<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>207</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    207
                    <a href="206.html">prev</a>
                    <a href="208.html">next</a>
                    <a href="207_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Automattic/simplenote-android_bf5cd5502f24a0f8a529769c227437509b0ec9f5_Simplenote/src/main/java/com/automattic/simplenote/NoteEditorFragment.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;bf5cd5502f24a0f8a529769c227437509b0ec9f5:Simplenote/src/main/java/com/automattic/simplenote/NoteEditorFragment.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;bf5cd5502f24a0f8a529769c227437509b0ec9f5^1:Simplenote/src/main/java/com/automattic/simplenote/NoteEditorFragment.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;bf5cd5502f24a0f8a529769c227437509b0ec9f5^2:Simplenote/src/main/java/com/automattic/simplenote/NoteEditorFragment.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Automattic\simplenote-android show &quot;15b2b25d8ceda8d613f23f9846fd7ddbea717acb:Simplenote/src/main/java/com/automattic/simplenote/NoteEditorFragment.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="8328120990598135231" onmouseenter="enter('8328120990598135231');" onmouseout="out('8328120990598135231');" style="">   1 package com.automattic.simplenote;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="7622566010320033225" onmouseenter="enter('7622566010320033225');" onmouseout="out('7622566010320033225');" style="">   4 import android.app.Fragment;                                                                             </span>
<span class="-1500972560159629307" onmouseenter="enter('-1500972560159629307');" onmouseout="out('-1500972560159629307');" style="">   5 import android.content.ClipData;                                                                         </span>
<span class="-1154037727824652611" onmouseenter="enter('-1154037727824652611');" onmouseout="out('-1154037727824652611');" style="">   6 import android.content.ClipboardManager;                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   7 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   8 import android.content.Intent;                                                                           </span>
<span class="-840652079464298178" onmouseenter="enter('-840652079464298178');" onmouseout="out('-840652079464298178');" style="">   9 import android.content.res.TypedArray;                                                                   </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  10 import android.database.Cursor;                                                                          </span>
<span class="1216741051675613788" onmouseenter="enter('1216741051675613788');" onmouseout="out('1216741051675613788');" style="">  11 import android.graphics.drawable.ColorDrawable;                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  12 import android.net.Uri;                                                                                  </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  13 import android.os.AsyncTask;                                                                             </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  14 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  15 import android.os.Bundle;                                                                                </span>
<span class="-1086316590722027623" onmouseenter="enter('-1086316590722027623');" onmouseout="out('-1086316590722027623');" style="">  16 import android.os.Handler;                                                                               </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  17 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="-8226814767277370585" onmouseenter="enter('-8226814767277370585');" onmouseout="out('-8226814767277370585');" style="">  18 import android.support.v7.view.ActionMode;                                                               </span>
<span class="4177373235046048356" onmouseenter="enter('4177373235046048356');" onmouseout="out('4177373235046048356');" style="">  19 import android.text.Editable;                                                                            </span>
<span class="7731806713123176572" onmouseenter="enter('7731806713123176572');" onmouseout="out('7731806713123176572');" style="">  20 import android.text.Spanned;                                                                             </span>
<span class="4038639591141008331" onmouseenter="enter('4038639591141008331');" onmouseout="out('4038639591141008331');" style="">  21 import android.text.TextWatcher;                                                                         </span>
<span class="2374973474356501783" onmouseenter="enter('2374973474356501783');" onmouseout="out('2374973474356501783');" style="">  22 import android.text.style.RelativeSizeSpan;                                                              </span>
<span class="-1165963660754430642" onmouseenter="enter('-1165963660754430642');" onmouseout="out('-1165963660754430642');" style="">  23 import android.text.style.URLSpan;                                                                       </span>
<span class="-3804250137032727253" onmouseenter="enter('-3804250137032727253');" onmouseout="out('-3804250137032727253');" style="">  24 import android.text.util.Linkify;                                                                        </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  25 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import android.util.TypedValue;                                                                          </span>
<span class="-153541495165582031" onmouseenter="enter('-153541495165582031');" onmouseout="out('-153541495165582031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import android.view.ActionMode;                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  28 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-153541495165582031" onmouseenter="enter('-153541495165582031');" onmouseout="out('-153541495165582031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import android.view.ActionMode;                                                                          </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import android.view.LayoutInflater;                                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  31 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  32 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="">  33 import android.view.LayoutInflater;                                                                      </span>
<span class="-603490076395619238" onmouseenter="enter('-603490076395619238');" onmouseout="out('-603490076395619238');" style="">  34 import android.view.Menu;                                                                                </span>
<span class="-434306062495579804" onmouseenter="enter('-434306062495579804');" onmouseout="out('-434306062495579804');" style="">  35 import android.view.MenuInflater;                                                                        </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  36 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  37 import android.view.View;                                                                                </span>
<span class="7569314084591619834" onmouseenter="enter('7569314084591619834');" onmouseout="out('7569314084591619834');" style="">  38 import android.view.ViewGroup;                                                                           </span>
<span class="-3054355229537475035" onmouseenter="enter('-3054355229537475035');" onmouseout="out('-3054355229537475035');" style="">  39 import android.view.WindowManager;                                                                       </span>
<span class="-3117363671899680167" onmouseenter="enter('-3117363671899680167');" onmouseout="out('-3117363671899680167');" style="">  40 import android.view.inputmethod.InputMethodManager;                                                      </span>
<span class="5634491474902588492" onmouseenter="enter('5634491474902588492');" onmouseout="out('5634491474902588492');" style="">  41 import android.widget.CursorAdapter;                                                                     </span>
<span class="-7136991092569948508" onmouseenter="enter('-7136991092569948508');" onmouseout="out('-7136991092569948508');" style="">  42 import android.widget.ImageButton;                                                                       </span>
<span class="-8478546344938881111" onmouseenter="enter('-8478546344938881111');" onmouseout="out('-8478546344938881111');" style="">  43 import android.widget.ImageView;                                                                         </span>
<span class="5987800420235491716" onmouseenter="enter('5987800420235491716');" onmouseout="out('5987800420235491716');" style="">  44 import android.widget.LinearLayout;                                                                      </span>
<span class="842268080202249770" onmouseenter="enter('842268080202249770');" onmouseout="out('842268080202249770');" style="">  45 import android.widget.PopupWindow;                                                                       </span>
<span class="-4961528671422147708" onmouseenter="enter('-4961528671422147708');" onmouseout="out('-4961528671422147708');" style="">  46 import android.widget.TextView;                                                                          </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  47 import android.widget.Toast;                                                                             </span>
<span class="-1505700250942826116" onmouseenter="enter('-1505700250942826116');" onmouseout="out('-1505700250942826116');" style="">  48 import android.widget.ToggleButton;                                                                      </span>
<span class="737425360271515900" onmouseenter="enter('737425360271515900');" onmouseout="out('737425360271515900');" style="">  49 import android.widget.ViewSwitcher;                                                                      </span>
<span  style="">  50                                                                                                          </span>
<span class="9061368408436996655" onmouseenter="enter('9061368408436996655');" onmouseout="out('9061368408436996655');" style="">  51 import com.automattic.simplenote.models.Note;                                                            </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">  52 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-4380838228434146133" onmouseenter="enter('-4380838228434146133');" onmouseout="out('-4380838228434146133');" style="">  53 import com.automattic.simplenote.utils.AutoBullet;                                                       </span>
<span class="8577850632926167445" onmouseenter="enter('8577850632926167445');" onmouseout="out('8577850632926167445');" style="">  54 import com.automattic.simplenote.utils.DisplayUtils;                                                     </span>
<span class="1327521140651609704" onmouseenter="enter('1327521140651609704');" onmouseout="out('1327521140651609704');" style="">  55 import com.automattic.simplenote.utils.MatchOffsetHighlighter;                                           </span>
<span class="-7136497821822559876" onmouseenter="enter('-7136497821822559876');" onmouseout="out('-7136497821822559876');" style="">  56 import com.automattic.simplenote.utils.PrefUtils;                                                        </span>
<span class="13513923158165555" onmouseenter="enter('13513923158165555');" onmouseout="out('13513923158165555');" style="">  57 import com.automattic.simplenote.utils.SpaceTokenizer;                                                   </span>
<span class="4834384566534786428" onmouseenter="enter('4834384566534786428');" onmouseout="out('4834384566534786428');" style="">  58 import com.automattic.simplenote.widgets.SimplenoteEditText;                                             </span>
<span class="2537926396801226048" onmouseenter="enter('2537926396801226048');" onmouseout="out('2537926396801226048');" style="">  59 import com.automattic.simplenote.utils.SimplenoteLinkify;                                                </span>
<span class="-4652171765784917488" onmouseenter="enter('-4652171765784917488');" onmouseout="out('-4652171765784917488');" style="">  60 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView;                                    </span>
<span class="451633977271230846" onmouseenter="enter('451633977271230846');" onmouseout="out('451633977271230846');" style="">  61 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView.OnTagAddedListener;                 </span>
<span class="3055903766206676561" onmouseenter="enter('3055903766206676561');" onmouseout="out('3055903766206676561');" style="">  62 import com.automattic.simplenote.utils.TextHighlighter;                                                  </span>
<span class="-454400291627646237" onmouseenter="enter('-454400291627646237');" onmouseout="out('-454400291627646237');" style="">  63 import com.google.android.gms.analytics.HitBuilders;                                                     </span>
<span class="-1389398410172463659" onmouseenter="enter('-1389398410172463659');" onmouseout="out('-1389398410172463659');" style="">  64 import com.google.android.gms.analytics.Tracker;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  65 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">  66 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  67 import com.simperium.client.Query;                                                                       </span>
<span  style="">  68                                                                                                          </span>
<span class="-76499702739685611" onmouseenter="enter('-76499702739685611');" onmouseout="out('-76499702739685611');" style="">  69 import java.text.NumberFormat;                                                                           </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  70 import java.util.Calendar;                                                                               </span>
<span  style="">  71                                                                                                          </span>
<span class="7280890691619564888" onmouseenter="enter('7280890691619564888');" onmouseout="out('7280890691619564888');" style=""><abbr title="  72 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListener, View.OnFocusChangeListener, SimplenoteEditText.OnSelectionChangedListener {">  72 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddeðŸ”µ</abbr></span>
<span  style="">  73                                                                                                          </span>
<span class="-4619625032881090052" onmouseenter="enter('-4619625032881090052');" onmouseout="out('-4619625032881090052');" style="">  74     public static final String ARG_ITEM_ID = &quot;item_id&quot;;                                                  </span>
<span class="-7299684920632401552" onmouseenter="enter('-7299684920632401552');" onmouseout="out('-7299684920632401552');" style="">  75     public static final String ARG_NEW_NOTE = &quot;new_note&quot;;                                                </span>
<span class="7663325037782331899" onmouseenter="enter('7663325037782331899');" onmouseout="out('7663325037782331899');" style="">  76     static public final String ARG_MATCH_OFFSETS = &quot;match_offsets&quot;;                                      </span>
<span class="8491452362607628076" onmouseenter="enter('8491452362607628076');" onmouseout="out('8491452362607628076');" style="">  77     private static final int AUTOSAVE_DELAY_MILLIS = 2000;                                               </span>
<span  style="">  78                                                                                                          </span>
<span class="-6846870049312317979" onmouseenter="enter('-6846870049312317979');" onmouseout="out('-6846870049312317979');" style="">  79     private Note mNote;                                                                                  </span>
<span class="-7913886194286774922" onmouseenter="enter('-7913886194286774922');" onmouseout="out('-7913886194286774922');" style="">  80     private Bucket&lt;Note&gt; mNotesBucket;                                                                   </span>
<span  style="">  81                                                                                                          </span>
<span class="7126484835826685301" onmouseenter="enter('7126484835826685301');" onmouseout="out('7126484835826685301');" style="">  82     private Tracker mTracker;                                                                            </span>
<span  style="">  83                                                                                                          </span>
<span class="6580801006778009663" onmouseenter="enter('6580801006778009663');" onmouseout="out('6580801006778009663');" style="">  84     private SimplenoteEditText mContentEditText;                                                         </span>
<span class="-6964345898478101017" onmouseenter="enter('-6964345898478101017');" onmouseout="out('-6964345898478101017');" style="">  85     private TagsMultiAutoCompleteTextView mTagView;                                                      </span>
<span class="5165556704755836097" onmouseenter="enter('5165556704755836097');" onmouseout="out('5165556704755836097');" style="">  86     private PopupWindow mInfoPopupWindow;                                                                </span>
<span class="2959047860003936172" onmouseenter="enter('2959047860003936172');" onmouseout="out('2959047860003936172');" style="">  87     private ToggleButton mPinButton;                                                                     </span>
<span class="6494121288462075344" onmouseenter="enter('6494121288462075344');" onmouseout="out('6494121288462075344');" style="">  88     private Handler mAutoSaveHandler;                                                                    </span>
<span class="8783277907965445564" onmouseenter="enter('8783277907965445564');" onmouseout="out('8783277907965445564');" style="">  89     private Handler mPublishTimeoutHandler;                                                              </span>
<span class="-1776320876088405367" onmouseenter="enter('-1776320876088405367');" onmouseout="out('-1776320876088405367');" style="">  90     private LinearLayout mPlaceholderView;                                                               </span>
<span class="-5862875858497045082" onmouseenter="enter('-5862875858497045082');" onmouseout="out('-5862875858497045082');" style="">  91     private CursorAdapter mAutocompleteAdapter;                                                          </span>
<span class="275494556225166536" onmouseenter="enter('275494556225166536');" onmouseout="out('275494556225166536');" style="">  92     private boolean mIsNewNote, mIsLoadingNote;                                                          </span>
<span class="7307228847460234411" onmouseenter="enter('7307228847460234411');" onmouseout="out('7307228847460234411');" style="">  93     private ActionMode mActionMode;                                                                      </span>
<span class="-1934738222867341331" onmouseenter="enter('-1934738222867341331');" onmouseout="out('-1934738222867341331');" style="">  94     private MenuItem mViewLinkMenuItem;                                                                  </span>
<span class="-3624836155172024592" onmouseenter="enter('-3624836155172024592');" onmouseout="out('-3624836155172024592');" style="">  95     private String mLinkUrl;                                                                             </span>
<span class="-680149036339568713" onmouseenter="enter('-680149036339568713');" onmouseout="out('-680149036339568713');" style="">  96     private String mLinkText;                                                                            </span>
<span class="-8355060532383088001" onmouseenter="enter('-8355060532383088001');" onmouseout="out('-8355060532383088001');" style="">  97     private MatchOffsetHighlighter mHighlighter;                                                         </span>
<span class="-2809999858206249165" onmouseenter="enter('-2809999858206249165');" onmouseout="out('-2809999858206249165');" style="">  98     private int mEmailIconResId, mWebIconResId, mMapIconResId, mCallIconResId;                           </span>
<span class="-7542236593744276396" onmouseenter="enter('-7542236593744276396');" onmouseout="out('-7542236593744276396');" style="">  99     private MatchOffsetHighlighter.SpanFactory mMatchHighlighter;                                        </span>
<span class="2689815831275839045" onmouseenter="enter('2689815831275839045');" onmouseout="out('2689815831275839045');" style=""> 100     private String mMatchOffsets;                                                                        </span>
<span class="-7790101837861097441" onmouseenter="enter('-7790101837861097441');" onmouseout="out('-7790101837861097441');" style=""> 101     private int mCurrentCursorPosition;                                                                  </span>
<span  style=""> 102                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 103     /**                                                                                                  </span>
<span class="7780585517980788373" onmouseenter="enter('7780585517980788373');" onmouseout="out('7780585517980788373');" style=""> 104      * Mandatory empty constructor for the fragment manager to instantiate the                           </span>
<span class="7130060501227883159" onmouseenter="enter('7130060501227883159');" onmouseout="out('7130060501227883159');" style=""> 105      * fragment (e.g. upon screen orientation changes).                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 106      */                                                                                                  </span>
<span class="2055429757813344166" onmouseenter="enter('2055429757813344166');" onmouseout="out('2055429757813344166');" style=""> 107     public NoteEditorFragment() {                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 111     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 112         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 113                                                                                                          </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 114         if (getActivity() != null) {                                                                     </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 115             Simplenote currentApp = (Simplenote) getActivity().getApplication();                         </span>
<span class="3464165486447434608" onmouseenter="enter('3464165486447434608');" onmouseout="out('3464165486447434608');" style=""> 116             mNotesBucket = currentApp.getNotesBucket();                                                  </span>
<span class="8395901407898834802" onmouseenter="enter('8395901407898834802');" onmouseout="out('8395901407898834802');" style=""> 117             mTracker = currentApp.getTracker();                                                          </span>
<span  style=""> 118                                                                                                          </span>
<span class="6390134422937918444" onmouseenter="enter('6390134422937918444');" onmouseout="out('6390134422937918444');" style=""><abbr title=" 119             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionBarIconWeb, R.attr.actionBarIconMap, R.attr.actionBarIconCall});"> 119             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.atðŸ”µ</abbr></span>
<span class="-368005650607593546" onmouseenter="enter('-368005650607593546');" onmouseout="out('-368005650607593546');" style=""> 120             if (a != null) {                                                                             </span>
<span class="156477903530707073" onmouseenter="enter('156477903530707073');" onmouseout="out('156477903530707073');" style=""> 121                 mEmailIconResId = a.getResourceId(0, 0);                                                 </span>
<span class="2237960387607406884" onmouseenter="enter('2237960387607406884');" onmouseout="out('2237960387607406884');" style=""> 122                 mWebIconResId = a.getResourceId(1, 0);                                                   </span>
<span class="-2587404817224189880" onmouseenter="enter('-2587404817224189880');" onmouseout="out('-2587404817224189880');" style=""> 123                 mMapIconResId = a.getResourceId(2, 0);                                                   </span>
<span class="7397862531502718567" onmouseenter="enter('7397862531502718567');" onmouseout="out('7397862531502718567');" style=""> 124                 mCallIconResId = a.getResourceId(3, 0);                                                  </span>
<span class="7664438635535969272" onmouseenter="enter('7664438635535969272');" onmouseout="out('7664438635535969272');" style=""> 125                 a.recycle();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span  style=""> 128                                                                                                          </span>
<span class="-7557436274459739944" onmouseenter="enter('-7557436274459739944');" onmouseout="out('-7557436274459739944');" style=""> 129         mAutoSaveHandler = new Handler();                                                                </span>
<span class="5311700283685025064" onmouseenter="enter('5311700283685025064');" onmouseout="out('5311700283685025064');" style=""> 130         mPublishTimeoutHandler = new Handler();                                                          </span>
<span  style=""> 131                                                                                                          </span>
<span class="-8863028397307166255" onmouseenter="enter('-8863028397307166255');" onmouseout="out('-8863028397307166255');" style=""> 132         mMatchHighlighter = new TextHighlighter(getActivity(),                                           </span>
<span class="5690198221529347900" onmouseenter="enter('5690198221529347900');" onmouseout="out('5690198221529347900');" style=""><abbr title=" 133                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor);"> 133                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor)ðŸ”µ</abbr></span>
<span class="3992270686517948303" onmouseenter="enter('3992270686517948303');" onmouseout="out('3992270686517948303');" style=""> 134         mAutocompleteAdapter = new CursorAdapter(getActivity(), null, 0x0){                              </span>
<span  style=""> 135                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 136             @Override                                                                                    </span>
<span class="5082230411214880762" onmouseenter="enter('5082230411214880762');" onmouseout="out('5082230411214880762');" style=""> 137             public View newView(Context context, Cursor cursor, ViewGroup parent) {                      </span>
<span class="-7341849400851650995" onmouseenter="enter('-7341849400851650995');" onmouseout="out('-7341849400851650995');" style=""> 138                 Activity activity = (Activity) context;                                                  </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 139                 if (activity == null) return null;                                                       </span>
<span class="-3314008061858345993" onmouseenter="enter('-3314008061858345993');" onmouseout="out('-3314008061858345993');" style=""> 140                 return activity.getLayoutInflater().inflate(R.layout.tag_autocomplete_list_item, null);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141             }                                                                                            </span>
<span  style=""> 142                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 143             @Override                                                                                    </span>
<span class="19024103499623332" onmouseenter="enter('19024103499623332');" onmouseout="out('19024103499623332');" style=""> 144             public void bindView(View view, Context context, Cursor cursor) {                            </span>
<span class="1800045997788095368" onmouseenter="enter('1800045997788095368');" onmouseout="out('1800045997788095368');" style=""> 145                 TextView textView = (TextView) view;                                                     </span>
<span class="6731261465219202848" onmouseenter="enter('6731261465219202848');" onmouseout="out('6731261465219202848');" style=""> 146                 textView.setText(convertToString(cursor));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147             }                                                                                            </span>
<span  style=""> 148                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 149             @Override                                                                                    </span>
<span class="-1664730445059241307" onmouseenter="enter('-1664730445059241307');" onmouseout="out('-1664730445059241307');" style=""> 150             public CharSequence convertToString(Cursor cursor){                                          </span>
<span class="-7149458698442797769" onmouseenter="enter('-7149458698442797769');" onmouseout="out('-7149458698442797769');" style=""> 151                 return cursor.getString(cursor.getColumnIndex(Tag.NAME_PROPERTY));                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152             }                                                                                            </span>
<span  style=""> 153                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 154             @Override                                                                                    </span>
<span class="-6792310640715402890" onmouseenter="enter('-6792310640715402890');" onmouseout="out('-6792310640715402890');" style=""> 155             public Cursor runQueryOnBackgroundThread(CharSequence filter) {                              </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 156                 Activity activity = getActivity();                                                       </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 157                 if (activity == null) return null;                                                       </span>
<span class="9016693485500608067" onmouseenter="enter('9016693485500608067');" onmouseout="out('9016693485500608067');" style=""> 158                 Simplenote application = (Simplenote) activity.getApplication();                         </span>
<span class="-288329532637656436" onmouseenter="enter('-288329532637656436');" onmouseout="out('-288329532637656436');" style=""> 159                 Query&lt;Tag&gt; query = application.getTagsBucket().query();                                  </span>
<span class="-1263658484466254954" onmouseenter="enter('-1263658484466254954');" onmouseout="out('-1263658484466254954');" style=""> 160                 // make the tag name available to the cursor                                             </span>
<span class="5748018636045801946" onmouseenter="enter('5748018636045801946');" onmouseout="out('5748018636045801946');" style=""> 161                 query.include(Tag.NAME_PROPERTY);                                                        </span>
<span class="-7615810455976629564" onmouseenter="enter('-7615810455976629564');" onmouseout="out('-7615810455976629564');" style=""> 162                 // sort the tags by their names                                                          </span>
<span class="5674220988188306819" onmouseenter="enter('5674220988188306819');" onmouseout="out('5674220988188306819');" style=""> 163                 query.order(Tag.NAME_PROPERTY);                                                          </span>
<span class="8185275162074884971" onmouseenter="enter('8185275162074884971');" onmouseout="out('8185275162074884971');" style=""> 164                 // if there&#x27;s a filter string find only matching tag names                               </span>
<span class="-1465062097430607325" onmouseenter="enter('-1465062097430607325');" onmouseout="out('-1465062097430607325');" style=""><abbr title=" 165                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%&quot;, filter));"> 165                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.forðŸ”µ</abbr></span>
<span class="8392918727668200780" onmouseenter="enter('8392918727668200780');" onmouseout="out('8392918727668200780');" style=""> 166                 return query.execute();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 168         };                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169     }                                                                                                    </span>
<span  style=""> 170                                                                                                          </span>
<span  style=""> 171                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 172     @Override                                                                                            </span>
<span class="-7355940524539913821" onmouseenter="enter('-7355940524539913821');" onmouseout="out('-7355940524539913821');" style=""> 173     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {  </span>
<span class="7823602444079418117" onmouseenter="enter('7823602444079418117');" onmouseout="out('7823602444079418117');" style=""> 174         setHasOptionsMenu(true);                                                                         </span>
<span class="6339769591252564933" onmouseenter="enter('6339769591252564933');" onmouseout="out('6339769591252564933');" style=""> 175         View rootView = inflater.inflate(R.layout.fragment_note_editor, container, false);               </span>
<span class="7145177453793333411" onmouseenter="enter('7145177453793333411');" onmouseout="out('7145177453793333411');" style=""> 176         mContentEditText = ((SimplenoteEditText) rootView.findViewById(R.id.note_content));              </span>
<span class="-2924083774161461664" onmouseenter="enter('-2924083774161461664');" onmouseout="out('-2924083774161461664');" style=""> 177         mContentEditText.addOnSelectionChangedListener(this);                                            </span>
<span class="-5685601943521108416" onmouseenter="enter('-5685601943521108416');" onmouseout="out('-5685601943521108416');" style=""> 178         mTagView = (TagsMultiAutoCompleteTextView) rootView.findViewById(R.id.tag_view);                 </span>
<span class="-1710279282572635872" onmouseenter="enter('-1710279282572635872');" onmouseout="out('-1710279282572635872');" style=""> 179         mTagView.setTokenizer(new SpaceTokenizer());                                                     </span>
<span class="-905473657518076069" onmouseenter="enter('-905473657518076069');" onmouseout="out('-905473657518076069');" style=""> 180         mTagView.setOnFocusChangeListener(this);                                                         </span>
<span  style=""> 181                                                                                                          </span>
<span class="6080374810605667863" onmouseenter="enter('6080374810605667863');" onmouseout="out('6080374810605667863');" style=""> 182         mHighlighter = new MatchOffsetHighlighter(mMatchHighlighter, mContentEditText);                  </span>
<span  style=""> 183                                                                                                          </span>
<span class="8838498328861850169" onmouseenter="enter('8838498328861850169');" onmouseout="out('8838498328861850169');" style=""> 184         mPinButton = (ToggleButton) rootView.findViewById(R.id.pinButton);                               </span>
<span class="-6233419192957625397" onmouseenter="enter('-6233419192957625397');" onmouseout="out('-6233419192957625397');" style=""> 185         mPinButton.setOnClickListener(new View.OnClickListener() {                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 186             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 187             public void onClick(View v) {                                                                </span>
<span class="-1510302136918940941" onmouseenter="enter('-1510302136918940941');" onmouseout="out('-1510302136918940941');" style=""> 188                 if (mPinButton.isChecked()) {                                                            </span>
<span class="-7637598965692605019" onmouseenter="enter('-7637598965692605019');" onmouseout="out('-7637598965692605019');" style=""> 189                     // Friendly message to the user as to what this button does.                         </span>
<span class="5938443200552047425" onmouseenter="enter('5938443200552047425');" onmouseout="out('5938443200552047425');" style=""> 190                     Toast.makeText(getActivity(), R.string.note_pinned, Toast.LENGTH_SHORT).show();      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 193         });                                                                                              </span>
<span  style=""> 194                                                                                                          </span>
<span class="-3806018576171196544" onmouseenter="enter('-3806018576171196544');" onmouseout="out('-3806018576171196544');" style=""> 195         mPlaceholderView = (LinearLayout) rootView.findViewById(R.id.placeholder);                       </span>
<span class="2017772049978674307" onmouseenter="enter('2017772049978674307');" onmouseout="out('2017772049978674307');" style=""> 196         if (DisplayUtils.isLargeLandscape(getActivity()) &amp;&amp; mNote == null) {                             </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 197             mPlaceholderView.setVisibility(View.VISIBLE);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198         }                                                                                                </span>
<span  style=""> 199                                                                                                          </span>
<span class="-8386469275367064070" onmouseenter="enter('-8386469275367064070');" onmouseout="out('-8386469275367064070');" style=""> 200         mTagView.setAdapter(mAutocompleteAdapter);                                                       </span>
<span  style=""> 201                                                                                                          </span>
<span class="592168733134676120" onmouseenter="enter('592168733134676120');" onmouseout="out('592168733134676120');" style=""> 202         // Load note if we were passed a note Id                                                         </span>
<span class="-512438581163180757" onmouseenter="enter('-512438581163180757');" onmouseout="out('-512438581163180757');" style=""> 203         Bundle arguments = getArguments();                                                               </span>
<span class="5652609996770636291" onmouseenter="enter('5652609996770636291');" onmouseout="out('5652609996770636291');" style=""> 204         if (arguments != null &amp;&amp; arguments.containsKey(ARG_ITEM_ID)) {                                   </span>
<span class="-30854459346766710" onmouseenter="enter('-30854459346766710');" onmouseout="out('-30854459346766710');" style=""> 205             String key = arguments.getString(ARG_ITEM_ID);                                               </span>
<span class="9138949033848867696" onmouseenter="enter('9138949033848867696');" onmouseout="out('9138949033848867696');" style=""> 206             if (arguments.containsKey(ARG_MATCH_OFFSETS)) {                                              </span>
<span class="-1831707694683903303" onmouseenter="enter('-1831707694683903303');" onmouseout="out('-1831707694683903303');" style=""> 207                 mMatchOffsets = arguments.getString(ARG_MATCH_OFFSETS);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208             }                                                                                            </span>
<span class="-3890643464976908836" onmouseenter="enter('-3890643464976908836');" onmouseout="out('-3890643464976908836');" style=""> 209             new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, key);                   </span>
<span class="-4954549700347163589" onmouseenter="enter('-4954549700347163589');" onmouseout="out('-4954549700347163589');" style=""> 210             setIsNewNote(getArguments().getBoolean(ARG_NEW_NOTE, false));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span  style=""> 212                                                                                                          </span>
<span class="4654908577906893139" onmouseenter="enter('4654908577906893139');" onmouseout="out('4654908577906893139');" style=""> 213 		return rootView;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214 	}                                                                                                       </span>
<span  style=""> 215                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216     @Override                                                                                            </span>
<span class="3212580988936830895" onmouseenter="enter('3212580988936830895');" onmouseout="out('3212580988936830895');" style=""> 217     public void onResume() {                                                                             </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 218         super.onResume();                                                                                </span>
<span class="-295722270474880574" onmouseenter="enter('-295722270474880574');" onmouseout="out('-295722270474880574');" style=""> 219         mNotesBucket.start();                                                                            </span>
<span class="8320491026461558488" onmouseenter="enter('8320491026461558488');" onmouseout="out('8320491026461558488');" style=""> 220         mNotesBucket.addListener(this);                                                                  </span>
<span  style=""> 221                                                                                                          </span>
<span class="2283760307260285965" onmouseenter="enter('2283760307260285965');" onmouseout="out('2283760307260285965');" style=""> 222         mTagView.setOnTagAddedListener(this);                                                            </span>
<span  style=""> 223                                                                                                          </span>
<span class="-8630351771722931094" onmouseenter="enter('-8630351771722931094');" onmouseout="out('-8630351771722931094');" style=""> 224         if (mContentEditText != null) {                                                                  </span>
<span class="-999020196626820400" onmouseenter="enter('-999020196626820400');" onmouseout="out('-999020196626820400');" style=""><abbr title=" 225             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), PrefUtils.PREF_FONT_SIZE, 18));"> 225             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 229     @Override                                                                                            </span>
<span class="3108783673391190151" onmouseenter="enter('3108783673391190151');" onmouseout="out('3108783673391190151');" style=""> 230     public void onPause() {                                                                              </span>
<span class="-1649552973291504175" onmouseenter="enter('-1649552973291504175');" onmouseout="out('-1649552973291504175');" style=""> 231         mNotesBucket.removeListener(this);                                                               </span>
<span class="-4286062678685908757" onmouseenter="enter('-4286062678685908757');" onmouseout="out('-4286062678685908757');" style=""> 232         // Hide soft keyboard if it is showing...                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 233         if (getActivity() != null) {                                                                     </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 234             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 234             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(CðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 235             if (inputMethodManager != null) {                                                            </span>
<span class="159022051514418479" onmouseenter="enter('159022051514418479');" onmouseout="out('159022051514418479');" style=""> 236                 inputMethodManager.hideSoftInputFromWindow(mContentEditText.getWindowToken(), 0);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238         }                                                                                                </span>
<span  style=""> 239                                                                                                          </span>
<span class="-2832208055092409078" onmouseenter="enter('-2832208055092409078');" onmouseout="out('-2832208055092409078');" style=""> 240         // Delete the note if it is new and has empty fields                                             </span>
<span class="-2219905285758853631" onmouseenter="enter('-2219905285758853631');" onmouseout="out('-2219905285758853631');" style=""> 241         if (mNote != null &amp;&amp; mIsNewNote &amp;&amp; noteIsEmpty()) {                                              </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 242             mNote.delete();                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 243         } else {                                                                                         </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 244             saveNote();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245         }                                                                                                </span>
<span  style=""> 246                                                                                                          </span>
<span class="-5824468190651999684" onmouseenter="enter('-5824468190651999684');" onmouseout="out('-5824468190651999684');" style=""> 247         mTagView.setOnTagAddedListener(null);                                                            </span>
<span  style=""> 248                                                                                                          </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 249         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 250             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251         }                                                                                                </span>
<span  style=""> 252                                                                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 253         if (mPublishTimeoutHandler != null) {                                                            </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 254             mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255         }                                                                                                </span>
<span  style=""> 256                                                                                                          </span>
<span class="212618759798230270" onmouseenter="enter('212618759798230270');" onmouseout="out('212618759798230270');" style=""> 257         mHighlighter.stop();                                                                             </span>
<span  style=""> 258                                                                                                          </span>
<span class="-7508449912261312872" onmouseenter="enter('-7508449912261312872');" onmouseout="out('-7508449912261312872');" style=""> 259         super.onPause();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260     }                                                                                                    </span>
<span  style=""> 261                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 262     @Override                                                                                            </span>
<span class="-6208734081302594375" onmouseenter="enter('-6208734081302594375');" onmouseout="out('-6208734081302594375');" style=""> 263     public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {                                  </span>
<span class="-5591635883999644357" onmouseenter="enter('-5591635883999644357');" onmouseout="out('-5591635883999644357');" style=""> 264         inflater.inflate(R.menu.note_editor, menu);                                                      </span>
<span  style=""> 265                                                                                                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 266         if (mNote != null) {                                                                             </span>
<span class="3411369858029698957" onmouseenter="enter('3411369858029698957');" onmouseout="out('3411369858029698957');" style=""> 267             MenuItem viewPublishedNoteItem = menu.findItem(R.id.menu_view_info);                         </span>
<span class="-2499359923625437976" onmouseenter="enter('-2499359923625437976');" onmouseout="out('-2499359923625437976');" style=""> 268             viewPublishedNoteItem.setVisible(true);                                                      </span>
<span  style=""> 269                                                                                                          </span>
<span class="7674470390729338414" onmouseenter="enter('7674470390729338414');" onmouseout="out('7674470390729338414');" style=""> 270             MenuItem trashItem = menu.findItem(R.id.menu_delete).setTitle(R.string.undelete);            </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 271             if (mNote.isDeleted())                                                                       </span>
<span class="2395244797129247894" onmouseenter="enter('2395244797129247894');" onmouseout="out('2395244797129247894');" style=""> 272                 trashItem.setTitle(R.string.undelete);                                                   </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 273             else                                                                                         </span>
<span class="-2747782095374702281" onmouseenter="enter('-2747782095374702281');" onmouseout="out('-2747782095374702281');" style=""> 274                 trashItem.setTitle(R.string.delete);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275         }                                                                                                </span>
<span  style=""> 276                                                                                                          </span>
<span class="5772887857065615623" onmouseenter="enter('5772887857065615623');" onmouseout="out('5772887857065615623');" style=""> 277         super.onCreateOptionsMenu(menu, inflater);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 280     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 281     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 282         switch (item.getItemId()) {                                                                      </span>
<span class="-3574644309369097250" onmouseenter="enter('-3574644309369097250');" onmouseout="out('-3574644309369097250');" style=""> 283             case R.id.menu_view_info:                                                                    </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 284                 if (mNote != null) {                                                                     </span>
<span class="-5974815457760504487" onmouseenter="enter('-5974815457760504487');" onmouseout="out('-5974815457760504487');" style=""> 285                     View menuItemView = getActivity().findViewById(R.id.menu_view_info);                 </span>
<span class="2497222703395221844" onmouseenter="enter('2497222703395221844');" onmouseout="out('2497222703395221844');" style=""> 286                     showInfoPopup(menuItemView);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 288                 return true;                                                                             </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 289             case R.id.menu_share:                                                                        </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 290                 if (mNote != null) {                                                                     </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 291                     Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                 </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 292                     shareIntent.setType(&quot;text/plain&quot;);                                                   </span>
<span class="2565640458837084796" onmouseenter="enter('2565640458837084796');" onmouseout="out('2565640458837084796');" style=""> 293                     shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mNote.getContent());         </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 294                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 294                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.shaðŸ”µ</abbr></span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 295                     mTracker.send(                                                                       </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 296                             new HitBuilders.EventBuilder()                                               </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 297                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="2679386718058736721" onmouseenter="enter('2679386718058736721');" onmouseout="out('2679386718058736721');" style=""> 298                             .setAction(&quot;shared_note&quot;)                                                    </span>
<span class="-1410195237862732008" onmouseenter="enter('-1410195237862732008');" onmouseout="out('-1410195237862732008');" style=""> 299                             .setLabel(&quot;action_bar_share_button&quot;)                                         </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 300                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 301                     );                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 303                 return true;                                                                             </span>
<span class="6443133868746637198" onmouseenter="enter('6443133868746637198');" onmouseout="out('6443133868746637198');" style=""> 304             case R.id.menu_delete:                                                                       </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 305                 if (mNote != null) {                                                                     </span>
<span class="-929724925513034279" onmouseenter="enter('-929724925513034279');" onmouseout="out('-929724925513034279');" style=""> 306                     mNote.setDeleted(!mNote.isDeleted());                                                </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 307                     mNote.setModificationDate(Calendar.getInstance());                                   </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 308                     mNote.save();                                                                        </span>
<span class="-8654137458864067059" onmouseenter="enter('-8654137458864067059');" onmouseout="out('-8654137458864067059');" style=""> 309                     Intent resultIntent = new Intent();                                                  </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 310                     if (mNote.isDeleted())                                                               </span>
<span class="-4555570864561374481" onmouseenter="enter('-4555570864561374481');" onmouseout="out('-4555570864561374481');" style=""> 311                         resultIntent.putExtra(Simplenote.DELETED_NOTE_ID, mNote.getSimperiumKey());      </span>
<span class="2925812847088143790" onmouseenter="enter('2925812847088143790');" onmouseout="out('2925812847088143790');" style=""> 312                     getActivity().setResult(Activity.RESULT_OK, resultIntent);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313                 }                                                                                        </span>
<span  style=""> 314                                                                                                          </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 315                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 316                 return true;                                                                             </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 317             case android.R.id.home:                                                                      </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 318                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 319                 return true;                                                                             </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 320             default:                                                                                     </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 321                 return super.onOptionsItemSelected(item);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323     }                                                                                                    </span>
<span  style=""> 324                                                                                                          </span>
<span class="8271468180839847847" onmouseenter="enter('8271468180839847847');" onmouseout="out('8271468180839847847');" style=""> 325     // show a popup view from the info action bar item                                                   </span>
<span class="301694884727727095" onmouseenter="enter('301694884727727095');" onmouseout="out('301694884727727095');" style=""> 326     private void showInfoPopup(View view) {                                                              </span>
<span class="-8824124309160747557" onmouseenter="enter('-8824124309160747557');" onmouseout="out('-8824124309160747557');" style=""> 327         if (!isAdded() || view == null) return;                                                          </span>
<span  style=""> 328                                                                                                          </span>
<span class="-6163322818153177863" onmouseenter="enter('-6163322818153177863');" onmouseout="out('-6163322818153177863');" style=""> 329         if (mInfoPopupWindow == null) {                                                                  </span>
<span class="6416634994496998699" onmouseenter="enter('6416634994496998699');" onmouseout="out('6416634994496998699');" style=""> 330             mInfoPopupWindow = new PopupWindow(getActivity());                                           </span>
<span class="-7704183450622301834" onmouseenter="enter('-7704183450622301834');" onmouseout="out('-7704183450622301834');" style=""> 331             mInfoPopupWindow.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);                          </span>
<span class="-3987029803100381492" onmouseenter="enter('-3987029803100381492');" onmouseout="out('-3987029803100381492');" style=""> 332             mInfoPopupWindow.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);                         </span>
<span class="-8327124619089985465" onmouseenter="enter('-8327124619089985465');" onmouseout="out('-8327124619089985465');" style=""> 333             mInfoPopupWindow.setBackgroundDrawable(new ColorDrawable(0));                                </span>
<span class="3466073935356821559" onmouseenter="enter('3466073935356821559');" onmouseout="out('3466073935356821559');" style=""> 334             mInfoPopupWindow.setOutsideTouchable(true);                                                  </span>
<span class="-1875471742113799055" onmouseenter="enter('-1875471742113799055');" onmouseout="out('-1875471742113799055');" style=""> 335             mInfoPopupWindow.setFocusable(true);                                                         </span>
<span  style=""> 336                                                                                                          </span>
<span class="5212568524712573915" onmouseenter="enter('5212568524712573915');" onmouseout="out('5212568524712573915');" style=""> 337             LayoutInflater inflater = LayoutInflater.from(getActivity());                                </span>
<span class="-7758049233010801507" onmouseenter="enter('-7758049233010801507');" onmouseout="out('-7758049233010801507');" style=""> 338             View popupView = inflater.inflate(R.layout.popup_info, null);                                </span>
<span class="536077715701124131" onmouseenter="enter('536077715701124131');" onmouseout="out('536077715701124131');" style=""> 339             mInfoPopupWindow.setContentView(popupView);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340         }                                                                                                </span>
<span  style=""> 341                                                                                                          </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 342         updateInfoPopup();                                                                               </span>
<span  style=""> 343                                                                                                          </span>
<span class="4487253113225225144" onmouseenter="enter('4487253113225225144');" onmouseout="out('4487253113225225144');" style=""> 344         mInfoPopupWindow.showAsDropDown(view);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345     }                                                                                                    </span>
<span  style=""> 346                                                                                                          </span>
<span class="-8758077771583595367" onmouseenter="enter('-8758077771583595367');" onmouseout="out('-8758077771583595367');" style=""> 347     // update the content of the popupview                                                               </span>
<span class="-7181846678873590508" onmouseenter="enter('-7181846678873590508');" onmouseout="out('-7181846678873590508');" style=""> 348     private void updateInfoPopup() {                                                                     </span>
<span class="-8697403400729029020" onmouseenter="enter('-8697403400729029020');" onmouseout="out('-8697403400729029020');" style=""> 349         if (mInfoPopupWindow == null || mInfoPopupWindow.getContentView() == null) return;               </span>
<span  style=""> 350                                                                                                          </span>
<span class="3837773520867540996" onmouseenter="enter('3837773520867540996');" onmouseout="out('3837773520867540996');" style=""> 351         View popupView = mInfoPopupWindow.getContentView();                                              </span>
<span  style=""> 352                                                                                                          </span>
<span class="-5563348291777194716" onmouseenter="enter('-5563348291777194716');" onmouseout="out('-5563348291777194716');" style=""> 353         View publishButton = popupView.findViewById(R.id.publish_note_button);                           </span>
<span class="4581310412057978293" onmouseenter="enter('4581310412057978293');" onmouseout="out('4581310412057978293');" style=""> 354         TextView publishButtonTextView = (TextView)popupView.findViewById(R.id.publish_note_button_text);</span>
<span class="-6410915739065156574" onmouseenter="enter('-6410915739065156574');" onmouseout="out('-6410915739065156574');" style=""> 355         ImageView publishButtonIcon = (ImageView)popupView.findViewById(R.id.publish_note_button_icon);  </span>
<span class="-6918482493044946592" onmouseenter="enter('-6918482493044946592');" onmouseout="out('-6918482493044946592');" style=""> 356         TextView publishTextView = (TextView) popupView.findViewById(R.id.publish_url_textview);         </span>
<span class="1038347291336054559" onmouseenter="enter('1038347291336054559');" onmouseout="out('1038347291336054559');" style=""> 357         TextView wordCountTextView = (TextView) popupView.findViewById(R.id.word_count);                 </span>
<span class="-7977646551049898553" onmouseenter="enter('-7977646551049898553');" onmouseout="out('-7977646551049898553');" style=""> 358         ImageButton publishCopyButton = (ImageButton) popupView.findViewById(R.id.publish_copy_url);     </span>
<span class="7101383467626352915" onmouseenter="enter('7101383467626352915');" onmouseout="out('7101383467626352915');" style=""> 359         ImageButton publishShareButton = (ImageButton) popupView.findViewById(R.id.publish_share_url);   </span>
<span class="3150325744662714786" onmouseenter="enter('3150325744662714786');" onmouseout="out('3150325744662714786');" style=""> 360         View actionsView = popupView.findViewById(R.id.publish_actions);                                 </span>
<span  style=""> 361                                                                                                          </span>
<span class="1432622249676412210" onmouseenter="enter('1432622249676412210');" onmouseout="out('1432622249676412210');" style=""><abbr title=" 362         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcher);"> 362         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcheðŸ”µ</abbr></span>
<span  style=""> 363                                                                                                          </span>
<span class="-7759606836018483289" onmouseenter="enter('-7759606836018483289');" onmouseout="out('-7759606836018483289');" style=""> 364         publishButton.setOnClickListener(new View.OnClickListener() {                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 365             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 366             public void onClick(View v) {                                                                </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 367                 if (mNote != null) {                                                                     </span>
<span class="5563864695602119989" onmouseenter="enter('5563864695602119989');" onmouseout="out('5563864695602119989');" style=""> 368                     boolean newPublishedStatus = !mNote.isPublished();                                   </span>
<span class="-3191807331109519265" onmouseenter="enter('-3191807331109519265');" onmouseout="out('-3191807331109519265');" style=""> 369                     mNote.setPublished(newPublishedStatus);                                              </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 370                     mNote.save();                                                                        </span>
<span  style=""> 371                                                                                                          </span>
<span class="-6566894946886815467" onmouseenter="enter('-6566894946886815467');" onmouseout="out('-6566894946886815467');" style=""> 372                     if (viewSwitcher.getDisplayedChild() == 0) {                                         </span>
<span class="1964540099195163034" onmouseenter="enter('1964540099195163034');" onmouseout="out('1964540099195163034');" style=""> 373                         viewSwitcher.showNext();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374                     }                                                                                    </span>
<span  style=""> 375                                                                                                          </span>
<span class="3198515589608942377" onmouseenter="enter('3198515589608942377');" onmouseout="out('3198515589608942377');" style=""> 376                     // reset publish status in 20 seconds if we don&#x27;t hear back from Simperium           </span>
<span class="-4829904289357833951" onmouseenter="enter('-4829904289357833951');" onmouseout="out('-4829904289357833951');" style=""> 377                     mPublishTimeoutHandler.postDelayed(mPublishTimeoutRunnable, 20000);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 380         });                                                                                              </span>
<span  style=""> 381                                                                                                          </span>
<span class="4045844893437359317" onmouseenter="enter('4045844893437359317');" onmouseout="out('4045844893437359317');" style=""> 382         publishTextView.setOnClickListener(new View.OnClickListener() {                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 383             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 384             public void onClick(View v) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 385                 try {                                                                                    </span>
<span class="-8142976939479350202" onmouseenter="enter('-8142976939479350202');" onmouseout="out('-8142976939479350202');" style=""> 386                     startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(mNote.getPublishedUrl())));   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 387                 } catch (Exception e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 388                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 391         });                                                                                              </span>
<span  style=""> 392                                                                                                          </span>
<span class="-6950650320634084190" onmouseenter="enter('-6950650320634084190');" onmouseout="out('-6950650320634084190');" style=""> 393         publishCopyButton.setOnClickListener(new View.OnClickListener() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 394             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 395             public void onClick(View v) {                                                                </span>
<span class="4796955211675373396" onmouseenter="enter('4796955211675373396');" onmouseout="out('4796955211675373396');" style=""><abbr title=" 396                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 396                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLðŸ”µ</abbr></span>
<span class="-7278433972965562810" onmouseenter="enter('-7278433972965562810');" onmouseout="out('-7278433972965562810');" style=""><abbr title=" 397                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrl());"> 397                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrlðŸ”µ</abbr></span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 398                 clipboard.setPrimaryClip(clip);                                                          </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 399                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 399                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 401         });                                                                                              </span>
<span  style=""> 402                                                                                                          </span>
<span class="7858974346508965340" onmouseenter="enter('7858974346508965340');" onmouseout="out('7858974346508965340');" style=""> 403         publishShareButton.setOnClickListener(new View.OnClickListener() {                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 404             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 405             public void onClick(View v) {                                                                </span>
<span class="-1084258541936962831" onmouseenter="enter('-1084258541936962831');" onmouseout="out('-1084258541936962831');" style=""> 406                 Intent i = new Intent(Intent.ACTION_SEND);                                               </span>
<span class="-4820203166518762252" onmouseenter="enter('-4820203166518762252');" onmouseout="out('-4820203166518762252');" style=""> 407                 i.setType(&quot;text/plain&quot;);                                                                 </span>
<span class="-6000923337939610903" onmouseenter="enter('-6000923337939610903');" onmouseout="out('-6000923337939610903');" style=""> 408                 i.putExtra(Intent.EXTRA_TEXT, mNote.getPublishedUrl());                                  </span>
<span class="3733331565586339944" onmouseenter="enter('3733331565586339944');" onmouseout="out('3733331565586339944');" style=""> 409                 startActivity(Intent.createChooser(i, getString(R.string.share_url)));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 411         });                                                                                              </span>
<span  style=""> 412                                                                                                          </span>
<span class="-2067876314787213528" onmouseenter="enter('-2067876314787213528');" onmouseout="out('-2067876314787213528');" style=""> 413         updateWordCount(wordCountTextView);                                                              </span>
<span  style=""> 414                                                                                                          </span>
<span class="-1365615346790030662" onmouseenter="enter('-1365615346790030662');" onmouseout="out('-1365615346790030662');" style=""> 415         if (mNote.isPublished()) {                                                                       </span>
<span class="-8174565940676304202" onmouseenter="enter('-8174565940676304202');" onmouseout="out('-8174565940676304202');" style=""> 416             publishButtonTextView.setText(getString(R.string.published));                                </span>
<span class="8297531220637406295" onmouseenter="enter('8297531220637406295');" onmouseout="out('8297531220637406295');" style=""> 417             publishButtonIcon.setVisibility(View.VISIBLE);                                               </span>
<span class="-2988513566372186325" onmouseenter="enter('-2988513566372186325');" onmouseout="out('-2988513566372186325');" style=""> 418             publishTextView.setText(mNote.getPublishedUrl());                                            </span>
<span class="6413899042811805294" onmouseenter="enter('6413899042811805294');" onmouseout="out('6413899042811805294');" style=""> 419             actionsView.setVisibility(View.VISIBLE);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 420         } else {                                                                                         </span>
<span class="843719504642786212" onmouseenter="enter('843719504642786212');" onmouseout="out('843719504642786212');" style=""> 421             publishButtonTextView.setText(getString(R.string.publish));                                  </span>
<span class="-2250731724671553485" onmouseenter="enter('-2250731724671553485');" onmouseout="out('-2250731724671553485');" style=""> 422             publishButtonIcon.setVisibility(View.GONE);                                                  </span>
<span class="1035970444036754268" onmouseenter="enter('1035970444036754268');" onmouseout="out('1035970444036754268');" style=""> 423             actionsView.setVisibility(View.GONE);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424         }                                                                                                </span>
<span  style=""> 425                                                                                                          </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 426         Simplenote currentApp = (Simplenote) getActivity().getApplication();                             </span>
<span class="-1805411858302537149" onmouseenter="enter('-1805411858302537149');" onmouseout="out('-1805411858302537149');" style=""> 427         if (currentApp.getSimperium().needsAuthorization()) {                                            </span>
<span class="5338357254244494547" onmouseenter="enter('5338357254244494547');" onmouseout="out('5338357254244494547');" style=""> 428             viewSwitcher.setVisibility(View.GONE);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 429         } else {                                                                                         </span>
<span class="4598892846854382425" onmouseenter="enter('4598892846854382425');" onmouseout="out('4598892846854382425');" style=""> 430             viewSwitcher.setVisibility(View.VISIBLE);                                                    </span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 431             if (viewSwitcher.getDisplayedChild() == 1) {                                                 </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 432                 viewSwitcher.showPrevious();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435     }                                                                                                    </span>
<span  style=""> 436                                                                                                          </span>
<span class="2878966018694925493" onmouseenter="enter('2878966018694925493');" onmouseout="out('2878966018694925493');" style=""> 437     private boolean noteIsEmpty() {                                                                      </span>
<span class="5142306291108152313" onmouseenter="enter('5142306291108152313');" onmouseout="out('5142306291108152313');" style=""> 438         return (getNoteContentString().trim().length() == 0 &amp;&amp; getNoteTagsString().trim().length() == 0);</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439     }                                                                                                    </span>
<span  style=""> 440                                                                                                          </span>
<span class="8710628914141899315" onmouseenter="enter('8710628914141899315');" onmouseout="out('8710628914141899315');" style=""> 441     public void setNote(String noteID){                                                                  </span>
<span class="-6972394152055286124" onmouseenter="enter('-6972394152055286124');" onmouseout="out('-6972394152055286124');" style=""> 442         setNote(noteID, null);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443     }                                                                                                    </span>
<span  style=""> 444                                                                                                          </span>
<span class="8195105300246755684" onmouseenter="enter('8195105300246755684');" onmouseout="out('8195105300246755684');" style=""> 445     public void setNote(String noteID, String matchOffsets) {                                            </span>
<span class="-3646372507164546123" onmouseenter="enter('-3646372507164546123');" onmouseout="out('-3646372507164546123');" style=""> 446         if (mAutoSaveHandler != null)                                                                    </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 447             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span  style=""> 448                                                                                                          </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 449         mPlaceholderView.setVisibility(View.GONE);                                                       </span>
<span  style=""> 450                                                                                                          </span>
<span class="2077738191995360697" onmouseenter="enter('2077738191995360697');" onmouseout="out('2077738191995360697');" style=""> 451         if (matchOffsets != null)                                                                        </span>
<span class="76822769413740338" onmouseenter="enter('76822769413740338');" onmouseout="out('76822769413740338');" style=""> 452             mMatchOffsets = matchOffsets;                                                                </span>
<span  style=""> 453                                                                                                          </span>
<span class="-4019470309104916899" onmouseenter="enter('-4019470309104916899');" onmouseout="out('-4019470309104916899');" style=""> 454         // If we have a note already (on a tablet in landscape), save the note.                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 455         if (mNote != null) {                                                                             </span>
<span class="4900947620417658692" onmouseenter="enter('4900947620417658692');" onmouseout="out('4900947620417658692');" style=""> 456             if (mIsNewNote &amp;&amp; noteIsEmpty())                                                             </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 457                 mNote.delete();                                                                          </span>
<span class="-2440894158330100228" onmouseenter="enter('-2440894158330100228');" onmouseout="out('-2440894158330100228');" style=""> 458             else if (mNote != null)                                                                      </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 459                 saveNote();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460         }                                                                                                </span>
<span  style=""> 461                                                                                                          </span>
<span class="-3492920802008394842" onmouseenter="enter('-3492920802008394842');" onmouseout="out('-3492920802008394842');" style=""> 462         new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, noteID);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 463     }                                                                                                    </span>
<span  style=""> 464                                                                                                          </span>
<span class="-3433185850424102984" onmouseenter="enter('-3433185850424102984');" onmouseout="out('-3433185850424102984');" style=""> 465     public void updateNote(Note updatedNote) {                                                           </span>
<span class="1053945494720623403" onmouseenter="enter('1053945494720623403');" onmouseout="out('1053945494720623403');" style=""> 466         // update note if network change arrived                                                         </span>
<span class="8715526790189509580" onmouseenter="enter('8715526790189509580');" onmouseout="out('8715526790189509580');" style=""> 467         mNote = updatedNote;                                                                             </span>
<span class="-1082183570760036139" onmouseenter="enter('-1082183570760036139');" onmouseout="out('-1082183570760036139');" style=""> 468         refreshContent(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469     }                                                                                                    </span>
<span  style=""> 470                                                                                                          </span>
<span class="-5323752859114125708" onmouseenter="enter('-5323752859114125708');" onmouseout="out('-5323752859114125708');" style=""> 471     public void refreshContent(boolean isNoteUpdate) {                                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 472         if (mNote != null) {                                                                             </span>
<span class="9083634457699551889" onmouseenter="enter('9083634457699551889');" onmouseout="out('9083634457699551889');" style=""> 473             // Restore the cursor position if possible.                                                  </span>
<span  style=""> 474                                                                                                          </span>
<span class="-3899995221280134201" onmouseenter="enter('-3899995221280134201');" onmouseout="out('-3899995221280134201');" style=""><abbr title=" 475             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.getSelectionEnd());"> 475             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEdðŸ”µ</abbr></span>
<span  style=""> 476                                                                                                          </span>
<span class="4148799213240179760" onmouseenter="enter('4148799213240179760');" onmouseout="out('4148799213240179760');" style=""> 477             mContentEditText.setText(mNote.getContent());                                                </span>
<span  style=""> 478                                                                                                          </span>
<span class="2353268123342341866" onmouseenter="enter('2353268123342341866');" onmouseout="out('2353268123342341866');" style=""> 479             if (isNoteUpdate) {                                                                          </span>
<span class="-1678402685678405938" onmouseenter="enter('-1678402685678405938');" onmouseout="out('-1678402685678405938');" style=""> 480                 // Save the note so any local changes get synced                                         </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 481                 mNote.save();                                                                            </span>
<span  style=""> 482                                                                                                          </span>
<span class="-5094013145931261947" onmouseenter="enter('-5094013145931261947');" onmouseout="out('-5094013145931261947');" style=""><abbr title=" 483                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) {"> 483                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) ðŸ”µ</abbr></span>
<span class="2096054726124109686" onmouseenter="enter('2096054726124109686');" onmouseout="out('2096054726124109686');" style=""> 484                     mContentEditText.setSelection(cursorPosition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486             }                                                                                            </span>
<span  style=""> 487                                                                                                          </span>
<span class="-2853209662220592982" onmouseenter="enter('-2853209662220592982');" onmouseout="out('-2853209662220592982');" style=""> 488             afterTextChanged(mContentEditText.getText());                                                </span>
<span  style=""> 489                                                                                                          </span>
<span class="8723833736514346639" onmouseenter="enter('8723833736514346639');" onmouseout="out('8723833736514346639');" style=""> 490             mPinButton.setChecked(mNote.isPinned());                                                     </span>
<span  style=""> 491                                                                                                          </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 492             updateTagList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494     }                                                                                                    </span>
<span  style=""> 495                                                                                                          </span>
<span class="-5496131723873966197" onmouseenter="enter('-5496131723873966197');" onmouseout="out('-5496131723873966197');" style=""> 496     public void updateTagList() {                                                                        </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 497         Activity activity = getActivity();                                                               </span>
<span class="5732290278551506292" onmouseenter="enter('5732290278551506292');" onmouseout="out('5732290278551506292');" style=""> 498         if (activity == null) return;                                                                    </span>
<span  style=""> 499                                                                                                          </span>
<span class="-8748481830530330770" onmouseenter="enter('-8748481830530330770');" onmouseout="out('-8748481830530330770');" style=""> 500         // Populate this note&#x27;s tags in the tagView                                                      </span>
<span class="-3805230291902185366" onmouseenter="enter('-3805230291902185366');" onmouseout="out('-3805230291902185366');" style=""> 501         mTagView.setChips(mNote.getTagString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502     }                                                                                                    </span>
<span  style=""> 503                                                                                                          </span>
<span class="-3598917219400102100" onmouseenter="enter('-3598917219400102100');" onmouseout="out('-3598917219400102100');" style=""> 504     int newCursorLocation(String newText, String oldText, int cursorLocation) {                          </span>
<span class="9215253731107462720" onmouseenter="enter('9215253731107462720');" onmouseout="out('9215253731107462720');" style=""> 505         // Ported from the iOS app :)                                                                    </span>
<span class="746416875920517525" onmouseenter="enter('746416875920517525');" onmouseout="out('746416875920517525');" style=""> 506         // Cases:                                                                                        </span>
<span class="5532692154938930485" onmouseenter="enter('5532692154938930485');" onmouseout="out('5532692154938930485');" style=""> 507         // 0. All text after cursor (and possibly more) was removed ==&gt; put cursor at end                </span>
<span class="7679522442911259243" onmouseenter="enter('7679522442911259243');" onmouseout="out('7679522442911259243');" style=""> 508         // 1. Text was added after the cursor ==&gt; no change                                              </span>
<span class="-7894032746042607578" onmouseenter="enter('-7894032746042607578');" onmouseout="out('-7894032746042607578');" style=""> 509         // 2. Text was added before the cursor ==&gt; location advances                                     </span>
<span class="-2716138352653500367" onmouseenter="enter('-2716138352653500367');" onmouseout="out('-2716138352653500367');" style=""> 510         // 3. Text was removed after the cursor ==&gt; no change                                            </span>
<span class="-5135222146548415418" onmouseenter="enter('-5135222146548415418');" onmouseout="out('-5135222146548415418');" style=""> 511         // 4. Text was removed before the cursor ==&gt; location retreats                                   </span>
<span class="-7558810491072030947" onmouseenter="enter('-7558810491072030947');" onmouseout="out('-7558810491072030947');" style=""> 512         // 5. Text was added/removed on both sides of the cursor ==&gt; not handled                         </span>
<span  style=""> 513                                                                                                          </span>
<span class="2494517364842646163" onmouseenter="enter('2494517364842646163');" onmouseout="out('2494517364842646163');" style=""> 514         int newCursorLocation = cursorLocation;                                                          </span>
<span  style=""> 515                                                                                                          </span>
<span class="5908042661332565473" onmouseenter="enter('5908042661332565473');" onmouseout="out('5908042661332565473');" style=""> 516         int deltaLength = newText.length() - oldText.length();                                           </span>
<span  style=""> 517                                                                                                          </span>
<span class="-6285488792309831531" onmouseenter="enter('-6285488792309831531');" onmouseout="out('-6285488792309831531');" style=""> 518         // Case 0                                                                                        </span>
<span class="-3414403190560247865" onmouseenter="enter('-3414403190560247865');" onmouseout="out('-3414403190560247865');" style=""> 519         if (newText.length() &lt; cursorLocation)                                                           </span>
<span class="-8431314608568195365" onmouseenter="enter('-8431314608568195365');" onmouseout="out('-8431314608568195365');" style=""> 520             return newText.length();                                                                     </span>
<span  style=""> 521                                                                                                          </span>
<span class="-8591384106259708496" onmouseenter="enter('-8591384106259708496');" onmouseout="out('-8591384106259708496');" style=""> 522         boolean beforeCursorMatches = false;                                                             </span>
<span class="-2836779116340504068" onmouseenter="enter('-2836779116340504068');" onmouseout="out('-2836779116340504068');" style=""> 523         boolean afterCursorMatches = false;                                                              </span>
<span  style=""> 524                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 525         try {                                                                                            </span>
<span class="535177221055952012" onmouseenter="enter('535177221055952012');" onmouseout="out('535177221055952012');" style=""><abbr title=" 526             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation));"> 526             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorðŸ”µ</abbr></span>
<span class="-6954326744185480821" onmouseenter="enter('-6954326744185480821');" onmouseout="out('-6954326744185480821');" style=""><abbr title=" 527             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursorLocation + deltaLength, newText.length()));"> 527             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 528         } catch (Exception e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 529             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 530         }                                                                                                </span>
<span  style=""> 531                                                                                                          </span>
<span class="-8188204612528872149" onmouseenter="enter('-8188204612528872149');" onmouseout="out('-8188204612528872149');" style=""> 532         // Cases 2 and 4                                                                                 </span>
<span class="6616414540674367624" onmouseenter="enter('6616414540674367624');" onmouseout="out('6616414540674367624');" style=""> 533         if (!beforeCursorMatches &amp;&amp; afterCursorMatches)                                                  </span>
<span class="-4510977125628343614" onmouseenter="enter('-4510977125628343614');" onmouseout="out('-4510977125628343614');" style=""> 534             newCursorLocation += deltaLength;                                                            </span>
<span  style=""> 535                                                                                                          </span>
<span class="6867115481875645839" onmouseenter="enter('6867115481875645839');" onmouseout="out('6867115481875645839');" style=""> 536         // Cases 1, 3 and 5 have no change                                                               </span>
<span class="-7784410696724573059" onmouseenter="enter('-7784410696724573059');" onmouseout="out('-7784410696724573059');" style=""> 537         return newCursorLocation;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 538     }                                                                                                    </span>
<span  style=""> 539                                                                                                          </span>
<span class="-4880079435078668080" onmouseenter="enter('-4880079435078668080');" onmouseout="out('-4880079435078668080');" style=""> 540     private Runnable mAutoSaveRunnable = new Runnable() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 541         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 542         public void run() {                                                                              </span>
<span class="-2186856349666885424" onmouseenter="enter('-2186856349666885424');" onmouseout="out('-2186856349666885424');" style=""> 543             saveAndSyncNote();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 544         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 545     };                                                                                                   </span>
<span  style=""> 546                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 547     @Override                                                                                            </span>
<span class="-2796122281296135687" onmouseenter="enter('-2796122281296135687');" onmouseout="out('-2796122281296135687');" style=""> 548     public void onTagsChanged(String tagString) {                                                        </span>
<span class="5357705753761437027" onmouseenter="enter('5357705753761437027');" onmouseout="out('5357705753761437027');" style=""> 549         if (mNote == null || !isAdded()) return;                                                         </span>
<span  style=""> 550                                                                                                          </span>
<span class="-6077287130430406243" onmouseenter="enter('-6077287130430406243');" onmouseout="out('-6077287130430406243');" style=""> 551         if (mNote.getTagString() != null &amp;&amp; tagString.length() &gt; mNote.getTagString().length()) {        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 552             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 553                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 554                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="5410511239462362052" onmouseenter="enter('5410511239462362052');" onmouseout="out('5410511239462362052');" style=""> 555                             .setAction(&quot;added_tag&quot;)                                                      </span>
<span class="-4831158292382506824" onmouseenter="enter('-4831158292382506824');" onmouseout="out('-4831158292382506824');" style=""> 556                             .setLabel(&quot;tag_added_to_note&quot;)                                               </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 557                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 558             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559         }                                                                                                </span>
<span class="4391598042186419731" onmouseenter="enter('4391598042186419731');" onmouseout="out('4391598042186419731');" style=""> 560         else {                                                                                           </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 561             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 562                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 563                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="-1624008121867682947" onmouseenter="enter('-1624008121867682947');" onmouseout="out('-1624008121867682947');" style=""> 564                             .setAction(&quot;removed_tag&quot;)                                                    </span>
<span class="-6979485583008136850" onmouseenter="enter('-6979485583008136850');" onmouseout="out('-6979485583008136850');" style=""> 565                             .setLabel(&quot;tag_removed_from_note&quot;)                                           </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 566                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 567             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568         }                                                                                                </span>
<span  style=""> 569                                                                                                          </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 570         mNote.setTagString(tagString);                                                                   </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 571         mNote.setModificationDate(Calendar.getInstance());                                               </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 572         updateTagList();                                                                                 </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 573         mNote.save();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 574     }                                                                                                    </span>
<span  style=""> 575                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 576     @Override                                                                                            </span>
<span class="-5110897291356760413" onmouseenter="enter('-5110897291356760413');" onmouseout="out('-5110897291356760413');" style=""> 577     public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {                    </span>
<span class="7490540504293754116" onmouseenter="enter('7490540504293754116');" onmouseout="out('7490540504293754116');" style=""> 578         // Unused                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579     }                                                                                                    </span>
<span  style=""> 580                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 581     @Override                                                                                            </span>
<span class="-3169498224421089624" onmouseenter="enter('-3169498224421089624');" onmouseout="out('-3169498224421089624');" style=""> 582     public void afterTextChanged(Editable editable) {                                                    </span>
<span class="7005237563799171506" onmouseenter="enter('7005237563799171506');" onmouseout="out('7005237563799171506');" style=""> 583         setTitleSpan(editable);                                                                          </span>
<span class="4641646211430236365" onmouseenter="enter('4641646211430236365');" onmouseout="out('4641646211430236365');" style=""> 584         attemptAutoList(editable);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585     }                                                                                                    </span>
<span  style=""> 586                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 587     @Override                                                                                            </span>
<span class="-6004971105578563950" onmouseenter="enter('-6004971105578563950');" onmouseout="out('-6004971105578563950');" style=""> 588     public void onTextChanged(CharSequence charSequence, int start, int before, int count) {             </span>
<span  style=""> 589                                                                                                          </span>
<span class="2036741165452809133" onmouseenter="enter('2036741165452809133');" onmouseout="out('2036741165452809133');" style=""> 590         // When text changes, start timer that will fire after AUTOSAVE_DELAY_MILLIS passes              </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 591         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 592             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="3237260668993885548" onmouseenter="enter('3237260668993885548');" onmouseout="out('3237260668993885548');" style=""> 593             mAutoSaveHandler.postDelayed(mAutoSaveRunnable, AUTOSAVE_DELAY_MILLIS);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594         }                                                                                                </span>
<span  style=""> 595                                                                                                          </span>
<span class="5409551732025834677" onmouseenter="enter('5409551732025834677');" onmouseout="out('5409551732025834677');" style=""> 596         // Remove search highlight spans when note content changes                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 597         if (mMatchOffsets != null) {                                                                     </span>
<span class="-5254682256162211718" onmouseenter="enter('-5254682256162211718');" onmouseout="out('-5254682256162211718');" style=""> 598             mMatchOffsets = null;                                                                        </span>
<span class="2930846742809702691" onmouseenter="enter('2930846742809702691');" onmouseout="out('2930846742809702691');" style=""> 599             mHighlighter.removeMatches();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601     }                                                                                                    </span>
<span  style=""> 602                                                                                                          </span>
<span class="6849776144692122373" onmouseenter="enter('6849776144692122373');" onmouseout="out('6849776144692122373');" style=""> 603     private void setTitleSpan(Editable editable) {                                                       </span>
<span class="-1378972571136516392" onmouseenter="enter('-1378972571136516392');" onmouseout="out('-1378972571136516392');" style=""> 604         // Set the note title to be a larger size                                                        </span>
<span class="3997786880116952820" onmouseenter="enter('3997786880116952820');" onmouseout="out('3997786880116952820');" style=""> 605         // Remove any existing size spans                                                                </span>
<span class="-8972916714996192672" onmouseenter="enter('-8972916714996192672');" onmouseout="out('-8972916714996192672');" style=""> 606         RelativeSizeSpan spans[] = editable.getSpans(0, editable.length(), RelativeSizeSpan.class);      </span>
<span class="2386014209880419735" onmouseenter="enter('2386014209880419735');" onmouseout="out('2386014209880419735');" style=""> 607         for (RelativeSizeSpan span : spans) {                                                            </span>
<span class="-4538099325482792099" onmouseenter="enter('-4538099325482792099');" onmouseout="out('-4538099325482792099');" style=""> 608             editable.removeSpan(span);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 609         }                                                                                                </span>
<span class="-901734861574280266" onmouseenter="enter('-901734861574280266');" onmouseout="out('-901734861574280266');" style=""> 610         int newLinePosition = getNoteContentString().indexOf(&quot;\n&quot;);                                      </span>
<span class="-2560738681101946885" onmouseenter="enter('-2560738681101946885');" onmouseout="out('-2560738681101946885');" style=""> 611         if (newLinePosition == 0)                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 612             return;                                                                                      </span>
<span class="-2775800673646162791" onmouseenter="enter('-2775800673646162791');" onmouseout="out('-2775800673646162791');" style=""><abbr title=" 613         editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 613         editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614     }                                                                                                    </span>
<span  style=""> 615                                                                                                          </span>
<span class="8395667075038215241" onmouseenter="enter('8395667075038215241');" onmouseout="out('8395667075038215241');" style=""> 616     private void attemptAutoList(Editable editable) {                                                    </span>
<span class="1630313539519665774" onmouseenter="enter('1630313539519665774');" onmouseout="out('1630313539519665774');" style=""> 617         int oldCursorPosition = mCurrentCursorPosition;                                                  </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 618         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="-1456162723219098064" onmouseenter="enter('-1456162723219098064');" onmouseout="out('-1456162723219098064');" style=""> 619         AutoBullet.apply(editable, oldCursorPosition, mCurrentCursorPosition);                           </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 620         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="6723912502491086435" onmouseenter="enter('6723912502491086435');" onmouseout="out('6723912502491086435');" style=""> 621         android.util.Log.d(&quot;Simplenote&quot;, &quot;==&gt; post cursor position:&quot; + mCurrentCursorPosition);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 622     }                                                                                                    </span>
<span  style=""> 623                                                                                                          </span>
<span class="-6933317077070028336" onmouseenter="enter('-6933317077070028336');" onmouseout="out('-6933317077070028336');" style=""> 624     private void saveAndSyncNote() {                                                                     </span>
<span class="8223376420483055518" onmouseenter="enter('8223376420483055518');" onmouseout="out('8223376420483055518');" style=""> 625         if (mNote == null)                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 626             return;                                                                                      </span>
<span  style=""> 627                                                                                                          </span>
<span class="5987107161692050970" onmouseenter="enter('5987107161692050970');" onmouseout="out('5987107161692050970');" style=""> 628         new saveNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629     }                                                                                                    </span>
<span  style=""> 630                                                                                                          </span>
<span class="-4564004023547017377" onmouseenter="enter('-4564004023547017377');" onmouseout="out('-4564004023547017377');" style=""> 631     public void setPlaceholderVisible(boolean isVisible) {                                               </span>
<span class="-6467031518050872536" onmouseenter="enter('-6467031518050872536');" onmouseout="out('-6467031518050872536');" style=""> 632         if (isVisible) {                                                                                 </span>
<span class="1687907534970456445" onmouseenter="enter('1687907534970456445');" onmouseout="out('1687907534970456445');" style=""> 633             mNote = null;                                                                                </span>
<span class="-3407359796970873837" onmouseenter="enter('-3407359796970873837');" onmouseout="out('-3407359796970873837');" style=""> 634             mContentEditText.setText(&quot;&quot;);                                                                </span>
<span class="-7997465605671669559" onmouseenter="enter('-7997465605671669559');" onmouseout="out('-7997465605671669559');" style=""> 635             mTagView.setText(&quot;&quot;);                                                                        </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 636             if (mPlaceholderView != null)                                                                </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 637                 mPlaceholderView.setVisibility(View.VISIBLE);                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 638         } else {                                                                                         </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 639             if (mPlaceholderView != null)                                                                </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 640                 mPlaceholderView.setVisibility(View.GONE);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 641         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642     }                                                                                                    </span>
<span  style=""> 643                                                                                                          </span>
<span class="7106522413253020021" onmouseenter="enter('7106522413253020021');" onmouseout="out('7106522413253020021');" style=""> 644     public void setIsNewNote(boolean isNewNote) {                                                        </span>
<span class="-5949421386499580587" onmouseenter="enter('-5949421386499580587');" onmouseout="out('-5949421386499580587');" style=""> 645         this.mIsNewNote = isNewNote;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 646     }                                                                                                    </span>
<span  style=""> 647                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 648     @Override                                                                                            </span>
<span class="-3315120631467309087" onmouseenter="enter('-3315120631467309087');" onmouseout="out('-3315120631467309087');" style=""> 649     public void onFocusChange(View v, boolean hasFocus) {                                                </span>
<span class="-6285712256166584728" onmouseenter="enter('-6285712256166584728');" onmouseout="out('-6285712256166584728');" style=""> 650         if (!hasFocus) {                                                                                 </span>
<span class="-6666174322440118634" onmouseenter="enter('-6666174322440118634');" onmouseout="out('-6666174322440118634');" style=""> 651             String tagString = getNoteTagsString().trim();                                               </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 652             if (tagString.length() &gt; 0) {                                                                </span>
<span class="8488340728323435918" onmouseenter="enter('8488340728323435918');" onmouseout="out('8488340728323435918');" style=""> 653                 mTagView.setChips(tagString);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 654             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 655         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 656     }                                                                                                    </span>
<span  style=""> 657                                                                                                          </span>
<span class="-6849832043716883515" onmouseenter="enter('-6849832043716883515');" onmouseout="out('-6849832043716883515');" style=""> 658     public Note getNote() {                                                                              </span>
<span class="6687317620803594982" onmouseenter="enter('6687317620803594982');" onmouseout="out('6687317620803594982');" style=""> 659         return mNote;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660     }                                                                                                    </span>
<span  style=""> 661                                                                                                          </span>
<span class="5855058962481175207" onmouseenter="enter('5855058962481175207');" onmouseout="out('5855058962481175207');" style=""> 662     public String getNoteContentString() {                                                               </span>
<span class="-8451380960236704581" onmouseenter="enter('-8451380960236704581');" onmouseout="out('-8451380960236704581');" style=""> 663         if (mContentEditText == null || mContentEditText.getText() == null) {                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 664             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 665         } else {                                                                                         </span>
<span class="9069870454824528783" onmouseenter="enter('9069870454824528783');" onmouseout="out('9069870454824528783');" style=""> 666             return mContentEditText.getText().toString();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 668     }                                                                                                    </span>
<span  style=""> 669                                                                                                          </span>
<span class="2486113532203564324" onmouseenter="enter('2486113532203564324');" onmouseout="out('2486113532203564324');" style=""> 670     public String getNoteTagsString() {                                                                  </span>
<span class="2201751553125502793" onmouseenter="enter('2201751553125502793');" onmouseout="out('2201751553125502793');" style=""> 671         if (mTagView == null || mTagView.getText() == null) {                                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 672             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 673         } else {                                                                                         </span>
<span class="-3768945108519459655" onmouseenter="enter('-3768945108519459655');" onmouseout="out('-3768945108519459655');" style=""> 674             return mTagView.getText().toString();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 675         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 676     }                                                                                                    </span>
<span  style=""> 677                                                                                                          </span>
<span class="4832835199818847464" onmouseenter="enter('4832835199818847464');" onmouseout="out('4832835199818847464');" style=""> 678     private class loadNoteTask extends AsyncTask&lt;String, Void, Void&gt; {                                   </span>
<span  style=""> 679                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 680         @Override                                                                                        </span>
<span class="-2143377957271683587" onmouseenter="enter('-2143377957271683587');" onmouseout="out('-2143377957271683587');" style=""> 681         protected void onPreExecute() {                                                                  </span>
<span class="-4476633077483558762" onmouseenter="enter('-4476633077483558762');" onmouseout="out('-4476633077483558762');" style=""> 682             mContentEditText.removeTextChangedListener(NoteEditorFragment.this);                         </span>
<span class="1885380990906425504" onmouseenter="enter('1885380990906425504');" onmouseout="out('1885380990906425504');" style=""> 683             mIsLoadingNote = true;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 684         }                                                                                                </span>
<span  style=""> 685                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 686         @Override                                                                                        </span>
<span class="2907103121668961470" onmouseenter="enter('2907103121668961470');" onmouseout="out('2907103121668961470');" style=""> 687         protected Void doInBackground(String... args) {                                                  </span>
<span class="-3170312762343778784" onmouseenter="enter('-3170312762343778784');" onmouseout="out('-3170312762343778784');" style=""> 688             if (getActivity() == null) {                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 689                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690             }                                                                                            </span>
<span  style=""> 691                                                                                                          </span>
<span class="-6905640337159350056" onmouseenter="enter('-6905640337159350056');" onmouseout="out('-6905640337159350056');" style=""> 692             String noteID = args[0];                                                                     </span>
<span class="5105206001451632901" onmouseenter="enter('5105206001451632901');" onmouseout="out('5105206001451632901');" style=""> 693             Simplenote application = (Simplenote) getActivity().getApplication();                        </span>
<span class="3820701427545927889" onmouseenter="enter('3820701427545927889');" onmouseout="out('3820701427545927889');" style=""> 694             Bucket&lt;Note&gt; notesBucket = application.getNotesBucket();                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 695             try {                                                                                        </span>
<span class="1900948898960959991" onmouseenter="enter('1900948898960959991');" onmouseout="out('1900948898960959991');" style=""> 696                 mNote = notesBucket.get(noteID);                                                         </span>
<span class="-8094446681246514952" onmouseenter="enter('-8094446681246514952');" onmouseout="out('-8094446681246514952');" style=""> 697                 // Set the current note in NotesActivity when on a tablet                                </span>
<span class="-4385871719572971359" onmouseenter="enter('-4385871719572971359');" onmouseout="out('-4385871719572971359');" style=""> 698                 if (getActivity() instanceof NotesActivity) {                                            </span>
<span class="-5437998525889410543" onmouseenter="enter('-5437998525889410543');" onmouseout="out('-5437998525889410543');" style=""> 699                     ((NotesActivity) getActivity()).setCurrentNote(mNote);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 700                 }                                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 701             } catch (BucketObjectMissingException e) {                                                   </span>
<span class="9016552103124647674" onmouseenter="enter('9016552103124647674');" onmouseout="out('9016552103124647674');" style=""> 702                 // TODO: Handle a missing note                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 703             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 704             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 705         }                                                                                                </span>
<span  style=""> 706                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 707         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 708         protected void onPostExecute(Void nada) {                                                        </span>
<span class="3019142402664254149" onmouseenter="enter('3019142402664254149');" onmouseout="out('3019142402664254149');" style=""> 709             if (getActivity() == null || getActivity().isFinishing())                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 710                 return;                                                                                  </span>
<span class="-2770512784578238911" onmouseenter="enter('-2770512784578238911');" onmouseout="out('-2770512784578238911');" style=""> 711             refreshContent(false);                                                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 712             if (mMatchOffsets != null) {                                                                 </span>
<span class="4645759725865606036" onmouseenter="enter('4645759725865606036');" onmouseout="out('4645759725865606036');" style=""><abbr title=" 713                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROPERTY);"> 713                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.COðŸ”µ</abbr></span>
<span class="1514128940236991067" onmouseenter="enter('1514128940236991067');" onmouseout="out('1514128940236991067');" style=""> 714                 mHighlighter.highlightMatches(mMatchOffsets, columnIndex);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715             }                                                                                            </span>
<span class="2908988742356344281" onmouseenter="enter('2908988742356344281');" onmouseout="out('2908988742356344281');" style=""> 716             mContentEditText.addTextChangedListener(NoteEditorFragment.this);                            </span>
<span class="1726616917938037339" onmouseenter="enter('1726616917938037339');" onmouseout="out('1726616917938037339');" style=""> 717             if (mNote != null &amp;&amp; mNote.getContent().isEmpty()) {                                         </span>
<span class="-7639034409774462373" onmouseenter="enter('-7639034409774462373');" onmouseout="out('-7639034409774462373');" style=""> 718                 // Show soft keyboard                                                                    </span>
<span class="-5568483982770704985" onmouseenter="enter('-5568483982770704985');" onmouseout="out('-5568483982770704985');" style=""> 719                 mContentEditText.requestFocus();                                                         </span>
<span class="7162501222170899627" onmouseenter="enter('7162501222170899627');" onmouseout="out('7162501222170899627');" style=""> 720                 new Handler().postDelayed(new Runnable() {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 721                     @Override                                                                            </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 722                     public void run() {                                                                  </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 723                         InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 723                         InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSysðŸ”µ</abbr></span>
<span class="-1476760297763804327" onmouseenter="enter('-1476760297763804327');" onmouseout="out('-1476760297763804327');" style=""> 724                         if (inputMethodManager != null)                                                  </span>
<span class="7954226653587797662" onmouseenter="enter('7954226653587797662');" onmouseout="out('7954226653587797662');" style=""> 725                             inputMethodManager.showSoftInput(mContentEditText, 0);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 726                     }                                                                                    </span>
<span class="-4884776244894547305" onmouseenter="enter('-4884776244894547305');" onmouseout="out('-4884776244894547305');" style=""> 727                 }, 100);                                                                                 </span>
<span  style=""> 728                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 729             }                                                                                            </span>
<span  style=""> 730                                                                                                          </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 731             SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                   </span>
<span  style=""> 732                                                                                                          </span>
<span class="2296161227930019578" onmouseenter="enter('2296161227930019578');" onmouseout="out('2296161227930019578');" style=""> 733             mIsLoadingNote = false;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 734         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 735     }                                                                                                    </span>
<span  style=""> 736                                                                                                          </span>
<span class="-8015309924985109245" onmouseenter="enter('-8015309924985109245');" onmouseout="out('-8015309924985109245');" style=""> 737     private class saveNoteTask extends AsyncTask&lt;Void, Void, Void&gt; {                                     </span>
<span  style=""> 738                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 739         @Override                                                                                        </span>
<span class="1259374977543247181" onmouseenter="enter('1259374977543247181');" onmouseout="out('1259374977543247181');" style=""> 740         protected Void doInBackground(Void... args) {                                                    </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 741             saveNote();                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 742             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743         }                                                                                                </span>
<span  style=""> 744                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 745         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 746         protected void onPostExecute(Void nada) {                                                        </span>
<span class="-8878355580113381449" onmouseenter="enter('-8878355580113381449');" onmouseout="out('-8878355580113381449');" style=""> 747             if (getActivity() != null &amp;&amp; !getActivity().isFinishing()) {                                 </span>
<span class="4157206213844518202" onmouseenter="enter('4157206213844518202');" onmouseout="out('4157206213844518202');" style=""> 748                 // Update links                                                                          </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 749                 SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 751         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 752     }                                                                                                    </span>
<span  style=""> 753                                                                                                          </span>
<span class="-2294831155573525866" onmouseenter="enter('-2294831155573525866');" onmouseout="out('-2294831155573525866');" style=""> 754     private void saveNote() {                                                                            </span>
<span class="-6566957513776356959" onmouseenter="enter('-6566957513776356959');" onmouseout="out('-6566957513776356959');" style=""> 755         if (mNote == null) {                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 756             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 757         }                                                                                                </span>
<span  style=""> 758                                                                                                          </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 759         String content = getNoteContentString();                                                         </span>
<span class="-8502490389039341280" onmouseenter="enter('-8502490389039341280');" onmouseout="out('-8502490389039341280');" style=""> 760         String tagString = getNoteTagsString();                                                          </span>
<span class="-8359444972541895470" onmouseenter="enter('-8359444972541895470');" onmouseout="out('-8359444972541895470');" style=""> 761         if (mNote.hasChanges(content, tagString.trim(), mPinButton.isChecked())) {                       </span>
<span class="843504871988910810" onmouseenter="enter('843504871988910810');" onmouseout="out('843504871988910810');" style=""> 762             mNote.setContent(content);                                                                   </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 763             mNote.setTagString(tagString);                                                               </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 764             mNote.setModificationDate(Calendar.getInstance());                                           </span>
<span class="-5430078119462356953" onmouseenter="enter('-5430078119462356953');" onmouseout="out('-5430078119462356953');" style=""> 765             // Send pinned event to google analytics if changed                                          </span>
<span class="-8280425794504398339" onmouseenter="enter('-8280425794504398339');" onmouseout="out('-8280425794504398339');" style=""> 766             mNote.setPinned(mPinButton.isChecked());                                                     </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 767             mNote.save();                                                                                </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 768             if (getActivity() != null) {                                                                 </span>
<span class="9119823558701234173" onmouseenter="enter('9119823558701234173');" onmouseout="out('9119823558701234173');" style=""> 769                 if (mNote.isPinned() != mPinButton.isChecked()) {                                        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 770                     mTracker.send(                                                                       </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 771                             new HitBuilders.EventBuilder()                                               </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 772                                     .setCategory(&quot;note&quot;)                                                 </span>
<span class="-653095590827548063" onmouseenter="enter('-653095590827548063');" onmouseout="out('-653095590827548063');" style=""><abbr title=" 773                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;)"> 773                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;ðŸ”µ</abbr></span>
<span class="4917363824063796296" onmouseenter="enter('4917363824063796296');" onmouseout="out('4917363824063796296');" style=""> 774                                     .setLabel(&quot;pin_button&quot;)                                              </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 775                                     .build()                                                             </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 776                     );                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 777                 }                                                                                        </span>
<span  style=""> 778                                                                                                          </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 779                 mTracker.send(                                                                           </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 780                         new HitBuilders.EventBuilder()                                                   </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 781                                 .setCategory(&quot;note&quot;)                                                     </span>
<span class="248231167587528808" onmouseenter="enter('248231167587528808');" onmouseout="out('248231167587528808');" style=""> 782                                 .setAction(&quot;edited_note&quot;)                                                </span>
<span class="5457290577030983699" onmouseenter="enter('5457290577030983699');" onmouseout="out('5457290577030983699');" style=""> 783                                 .setLabel(&quot;editor_save&quot;)                                                 </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 784                                 .build()                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 785                 );                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 786             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 787         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 788     }                                                                                                    </span>
<span  style=""> 789                                                                                                          </span>
<span class="9084056993766846780" onmouseenter="enter('9084056993766846780');" onmouseout="out('9084056993766846780');" style=""> 790     // Contextual action bar for dealing with links                                                      </span>
<span class="-23103958784499667" onmouseenter="enter('-23103958784499667');" onmouseout="out('-23103958784499667');" style=""> 791     private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {                        </span>
<span  style=""> 792                                                                                                          </span>
<span class="-5830922032047880245" onmouseenter="enter('-5830922032047880245');" onmouseout="out('-5830922032047880245');" style=""> 793         // Called when the action mode is created; startActionMode() was called                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 794         @Override                                                                                        </span>
<span class="6869646826473679297" onmouseenter="enter('6869646826473679297');" onmouseout="out('6869646826473679297');" style=""> 795         public boolean onCreateActionMode(ActionMode mode, Menu menu) {                                  </span>
<span class="-5328486553851934265" onmouseenter="enter('-5328486553851934265');" onmouseout="out('-5328486553851934265');" style=""> 796             // Inflate a menu resource providing context menu items                                      </span>
<span class="8164139660214751060" onmouseenter="enter('8164139660214751060');" onmouseout="out('8164139660214751060');" style=""> 797             MenuInflater inflater = mode.getMenuInflater();                                              </span>
<span class="-5537764272582475285" onmouseenter="enter('-5537764272582475285');" onmouseout="out('-5537764272582475285');" style=""> 798             if (inflater != null){                                                                       </span>
<span class="6552624979414277895" onmouseenter="enter('6552624979414277895');" onmouseout="out('6552624979414277895');" style=""> 799                 inflater.inflate(R.menu.view_link, menu);                                                </span>
<span class="2045169504868185532" onmouseenter="enter('2045169504868185532');" onmouseout="out('2045169504868185532');" style=""> 800                 mViewLinkMenuItem = menu.findItem(R.id.menu_view_link);                                  </span>
<span class="4190298810187820509" onmouseenter="enter('4190298810187820509');" onmouseout="out('4190298810187820509');" style=""> 801                 mode.setTitle(getString(R.string.link));                                                 </span>
<span class="9015861346770894985" onmouseenter="enter('9015861346770894985');" onmouseout="out('9015861346770894985');" style=""> 802                 if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {                </span>
<span class="-2927630225150463376" onmouseenter="enter('-2927630225150463376');" onmouseout="out('-2927630225150463376');" style=""> 803                     mode.setTitleOptionalHint(false);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 805             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 806             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 807         }                                                                                                </span>
<span  style=""> 808                                                                                                          </span>
<span class="-7885162724385925248" onmouseenter="enter('-7885162724385925248');" onmouseout="out('-7885162724385925248');" style=""> 809         // Called each time the action mode is shown. Always called after onCreateActionMode, but        </span>
<span class="6140331646129020842" onmouseenter="enter('6140331646129020842');" onmouseout="out('6140331646129020842');" style=""> 810         // may be called multiple times if the mode is invalidated.                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 811         @Override                                                                                        </span>
<span class="5392123371105216364" onmouseenter="enter('5392123371105216364');" onmouseout="out('5392123371105216364');" style=""> 812         public boolean onPrepareActionMode(ActionMode mode, Menu menu) {                                 </span>
<span class="9220029862843236189" onmouseenter="enter('9220029862843236189');" onmouseout="out('9220029862843236189');" style=""> 813             return false; // Return false if nothing is done                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 814         }                                                                                                </span>
<span  style=""> 815                                                                                                          </span>
<span class="-918812678605329556" onmouseenter="enter('-918812678605329556');" onmouseout="out('-918812678605329556');" style=""> 816         // Called when the user selects a contextual menu item                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 817         @Override                                                                                        </span>
<span class="816131742774025467" onmouseenter="enter('816131742774025467');" onmouseout="out('816131742774025467');" style=""> 818         public boolean onActionItemClicked(ActionMode mode, MenuItem item) {                             </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 819             switch (item.getItemId()) {                                                                  </span>
<span class="1241487664924667668" onmouseenter="enter('1241487664924667668');" onmouseout="out('1241487664924667668');" style=""> 820                 case R.id.menu_view_link:                                                                </span>
<span class="2689068574112651560" onmouseenter="enter('2689068574112651560');" onmouseout="out('2689068574112651560');" style=""> 821                     if (mLinkUrl != null) {                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 822                         try {                                                                            </span>
<span class="2961985398395482945" onmouseenter="enter('2961985398395482945');" onmouseout="out('2961985398395482945');" style=""> 823                             Uri uri = Uri.parse(mLinkUrl);                                               </span>
<span class="-3647274578727323622" onmouseenter="enter('-3647274578727323622');" onmouseout="out('-3647274578727323622');" style=""> 824                             Intent i = new Intent(Intent.ACTION_VIEW);                                   </span>
<span class="3545520342926402522" onmouseenter="enter('3545520342926402522');" onmouseout="out('3545520342926402522');" style=""> 825                             i.setData(uri);                                                              </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 826                             startActivity(i);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 827                         } catch (Exception e) {                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 828                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 829                         }                                                                                </span>
<span class="-5985541663234456921" onmouseenter="enter('-5985541663234456921');" onmouseout="out('-5985541663234456921');" style=""> 830                         mode.finish(); // Action picked, so close the CAB                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 831                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 832                     return true;                                                                         </span>
<span class="1323072004784584241" onmouseenter="enter('1323072004784584241');" onmouseout="out('1323072004784584241');" style=""> 833                 case R.id.menu_copy:                                                                     </span>
<span class="5917848124130151943" onmouseenter="enter('5917848124130151943');" onmouseout="out('5917848124130151943');" style=""> 834                     if (mLinkText != null &amp;&amp; getActivity() != null) {                                    </span>
<span class="-1800885668589834003" onmouseenter="enter('-1800885668589834003');" onmouseout="out('-1800885668589834003');" style=""><abbr title=" 835                         ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 835                         ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(ConðŸ”µ</abbr></span>
<span class="-1681747336188731628" onmouseenter="enter('-1681747336188731628');" onmouseout="out('-1681747336188731628');" style=""> 836                         ClipData clip = ClipData.newPlainText(getString(R.string.app_name),mLinkText);   </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 837                         clipboard.setPrimaryClip(clip);                                                  </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 838                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 838                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORTðŸ”µ</abbr></span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 839                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 840                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 841                     return true;                                                                         </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 842                 case R.id.menu_share:                                                                    </span>
<span class="-6928924091126055668" onmouseenter="enter('-6928924091126055668');" onmouseout="out('-6928924091126055668');" style=""> 843                     if (mLinkText != null) {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 844                         try {                                                                            </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 845                             Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);         </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 846                             shareIntent.setType(&quot;text/plain&quot;);                                           </span>
<span class="-5545338866841663037" onmouseenter="enter('-5545338866841663037');" onmouseout="out('-5545338866841663037');" style=""> 847                             shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mLinkText);          </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 848                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 848                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.stðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 849                         } catch (Exception e) {                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 850                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 851                         }                                                                                </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 852                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 853                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 854                     return true;                                                                         </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 855                 default:                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 856                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 857             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 858         }                                                                                                </span>
<span  style=""> 859                                                                                                          </span>
<span class="2525157012953828009" onmouseenter="enter('2525157012953828009');" onmouseout="out('2525157012953828009');" style=""> 860         // Called when the user exits the action mode                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 861         @Override                                                                                        </span>
<span class="-2232977199830239129" onmouseenter="enter('-2232977199830239129');" onmouseout="out('-2232977199830239129');" style=""> 862         public void onDestroyActionMode(ActionMode mode) {                                               </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 863             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 864         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 865     };                                                                                                   </span>
<span  style=""> 866                                                                                                          </span>
<span class="-6769383367293074987" onmouseenter="enter('-6769383367293074987');" onmouseout="out('-6769383367293074987');" style=""> 867     // Checks if cursor is at a URL when the selection changes                                           </span>
<span class="499820509706145242" onmouseenter="enter('499820509706145242');" onmouseout="out('499820509706145242');" style=""> 868     // If it is a URL, show the contextual action bar                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 869     @Override                                                                                            </span>
<span class="-6619706727651867065" onmouseenter="enter('-6619706727651867065');" onmouseout="out('-6619706727651867065');" style=""> 870     public void onSelectionChanged(int selStart, int selEnd) {                                           </span>
<span class="-5773931921061181239" onmouseenter="enter('-5773931921061181239');" onmouseout="out('-5773931921061181239');" style=""> 871         if (selStart == selEnd) {                                                                        </span>
<span class="-1073801886026856185" onmouseenter="enter('-1073801886026856185');" onmouseout="out('-1073801886026856185');" style=""> 872             Editable noteContent = mContentEditText.getText();                                           </span>
<span class="6562974929235397620" onmouseenter="enter('6562974929235397620');" onmouseout="out('6562974929235397620');" style=""> 873             if (noteContent == null)                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 874                 return;                                                                                  </span>
<span  style=""> 875                                                                                                          </span>
<span class="1258634593958745929" onmouseenter="enter('1258634593958745929');" onmouseout="out('1258634593958745929');" style=""> 876             URLSpan[] urlSpans = noteContent.getSpans(selStart, selStart, URLSpan.class);                </span>
<span class="8265917182779455796" onmouseenter="enter('8265917182779455796');" onmouseout="out('8265917182779455796');" style=""> 877             if (urlSpans.length &gt; 0) {                                                                   </span>
<span class="379938049561077801" onmouseenter="enter('379938049561077801');" onmouseout="out('379938049561077801');" style=""> 878                 URLSpan urlSpan = urlSpans[0];                                                           </span>
<span class="7382553573082356877" onmouseenter="enter('7382553573082356877');" onmouseout="out('7382553573082356877');" style=""> 879                 mLinkUrl = urlSpan.getURL();                                                             </span>
<span class="-2685141031372274993" onmouseenter="enter('-2685141031372274993');" onmouseout="out('-2685141031372274993');" style=""><abbr title=" 880                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSpan)).toString();"> 880                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpaðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 881                 if (mActionMode != null) {                                                               </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 882                     mActionMode.setSubtitle(mLinkText);                                                  </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 883                     setLinkMenuItem();                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 884                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 885                 }                                                                                        </span>
<span  style=""> 886                                                                                                          </span>
<span class="-4243988111679111503" onmouseenter="enter('-4243988111679111503');" onmouseout="out('-4243988111679111503');" style=""> 887                 // Show the Contextual Action Bar                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 888                 if (getActivity() != null) {                                                             </span>
<span class="-7108116137017669118" onmouseenter="enter('-7108116137017669118');" onmouseout="out('-7108116137017669118');" style=""><abbr title=" 889                     mActionMode = ((NoteEditorActivity)getActivity()).startSupportActionMode(mActionModeCallback);"> 889                     mActionMode = ((NoteEditorActivity)getActivity()).startSupportActionMode(mActionModeCðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 890                     if (mActionMode != null) {                                                           </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 891                         mActionMode.setSubtitle(mLinkText);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 892                     }                                                                                    </span>
<span  style=""> 893                                                                                                          </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 894                     setLinkMenuItem();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 895                 }                                                                                        </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 896             } else if (mActionMode != null) {                                                            </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 897                 mActionMode.finish();                                                                    </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 898                 mActionMode = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 899             }                                                                                            </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 900         } else if (mActionMode != null) {                                                                </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 901             mActionMode.finish();                                                                        </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 902             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 903         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 904     }                                                                                                    </span>
<span  style=""> 905                                                                                                          </span>
<span class="-1933854749523580289" onmouseenter="enter('-1933854749523580289');" onmouseout="out('-1933854749523580289');" style=""> 906     private void setLinkMenuItem() {                                                                     </span>
<span class="-4542884014549729251" onmouseenter="enter('-4542884014549729251');" onmouseout="out('-4542884014549729251');" style=""> 907         if (mViewLinkMenuItem != null &amp;&amp; mLinkUrl != null) {                                             </span>
<span class="7070835845876331574" onmouseenter="enter('7070835845876331574');" onmouseout="out('7070835845876331574');" style=""> 908             if (mLinkUrl.startsWith(&quot;tel:&quot;)) {                                                           </span>
<span class="4608769072092705594" onmouseenter="enter('4608769072092705594');" onmouseout="out('4608769072092705594');" style=""> 909                 mViewLinkMenuItem.setIcon(mCallIconResId);                                               </span>
<span class="-1045706461125369539" onmouseenter="enter('-1045706461125369539');" onmouseout="out('-1045706461125369539');" style=""> 910                 mViewLinkMenuItem.setTitle(getString(R.string.call));                                    </span>
<span class="-4087102511435152339" onmouseenter="enter('-4087102511435152339');" onmouseout="out('-4087102511435152339');" style=""> 911             } else if (mLinkUrl.startsWith(&quot;mailto:&quot;)) {                                                 </span>
<span class="112818067677115399" onmouseenter="enter('112818067677115399');" onmouseout="out('112818067677115399');" style=""> 912                 mViewLinkMenuItem.setIcon(mEmailIconResId);                                              </span>
<span class="7417350135164215691" onmouseenter="enter('7417350135164215691');" onmouseout="out('7417350135164215691');" style=""> 913                 mViewLinkMenuItem.setTitle(getString(R.string.email));                                   </span>
<span class="-1372170246346381865" onmouseenter="enter('-1372170246346381865');" onmouseout="out('-1372170246346381865');" style=""> 914             } else if (mLinkUrl.startsWith(&quot;geo:&quot;)) {                                                    </span>
<span class="-5464734295170160558" onmouseenter="enter('-5464734295170160558');" onmouseout="out('-5464734295170160558');" style=""> 915                 mViewLinkMenuItem.setIcon(mMapIconResId);                                                </span>
<span class="5018205442899714685" onmouseenter="enter('5018205442899714685');" onmouseout="out('5018205442899714685');" style=""> 916                 mViewLinkMenuItem.setTitle(getString(R.string.view_map));                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 917             } else {                                                                                     </span>
<span class="-4632312324298999235" onmouseenter="enter('-4632312324298999235');" onmouseout="out('-4632312324298999235');" style=""> 918                 mViewLinkMenuItem.setIcon(mWebIconResId);                                                </span>
<span class="4171282647008223100" onmouseenter="enter('4171282647008223100');" onmouseout="out('4171282647008223100');" style=""> 919                 mViewLinkMenuItem.setTitle(getString(R.string.view_in_browser));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 920             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 922     }                                                                                                    </span>
<span  style=""> 923                                                                                                          </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 924     // Resets note publish status if Simperium never returned the new publish status                     </span>
<span class="-7747131454054684363" onmouseenter="enter('-7747131454054684363');" onmouseout="out('-7747131454054684363');" style=""> 925     private Runnable mPublishTimeoutRunnable = new Runnable() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 926         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 927         public void run() {                                                                              </span>
<span class="6112154992837754036" onmouseenter="enter('6112154992837754036');" onmouseout="out('6112154992837754036');" style=""> 928             if (!isAdded()) return;                                                                      </span>
<span  style=""> 929                                                                                                          </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 930             getActivity().runOnUiThread(new Runnable() {                                                 </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 931                 @Override                                                                                </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 932                 public void run() {                                                                      </span>
<span class="-46541338249551852" onmouseenter="enter('-46541338249551852');" onmouseout="out('-46541338249551852');" style=""> 933                     Toast.makeText(                                                                      </span>
<span class="1251951171853107838" onmouseenter="enter('1251951171853107838');" onmouseout="out('1251951171853107838');" style=""> 934                             getActivity(),                                                               </span>
<span class="112353621179497368" onmouseenter="enter('112353621179497368');" onmouseout="out('112353621179497368');" style=""> 935                             mNote.isPublished() ? R.string.publish_error : R.string.unpublish_error,     </span>
<span class="-5464445565121122409" onmouseenter="enter('-5464445565121122409');" onmouseout="out('-5464445565121122409');" style=""> 936                             Toast.LENGTH_SHORT                                                           </span>
<span class="1929519410657596695" onmouseenter="enter('1929519410657596695');" onmouseout="out('1929519410657596695');" style=""> 937                     ).show();                                                                            </span>
<span  style=""> 938                                                                                                          </span>
<span class="-6752199236124778161" onmouseenter="enter('-6752199236124778161');" onmouseout="out('-6752199236124778161');" style=""> 939                     mNote.setPublished(!mNote.isPublished());                                            </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 940                     mNote.save();                                                                        </span>
<span  style=""> 941                                                                                                          </span>
<span class="-4813280994160595323" onmouseenter="enter('-4813280994160595323');" onmouseout="out('-4813280994160595323');" style=""> 942                     if (mInfoPopupWindow != null &amp;&amp; mInfoPopupWindow.isShowing()) {                      </span>
<span class="-6944825779591395660" onmouseenter="enter('-6944825779591395660');" onmouseout="out('-6944825779591395660');" style=""><abbr title=" 943                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(R.id.publish_view_switcher);"> 943                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findVðŸ”µ</abbr></span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 944                         if (viewSwitcher.getDisplayedChild() == 1) {                                     </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 945                             viewSwitcher.showPrevious();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 946                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 947                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 948                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 949             });                                                                                          </span>
<span  style=""> 950                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 951         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 952     };                                                                                                   </span>
<span  style=""> 953                                                                                                          </span>
<span class="1779789763575252159" onmouseenter="enter('1779789763575252159');" onmouseout="out('1779789763575252159');" style=""> 954     private void updateWordCount(TextView textView) {                                                    </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 955         String content = getNoteContentString();                                                         </span>
<span  style=""> 956                                                                                                          </span>
<span class="-1008232604726066894" onmouseenter="enter('-1008232604726066894');" onmouseout="out('-1008232604726066894');" style=""> 957         if (content == null || textView == null) return;                                                 </span>
<span  style=""> 958                                                                                                          </span>
<span class="-1430881109113489374" onmouseenter="enter('-1430881109113489374');" onmouseout="out('-1430881109113489374');" style=""> 959         int numWords = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;     </span>
<span  style=""> 960                                                                                                          </span>
<span class="7366599842051642465" onmouseenter="enter('7366599842051642465');" onmouseout="out('7366599842051642465');" style=""> 961         String wordCountString = getResources().getQuantityString(R.plurals.word_count, numWords);       </span>
<span class="6184855737129992397" onmouseenter="enter('6184855737129992397');" onmouseout="out('6184855737129992397');" style=""> 962         String formattedWordCount = NumberFormat.getInstance().format(numWords);                         </span>
<span  style=""> 963                                                                                                          </span>
<span class="-8359331938088478069" onmouseenter="enter('-8359331938088478069');" onmouseout="out('-8359331938088478069');" style=""> 964         textView.setText(formattedWordCount + &quot; &quot; + wordCountString);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 965     }                                                                                                    </span>
<span  style=""> 966                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 967     /**                                                                                                  </span>
<span class="-1711188639399183775" onmouseenter="enter('-1711188639399183775');" onmouseout="out('-1711188639399183775');" style=""> 968      * Simperium listeners                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 969      */                                                                                                  </span>
<span  style=""> 970                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 971     @Override                                                                                            </span>
<span class="3459602708969445883" onmouseenter="enter('3459602708969445883');" onmouseout="out('3459602708969445883');" style=""> 972     public void onDeleteObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                     </span>
<span  style=""> 973                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 974     }                                                                                                    </span>
<span  style=""> 975                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 976     @Override                                                                                            </span>
<span class="-2970240973750057256" onmouseenter="enter('-2970240973750057256');" onmouseout="out('-2970240973750057256');" style=""><abbr title=" 977     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {"> 977     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) ðŸ”µ</abbr></span>
<span class="6607037711761945955" onmouseenter="enter('6607037711761945955');" onmouseout="out('6607037711761945955');" style=""> 978         if (changeType == Bucket.ChangeType.MODIFY) {                                                    </span>
<span class="-6254872391725782597" onmouseenter="enter('-6254872391725782597');" onmouseout="out('-6254872391725782597');" style=""> 979             if (getNote() != null &amp;&amp; getNote().getSimperiumKey().equals(key)) {                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 980                 try {                                                                                    </span>
<span class="3951885723067312215" onmouseenter="enter('3951885723067312215');" onmouseout="out('3951885723067312215');" style=""> 981                     final Note updatedNote = mNotesBucket.get(key);                                      </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 982                     if (getActivity() != null) {                                                         </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 983                         getActivity().runOnUiThread(new Runnable() {                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 984                             @Override                                                                    </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 985                             public void run() {                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 986                                 if (mPublishTimeoutHandler != null) {                                    </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 987                                     mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 988                                 }                                                                        </span>
<span  style=""> 989                                                                                                          </span>
<span class="-8617980127286778731" onmouseenter="enter('-8617980127286778731');" onmouseout="out('-8617980127286778731');" style=""> 990                                 updateNote(updatedNote);                                                 </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 991                                 updateInfoPopup();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 992                             }                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 993                         });                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 994                     }                                                                                    </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 995                 } catch (BucketObjectMissingException e) {                                               </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 996                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 997                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 998             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 999         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1000     }                                                                                                    </span>
<span  style="">1001                                                                                                          </span>
<span  style="">1002                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1003     @Override                                                                                            </span>
<span class="1835476648918604123" onmouseenter="enter('1835476648918604123');" onmouseout="out('1835476648918604123');" style="">1004     public void onSaveObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                       </span>
<span class="-5784091718421357269" onmouseenter="enter('-5784091718421357269');" onmouseout="out('-5784091718421357269');" style="">1005         // noop                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1006     }                                                                                                    </span>
<span  style="">1007                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1008     @Override                                                                                            </span>
<span class="-5956849782971602831" onmouseenter="enter('-5956849782971602831');" onmouseout="out('-5956849782971602831');" style="">1009     public void onBeforeUpdateObject(Bucket&lt;Note&gt; bucket, Note note) {                                   </span>
<span class="9133977848896323437" onmouseenter="enter('9133977848896323437');" onmouseout="out('9133977848896323437');" style="">1010         // Don&#x27;t apply updates if we haven&#x27;t loaded the note yet                                         </span>
<span class="-1541782922582123662" onmouseenter="enter('-1541782922582123662');" onmouseout="out('-1541782922582123662');" style="">1011         if (mIsLoadingNote)                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1012             return;                                                                                      </span>
<span  style="">1013                                                                                                          </span>
<span class="1341660593539808393" onmouseenter="enter('1341660593539808393');" onmouseout="out('1341660593539808393');" style="">1014         Note openNote = getNote();                                                                       </span>
<span class="-6997098079508589023" onmouseenter="enter('-6997098079508589023');" onmouseout="out('-6997098079508589023');" style="">1015         if (openNote == null || !openNote.getSimperiumKey().equals(note.getSimperiumKey()))              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1016             return;                                                                                      </span>
<span  style="">1017                                                                                                          </span>
<span class="4441072062127767636" onmouseenter="enter('4441072062127767636');" onmouseout="out('4441072062127767636');" style="">1018         note.setContent(getNoteContentString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1019     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1020 }                                                                                                        </span></pre></td>
                            <td><pre><span class="8328120990598135231" onmouseenter="enter('8328120990598135231');" onmouseout="out('8328120990598135231');" style="">   1 package com.automattic.simplenote;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="7622566010320033225" onmouseenter="enter('7622566010320033225');" onmouseout="out('7622566010320033225');" style="">   4 import android.app.Fragment;                                                                             </span>
<span class="-1500972560159629307" onmouseenter="enter('-1500972560159629307');" onmouseout="out('-1500972560159629307');" style="">   5 import android.content.ClipData;                                                                         </span>
<span class="-1154037727824652611" onmouseenter="enter('-1154037727824652611');" onmouseout="out('-1154037727824652611');" style="">   6 import android.content.ClipboardManager;                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   7 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   8 import android.content.Intent;                                                                           </span>
<span class="-840652079464298178" onmouseenter="enter('-840652079464298178');" onmouseout="out('-840652079464298178');" style="">   9 import android.content.res.TypedArray;                                                                   </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  10 import android.database.Cursor;                                                                          </span>
<span class="1216741051675613788" onmouseenter="enter('1216741051675613788');" onmouseout="out('1216741051675613788');" style="">  11 import android.graphics.drawable.ColorDrawable;                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  12 import android.net.Uri;                                                                                  </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  13 import android.os.AsyncTask;                                                                             </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  14 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  15 import android.os.Bundle;                                                                                </span>
<span class="-1086316590722027623" onmouseenter="enter('-1086316590722027623');" onmouseout="out('-1086316590722027623');" style="">  16 import android.os.Handler;                                                                               </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  17 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="-8226814767277370585" onmouseenter="enter('-8226814767277370585');" onmouseout="out('-8226814767277370585');" style="">  18 import android.support.v7.view.ActionMode;                                                               </span>
<span class="4177373235046048356" onmouseenter="enter('4177373235046048356');" onmouseout="out('4177373235046048356');" style="">  19 import android.text.Editable;                                                                            </span>
<span class="7731806713123176572" onmouseenter="enter('7731806713123176572');" onmouseout="out('7731806713123176572');" style="">  20 import android.text.Spanned;                                                                             </span>
<span class="4038639591141008331" onmouseenter="enter('4038639591141008331');" onmouseout="out('4038639591141008331');" style="">  21 import android.text.TextWatcher;                                                                         </span>
<span class="2374973474356501783" onmouseenter="enter('2374973474356501783');" onmouseout="out('2374973474356501783');" style="">  22 import android.text.style.RelativeSizeSpan;                                                              </span>
<span class="-1165963660754430642" onmouseenter="enter('-1165963660754430642');" onmouseout="out('-1165963660754430642');" style="">  23 import android.text.style.URLSpan;                                                                       </span>
<span class="-3804250137032727253" onmouseenter="enter('-3804250137032727253');" onmouseout="out('-3804250137032727253');" style="">  24 import android.text.util.Linkify;                                                                        </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  25 import android.util.TypedValue;                                                                          </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="">  26 import android.view.LayoutInflater;                                                                      </span>
<span class="-603490076395619238" onmouseenter="enter('-603490076395619238');" onmouseout="out('-603490076395619238');" style="">  27 import android.view.Menu;                                                                                </span>
<span class="-434306062495579804" onmouseenter="enter('-434306062495579804');" onmouseout="out('-434306062495579804');" style="">  28 import android.view.MenuInflater;                                                                        </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  29 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  30 import android.view.View;                                                                                </span>
<span class="7569314084591619834" onmouseenter="enter('7569314084591619834');" onmouseout="out('7569314084591619834');" style="">  31 import android.view.ViewGroup;                                                                           </span>
<span class="-3054355229537475035" onmouseenter="enter('-3054355229537475035');" onmouseout="out('-3054355229537475035');" style="">  32 import android.view.WindowManager;                                                                       </span>
<span class="-3117363671899680167" onmouseenter="enter('-3117363671899680167');" onmouseout="out('-3117363671899680167');" style="">  33 import android.view.inputmethod.InputMethodManager;                                                      </span>
<span class="5634491474902588492" onmouseenter="enter('5634491474902588492');" onmouseout="out('5634491474902588492');" style="">  34 import android.widget.CursorAdapter;                                                                     </span>
<span class="-7136991092569948508" onmouseenter="enter('-7136991092569948508');" onmouseout="out('-7136991092569948508');" style="">  35 import android.widget.ImageButton;                                                                       </span>
<span class="-8478546344938881111" onmouseenter="enter('-8478546344938881111');" onmouseout="out('-8478546344938881111');" style="">  36 import android.widget.ImageView;                                                                         </span>
<span class="5987800420235491716" onmouseenter="enter('5987800420235491716');" onmouseout="out('5987800420235491716');" style="">  37 import android.widget.LinearLayout;                                                                      </span>
<span class="842268080202249770" onmouseenter="enter('842268080202249770');" onmouseout="out('842268080202249770');" style="">  38 import android.widget.PopupWindow;                                                                       </span>
<span class="-4961528671422147708" onmouseenter="enter('-4961528671422147708');" onmouseout="out('-4961528671422147708');" style="">  39 import android.widget.TextView;                                                                          </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  40 import android.widget.Toast;                                                                             </span>
<span class="-1505700250942826116" onmouseenter="enter('-1505700250942826116');" onmouseout="out('-1505700250942826116');" style="">  41 import android.widget.ToggleButton;                                                                      </span>
<span class="737425360271515900" onmouseenter="enter('737425360271515900');" onmouseout="out('737425360271515900');" style="">  42 import android.widget.ViewSwitcher;                                                                      </span>
<span  style="">  43                                                                                                          </span>
<span class="9061368408436996655" onmouseenter="enter('9061368408436996655');" onmouseout="out('9061368408436996655');" style="">  44 import com.automattic.simplenote.models.Note;                                                            </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">  45 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-4380838228434146133" onmouseenter="enter('-4380838228434146133');" onmouseout="out('-4380838228434146133');" style="">  46 import com.automattic.simplenote.utils.AutoBullet;                                                       </span>
<span class="8577850632926167445" onmouseenter="enter('8577850632926167445');" onmouseout="out('8577850632926167445');" style="">  47 import com.automattic.simplenote.utils.DisplayUtils;                                                     </span>
<span class="1327521140651609704" onmouseenter="enter('1327521140651609704');" onmouseout="out('1327521140651609704');" style="">  48 import com.automattic.simplenote.utils.MatchOffsetHighlighter;                                           </span>
<span class="-7136497821822559876" onmouseenter="enter('-7136497821822559876');" onmouseout="out('-7136497821822559876');" style="">  49 import com.automattic.simplenote.utils.PrefUtils;                                                        </span>
<span class="13513923158165555" onmouseenter="enter('13513923158165555');" onmouseout="out('13513923158165555');" style="">  50 import com.automattic.simplenote.utils.SpaceTokenizer;                                                   </span>
<span class="4834384566534786428" onmouseenter="enter('4834384566534786428');" onmouseout="out('4834384566534786428');" style="">  51 import com.automattic.simplenote.widgets.SimplenoteEditText;                                             </span>
<span class="2537926396801226048" onmouseenter="enter('2537926396801226048');" onmouseout="out('2537926396801226048');" style="">  52 import com.automattic.simplenote.utils.SimplenoteLinkify;                                                </span>
<span class="-4652171765784917488" onmouseenter="enter('-4652171765784917488');" onmouseout="out('-4652171765784917488');" style="">  53 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView;                                    </span>
<span class="451633977271230846" onmouseenter="enter('451633977271230846');" onmouseout="out('451633977271230846');" style="">  54 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView.OnTagAddedListener;                 </span>
<span class="3055903766206676561" onmouseenter="enter('3055903766206676561');" onmouseout="out('3055903766206676561');" style="">  55 import com.automattic.simplenote.utils.TextHighlighter;                                                  </span>
<span class="-454400291627646237" onmouseenter="enter('-454400291627646237');" onmouseout="out('-454400291627646237');" style="">  56 import com.google.android.gms.analytics.HitBuilders;                                                     </span>
<span class="-1389398410172463659" onmouseenter="enter('-1389398410172463659');" onmouseout="out('-1389398410172463659');" style="">  57 import com.google.android.gms.analytics.Tracker;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  58 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">  59 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  60 import com.simperium.client.Query;                                                                       </span>
<span  style="">  61                                                                                                          </span>
<span class="-76499702739685611" onmouseenter="enter('-76499702739685611');" onmouseout="out('-76499702739685611');" style="">  62 import java.text.NumberFormat;                                                                           </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  63 import java.util.Calendar;                                                                               </span>
<span  style="">  64                                                                                                          </span>
<span class="7280890691619564888" onmouseenter="enter('7280890691619564888');" onmouseout="out('7280890691619564888');" style=""><abbr title="  65 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListener, View.OnFocusChangeListener, SimplenoteEditText.OnSelectionChangedListener {">  65 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddeðŸ”µ</abbr></span>
<span  style="">  66                                                                                                          </span>
<span class="-4619625032881090052" onmouseenter="enter('-4619625032881090052');" onmouseout="out('-4619625032881090052');" style="">  67     public static final String ARG_ITEM_ID = &quot;item_id&quot;;                                                  </span>
<span class="-7299684920632401552" onmouseenter="enter('-7299684920632401552');" onmouseout="out('-7299684920632401552');" style="">  68     public static final String ARG_NEW_NOTE = &quot;new_note&quot;;                                                </span>
<span class="7663325037782331899" onmouseenter="enter('7663325037782331899');" onmouseout="out('7663325037782331899');" style="">  69     static public final String ARG_MATCH_OFFSETS = &quot;match_offsets&quot;;                                      </span>
<span class="8491452362607628076" onmouseenter="enter('8491452362607628076');" onmouseout="out('8491452362607628076');" style="">  70     private static final int AUTOSAVE_DELAY_MILLIS = 2000;                                               </span>
<span  style="">  71                                                                                                          </span>
<span class="-6846870049312317979" onmouseenter="enter('-6846870049312317979');" onmouseout="out('-6846870049312317979');" style="">  72     private Note mNote;                                                                                  </span>
<span class="-7913886194286774922" onmouseenter="enter('-7913886194286774922');" onmouseout="out('-7913886194286774922');" style="">  73     private Bucket&lt;Note&gt; mNotesBucket;                                                                   </span>
<span  style="">  74                                                                                                          </span>
<span class="7126484835826685301" onmouseenter="enter('7126484835826685301');" onmouseout="out('7126484835826685301');" style="">  75     private Tracker mTracker;                                                                            </span>
<span  style="">  76                                                                                                          </span>
<span class="6580801006778009663" onmouseenter="enter('6580801006778009663');" onmouseout="out('6580801006778009663');" style="">  77     private SimplenoteEditText mContentEditText;                                                         </span>
<span class="-6964345898478101017" onmouseenter="enter('-6964345898478101017');" onmouseout="out('-6964345898478101017');" style="">  78     private TagsMultiAutoCompleteTextView mTagView;                                                      </span>
<span class="5165556704755836097" onmouseenter="enter('5165556704755836097');" onmouseout="out('5165556704755836097');" style="">  79     private PopupWindow mInfoPopupWindow;                                                                </span>
<span class="2959047860003936172" onmouseenter="enter('2959047860003936172');" onmouseout="out('2959047860003936172');" style="">  80     private ToggleButton mPinButton;                                                                     </span>
<span class="6494121288462075344" onmouseenter="enter('6494121288462075344');" onmouseout="out('6494121288462075344');" style="">  81     private Handler mAutoSaveHandler;                                                                    </span>
<span class="8783277907965445564" onmouseenter="enter('8783277907965445564');" onmouseout="out('8783277907965445564');" style="">  82     private Handler mPublishTimeoutHandler;                                                              </span>
<span class="-1776320876088405367" onmouseenter="enter('-1776320876088405367');" onmouseout="out('-1776320876088405367');" style="">  83     private LinearLayout mPlaceholderView;                                                               </span>
<span class="-5862875858497045082" onmouseenter="enter('-5862875858497045082');" onmouseout="out('-5862875858497045082');" style="">  84     private CursorAdapter mAutocompleteAdapter;                                                          </span>
<span class="275494556225166536" onmouseenter="enter('275494556225166536');" onmouseout="out('275494556225166536');" style="">  85     private boolean mIsNewNote, mIsLoadingNote;                                                          </span>
<span class="7307228847460234411" onmouseenter="enter('7307228847460234411');" onmouseout="out('7307228847460234411');" style="">  86     private ActionMode mActionMode;                                                                      </span>
<span class="-1934738222867341331" onmouseenter="enter('-1934738222867341331');" onmouseout="out('-1934738222867341331');" style="">  87     private MenuItem mViewLinkMenuItem;                                                                  </span>
<span class="-3624836155172024592" onmouseenter="enter('-3624836155172024592');" onmouseout="out('-3624836155172024592');" style="">  88     private String mLinkUrl;                                                                             </span>
<span class="-680149036339568713" onmouseenter="enter('-680149036339568713');" onmouseout="out('-680149036339568713');" style="">  89     private String mLinkText;                                                                            </span>
<span class="-8355060532383088001" onmouseenter="enter('-8355060532383088001');" onmouseout="out('-8355060532383088001');" style="">  90     private MatchOffsetHighlighter mHighlighter;                                                         </span>
<span class="-2809999858206249165" onmouseenter="enter('-2809999858206249165');" onmouseout="out('-2809999858206249165');" style="">  91     private int mEmailIconResId, mWebIconResId, mMapIconResId, mCallIconResId;                           </span>
<span class="-7542236593744276396" onmouseenter="enter('-7542236593744276396');" onmouseout="out('-7542236593744276396');" style="">  92     private MatchOffsetHighlighter.SpanFactory mMatchHighlighter;                                        </span>
<span class="2689815831275839045" onmouseenter="enter('2689815831275839045');" onmouseout="out('2689815831275839045');" style="">  93     private String mMatchOffsets;                                                                        </span>
<span class="-7790101837861097441" onmouseenter="enter('-7790101837861097441');" onmouseout="out('-7790101837861097441');" style="">  94     private int mCurrentCursorPosition;                                                                  </span>
<span  style="">  95                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96     /**                                                                                                  </span>
<span class="7780585517980788373" onmouseenter="enter('7780585517980788373');" onmouseout="out('7780585517980788373');" style="">  97      * Mandatory empty constructor for the fragment manager to instantiate the                           </span>
<span class="7130060501227883159" onmouseenter="enter('7130060501227883159');" onmouseout="out('7130060501227883159');" style="">  98      * fragment (e.g. upon screen orientation changes).                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  99      */                                                                                                  </span>
<span class="2055429757813344166" onmouseenter="enter('2055429757813344166');" onmouseout="out('2055429757813344166');" style=""> 100     public NoteEditorFragment() {                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101     }                                                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 103     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 104     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 105         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 106                                                                                                          </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 107         if (getActivity() != null) {                                                                     </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 108             Simplenote currentApp = (Simplenote) getActivity().getApplication();                         </span>
<span class="3464165486447434608" onmouseenter="enter('3464165486447434608');" onmouseout="out('3464165486447434608');" style=""> 109             mNotesBucket = currentApp.getNotesBucket();                                                  </span>
<span class="8395901407898834802" onmouseenter="enter('8395901407898834802');" onmouseout="out('8395901407898834802');" style=""> 110             mTracker = currentApp.getTracker();                                                          </span>
<span  style=""> 111                                                                                                          </span>
<span class="6390134422937918444" onmouseenter="enter('6390134422937918444');" onmouseout="out('6390134422937918444');" style=""><abbr title=" 112             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionBarIconWeb, R.attr.actionBarIconMap, R.attr.actionBarIconCall});"> 112             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.atðŸ”µ</abbr></span>
<span class="-368005650607593546" onmouseenter="enter('-368005650607593546');" onmouseout="out('-368005650607593546');" style=""> 113             if (a != null) {                                                                             </span>
<span class="156477903530707073" onmouseenter="enter('156477903530707073');" onmouseout="out('156477903530707073');" style=""> 114                 mEmailIconResId = a.getResourceId(0, 0);                                                 </span>
<span class="2237960387607406884" onmouseenter="enter('2237960387607406884');" onmouseout="out('2237960387607406884');" style=""> 115                 mWebIconResId = a.getResourceId(1, 0);                                                   </span>
<span class="-2587404817224189880" onmouseenter="enter('-2587404817224189880');" onmouseout="out('-2587404817224189880');" style=""> 116                 mMapIconResId = a.getResourceId(2, 0);                                                   </span>
<span class="7397862531502718567" onmouseenter="enter('7397862531502718567');" onmouseout="out('7397862531502718567');" style=""> 117                 mCallIconResId = a.getResourceId(3, 0);                                                  </span>
<span class="7664438635535969272" onmouseenter="enter('7664438635535969272');" onmouseout="out('7664438635535969272');" style=""> 118                 a.recycle();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120         }                                                                                                </span>
<span  style=""> 121                                                                                                          </span>
<span class="-7557436274459739944" onmouseenter="enter('-7557436274459739944');" onmouseout="out('-7557436274459739944');" style=""> 122         mAutoSaveHandler = new Handler();                                                                </span>
<span class="5311700283685025064" onmouseenter="enter('5311700283685025064');" onmouseout="out('5311700283685025064');" style=""> 123         mPublishTimeoutHandler = new Handler();                                                          </span>
<span  style=""> 124                                                                                                          </span>
<span class="-8863028397307166255" onmouseenter="enter('-8863028397307166255');" onmouseout="out('-8863028397307166255');" style=""> 125         mMatchHighlighter = new TextHighlighter(getActivity(),                                           </span>
<span class="5690198221529347900" onmouseenter="enter('5690198221529347900');" onmouseout="out('5690198221529347900');" style=""><abbr title=" 126                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor);"> 126                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor)ðŸ”µ</abbr></span>
<span class="3992270686517948303" onmouseenter="enter('3992270686517948303');" onmouseout="out('3992270686517948303');" style=""> 127         mAutocompleteAdapter = new CursorAdapter(getActivity(), null, 0x0){                              </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129             @Override                                                                                    </span>
<span class="5082230411214880762" onmouseenter="enter('5082230411214880762');" onmouseout="out('5082230411214880762');" style=""> 130             public View newView(Context context, Cursor cursor, ViewGroup parent) {                      </span>
<span class="-7341849400851650995" onmouseenter="enter('-7341849400851650995');" onmouseout="out('-7341849400851650995');" style=""> 131                 Activity activity = (Activity) context;                                                  </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 132                 if (activity == null) return null;                                                       </span>
<span class="-3314008061858345993" onmouseenter="enter('-3314008061858345993');" onmouseout="out('-3314008061858345993');" style=""> 133                 return activity.getLayoutInflater().inflate(R.layout.tag_autocomplete_list_item, null);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134             }                                                                                            </span>
<span  style=""> 135                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 136             @Override                                                                                    </span>
<span class="19024103499623332" onmouseenter="enter('19024103499623332');" onmouseout="out('19024103499623332');" style=""> 137             public void bindView(View view, Context context, Cursor cursor) {                            </span>
<span class="1800045997788095368" onmouseenter="enter('1800045997788095368');" onmouseout="out('1800045997788095368');" style=""> 138                 TextView textView = (TextView) view;                                                     </span>
<span class="6731261465219202848" onmouseenter="enter('6731261465219202848');" onmouseout="out('6731261465219202848');" style=""> 139                 textView.setText(convertToString(cursor));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140             }                                                                                            </span>
<span  style=""> 141                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 142             @Override                                                                                    </span>
<span class="-1664730445059241307" onmouseenter="enter('-1664730445059241307');" onmouseout="out('-1664730445059241307');" style=""> 143             public CharSequence convertToString(Cursor cursor){                                          </span>
<span class="-7149458698442797769" onmouseenter="enter('-7149458698442797769');" onmouseout="out('-7149458698442797769');" style=""> 144                 return cursor.getString(cursor.getColumnIndex(Tag.NAME_PROPERTY));                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145             }                                                                                            </span>
<span  style=""> 146                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 147             @Override                                                                                    </span>
<span class="-6792310640715402890" onmouseenter="enter('-6792310640715402890');" onmouseout="out('-6792310640715402890');" style=""> 148             public Cursor runQueryOnBackgroundThread(CharSequence filter) {                              </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 149                 Activity activity = getActivity();                                                       </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 150                 if (activity == null) return null;                                                       </span>
<span class="9016693485500608067" onmouseenter="enter('9016693485500608067');" onmouseout="out('9016693485500608067');" style=""> 151                 Simplenote application = (Simplenote) activity.getApplication();                         </span>
<span class="-288329532637656436" onmouseenter="enter('-288329532637656436');" onmouseout="out('-288329532637656436');" style=""> 152                 Query&lt;Tag&gt; query = application.getTagsBucket().query();                                  </span>
<span class="-1263658484466254954" onmouseenter="enter('-1263658484466254954');" onmouseout="out('-1263658484466254954');" style=""> 153                 // make the tag name available to the cursor                                             </span>
<span class="5748018636045801946" onmouseenter="enter('5748018636045801946');" onmouseout="out('5748018636045801946');" style=""> 154                 query.include(Tag.NAME_PROPERTY);                                                        </span>
<span class="-7615810455976629564" onmouseenter="enter('-7615810455976629564');" onmouseout="out('-7615810455976629564');" style=""> 155                 // sort the tags by their names                                                          </span>
<span class="5674220988188306819" onmouseenter="enter('5674220988188306819');" onmouseout="out('5674220988188306819');" style=""> 156                 query.order(Tag.NAME_PROPERTY);                                                          </span>
<span class="8185275162074884971" onmouseenter="enter('8185275162074884971');" onmouseout="out('8185275162074884971');" style=""> 157                 // if there&#x27;s a filter string find only matching tag names                               </span>
<span class="-1465062097430607325" onmouseenter="enter('-1465062097430607325');" onmouseout="out('-1465062097430607325');" style=""><abbr title=" 158                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%&quot;, filter));"> 158                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.forðŸ”µ</abbr></span>
<span class="8392918727668200780" onmouseenter="enter('8392918727668200780');" onmouseout="out('8392918727668200780');" style=""> 159                 return query.execute();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 161         };                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span  style=""> 164                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165     @Override                                                                                            </span>
<span class="-7355940524539913821" onmouseenter="enter('-7355940524539913821');" onmouseout="out('-7355940524539913821');" style=""> 166     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {  </span>
<span class="7823602444079418117" onmouseenter="enter('7823602444079418117');" onmouseout="out('7823602444079418117');" style=""> 167         setHasOptionsMenu(true);                                                                         </span>
<span class="6339769591252564933" onmouseenter="enter('6339769591252564933');" onmouseout="out('6339769591252564933');" style=""> 168         View rootView = inflater.inflate(R.layout.fragment_note_editor, container, false);               </span>
<span class="7145177453793333411" onmouseenter="enter('7145177453793333411');" onmouseout="out('7145177453793333411');" style=""> 169         mContentEditText = ((SimplenoteEditText) rootView.findViewById(R.id.note_content));              </span>
<span class="-2924083774161461664" onmouseenter="enter('-2924083774161461664');" onmouseout="out('-2924083774161461664');" style=""> 170         mContentEditText.addOnSelectionChangedListener(this);                                            </span>
<span class="-5685601943521108416" onmouseenter="enter('-5685601943521108416');" onmouseout="out('-5685601943521108416');" style=""> 171         mTagView = (TagsMultiAutoCompleteTextView) rootView.findViewById(R.id.tag_view);                 </span>
<span class="-1710279282572635872" onmouseenter="enter('-1710279282572635872');" onmouseout="out('-1710279282572635872');" style=""> 172         mTagView.setTokenizer(new SpaceTokenizer());                                                     </span>
<span class="-905473657518076069" onmouseenter="enter('-905473657518076069');" onmouseout="out('-905473657518076069');" style=""> 173         mTagView.setOnFocusChangeListener(this);                                                         </span>
<span  style=""> 174                                                                                                          </span>
<span class="6080374810605667863" onmouseenter="enter('6080374810605667863');" onmouseout="out('6080374810605667863');" style=""> 175         mHighlighter = new MatchOffsetHighlighter(mMatchHighlighter, mContentEditText);                  </span>
<span  style=""> 176                                                                                                          </span>
<span class="8838498328861850169" onmouseenter="enter('8838498328861850169');" onmouseout="out('8838498328861850169');" style=""> 177         mPinButton = (ToggleButton) rootView.findViewById(R.id.pinButton);                               </span>
<span class="-6233419192957625397" onmouseenter="enter('-6233419192957625397');" onmouseout="out('-6233419192957625397');" style=""> 178         mPinButton.setOnClickListener(new View.OnClickListener() {                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 179             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 180             public void onClick(View v) {                                                                </span>
<span class="-1510302136918940941" onmouseenter="enter('-1510302136918940941');" onmouseout="out('-1510302136918940941');" style=""> 181                 if (mPinButton.isChecked()) {                                                            </span>
<span class="-7637598965692605019" onmouseenter="enter('-7637598965692605019');" onmouseout="out('-7637598965692605019');" style=""> 182                     // Friendly message to the user as to what this button does.                         </span>
<span class="5938443200552047425" onmouseenter="enter('5938443200552047425');" onmouseout="out('5938443200552047425');" style=""> 183                     Toast.makeText(getActivity(), R.string.note_pinned, Toast.LENGTH_SHORT).show();      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 186         });                                                                                              </span>
<span  style=""> 187                                                                                                          </span>
<span class="-3806018576171196544" onmouseenter="enter('-3806018576171196544');" onmouseout="out('-3806018576171196544');" style=""> 188         mPlaceholderView = (LinearLayout) rootView.findViewById(R.id.placeholder);                       </span>
<span class="2017772049978674307" onmouseenter="enter('2017772049978674307');" onmouseout="out('2017772049978674307');" style=""> 189         if (DisplayUtils.isLargeLandscape(getActivity()) &amp;&amp; mNote == null) {                             </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 190             mPlaceholderView.setVisibility(View.VISIBLE);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191         }                                                                                                </span>
<span  style=""> 192                                                                                                          </span>
<span class="-8386469275367064070" onmouseenter="enter('-8386469275367064070');" onmouseout="out('-8386469275367064070');" style=""> 193         mTagView.setAdapter(mAutocompleteAdapter);                                                       </span>
<span  style=""> 194                                                                                                          </span>
<span class="592168733134676120" onmouseenter="enter('592168733134676120');" onmouseout="out('592168733134676120');" style=""> 195         // Load note if we were passed a note Id                                                         </span>
<span class="-512438581163180757" onmouseenter="enter('-512438581163180757');" onmouseout="out('-512438581163180757');" style=""> 196         Bundle arguments = getArguments();                                                               </span>
<span class="5652609996770636291" onmouseenter="enter('5652609996770636291');" onmouseout="out('5652609996770636291');" style=""> 197         if (arguments != null &amp;&amp; arguments.containsKey(ARG_ITEM_ID)) {                                   </span>
<span class="-30854459346766710" onmouseenter="enter('-30854459346766710');" onmouseout="out('-30854459346766710');" style=""> 198             String key = arguments.getString(ARG_ITEM_ID);                                               </span>
<span class="9138949033848867696" onmouseenter="enter('9138949033848867696');" onmouseout="out('9138949033848867696');" style=""> 199             if (arguments.containsKey(ARG_MATCH_OFFSETS)) {                                              </span>
<span class="-1831707694683903303" onmouseenter="enter('-1831707694683903303');" onmouseout="out('-1831707694683903303');" style=""> 200                 mMatchOffsets = arguments.getString(ARG_MATCH_OFFSETS);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201             }                                                                                            </span>
<span class="-3890643464976908836" onmouseenter="enter('-3890643464976908836');" onmouseout="out('-3890643464976908836');" style=""> 202             new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, key);                   </span>
<span class="-4954549700347163589" onmouseenter="enter('-4954549700347163589');" onmouseout="out('-4954549700347163589');" style=""> 203             setIsNewNote(getArguments().getBoolean(ARG_NEW_NOTE, false));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204         }                                                                                                </span>
<span  style=""> 205                                                                                                          </span>
<span class="4654908577906893139" onmouseenter="enter('4654908577906893139');" onmouseout="out('4654908577906893139');" style=""> 206 		return rootView;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207 	}                                                                                                       </span>
<span  style=""> 208                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 209     @Override                                                                                            </span>
<span class="3212580988936830895" onmouseenter="enter('3212580988936830895');" onmouseout="out('3212580988936830895');" style=""> 210     public void onResume() {                                                                             </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 211         super.onResume();                                                                                </span>
<span class="-295722270474880574" onmouseenter="enter('-295722270474880574');" onmouseout="out('-295722270474880574');" style=""> 212         mNotesBucket.start();                                                                            </span>
<span class="8320491026461558488" onmouseenter="enter('8320491026461558488');" onmouseout="out('8320491026461558488');" style=""> 213         mNotesBucket.addListener(this);                                                                  </span>
<span  style=""> 214                                                                                                          </span>
<span class="2283760307260285965" onmouseenter="enter('2283760307260285965');" onmouseout="out('2283760307260285965');" style=""> 215         mTagView.setOnTagAddedListener(this);                                                            </span>
<span  style=""> 216                                                                                                          </span>
<span class="-8630351771722931094" onmouseenter="enter('-8630351771722931094');" onmouseout="out('-8630351771722931094');" style=""> 217         if (mContentEditText != null) {                                                                  </span>
<span class="-999020196626820400" onmouseenter="enter('-999020196626820400');" onmouseout="out('-999020196626820400');" style=""><abbr title=" 218             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), PrefUtils.PREF_FONT_SIZE, 18));"> 218             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 222     @Override                                                                                            </span>
<span class="3108783673391190151" onmouseenter="enter('3108783673391190151');" onmouseout="out('3108783673391190151');" style=""> 223     public void onPause() {                                                                              </span>
<span class="-1649552973291504175" onmouseenter="enter('-1649552973291504175');" onmouseout="out('-1649552973291504175');" style=""> 224         mNotesBucket.removeListener(this);                                                               </span>
<span class="-4286062678685908757" onmouseenter="enter('-4286062678685908757');" onmouseout="out('-4286062678685908757');" style=""> 225         // Hide soft keyboard if it is showing...                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 226         if (getActivity() != null) {                                                                     </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 227             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 227             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(CðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 228             if (inputMethodManager != null) {                                                            </span>
<span class="159022051514418479" onmouseenter="enter('159022051514418479');" onmouseout="out('159022051514418479');" style=""> 229                 inputMethodManager.hideSoftInputFromWindow(mContentEditText.getWindowToken(), 0);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231         }                                                                                                </span>
<span  style=""> 232                                                                                                          </span>
<span class="-2832208055092409078" onmouseenter="enter('-2832208055092409078');" onmouseout="out('-2832208055092409078');" style=""> 233         // Delete the note if it is new and has empty fields                                             </span>
<span class="-2219905285758853631" onmouseenter="enter('-2219905285758853631');" onmouseout="out('-2219905285758853631');" style=""> 234         if (mNote != null &amp;&amp; mIsNewNote &amp;&amp; noteIsEmpty()) {                                              </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 235             mNote.delete();                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 236         } else {                                                                                         </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 237             saveNote();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238         }                                                                                                </span>
<span  style=""> 239                                                                                                          </span>
<span class="-5824468190651999684" onmouseenter="enter('-5824468190651999684');" onmouseout="out('-5824468190651999684');" style=""> 240         mTagView.setOnTagAddedListener(null);                                                            </span>
<span  style=""> 241                                                                                                          </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 242         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 243             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244         }                                                                                                </span>
<span  style=""> 245                                                                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 246         if (mPublishTimeoutHandler != null) {                                                            </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 247             mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248         }                                                                                                </span>
<span  style=""> 249                                                                                                          </span>
<span class="212618759798230270" onmouseenter="enter('212618759798230270');" onmouseout="out('212618759798230270');" style=""> 250         mHighlighter.stop();                                                                             </span>
<span  style=""> 251                                                                                                          </span>
<span class="-7508449912261312872" onmouseenter="enter('-7508449912261312872');" onmouseout="out('-7508449912261312872');" style=""> 252         super.onPause();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253     }                                                                                                    </span>
<span  style=""> 254                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 255     @Override                                                                                            </span>
<span class="-6208734081302594375" onmouseenter="enter('-6208734081302594375');" onmouseout="out('-6208734081302594375');" style=""> 256     public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {                                  </span>
<span class="-5591635883999644357" onmouseenter="enter('-5591635883999644357');" onmouseout="out('-5591635883999644357');" style=""> 257         inflater.inflate(R.menu.note_editor, menu);                                                      </span>
<span  style=""> 258                                                                                                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 259         if (mNote != null) {                                                                             </span>
<span class="3411369858029698957" onmouseenter="enter('3411369858029698957');" onmouseout="out('3411369858029698957');" style=""> 260             MenuItem viewPublishedNoteItem = menu.findItem(R.id.menu_view_info);                         </span>
<span class="-2499359923625437976" onmouseenter="enter('-2499359923625437976');" onmouseout="out('-2499359923625437976');" style=""> 261             viewPublishedNoteItem.setVisible(true);                                                      </span>
<span  style=""> 262                                                                                                          </span>
<span class="7674470390729338414" onmouseenter="enter('7674470390729338414');" onmouseout="out('7674470390729338414');" style=""> 263             MenuItem trashItem = menu.findItem(R.id.menu_delete).setTitle(R.string.undelete);            </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 264             if (mNote.isDeleted())                                                                       </span>
<span class="2395244797129247894" onmouseenter="enter('2395244797129247894');" onmouseout="out('2395244797129247894');" style=""> 265                 trashItem.setTitle(R.string.undelete);                                                   </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 266             else                                                                                         </span>
<span class="-2747782095374702281" onmouseenter="enter('-2747782095374702281');" onmouseout="out('-2747782095374702281');" style=""> 267                 trashItem.setTitle(R.string.delete);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268         }                                                                                                </span>
<span  style=""> 269                                                                                                          </span>
<span class="5772887857065615623" onmouseenter="enter('5772887857065615623');" onmouseout="out('5772887857065615623');" style=""> 270         super.onCreateOptionsMenu(menu, inflater);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 273     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 274     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 275         switch (item.getItemId()) {                                                                      </span>
<span class="-3574644309369097250" onmouseenter="enter('-3574644309369097250');" onmouseout="out('-3574644309369097250');" style=""> 276             case R.id.menu_view_info:                                                                    </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 277                 if (mNote != null) {                                                                     </span>
<span class="-5974815457760504487" onmouseenter="enter('-5974815457760504487');" onmouseout="out('-5974815457760504487');" style=""> 278                     View menuItemView = getActivity().findViewById(R.id.menu_view_info);                 </span>
<span class="2497222703395221844" onmouseenter="enter('2497222703395221844');" onmouseout="out('2497222703395221844');" style=""> 279                     showInfoPopup(menuItemView);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 281                 return true;                                                                             </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 282             case R.id.menu_share:                                                                        </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 283                 if (mNote != null) {                                                                     </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 284                     Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                 </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 285                     shareIntent.setType(&quot;text/plain&quot;);                                                   </span>
<span class="2565640458837084796" onmouseenter="enter('2565640458837084796');" onmouseout="out('2565640458837084796');" style=""> 286                     shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mNote.getContent());         </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 287                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 287                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.shaðŸ”µ</abbr></span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 288                     mTracker.send(                                                                       </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 289                             new HitBuilders.EventBuilder()                                               </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 290                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="2679386718058736721" onmouseenter="enter('2679386718058736721');" onmouseout="out('2679386718058736721');" style=""> 291                             .setAction(&quot;shared_note&quot;)                                                    </span>
<span class="-1410195237862732008" onmouseenter="enter('-1410195237862732008');" onmouseout="out('-1410195237862732008');" style=""> 292                             .setLabel(&quot;action_bar_share_button&quot;)                                         </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 293                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 294                     );                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 296                 return true;                                                                             </span>
<span class="6443133868746637198" onmouseenter="enter('6443133868746637198');" onmouseout="out('6443133868746637198');" style=""> 297             case R.id.menu_delete:                                                                       </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 298                 if (mNote != null) {                                                                     </span>
<span class="-929724925513034279" onmouseenter="enter('-929724925513034279');" onmouseout="out('-929724925513034279');" style=""> 299                     mNote.setDeleted(!mNote.isDeleted());                                                </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 300                     mNote.setModificationDate(Calendar.getInstance());                                   </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 301                     mNote.save();                                                                        </span>
<span class="-8654137458864067059" onmouseenter="enter('-8654137458864067059');" onmouseout="out('-8654137458864067059');" style=""> 302                     Intent resultIntent = new Intent();                                                  </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 303                     if (mNote.isDeleted())                                                               </span>
<span class="-4555570864561374481" onmouseenter="enter('-4555570864561374481');" onmouseout="out('-4555570864561374481');" style=""> 304                         resultIntent.putExtra(Simplenote.DELETED_NOTE_ID, mNote.getSimperiumKey());      </span>
<span class="2925812847088143790" onmouseenter="enter('2925812847088143790');" onmouseout="out('2925812847088143790');" style=""> 305                     getActivity().setResult(Activity.RESULT_OK, resultIntent);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306                 }                                                                                        </span>
<span  style=""> 307                                                                                                          </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 308                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 309                 return true;                                                                             </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 310             case android.R.id.home:                                                                      </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 311                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 312                 return true;                                                                             </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 313             default:                                                                                     </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 314                 return super.onOptionsItemSelected(item);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="8271468180839847847" onmouseenter="enter('8271468180839847847');" onmouseout="out('8271468180839847847');" style=""> 318     // show a popup view from the info action bar item                                                   </span>
<span class="301694884727727095" onmouseenter="enter('301694884727727095');" onmouseout="out('301694884727727095');" style=""> 319     private void showInfoPopup(View view) {                                                              </span>
<span class="-8824124309160747557" onmouseenter="enter('-8824124309160747557');" onmouseout="out('-8824124309160747557');" style=""> 320         if (!isAdded() || view == null) return;                                                          </span>
<span  style=""> 321                                                                                                          </span>
<span class="-6163322818153177863" onmouseenter="enter('-6163322818153177863');" onmouseout="out('-6163322818153177863');" style=""> 322         if (mInfoPopupWindow == null) {                                                                  </span>
<span class="6416634994496998699" onmouseenter="enter('6416634994496998699');" onmouseout="out('6416634994496998699');" style=""> 323             mInfoPopupWindow = new PopupWindow(getActivity());                                           </span>
<span class="-7704183450622301834" onmouseenter="enter('-7704183450622301834');" onmouseout="out('-7704183450622301834');" style=""> 324             mInfoPopupWindow.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);                          </span>
<span class="-3987029803100381492" onmouseenter="enter('-3987029803100381492');" onmouseout="out('-3987029803100381492');" style=""> 325             mInfoPopupWindow.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);                         </span>
<span class="-8327124619089985465" onmouseenter="enter('-8327124619089985465');" onmouseout="out('-8327124619089985465');" style=""> 326             mInfoPopupWindow.setBackgroundDrawable(new ColorDrawable(0));                                </span>
<span class="3466073935356821559" onmouseenter="enter('3466073935356821559');" onmouseout="out('3466073935356821559');" style=""> 327             mInfoPopupWindow.setOutsideTouchable(true);                                                  </span>
<span class="-1875471742113799055" onmouseenter="enter('-1875471742113799055');" onmouseout="out('-1875471742113799055');" style=""> 328             mInfoPopupWindow.setFocusable(true);                                                         </span>
<span  style=""> 329                                                                                                          </span>
<span class="5212568524712573915" onmouseenter="enter('5212568524712573915');" onmouseout="out('5212568524712573915');" style=""> 330             LayoutInflater inflater = LayoutInflater.from(getActivity());                                </span>
<span class="-7758049233010801507" onmouseenter="enter('-7758049233010801507');" onmouseout="out('-7758049233010801507');" style=""> 331             View popupView = inflater.inflate(R.layout.popup_info, null);                                </span>
<span class="536077715701124131" onmouseenter="enter('536077715701124131');" onmouseout="out('536077715701124131');" style=""> 332             mInfoPopupWindow.setContentView(popupView);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333         }                                                                                                </span>
<span  style=""> 334                                                                                                          </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 335         updateInfoPopup();                                                                               </span>
<span  style=""> 336                                                                                                          </span>
<span class="4487253113225225144" onmouseenter="enter('4487253113225225144');" onmouseout="out('4487253113225225144');" style=""> 337         mInfoPopupWindow.showAsDropDown(view);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338     }                                                                                                    </span>
<span  style=""> 339                                                                                                          </span>
<span class="-8758077771583595367" onmouseenter="enter('-8758077771583595367');" onmouseout="out('-8758077771583595367');" style=""> 340     // update the content of the popupview                                                               </span>
<span class="-7181846678873590508" onmouseenter="enter('-7181846678873590508');" onmouseout="out('-7181846678873590508');" style=""> 341     private void updateInfoPopup() {                                                                     </span>
<span class="-8697403400729029020" onmouseenter="enter('-8697403400729029020');" onmouseout="out('-8697403400729029020');" style=""> 342         if (mInfoPopupWindow == null || mInfoPopupWindow.getContentView() == null) return;               </span>
<span  style=""> 343                                                                                                          </span>
<span class="3837773520867540996" onmouseenter="enter('3837773520867540996');" onmouseout="out('3837773520867540996');" style=""> 344         View popupView = mInfoPopupWindow.getContentView();                                              </span>
<span  style=""> 345                                                                                                          </span>
<span class="-5563348291777194716" onmouseenter="enter('-5563348291777194716');" onmouseout="out('-5563348291777194716');" style=""> 346         View publishButton = popupView.findViewById(R.id.publish_note_button);                           </span>
<span class="4581310412057978293" onmouseenter="enter('4581310412057978293');" onmouseout="out('4581310412057978293');" style=""> 347         TextView publishButtonTextView = (TextView)popupView.findViewById(R.id.publish_note_button_text);</span>
<span class="-6410915739065156574" onmouseenter="enter('-6410915739065156574');" onmouseout="out('-6410915739065156574');" style=""> 348         ImageView publishButtonIcon = (ImageView)popupView.findViewById(R.id.publish_note_button_icon);  </span>
<span class="-6918482493044946592" onmouseenter="enter('-6918482493044946592');" onmouseout="out('-6918482493044946592');" style=""> 349         TextView publishTextView = (TextView) popupView.findViewById(R.id.publish_url_textview);         </span>
<span class="1038347291336054559" onmouseenter="enter('1038347291336054559');" onmouseout="out('1038347291336054559');" style=""> 350         TextView wordCountTextView = (TextView) popupView.findViewById(R.id.word_count);                 </span>
<span class="-7977646551049898553" onmouseenter="enter('-7977646551049898553');" onmouseout="out('-7977646551049898553');" style=""> 351         ImageButton publishCopyButton = (ImageButton) popupView.findViewById(R.id.publish_copy_url);     </span>
<span class="7101383467626352915" onmouseenter="enter('7101383467626352915');" onmouseout="out('7101383467626352915');" style=""> 352         ImageButton publishShareButton = (ImageButton) popupView.findViewById(R.id.publish_share_url);   </span>
<span class="3150325744662714786" onmouseenter="enter('3150325744662714786');" onmouseout="out('3150325744662714786');" style=""> 353         View actionsView = popupView.findViewById(R.id.publish_actions);                                 </span>
<span  style=""> 354                                                                                                          </span>
<span class="1432622249676412210" onmouseenter="enter('1432622249676412210');" onmouseout="out('1432622249676412210');" style=""><abbr title=" 355         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcher);"> 355         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcheðŸ”µ</abbr></span>
<span  style=""> 356                                                                                                          </span>
<span class="-7759606836018483289" onmouseenter="enter('-7759606836018483289');" onmouseout="out('-7759606836018483289');" style=""> 357         publishButton.setOnClickListener(new View.OnClickListener() {                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 358             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 359             public void onClick(View v) {                                                                </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 360                 if (mNote != null) {                                                                     </span>
<span class="5563864695602119989" onmouseenter="enter('5563864695602119989');" onmouseout="out('5563864695602119989');" style=""> 361                     boolean newPublishedStatus = !mNote.isPublished();                                   </span>
<span class="-3191807331109519265" onmouseenter="enter('-3191807331109519265');" onmouseout="out('-3191807331109519265');" style=""> 362                     mNote.setPublished(newPublishedStatus);                                              </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 363                     mNote.save();                                                                        </span>
<span  style=""> 364                                                                                                          </span>
<span class="-6566894946886815467" onmouseenter="enter('-6566894946886815467');" onmouseout="out('-6566894946886815467');" style=""> 365                     if (viewSwitcher.getDisplayedChild() == 0) {                                         </span>
<span class="1964540099195163034" onmouseenter="enter('1964540099195163034');" onmouseout="out('1964540099195163034');" style=""> 366                         viewSwitcher.showNext();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367                     }                                                                                    </span>
<span  style=""> 368                                                                                                          </span>
<span class="3198515589608942377" onmouseenter="enter('3198515589608942377');" onmouseout="out('3198515589608942377');" style=""> 369                     // reset publish status in 20 seconds if we don&#x27;t hear back from Simperium           </span>
<span class="-4829904289357833951" onmouseenter="enter('-4829904289357833951');" onmouseout="out('-4829904289357833951');" style=""> 370                     mPublishTimeoutHandler.postDelayed(mPublishTimeoutRunnable, 20000);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 373         });                                                                                              </span>
<span  style=""> 374                                                                                                          </span>
<span class="4045844893437359317" onmouseenter="enter('4045844893437359317');" onmouseout="out('4045844893437359317');" style=""> 375         publishTextView.setOnClickListener(new View.OnClickListener() {                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 376             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 377             public void onClick(View v) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 378                 try {                                                                                    </span>
<span class="-8142976939479350202" onmouseenter="enter('-8142976939479350202');" onmouseout="out('-8142976939479350202');" style=""> 379                     startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(mNote.getPublishedUrl())));   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 380                 } catch (Exception e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 381                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 384         });                                                                                              </span>
<span  style=""> 385                                                                                                          </span>
<span class="-6950650320634084190" onmouseenter="enter('-6950650320634084190');" onmouseout="out('-6950650320634084190');" style=""> 386         publishCopyButton.setOnClickListener(new View.OnClickListener() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 388             public void onClick(View v) {                                                                </span>
<span class="4796955211675373396" onmouseenter="enter('4796955211675373396');" onmouseout="out('4796955211675373396');" style=""><abbr title=" 389                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 389                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLðŸ”µ</abbr></span>
<span class="-7278433972965562810" onmouseenter="enter('-7278433972965562810');" onmouseout="out('-7278433972965562810');" style=""><abbr title=" 390                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrl());"> 390                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrlðŸ”µ</abbr></span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 391                 clipboard.setPrimaryClip(clip);                                                          </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 392                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 392                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 393             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 394         });                                                                                              </span>
<span  style=""> 395                                                                                                          </span>
<span class="7858974346508965340" onmouseenter="enter('7858974346508965340');" onmouseout="out('7858974346508965340');" style=""> 396         publishShareButton.setOnClickListener(new View.OnClickListener() {                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 397             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 398             public void onClick(View v) {                                                                </span>
<span class="-1084258541936962831" onmouseenter="enter('-1084258541936962831');" onmouseout="out('-1084258541936962831');" style=""> 399                 Intent i = new Intent(Intent.ACTION_SEND);                                               </span>
<span class="-4820203166518762252" onmouseenter="enter('-4820203166518762252');" onmouseout="out('-4820203166518762252');" style=""> 400                 i.setType(&quot;text/plain&quot;);                                                                 </span>
<span class="-6000923337939610903" onmouseenter="enter('-6000923337939610903');" onmouseout="out('-6000923337939610903');" style=""> 401                 i.putExtra(Intent.EXTRA_TEXT, mNote.getPublishedUrl());                                  </span>
<span class="3733331565586339944" onmouseenter="enter('3733331565586339944');" onmouseout="out('3733331565586339944');" style=""> 402                 startActivity(Intent.createChooser(i, getString(R.string.share_url)));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 404         });                                                                                              </span>
<span  style=""> 405                                                                                                          </span>
<span class="-2067876314787213528" onmouseenter="enter('-2067876314787213528');" onmouseout="out('-2067876314787213528');" style=""> 406         updateWordCount(wordCountTextView);                                                              </span>
<span  style=""> 407                                                                                                          </span>
<span class="-1365615346790030662" onmouseenter="enter('-1365615346790030662');" onmouseout="out('-1365615346790030662');" style=""> 408         if (mNote.isPublished()) {                                                                       </span>
<span class="-8174565940676304202" onmouseenter="enter('-8174565940676304202');" onmouseout="out('-8174565940676304202');" style=""> 409             publishButtonTextView.setText(getString(R.string.published));                                </span>
<span class="8297531220637406295" onmouseenter="enter('8297531220637406295');" onmouseout="out('8297531220637406295');" style=""> 410             publishButtonIcon.setVisibility(View.VISIBLE);                                               </span>
<span class="-2988513566372186325" onmouseenter="enter('-2988513566372186325');" onmouseout="out('-2988513566372186325');" style=""> 411             publishTextView.setText(mNote.getPublishedUrl());                                            </span>
<span class="6413899042811805294" onmouseenter="enter('6413899042811805294');" onmouseout="out('6413899042811805294');" style=""> 412             actionsView.setVisibility(View.VISIBLE);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413         } else {                                                                                         </span>
<span class="843719504642786212" onmouseenter="enter('843719504642786212');" onmouseout="out('843719504642786212');" style=""> 414             publishButtonTextView.setText(getString(R.string.publish));                                  </span>
<span class="-2250731724671553485" onmouseenter="enter('-2250731724671553485');" onmouseout="out('-2250731724671553485');" style=""> 415             publishButtonIcon.setVisibility(View.GONE);                                                  </span>
<span class="1035970444036754268" onmouseenter="enter('1035970444036754268');" onmouseout="out('1035970444036754268');" style=""> 416             actionsView.setVisibility(View.GONE);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span  style=""> 418                                                                                                          </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 419         Simplenote currentApp = (Simplenote) getActivity().getApplication();                             </span>
<span class="-1805411858302537149" onmouseenter="enter('-1805411858302537149');" onmouseout="out('-1805411858302537149');" style=""> 420         if (currentApp.getSimperium().needsAuthorization()) {                                            </span>
<span class="5338357254244494547" onmouseenter="enter('5338357254244494547');" onmouseout="out('5338357254244494547');" style=""> 421             viewSwitcher.setVisibility(View.GONE);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 422         } else {                                                                                         </span>
<span class="4598892846854382425" onmouseenter="enter('4598892846854382425');" onmouseout="out('4598892846854382425');" style=""> 423             viewSwitcher.setVisibility(View.VISIBLE);                                                    </span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 424             if (viewSwitcher.getDisplayedChild() == 1) {                                                 </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 425                 viewSwitcher.showPrevious();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428     }                                                                                                    </span>
<span  style=""> 429                                                                                                          </span>
<span class="2878966018694925493" onmouseenter="enter('2878966018694925493');" onmouseout="out('2878966018694925493');" style=""> 430     private boolean noteIsEmpty() {                                                                      </span>
<span class="5142306291108152313" onmouseenter="enter('5142306291108152313');" onmouseout="out('5142306291108152313');" style=""> 431         return (getNoteContentString().trim().length() == 0 &amp;&amp; getNoteTagsString().trim().length() == 0);</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432     }                                                                                                    </span>
<span  style=""> 433                                                                                                          </span>
<span class="8710628914141899315" onmouseenter="enter('8710628914141899315');" onmouseout="out('8710628914141899315');" style=""> 434     public void setNote(String noteID){                                                                  </span>
<span class="-6972394152055286124" onmouseenter="enter('-6972394152055286124');" onmouseout="out('-6972394152055286124');" style=""> 435         setNote(noteID, null);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436     }                                                                                                    </span>
<span  style=""> 437                                                                                                          </span>
<span class="8195105300246755684" onmouseenter="enter('8195105300246755684');" onmouseout="out('8195105300246755684');" style=""> 438     public void setNote(String noteID, String matchOffsets) {                                            </span>
<span class="-3646372507164546123" onmouseenter="enter('-3646372507164546123');" onmouseout="out('-3646372507164546123');" style=""> 439         if (mAutoSaveHandler != null)                                                                    </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 440             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span  style=""> 441                                                                                                          </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 442         mPlaceholderView.setVisibility(View.GONE);                                                       </span>
<span  style=""> 443                                                                                                          </span>
<span class="2077738191995360697" onmouseenter="enter('2077738191995360697');" onmouseout="out('2077738191995360697');" style=""> 444         if (matchOffsets != null)                                                                        </span>
<span class="76822769413740338" onmouseenter="enter('76822769413740338');" onmouseout="out('76822769413740338');" style=""> 445             mMatchOffsets = matchOffsets;                                                                </span>
<span  style=""> 446                                                                                                          </span>
<span class="-4019470309104916899" onmouseenter="enter('-4019470309104916899');" onmouseout="out('-4019470309104916899');" style=""> 447         // If we have a note already (on a tablet in landscape), save the note.                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 448         if (mNote != null) {                                                                             </span>
<span class="4900947620417658692" onmouseenter="enter('4900947620417658692');" onmouseout="out('4900947620417658692');" style=""> 449             if (mIsNewNote &amp;&amp; noteIsEmpty())                                                             </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 450                 mNote.delete();                                                                          </span>
<span class="-2440894158330100228" onmouseenter="enter('-2440894158330100228');" onmouseout="out('-2440894158330100228');" style=""> 451             else if (mNote != null)                                                                      </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 452                 saveNote();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453         }                                                                                                </span>
<span  style=""> 454                                                                                                          </span>
<span class="-3492920802008394842" onmouseenter="enter('-3492920802008394842');" onmouseout="out('-3492920802008394842');" style=""> 455         new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, noteID);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456     }                                                                                                    </span>
<span  style=""> 457                                                                                                          </span>
<span class="-3433185850424102984" onmouseenter="enter('-3433185850424102984');" onmouseout="out('-3433185850424102984');" style=""> 458     public void updateNote(Note updatedNote) {                                                           </span>
<span class="1053945494720623403" onmouseenter="enter('1053945494720623403');" onmouseout="out('1053945494720623403');" style=""> 459         // update note if network change arrived                                                         </span>
<span class="8715526790189509580" onmouseenter="enter('8715526790189509580');" onmouseout="out('8715526790189509580');" style=""> 460         mNote = updatedNote;                                                                             </span>
<span class="-1082183570760036139" onmouseenter="enter('-1082183570760036139');" onmouseout="out('-1082183570760036139');" style=""> 461         refreshContent(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462     }                                                                                                    </span>
<span  style=""> 463                                                                                                          </span>
<span class="-5323752859114125708" onmouseenter="enter('-5323752859114125708');" onmouseout="out('-5323752859114125708');" style=""> 464     public void refreshContent(boolean isNoteUpdate) {                                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 465         if (mNote != null) {                                                                             </span>
<span class="9083634457699551889" onmouseenter="enter('9083634457699551889');" onmouseout="out('9083634457699551889');" style=""> 466             // Restore the cursor position if possible.                                                  </span>
<span  style=""> 467                                                                                                          </span>
<span class="-3899995221280134201" onmouseenter="enter('-3899995221280134201');" onmouseout="out('-3899995221280134201');" style=""><abbr title=" 468             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.getSelectionEnd());"> 468             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEdðŸ”µ</abbr></span>
<span  style=""> 469                                                                                                          </span>
<span class="4148799213240179760" onmouseenter="enter('4148799213240179760');" onmouseout="out('4148799213240179760');" style=""> 470             mContentEditText.setText(mNote.getContent());                                                </span>
<span  style=""> 471                                                                                                          </span>
<span class="2353268123342341866" onmouseenter="enter('2353268123342341866');" onmouseout="out('2353268123342341866');" style=""> 472             if (isNoteUpdate) {                                                                          </span>
<span class="-1678402685678405938" onmouseenter="enter('-1678402685678405938');" onmouseout="out('-1678402685678405938');" style=""> 473                 // Save the note so any local changes get synced                                         </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 474                 mNote.save();                                                                            </span>
<span  style=""> 475                                                                                                          </span>
<span class="-5094013145931261947" onmouseenter="enter('-5094013145931261947');" onmouseout="out('-5094013145931261947');" style=""><abbr title=" 476                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) {"> 476                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) ðŸ”µ</abbr></span>
<span class="2096054726124109686" onmouseenter="enter('2096054726124109686');" onmouseout="out('2096054726124109686');" style=""> 477                     mContentEditText.setSelection(cursorPosition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 479             }                                                                                            </span>
<span  style=""> 480                                                                                                          </span>
<span class="-2853209662220592982" onmouseenter="enter('-2853209662220592982');" onmouseout="out('-2853209662220592982');" style=""> 481             afterTextChanged(mContentEditText.getText());                                                </span>
<span  style=""> 482                                                                                                          </span>
<span class="8723833736514346639" onmouseenter="enter('8723833736514346639');" onmouseout="out('8723833736514346639');" style=""> 483             mPinButton.setChecked(mNote.isPinned());                                                     </span>
<span  style=""> 484                                                                                                          </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 485             updateTagList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487     }                                                                                                    </span>
<span  style=""> 488                                                                                                          </span>
<span class="-5496131723873966197" onmouseenter="enter('-5496131723873966197');" onmouseout="out('-5496131723873966197');" style=""> 489     public void updateTagList() {                                                                        </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 490         Activity activity = getActivity();                                                               </span>
<span class="5732290278551506292" onmouseenter="enter('5732290278551506292');" onmouseout="out('5732290278551506292');" style=""> 491         if (activity == null) return;                                                                    </span>
<span  style=""> 492                                                                                                          </span>
<span class="-8748481830530330770" onmouseenter="enter('-8748481830530330770');" onmouseout="out('-8748481830530330770');" style=""> 493         // Populate this note&#x27;s tags in the tagView                                                      </span>
<span class="-3805230291902185366" onmouseenter="enter('-3805230291902185366');" onmouseout="out('-3805230291902185366');" style=""> 494         mTagView.setChips(mNote.getTagString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495     }                                                                                                    </span>
<span  style=""> 496                                                                                                          </span>
<span class="-3598917219400102100" onmouseenter="enter('-3598917219400102100');" onmouseout="out('-3598917219400102100');" style=""> 497     int newCursorLocation(String newText, String oldText, int cursorLocation) {                          </span>
<span class="9215253731107462720" onmouseenter="enter('9215253731107462720');" onmouseout="out('9215253731107462720');" style=""> 498         // Ported from the iOS app :)                                                                    </span>
<span class="746416875920517525" onmouseenter="enter('746416875920517525');" onmouseout="out('746416875920517525');" style=""> 499         // Cases:                                                                                        </span>
<span class="5532692154938930485" onmouseenter="enter('5532692154938930485');" onmouseout="out('5532692154938930485');" style=""> 500         // 0. All text after cursor (and possibly more) was removed ==&gt; put cursor at end                </span>
<span class="7679522442911259243" onmouseenter="enter('7679522442911259243');" onmouseout="out('7679522442911259243');" style=""> 501         // 1. Text was added after the cursor ==&gt; no change                                              </span>
<span class="-7894032746042607578" onmouseenter="enter('-7894032746042607578');" onmouseout="out('-7894032746042607578');" style=""> 502         // 2. Text was added before the cursor ==&gt; location advances                                     </span>
<span class="-2716138352653500367" onmouseenter="enter('-2716138352653500367');" onmouseout="out('-2716138352653500367');" style=""> 503         // 3. Text was removed after the cursor ==&gt; no change                                            </span>
<span class="-5135222146548415418" onmouseenter="enter('-5135222146548415418');" onmouseout="out('-5135222146548415418');" style=""> 504         // 4. Text was removed before the cursor ==&gt; location retreats                                   </span>
<span class="-7558810491072030947" onmouseenter="enter('-7558810491072030947');" onmouseout="out('-7558810491072030947');" style=""> 505         // 5. Text was added/removed on both sides of the cursor ==&gt; not handled                         </span>
<span  style=""> 506                                                                                                          </span>
<span class="2494517364842646163" onmouseenter="enter('2494517364842646163');" onmouseout="out('2494517364842646163');" style=""> 507         int newCursorLocation = cursorLocation;                                                          </span>
<span  style=""> 508                                                                                                          </span>
<span class="5908042661332565473" onmouseenter="enter('5908042661332565473');" onmouseout="out('5908042661332565473');" style=""> 509         int deltaLength = newText.length() - oldText.length();                                           </span>
<span  style=""> 510                                                                                                          </span>
<span class="-6285488792309831531" onmouseenter="enter('-6285488792309831531');" onmouseout="out('-6285488792309831531');" style=""> 511         // Case 0                                                                                        </span>
<span class="-3414403190560247865" onmouseenter="enter('-3414403190560247865');" onmouseout="out('-3414403190560247865');" style=""> 512         if (newText.length() &lt; cursorLocation)                                                           </span>
<span class="-8431314608568195365" onmouseenter="enter('-8431314608568195365');" onmouseout="out('-8431314608568195365');" style=""> 513             return newText.length();                                                                     </span>
<span  style=""> 514                                                                                                          </span>
<span class="-8591384106259708496" onmouseenter="enter('-8591384106259708496');" onmouseout="out('-8591384106259708496');" style=""> 515         boolean beforeCursorMatches = false;                                                             </span>
<span class="-2836779116340504068" onmouseenter="enter('-2836779116340504068');" onmouseout="out('-2836779116340504068');" style=""> 516         boolean afterCursorMatches = false;                                                              </span>
<span  style=""> 517                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 518         try {                                                                                            </span>
<span class="535177221055952012" onmouseenter="enter('535177221055952012');" onmouseout="out('535177221055952012');" style=""><abbr title=" 519             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation));"> 519             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorðŸ”µ</abbr></span>
<span class="-6954326744185480821" onmouseenter="enter('-6954326744185480821');" onmouseout="out('-6954326744185480821');" style=""><abbr title=" 520             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursorLocation + deltaLength, newText.length()));"> 520             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 521         } catch (Exception e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 522             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523         }                                                                                                </span>
<span  style=""> 524                                                                                                          </span>
<span class="-8188204612528872149" onmouseenter="enter('-8188204612528872149');" onmouseout="out('-8188204612528872149');" style=""> 525         // Cases 2 and 4                                                                                 </span>
<span class="6616414540674367624" onmouseenter="enter('6616414540674367624');" onmouseout="out('6616414540674367624');" style=""> 526         if (!beforeCursorMatches &amp;&amp; afterCursorMatches)                                                  </span>
<span class="-4510977125628343614" onmouseenter="enter('-4510977125628343614');" onmouseout="out('-4510977125628343614');" style=""> 527             newCursorLocation += deltaLength;                                                            </span>
<span  style=""> 528                                                                                                          </span>
<span class="6867115481875645839" onmouseenter="enter('6867115481875645839');" onmouseout="out('6867115481875645839');" style=""> 529         // Cases 1, 3 and 5 have no change                                                               </span>
<span class="-7784410696724573059" onmouseenter="enter('-7784410696724573059');" onmouseout="out('-7784410696724573059');" style=""> 530         return newCursorLocation;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531     }                                                                                                    </span>
<span  style=""> 532                                                                                                          </span>
<span class="-4880079435078668080" onmouseenter="enter('-4880079435078668080');" onmouseout="out('-4880079435078668080');" style=""> 533     private Runnable mAutoSaveRunnable = new Runnable() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 534         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 535         public void run() {                                                                              </span>
<span class="-2186856349666885424" onmouseenter="enter('-2186856349666885424');" onmouseout="out('-2186856349666885424');" style=""> 536             saveAndSyncNote();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 538     };                                                                                                   </span>
<span  style=""> 539                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 540     @Override                                                                                            </span>
<span class="-2796122281296135687" onmouseenter="enter('-2796122281296135687');" onmouseout="out('-2796122281296135687');" style=""> 541     public void onTagsChanged(String tagString) {                                                        </span>
<span class="5357705753761437027" onmouseenter="enter('5357705753761437027');" onmouseout="out('5357705753761437027');" style=""> 542         if (mNote == null || !isAdded()) return;                                                         </span>
<span  style=""> 543                                                                                                          </span>
<span class="-6077287130430406243" onmouseenter="enter('-6077287130430406243');" onmouseout="out('-6077287130430406243');" style=""> 544         if (mNote.getTagString() != null &amp;&amp; tagString.length() &gt; mNote.getTagString().length()) {        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 545             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 546                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 547                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="5410511239462362052" onmouseenter="enter('5410511239462362052');" onmouseout="out('5410511239462362052');" style=""> 548                             .setAction(&quot;added_tag&quot;)                                                      </span>
<span class="-4831158292382506824" onmouseenter="enter('-4831158292382506824');" onmouseout="out('-4831158292382506824');" style=""> 549                             .setLabel(&quot;tag_added_to_note&quot;)                                               </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 550                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 551             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 552         }                                                                                                </span>
<span class="4391598042186419731" onmouseenter="enter('4391598042186419731');" onmouseout="out('4391598042186419731');" style=""> 553         else {                                                                                           </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 554             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 555                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 556                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="-1624008121867682947" onmouseenter="enter('-1624008121867682947');" onmouseout="out('-1624008121867682947');" style=""> 557                             .setAction(&quot;removed_tag&quot;)                                                    </span>
<span class="-6979485583008136850" onmouseenter="enter('-6979485583008136850');" onmouseout="out('-6979485583008136850');" style=""> 558                             .setLabel(&quot;tag_removed_from_note&quot;)                                           </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 559                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 560             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 561         }                                                                                                </span>
<span  style=""> 562                                                                                                          </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 563         mNote.setTagString(tagString);                                                                   </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 564         mNote.setModificationDate(Calendar.getInstance());                                               </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 565         updateTagList();                                                                                 </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 566         mNote.save();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 569     @Override                                                                                            </span>
<span class="-5110897291356760413" onmouseenter="enter('-5110897291356760413');" onmouseout="out('-5110897291356760413');" style=""> 570     public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {                    </span>
<span class="7490540504293754116" onmouseenter="enter('7490540504293754116');" onmouseout="out('7490540504293754116');" style=""> 571         // Unused                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572     }                                                                                                    </span>
<span  style=""> 573                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 574     @Override                                                                                            </span>
<span class="-3169498224421089624" onmouseenter="enter('-3169498224421089624');" onmouseout="out('-3169498224421089624');" style=""> 575     public void afterTextChanged(Editable editable) {                                                    </span>
<span class="7005237563799171506" onmouseenter="enter('7005237563799171506');" onmouseout="out('7005237563799171506');" style=""> 576         setTitleSpan(editable);                                                                          </span>
<span class="4641646211430236365" onmouseenter="enter('4641646211430236365');" onmouseout="out('4641646211430236365');" style=""> 577         attemptAutoList(editable);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 578     }                                                                                                    </span>
<span  style=""> 579                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 580     @Override                                                                                            </span>
<span class="-6004971105578563950" onmouseenter="enter('-6004971105578563950');" onmouseout="out('-6004971105578563950');" style=""> 581     public void onTextChanged(CharSequence charSequence, int start, int before, int count) {             </span>
<span  style=""> 582                                                                                                          </span>
<span class="2036741165452809133" onmouseenter="enter('2036741165452809133');" onmouseout="out('2036741165452809133');" style=""> 583         // When text changes, start timer that will fire after AUTOSAVE_DELAY_MILLIS passes              </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 584         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 585             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="3237260668993885548" onmouseenter="enter('3237260668993885548');" onmouseout="out('3237260668993885548');" style=""> 586             mAutoSaveHandler.postDelayed(mAutoSaveRunnable, AUTOSAVE_DELAY_MILLIS);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 587         }                                                                                                </span>
<span  style=""> 588                                                                                                          </span>
<span class="5409551732025834677" onmouseenter="enter('5409551732025834677');" onmouseout="out('5409551732025834677');" style=""> 589         // Remove search highlight spans when note content changes                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 590         if (mMatchOffsets != null) {                                                                     </span>
<span class="-5254682256162211718" onmouseenter="enter('-5254682256162211718');" onmouseout="out('-5254682256162211718');" style=""> 591             mMatchOffsets = null;                                                                        </span>
<span class="2930846742809702691" onmouseenter="enter('2930846742809702691');" onmouseout="out('2930846742809702691');" style=""> 592             mHighlighter.removeMatches();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 594     }                                                                                                    </span>
<span  style=""> 595                                                                                                          </span>
<span class="6849776144692122373" onmouseenter="enter('6849776144692122373');" onmouseout="out('6849776144692122373');" style=""> 596     private void setTitleSpan(Editable editable) {                                                       </span>
<span class="-1378972571136516392" onmouseenter="enter('-1378972571136516392');" onmouseout="out('-1378972571136516392');" style=""> 597         // Set the note title to be a larger size                                                        </span>
<span class="3997786880116952820" onmouseenter="enter('3997786880116952820');" onmouseout="out('3997786880116952820');" style=""> 598         // Remove any existing size spans                                                                </span>
<span class="-8972916714996192672" onmouseenter="enter('-8972916714996192672');" onmouseout="out('-8972916714996192672');" style=""> 599         RelativeSizeSpan spans[] = editable.getSpans(0, editable.length(), RelativeSizeSpan.class);      </span>
<span class="2386014209880419735" onmouseenter="enter('2386014209880419735');" onmouseout="out('2386014209880419735');" style=""> 600         for (RelativeSizeSpan span : spans) {                                                            </span>
<span class="-4538099325482792099" onmouseenter="enter('-4538099325482792099');" onmouseout="out('-4538099325482792099');" style=""> 601             editable.removeSpan(span);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 602         }                                                                                                </span>
<span class="-901734861574280266" onmouseenter="enter('-901734861574280266');" onmouseout="out('-901734861574280266');" style=""> 603         int newLinePosition = getNoteContentString().indexOf(&quot;\n&quot;);                                      </span>
<span class="-2560738681101946885" onmouseenter="enter('-2560738681101946885');" onmouseout="out('-2560738681101946885');" style=""> 604         if (newLinePosition == 0)                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 605             return;                                                                                      </span>
<span class="-2775800673646162791" onmouseenter="enter('-2775800673646162791');" onmouseout="out('-2775800673646162791');" style=""><abbr title=" 606         editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 606         editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607     }                                                                                                    </span>
<span  style=""> 608                                                                                                          </span>
<span class="8395667075038215241" onmouseenter="enter('8395667075038215241');" onmouseout="out('8395667075038215241');" style=""> 609     private void attemptAutoList(Editable editable) {                                                    </span>
<span class="1630313539519665774" onmouseenter="enter('1630313539519665774');" onmouseout="out('1630313539519665774');" style=""> 610         int oldCursorPosition = mCurrentCursorPosition;                                                  </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 611         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="-1456162723219098064" onmouseenter="enter('-1456162723219098064');" onmouseout="out('-1456162723219098064');" style=""> 612         AutoBullet.apply(editable, oldCursorPosition, mCurrentCursorPosition);                           </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 613         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="6723912502491086435" onmouseenter="enter('6723912502491086435');" onmouseout="out('6723912502491086435');" style=""> 614         android.util.Log.d(&quot;Simplenote&quot;, &quot;==&gt; post cursor position:&quot; + mCurrentCursorPosition);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 615     }                                                                                                    </span>
<span  style=""> 616                                                                                                          </span>
<span class="-6933317077070028336" onmouseenter="enter('-6933317077070028336');" onmouseout="out('-6933317077070028336');" style=""> 617     private void saveAndSyncNote() {                                                                     </span>
<span class="8223376420483055518" onmouseenter="enter('8223376420483055518');" onmouseout="out('8223376420483055518');" style=""> 618         if (mNote == null)                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 619             return;                                                                                      </span>
<span  style=""> 620                                                                                                          </span>
<span class="5987107161692050970" onmouseenter="enter('5987107161692050970');" onmouseout="out('5987107161692050970');" style=""> 621         new saveNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 622     }                                                                                                    </span>
<span  style=""> 623                                                                                                          </span>
<span class="-4564004023547017377" onmouseenter="enter('-4564004023547017377');" onmouseout="out('-4564004023547017377');" style=""> 624     public void setPlaceholderVisible(boolean isVisible) {                                               </span>
<span class="-6467031518050872536" onmouseenter="enter('-6467031518050872536');" onmouseout="out('-6467031518050872536');" style=""> 625         if (isVisible) {                                                                                 </span>
<span class="1687907534970456445" onmouseenter="enter('1687907534970456445');" onmouseout="out('1687907534970456445');" style=""> 626             mNote = null;                                                                                </span>
<span class="-3407359796970873837" onmouseenter="enter('-3407359796970873837');" onmouseout="out('-3407359796970873837');" style=""> 627             mContentEditText.setText(&quot;&quot;);                                                                </span>
<span class="-7997465605671669559" onmouseenter="enter('-7997465605671669559');" onmouseout="out('-7997465605671669559');" style=""> 628             mTagView.setText(&quot;&quot;);                                                                        </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 629             if (mPlaceholderView != null)                                                                </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 630                 mPlaceholderView.setVisibility(View.VISIBLE);                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 631         } else {                                                                                         </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 632             if (mPlaceholderView != null)                                                                </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 633                 mPlaceholderView.setVisibility(View.GONE);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 634         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635     }                                                                                                    </span>
<span  style=""> 636                                                                                                          </span>
<span class="7106522413253020021" onmouseenter="enter('7106522413253020021');" onmouseout="out('7106522413253020021');" style=""> 637     public void setIsNewNote(boolean isNewNote) {                                                        </span>
<span class="-5949421386499580587" onmouseenter="enter('-5949421386499580587');" onmouseout="out('-5949421386499580587');" style=""> 638         this.mIsNewNote = isNewNote;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639     }                                                                                                    </span>
<span  style=""> 640                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 641     @Override                                                                                            </span>
<span class="-3315120631467309087" onmouseenter="enter('-3315120631467309087');" onmouseout="out('-3315120631467309087');" style=""> 642     public void onFocusChange(View v, boolean hasFocus) {                                                </span>
<span class="-6285712256166584728" onmouseenter="enter('-6285712256166584728');" onmouseout="out('-6285712256166584728');" style=""> 643         if (!hasFocus) {                                                                                 </span>
<span class="-6666174322440118634" onmouseenter="enter('-6666174322440118634');" onmouseout="out('-6666174322440118634');" style=""> 644             String tagString = getNoteTagsString().trim();                                               </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 645             if (tagString.length() &gt; 0) {                                                                </span>
<span class="8488340728323435918" onmouseenter="enter('8488340728323435918');" onmouseout="out('8488340728323435918');" style=""> 646                 mTagView.setChips(tagString);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 647             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 648         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649     }                                                                                                    </span>
<span  style=""> 650                                                                                                          </span>
<span class="-6849832043716883515" onmouseenter="enter('-6849832043716883515');" onmouseout="out('-6849832043716883515');" style=""> 651     public Note getNote() {                                                                              </span>
<span class="6687317620803594982" onmouseenter="enter('6687317620803594982');" onmouseout="out('6687317620803594982');" style=""> 652         return mNote;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 653     }                                                                                                    </span>
<span  style=""> 654                                                                                                          </span>
<span class="5855058962481175207" onmouseenter="enter('5855058962481175207');" onmouseout="out('5855058962481175207');" style=""> 655     public String getNoteContentString() {                                                               </span>
<span class="-8451380960236704581" onmouseenter="enter('-8451380960236704581');" onmouseout="out('-8451380960236704581');" style=""> 656         if (mContentEditText == null || mContentEditText.getText() == null) {                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 657             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 658         } else {                                                                                         </span>
<span class="9069870454824528783" onmouseenter="enter('9069870454824528783');" onmouseout="out('9069870454824528783');" style=""> 659             return mContentEditText.getText().toString();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661     }                                                                                                    </span>
<span  style=""> 662                                                                                                          </span>
<span class="2486113532203564324" onmouseenter="enter('2486113532203564324');" onmouseout="out('2486113532203564324');" style=""> 663     public String getNoteTagsString() {                                                                  </span>
<span class="2201751553125502793" onmouseenter="enter('2201751553125502793');" onmouseout="out('2201751553125502793');" style=""> 664         if (mTagView == null || mTagView.getText() == null) {                                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 665             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 666         } else {                                                                                         </span>
<span class="-3768945108519459655" onmouseenter="enter('-3768945108519459655');" onmouseout="out('-3768945108519459655');" style=""> 667             return mTagView.getText().toString();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 668         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 669     }                                                                                                    </span>
<span  style=""> 670                                                                                                          </span>
<span class="4832835199818847464" onmouseenter="enter('4832835199818847464');" onmouseout="out('4832835199818847464');" style=""> 671     private class loadNoteTask extends AsyncTask&lt;String, Void, Void&gt; {                                   </span>
<span  style=""> 672                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 673         @Override                                                                                        </span>
<span class="-2143377957271683587" onmouseenter="enter('-2143377957271683587');" onmouseout="out('-2143377957271683587');" style=""> 674         protected void onPreExecute() {                                                                  </span>
<span class="-4476633077483558762" onmouseenter="enter('-4476633077483558762');" onmouseout="out('-4476633077483558762');" style=""> 675             mContentEditText.removeTextChangedListener(NoteEditorFragment.this);                         </span>
<span class="1885380990906425504" onmouseenter="enter('1885380990906425504');" onmouseout="out('1885380990906425504');" style=""> 676             mIsLoadingNote = true;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 677         }                                                                                                </span>
<span  style=""> 678                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 679         @Override                                                                                        </span>
<span class="2907103121668961470" onmouseenter="enter('2907103121668961470');" onmouseout="out('2907103121668961470');" style=""> 680         protected Void doInBackground(String... args) {                                                  </span>
<span class="-3170312762343778784" onmouseenter="enter('-3170312762343778784');" onmouseout="out('-3170312762343778784');" style=""> 681             if (getActivity() == null) {                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 682                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 683             }                                                                                            </span>
<span  style=""> 684                                                                                                          </span>
<span class="-6905640337159350056" onmouseenter="enter('-6905640337159350056');" onmouseout="out('-6905640337159350056');" style=""> 685             String noteID = args[0];                                                                     </span>
<span class="5105206001451632901" onmouseenter="enter('5105206001451632901');" onmouseout="out('5105206001451632901');" style=""> 686             Simplenote application = (Simplenote) getActivity().getApplication();                        </span>
<span class="3820701427545927889" onmouseenter="enter('3820701427545927889');" onmouseout="out('3820701427545927889');" style=""> 687             Bucket&lt;Note&gt; notesBucket = application.getNotesBucket();                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 688             try {                                                                                        </span>
<span class="1900948898960959991" onmouseenter="enter('1900948898960959991');" onmouseout="out('1900948898960959991');" style=""> 689                 mNote = notesBucket.get(noteID);                                                         </span>
<span class="-8094446681246514952" onmouseenter="enter('-8094446681246514952');" onmouseout="out('-8094446681246514952');" style=""> 690                 // Set the current note in NotesActivity when on a tablet                                </span>
<span class="-4385871719572971359" onmouseenter="enter('-4385871719572971359');" onmouseout="out('-4385871719572971359');" style=""> 691                 if (getActivity() instanceof NotesActivity) {                                            </span>
<span class="-5437998525889410543" onmouseenter="enter('-5437998525889410543');" onmouseout="out('-5437998525889410543');" style=""> 692                     ((NotesActivity) getActivity()).setCurrentNote(mNote);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693                 }                                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 694             } catch (BucketObjectMissingException e) {                                                   </span>
<span class="9016552103124647674" onmouseenter="enter('9016552103124647674');" onmouseout="out('9016552103124647674');" style=""> 695                 // TODO: Handle a missing note                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 696             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 697             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 698         }                                                                                                </span>
<span  style=""> 699                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 700         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 701         protected void onPostExecute(Void nada) {                                                        </span>
<span class="3019142402664254149" onmouseenter="enter('3019142402664254149');" onmouseout="out('3019142402664254149');" style=""> 702             if (getActivity() == null || getActivity().isFinishing())                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 703                 return;                                                                                  </span>
<span class="-2770512784578238911" onmouseenter="enter('-2770512784578238911');" onmouseout="out('-2770512784578238911');" style=""> 704             refreshContent(false);                                                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 705             if (mMatchOffsets != null) {                                                                 </span>
<span class="4645759725865606036" onmouseenter="enter('4645759725865606036');" onmouseout="out('4645759725865606036');" style=""><abbr title=" 706                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROPERTY);"> 706                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.COðŸ”µ</abbr></span>
<span class="1514128940236991067" onmouseenter="enter('1514128940236991067');" onmouseout="out('1514128940236991067');" style=""> 707                 mHighlighter.highlightMatches(mMatchOffsets, columnIndex);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 708             }                                                                                            </span>
<span class="2908988742356344281" onmouseenter="enter('2908988742356344281');" onmouseout="out('2908988742356344281');" style=""> 709             mContentEditText.addTextChangedListener(NoteEditorFragment.this);                            </span>
<span class="1726616917938037339" onmouseenter="enter('1726616917938037339');" onmouseout="out('1726616917938037339');" style=""> 710             if (mNote != null &amp;&amp; mNote.getContent().isEmpty()) {                                         </span>
<span class="-7639034409774462373" onmouseenter="enter('-7639034409774462373');" onmouseout="out('-7639034409774462373');" style=""> 711                 // Show soft keyboard                                                                    </span>
<span class="-5568483982770704985" onmouseenter="enter('-5568483982770704985');" onmouseout="out('-5568483982770704985');" style=""> 712                 mContentEditText.requestFocus();                                                         </span>
<span class="7162501222170899627" onmouseenter="enter('7162501222170899627');" onmouseout="out('7162501222170899627');" style=""> 713                 new Handler().postDelayed(new Runnable() {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 714                     @Override                                                                            </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 715                     public void run() {                                                                  </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 716                         InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 716                         InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSysðŸ”µ</abbr></span>
<span class="-1476760297763804327" onmouseenter="enter('-1476760297763804327');" onmouseout="out('-1476760297763804327');" style=""> 717                         if (inputMethodManager != null)                                                  </span>
<span class="7954226653587797662" onmouseenter="enter('7954226653587797662');" onmouseout="out('7954226653587797662');" style=""> 718                             inputMethodManager.showSoftInput(mContentEditText, 0);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 719                     }                                                                                    </span>
<span class="-4884776244894547305" onmouseenter="enter('-4884776244894547305');" onmouseout="out('-4884776244894547305');" style=""> 720                 }, 100);                                                                                 </span>
<span  style=""> 721                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722             }                                                                                            </span>
<span  style=""> 723                                                                                                          </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 724             SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                   </span>
<span  style=""> 725                                                                                                          </span>
<span class="2296161227930019578" onmouseenter="enter('2296161227930019578');" onmouseout="out('2296161227930019578');" style=""> 726             mIsLoadingNote = false;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 727         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 728     }                                                                                                    </span>
<span  style=""> 729                                                                                                          </span>
<span class="-8015309924985109245" onmouseenter="enter('-8015309924985109245');" onmouseout="out('-8015309924985109245');" style=""> 730     private class saveNoteTask extends AsyncTask&lt;Void, Void, Void&gt; {                                     </span>
<span  style=""> 731                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 732         @Override                                                                                        </span>
<span class="1259374977543247181" onmouseenter="enter('1259374977543247181');" onmouseout="out('1259374977543247181');" style=""> 733         protected Void doInBackground(Void... args) {                                                    </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 734             saveNote();                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 735             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 736         }                                                                                                </span>
<span  style=""> 737                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 738         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 739         protected void onPostExecute(Void nada) {                                                        </span>
<span class="-8878355580113381449" onmouseenter="enter('-8878355580113381449');" onmouseout="out('-8878355580113381449');" style=""> 740             if (getActivity() != null &amp;&amp; !getActivity().isFinishing()) {                                 </span>
<span class="4157206213844518202" onmouseenter="enter('4157206213844518202');" onmouseout="out('4157206213844518202');" style=""> 741                 // Update links                                                                          </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 742                 SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 744         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 745     }                                                                                                    </span>
<span  style=""> 746                                                                                                          </span>
<span class="-2294831155573525866" onmouseenter="enter('-2294831155573525866');" onmouseout="out('-2294831155573525866');" style=""> 747     private void saveNote() {                                                                            </span>
<span class="-6566957513776356959" onmouseenter="enter('-6566957513776356959');" onmouseout="out('-6566957513776356959');" style=""> 748         if (mNote == null) {                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 749             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750         }                                                                                                </span>
<span  style=""> 751                                                                                                          </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 752         String content = getNoteContentString();                                                         </span>
<span class="-8502490389039341280" onmouseenter="enter('-8502490389039341280');" onmouseout="out('-8502490389039341280');" style=""> 753         String tagString = getNoteTagsString();                                                          </span>
<span class="-8359444972541895470" onmouseenter="enter('-8359444972541895470');" onmouseout="out('-8359444972541895470');" style=""> 754         if (mNote.hasChanges(content, tagString.trim(), mPinButton.isChecked())) {                       </span>
<span class="843504871988910810" onmouseenter="enter('843504871988910810');" onmouseout="out('843504871988910810');" style=""> 755             mNote.setContent(content);                                                                   </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 756             mNote.setTagString(tagString);                                                               </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 757             mNote.setModificationDate(Calendar.getInstance());                                           </span>
<span class="-5430078119462356953" onmouseenter="enter('-5430078119462356953');" onmouseout="out('-5430078119462356953');" style=""> 758             // Send pinned event to google analytics if changed                                          </span>
<span class="-8280425794504398339" onmouseenter="enter('-8280425794504398339');" onmouseout="out('-8280425794504398339');" style=""> 759             mNote.setPinned(mPinButton.isChecked());                                                     </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 760             mNote.save();                                                                                </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 761             if (getActivity() != null) {                                                                 </span>
<span class="9119823558701234173" onmouseenter="enter('9119823558701234173');" onmouseout="out('9119823558701234173');" style=""> 762                 if (mNote.isPinned() != mPinButton.isChecked()) {                                        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 763                     mTracker.send(                                                                       </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 764                             new HitBuilders.EventBuilder()                                               </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 765                                     .setCategory(&quot;note&quot;)                                                 </span>
<span class="-653095590827548063" onmouseenter="enter('-653095590827548063');" onmouseout="out('-653095590827548063');" style=""><abbr title=" 766                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;)"> 766                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;ðŸ”µ</abbr></span>
<span class="4917363824063796296" onmouseenter="enter('4917363824063796296');" onmouseout="out('4917363824063796296');" style=""> 767                                     .setLabel(&quot;pin_button&quot;)                                              </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 768                                     .build()                                                             </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 769                     );                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 770                 }                                                                                        </span>
<span  style=""> 771                                                                                                          </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 772                 mTracker.send(                                                                           </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 773                         new HitBuilders.EventBuilder()                                                   </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 774                                 .setCategory(&quot;note&quot;)                                                     </span>
<span class="248231167587528808" onmouseenter="enter('248231167587528808');" onmouseout="out('248231167587528808');" style=""> 775                                 .setAction(&quot;edited_note&quot;)                                                </span>
<span class="5457290577030983699" onmouseenter="enter('5457290577030983699');" onmouseout="out('5457290577030983699');" style=""> 776                                 .setLabel(&quot;editor_save&quot;)                                                 </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 777                                 .build()                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 778                 );                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 779             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 780         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 781     }                                                                                                    </span>
<span  style=""> 782                                                                                                          </span>
<span class="9084056993766846780" onmouseenter="enter('9084056993766846780');" onmouseout="out('9084056993766846780');" style=""> 783     // Contextual action bar for dealing with links                                                      </span>
<span class="-23103958784499667" onmouseenter="enter('-23103958784499667');" onmouseout="out('-23103958784499667');" style=""> 784     private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {                        </span>
<span  style=""> 785                                                                                                          </span>
<span class="-5830922032047880245" onmouseenter="enter('-5830922032047880245');" onmouseout="out('-5830922032047880245');" style=""> 786         // Called when the action mode is created; startActionMode() was called                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 787         @Override                                                                                        </span>
<span class="6869646826473679297" onmouseenter="enter('6869646826473679297');" onmouseout="out('6869646826473679297');" style=""> 788         public boolean onCreateActionMode(ActionMode mode, Menu menu) {                                  </span>
<span class="-5328486553851934265" onmouseenter="enter('-5328486553851934265');" onmouseout="out('-5328486553851934265');" style=""> 789             // Inflate a menu resource providing context menu items                                      </span>
<span class="8164139660214751060" onmouseenter="enter('8164139660214751060');" onmouseout="out('8164139660214751060');" style=""> 790             MenuInflater inflater = mode.getMenuInflater();                                              </span>
<span class="-5537764272582475285" onmouseenter="enter('-5537764272582475285');" onmouseout="out('-5537764272582475285');" style=""> 791             if (inflater != null){                                                                       </span>
<span class="6552624979414277895" onmouseenter="enter('6552624979414277895');" onmouseout="out('6552624979414277895');" style=""> 792                 inflater.inflate(R.menu.view_link, menu);                                                </span>
<span class="2045169504868185532" onmouseenter="enter('2045169504868185532');" onmouseout="out('2045169504868185532');" style=""> 793                 mViewLinkMenuItem = menu.findItem(R.id.menu_view_link);                                  </span>
<span class="4190298810187820509" onmouseenter="enter('4190298810187820509');" onmouseout="out('4190298810187820509');" style=""> 794                 mode.setTitle(getString(R.string.link));                                                 </span>
<span class="9015861346770894985" onmouseenter="enter('9015861346770894985');" onmouseout="out('9015861346770894985');" style=""> 795                 if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {                </span>
<span class="-2927630225150463376" onmouseenter="enter('-2927630225150463376');" onmouseout="out('-2927630225150463376');" style=""> 796                     mode.setTitleOptionalHint(false);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 798             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 799             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 800         }                                                                                                </span>
<span  style=""> 801                                                                                                          </span>
<span class="-7885162724385925248" onmouseenter="enter('-7885162724385925248');" onmouseout="out('-7885162724385925248');" style=""> 802         // Called each time the action mode is shown. Always called after onCreateActionMode, but        </span>
<span class="6140331646129020842" onmouseenter="enter('6140331646129020842');" onmouseout="out('6140331646129020842');" style=""> 803         // may be called multiple times if the mode is invalidated.                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 804         @Override                                                                                        </span>
<span class="5392123371105216364" onmouseenter="enter('5392123371105216364');" onmouseout="out('5392123371105216364');" style=""> 805         public boolean onPrepareActionMode(ActionMode mode, Menu menu) {                                 </span>
<span class="9220029862843236189" onmouseenter="enter('9220029862843236189');" onmouseout="out('9220029862843236189');" style=""> 806             return false; // Return false if nothing is done                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 807         }                                                                                                </span>
<span  style=""> 808                                                                                                          </span>
<span class="-918812678605329556" onmouseenter="enter('-918812678605329556');" onmouseout="out('-918812678605329556');" style=""> 809         // Called when the user selects a contextual menu item                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 810         @Override                                                                                        </span>
<span class="816131742774025467" onmouseenter="enter('816131742774025467');" onmouseout="out('816131742774025467');" style=""> 811         public boolean onActionItemClicked(ActionMode mode, MenuItem item) {                             </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 812             switch (item.getItemId()) {                                                                  </span>
<span class="1241487664924667668" onmouseenter="enter('1241487664924667668');" onmouseout="out('1241487664924667668');" style=""> 813                 case R.id.menu_view_link:                                                                </span>
<span class="2689068574112651560" onmouseenter="enter('2689068574112651560');" onmouseout="out('2689068574112651560');" style=""> 814                     if (mLinkUrl != null) {                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 815                         try {                                                                            </span>
<span class="2961985398395482945" onmouseenter="enter('2961985398395482945');" onmouseout="out('2961985398395482945');" style=""> 816                             Uri uri = Uri.parse(mLinkUrl);                                               </span>
<span class="-3647274578727323622" onmouseenter="enter('-3647274578727323622');" onmouseout="out('-3647274578727323622');" style=""> 817                             Intent i = new Intent(Intent.ACTION_VIEW);                                   </span>
<span class="3545520342926402522" onmouseenter="enter('3545520342926402522');" onmouseout="out('3545520342926402522');" style=""> 818                             i.setData(uri);                                                              </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 819                             startActivity(i);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 820                         } catch (Exception e) {                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 821                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 822                         }                                                                                </span>
<span class="-5985541663234456921" onmouseenter="enter('-5985541663234456921');" onmouseout="out('-5985541663234456921');" style=""> 823                         mode.finish(); // Action picked, so close the CAB                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 824                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 825                     return true;                                                                         </span>
<span class="1323072004784584241" onmouseenter="enter('1323072004784584241');" onmouseout="out('1323072004784584241');" style=""> 826                 case R.id.menu_copy:                                                                     </span>
<span class="5917848124130151943" onmouseenter="enter('5917848124130151943');" onmouseout="out('5917848124130151943');" style=""> 827                     if (mLinkText != null &amp;&amp; getActivity() != null) {                                    </span>
<span class="-1800885668589834003" onmouseenter="enter('-1800885668589834003');" onmouseout="out('-1800885668589834003');" style=""><abbr title=" 828                         ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 828                         ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(ConðŸ”µ</abbr></span>
<span class="-1681747336188731628" onmouseenter="enter('-1681747336188731628');" onmouseout="out('-1681747336188731628');" style=""> 829                         ClipData clip = ClipData.newPlainText(getString(R.string.app_name),mLinkText);   </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 830                         clipboard.setPrimaryClip(clip);                                                  </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 831                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 831                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORTðŸ”µ</abbr></span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 832                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 833                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 834                     return true;                                                                         </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 835                 case R.id.menu_share:                                                                    </span>
<span class="-6928924091126055668" onmouseenter="enter('-6928924091126055668');" onmouseout="out('-6928924091126055668');" style=""> 836                     if (mLinkText != null) {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 837                         try {                                                                            </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 838                             Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);         </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 839                             shareIntent.setType(&quot;text/plain&quot;);                                           </span>
<span class="-5545338866841663037" onmouseenter="enter('-5545338866841663037');" onmouseout="out('-5545338866841663037');" style=""> 840                             shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mLinkText);          </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 841                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 841                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.stðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 842                         } catch (Exception e) {                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 843                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 844                         }                                                                                </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 845                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 846                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 847                     return true;                                                                         </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 848                 default:                                                                                 </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 849                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 850             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 851         }                                                                                                </span>
<span  style=""> 852                                                                                                          </span>
<span class="2525157012953828009" onmouseenter="enter('2525157012953828009');" onmouseout="out('2525157012953828009');" style=""> 853         // Called when the user exits the action mode                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 854         @Override                                                                                        </span>
<span class="-2232977199830239129" onmouseenter="enter('-2232977199830239129');" onmouseout="out('-2232977199830239129');" style=""> 855         public void onDestroyActionMode(ActionMode mode) {                                               </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 856             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 857         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 858     };                                                                                                   </span>
<span  style=""> 859                                                                                                          </span>
<span class="-6769383367293074987" onmouseenter="enter('-6769383367293074987');" onmouseout="out('-6769383367293074987');" style=""> 860     // Checks if cursor is at a URL when the selection changes                                           </span>
<span class="499820509706145242" onmouseenter="enter('499820509706145242');" onmouseout="out('499820509706145242');" style=""> 861     // If it is a URL, show the contextual action bar                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 862     @Override                                                                                            </span>
<span class="-6619706727651867065" onmouseenter="enter('-6619706727651867065');" onmouseout="out('-6619706727651867065');" style=""> 863     public void onSelectionChanged(int selStart, int selEnd) {                                           </span>
<span class="-5773931921061181239" onmouseenter="enter('-5773931921061181239');" onmouseout="out('-5773931921061181239');" style=""> 864         if (selStart == selEnd) {                                                                        </span>
<span class="-1073801886026856185" onmouseenter="enter('-1073801886026856185');" onmouseout="out('-1073801886026856185');" style=""> 865             Editable noteContent = mContentEditText.getText();                                           </span>
<span class="6562974929235397620" onmouseenter="enter('6562974929235397620');" onmouseout="out('6562974929235397620');" style=""> 866             if (noteContent == null)                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 867                 return;                                                                                  </span>
<span  style=""> 868                                                                                                          </span>
<span class="1258634593958745929" onmouseenter="enter('1258634593958745929');" onmouseout="out('1258634593958745929');" style=""> 869             URLSpan[] urlSpans = noteContent.getSpans(selStart, selStart, URLSpan.class);                </span>
<span class="8265917182779455796" onmouseenter="enter('8265917182779455796');" onmouseout="out('8265917182779455796');" style=""> 870             if (urlSpans.length &gt; 0) {                                                                   </span>
<span class="379938049561077801" onmouseenter="enter('379938049561077801');" onmouseout="out('379938049561077801');" style=""> 871                 URLSpan urlSpan = urlSpans[0];                                                           </span>
<span class="7382553573082356877" onmouseenter="enter('7382553573082356877');" onmouseout="out('7382553573082356877');" style=""> 872                 mLinkUrl = urlSpan.getURL();                                                             </span>
<span class="-2685141031372274993" onmouseenter="enter('-2685141031372274993');" onmouseout="out('-2685141031372274993');" style=""><abbr title=" 873                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSpan)).toString();"> 873                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpaðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 874                 if (mActionMode != null) {                                                               </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 875                     mActionMode.setSubtitle(mLinkText);                                                  </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 876                     setLinkMenuItem();                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 877                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 878                 }                                                                                        </span>
<span  style=""> 879                                                                                                          </span>
<span class="-4243988111679111503" onmouseenter="enter('-4243988111679111503');" onmouseout="out('-4243988111679111503');" style=""> 880                 // Show the Contextual Action Bar                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 881                 if (getActivity() != null) {                                                             </span>
<span class="-7108116137017669118" onmouseenter="enter('-7108116137017669118');" onmouseout="out('-7108116137017669118');" style=""><abbr title=" 882                     mActionMode = ((NoteEditorActivity)getActivity()).startSupportActionMode(mActionModeCallback);"> 882                     mActionMode = ((NoteEditorActivity)getActivity()).startSupportActionMode(mActionModeCðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 883                     if (mActionMode != null) {                                                           </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 884                         mActionMode.setSubtitle(mLinkText);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 885                     }                                                                                    </span>
<span  style=""> 886                                                                                                          </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 887                     setLinkMenuItem();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 888                 }                                                                                        </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 889             } else if (mActionMode != null) {                                                            </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 890                 mActionMode.finish();                                                                    </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 891                 mActionMode = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 892             }                                                                                            </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 893         } else if (mActionMode != null) {                                                                </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 894             mActionMode.finish();                                                                        </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 895             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 896         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 897     }                                                                                                    </span>
<span  style=""> 898                                                                                                          </span>
<span class="-1933854749523580289" onmouseenter="enter('-1933854749523580289');" onmouseout="out('-1933854749523580289');" style=""> 899     private void setLinkMenuItem() {                                                                     </span>
<span class="-4542884014549729251" onmouseenter="enter('-4542884014549729251');" onmouseout="out('-4542884014549729251');" style=""> 900         if (mViewLinkMenuItem != null &amp;&amp; mLinkUrl != null) {                                             </span>
<span class="7070835845876331574" onmouseenter="enter('7070835845876331574');" onmouseout="out('7070835845876331574');" style=""> 901             if (mLinkUrl.startsWith(&quot;tel:&quot;)) {                                                           </span>
<span class="4608769072092705594" onmouseenter="enter('4608769072092705594');" onmouseout="out('4608769072092705594');" style=""> 902                 mViewLinkMenuItem.setIcon(mCallIconResId);                                               </span>
<span class="-1045706461125369539" onmouseenter="enter('-1045706461125369539');" onmouseout="out('-1045706461125369539');" style=""> 903                 mViewLinkMenuItem.setTitle(getString(R.string.call));                                    </span>
<span class="-4087102511435152339" onmouseenter="enter('-4087102511435152339');" onmouseout="out('-4087102511435152339');" style=""> 904             } else if (mLinkUrl.startsWith(&quot;mailto:&quot;)) {                                                 </span>
<span class="112818067677115399" onmouseenter="enter('112818067677115399');" onmouseout="out('112818067677115399');" style=""> 905                 mViewLinkMenuItem.setIcon(mEmailIconResId);                                              </span>
<span class="7417350135164215691" onmouseenter="enter('7417350135164215691');" onmouseout="out('7417350135164215691');" style=""> 906                 mViewLinkMenuItem.setTitle(getString(R.string.email));                                   </span>
<span class="-1372170246346381865" onmouseenter="enter('-1372170246346381865');" onmouseout="out('-1372170246346381865');" style=""> 907             } else if (mLinkUrl.startsWith(&quot;geo:&quot;)) {                                                    </span>
<span class="-5464734295170160558" onmouseenter="enter('-5464734295170160558');" onmouseout="out('-5464734295170160558');" style=""> 908                 mViewLinkMenuItem.setIcon(mMapIconResId);                                                </span>
<span class="5018205442899714685" onmouseenter="enter('5018205442899714685');" onmouseout="out('5018205442899714685');" style=""> 909                 mViewLinkMenuItem.setTitle(getString(R.string.view_map));                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 910             } else {                                                                                     </span>
<span class="-4632312324298999235" onmouseenter="enter('-4632312324298999235');" onmouseout="out('-4632312324298999235');" style=""> 911                 mViewLinkMenuItem.setIcon(mWebIconResId);                                                </span>
<span class="4171282647008223100" onmouseenter="enter('4171282647008223100');" onmouseout="out('4171282647008223100');" style=""> 912                 mViewLinkMenuItem.setTitle(getString(R.string.view_in_browser));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 913             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 914         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 915     }                                                                                                    </span>
<span  style=""> 916                                                                                                          </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 917     // Resets note publish status if Simperium never returned the new publish status                     </span>
<span class="-7747131454054684363" onmouseenter="enter('-7747131454054684363');" onmouseout="out('-7747131454054684363');" style=""> 918     private Runnable mPublishTimeoutRunnable = new Runnable() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 919         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 920         public void run() {                                                                              </span>
<span class="6112154992837754036" onmouseenter="enter('6112154992837754036');" onmouseout="out('6112154992837754036');" style=""> 921             if (!isAdded()) return;                                                                      </span>
<span  style=""> 922                                                                                                          </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 923             getActivity().runOnUiThread(new Runnable() {                                                 </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 924                 @Override                                                                                </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 925                 public void run() {                                                                      </span>
<span class="-46541338249551852" onmouseenter="enter('-46541338249551852');" onmouseout="out('-46541338249551852');" style=""> 926                     Toast.makeText(                                                                      </span>
<span class="1251951171853107838" onmouseenter="enter('1251951171853107838');" onmouseout="out('1251951171853107838');" style=""> 927                             getActivity(),                                                               </span>
<span class="112353621179497368" onmouseenter="enter('112353621179497368');" onmouseout="out('112353621179497368');" style=""> 928                             mNote.isPublished() ? R.string.publish_error : R.string.unpublish_error,     </span>
<span class="-5464445565121122409" onmouseenter="enter('-5464445565121122409');" onmouseout="out('-5464445565121122409');" style=""> 929                             Toast.LENGTH_SHORT                                                           </span>
<span class="1929519410657596695" onmouseenter="enter('1929519410657596695');" onmouseout="out('1929519410657596695');" style=""> 930                     ).show();                                                                            </span>
<span  style=""> 931                                                                                                          </span>
<span class="-6752199236124778161" onmouseenter="enter('-6752199236124778161');" onmouseout="out('-6752199236124778161');" style=""> 932                     mNote.setPublished(!mNote.isPublished());                                            </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 933                     mNote.save();                                                                        </span>
<span  style=""> 934                                                                                                          </span>
<span class="-4813280994160595323" onmouseenter="enter('-4813280994160595323');" onmouseout="out('-4813280994160595323');" style=""> 935                     if (mInfoPopupWindow != null &amp;&amp; mInfoPopupWindow.isShowing()) {                      </span>
<span class="-6944825779591395660" onmouseenter="enter('-6944825779591395660');" onmouseout="out('-6944825779591395660');" style=""><abbr title=" 936                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(R.id.publish_view_switcher);"> 936                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findVðŸ”µ</abbr></span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 937                         if (viewSwitcher.getDisplayedChild() == 1) {                                     </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 938                             viewSwitcher.showPrevious();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 940                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 941                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 942             });                                                                                          </span>
<span  style=""> 943                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 944         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 945     };                                                                                                   </span>
<span  style=""> 946                                                                                                          </span>
<span class="1779789763575252159" onmouseenter="enter('1779789763575252159');" onmouseout="out('1779789763575252159');" style=""> 947     private void updateWordCount(TextView textView) {                                                    </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 948         String content = getNoteContentString();                                                         </span>
<span  style=""> 949                                                                                                          </span>
<span class="-1008232604726066894" onmouseenter="enter('-1008232604726066894');" onmouseout="out('-1008232604726066894');" style=""> 950         if (content == null || textView == null) return;                                                 </span>
<span  style=""> 951                                                                                                          </span>
<span class="-1430881109113489374" onmouseenter="enter('-1430881109113489374');" onmouseout="out('-1430881109113489374');" style=""> 952         int numWords = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;     </span>
<span  style=""> 953                                                                                                          </span>
<span class="7366599842051642465" onmouseenter="enter('7366599842051642465');" onmouseout="out('7366599842051642465');" style=""> 954         String wordCountString = getResources().getQuantityString(R.plurals.word_count, numWords);       </span>
<span class="6184855737129992397" onmouseenter="enter('6184855737129992397');" onmouseout="out('6184855737129992397');" style=""> 955         String formattedWordCount = NumberFormat.getInstance().format(numWords);                         </span>
<span  style=""> 956                                                                                                          </span>
<span class="-8359331938088478069" onmouseenter="enter('-8359331938088478069');" onmouseout="out('-8359331938088478069');" style=""> 957         textView.setText(formattedWordCount + &quot; &quot; + wordCountString);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 958     }                                                                                                    </span>
<span  style=""> 959                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 960     /**                                                                                                  </span>
<span class="-1711188639399183775" onmouseenter="enter('-1711188639399183775');" onmouseout="out('-1711188639399183775');" style=""> 961      * Simperium listeners                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 962      */                                                                                                  </span>
<span  style=""> 963                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 964     @Override                                                                                            </span>
<span class="3459602708969445883" onmouseenter="enter('3459602708969445883');" onmouseout="out('3459602708969445883');" style=""> 965     public void onDeleteObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                     </span>
<span  style=""> 966                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 967     }                                                                                                    </span>
<span  style=""> 968                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 969     @Override                                                                                            </span>
<span class="-2970240973750057256" onmouseenter="enter('-2970240973750057256');" onmouseout="out('-2970240973750057256');" style=""><abbr title=" 970     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {"> 970     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) ðŸ”µ</abbr></span>
<span class="6607037711761945955" onmouseenter="enter('6607037711761945955');" onmouseout="out('6607037711761945955');" style=""> 971         if (changeType == Bucket.ChangeType.MODIFY) {                                                    </span>
<span class="-6254872391725782597" onmouseenter="enter('-6254872391725782597');" onmouseout="out('-6254872391725782597');" style=""> 972             if (getNote() != null &amp;&amp; getNote().getSimperiumKey().equals(key)) {                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 973                 try {                                                                                    </span>
<span class="3951885723067312215" onmouseenter="enter('3951885723067312215');" onmouseout="out('3951885723067312215');" style=""> 974                     final Note updatedNote = mNotesBucket.get(key);                                      </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 975                     if (getActivity() != null) {                                                         </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 976                         getActivity().runOnUiThread(new Runnable() {                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 977                             @Override                                                                    </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 978                             public void run() {                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 979                                 if (mPublishTimeoutHandler != null) {                                    </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 980                                     mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 981                                 }                                                                        </span>
<span  style=""> 982                                                                                                          </span>
<span class="-8617980127286778731" onmouseenter="enter('-8617980127286778731');" onmouseout="out('-8617980127286778731');" style=""> 983                                 updateNote(updatedNote);                                                 </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 984                                 updateInfoPopup();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 985                             }                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 986                         });                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 987                     }                                                                                    </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 988                 } catch (BucketObjectMissingException e) {                                               </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 989                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 990                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 991             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 992         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 993     }                                                                                                    </span>
<span  style=""> 994                                                                                                          </span>
<span  style=""> 995                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 996     @Override                                                                                            </span>
<span class="1835476648918604123" onmouseenter="enter('1835476648918604123');" onmouseout="out('1835476648918604123');" style=""> 997     public void onSaveObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                       </span>
<span class="-5784091718421357269" onmouseenter="enter('-5784091718421357269');" onmouseout="out('-5784091718421357269');" style=""> 998         // noop                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 999     }                                                                                                    </span>
<span  style="">1000                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1001     @Override                                                                                            </span>
<span class="-5956849782971602831" onmouseenter="enter('-5956849782971602831');" onmouseout="out('-5956849782971602831');" style="">1002     public void onBeforeUpdateObject(Bucket&lt;Note&gt; bucket, Note note) {                                   </span>
<span class="9133977848896323437" onmouseenter="enter('9133977848896323437');" onmouseout="out('9133977848896323437');" style="">1003         // Don&#x27;t apply updates if we haven&#x27;t loaded the note yet                                         </span>
<span class="-1541782922582123662" onmouseenter="enter('-1541782922582123662');" onmouseout="out('-1541782922582123662');" style="">1004         if (mIsLoadingNote)                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1005             return;                                                                                      </span>
<span  style="">1006                                                                                                          </span>
<span class="1341660593539808393" onmouseenter="enter('1341660593539808393');" onmouseout="out('1341660593539808393');" style="">1007         Note openNote = getNote();                                                                       </span>
<span class="-6997098079508589023" onmouseenter="enter('-6997098079508589023');" onmouseout="out('-6997098079508589023');" style="">1008         if (openNote == null || !openNote.getSimperiumKey().equals(note.getSimperiumKey()))              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1009             return;                                                                                      </span>
<span  style="">1010                                                                                                          </span>
<span class="4441072062127767636" onmouseenter="enter('4441072062127767636');" onmouseout="out('4441072062127767636');" style="">1011         note.setContent(getNoteContentString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1012     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1013 }                                                                                                        </span>





</pre></td>
                            <td><pre><span class="8328120990598135231" onmouseenter="enter('8328120990598135231');" onmouseout="out('8328120990598135231');" style="">   1 package com.automattic.simplenote;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3 import android.app.Activity;                                                                             </span>
<span class="7622566010320033225" onmouseenter="enter('7622566010320033225');" onmouseout="out('7622566010320033225');" style="">   4 import android.app.Fragment;                                                                             </span>
<span class="-1500972560159629307" onmouseenter="enter('-1500972560159629307');" onmouseout="out('-1500972560159629307');" style="">   5 import android.content.ClipData;                                                                         </span>
<span class="-1154037727824652611" onmouseenter="enter('-1154037727824652611');" onmouseout="out('-1154037727824652611');" style="">   6 import android.content.ClipboardManager;                                                                 </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   7 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   8 import android.content.Intent;                                                                           </span>
<span class="-840652079464298178" onmouseenter="enter('-840652079464298178');" onmouseout="out('-840652079464298178');" style="">   9 import android.content.res.TypedArray;                                                                   </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  10 import android.database.Cursor;                                                                          </span>
<span class="1216741051675613788" onmouseenter="enter('1216741051675613788');" onmouseout="out('1216741051675613788');" style="">  11 import android.graphics.drawable.ColorDrawable;                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  12 import android.net.Uri;                                                                                  </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  13 import android.os.AsyncTask;                                                                             </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  14 import android.os.Build;                                                                                 </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  15 import android.os.Bundle;                                                                                </span>
<span class="-1086316590722027623" onmouseenter="enter('-1086316590722027623');" onmouseout="out('-1086316590722027623');" style="">  16 import android.os.Handler;                                                                               </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="">  17 import android.support.v4.app.ActivityCompat;                                                            </span>
<span class="-8226814767277370585" onmouseenter="enter('-8226814767277370585');" onmouseout="out('-8226814767277370585');" style="">  18 import android.support.v7.view.ActionMode;                                                               </span>
<span class="4177373235046048356" onmouseenter="enter('4177373235046048356');" onmouseout="out('4177373235046048356');" style="">  19 import android.text.Editable;                                                                            </span>
<span class="7731806713123176572" onmouseenter="enter('7731806713123176572');" onmouseout="out('7731806713123176572');" style="">  20 import android.text.Spanned;                                                                             </span>
<span class="4038639591141008331" onmouseenter="enter('4038639591141008331');" onmouseout="out('4038639591141008331');" style="">  21 import android.text.TextWatcher;                                                                         </span>
<span class="2374973474356501783" onmouseenter="enter('2374973474356501783');" onmouseout="out('2374973474356501783');" style="">  22 import android.text.style.RelativeSizeSpan;                                                              </span>
<span class="-1165963660754430642" onmouseenter="enter('-1165963660754430642');" onmouseout="out('-1165963660754430642');" style="">  23 import android.text.style.URLSpan;                                                                       </span>
<span class="-3804250137032727253" onmouseenter="enter('-3804250137032727253');" onmouseout="out('-3804250137032727253');" style="">  24 import android.text.util.Linkify;                                                                        </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  25 import android.util.TypedValue;                                                                          </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="">  26 import android.view.LayoutInflater;                                                                      </span>
<span class="-603490076395619238" onmouseenter="enter('-603490076395619238');" onmouseout="out('-603490076395619238');" style="">  27 import android.view.Menu;                                                                                </span>
<span class="-434306062495579804" onmouseenter="enter('-434306062495579804');" onmouseout="out('-434306062495579804');" style="">  28 import android.view.MenuInflater;                                                                        </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  29 import android.view.MenuItem;                                                                            </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  30 import android.view.View;                                                                                </span>
<span class="7569314084591619834" onmouseenter="enter('7569314084591619834');" onmouseout="out('7569314084591619834');" style="">  31 import android.view.ViewGroup;                                                                           </span>
<span class="-3054355229537475035" onmouseenter="enter('-3054355229537475035');" onmouseout="out('-3054355229537475035');" style="">  32 import android.view.WindowManager;                                                                       </span>
<span class="-3117363671899680167" onmouseenter="enter('-3117363671899680167');" onmouseout="out('-3117363671899680167');" style="">  33 import android.view.inputmethod.InputMethodManager;                                                      </span>
<span class="5634491474902588492" onmouseenter="enter('5634491474902588492');" onmouseout="out('5634491474902588492');" style="">  34 import android.widget.CursorAdapter;                                                                     </span>
<span class="-7136991092569948508" onmouseenter="enter('-7136991092569948508');" onmouseout="out('-7136991092569948508');" style="">  35 import android.widget.ImageButton;                                                                       </span>
<span class="-8478546344938881111" onmouseenter="enter('-8478546344938881111');" onmouseout="out('-8478546344938881111');" style="">  36 import android.widget.ImageView;                                                                         </span>
<span class="5987800420235491716" onmouseenter="enter('5987800420235491716');" onmouseout="out('5987800420235491716');" style="">  37 import android.widget.LinearLayout;                                                                      </span>
<span class="842268080202249770" onmouseenter="enter('842268080202249770');" onmouseout="out('842268080202249770');" style="">  38 import android.widget.PopupWindow;                                                                       </span>
<span class="-4961528671422147708" onmouseenter="enter('-4961528671422147708');" onmouseout="out('-4961528671422147708');" style="">  39 import android.widget.TextView;                                                                          </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  40 import android.widget.Toast;                                                                             </span>
<span class="-1505700250942826116" onmouseenter="enter('-1505700250942826116');" onmouseout="out('-1505700250942826116');" style="">  41 import android.widget.ToggleButton;                                                                      </span>
<span class="737425360271515900" onmouseenter="enter('737425360271515900');" onmouseout="out('737425360271515900');" style="">  42 import android.widget.ViewSwitcher;                                                                      </span>
<span class="9061368408436996655" onmouseenter="enter('9061368408436996655');" onmouseout="out('9061368408436996655');" style="">  43 import com.automattic.simplenote.models.Note;                                                            </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">  44 import com.automattic.simplenote.models.Tag;                                                             </span>
<span class="-4380838228434146133" onmouseenter="enter('-4380838228434146133');" onmouseout="out('-4380838228434146133');" style="">  45 import com.automattic.simplenote.utils.AutoBullet;                                                       </span>
<span class="8577850632926167445" onmouseenter="enter('8577850632926167445');" onmouseout="out('8577850632926167445');" style="">  46 import com.automattic.simplenote.utils.DisplayUtils;                                                     </span>
<span class="1327521140651609704" onmouseenter="enter('1327521140651609704');" onmouseout="out('1327521140651609704');" style="">  47 import com.automattic.simplenote.utils.MatchOffsetHighlighter;                                           </span>
<span class="-7136497821822559876" onmouseenter="enter('-7136497821822559876');" onmouseout="out('-7136497821822559876');" style="">  48 import com.automattic.simplenote.utils.PrefUtils;                                                        </span>
<span class="2537926396801226048" onmouseenter="enter('2537926396801226048');" onmouseout="out('2537926396801226048');" style="">  49 import com.automattic.simplenote.utils.SimplenoteLinkify;                                                </span>
<span class="13513923158165555" onmouseenter="enter('13513923158165555');" onmouseout="out('13513923158165555');" style="">  50 import com.automattic.simplenote.utils.SpaceTokenizer;                                                   </span>
<span class="451633977271230846" onmouseenter="enter('451633977271230846');" onmouseout="out('451633977271230846');" style="">  51 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView.OnTagAddedListener;                 </span>
<span class="-4652171765784917488" onmouseenter="enter('-4652171765784917488');" onmouseout="out('-4652171765784917488');" style="">  52 import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView;                                    </span>
<span class="3055903766206676561" onmouseenter="enter('3055903766206676561');" onmouseout="out('3055903766206676561');" style="">  53 import com.automattic.simplenote.utils.TextHighlighter;                                                  </span>
<span class="4834384566534786428" onmouseenter="enter('4834384566534786428');" onmouseout="out('4834384566534786428');" style="">  54 import com.automattic.simplenote.widgets.SimplenoteEditText;                                             </span>
<span class="-454400291627646237" onmouseenter="enter('-454400291627646237');" onmouseout="out('-454400291627646237');" style="">  55 import com.google.android.gms.analytics.HitBuilders;                                                     </span>
<span class="-1389398410172463659" onmouseenter="enter('-1389398410172463659');" onmouseout="out('-1389398410172463659');" style="">  56 import com.google.android.gms.analytics.Tracker;                                                         </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  57 import com.simperium.client.Bucket;                                                                      </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">  58 import com.simperium.client.BucketObjectMissingException;                                                </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  59 import com.simperium.client.Query;                                                                       </span>
<span class="-76499702739685611" onmouseenter="enter('-76499702739685611');" onmouseout="out('-76499702739685611');" style="">  60 import java.text.NumberFormat;                                                                           </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  61 import java.util.Calendar;                                                                               </span>
<span  style="">  62                                                                                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="2103530198636224534" onmouseenter="enter('2103530198636224534');" onmouseout="out('2103530198636224534');" style=""><abbr title="  64 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt; , TextWatcher , OnTagAddedListener , View.OnFocusChangeListener , SimplenoteEditText.OnSelectionChangedListener {">  64 public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt; , TextWatcher , OnTagAdðŸ”µ</abbr></span>
<span class="-4619625032881090052" onmouseenter="enter('-4619625032881090052');" onmouseout="out('-4619625032881090052');" style="">  65     public static final String ARG_ITEM_ID = &quot;item_id&quot;;                                                  </span>
<span  style="">  66                                                                                                          </span>
<span class="-7299684920632401552" onmouseenter="enter('-7299684920632401552');" onmouseout="out('-7299684920632401552');" style="">  67     public static final String ARG_NEW_NOTE = &quot;new_note&quot;;                                                </span>
<span  style="">  68                                                                                                          </span>
<span class="7663325037782331899" onmouseenter="enter('7663325037782331899');" onmouseout="out('7663325037782331899');" style="">  69     static public final String ARG_MATCH_OFFSETS = &quot;match_offsets&quot;;                                      </span>
<span  style="">  70                                                                                                          </span>
<span class="8491452362607628076" onmouseenter="enter('8491452362607628076');" onmouseout="out('8491452362607628076');" style="">  71     private static final int AUTOSAVE_DELAY_MILLIS = 2000;                                               </span>
<span  style="">  72                                                                                                          </span>
<span class="-6846870049312317979" onmouseenter="enter('-6846870049312317979');" onmouseout="out('-6846870049312317979');" style="">  73     private Note mNote;                                                                                  </span>
<span  style="">  74                                                                                                          </span>
<span class="-7913886194286774922" onmouseenter="enter('-7913886194286774922');" onmouseout="out('-7913886194286774922');" style="">  75     private Bucket&lt;Note&gt; mNotesBucket;                                                                   </span>
<span  style="">  76                                                                                                          </span>
<span class="7126484835826685301" onmouseenter="enter('7126484835826685301');" onmouseout="out('7126484835826685301');" style="">  77     private Tracker mTracker;                                                                            </span>
<span  style="">  78                                                                                                          </span>
<span class="6580801006778009663" onmouseenter="enter('6580801006778009663');" onmouseout="out('6580801006778009663');" style="">  79     private SimplenoteEditText mContentEditText;                                                         </span>
<span  style="">  80                                                                                                          </span>
<span class="-6964345898478101017" onmouseenter="enter('-6964345898478101017');" onmouseout="out('-6964345898478101017');" style="">  81     private TagsMultiAutoCompleteTextView mTagView;                                                      </span>
<span  style="">  82                                                                                                          </span>
<span class="5165556704755836097" onmouseenter="enter('5165556704755836097');" onmouseout="out('5165556704755836097');" style="">  83     private PopupWindow mInfoPopupWindow;                                                                </span>
<span  style="">  84                                                                                                          </span>
<span class="2959047860003936172" onmouseenter="enter('2959047860003936172');" onmouseout="out('2959047860003936172');" style="">  85     private ToggleButton mPinButton;                                                                     </span>
<span  style="">  86                                                                                                          </span>
<span class="6494121288462075344" onmouseenter="enter('6494121288462075344');" onmouseout="out('6494121288462075344');" style="">  87     private Handler mAutoSaveHandler;                                                                    </span>
<span  style="">  88                                                                                                          </span>
<span class="8783277907965445564" onmouseenter="enter('8783277907965445564');" onmouseout="out('8783277907965445564');" style="">  89     private Handler mPublishTimeoutHandler;                                                              </span>
<span  style="">  90                                                                                                          </span>
<span class="-1776320876088405367" onmouseenter="enter('-1776320876088405367');" onmouseout="out('-1776320876088405367');" style="">  91     private LinearLayout mPlaceholderView;                                                               </span>
<span  style="">  92                                                                                                          </span>
<span class="-5862875858497045082" onmouseenter="enter('-5862875858497045082');" onmouseout="out('-5862875858497045082');" style="">  93     private CursorAdapter mAutocompleteAdapter;                                                          </span>
<span  style="">  94                                                                                                          </span>
<span class="-5063638822987784427" onmouseenter="enter('-5063638822987784427');" onmouseout="out('-5063638822987784427');" style="">  95     private boolean mIsNewNote;                                                                          </span>
<span  style="">  96                                                                                                          </span>
<span class="-7523089573477153489" onmouseenter="enter('-7523089573477153489');" onmouseout="out('-7523089573477153489');" style="">  97     private boolean mIsLoadingNote;                                                                      </span>
<span  style="">  98                                                                                                          </span>
<span class="7307228847460234411" onmouseenter="enter('7307228847460234411');" onmouseout="out('7307228847460234411');" style="">  99     private ActionMode mActionMode;                                                                      </span>
<span  style=""> 100                                                                                                          </span>
<span class="-1934738222867341331" onmouseenter="enter('-1934738222867341331');" onmouseout="out('-1934738222867341331');" style=""> 101     private MenuItem mViewLinkMenuItem;                                                                  </span>
<span  style=""> 102                                                                                                          </span>
<span class="-3624836155172024592" onmouseenter="enter('-3624836155172024592');" onmouseout="out('-3624836155172024592');" style=""> 103     private String mLinkUrl;                                                                             </span>
<span  style=""> 104                                                                                                          </span>
<span class="-680149036339568713" onmouseenter="enter('-680149036339568713');" onmouseout="out('-680149036339568713');" style=""> 105     private String mLinkText;                                                                            </span>
<span  style=""> 106                                                                                                          </span>
<span class="-8355060532383088001" onmouseenter="enter('-8355060532383088001');" onmouseout="out('-8355060532383088001');" style=""> 107     private MatchOffsetHighlighter mHighlighter;                                                         </span>
<span  style=""> 108                                                                                                          </span>
<span class="-1854523128072080027" onmouseenter="enter('-1854523128072080027');" onmouseout="out('-1854523128072080027');" style=""> 109     private int mEmailIconResId;                                                                         </span>
<span  style=""> 110                                                                                                          </span>
<span class="-2945997385631216974" onmouseenter="enter('-2945997385631216974');" onmouseout="out('-2945997385631216974');" style=""> 111     private int mWebIconResId;                                                                           </span>
<span  style=""> 112                                                                                                          </span>
<span class="-6818745133087132397" onmouseenter="enter('-6818745133087132397');" onmouseout="out('-6818745133087132397');" style=""> 113     private int mMapIconResId;                                                                           </span>
<span  style=""> 114                                                                                                          </span>
<span class="-5534304236570932887" onmouseenter="enter('-5534304236570932887');" onmouseout="out('-5534304236570932887');" style=""> 115     private int mCallIconResId;                                                                          </span>
<span  style=""> 116                                                                                                          </span>
<span class="-7542236593744276396" onmouseenter="enter('-7542236593744276396');" onmouseout="out('-7542236593744276396');" style=""> 117     private MatchOffsetHighlighter.SpanFactory mMatchHighlighter;                                        </span>
<span  style=""> 118                                                                                                          </span>
<span class="2689815831275839045" onmouseenter="enter('2689815831275839045');" onmouseout="out('2689815831275839045');" style=""> 119     private String mMatchOffsets;                                                                        </span>
<span  style=""> 120                                                                                                          </span>
<span class="-7790101837861097441" onmouseenter="enter('-7790101837861097441');" onmouseout="out('-7790101837861097441');" style=""> 121     private int mCurrentCursorPosition;                                                                  </span>
<span  style=""> 122                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 123     /**                                                                                                  </span>
<span class="7780585517980788373" onmouseenter="enter('7780585517980788373');" onmouseout="out('7780585517980788373');" style=""> 124      * Mandatory empty constructor for the fragment manager to instantiate the                           </span>
<span class="7130060501227883159" onmouseenter="enter('7130060501227883159');" onmouseout="out('7130060501227883159');" style=""> 125      * fragment (e.g. upon screen orientation changes).                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 126      */                                                                                                  </span>
<span class="2055429757813344166" onmouseenter="enter('2055429757813344166');" onmouseout="out('2055429757813344166');" style=""> 127     public NoteEditorFragment() {                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 130     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 131     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 132         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 133                                                                                                          </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 134         if (getActivity() != null) {                                                                     </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 135             Simplenote currentApp = (Simplenote) getActivity().getApplication();                         </span>
<span class="3464165486447434608" onmouseenter="enter('3464165486447434608');" onmouseout="out('3464165486447434608');" style=""> 136             mNotesBucket = currentApp.getNotesBucket();                                                  </span>
<span class="8395901407898834802" onmouseenter="enter('8395901407898834802');" onmouseout="out('8395901407898834802');" style=""> 137             mTracker = currentApp.getTracker();                                                          </span>
<span  style=""> 138                                                                                                          </span>
<span class="6390134422937918444" onmouseenter="enter('6390134422937918444');" onmouseout="out('6390134422937918444');" style=""><abbr title=" 139             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionBarIconWeb, R.attr.actionBarIconMap, R.attr.actionBarIconCall});"> 139             TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.atðŸ”µ</abbr></span>
<span class="-368005650607593546" onmouseenter="enter('-368005650607593546');" onmouseout="out('-368005650607593546');" style=""> 140             if (a != null) {                                                                             </span>
<span class="156477903530707073" onmouseenter="enter('156477903530707073');" onmouseout="out('156477903530707073');" style=""> 141                 mEmailIconResId = a.getResourceId(0, 0);                                                 </span>
<span class="2237960387607406884" onmouseenter="enter('2237960387607406884');" onmouseout="out('2237960387607406884');" style=""> 142                 mWebIconResId = a.getResourceId(1, 0);                                                   </span>
<span class="-2587404817224189880" onmouseenter="enter('-2587404817224189880');" onmouseout="out('-2587404817224189880');" style=""> 143                 mMapIconResId = a.getResourceId(2, 0);                                                   </span>
<span class="7397862531502718567" onmouseenter="enter('7397862531502718567');" onmouseout="out('7397862531502718567');" style=""> 144                 mCallIconResId = a.getResourceId(3, 0);                                                  </span>
<span class="7664438635535969272" onmouseenter="enter('7664438635535969272');" onmouseout="out('7664438635535969272');" style=""> 145                 a.recycle();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147         }                                                                                                </span>
<span  style=""> 148                                                                                                          </span>
<span class="-7557436274459739944" onmouseenter="enter('-7557436274459739944');" onmouseout="out('-7557436274459739944');" style=""> 149         mAutoSaveHandler = new Handler();                                                                </span>
<span class="5311700283685025064" onmouseenter="enter('5311700283685025064');" onmouseout="out('5311700283685025064');" style=""> 150         mPublishTimeoutHandler = new Handler();                                                          </span>
<span  style=""> 151                                                                                                          </span>
<span class="-8863028397307166255" onmouseenter="enter('-8863028397307166255');" onmouseout="out('-8863028397307166255');" style=""> 152         mMatchHighlighter = new TextHighlighter(getActivity(),                                           </span>
<span class="5690198221529347900" onmouseenter="enter('5690198221529347900');" onmouseout="out('5690198221529347900');" style=""><abbr title=" 153                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor);"> 153                 R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor)ðŸ”µ</abbr></span>
<span class="3992270686517948303" onmouseenter="enter('3992270686517948303');" onmouseout="out('3992270686517948303');" style=""> 154         mAutocompleteAdapter = new CursorAdapter(getActivity(), null, 0x0){                              </span>
<span  style=""> 155                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 156             @Override                                                                                    </span>
<span class="5082230411214880762" onmouseenter="enter('5082230411214880762');" onmouseout="out('5082230411214880762');" style=""> 157             public View newView(Context context, Cursor cursor, ViewGroup parent) {                      </span>
<span class="-7341849400851650995" onmouseenter="enter('-7341849400851650995');" onmouseout="out('-7341849400851650995');" style=""> 158                 Activity activity = (Activity) context;                                                  </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 159                 if (activity == null) return null;                                                       </span>
<span class="-3314008061858345993" onmouseenter="enter('-3314008061858345993');" onmouseout="out('-3314008061858345993');" style=""> 160                 return activity.getLayoutInflater().inflate(R.layout.tag_autocomplete_list_item, null);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161             }                                                                                            </span>
<span  style=""> 162                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163             @Override                                                                                    </span>
<span class="19024103499623332" onmouseenter="enter('19024103499623332');" onmouseout="out('19024103499623332');" style=""> 164             public void bindView(View view, Context context, Cursor cursor) {                            </span>
<span class="1800045997788095368" onmouseenter="enter('1800045997788095368');" onmouseout="out('1800045997788095368');" style=""> 165                 TextView textView = (TextView) view;                                                     </span>
<span class="6731261465219202848" onmouseenter="enter('6731261465219202848');" onmouseout="out('6731261465219202848');" style=""> 166                 textView.setText(convertToString(cursor));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167             }                                                                                            </span>
<span  style=""> 168                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 169             @Override                                                                                    </span>
<span class="-1664730445059241307" onmouseenter="enter('-1664730445059241307');" onmouseout="out('-1664730445059241307');" style=""> 170             public CharSequence convertToString(Cursor cursor){                                          </span>
<span class="-7149458698442797769" onmouseenter="enter('-7149458698442797769');" onmouseout="out('-7149458698442797769');" style=""> 171                 return cursor.getString(cursor.getColumnIndex(Tag.NAME_PROPERTY));                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172             }                                                                                            </span>
<span  style=""> 173                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 174             @Override                                                                                    </span>
<span class="-6792310640715402890" onmouseenter="enter('-6792310640715402890');" onmouseout="out('-6792310640715402890');" style=""> 175             public Cursor runQueryOnBackgroundThread(CharSequence filter) {                              </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 176                 Activity activity = getActivity();                                                       </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 177                 if (activity == null) return null;                                                       </span>
<span class="9016693485500608067" onmouseenter="enter('9016693485500608067');" onmouseout="out('9016693485500608067');" style=""> 178                 Simplenote application = (Simplenote) activity.getApplication();                         </span>
<span class="-288329532637656436" onmouseenter="enter('-288329532637656436');" onmouseout="out('-288329532637656436');" style=""> 179                 Query&lt;Tag&gt; query = application.getTagsBucket().query();                                  </span>
<span class="-1263658484466254954" onmouseenter="enter('-1263658484466254954');" onmouseout="out('-1263658484466254954');" style=""> 180                 // make the tag name available to the cursor                                             </span>
<span class="5748018636045801946" onmouseenter="enter('5748018636045801946');" onmouseout="out('5748018636045801946');" style=""> 181                 query.include(Tag.NAME_PROPERTY);                                                        </span>
<span class="-7615810455976629564" onmouseenter="enter('-7615810455976629564');" onmouseout="out('-7615810455976629564');" style=""> 182                 // sort the tags by their names                                                          </span>
<span class="5674220988188306819" onmouseenter="enter('5674220988188306819');" onmouseout="out('5674220988188306819');" style=""> 183                 query.order(Tag.NAME_PROPERTY);                                                          </span>
<span class="8185275162074884971" onmouseenter="enter('8185275162074884971');" onmouseout="out('8185275162074884971');" style=""> 184                 // if there&#x27;s a filter string find only matching tag names                               </span>
<span class="-1465062097430607325" onmouseenter="enter('-1465062097430607325');" onmouseout="out('-1465062097430607325');" style=""><abbr title=" 185                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%&quot;, filter));"> 185                 if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.forðŸ”µ</abbr></span>
<span class="8392918727668200780" onmouseenter="enter('8392918727668200780');" onmouseout="out('8392918727668200780');" style=""> 186                 return query.execute();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187             }                                                                                            </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 188         };                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 191     @Override                                                                                            </span>
<span class="-7355940524539913821" onmouseenter="enter('-7355940524539913821');" onmouseout="out('-7355940524539913821');" style=""> 192     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {  </span>
<span class="7823602444079418117" onmouseenter="enter('7823602444079418117');" onmouseout="out('7823602444079418117');" style=""> 193         setHasOptionsMenu(true);                                                                         </span>
<span class="6339769591252564933" onmouseenter="enter('6339769591252564933');" onmouseout="out('6339769591252564933');" style=""> 194         View rootView = inflater.inflate(R.layout.fragment_note_editor, container, false);               </span>
<span class="-1364901824274913901" onmouseenter="enter('-1364901824274913901');" onmouseout="out('-1364901824274913901');" style=""> 195         mContentEditText = ((SimplenoteEditText) (rootView.findViewById(R.id.note_content)));            </span>
<span class="-2924083774161461664" onmouseenter="enter('-2924083774161461664');" onmouseout="out('-2924083774161461664');" style=""> 196         mContentEditText.addOnSelectionChangedListener(this);                                            </span>
<span class="4545655727599787961" onmouseenter="enter('4545655727599787961');" onmouseout="out('4545655727599787961');" style=""> 197         mTagView = ((TagsMultiAutoCompleteTextView) (rootView.findViewById(R.id.tag_view)));             </span>
<span class="-1710279282572635872" onmouseenter="enter('-1710279282572635872');" onmouseout="out('-1710279282572635872');" style=""> 198         mTagView.setTokenizer(new SpaceTokenizer());                                                     </span>
<span class="-905473657518076069" onmouseenter="enter('-905473657518076069');" onmouseout="out('-905473657518076069');" style=""> 199         mTagView.setOnFocusChangeListener(this);                                                         </span>
<span class="6080374810605667863" onmouseenter="enter('6080374810605667863');" onmouseout="out('6080374810605667863');" style=""> 200         mHighlighter = new MatchOffsetHighlighter(mMatchHighlighter, mContentEditText);                  </span>
<span class="1577312702828315360" onmouseenter="enter('1577312702828315360');" onmouseout="out('1577312702828315360');" style=""> 201         mPinButton = ((ToggleButton) (rootView.findViewById(R.id.pinButton)));                           </span>
<span class="-6233419192957625397" onmouseenter="enter('-6233419192957625397');" onmouseout="out('-6233419192957625397');" style=""> 202         mPinButton.setOnClickListener(new View.OnClickListener() {                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 203             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 204             public void onClick(View v) {                                                                </span>
<span class="-1510302136918940941" onmouseenter="enter('-1510302136918940941');" onmouseout="out('-1510302136918940941');" style=""> 205                 if (mPinButton.isChecked()) {                                                            </span>
<span class="-7637598965692605019" onmouseenter="enter('-7637598965692605019');" onmouseout="out('-7637598965692605019');" style=""> 206                     // Friendly message to the user as to what this button does.                         </span>
<span class="5938443200552047425" onmouseenter="enter('5938443200552047425');" onmouseout="out('5938443200552047425');" style=""> 207                     Toast.makeText(getActivity(), R.string.note_pinned, Toast.LENGTH_SHORT).show();      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 210         });                                                                                              </span>
<span class="8859941692086049893" onmouseenter="enter('8859941692086049893');" onmouseout="out('8859941692086049893');" style=""> 211         mPlaceholderView = ((LinearLayout) (rootView.findViewById(R.id.placeholder)));                   </span>
<span class="-2154062384511204910" onmouseenter="enter('-2154062384511204910');" onmouseout="out('-2154062384511204910');" style=""> 212         if (DisplayUtils.isLargeLandscape(getActivity()) &amp;&amp; (mNote == null)) {                           </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 213             mPlaceholderView.setVisibility(View.VISIBLE);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214         }                                                                                                </span>
<span class="-8386469275367064070" onmouseenter="enter('-8386469275367064070');" onmouseout="out('-8386469275367064070');" style=""> 215         mTagView.setAdapter(mAutocompleteAdapter);                                                       </span>
<span class="592168733134676120" onmouseenter="enter('592168733134676120');" onmouseout="out('592168733134676120');" style=""> 216         // Load note if we were passed a note Id                                                         </span>
<span class="-512438581163180757" onmouseenter="enter('-512438581163180757');" onmouseout="out('-512438581163180757');" style=""> 217         Bundle arguments = getArguments();                                                               </span>
<span class="4011393863908935220" onmouseenter="enter('4011393863908935220');" onmouseout="out('4011393863908935220');" style=""> 218         if ((arguments != null) &amp;&amp; arguments.containsKey(ARG_ITEM_ID)) {                                 </span>
<span class="-30854459346766710" onmouseenter="enter('-30854459346766710');" onmouseout="out('-30854459346766710');" style=""> 219             String key = arguments.getString(ARG_ITEM_ID);                                               </span>
<span class="9138949033848867696" onmouseenter="enter('9138949033848867696');" onmouseout="out('9138949033848867696');" style=""> 220             if (arguments.containsKey(ARG_MATCH_OFFSETS)) {                                              </span>
<span class="-1831707694683903303" onmouseenter="enter('-1831707694683903303');" onmouseout="out('-1831707694683903303');" style=""> 221                 mMatchOffsets = arguments.getString(ARG_MATCH_OFFSETS);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222             }                                                                                            </span>
<span class="-3890643464976908836" onmouseenter="enter('-3890643464976908836');" onmouseout="out('-3890643464976908836');" style=""> 223             new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, key);                   </span>
<span class="-4954549700347163589" onmouseenter="enter('-4954549700347163589');" onmouseout="out('-4954549700347163589');" style=""> 224             setIsNewNote(getArguments().getBoolean(ARG_NEW_NOTE, false));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225         }                                                                                                </span>
<span class="4654908577906893139" onmouseenter="enter('4654908577906893139');" onmouseout="out('4654908577906893139');" style=""> 226         return rootView;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 229     @Override                                                                                            </span>
<span class="3212580988936830895" onmouseenter="enter('3212580988936830895');" onmouseout="out('3212580988936830895');" style=""> 230     public void onResume() {                                                                             </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 231         super.onResume();                                                                                </span>
<span class="-295722270474880574" onmouseenter="enter('-295722270474880574');" onmouseout="out('-295722270474880574');" style=""> 232         mNotesBucket.start();                                                                            </span>
<span class="8320491026461558488" onmouseenter="enter('8320491026461558488');" onmouseout="out('8320491026461558488');" style=""> 233         mNotesBucket.addListener(this);                                                                  </span>
<span class="2283760307260285965" onmouseenter="enter('2283760307260285965');" onmouseout="out('2283760307260285965');" style=""> 234         mTagView.setOnTagAddedListener(this);                                                            </span>
<span class="-8630351771722931094" onmouseenter="enter('-8630351771722931094');" onmouseout="out('-8630351771722931094');" style=""> 235         if (mContentEditText != null) {                                                                  </span>
<span class="-999020196626820400" onmouseenter="enter('-999020196626820400');" onmouseout="out('-999020196626820400');" style=""><abbr title=" 236             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), PrefUtils.PREF_FONT_SIZE, 18));"> 236             mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238     }                                                                                                    </span>
<span  style=""> 239                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 240     @Override                                                                                            </span>
<span class="3108783673391190151" onmouseenter="enter('3108783673391190151');" onmouseout="out('3108783673391190151');" style=""> 241     public void onPause() {                                                                              </span>
<span class="-1649552973291504175" onmouseenter="enter('-1649552973291504175');" onmouseout="out('-1649552973291504175');" style=""> 242         mNotesBucket.removeListener(this);                                                               </span>
<span class="-4286062678685908757" onmouseenter="enter('-4286062678685908757');" onmouseout="out('-4286062678685908757');" style=""> 243         // Hide soft keyboard if it is showing...                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 244         if (getActivity() != null) {                                                                     </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 245             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 245             InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(CðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 246             if (inputMethodManager != null) {                                                            </span>
<span class="159022051514418479" onmouseenter="enter('159022051514418479');" onmouseout="out('159022051514418479');" style=""> 247                 inputMethodManager.hideSoftInputFromWindow(mContentEditText.getWindowToken(), 0);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249         }                                                                                                </span>
<span  style=""> 250                                                                                                          </span>
<span class="-2832208055092409078" onmouseenter="enter('-2832208055092409078');" onmouseout="out('-2832208055092409078');" style=""> 251         // Delete the note if it is new and has empty fields                                             </span>
<span class="-2219905285758853631" onmouseenter="enter('-2219905285758853631');" onmouseout="out('-2219905285758853631');" style=""> 252         if (mNote != null &amp;&amp; mIsNewNote &amp;&amp; noteIsEmpty()) {                                              </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 253             mNote.delete();                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 254         } else {                                                                                         </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 255             saveNote();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256         }                                                                                                </span>
<span  style=""> 257                                                                                                          </span>
<span class="-5824468190651999684" onmouseenter="enter('-5824468190651999684');" onmouseout="out('-5824468190651999684');" style=""> 258         mTagView.setOnTagAddedListener(null);                                                            </span>
<span  style=""> 259                                                                                                          </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 260         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 261             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262         }                                                                                                </span>
<span  style=""> 263                                                                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 264         if (mPublishTimeoutHandler != null) {                                                            </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 265             mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266         }                                                                                                </span>
<span  style=""> 267                                                                                                          </span>
<span class="212618759798230270" onmouseenter="enter('212618759798230270');" onmouseout="out('212618759798230270');" style=""> 268         mHighlighter.stop();                                                                             </span>
<span  style=""> 269                                                                                                          </span>
<span class="-7508449912261312872" onmouseenter="enter('-7508449912261312872');" onmouseout="out('-7508449912261312872');" style=""> 270         super.onPause();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 273     @Override                                                                                            </span>
<span class="-6208734081302594375" onmouseenter="enter('-6208734081302594375');" onmouseout="out('-6208734081302594375');" style=""> 274     public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {                                  </span>
<span class="-5591635883999644357" onmouseenter="enter('-5591635883999644357');" onmouseout="out('-5591635883999644357');" style=""> 275         inflater.inflate(R.menu.note_editor, menu);                                                      </span>
<span  style=""> 276                                                                                                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 277         if (mNote != null) {                                                                             </span>
<span class="3411369858029698957" onmouseenter="enter('3411369858029698957');" onmouseout="out('3411369858029698957');" style=""> 278             MenuItem viewPublishedNoteItem = menu.findItem(R.id.menu_view_info);                         </span>
<span class="-2499359923625437976" onmouseenter="enter('-2499359923625437976');" onmouseout="out('-2499359923625437976');" style=""> 279             viewPublishedNoteItem.setVisible(true);                                                      </span>
<span  style=""> 280                                                                                                          </span>
<span class="7674470390729338414" onmouseenter="enter('7674470390729338414');" onmouseout="out('7674470390729338414');" style=""> 281             MenuItem trashItem = menu.findItem(R.id.menu_delete).setTitle(R.string.undelete);            </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 282             if (mNote.isDeleted())                                                                       </span>
<span class="2395244797129247894" onmouseenter="enter('2395244797129247894');" onmouseout="out('2395244797129247894');" style=""> 283                 trashItem.setTitle(R.string.undelete);                                                   </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 284             else                                                                                         </span>
<span class="-2747782095374702281" onmouseenter="enter('-2747782095374702281');" onmouseout="out('-2747782095374702281');" style=""> 285                 trashItem.setTitle(R.string.delete);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286         }                                                                                                </span>
<span  style=""> 287                                                                                                          </span>
<span class="5772887857065615623" onmouseenter="enter('5772887857065615623');" onmouseout="out('5772887857065615623');" style=""> 288         super.onCreateOptionsMenu(menu, inflater);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span  style=""> 290                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 291     @Override                                                                                            </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 292     public boolean onOptionsItemSelected(MenuItem item) {                                                </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 293         switch (item.getItemId()) {                                                                      </span>
<span class="8247826493448347900" onmouseenter="enter('8247826493448347900');" onmouseout="out('8247826493448347900');" style=""> 294             case R.id.menu_view_info :                                                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 295                 if (mNote != null) {                                                                     </span>
<span class="-5974815457760504487" onmouseenter="enter('-5974815457760504487');" onmouseout="out('-5974815457760504487');" style=""> 296                     View menuItemView = getActivity().findViewById(R.id.menu_view_info);                 </span>
<span class="2497222703395221844" onmouseenter="enter('2497222703395221844');" onmouseout="out('2497222703395221844');" style=""> 297                     showInfoPopup(menuItemView);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 299                 return true;                                                                             </span>
<span class="-4929350896823615772" onmouseenter="enter('-4929350896823615772');" onmouseout="out('-4929350896823615772');" style=""> 300             case R.id.menu_share :                                                                       </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 301                 if (mNote != null) {                                                                     </span>
<span class="2351823289576090125" onmouseenter="enter('2351823289576090125');" onmouseout="out('2351823289576090125');" style=""> 302                     Intent shareIntent = new Intent(Intent.ACTION_SEND);                                 </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 303                     shareIntent.setType(&quot;text/plain&quot;);                                                   </span>
<span class="2565640458837084796" onmouseenter="enter('2565640458837084796');" onmouseout="out('2565640458837084796');" style=""> 304                     shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mNote.getContent());         </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 305                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 305                     startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.shaðŸ”µ</abbr></span>
<span class="-6023974736626738641" onmouseenter="enter('-6023974736626738641');" onmouseout="out('-6023974736626738641');" style=""><abbr title=" 306                     mTracker.send(new HitBuilders.EventBuilder().setCategory(&quot;note&quot;).setAction(&quot;shared_note&quot;).setLabel(&quot;action_bar_share_button&quot;).build());"> 306                     mTracker.send(new HitBuilders.EventBuilder().setCategory(&quot;note&quot;).setAction(&quot;shared_noðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307                 }                                                                                        </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 308                 return true;                                                                             </span>
<span class="4085560905623289311" onmouseenter="enter('4085560905623289311');" onmouseout="out('4085560905623289311');" style=""> 309             case R.id.menu_delete :                                                                      </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 310                 if (mNote != null) {                                                                     </span>
<span class="-929724925513034279" onmouseenter="enter('-929724925513034279');" onmouseout="out('-929724925513034279');" style=""> 311                     mNote.setDeleted(!mNote.isDeleted());                                                </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 312                     mNote.setModificationDate(Calendar.getInstance());                                   </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 313                     mNote.save();                                                                        </span>
<span class="-8654137458864067059" onmouseenter="enter('-8654137458864067059');" onmouseout="out('-8654137458864067059');" style=""> 314                     Intent resultIntent = new Intent();                                                  </span>
<span class="5561093706160816776" onmouseenter="enter('5561093706160816776');" onmouseout="out('5561093706160816776');" style=""> 315                     if (mNote.isDeleted()) {                                                             </span>
<span class="-4555570864561374481" onmouseenter="enter('-4555570864561374481');" onmouseout="out('-4555570864561374481');" style=""> 316                         resultIntent.putExtra(Simplenote.DELETED_NOTE_ID, mNote.getSimperiumKey());      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317                     }                                                                                    </span>
<span class="2925812847088143790" onmouseenter="enter('2925812847088143790');" onmouseout="out('2925812847088143790');" style=""> 318                     getActivity().setResult(Activity.RESULT_OK, resultIntent);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319                 }                                                                                        </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 320                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 321                 return true;                                                                             </span>
<span class="-1147335564575759755" onmouseenter="enter('-1147335564575759755');" onmouseout="out('-1147335564575759755');" style=""> 322             case android.R.id.home :                                                                     </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style=""> 323                 ActivityCompat.finishAfterTransition(getActivity());                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 324                 return true;                                                                             </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 325             default :                                                                                    </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 326                 return super.onOptionsItemSelected(item);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328     }                                                                                                    </span>
<span  style=""> 329                                                                                                          </span>
<span class="8271468180839847847" onmouseenter="enter('8271468180839847847');" onmouseout="out('8271468180839847847');" style=""> 330     // show a popup view from the info action bar item                                                   </span>
<span class="301694884727727095" onmouseenter="enter('301694884727727095');" onmouseout="out('301694884727727095');" style=""> 331     private void showInfoPopup(View view) {                                                              </span>
<span class="-8824124309160747557" onmouseenter="enter('-8824124309160747557');" onmouseout="out('-8824124309160747557');" style=""> 332         if (!isAdded() || view == null) return;                                                          </span>
<span  style=""> 333                                                                                                          </span>
<span class="-6163322818153177863" onmouseenter="enter('-6163322818153177863');" onmouseout="out('-6163322818153177863');" style=""> 334         if (mInfoPopupWindow == null) {                                                                  </span>
<span class="6416634994496998699" onmouseenter="enter('6416634994496998699');" onmouseout="out('6416634994496998699');" style=""> 335             mInfoPopupWindow = new PopupWindow(getActivity());                                           </span>
<span class="-7704183450622301834" onmouseenter="enter('-7704183450622301834');" onmouseout="out('-7704183450622301834');" style=""> 336             mInfoPopupWindow.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);                          </span>
<span class="-3987029803100381492" onmouseenter="enter('-3987029803100381492');" onmouseout="out('-3987029803100381492');" style=""> 337             mInfoPopupWindow.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);                         </span>
<span class="-8327124619089985465" onmouseenter="enter('-8327124619089985465');" onmouseout="out('-8327124619089985465');" style=""> 338             mInfoPopupWindow.setBackgroundDrawable(new ColorDrawable(0));                                </span>
<span class="3466073935356821559" onmouseenter="enter('3466073935356821559');" onmouseout="out('3466073935356821559');" style=""> 339             mInfoPopupWindow.setOutsideTouchable(true);                                                  </span>
<span class="-1875471742113799055" onmouseenter="enter('-1875471742113799055');" onmouseout="out('-1875471742113799055');" style=""> 340             mInfoPopupWindow.setFocusable(true);                                                         </span>
<span  style=""> 341                                                                                                          </span>
<span class="5212568524712573915" onmouseenter="enter('5212568524712573915');" onmouseout="out('5212568524712573915');" style=""> 342             LayoutInflater inflater = LayoutInflater.from(getActivity());                                </span>
<span class="-7758049233010801507" onmouseenter="enter('-7758049233010801507');" onmouseout="out('-7758049233010801507');" style=""> 343             View popupView = inflater.inflate(R.layout.popup_info, null);                                </span>
<span class="536077715701124131" onmouseenter="enter('536077715701124131');" onmouseout="out('536077715701124131');" style=""> 344             mInfoPopupWindow.setContentView(popupView);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345         }                                                                                                </span>
<span  style=""> 346                                                                                                          </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 347         updateInfoPopup();                                                                               </span>
<span  style=""> 348                                                                                                          </span>
<span class="4487253113225225144" onmouseenter="enter('4487253113225225144');" onmouseout="out('4487253113225225144');" style=""> 349         mInfoPopupWindow.showAsDropDown(view);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350     }                                                                                                    </span>
<span  style=""> 351                                                                                                          </span>
<span class="-8758077771583595367" onmouseenter="enter('-8758077771583595367');" onmouseout="out('-8758077771583595367');" style=""> 352     // update the content of the popupview                                                               </span>
<span class="-7181846678873590508" onmouseenter="enter('-7181846678873590508');" onmouseout="out('-7181846678873590508');" style=""> 353     private void updateInfoPopup() {                                                                     </span>
<span class="-8697403400729029020" onmouseenter="enter('-8697403400729029020');" onmouseout="out('-8697403400729029020');" style=""> 354         if (mInfoPopupWindow == null || mInfoPopupWindow.getContentView() == null) return;               </span>
<span  style=""> 355                                                                                                          </span>
<span class="3837773520867540996" onmouseenter="enter('3837773520867540996');" onmouseout="out('3837773520867540996');" style=""> 356         View popupView = mInfoPopupWindow.getContentView();                                              </span>
<span  style=""> 357                                                                                                          </span>
<span class="-5563348291777194716" onmouseenter="enter('-5563348291777194716');" onmouseout="out('-5563348291777194716');" style=""> 358         View publishButton = popupView.findViewById(R.id.publish_note_button);                           </span>
<span class="4581310412057978293" onmouseenter="enter('4581310412057978293');" onmouseout="out('4581310412057978293');" style=""> 359         TextView publishButtonTextView = (TextView)popupView.findViewById(R.id.publish_note_button_text);</span>
<span class="-6410915739065156574" onmouseenter="enter('-6410915739065156574');" onmouseout="out('-6410915739065156574');" style=""> 360         ImageView publishButtonIcon = (ImageView)popupView.findViewById(R.id.publish_note_button_icon);  </span>
<span class="-6918482493044946592" onmouseenter="enter('-6918482493044946592');" onmouseout="out('-6918482493044946592');" style=""> 361         TextView publishTextView = (TextView) popupView.findViewById(R.id.publish_url_textview);         </span>
<span class="1038347291336054559" onmouseenter="enter('1038347291336054559');" onmouseout="out('1038347291336054559');" style=""> 362         TextView wordCountTextView = (TextView) popupView.findViewById(R.id.word_count);                 </span>
<span class="-7977646551049898553" onmouseenter="enter('-7977646551049898553');" onmouseout="out('-7977646551049898553');" style=""> 363         ImageButton publishCopyButton = (ImageButton) popupView.findViewById(R.id.publish_copy_url);     </span>
<span class="7101383467626352915" onmouseenter="enter('7101383467626352915');" onmouseout="out('7101383467626352915');" style=""> 364         ImageButton publishShareButton = (ImageButton) popupView.findViewById(R.id.publish_share_url);   </span>
<span class="3150325744662714786" onmouseenter="enter('3150325744662714786');" onmouseout="out('3150325744662714786');" style=""> 365         View actionsView = popupView.findViewById(R.id.publish_actions);                                 </span>
<span  style=""> 366                                                                                                          </span>
<span class="1432622249676412210" onmouseenter="enter('1432622249676412210');" onmouseout="out('1432622249676412210');" style=""><abbr title=" 367         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcher);"> 367         final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcheðŸ”µ</abbr></span>
<span  style=""> 368                                                                                                          </span>
<span class="-7759606836018483289" onmouseenter="enter('-7759606836018483289');" onmouseout="out('-7759606836018483289');" style=""> 369         publishButton.setOnClickListener(new View.OnClickListener() {                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 370             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 371             public void onClick(View v) {                                                                </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 372                 if (mNote != null) {                                                                     </span>
<span class="5563864695602119989" onmouseenter="enter('5563864695602119989');" onmouseout="out('5563864695602119989');" style=""> 373                     boolean newPublishedStatus = !mNote.isPublished();                                   </span>
<span class="-3191807331109519265" onmouseenter="enter('-3191807331109519265');" onmouseout="out('-3191807331109519265');" style=""> 374                     mNote.setPublished(newPublishedStatus);                                              </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 375                     mNote.save();                                                                        </span>
<span  style=""> 376                                                                                                          </span>
<span class="-6566894946886815467" onmouseenter="enter('-6566894946886815467');" onmouseout="out('-6566894946886815467');" style=""> 377                     if (viewSwitcher.getDisplayedChild() == 0) {                                         </span>
<span class="1964540099195163034" onmouseenter="enter('1964540099195163034');" onmouseout="out('1964540099195163034');" style=""> 378                         viewSwitcher.showNext();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379                     }                                                                                    </span>
<span  style=""> 380                                                                                                          </span>
<span class="3198515589608942377" onmouseenter="enter('3198515589608942377');" onmouseout="out('3198515589608942377');" style=""> 381                     // reset publish status in 20 seconds if we don&#x27;t hear back from Simperium           </span>
<span class="-4829904289357833951" onmouseenter="enter('-4829904289357833951');" onmouseout="out('-4829904289357833951');" style=""> 382                     mPublishTimeoutHandler.postDelayed(mPublishTimeoutRunnable, 20000);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 385         });                                                                                              </span>
<span  style=""> 386                                                                                                          </span>
<span class="4045844893437359317" onmouseenter="enter('4045844893437359317');" onmouseout="out('4045844893437359317');" style=""> 387         publishTextView.setOnClickListener(new View.OnClickListener() {                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 388             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 389             public void onClick(View v) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 390                 try {                                                                                    </span>
<span class="-8142976939479350202" onmouseenter="enter('-8142976939479350202');" onmouseout="out('-8142976939479350202');" style=""> 391                     startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(mNote.getPublishedUrl())));   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 392                 } catch (Exception e) {                                                                  </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 393                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 396         });                                                                                              </span>
<span  style=""> 397                                                                                                          </span>
<span class="-6950650320634084190" onmouseenter="enter('-6950650320634084190');" onmouseout="out('-6950650320634084190');" style=""> 398         publishCopyButton.setOnClickListener(new View.OnClickListener() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 399             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 400             public void onClick(View v) {                                                                </span>
<span class="4796955211675373396" onmouseenter="enter('4796955211675373396');" onmouseout="out('4796955211675373396');" style=""><abbr title=" 401                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 401                 ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLðŸ”µ</abbr></span>
<span class="-7278433972965562810" onmouseenter="enter('-7278433972965562810');" onmouseout="out('-7278433972965562810');" style=""><abbr title=" 402                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrl());"> 402                 ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrlðŸ”µ</abbr></span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 403                 clipboard.setPrimaryClip(clip);                                                          </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 404                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 404                 Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 406         });                                                                                              </span>
<span  style=""> 407                                                                                                          </span>
<span class="7858974346508965340" onmouseenter="enter('7858974346508965340');" onmouseout="out('7858974346508965340');" style=""> 408         publishShareButton.setOnClickListener(new View.OnClickListener() {                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 409             @Override                                                                                    </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 410             public void onClick(View v) {                                                                </span>
<span class="-1084258541936962831" onmouseenter="enter('-1084258541936962831');" onmouseout="out('-1084258541936962831');" style=""> 411                 Intent i = new Intent(Intent.ACTION_SEND);                                               </span>
<span class="-4820203166518762252" onmouseenter="enter('-4820203166518762252');" onmouseout="out('-4820203166518762252');" style=""> 412                 i.setType(&quot;text/plain&quot;);                                                                 </span>
<span class="-6000923337939610903" onmouseenter="enter('-6000923337939610903');" onmouseout="out('-6000923337939610903');" style=""> 413                 i.putExtra(Intent.EXTRA_TEXT, mNote.getPublishedUrl());                                  </span>
<span class="3733331565586339944" onmouseenter="enter('3733331565586339944');" onmouseout="out('3733331565586339944');" style=""> 414                 startActivity(Intent.createChooser(i, getString(R.string.share_url)));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 416         });                                                                                              </span>
<span  style=""> 417                                                                                                          </span>
<span class="-2067876314787213528" onmouseenter="enter('-2067876314787213528');" onmouseout="out('-2067876314787213528');" style=""> 418         updateWordCount(wordCountTextView);                                                              </span>
<span  style=""> 419                                                                                                          </span>
<span class="-1365615346790030662" onmouseenter="enter('-1365615346790030662');" onmouseout="out('-1365615346790030662');" style=""> 420         if (mNote.isPublished()) {                                                                       </span>
<span class="-8174565940676304202" onmouseenter="enter('-8174565940676304202');" onmouseout="out('-8174565940676304202');" style=""> 421             publishButtonTextView.setText(getString(R.string.published));                                </span>
<span class="8297531220637406295" onmouseenter="enter('8297531220637406295');" onmouseout="out('8297531220637406295');" style=""> 422             publishButtonIcon.setVisibility(View.VISIBLE);                                               </span>
<span class="-2988513566372186325" onmouseenter="enter('-2988513566372186325');" onmouseout="out('-2988513566372186325');" style=""> 423             publishTextView.setText(mNote.getPublishedUrl());                                            </span>
<span class="6413899042811805294" onmouseenter="enter('6413899042811805294');" onmouseout="out('6413899042811805294');" style=""> 424             actionsView.setVisibility(View.VISIBLE);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 425         } else {                                                                                         </span>
<span class="843719504642786212" onmouseenter="enter('843719504642786212');" onmouseout="out('843719504642786212');" style=""> 426             publishButtonTextView.setText(getString(R.string.publish));                                  </span>
<span class="-2250731724671553485" onmouseenter="enter('-2250731724671553485');" onmouseout="out('-2250731724671553485');" style=""> 427             publishButtonIcon.setVisibility(View.GONE);                                                  </span>
<span class="1035970444036754268" onmouseenter="enter('1035970444036754268');" onmouseout="out('1035970444036754268');" style=""> 428             actionsView.setVisibility(View.GONE);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429         }                                                                                                </span>
<span  style=""> 430                                                                                                          </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 431         Simplenote currentApp = (Simplenote) getActivity().getApplication();                             </span>
<span class="-1805411858302537149" onmouseenter="enter('-1805411858302537149');" onmouseout="out('-1805411858302537149');" style=""> 432         if (currentApp.getSimperium().needsAuthorization()) {                                            </span>
<span class="5338357254244494547" onmouseenter="enter('5338357254244494547');" onmouseout="out('5338357254244494547');" style=""> 433             viewSwitcher.setVisibility(View.GONE);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 434         } else {                                                                                         </span>
<span class="4598892846854382425" onmouseenter="enter('4598892846854382425');" onmouseout="out('4598892846854382425');" style=""> 435             viewSwitcher.setVisibility(View.VISIBLE);                                                    </span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 436             if (viewSwitcher.getDisplayedChild() == 1) {                                                 </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 437                 viewSwitcher.showPrevious();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440     }                                                                                                    </span>
<span  style=""> 441                                                                                                          </span>
<span class="2878966018694925493" onmouseenter="enter('2878966018694925493');" onmouseout="out('2878966018694925493');" style=""> 442     private boolean noteIsEmpty() {                                                                      </span>
<span class="5142306291108152313" onmouseenter="enter('5142306291108152313');" onmouseout="out('5142306291108152313');" style=""> 443         return (getNoteContentString().trim().length() == 0 &amp;&amp; getNoteTagsString().trim().length() == 0);</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444     }                                                                                                    </span>
<span  style=""> 445                                                                                                          </span>
<span class="8710628914141899315" onmouseenter="enter('8710628914141899315');" onmouseout="out('8710628914141899315');" style=""> 446     public void setNote(String noteID){                                                                  </span>
<span class="-6972394152055286124" onmouseenter="enter('-6972394152055286124');" onmouseout="out('-6972394152055286124');" style=""> 447         setNote(noteID, null);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="8195105300246755684" onmouseenter="enter('8195105300246755684');" onmouseout="out('8195105300246755684');" style=""> 450     public void setNote(String noteID, String matchOffsets) {                                            </span>
<span class="-3646372507164546123" onmouseenter="enter('-3646372507164546123');" onmouseout="out('-3646372507164546123');" style=""> 451         if (mAutoSaveHandler != null)                                                                    </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 452             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span  style=""> 453                                                                                                          </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 454         mPlaceholderView.setVisibility(View.GONE);                                                       </span>
<span  style=""> 455                                                                                                          </span>
<span class="2077738191995360697" onmouseenter="enter('2077738191995360697');" onmouseout="out('2077738191995360697');" style=""> 456         if (matchOffsets != null)                                                                        </span>
<span class="76822769413740338" onmouseenter="enter('76822769413740338');" onmouseout="out('76822769413740338');" style=""> 457             mMatchOffsets = matchOffsets;                                                                </span>
<span  style=""> 458                                                                                                          </span>
<span class="-4019470309104916899" onmouseenter="enter('-4019470309104916899');" onmouseout="out('-4019470309104916899');" style=""> 459         // If we have a note already (on a tablet in landscape), save the note.                          </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 460         if (mNote != null) {                                                                             </span>
<span class="4900947620417658692" onmouseenter="enter('4900947620417658692');" onmouseout="out('4900947620417658692');" style=""> 461             if (mIsNewNote &amp;&amp; noteIsEmpty())                                                             </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 462                 mNote.delete();                                                                          </span>
<span class="-2440894158330100228" onmouseenter="enter('-2440894158330100228');" onmouseout="out('-2440894158330100228');" style=""> 463             else if (mNote != null)                                                                      </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 464                 saveNote();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465         }                                                                                                </span>
<span  style=""> 466                                                                                                          </span>
<span class="-3492920802008394842" onmouseenter="enter('-3492920802008394842');" onmouseout="out('-3492920802008394842');" style=""> 467         new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, noteID);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="-3433185850424102984" onmouseenter="enter('-3433185850424102984');" onmouseout="out('-3433185850424102984');" style=""> 470     public void updateNote(Note updatedNote) {                                                           </span>
<span class="1053945494720623403" onmouseenter="enter('1053945494720623403');" onmouseout="out('1053945494720623403');" style=""> 471         // update note if network change arrived                                                         </span>
<span class="8715526790189509580" onmouseenter="enter('8715526790189509580');" onmouseout="out('8715526790189509580');" style=""> 472         mNote = updatedNote;                                                                             </span>
<span class="-1082183570760036139" onmouseenter="enter('-1082183570760036139');" onmouseout="out('-1082183570760036139');" style=""> 473         refreshContent(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474     }                                                                                                    </span>
<span  style=""> 475                                                                                                          </span>
<span class="-5323752859114125708" onmouseenter="enter('-5323752859114125708');" onmouseout="out('-5323752859114125708');" style=""> 476     public void refreshContent(boolean isNoteUpdate) {                                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 477         if (mNote != null) {                                                                             </span>
<span class="9083634457699551889" onmouseenter="enter('9083634457699551889');" onmouseout="out('9083634457699551889');" style=""> 478             // Restore the cursor position if possible.                                                  </span>
<span  style=""> 479                                                                                                          </span>
<span class="-3899995221280134201" onmouseenter="enter('-3899995221280134201');" onmouseout="out('-3899995221280134201');" style=""><abbr title=" 480             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.getSelectionEnd());"> 480             int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEdðŸ”µ</abbr></span>
<span  style=""> 481                                                                                                          </span>
<span class="4148799213240179760" onmouseenter="enter('4148799213240179760');" onmouseout="out('4148799213240179760');" style=""> 482             mContentEditText.setText(mNote.getContent());                                                </span>
<span  style=""> 483                                                                                                          </span>
<span class="2353268123342341866" onmouseenter="enter('2353268123342341866');" onmouseout="out('2353268123342341866');" style=""> 484             if (isNoteUpdate) {                                                                          </span>
<span class="-1678402685678405938" onmouseenter="enter('-1678402685678405938');" onmouseout="out('-1678402685678405938');" style=""> 485                 // Save the note so any local changes get synced                                         </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 486                 mNote.save();                                                                            </span>
<span  style=""> 487                                                                                                          </span>
<span class="-5094013145931261947" onmouseenter="enter('-5094013145931261947');" onmouseout="out('-5094013145931261947');" style=""><abbr title=" 488                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) {"> 488                 if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) ðŸ”µ</abbr></span>
<span class="2096054726124109686" onmouseenter="enter('2096054726124109686');" onmouseout="out('2096054726124109686');" style=""> 489                     mContentEditText.setSelection(cursorPosition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 490                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491             }                                                                                            </span>
<span  style=""> 492                                                                                                          </span>
<span class="-2853209662220592982" onmouseenter="enter('-2853209662220592982');" onmouseout="out('-2853209662220592982');" style=""> 493             afterTextChanged(mContentEditText.getText());                                                </span>
<span  style=""> 494                                                                                                          </span>
<span class="8723833736514346639" onmouseenter="enter('8723833736514346639');" onmouseout="out('8723833736514346639');" style=""> 495             mPinButton.setChecked(mNote.isPinned());                                                     </span>
<span  style=""> 496                                                                                                          </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 497             updateTagList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499     }                                                                                                    </span>
<span  style=""> 500                                                                                                          </span>
<span class="-5496131723873966197" onmouseenter="enter('-5496131723873966197');" onmouseout="out('-5496131723873966197');" style=""> 501     public void updateTagList() {                                                                        </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 502         Activity activity = getActivity();                                                               </span>
<span class="5732290278551506292" onmouseenter="enter('5732290278551506292');" onmouseout="out('5732290278551506292');" style=""> 503         if (activity == null) return;                                                                    </span>
<span  style=""> 504                                                                                                          </span>
<span class="-8748481830530330770" onmouseenter="enter('-8748481830530330770');" onmouseout="out('-8748481830530330770');" style=""> 505         // Populate this note&#x27;s tags in the tagView                                                      </span>
<span class="-3805230291902185366" onmouseenter="enter('-3805230291902185366');" onmouseout="out('-3805230291902185366');" style=""> 506         mTagView.setChips(mNote.getTagString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507     }                                                                                                    </span>
<span  style=""> 508                                                                                                          </span>
<span class="-3598917219400102100" onmouseenter="enter('-3598917219400102100');" onmouseout="out('-3598917219400102100');" style=""> 509     int newCursorLocation(String newText, String oldText, int cursorLocation) {                          </span>
<span class="9215253731107462720" onmouseenter="enter('9215253731107462720');" onmouseout="out('9215253731107462720');" style=""> 510         // Ported from the iOS app :)                                                                    </span>
<span class="746416875920517525" onmouseenter="enter('746416875920517525');" onmouseout="out('746416875920517525');" style=""> 511         // Cases:                                                                                        </span>
<span class="5532692154938930485" onmouseenter="enter('5532692154938930485');" onmouseout="out('5532692154938930485');" style=""> 512         // 0. All text after cursor (and possibly more) was removed ==&gt; put cursor at end                </span>
<span class="7679522442911259243" onmouseenter="enter('7679522442911259243');" onmouseout="out('7679522442911259243');" style=""> 513         // 1. Text was added after the cursor ==&gt; no change                                              </span>
<span class="-7894032746042607578" onmouseenter="enter('-7894032746042607578');" onmouseout="out('-7894032746042607578');" style=""> 514         // 2. Text was added before the cursor ==&gt; location advances                                     </span>
<span class="-2716138352653500367" onmouseenter="enter('-2716138352653500367');" onmouseout="out('-2716138352653500367');" style=""> 515         // 3. Text was removed after the cursor ==&gt; no change                                            </span>
<span class="-5135222146548415418" onmouseenter="enter('-5135222146548415418');" onmouseout="out('-5135222146548415418');" style=""> 516         // 4. Text was removed before the cursor ==&gt; location retreats                                   </span>
<span class="-7558810491072030947" onmouseenter="enter('-7558810491072030947');" onmouseout="out('-7558810491072030947');" style=""> 517         // 5. Text was added/removed on both sides of the cursor ==&gt; not handled                         </span>
<span  style=""> 518                                                                                                          </span>
<span class="2494517364842646163" onmouseenter="enter('2494517364842646163');" onmouseout="out('2494517364842646163');" style=""> 519         int newCursorLocation = cursorLocation;                                                          </span>
<span  style=""> 520                                                                                                          </span>
<span class="5908042661332565473" onmouseenter="enter('5908042661332565473');" onmouseout="out('5908042661332565473');" style=""> 521         int deltaLength = newText.length() - oldText.length();                                           </span>
<span  style=""> 522                                                                                                          </span>
<span class="-6285488792309831531" onmouseenter="enter('-6285488792309831531');" onmouseout="out('-6285488792309831531');" style=""> 523         // Case 0                                                                                        </span>
<span class="-3414403190560247865" onmouseenter="enter('-3414403190560247865');" onmouseout="out('-3414403190560247865');" style=""> 524         if (newText.length() &lt; cursorLocation)                                                           </span>
<span class="-8431314608568195365" onmouseenter="enter('-8431314608568195365');" onmouseout="out('-8431314608568195365');" style=""> 525             return newText.length();                                                                     </span>
<span  style=""> 526                                                                                                          </span>
<span class="-8591384106259708496" onmouseenter="enter('-8591384106259708496');" onmouseout="out('-8591384106259708496');" style=""> 527         boolean beforeCursorMatches = false;                                                             </span>
<span class="-2836779116340504068" onmouseenter="enter('-2836779116340504068');" onmouseout="out('-2836779116340504068');" style=""> 528         boolean afterCursorMatches = false;                                                              </span>
<span  style=""> 529                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 530         try {                                                                                            </span>
<span class="535177221055952012" onmouseenter="enter('535177221055952012');" onmouseout="out('535177221055952012');" style=""><abbr title=" 531             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation));"> 531             beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorðŸ”µ</abbr></span>
<span class="-6954326744185480821" onmouseenter="enter('-6954326744185480821');" onmouseout="out('-6954326744185480821');" style=""><abbr title=" 532             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursorLocation + deltaLength, newText.length()));"> 532             afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 533         } catch (Exception e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 534             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535         }                                                                                                </span>
<span  style=""> 536                                                                                                          </span>
<span class="-8188204612528872149" onmouseenter="enter('-8188204612528872149');" onmouseout="out('-8188204612528872149');" style=""> 537         // Cases 2 and 4                                                                                 </span>
<span class="6616414540674367624" onmouseenter="enter('6616414540674367624');" onmouseout="out('6616414540674367624');" style=""> 538         if (!beforeCursorMatches &amp;&amp; afterCursorMatches)                                                  </span>
<span class="-4510977125628343614" onmouseenter="enter('-4510977125628343614');" onmouseout="out('-4510977125628343614');" style=""> 539             newCursorLocation += deltaLength;                                                            </span>
<span  style=""> 540                                                                                                          </span>
<span class="6867115481875645839" onmouseenter="enter('6867115481875645839');" onmouseout="out('6867115481875645839');" style=""> 541         // Cases 1, 3 and 5 have no change                                                               </span>
<span class="-7784410696724573059" onmouseenter="enter('-7784410696724573059');" onmouseout="out('-7784410696724573059');" style=""> 542         return newCursorLocation;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 543     }                                                                                                    </span>
<span  style=""> 544                                                                                                          </span>
<span class="-4880079435078668080" onmouseenter="enter('-4880079435078668080');" onmouseout="out('-4880079435078668080');" style=""> 545     private Runnable mAutoSaveRunnable = new Runnable() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 546         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 547         public void run() {                                                                              </span>
<span class="-2186856349666885424" onmouseenter="enter('-2186856349666885424');" onmouseout="out('-2186856349666885424');" style=""> 548             saveAndSyncNote();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 550     };                                                                                                   </span>
<span  style=""> 551                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 552     @Override                                                                                            </span>
<span class="-2796122281296135687" onmouseenter="enter('-2796122281296135687');" onmouseout="out('-2796122281296135687');" style=""> 553     public void onTagsChanged(String tagString) {                                                        </span>
<span class="5357705753761437027" onmouseenter="enter('5357705753761437027');" onmouseout="out('5357705753761437027');" style=""> 554         if (mNote == null || !isAdded()) return;                                                         </span>
<span  style=""> 555                                                                                                          </span>
<span class="-6077287130430406243" onmouseenter="enter('-6077287130430406243');" onmouseout="out('-6077287130430406243');" style=""> 556         if (mNote.getTagString() != null &amp;&amp; tagString.length() &gt; mNote.getTagString().length()) {        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 557             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 558                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 559                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="5410511239462362052" onmouseenter="enter('5410511239462362052');" onmouseout="out('5410511239462362052');" style=""> 560                             .setAction(&quot;added_tag&quot;)                                                      </span>
<span class="-4831158292382506824" onmouseenter="enter('-4831158292382506824');" onmouseout="out('-4831158292382506824');" style=""> 561                             .setLabel(&quot;tag_added_to_note&quot;)                                               </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 562                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 563             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 564         }                                                                                                </span>
<span class="4391598042186419731" onmouseenter="enter('4391598042186419731');" onmouseout="out('4391598042186419731');" style=""> 565         else {                                                                                           </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 566             mTracker.send(                                                                               </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 567                     new HitBuilders.EventBuilder()                                                       </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 568                             .setCategory(&quot;note&quot;)                                                         </span>
<span class="-1624008121867682947" onmouseenter="enter('-1624008121867682947');" onmouseout="out('-1624008121867682947');" style=""> 569                             .setAction(&quot;removed_tag&quot;)                                                    </span>
<span class="-6979485583008136850" onmouseenter="enter('-6979485583008136850');" onmouseout="out('-6979485583008136850');" style=""> 570                             .setLabel(&quot;tag_removed_from_note&quot;)                                           </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 571                             .build()                                                                     </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 572             );                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573         }                                                                                                </span>
<span  style=""> 574                                                                                                          </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 575         mNote.setTagString(tagString);                                                                   </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 576         mNote.setModificationDate(Calendar.getInstance());                                               </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 577         updateTagList();                                                                                 </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 578         mNote.save();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579     }                                                                                                    </span>
<span  style=""> 580                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 581     @Override                                                                                            </span>
<span class="-5110897291356760413" onmouseenter="enter('-5110897291356760413');" onmouseout="out('-5110897291356760413');" style=""> 582     public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {                    </span>
<span class="7490540504293754116" onmouseenter="enter('7490540504293754116');" onmouseout="out('7490540504293754116');" style=""> 583         // Unused                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 584     }                                                                                                    </span>
<span  style=""> 585                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 586     @Override                                                                                            </span>
<span class="-3169498224421089624" onmouseenter="enter('-3169498224421089624');" onmouseout="out('-3169498224421089624');" style=""> 587     public void afterTextChanged(Editable editable) {                                                    </span>
<span class="7005237563799171506" onmouseenter="enter('7005237563799171506');" onmouseout="out('7005237563799171506');" style=""> 588         setTitleSpan(editable);                                                                          </span>
<span class="4641646211430236365" onmouseenter="enter('4641646211430236365');" onmouseout="out('4641646211430236365');" style=""> 589         attemptAutoList(editable);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590     }                                                                                                    </span>
<span  style=""> 591                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 592     @Override                                                                                            </span>
<span class="-6004971105578563950" onmouseenter="enter('-6004971105578563950');" onmouseout="out('-6004971105578563950');" style=""> 593     public void onTextChanged(CharSequence charSequence, int start, int before, int count) {             </span>
<span  style=""> 594                                                                                                          </span>
<span class="2036741165452809133" onmouseenter="enter('2036741165452809133');" onmouseout="out('2036741165452809133');" style=""> 595         // When text changes, start timer that will fire after AUTOSAVE_DELAY_MILLIS passes              </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 596         if (mAutoSaveHandler != null) {                                                                  </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 597             mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                         </span>
<span class="3237260668993885548" onmouseenter="enter('3237260668993885548');" onmouseout="out('3237260668993885548');" style=""> 598             mAutoSaveHandler.postDelayed(mAutoSaveRunnable, AUTOSAVE_DELAY_MILLIS);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 599         }                                                                                                </span>
<span  style=""> 600                                                                                                          </span>
<span class="5409551732025834677" onmouseenter="enter('5409551732025834677');" onmouseout="out('5409551732025834677');" style=""> 601         // Remove search highlight spans when note content changes                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 602         if (mMatchOffsets != null) {                                                                     </span>
<span class="-5254682256162211718" onmouseenter="enter('-5254682256162211718');" onmouseout="out('-5254682256162211718');" style=""> 603             mMatchOffsets = null;                                                                        </span>
<span class="2930846742809702691" onmouseenter="enter('2930846742809702691');" onmouseout="out('2930846742809702691');" style=""> 604             mHighlighter.removeMatches();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 605         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606     }                                                                                                    </span>
<span  style=""> 607                                                                                                          </span>
<span class="6849776144692122373" onmouseenter="enter('6849776144692122373');" onmouseout="out('6849776144692122373');" style=""> 608     private void setTitleSpan(Editable editable) {                                                       </span>
<span class="-1378972571136516392" onmouseenter="enter('-1378972571136516392');" onmouseout="out('-1378972571136516392');" style=""> 609         // Set the note title to be a larger size                                                        </span>
<span class="3997786880116952820" onmouseenter="enter('3997786880116952820');" onmouseout="out('3997786880116952820');" style=""> 610         // Remove any existing size spans                                                                </span>
<span class="-3345432347418186953" onmouseenter="enter('-3345432347418186953');" onmouseout="out('-3345432347418186953');" style=""> 611         RelativeSizeSpan[] spans = editable.getSpans(0, editable.length(), RelativeSizeSpan.class);      </span>
<span class="2386014209880419735" onmouseenter="enter('2386014209880419735');" onmouseout="out('2386014209880419735');" style=""> 612         for (RelativeSizeSpan span : spans) {                                                            </span>
<span class="-4538099325482792099" onmouseenter="enter('-4538099325482792099');" onmouseout="out('-4538099325482792099');" style=""> 613             editable.removeSpan(span);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614         }                                                                                                </span>
<span class="-901734861574280266" onmouseenter="enter('-901734861574280266');" onmouseout="out('-901734861574280266');" style=""> 615         int newLinePosition = getNoteContentString().indexOf(&quot;\n&quot;);                                      </span>
<span class="-3049917029530340718" onmouseenter="enter('-3049917029530340718');" onmouseout="out('-3049917029530340718');" style=""> 616         if (newLinePosition == 0) {                                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 617             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 618         }                                                                                                </span>
<span class="-5646116407572243305" onmouseenter="enter('-5646116407572243305');" onmouseout="out('-5646116407572243305');" style=""><abbr title=" 619         editable.setSpan(new RelativeSizeSpan(1.227F), 0, newLinePosition &gt; 0 ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 619         editable.setSpan(new RelativeSizeSpan(1.227F), 0, newLinePosition &gt; 0 ? newLinePosition : editablðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 620     }                                                                                                    </span>
<span  style=""> 621                                                                                                          </span>
<span class="8395667075038215241" onmouseenter="enter('8395667075038215241');" onmouseout="out('8395667075038215241');" style=""> 622     private void attemptAutoList(Editable editable) {                                                    </span>
<span class="1630313539519665774" onmouseenter="enter('1630313539519665774');" onmouseout="out('1630313539519665774');" style=""> 623         int oldCursorPosition = mCurrentCursorPosition;                                                  </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 624         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="-1456162723219098064" onmouseenter="enter('-1456162723219098064');" onmouseout="out('-1456162723219098064');" style=""> 625         AutoBullet.apply(editable, oldCursorPosition, mCurrentCursorPosition);                           </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 626         mCurrentCursorPosition = mContentEditText.getSelectionStart();                                   </span>
<span class="6723912502491086435" onmouseenter="enter('6723912502491086435');" onmouseout="out('6723912502491086435');" style=""> 627         android.util.Log.d(&quot;Simplenote&quot;, &quot;==&gt; post cursor position:&quot; + mCurrentCursorPosition);          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 628     }                                                                                                    </span>
<span  style=""> 629                                                                                                          </span>
<span class="-6933317077070028336" onmouseenter="enter('-6933317077070028336');" onmouseout="out('-6933317077070028336');" style=""> 630     private void saveAndSyncNote() {                                                                     </span>
<span class="8223376420483055518" onmouseenter="enter('8223376420483055518');" onmouseout="out('8223376420483055518');" style=""> 631         if (mNote == null)                                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 632             return;                                                                                      </span>
<span  style=""> 633                                                                                                          </span>
<span class="5987107161692050970" onmouseenter="enter('5987107161692050970');" onmouseout="out('5987107161692050970');" style=""> 634         new saveNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635     }                                                                                                    </span>
<span  style=""> 636                                                                                                          </span>
<span class="-4564004023547017377" onmouseenter="enter('-4564004023547017377');" onmouseout="out('-4564004023547017377');" style=""> 637     public void setPlaceholderVisible(boolean isVisible) {                                               </span>
<span class="-6467031518050872536" onmouseenter="enter('-6467031518050872536');" onmouseout="out('-6467031518050872536');" style=""> 638         if (isVisible) {                                                                                 </span>
<span class="1687907534970456445" onmouseenter="enter('1687907534970456445');" onmouseout="out('1687907534970456445');" style=""> 639             mNote = null;                                                                                </span>
<span class="-3407359796970873837" onmouseenter="enter('-3407359796970873837');" onmouseout="out('-3407359796970873837');" style=""> 640             mContentEditText.setText(&quot;&quot;);                                                                </span>
<span class="-7997465605671669559" onmouseenter="enter('-7997465605671669559');" onmouseout="out('-7997465605671669559');" style=""> 641             mTagView.setText(&quot;&quot;);                                                                        </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 642             if (mPlaceholderView != null)                                                                </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 643                 mPlaceholderView.setVisibility(View.VISIBLE);                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 644         } else {                                                                                         </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 645             if (mPlaceholderView != null)                                                                </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 646                 mPlaceholderView.setVisibility(View.GONE);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 647         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 648     }                                                                                                    </span>
<span  style=""> 649                                                                                                          </span>
<span class="7106522413253020021" onmouseenter="enter('7106522413253020021');" onmouseout="out('7106522413253020021');" style=""> 650     public void setIsNewNote(boolean isNewNote) {                                                        </span>
<span class="-5949421386499580587" onmouseenter="enter('-5949421386499580587');" onmouseout="out('-5949421386499580587');" style=""> 651         this.mIsNewNote = isNewNote;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 652     }                                                                                                    </span>
<span  style=""> 653                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 654     @Override                                                                                            </span>
<span class="-3315120631467309087" onmouseenter="enter('-3315120631467309087');" onmouseout="out('-3315120631467309087');" style=""> 655     public void onFocusChange(View v, boolean hasFocus) {                                                </span>
<span class="-6285712256166584728" onmouseenter="enter('-6285712256166584728');" onmouseout="out('-6285712256166584728');" style=""> 656         if (!hasFocus) {                                                                                 </span>
<span class="-6666174322440118634" onmouseenter="enter('-6666174322440118634');" onmouseout="out('-6666174322440118634');" style=""> 657             String tagString = getNoteTagsString().trim();                                               </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 658             if (tagString.length() &gt; 0) {                                                                </span>
<span class="8488340728323435918" onmouseenter="enter('8488340728323435918');" onmouseout="out('8488340728323435918');" style=""> 659                 mTagView.setChips(tagString);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 662     }                                                                                                    </span>
<span  style=""> 663                                                                                                          </span>
<span class="-6849832043716883515" onmouseenter="enter('-6849832043716883515');" onmouseout="out('-6849832043716883515');" style=""> 664     public Note getNote() {                                                                              </span>
<span class="6687317620803594982" onmouseenter="enter('6687317620803594982');" onmouseout="out('6687317620803594982');" style=""> 665         return mNote;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 666     }                                                                                                    </span>
<span  style=""> 667                                                                                                          </span>
<span class="5855058962481175207" onmouseenter="enter('5855058962481175207');" onmouseout="out('5855058962481175207');" style=""> 668     public String getNoteContentString() {                                                               </span>
<span class="-8451380960236704581" onmouseenter="enter('-8451380960236704581');" onmouseout="out('-8451380960236704581');" style=""> 669         if (mContentEditText == null || mContentEditText.getText() == null) {                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 670             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 671         } else {                                                                                         </span>
<span class="9069870454824528783" onmouseenter="enter('9069870454824528783');" onmouseout="out('9069870454824528783');" style=""> 672             return mContentEditText.getText().toString();                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 673         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674     }                                                                                                    </span>
<span  style=""> 675                                                                                                          </span>
<span class="2486113532203564324" onmouseenter="enter('2486113532203564324');" onmouseout="out('2486113532203564324');" style=""> 676     public String getNoteTagsString() {                                                                  </span>
<span class="2201751553125502793" onmouseenter="enter('2201751553125502793');" onmouseout="out('2201751553125502793');" style=""> 677         if (mTagView == null || mTagView.getText() == null) {                                            </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 678             return &quot;&quot;;                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 679         } else {                                                                                         </span>
<span class="-3768945108519459655" onmouseenter="enter('-3768945108519459655');" onmouseout="out('-3768945108519459655');" style=""> 680             return mTagView.getText().toString();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 682     }                                                                                                    </span>
<span  style=""> 683                                                                                                          </span>
<span class="4832835199818847464" onmouseenter="enter('4832835199818847464');" onmouseout="out('4832835199818847464');" style=""> 684     private class loadNoteTask extends AsyncTask&lt;String, Void, Void&gt; {                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 685         @Override                                                                                        </span>
<span class="-2143377957271683587" onmouseenter="enter('-2143377957271683587');" onmouseout="out('-2143377957271683587');" style=""> 686         protected void onPreExecute() {                                                                  </span>
<span class="-4476633077483558762" onmouseenter="enter('-4476633077483558762');" onmouseout="out('-4476633077483558762');" style=""> 687             mContentEditText.removeTextChangedListener(NoteEditorFragment.this);                         </span>
<span class="1885380990906425504" onmouseenter="enter('1885380990906425504');" onmouseout="out('1885380990906425504');" style=""> 688             mIsLoadingNote = true;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689         }                                                                                                </span>
<span  style=""> 690                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 691         @Override                                                                                        </span>
<span class="2907103121668961470" onmouseenter="enter('2907103121668961470');" onmouseout="out('2907103121668961470');" style=""> 692         protected Void doInBackground(String... args) {                                                  </span>
<span class="-3170312762343778784" onmouseenter="enter('-3170312762343778784');" onmouseout="out('-3170312762343778784');" style=""> 693             if (getActivity() == null) {                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 694                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 695             }                                                                                            </span>
<span class="-6905640337159350056" onmouseenter="enter('-6905640337159350056');" onmouseout="out('-6905640337159350056');" style=""> 696             String noteID = args[0];                                                                     </span>
<span class="1018174203056851079" onmouseenter="enter('1018174203056851079');" onmouseout="out('1018174203056851079');" style=""> 697             Simplenote application = ((Simplenote) (getActivity().getApplication()));                    </span>
<span class="3820701427545927889" onmouseenter="enter('3820701427545927889');" onmouseout="out('3820701427545927889');" style=""> 698             Bucket&lt;Note&gt; notesBucket = application.getNotesBucket();                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 699             try {                                                                                        </span>
<span class="1900948898960959991" onmouseenter="enter('1900948898960959991');" onmouseout="out('1900948898960959991');" style=""> 700                 mNote = notesBucket.get(noteID);                                                         </span>
<span class="-8094446681246514952" onmouseenter="enter('-8094446681246514952');" onmouseout="out('-8094446681246514952');" style=""> 701                 // Set the current note in NotesActivity when on a tablet                                </span>
<span class="-4385871719572971359" onmouseenter="enter('-4385871719572971359');" onmouseout="out('-4385871719572971359');" style=""> 702                 if (getActivity() instanceof NotesActivity) {                                            </span>
<span class="638470757036078587" onmouseenter="enter('638470757036078587');" onmouseout="out('638470757036078587');" style=""> 703                     ((NotesActivity) (getActivity())).setCurrentNote(mNote);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704                 }                                                                                        </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 705             } catch (BucketObjectMissingException e) {                                                   </span>
<span class="9016552103124647674" onmouseenter="enter('9016552103124647674');" onmouseout="out('9016552103124647674');" style=""> 706                 // TODO: Handle a missing note                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 707             }                                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 708             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 709         }                                                                                                </span>
<span  style=""> 710                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 711         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 712         protected void onPostExecute(Void nada) {                                                        </span>
<span class="8040630259399683176" onmouseenter="enter('8040630259399683176');" onmouseout="out('8040630259399683176');" style=""> 713             if ((getActivity() == null) || getActivity().isFinishing()) {                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 714                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715             }                                                                                            </span>
<span class="-2770512784578238911" onmouseenter="enter('-2770512784578238911');" onmouseout="out('-2770512784578238911');" style=""> 716             refreshContent(false);                                                                       </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 717             if (mMatchOffsets != null) {                                                                 </span>
<span class="4645759725865606036" onmouseenter="enter('4645759725865606036');" onmouseout="out('4645759725865606036');" style=""><abbr title=" 718                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROPERTY);"> 718                 int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.COðŸ”µ</abbr></span>
<span class="1514128940236991067" onmouseenter="enter('1514128940236991067');" onmouseout="out('1514128940236991067');" style=""> 719                 mHighlighter.highlightMatches(mMatchOffsets, columnIndex);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 720             }                                                                                            </span>
<span class="2908988742356344281" onmouseenter="enter('2908988742356344281');" onmouseout="out('2908988742356344281');" style=""> 721             mContentEditText.addTextChangedListener(NoteEditorFragment.this);                            </span>
<span class="-1157968862395621221" onmouseenter="enter('-1157968862395621221');" onmouseout="out('-1157968862395621221');" style=""> 722             if ((mNote != null) &amp;&amp; mNote.getContent().isEmpty()) {                                       </span>
<span class="-7639034409774462373" onmouseenter="enter('-7639034409774462373');" onmouseout="out('-7639034409774462373');" style=""> 723                 // Show soft keyboard                                                                    </span>
<span class="-5568483982770704985" onmouseenter="enter('-5568483982770704985');" onmouseout="out('-5568483982770704985');" style=""> 724                 mContentEditText.requestFocus();                                                         </span>
<span class="7162501222170899627" onmouseenter="enter('7162501222170899627');" onmouseout="out('7162501222170899627');" style=""> 725                 new Handler().postDelayed(new Runnable() {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 726                     @Override                                                                            </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 727                     public void run() {                                                                  </span>
<span class="-3252807025427255436" onmouseenter="enter('-3252807025427255436');" onmouseout="out('-3252807025427255436');" style=""><abbr title=" 728                         InputMethodManager inputMethodManager = ((InputMethodManager) (getActivity().getSystemService(Context.INPUT_METHOD_SERVICE)));"> 728                         InputMethodManager inputMethodManager = ((InputMethodManager) (getActivity().getSðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 729                         if (inputMethodManager != null) {                                                </span>
<span class="7954226653587797662" onmouseenter="enter('7954226653587797662');" onmouseout="out('7954226653587797662');" style=""> 730                             inputMethodManager.showSoftInput(mContentEditText, 0);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 731                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 732                     }                                                                                    </span>
<span class="-4884776244894547305" onmouseenter="enter('-4884776244894547305');" onmouseout="out('-4884776244894547305');" style=""> 733                 }, 100);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 734             }                                                                                            </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 735             SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                   </span>
<span class="2296161227930019578" onmouseenter="enter('2296161227930019578');" onmouseout="out('2296161227930019578');" style=""> 736             mIsLoadingNote = false;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 737         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 738     }                                                                                                    </span>
<span  style=""> 739                                                                                                          </span>
<span class="-8015309924985109245" onmouseenter="enter('-8015309924985109245');" onmouseout="out('-8015309924985109245');" style=""> 740     private class saveNoteTask extends AsyncTask&lt;Void, Void, Void&gt; {                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 741         @Override                                                                                        </span>
<span class="1259374977543247181" onmouseenter="enter('1259374977543247181');" onmouseout="out('1259374977543247181');" style=""> 742         protected Void doInBackground(Void... args) {                                                    </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 743             saveNote();                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 744             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 745         }                                                                                                </span>
<span  style=""> 746                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 747         @Override                                                                                        </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 748         protected void onPostExecute(Void nada) {                                                        </span>
<span class="8985972584985571946" onmouseenter="enter('8985972584985571946');" onmouseout="out('8985972584985571946');" style=""> 749             if ((getActivity() != null) &amp;&amp; (!getActivity().isFinishing())) {                             </span>
<span class="4157206213844518202" onmouseenter="enter('4157206213844518202');" onmouseout="out('4157206213844518202');" style=""> 750                 // Update links                                                                          </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 751                 SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 752             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 753         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754     }                                                                                                    </span>
<span  style=""> 755                                                                                                          </span>
<span class="-2294831155573525866" onmouseenter="enter('-2294831155573525866');" onmouseout="out('-2294831155573525866');" style=""> 756     private void saveNote() {                                                                            </span>
<span class="-6566957513776356959" onmouseenter="enter('-6566957513776356959');" onmouseout="out('-6566957513776356959');" style=""> 757         if (mNote == null) {                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 758             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 759         }                                                                                                </span>
<span  style=""> 760                                                                                                          </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 761         String content = getNoteContentString();                                                         </span>
<span class="-8502490389039341280" onmouseenter="enter('-8502490389039341280');" onmouseout="out('-8502490389039341280');" style=""> 762         String tagString = getNoteTagsString();                                                          </span>
<span class="-8359444972541895470" onmouseenter="enter('-8359444972541895470');" onmouseout="out('-8359444972541895470');" style=""> 763         if (mNote.hasChanges(content, tagString.trim(), mPinButton.isChecked())) {                       </span>
<span class="843504871988910810" onmouseenter="enter('843504871988910810');" onmouseout="out('843504871988910810');" style=""> 764             mNote.setContent(content);                                                                   </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 765             mNote.setTagString(tagString);                                                               </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 766             mNote.setModificationDate(Calendar.getInstance());                                           </span>
<span class="-5430078119462356953" onmouseenter="enter('-5430078119462356953');" onmouseout="out('-5430078119462356953');" style=""> 767             // Send pinned event to google analytics if changed                                          </span>
<span class="-8280425794504398339" onmouseenter="enter('-8280425794504398339');" onmouseout="out('-8280425794504398339');" style=""> 768             mNote.setPinned(mPinButton.isChecked());                                                     </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 769             mNote.save();                                                                                </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 770             if (getActivity() != null) {                                                                 </span>
<span class="9119823558701234173" onmouseenter="enter('9119823558701234173');" onmouseout="out('9119823558701234173');" style=""> 771                 if (mNote.isPinned() != mPinButton.isChecked()) {                                        </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 772                     mTracker.send(                                                                       </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 773                             new HitBuilders.EventBuilder()                                               </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 774                                     .setCategory(&quot;note&quot;)                                                 </span>
<span class="-653095590827548063" onmouseenter="enter('-653095590827548063');" onmouseout="out('-653095590827548063');" style=""><abbr title=" 775                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;)"> 775                                     .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;ðŸ”µ</abbr></span>
<span class="4917363824063796296" onmouseenter="enter('4917363824063796296');" onmouseout="out('4917363824063796296');" style=""> 776                                     .setLabel(&quot;pin_button&quot;)                                              </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 777                                     .build()                                                             </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 778                     );                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 779                 }                                                                                        </span>
<span  style=""> 780                                                                                                          </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 781                 mTracker.send(                                                                           </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 782                         new HitBuilders.EventBuilder()                                                   </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 783                                 .setCategory(&quot;note&quot;)                                                     </span>
<span class="248231167587528808" onmouseenter="enter('248231167587528808');" onmouseout="out('248231167587528808');" style=""> 784                                 .setAction(&quot;edited_note&quot;)                                                </span>
<span class="5457290577030983699" onmouseenter="enter('5457290577030983699');" onmouseout="out('5457290577030983699');" style=""> 785                                 .setLabel(&quot;editor_save&quot;)                                                 </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 786                                 .build()                                                                 </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 787                 );                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 788             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 789         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 790     }                                                                                                    </span>
<span  style=""> 791                                                                                                          </span>
<span class="9084056993766846780" onmouseenter="enter('9084056993766846780');" onmouseout="out('9084056993766846780');" style=""> 792     // Contextual action bar for dealing with links                                                      </span>
<span class="-23103958784499667" onmouseenter="enter('-23103958784499667');" onmouseout="out('-23103958784499667');" style=""> 793     private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {                        </span>
<span class="-5830922032047880245" onmouseenter="enter('-5830922032047880245');" onmouseout="out('-5830922032047880245');" style=""> 794         // Called when the action mode is created; startActionMode() was called                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 795         @Override                                                                                        </span>
<span class="6869646826473679297" onmouseenter="enter('6869646826473679297');" onmouseout="out('6869646826473679297');" style=""> 796         public boolean onCreateActionMode(ActionMode mode, Menu menu) {                                  </span>
<span class="-5328486553851934265" onmouseenter="enter('-5328486553851934265');" onmouseout="out('-5328486553851934265');" style=""> 797             // Inflate a menu resource providing context menu items                                      </span>
<span class="8164139660214751060" onmouseenter="enter('8164139660214751060');" onmouseout="out('8164139660214751060');" style=""> 798             MenuInflater inflater = mode.getMenuInflater();                                              </span>
<span class="-1400051225095864167" onmouseenter="enter('-1400051225095864167');" onmouseout="out('-1400051225095864167');" style=""> 799             if (inflater != null) {                                                                      </span>
<span class="6552624979414277895" onmouseenter="enter('6552624979414277895');" onmouseout="out('6552624979414277895');" style=""> 800                 inflater.inflate(R.menu.view_link, menu);                                                </span>
<span class="2045169504868185532" onmouseenter="enter('2045169504868185532');" onmouseout="out('2045169504868185532');" style=""> 801                 mViewLinkMenuItem = menu.findItem(R.id.menu_view_link);                                  </span>
<span class="4190298810187820509" onmouseenter="enter('4190298810187820509');" onmouseout="out('4190298810187820509');" style=""> 802                 mode.setTitle(getString(R.string.link));                                                 </span>
<span class="9015861346770894985" onmouseenter="enter('9015861346770894985');" onmouseout="out('9015861346770894985');" style=""> 803                 if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {                </span>
<span class="-2927630225150463376" onmouseenter="enter('-2927630225150463376');" onmouseout="out('-2927630225150463376');" style=""> 804                     mode.setTitleOptionalHint(false);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 805                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806             }                                                                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 807             return true;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 808         }                                                                                                </span>
<span  style=""> 809                                                                                                          </span>
<span class="-7885162724385925248" onmouseenter="enter('-7885162724385925248');" onmouseout="out('-7885162724385925248');" style=""> 810         // Called each time the action mode is shown. Always called after onCreateActionMode, but        </span>
<span class="6140331646129020842" onmouseenter="enter('6140331646129020842');" onmouseout="out('6140331646129020842');" style=""> 811         // may be called multiple times if the mode is invalidated.                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 812         @Override                                                                                        </span>
<span class="5392123371105216364" onmouseenter="enter('5392123371105216364');" onmouseout="out('5392123371105216364');" style=""> 813         public boolean onPrepareActionMode(ActionMode mode, Menu menu) {                                 </span>
<span class="7190731887693798693" onmouseenter="enter('7190731887693798693');" onmouseout="out('7190731887693798693');" style=""> 814             return false;// Return false if nothing is done                                              </span>
<span  style=""> 815                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 816         }                                                                                                </span>
<span  style=""> 817                                                                                                          </span>
<span class="-918812678605329556" onmouseenter="enter('-918812678605329556');" onmouseout="out('-918812678605329556');" style=""> 818         // Called when the user selects a contextual menu item                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 819         @Override                                                                                        </span>
<span class="816131742774025467" onmouseenter="enter('816131742774025467');" onmouseout="out('816131742774025467');" style=""> 820         public boolean onActionItemClicked(ActionMode mode, MenuItem item) {                             </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 821             switch (item.getItemId()) {                                                                  </span>
<span class="7972927839947469451" onmouseenter="enter('7972927839947469451');" onmouseout="out('7972927839947469451');" style=""> 822                 case R.id.menu_view_link :                                                               </span>
<span class="2689068574112651560" onmouseenter="enter('2689068574112651560');" onmouseout="out('2689068574112651560');" style=""> 823                     if (mLinkUrl != null) {                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 824                         try {                                                                            </span>
<span class="2961985398395482945" onmouseenter="enter('2961985398395482945');" onmouseout="out('2961985398395482945');" style=""> 825                             Uri uri = Uri.parse(mLinkUrl);                                               </span>
<span class="-3647274578727323622" onmouseenter="enter('-3647274578727323622');" onmouseout="out('-3647274578727323622');" style=""> 826                             Intent i = new Intent(Intent.ACTION_VIEW);                                   </span>
<span class="3545520342926402522" onmouseenter="enter('3545520342926402522');" onmouseout="out('3545520342926402522');" style=""> 827                             i.setData(uri);                                                              </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 828                             startActivity(i);                                                            </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 829                         } catch (java.lang.Exception e) {                                                </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 830                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 831                         }                                                                                </span>
<span class="5555442322990492074" onmouseenter="enter('5555442322990492074');" onmouseout="out('5555442322990492074');" style=""> 832                         // Action picked, so close the CAB                                               </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 833                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 835                     return true;                                                                         </span>
<span class="-4634405621556180819" onmouseenter="enter('-4634405621556180819');" onmouseout="out('-4634405621556180819');" style=""> 836                 case R.id.menu_copy :                                                                    </span>
<span class="-1509454475486936846" onmouseenter="enter('-1509454475486936846');" onmouseout="out('-1509454475486936846');" style=""> 837                     if ((mLinkText != null) &amp;&amp; (getActivity() != null)) {                                </span>
<span class="-8468462420308421995" onmouseenter="enter('-8468462420308421995');" onmouseout="out('-8468462420308421995');" style=""><abbr title=" 838                         ClipboardManager clipboard = ((ClipboardManager) (getActivity().getSystemService(Context.CLIPBOARD_SERVICE)));"> 838                         ClipboardManager clipboard = ((ClipboardManager) (getActivity().getSystemService(ðŸ”µ</abbr></span>
<span class="-877855331677321761" onmouseenter="enter('-877855331677321761');" onmouseout="out('-877855331677321761');" style=""> 839                         ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mLinkText);  </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 840                         clipboard.setPrimaryClip(clip);                                                  </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""><abbr title=" 841                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();"> 841                         Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORTðŸ”µ</abbr></span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 842                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 843                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 844                     return true;                                                                         </span>
<span class="-4929350896823615772" onmouseenter="enter('-4929350896823615772');" onmouseout="out('-4929350896823615772');" style=""> 845                 case R.id.menu_share :                                                                   </span>
<span class="-6928924091126055668" onmouseenter="enter('-6928924091126055668');" onmouseout="out('-6928924091126055668');" style=""> 846                     if (mLinkText != null) {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 847                         try {                                                                            </span>
<span class="2351823289576090125" onmouseenter="enter('2351823289576090125');" onmouseout="out('2351823289576090125');" style=""> 848                             Intent shareIntent = new Intent(Intent.ACTION_SEND);                         </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 849                             shareIntent.setType(&quot;text/plain&quot;);                                           </span>
<span class="-5545338866841663037" onmouseenter="enter('-5545338866841663037');" onmouseout="out('-5545338866841663037');" style=""> 850                             shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mLinkText);          </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 851                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 851                             startActivity(Intent.createChooser(shareIntent, getResources().getString(R.stðŸ”µ</abbr></span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 852                         } catch (java.lang.Exception e) {                                                </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 853                             e.printStackTrace();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 854                         }                                                                                </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 855                         mode.finish();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 856                     }                                                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 857                     return true;                                                                         </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 858                 default :                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 859                     return false;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 860             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 861         }                                                                                                </span>
<span  style=""> 862                                                                                                          </span>
<span class="2525157012953828009" onmouseenter="enter('2525157012953828009');" onmouseout="out('2525157012953828009');" style=""> 863         // Called when the user exits the action mode                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 864         @Override                                                                                        </span>
<span class="-2232977199830239129" onmouseenter="enter('-2232977199830239129');" onmouseout="out('-2232977199830239129');" style=""> 865         public void onDestroyActionMode(ActionMode mode) {                                               </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 866             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 867         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 868     };                                                                                                   </span>
<span  style=""> 869                                                                                                          </span>
<span class="-6769383367293074987" onmouseenter="enter('-6769383367293074987');" onmouseout="out('-6769383367293074987');" style=""> 870     // Checks if cursor is at a URL when the selection changes                                           </span>
<span class="499820509706145242" onmouseenter="enter('499820509706145242');" onmouseout="out('499820509706145242');" style=""> 871     // If it is a URL, show the contextual action bar                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 872     @Override                                                                                            </span>
<span class="-6619706727651867065" onmouseenter="enter('-6619706727651867065');" onmouseout="out('-6619706727651867065');" style=""> 873     public void onSelectionChanged(int selStart, int selEnd) {                                           </span>
<span class="-5773931921061181239" onmouseenter="enter('-5773931921061181239');" onmouseout="out('-5773931921061181239');" style=""> 874         if (selStart == selEnd) {                                                                        </span>
<span class="-1073801886026856185" onmouseenter="enter('-1073801886026856185');" onmouseout="out('-1073801886026856185');" style=""> 875             Editable noteContent = mContentEditText.getText();                                           </span>
<span class="-3728163105261704014" onmouseenter="enter('-3728163105261704014');" onmouseout="out('-3728163105261704014');" style=""> 876             if (noteContent == null) {                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 877                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 878             }                                                                                            </span>
<span class="1258634593958745929" onmouseenter="enter('1258634593958745929');" onmouseout="out('1258634593958745929');" style=""> 879             URLSpan[] urlSpans = noteContent.getSpans(selStart, selStart, URLSpan.class);                </span>
<span class="8265917182779455796" onmouseenter="enter('8265917182779455796');" onmouseout="out('8265917182779455796');" style=""> 880             if (urlSpans.length &gt; 0) {                                                                   </span>
<span class="379938049561077801" onmouseenter="enter('379938049561077801');" onmouseout="out('379938049561077801');" style=""> 881                 URLSpan urlSpan = urlSpans[0];                                                           </span>
<span class="7382553573082356877" onmouseenter="enter('7382553573082356877');" onmouseout="out('7382553573082356877');" style=""> 882                 mLinkUrl = urlSpan.getURL();                                                             </span>
<span class="-2685141031372274993" onmouseenter="enter('-2685141031372274993');" onmouseout="out('-2685141031372274993');" style=""><abbr title=" 883                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSpan)).toString();"> 883                 mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpaðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 884                 if (mActionMode != null) {                                                               </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 885                     mActionMode.setSubtitle(mLinkText);                                                  </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 886                     setLinkMenuItem();                                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 887                     return;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 888                 }                                                                                        </span>
<span class="-4243988111679111503" onmouseenter="enter('-4243988111679111503');" onmouseout="out('-4243988111679111503');" style=""> 889                 // Show the Contextual Action Bar                                                        </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 890                 if (getActivity() != null) {                                                             </span>
<span class="772845792005103046" onmouseenter="enter('772845792005103046');" onmouseout="out('772845792005103046');" style=""><abbr title=" 891                     mActionMode = ((NoteEditorActivity) (getActivity())).startSupportActionMode(mActionModeCallback);"> 891                     mActionMode = ((NoteEditorActivity) (getActivity())).startSupportActionMode(mActionMoðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 892                     if (mActionMode != null) {                                                           </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 893                         mActionMode.setSubtitle(mLinkText);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 894                     }                                                                                    </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 895                     setLinkMenuItem();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 896                 }                                                                                        </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 897             } else if (mActionMode != null) {                                                            </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 898                 mActionMode.finish();                                                                    </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 899                 mActionMode = null;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 900             }                                                                                            </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 901         } else if (mActionMode != null) {                                                                </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 902             mActionMode.finish();                                                                        </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 903             mActionMode = null;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 904         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 905     }                                                                                                    </span>
<span  style=""> 906                                                                                                          </span>
<span class="-1933854749523580289" onmouseenter="enter('-1933854749523580289');" onmouseout="out('-1933854749523580289');" style=""> 907     private void setLinkMenuItem() {                                                                     </span>
<span class="-4542884014549729251" onmouseenter="enter('-4542884014549729251');" onmouseout="out('-4542884014549729251');" style=""> 908         if (mViewLinkMenuItem != null &amp;&amp; mLinkUrl != null) {                                             </span>
<span class="7070835845876331574" onmouseenter="enter('7070835845876331574');" onmouseout="out('7070835845876331574');" style=""> 909             if (mLinkUrl.startsWith(&quot;tel:&quot;)) {                                                           </span>
<span class="4608769072092705594" onmouseenter="enter('4608769072092705594');" onmouseout="out('4608769072092705594');" style=""> 910                 mViewLinkMenuItem.setIcon(mCallIconResId);                                               </span>
<span class="-1045706461125369539" onmouseenter="enter('-1045706461125369539');" onmouseout="out('-1045706461125369539');" style=""> 911                 mViewLinkMenuItem.setTitle(getString(R.string.call));                                    </span>
<span class="-4087102511435152339" onmouseenter="enter('-4087102511435152339');" onmouseout="out('-4087102511435152339');" style=""> 912             } else if (mLinkUrl.startsWith(&quot;mailto:&quot;)) {                                                 </span>
<span class="112818067677115399" onmouseenter="enter('112818067677115399');" onmouseout="out('112818067677115399');" style=""> 913                 mViewLinkMenuItem.setIcon(mEmailIconResId);                                              </span>
<span class="7417350135164215691" onmouseenter="enter('7417350135164215691');" onmouseout="out('7417350135164215691');" style=""> 914                 mViewLinkMenuItem.setTitle(getString(R.string.email));                                   </span>
<span class="-1372170246346381865" onmouseenter="enter('-1372170246346381865');" onmouseout="out('-1372170246346381865');" style=""> 915             } else if (mLinkUrl.startsWith(&quot;geo:&quot;)) {                                                    </span>
<span class="-5464734295170160558" onmouseenter="enter('-5464734295170160558');" onmouseout="out('-5464734295170160558');" style=""> 916                 mViewLinkMenuItem.setIcon(mMapIconResId);                                                </span>
<span class="5018205442899714685" onmouseenter="enter('5018205442899714685');" onmouseout="out('5018205442899714685');" style=""> 917                 mViewLinkMenuItem.setTitle(getString(R.string.view_map));                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 918             } else {                                                                                     </span>
<span class="-4632312324298999235" onmouseenter="enter('-4632312324298999235');" onmouseout="out('-4632312324298999235');" style=""> 919                 mViewLinkMenuItem.setIcon(mWebIconResId);                                                </span>
<span class="4171282647008223100" onmouseenter="enter('4171282647008223100');" onmouseout="out('4171282647008223100');" style=""> 920                 mViewLinkMenuItem.setTitle(getString(R.string.view_in_browser));                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 921             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 922         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 923     }                                                                                                    </span>
<span  style=""> 924                                                                                                          </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 925     // Resets note publish status if Simperium never returned the new publish status                     </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 926     // Resets note publish status if Simperium never returned the new publish status                     </span>
<span class="-7747131454054684363" onmouseenter="enter('-7747131454054684363');" onmouseout="out('-7747131454054684363');" style=""> 927     private Runnable mPublishTimeoutRunnable = new Runnable() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 928         @Override                                                                                        </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 929         public void run() {                                                                              </span>
<span class="6112154992837754036" onmouseenter="enter('6112154992837754036');" onmouseout="out('6112154992837754036');" style=""> 930             if (!isAdded()) return;                                                                      </span>
<span  style=""> 931                                                                                                          </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 932             getActivity().runOnUiThread(new Runnable() {                                                 </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 933                 @Override                                                                                </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 934                 public void run() {                                                                      </span>
<span class="-46541338249551852" onmouseenter="enter('-46541338249551852');" onmouseout="out('-46541338249551852');" style=""> 935                     Toast.makeText(                                                                      </span>
<span class="1251951171853107838" onmouseenter="enter('1251951171853107838');" onmouseout="out('1251951171853107838');" style=""> 936                             getActivity(),                                                               </span>
<span class="112353621179497368" onmouseenter="enter('112353621179497368');" onmouseout="out('112353621179497368');" style=""> 937                             mNote.isPublished() ? R.string.publish_error : R.string.unpublish_error,     </span>
<span class="-5464445565121122409" onmouseenter="enter('-5464445565121122409');" onmouseout="out('-5464445565121122409');" style=""> 938                             Toast.LENGTH_SHORT                                                           </span>
<span class="1929519410657596695" onmouseenter="enter('1929519410657596695');" onmouseout="out('1929519410657596695');" style=""> 939                     ).show();                                                                            </span>
<span  style=""> 940                                                                                                          </span>
<span class="-6752199236124778161" onmouseenter="enter('-6752199236124778161');" onmouseout="out('-6752199236124778161');" style=""> 941                     mNote.setPublished(!mNote.isPublished());                                            </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 942                     mNote.save();                                                                        </span>
<span  style=""> 943                                                                                                          </span>
<span class="-4813280994160595323" onmouseenter="enter('-4813280994160595323');" onmouseout="out('-4813280994160595323');" style=""> 944                     if (mInfoPopupWindow != null &amp;&amp; mInfoPopupWindow.isShowing()) {                      </span>
<span class="-6944825779591395660" onmouseenter="enter('-6944825779591395660');" onmouseout="out('-6944825779591395660');" style=""><abbr title=" 945                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(R.id.publish_view_switcher);"> 945                         ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findVðŸ”µ</abbr></span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 946                         if (viewSwitcher.getDisplayedChild() == 1) {                                     </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 947                             viewSwitcher.showPrevious();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 948                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 949                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 950                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 951             });                                                                                          </span>
<span  style=""> 952                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 953         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 954     };                                                                                                   </span>
<span  style=""> 955                                                                                                          </span>
<span class="1779789763575252159" onmouseenter="enter('1779789763575252159');" onmouseout="out('1779789763575252159');" style=""> 956     private void updateWordCount(TextView textView) {                                                    </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 957         String content = getNoteContentString();                                                         </span>
<span  style=""> 958                                                                                                          </span>
<span class="-1008232604726066894" onmouseenter="enter('-1008232604726066894');" onmouseout="out('-1008232604726066894');" style=""> 959         if (content == null || textView == null) return;                                                 </span>
<span  style=""> 960                                                                                                          </span>
<span class="-1430881109113489374" onmouseenter="enter('-1430881109113489374');" onmouseout="out('-1430881109113489374');" style=""> 961         int numWords = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;     </span>
<span  style=""> 962                                                                                                          </span>
<span class="7366599842051642465" onmouseenter="enter('7366599842051642465');" onmouseout="out('7366599842051642465');" style=""> 963         String wordCountString = getResources().getQuantityString(R.plurals.word_count, numWords);       </span>
<span class="6184855737129992397" onmouseenter="enter('6184855737129992397');" onmouseout="out('6184855737129992397');" style=""> 964         String formattedWordCount = NumberFormat.getInstance().format(numWords);                         </span>
<span  style=""> 965                                                                                                          </span>
<span class="-8359331938088478069" onmouseenter="enter('-8359331938088478069');" onmouseout="out('-8359331938088478069');" style=""> 966         textView.setText(formattedWordCount + &quot; &quot; + wordCountString);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 967     }                                                                                                    </span>
<span  style=""> 968                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 969     /**                                                                                                  </span>
<span class="-1711188639399183775" onmouseenter="enter('-1711188639399183775');" onmouseout="out('-1711188639399183775');" style=""> 970      * Simperium listeners                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 971      */                                                                                                  </span>
<span  style=""> 972                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 973     @Override                                                                                            </span>
<span class="3459602708969445883" onmouseenter="enter('3459602708969445883');" onmouseout="out('3459602708969445883');" style=""> 974     public void onDeleteObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                     </span>
<span  style=""> 975                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 976     }                                                                                                    </span>
<span  style=""> 977                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 978     @Override                                                                                            </span>
<span class="-2970240973750057256" onmouseenter="enter('-2970240973750057256');" onmouseout="out('-2970240973750057256');" style=""><abbr title=" 979     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {"> 979     public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) ðŸ”µ</abbr></span>
<span class="6607037711761945955" onmouseenter="enter('6607037711761945955');" onmouseout="out('6607037711761945955');" style=""> 980         if (changeType == Bucket.ChangeType.MODIFY) {                                                    </span>
<span class="6009154871566676955" onmouseenter="enter('6009154871566676955');" onmouseout="out('6009154871566676955');" style=""> 981             if ((getNote() != null) &amp;&amp; getNote().getSimperiumKey().equals(key)) {                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 982                 try {                                                                                    </span>
<span class="3951885723067312215" onmouseenter="enter('3951885723067312215');" onmouseout="out('3951885723067312215');" style=""> 983                     final Note updatedNote = mNotesBucket.get(key);                                      </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 984                     if (getActivity() != null) {                                                         </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 985                         getActivity().runOnUiThread(new Runnable() {                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 986                             @Override                                                                    </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 987                             public void run() {                                                          </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 988                                 if (mPublishTimeoutHandler != null) {                                    </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 989                                     mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 990                                 }                                                                        </span>
<span class="-8617980127286778731" onmouseenter="enter('-8617980127286778731');" onmouseout="out('-8617980127286778731');" style=""> 991                                 updateNote(updatedNote);                                                 </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 992                                 updateInfoPopup();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 993                             }                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 994                         });                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 995                     }                                                                                    </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 996                 } catch (BucketObjectMissingException e) {                                               </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 997                     e.printStackTrace();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 998                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 999             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1000         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1001     }                                                                                                    </span>
<span  style="">1002                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1003     @Override                                                                                            </span>
<span class="1835476648918604123" onmouseenter="enter('1835476648918604123');" onmouseout="out('1835476648918604123');" style="">1004     public void onSaveObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                       </span>
<span class="-5784091718421357269" onmouseenter="enter('-5784091718421357269');" onmouseout="out('-5784091718421357269');" style="">1005         // noop                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1006     }                                                                                                    </span>
<span  style="">1007                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1008     @Override                                                                                            </span>
<span class="-5956849782971602831" onmouseenter="enter('-5956849782971602831');" onmouseout="out('-5956849782971602831');" style="">1009     public void onBeforeUpdateObject(Bucket&lt;Note&gt; bucket, Note note) {                                   </span>
<span class="9133977848896323437" onmouseenter="enter('9133977848896323437');" onmouseout="out('9133977848896323437');" style="">1010         // Don&#x27;t apply updates if we haven&#x27;t loaded the note yet                                         </span>
<span class="-1541782922582123662" onmouseenter="enter('-1541782922582123662');" onmouseout="out('-1541782922582123662');" style="">1011         if (mIsLoadingNote)                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1012             return;                                                                                      </span>
<span  style="">1013                                                                                                          </span>
<span class="1341660593539808393" onmouseenter="enter('1341660593539808393');" onmouseout="out('1341660593539808393');" style="">1014         Note openNote = getNote();                                                                       </span>
<span class="-6997098079508589023" onmouseenter="enter('-6997098079508589023');" onmouseout="out('-6997098079508589023');" style="">1015         if (openNote == null || !openNote.getSimperiumKey().equals(note.getSimperiumKey()))              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1016             return;                                                                                      </span>
<span  style="">1017                                                                                                          </span>
<span class="4441072062127767636" onmouseenter="enter('4441072062127767636');" onmouseout="out('4441072062127767636');" style="">1018         note.setContent(getNoteContentString());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1019     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1020 }                                                                                                        </span></pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="8328120990598135231" onmouseenter="enter('8328120990598135231');" onmouseout="out('8328120990598135231');" style="">   1  package com.automattic.simplenote;                                                                                </span>
<span  style="">   2                                                                                                                    </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3  import android.app.Activity;                                                                                      </span>
<span class="7622566010320033225" onmouseenter="enter('7622566010320033225');" onmouseout="out('7622566010320033225');" style="">   4  import android.app.Fragment;                                                                                      </span>
<span class="-1500972560159629307" onmouseenter="enter('-1500972560159629307');" onmouseout="out('-1500972560159629307');" style="">   5  import android.content.ClipData;                                                                                  </span>
<span class="-1154037727824652611" onmouseenter="enter('-1154037727824652611');" onmouseout="out('-1154037727824652611');" style="">   6  import android.content.ClipboardManager;                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   7  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   8  import android.content.Intent;                                                                                    </span>
<span class="-840652079464298178" onmouseenter="enter('-840652079464298178');" onmouseout="out('-840652079464298178');" style="">   9  import android.content.res.TypedArray;                                                                            </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  10  import android.database.Cursor;                                                                                   </span>
<span class="1216741051675613788" onmouseenter="enter('1216741051675613788');" onmouseout="out('1216741051675613788');" style="">  11  import android.graphics.drawable.ColorDrawable;                                                                   </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  12  import android.net.Uri;                                                                                           </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  13  import android.os.AsyncTask;                                                                                      </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  14  import android.os.Build;                                                                                          </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  15  import android.os.Bundle;                                                                                         </span>
<span class="-1086316590722027623" onmouseenter="enter('-1086316590722027623');" onmouseout="out('-1086316590722027623');" style="">  16  import android.os.Handler;                                                                                        </span>


<span class="4177373235046048356" onmouseenter="enter('4177373235046048356');" onmouseout="out('4177373235046048356');" style="">  17  import android.text.Editable;                                                                                     </span>
<span class="7731806713123176572" onmouseenter="enter('7731806713123176572');" onmouseout="out('7731806713123176572');" style="">  18  import android.text.Spanned;                                                                                      </span>
<span class="4038639591141008331" onmouseenter="enter('4038639591141008331');" onmouseout="out('4038639591141008331');" style="">  19  import android.text.TextWatcher;                                                                                  </span>
<span class="2374973474356501783" onmouseenter="enter('2374973474356501783');" onmouseout="out('2374973474356501783');" style="">  20  import android.text.style.RelativeSizeSpan;                                                                       </span>
<span class="-1165963660754430642" onmouseenter="enter('-1165963660754430642');" onmouseout="out('-1165963660754430642');" style="">  21  import android.text.style.URLSpan;                                                                                </span>
<span class="-3804250137032727253" onmouseenter="enter('-3804250137032727253');" onmouseout="out('-3804250137032727253');" style="">  22  import android.text.util.Linkify;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import android.util.TypedValue;                                                                                   </span>
<span class="-153541495165582031" onmouseenter="enter('-153541495165582031');" onmouseout="out('-153541495165582031');" style="">  24  import android.view.ActionMode;                                                                                   </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="">  25  import android.view.LayoutInflater;                                                                               </span>
<span class="-603490076395619238" onmouseenter="enter('-603490076395619238');" onmouseout="out('-603490076395619238');" style="">  26  import android.view.Menu;                                                                                         </span>
<span class="-434306062495579804" onmouseenter="enter('-434306062495579804');" onmouseout="out('-434306062495579804');" style="">  27  import android.view.MenuInflater;                                                                                 </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  28  import android.view.MenuItem;                                                                                     </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  29  import android.view.View;                                                                                         </span>
<span class="7569314084591619834" onmouseenter="enter('7569314084591619834');" onmouseout="out('7569314084591619834');" style="">  30  import android.view.ViewGroup;                                                                                    </span>
<span class="-3054355229537475035" onmouseenter="enter('-3054355229537475035');" onmouseout="out('-3054355229537475035');" style="">  31  import android.view.WindowManager;                                                                                </span>
<span class="-3117363671899680167" onmouseenter="enter('-3117363671899680167');" onmouseout="out('-3117363671899680167');" style="">  32  import android.view.inputmethod.InputMethodManager;                                                               </span>
<span class="5634491474902588492" onmouseenter="enter('5634491474902588492');" onmouseout="out('5634491474902588492');" style="">  33  import android.widget.CursorAdapter;                                                                              </span>
<span class="-7136991092569948508" onmouseenter="enter('-7136991092569948508');" onmouseout="out('-7136991092569948508');" style="">  34  import android.widget.ImageButton;                                                                                </span>
<span class="-8478546344938881111" onmouseenter="enter('-8478546344938881111');" onmouseout="out('-8478546344938881111');" style="">  35  import android.widget.ImageView;                                                                                  </span>
<span class="5987800420235491716" onmouseenter="enter('5987800420235491716');" onmouseout="out('5987800420235491716');" style="">  36  import android.widget.LinearLayout;                                                                               </span>
<span class="842268080202249770" onmouseenter="enter('842268080202249770');" onmouseout="out('842268080202249770');" style="">  37  import android.widget.PopupWindow;                                                                                </span>
<span class="-4961528671422147708" onmouseenter="enter('-4961528671422147708');" onmouseout="out('-4961528671422147708');" style="">  38  import android.widget.TextView;                                                                                   </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  39  import android.widget.Toast;                                                                                      </span>
<span class="-1505700250942826116" onmouseenter="enter('-1505700250942826116');" onmouseout="out('-1505700250942826116');" style="">  40  import android.widget.ToggleButton;                                                                               </span>
<span class="737425360271515900" onmouseenter="enter('737425360271515900');" onmouseout="out('737425360271515900');" style="">  41  import android.widget.ViewSwitcher;                                                                               </span>
<span  style="">  42                                                                                                                    </span>
<span class="9061368408436996655" onmouseenter="enter('9061368408436996655');" onmouseout="out('9061368408436996655');" style="">  43  import com.automattic.simplenote.models.Note;                                                                     </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">  44  import com.automattic.simplenote.models.Tag;                                                                      </span>
<span class="-4380838228434146133" onmouseenter="enter('-4380838228434146133');" onmouseout="out('-4380838228434146133');" style="">  45  import com.automattic.simplenote.utils.AutoBullet;                                                                </span>

<span class="1327521140651609704" onmouseenter="enter('1327521140651609704');" onmouseout="out('1327521140651609704');" style="">  46  import com.automattic.simplenote.utils.MatchOffsetHighlighter;                                                    </span>
<span class="-7136497821822559876" onmouseenter="enter('-7136497821822559876');" onmouseout="out('-7136497821822559876');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import com.automattic.simplenote.utils.PrefUtils;                                                                 </span>
<span class="13513923158165555" onmouseenter="enter('13513923158165555');" onmouseout="out('13513923158165555');" style="">  48  import com.automattic.simplenote.utils.SpaceTokenizer;                                                            </span>
<span class="4834384566534786428" onmouseenter="enter('4834384566534786428');" onmouseout="out('4834384566534786428');" style="">  49  import com.automattic.simplenote.widgets.SimplenoteEditText;                                                      </span>
<span class="2537926396801226048" onmouseenter="enter('2537926396801226048');" onmouseout="out('2537926396801226048');" style="">  50  import com.automattic.simplenote.utils.SimplenoteLinkify;                                                         </span>
<span class="-4652171765784917488" onmouseenter="enter('-4652171765784917488');" onmouseout="out('-4652171765784917488');" style="">  51  import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView;                                             </span>
<span class="451633977271230846" onmouseenter="enter('451633977271230846');" onmouseout="out('451633977271230846');" style="">  52  import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView.OnTagAddedListener;                          </span>
<span class="3055903766206676561" onmouseenter="enter('3055903766206676561');" onmouseout="out('3055903766206676561');" style="">  53  import com.automattic.simplenote.utils.TextHighlighter;                                                           </span>
<span class="-454400291627646237" onmouseenter="enter('-454400291627646237');" onmouseout="out('-454400291627646237');" style="">  54  import com.google.android.gms.analytics.HitBuilders;                                                              </span>
<span class="-1389398410172463659" onmouseenter="enter('-1389398410172463659');" onmouseout="out('-1389398410172463659');" style="">  55  import com.google.android.gms.analytics.Tracker;                                                                  </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  56  import com.simperium.client.Bucket;                                                                               </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">  57  import com.simperium.client.BucketObjectMissingException;                                                         </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  58  import com.simperium.client.Query;                                                                                </span>
<span  style="">  59                                                                                                                    </span>
<span class="-76499702739685611" onmouseenter="enter('-76499702739685611');" onmouseout="out('-76499702739685611');" style="">  60  import java.text.NumberFormat;                                                                                    </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  61  import java.util.Calendar;                                                                                        </span>
<span  style="">  62                                                                                                                    </span>
<span class="7280890691619564888" onmouseenter="enter('7280890691619564888');" onmouseout="out('7280890691619564888');" style=""><abbr title="  63  public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListener, View.OnFocusChangeListener, SimplenoteEditText.OnSelectionChangedListener {">  63  public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListenerðŸ”µ</abbr></span>
<span  style="">  64                                                                                                                    </span>
<span class="-4619625032881090052" onmouseenter="enter('-4619625032881090052');" onmouseout="out('-4619625032881090052');" style="">  65      public static final String ARG_ITEM_ID = &quot;item_id&quot;;                                                           </span>
<span class="-7299684920632401552" onmouseenter="enter('-7299684920632401552');" onmouseout="out('-7299684920632401552');" style="">  66      public static final String ARG_NEW_NOTE = &quot;new_note&quot;;                                                         </span>
<span class="7663325037782331899" onmouseenter="enter('7663325037782331899');" onmouseout="out('7663325037782331899');" style="">  67      static public final String ARG_MATCH_OFFSETS = &quot;match_offsets&quot;;                                               </span>
<span class="8491452362607628076" onmouseenter="enter('8491452362607628076');" onmouseout="out('8491452362607628076');" style="">  68      private static final int AUTOSAVE_DELAY_MILLIS = 2000;                                                        </span>
<span  style="">  69                                                                                                                    </span>
<span class="-6846870049312317979" onmouseenter="enter('-6846870049312317979');" onmouseout="out('-6846870049312317979');" style="">  70      private Note mNote;                                                                                           </span>
<span class="-7913886194286774922" onmouseenter="enter('-7913886194286774922');" onmouseout="out('-7913886194286774922');" style="">  71      private Bucket&lt;Note&gt; mNotesBucket;                                                                            </span>
<span  style="">  72                                                                                                                    </span>
<span class="7126484835826685301" onmouseenter="enter('7126484835826685301');" onmouseout="out('7126484835826685301');" style="">  73      private Tracker mTracker;                                                                                     </span>
<span  style="">  74                                                                                                                    </span>
<span class="6580801006778009663" onmouseenter="enter('6580801006778009663');" onmouseout="out('6580801006778009663');" style="">  75      private SimplenoteEditText mContentEditText;                                                                  </span>
<span class="-6964345898478101017" onmouseenter="enter('-6964345898478101017');" onmouseout="out('-6964345898478101017');" style="">  76      private TagsMultiAutoCompleteTextView mTagView;                                                               </span>
<span class="5165556704755836097" onmouseenter="enter('5165556704755836097');" onmouseout="out('5165556704755836097');" style="">  77      private PopupWindow mInfoPopupWindow;                                                                         </span>
<span class="2959047860003936172" onmouseenter="enter('2959047860003936172');" onmouseout="out('2959047860003936172');" style="">  78      private ToggleButton mPinButton;                                                                              </span>
<span class="6494121288462075344" onmouseenter="enter('6494121288462075344');" onmouseout="out('6494121288462075344');" style="">  79      private Handler mAutoSaveHandler;                                                                             </span>
<span class="8783277907965445564" onmouseenter="enter('8783277907965445564');" onmouseout="out('8783277907965445564');" style="">  80      private Handler mPublishTimeoutHandler;                                                                       </span>
<span class="-1776320876088405367" onmouseenter="enter('-1776320876088405367');" onmouseout="out('-1776320876088405367');" style="">  81      private LinearLayout mPlaceholderView;                                                                        </span>
<span class="-5862875858497045082" onmouseenter="enter('-5862875858497045082');" onmouseout="out('-5862875858497045082');" style="">  82      private CursorAdapter mAutocompleteAdapter;                                                                   </span>
<span class="275494556225166536" onmouseenter="enter('275494556225166536');" onmouseout="out('275494556225166536');" style="">  83      private boolean mIsNewNote, mIsLoadingNote;                                                                   </span>
<span class="7307228847460234411" onmouseenter="enter('7307228847460234411');" onmouseout="out('7307228847460234411');" style="">  84      private ActionMode mActionMode;                                                                               </span>
<span class="-1934738222867341331" onmouseenter="enter('-1934738222867341331');" onmouseout="out('-1934738222867341331');" style="">  85      private MenuItem mViewLinkMenuItem;                                                                           </span>
<span class="-3624836155172024592" onmouseenter="enter('-3624836155172024592');" onmouseout="out('-3624836155172024592');" style="">  86      private String mLinkUrl;                                                                                      </span>
<span class="-680149036339568713" onmouseenter="enter('-680149036339568713');" onmouseout="out('-680149036339568713');" style="">  87      private String mLinkText;                                                                                     </span>
<span class="-8355060532383088001" onmouseenter="enter('-8355060532383088001');" onmouseout="out('-8355060532383088001');" style="">  88      private MatchOffsetHighlighter mHighlighter;                                                                  </span>
<span class="-2809999858206249165" onmouseenter="enter('-2809999858206249165');" onmouseout="out('-2809999858206249165');" style="">  89      private int mEmailIconResId, mWebIconResId, mMapIconResId, mCallIconResId;                                    </span>
<span class="-7542236593744276396" onmouseenter="enter('-7542236593744276396');" onmouseout="out('-7542236593744276396');" style="">  90      private MatchOffsetHighlighter.SpanFactory mMatchHighlighter;                                                 </span>
<span class="2689815831275839045" onmouseenter="enter('2689815831275839045');" onmouseout="out('2689815831275839045');" style="">  91      private String mMatchOffsets;                                                                                 </span>
<span class="-7790101837861097441" onmouseenter="enter('-7790101837861097441');" onmouseout="out('-7790101837861097441');" style="">  92      private int mCurrentCursorPosition;                                                                           </span>
<span  style="">  93                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  94      /**                                                                                                           </span>
<span class="7780585517980788373" onmouseenter="enter('7780585517980788373');" onmouseout="out('7780585517980788373');" style="">  95       * Mandatory empty constructor for the fragment manager to instantiate the                                    </span>
<span class="7130060501227883159" onmouseenter="enter('7130060501227883159');" onmouseout="out('7130060501227883159');" style="">  96       * fragment (e.g. upon screen orientation changes).                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97       */                                                                                                           </span>
<span class="2055429757813344166" onmouseenter="enter('2055429757813344166');" onmouseout="out('2055429757813344166');" style="">  98      public NoteEditorFragment() {                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99      }                                                                                                             </span>
<span  style=""> 100                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101      @Override                                                                                                     </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 102      public void onCreate(Bundle savedInstanceState) {                                                             </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 103          super.onCreate(savedInstanceState);                                                                       </span>
<span  style=""> 104                                                                                                                    </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 105          if (getActivity() != null) {                                                                              </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 106              Simplenote currentApp = (Simplenote) getActivity().getApplication();                                  </span>
<span class="3464165486447434608" onmouseenter="enter('3464165486447434608');" onmouseout="out('3464165486447434608');" style=""> 107              mNotesBucket = currentApp.getNotesBucket();                                                           </span>
<span class="8395901407898834802" onmouseenter="enter('8395901407898834802');" onmouseout="out('8395901407898834802');" style=""> 108              mTracker = currentApp.getTracker();                                                                   </span>
<span  style=""> 109                                                                                                                    </span>
<span class="6390134422937918444" onmouseenter="enter('6390134422937918444');" onmouseout="out('6390134422937918444');" style=""><abbr title=" 110              TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionBarIconWeb, R.attr.actionBarIconMap, R.attr.actionBarIconCall});"> 110              TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionðŸ”µ</abbr></span>
<span class="-368005650607593546" onmouseenter="enter('-368005650607593546');" onmouseout="out('-368005650607593546');" style=""> 111              if (a != null) {                                                                                      </span>
<span class="156477903530707073" onmouseenter="enter('156477903530707073');" onmouseout="out('156477903530707073');" style=""> 112                  mEmailIconResId = a.getResourceId(0, 0);                                                          </span>
<span class="2237960387607406884" onmouseenter="enter('2237960387607406884');" onmouseout="out('2237960387607406884');" style=""> 113                  mWebIconResId = a.getResourceId(1, 0);                                                            </span>
<span class="-2587404817224189880" onmouseenter="enter('-2587404817224189880');" onmouseout="out('-2587404817224189880');" style=""> 114                  mMapIconResId = a.getResourceId(2, 0);                                                            </span>
<span class="7397862531502718567" onmouseenter="enter('7397862531502718567');" onmouseout="out('7397862531502718567');" style=""> 115                  mCallIconResId = a.getResourceId(3, 0);                                                           </span>
<span class="7664438635535969272" onmouseenter="enter('7664438635535969272');" onmouseout="out('7664438635535969272');" style=""> 116                  a.recycle();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118          }                                                                                                         </span>
<span  style=""> 119                                                                                                                    </span>
<span class="-7557436274459739944" onmouseenter="enter('-7557436274459739944');" onmouseout="out('-7557436274459739944');" style=""> 120          mAutoSaveHandler = new Handler();                                                                         </span>
<span class="5311700283685025064" onmouseenter="enter('5311700283685025064');" onmouseout="out('5311700283685025064');" style=""> 121          mPublishTimeoutHandler = new Handler();                                                                   </span>
<span  style=""> 122                                                                                                                    </span>
<span class="-8863028397307166255" onmouseenter="enter('-8863028397307166255');" onmouseout="out('-8863028397307166255');" style=""> 123          mMatchHighlighter = new TextHighlighter(getActivity(),                                                    </span>
<span class="5690198221529347900" onmouseenter="enter('5690198221529347900');" onmouseout="out('5690198221529347900');" style=""> 124                  R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor);        </span>
<span class="3992270686517948303" onmouseenter="enter('3992270686517948303');" onmouseout="out('3992270686517948303');" style=""> 125          mAutocompleteAdapter = new CursorAdapter(getActivity(), null, 0x0){                                       </span>
<span  style=""> 126                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127              @Override                                                                                             </span>
<span class="5082230411214880762" onmouseenter="enter('5082230411214880762');" onmouseout="out('5082230411214880762');" style=""> 128              public View newView(Context context, Cursor cursor, ViewGroup parent) {                               </span>
<span class="-7341849400851650995" onmouseenter="enter('-7341849400851650995');" onmouseout="out('-7341849400851650995');" style=""> 129                  Activity activity = (Activity) context;                                                           </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 130                  if (activity == null) return null;                                                                </span>
<span class="-3314008061858345993" onmouseenter="enter('-3314008061858345993');" onmouseout="out('-3314008061858345993');" style=""> 131                  return activity.getLayoutInflater().inflate(R.layout.tag_autocomplete_list_item, null);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132              }                                                                                                     </span>
<span  style=""> 133                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 134              @Override                                                                                             </span>
<span class="19024103499623332" onmouseenter="enter('19024103499623332');" onmouseout="out('19024103499623332');" style=""> 135              public void bindView(View view, Context context, Cursor cursor) {                                     </span>
<span class="1800045997788095368" onmouseenter="enter('1800045997788095368');" onmouseout="out('1800045997788095368');" style=""> 136                  TextView textView = (TextView) view;                                                              </span>
<span class="6731261465219202848" onmouseenter="enter('6731261465219202848');" onmouseout="out('6731261465219202848');" style=""> 137                  textView.setText(convertToString(cursor));                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138              }                                                                                                     </span>
<span  style=""> 139                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 140              @Override                                                                                             </span>
<span class="-1664730445059241307" onmouseenter="enter('-1664730445059241307');" onmouseout="out('-1664730445059241307');" style=""> 141              public CharSequence convertToString(Cursor cursor){                                                   </span>
<span class="-7149458698442797769" onmouseenter="enter('-7149458698442797769');" onmouseout="out('-7149458698442797769');" style=""> 142                  return cursor.getString(cursor.getColumnIndex(Tag.NAME_PROPERTY));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143              }                                                                                                     </span>
<span  style=""> 144                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 145              @Override                                                                                             </span>
<span class="-6792310640715402890" onmouseenter="enter('-6792310640715402890');" onmouseout="out('-6792310640715402890');" style=""> 146              public Cursor runQueryOnBackgroundThread(CharSequence filter) {                                       </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 147                  Activity activity = getActivity();                                                                </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 148                  if (activity == null) return null;                                                                </span>
<span class="9016693485500608067" onmouseenter="enter('9016693485500608067');" onmouseout="out('9016693485500608067');" style=""> 149                  Simplenote application = (Simplenote) activity.getApplication();                                  </span>
<span class="-288329532637656436" onmouseenter="enter('-288329532637656436');" onmouseout="out('-288329532637656436');" style=""> 150                  Query&lt;Tag&gt; query = application.getTagsBucket().query();                                           </span>
<span class="-1263658484466254954" onmouseenter="enter('-1263658484466254954');" onmouseout="out('-1263658484466254954');" style=""> 151                  // make the tag name available to the cursor                                                      </span>
<span class="5748018636045801946" onmouseenter="enter('5748018636045801946');" onmouseout="out('5748018636045801946');" style=""> 152                  query.include(Tag.NAME_PROPERTY);                                                                 </span>
<span class="-7615810455976629564" onmouseenter="enter('-7615810455976629564');" onmouseout="out('-7615810455976629564');" style=""> 153                  // sort the tags by their names                                                                   </span>
<span class="5674220988188306819" onmouseenter="enter('5674220988188306819');" onmouseout="out('5674220988188306819');" style=""> 154                  query.order(Tag.NAME_PROPERTY);                                                                   </span>
<span class="8185275162074884971" onmouseenter="enter('8185275162074884971');" onmouseout="out('8185275162074884971');" style=""> 155                  // if there&#x27;s a filter string find only matching tag names                                        </span>
<span class="-1465062097430607325" onmouseenter="enter('-1465062097430607325');" onmouseout="out('-1465062097430607325');" style=""><abbr title=" 156                  if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%&quot;, filter));"> 156                  if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%ðŸ”µ</abbr></span>
<span class="8392918727668200780" onmouseenter="enter('8392918727668200780');" onmouseout="out('8392918727668200780');" style=""> 157                  return query.execute();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 159          };                                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160      }                                                                                                             </span>
<span  style=""> 161                                                                                                                    </span>
<span  style=""> 162                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 163      @Override                                                                                                     </span>
<span class="-7355940524539913821" onmouseenter="enter('-7355940524539913821');" onmouseout="out('-7355940524539913821');" style=""> 164      public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {           </span>
<span class="7823602444079418117" onmouseenter="enter('7823602444079418117');" onmouseout="out('7823602444079418117');" style=""> 165          setHasOptionsMenu(true);                                                                                  </span>
<span class="6339769591252564933" onmouseenter="enter('6339769591252564933');" onmouseout="out('6339769591252564933');" style=""> 166          View rootView = inflater.inflate(R.layout.fragment_note_editor, container, false);                        </span>
<span class="7145177453793333411" onmouseenter="enter('7145177453793333411');" onmouseout="out('7145177453793333411');" style=""> 167          mContentEditText = ((SimplenoteEditText) rootView.findViewById(R.id.note_content));                       </span>
<span class="-2924083774161461664" onmouseenter="enter('-2924083774161461664');" onmouseout="out('-2924083774161461664');" style=""> 168          mContentEditText.addOnSelectionChangedListener(this);                                                     </span>
<span class="-5685601943521108416" onmouseenter="enter('-5685601943521108416');" onmouseout="out('-5685601943521108416');" style=""> 169          mTagView = (TagsMultiAutoCompleteTextView) rootView.findViewById(R.id.tag_view);                          </span>
<span class="-1710279282572635872" onmouseenter="enter('-1710279282572635872');" onmouseout="out('-1710279282572635872');" style=""> 170          mTagView.setTokenizer(new SpaceTokenizer());                                                              </span>
<span class="-905473657518076069" onmouseenter="enter('-905473657518076069');" onmouseout="out('-905473657518076069');" style=""> 171          mTagView.setOnFocusChangeListener(this);                                                                  </span>
<span  style=""> 172                                                                                                                    </span>
<span class="6080374810605667863" onmouseenter="enter('6080374810605667863');" onmouseout="out('6080374810605667863');" style=""> 173          mHighlighter = new MatchOffsetHighlighter(mMatchHighlighter, mContentEditText);                           </span>
<span  style=""> 174                                                                                                                    </span>
<span class="8838498328861850169" onmouseenter="enter('8838498328861850169');" onmouseout="out('8838498328861850169');" style=""> 175          mPinButton = (ToggleButton) rootView.findViewById(R.id.pinButton);                                        </span>
<span class="-6233419192957625397" onmouseenter="enter('-6233419192957625397');" onmouseout="out('-6233419192957625397');" style=""> 176          mPinButton.setOnClickListener(new View.OnClickListener() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 177              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 178              public void onClick(View v) {                                                                         </span>
<span class="-1510302136918940941" onmouseenter="enter('-1510302136918940941');" onmouseout="out('-1510302136918940941');" style=""> 179                  if (mPinButton.isChecked()) {                                                                     </span>
<span class="-7637598965692605019" onmouseenter="enter('-7637598965692605019');" onmouseout="out('-7637598965692605019');" style=""> 180                      // Friendly message to the user as to what this button does.                                  </span>
<span class="5938443200552047425" onmouseenter="enter('5938443200552047425');" onmouseout="out('5938443200552047425');" style=""> 181                      Toast.makeText(getActivity(), R.string.note_pinned, Toast.LENGTH_SHORT).show();               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 184          });                                                                                                       </span>
<span  style=""> 185                                                                                                                    </span>
<span class="-3806018576171196544" onmouseenter="enter('-3806018576171196544');" onmouseout="out('-3806018576171196544');" style=""> 186          mPlaceholderView = (LinearLayout) rootView.findViewById(R.id.placeholder);                                </span>
<span class="8670904764944796201" onmouseenter="enter('8670904764944796201');" onmouseout="out('8670904764944796201');" style=""><abbr title=" 187          if ((getActivity() instanceof NotesActivity) &amp;&amp; ((NotesActivity) getActivity()).isLargeScreenLandscape() &amp;&amp; mNote == null)"> 187          if ((getActivity() instanceof NotesActivity) &amp;&amp; ((NotesActivity) getActivity()).isLargeScreenLandscape() &amp;ðŸ”µ</abbr></span>

<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 188              mPlaceholderView.setVisibility(View.VISIBLE);                                                         </span>

<span  style=""> 189                                                                                                                    </span>
<span class="-8386469275367064070" onmouseenter="enter('-8386469275367064070');" onmouseout="out('-8386469275367064070');" style=""> 190          mTagView.setAdapter(mAutocompleteAdapter);                                                                </span>
<span  style=""> 191                                                                                                                    </span>
<span class="592168733134676120" onmouseenter="enter('592168733134676120');" onmouseout="out('592168733134676120');" style=""> 192          // Load note if we were passed a note Id                                                                  </span>
<span class="-512438581163180757" onmouseenter="enter('-512438581163180757');" onmouseout="out('-512438581163180757');" style=""> 193          Bundle arguments = getArguments();                                                                        </span>
<span class="5652609996770636291" onmouseenter="enter('5652609996770636291');" onmouseout="out('5652609996770636291');" style=""> 194          if (arguments != null &amp;&amp; arguments.containsKey(ARG_ITEM_ID)) {                                            </span>
<span class="-30854459346766710" onmouseenter="enter('-30854459346766710');" onmouseout="out('-30854459346766710');" style=""> 195              String key = arguments.getString(ARG_ITEM_ID);                                                        </span>
<span class="9138949033848867696" onmouseenter="enter('9138949033848867696');" onmouseout="out('9138949033848867696');" style=""> 196              if (arguments.containsKey(ARG_MATCH_OFFSETS)) {                                                       </span>
<span class="-1831707694683903303" onmouseenter="enter('-1831707694683903303');" onmouseout="out('-1831707694683903303');" style=""> 197                  mMatchOffsets = arguments.getString(ARG_MATCH_OFFSETS);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198              }                                                                                                     </span>
<span class="-3890643464976908836" onmouseenter="enter('-3890643464976908836');" onmouseout="out('-3890643464976908836');" style=""> 199              new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, key);                            </span>
<span class="-4954549700347163589" onmouseenter="enter('-4954549700347163589');" onmouseout="out('-4954549700347163589');" style=""> 200              setIsNewNote(getArguments().getBoolean(ARG_NEW_NOTE, false));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201          }                                                                                                         </span>
<span  style=""> 202                                                                                                                    </span>
<span class="4654908577906893139" onmouseenter="enter('4654908577906893139');" onmouseout="out('4654908577906893139');" style=""> 203  		return rootView;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204  	}                                                                                                                </span>
<span  style=""> 205                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206      @Override                                                                                                     </span>
<span class="3212580988936830895" onmouseenter="enter('3212580988936830895');" onmouseout="out('3212580988936830895');" style=""> 207      public void onResume() {                                                                                      </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 208          super.onResume();                                                                                         </span>
<span class="-295722270474880574" onmouseenter="enter('-295722270474880574');" onmouseout="out('-295722270474880574');" style=""> 209          mNotesBucket.start();                                                                                     </span>
<span class="8320491026461558488" onmouseenter="enter('8320491026461558488');" onmouseout="out('8320491026461558488');" style=""> 210          mNotesBucket.addListener(this);                                                                           </span>
<span  style=""> 211                                                                                                                    </span>
<span class="2283760307260285965" onmouseenter="enter('2283760307260285965');" onmouseout="out('2283760307260285965');" style=""> 212          mTagView.setOnTagAddedListener(this);                                                                     </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +                                                                                                                  </span>
<span class="-8630351771722931094" onmouseenter="enter('-8630351771722931094');" onmouseout="out('-8630351771722931094');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +        if (mContentEditText != null) {                                                                           </span>
<span class="-999020196626820400" onmouseenter="enter('-999020196626820400');" onmouseout="out('-999020196626820400');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 215 +            mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), PrefUtils.PREF_FONT_SIZE, 18));"> 215 +            mContentEditText.setTextSize(TypedValue.COMPLEX_UNIT_SP, PrefUtils.getIntPref(getActivity(), PrefUtilsðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217      }                                                                                                             </span>
<span  style=""> 218                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 219      @Override                                                                                                     </span>
<span class="3108783673391190151" onmouseenter="enter('3108783673391190151');" onmouseout="out('3108783673391190151');" style=""> 220      public void onPause() {                                                                                       </span>
<span class="-1649552973291504175" onmouseenter="enter('-1649552973291504175');" onmouseout="out('-1649552973291504175');" style=""> 221          mNotesBucket.removeListener(this);                                                                        </span>
<span class="-4286062678685908757" onmouseenter="enter('-4286062678685908757');" onmouseout="out('-4286062678685908757');" style=""> 222          // Hide soft keyboard if it is showing...                                                                 </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 223          if (getActivity() != null) {                                                                              </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 224              InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 224              InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 225              if (inputMethodManager != null) {                                                                     </span>
<span class="159022051514418479" onmouseenter="enter('159022051514418479');" onmouseout="out('159022051514418479');" style=""> 226                  inputMethodManager.hideSoftInputFromWindow(mContentEditText.getWindowToken(), 0);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228          }                                                                                                         </span>
<span  style=""> 229                                                                                                                    </span>
<span class="-2832208055092409078" onmouseenter="enter('-2832208055092409078');" onmouseout="out('-2832208055092409078');" style=""> 230          // Delete the note if it is new and has empty fields                                                      </span>
<span class="-2219905285758853631" onmouseenter="enter('-2219905285758853631');" onmouseout="out('-2219905285758853631');" style=""> 231          if (mNote != null &amp;&amp; mIsNewNote &amp;&amp; noteIsEmpty()) {                                                       </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 232              mNote.delete();                                                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 233          } else {                                                                                                  </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 234              saveNote();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235          }                                                                                                         </span>
<span  style=""> 236                                                                                                                    </span>
<span class="-5824468190651999684" onmouseenter="enter('-5824468190651999684');" onmouseout="out('-5824468190651999684');" style=""> 237          mTagView.setOnTagAddedListener(null);                                                                     </span>
<span  style=""> 238                                                                                                                    </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 239          if (mAutoSaveHandler != null) {                                                                           </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 240              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span  style=""> 242                                                                                                                    </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 243          if (mPublishTimeoutHandler != null) {                                                                     </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 244              mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245          }                                                                                                         </span>
<span  style=""> 246                                                                                                                    </span>
<span class="212618759798230270" onmouseenter="enter('212618759798230270');" onmouseout="out('212618759798230270');" style=""> 247          mHighlighter.stop();                                                                                      </span>
<span  style=""> 248                                                                                                                    </span>
<span class="-7508449912261312872" onmouseenter="enter('-7508449912261312872');" onmouseout="out('-7508449912261312872');" style=""> 249          super.onPause();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250      }                                                                                                             </span>
<span  style=""> 251                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 252      @Override                                                                                                     </span>
<span class="-6208734081302594375" onmouseenter="enter('-6208734081302594375');" onmouseout="out('-6208734081302594375');" style=""> 253      public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {                                           </span>
<span class="-5591635883999644357" onmouseenter="enter('-5591635883999644357');" onmouseout="out('-5591635883999644357');" style=""> 254          inflater.inflate(R.menu.note_editor, menu);                                                               </span>
<span  style=""> 255                                                                                                                    </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 256          if (mNote != null) {                                                                                      </span>
<span class="3411369858029698957" onmouseenter="enter('3411369858029698957');" onmouseout="out('3411369858029698957');" style=""> 257              MenuItem viewPublishedNoteItem = menu.findItem(R.id.menu_view_info);                                  </span>
<span class="-2499359923625437976" onmouseenter="enter('-2499359923625437976');" onmouseout="out('-2499359923625437976');" style=""> 258              viewPublishedNoteItem.setVisible(true);                                                               </span>
<span  style=""> 259                                                                                                                    </span>
<span class="7674470390729338414" onmouseenter="enter('7674470390729338414');" onmouseout="out('7674470390729338414');" style=""> 260              MenuItem trashItem = menu.findItem(R.id.menu_delete).setTitle(R.string.undelete);                     </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 261              if (mNote.isDeleted())                                                                                </span>
<span class="2395244797129247894" onmouseenter="enter('2395244797129247894');" onmouseout="out('2395244797129247894');" style=""> 262                  trashItem.setTitle(R.string.undelete);                                                            </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 263              else                                                                                                  </span>
<span class="-2747782095374702281" onmouseenter="enter('-2747782095374702281');" onmouseout="out('-2747782095374702281');" style=""> 264                  trashItem.setTitle(R.string.delete);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265          }                                                                                                         </span>
<span  style=""> 266                                                                                                                    </span>
<span class="5772887857065615623" onmouseenter="enter('5772887857065615623');" onmouseout="out('5772887857065615623');" style=""> 267          super.onCreateOptionsMenu(menu, inflater);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268      }                                                                                                             </span>
<span  style=""> 269                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 270      @Override                                                                                                     </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 271      public boolean onOptionsItemSelected(MenuItem item) {                                                         </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 272          switch (item.getItemId()) {                                                                               </span>
<span class="-3574644309369097250" onmouseenter="enter('-3574644309369097250');" onmouseout="out('-3574644309369097250');" style=""> 273              case R.id.menu_view_info:                                                                             </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 274                  if (mNote != null) {                                                                              </span>
<span class="-5974815457760504487" onmouseenter="enter('-5974815457760504487');" onmouseout="out('-5974815457760504487');" style=""> 275                      View menuItemView = getActivity().findViewById(R.id.menu_view_info);                          </span>
<span class="2497222703395221844" onmouseenter="enter('2497222703395221844');" onmouseout="out('2497222703395221844');" style=""> 276                      showInfoPopup(menuItemView);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277                  }                                                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 278                  return true;                                                                                      </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 279              case R.id.menu_share:                                                                                 </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 280                  if (mNote != null) {                                                                              </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 281                      Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                          </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 282                      shareIntent.setType(&quot;text/plain&quot;);                                                            </span>
<span class="2565640458837084796" onmouseenter="enter('2565640458837084796');" onmouseout="out('2565640458837084796');" style=""> 283                      shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mNote.getContent());                  </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 284                      startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 284                      startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note))ðŸ”µ</abbr></span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 285                      mTracker.send(                                                                                </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 286                              new HitBuilders.EventBuilder()                                                        </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 287                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="2679386718058736721" onmouseenter="enter('2679386718058736721');" onmouseout="out('2679386718058736721');" style=""> 288                              .setAction(&quot;shared_note&quot;)                                                             </span>
<span class="-1410195237862732008" onmouseenter="enter('-1410195237862732008');" onmouseout="out('-1410195237862732008');" style=""> 289                              .setLabel(&quot;action_bar_share_button&quot;)                                                  </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 290                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 291                      );                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292                  }                                                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 293                  return true;                                                                                      </span>
<span class="6443133868746637198" onmouseenter="enter('6443133868746637198');" onmouseout="out('6443133868746637198');" style=""> 294              case R.id.menu_delete:                                                                                </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 295                  if (mNote != null) {                                                                              </span>
<span class="-929724925513034279" onmouseenter="enter('-929724925513034279');" onmouseout="out('-929724925513034279');" style=""> 296                      mNote.setDeleted(!mNote.isDeleted());                                                         </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 297                      mNote.setModificationDate(Calendar.getInstance());                                            </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 298                      mNote.save();                                                                                 </span>
<span class="-8654137458864067059" onmouseenter="enter('-8654137458864067059');" onmouseout="out('-8654137458864067059');" style=""> 299                      Intent resultIntent = new Intent();                                                           </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 300                      if (mNote.isDeleted())                                                                        </span>
<span class="-4555570864561374481" onmouseenter="enter('-4555570864561374481');" onmouseout="out('-4555570864561374481');" style=""> 301                          resultIntent.putExtra(Simplenote.DELETED_NOTE_ID, mNote.getSimperiumKey());               </span>
<span class="2925812847088143790" onmouseenter="enter('2925812847088143790');" onmouseout="out('2925812847088143790');" style=""> 302                      getActivity().setResult(Activity.RESULT_OK, resultIntent);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303                  }                                                                                                 </span>
<span class="2776709281245151825" onmouseenter="enter('2776709281245151825');" onmouseout="out('2776709281245151825');" style=""> 304                  getActivity().finish();                                                                           </span>


<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 305                  return true;                                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 306              case android.R.id.home:                                                                               </span>
<span class="2776709281245151825" onmouseenter="enter('2776709281245151825');" onmouseout="out('2776709281245151825');" style=""> 307                  getActivity().finish();                                                                           </span>

<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 308                  return true;                                                                                      </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 309              default:                                                                                              </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 310                  return super.onOptionsItemSelected(item);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312      }                                                                                                             </span>
<span  style=""> 313                                                                                                                    </span>
<span class="8271468180839847847" onmouseenter="enter('8271468180839847847');" onmouseout="out('8271468180839847847');" style=""> 314      // show a popup view from the info action bar item                                                            </span>
<span class="301694884727727095" onmouseenter="enter('301694884727727095');" onmouseout="out('301694884727727095');" style=""> 315      private void showInfoPopup(View view) {                                                                       </span>
<span class="-8824124309160747557" onmouseenter="enter('-8824124309160747557');" onmouseout="out('-8824124309160747557');" style=""> 316          if (!isAdded() || view == null) return;                                                                   </span>
<span  style=""> 317                                                                                                                    </span>
<span class="-6163322818153177863" onmouseenter="enter('-6163322818153177863');" onmouseout="out('-6163322818153177863');" style=""> 318          if (mInfoPopupWindow == null) {                                                                           </span>
<span class="6416634994496998699" onmouseenter="enter('6416634994496998699');" onmouseout="out('6416634994496998699');" style=""> 319              mInfoPopupWindow = new PopupWindow(getActivity());                                                    </span>
<span class="-7704183450622301834" onmouseenter="enter('-7704183450622301834');" onmouseout="out('-7704183450622301834');" style=""> 320              mInfoPopupWindow.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);                                   </span>
<span class="-3987029803100381492" onmouseenter="enter('-3987029803100381492');" onmouseout="out('-3987029803100381492');" style=""> 321              mInfoPopupWindow.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);                                  </span>
<span class="-8327124619089985465" onmouseenter="enter('-8327124619089985465');" onmouseout="out('-8327124619089985465');" style=""> 322              mInfoPopupWindow.setBackgroundDrawable(new ColorDrawable(0));                                         </span>
<span class="3466073935356821559" onmouseenter="enter('3466073935356821559');" onmouseout="out('3466073935356821559');" style=""> 323              mInfoPopupWindow.setOutsideTouchable(true);                                                           </span>
<span class="-1875471742113799055" onmouseenter="enter('-1875471742113799055');" onmouseout="out('-1875471742113799055');" style=""> 324              mInfoPopupWindow.setFocusable(true);                                                                  </span>
<span  style=""> 325                                                                                                                    </span>
<span class="5212568524712573915" onmouseenter="enter('5212568524712573915');" onmouseout="out('5212568524712573915');" style=""> 326              LayoutInflater inflater = LayoutInflater.from(getActivity());                                         </span>
<span class="-7758049233010801507" onmouseenter="enter('-7758049233010801507');" onmouseout="out('-7758049233010801507');" style=""> 327              View popupView = inflater.inflate(R.layout.popup_info, null);                                         </span>
<span class="536077715701124131" onmouseenter="enter('536077715701124131');" onmouseout="out('536077715701124131');" style=""> 328              mInfoPopupWindow.setContentView(popupView);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329          }                                                                                                         </span>
<span  style=""> 330                                                                                                                    </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 331          updateInfoPopup();                                                                                        </span>
<span  style=""> 332                                                                                                                    </span>
<span class="4487253113225225144" onmouseenter="enter('4487253113225225144');" onmouseout="out('4487253113225225144');" style=""> 333          mInfoPopupWindow.showAsDropDown(view);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334      }                                                                                                             </span>
<span  style=""> 335                                                                                                                    </span>
<span class="-8758077771583595367" onmouseenter="enter('-8758077771583595367');" onmouseout="out('-8758077771583595367');" style=""> 336      // update the content of the popupview                                                                        </span>
<span class="-7181846678873590508" onmouseenter="enter('-7181846678873590508');" onmouseout="out('-7181846678873590508');" style=""> 337      private void updateInfoPopup() {                                                                              </span>
<span class="-8697403400729029020" onmouseenter="enter('-8697403400729029020');" onmouseout="out('-8697403400729029020');" style=""> 338          if (mInfoPopupWindow == null || mInfoPopupWindow.getContentView() == null) return;                        </span>
<span  style=""> 339                                                                                                                    </span>
<span class="3837773520867540996" onmouseenter="enter('3837773520867540996');" onmouseout="out('3837773520867540996');" style=""> 340          View popupView = mInfoPopupWindow.getContentView();                                                       </span>
<span  style=""> 341                                                                                                                    </span>
<span class="-5563348291777194716" onmouseenter="enter('-5563348291777194716');" onmouseout="out('-5563348291777194716');" style=""> 342          View publishButton = popupView.findViewById(R.id.publish_note_button);                                    </span>
<span class="4581310412057978293" onmouseenter="enter('4581310412057978293');" onmouseout="out('4581310412057978293');" style=""> 343          TextView publishButtonTextView = (TextView)popupView.findViewById(R.id.publish_note_button_text);         </span>
<span class="-6410915739065156574" onmouseenter="enter('-6410915739065156574');" onmouseout="out('-6410915739065156574');" style=""> 344          ImageView publishButtonIcon = (ImageView)popupView.findViewById(R.id.publish_note_button_icon);           </span>
<span class="-6918482493044946592" onmouseenter="enter('-6918482493044946592');" onmouseout="out('-6918482493044946592');" style=""> 345          TextView publishTextView = (TextView) popupView.findViewById(R.id.publish_url_textview);                  </span>
<span class="1038347291336054559" onmouseenter="enter('1038347291336054559');" onmouseout="out('1038347291336054559');" style=""> 346          TextView wordCountTextView = (TextView) popupView.findViewById(R.id.word_count);                          </span>
<span class="-7977646551049898553" onmouseenter="enter('-7977646551049898553');" onmouseout="out('-7977646551049898553');" style=""> 347          ImageButton publishCopyButton = (ImageButton) popupView.findViewById(R.id.publish_copy_url);              </span>
<span class="7101383467626352915" onmouseenter="enter('7101383467626352915');" onmouseout="out('7101383467626352915');" style=""> 348          ImageButton publishShareButton = (ImageButton) popupView.findViewById(R.id.publish_share_url);            </span>
<span class="3150325744662714786" onmouseenter="enter('3150325744662714786');" onmouseout="out('3150325744662714786');" style=""> 349          View actionsView = popupView.findViewById(R.id.publish_actions);                                          </span>
<span  style=""> 350                                                                                                                    </span>
<span class="1432622249676412210" onmouseenter="enter('1432622249676412210');" onmouseout="out('1432622249676412210');" style=""> 351          final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcher);      </span>
<span  style=""> 352                                                                                                                    </span>
<span class="-7759606836018483289" onmouseenter="enter('-7759606836018483289');" onmouseout="out('-7759606836018483289');" style=""> 353          publishButton.setOnClickListener(new View.OnClickListener() {                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 354              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 355              public void onClick(View v) {                                                                         </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 356                  if (mNote != null) {                                                                              </span>
<span class="5563864695602119989" onmouseenter="enter('5563864695602119989');" onmouseout="out('5563864695602119989');" style=""> 357                      boolean newPublishedStatus = !mNote.isPublished();                                            </span>
<span class="-3191807331109519265" onmouseenter="enter('-3191807331109519265');" onmouseout="out('-3191807331109519265');" style=""> 358                      mNote.setPublished(newPublishedStatus);                                                       </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 359                      mNote.save();                                                                                 </span>
<span  style=""> 360                                                                                                                    </span>
<span class="-6566894946886815467" onmouseenter="enter('-6566894946886815467');" onmouseout="out('-6566894946886815467');" style=""> 361                      if (viewSwitcher.getDisplayedChild() == 0) {                                                  </span>
<span class="1964540099195163034" onmouseenter="enter('1964540099195163034');" onmouseout="out('1964540099195163034');" style=""> 362                          viewSwitcher.showNext();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363                      }                                                                                             </span>
<span  style=""> 364                                                                                                                    </span>
<span class="3198515589608942377" onmouseenter="enter('3198515589608942377');" onmouseout="out('3198515589608942377');" style=""> 365                      // reset publish status in 20 seconds if we don&#x27;t hear back from Simperium                    </span>
<span class="-4829904289357833951" onmouseenter="enter('-4829904289357833951');" onmouseout="out('-4829904289357833951');" style=""> 366                      mPublishTimeoutHandler.postDelayed(mPublishTimeoutRunnable, 20000);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 369          });                                                                                                       </span>
<span  style=""> 370                                                                                                                    </span>
<span class="4045844893437359317" onmouseenter="enter('4045844893437359317');" onmouseout="out('4045844893437359317');" style=""> 371          publishTextView.setOnClickListener(new View.OnClickListener() {                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 372              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 373              public void onClick(View v) {                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 374                  try {                                                                                             </span>
<span class="-8142976939479350202" onmouseenter="enter('-8142976939479350202');" onmouseout="out('-8142976939479350202');" style=""> 375                      startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(mNote.getPublishedUrl())));            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 376                  } catch (Exception e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 377                      e.printStackTrace();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 380          });                                                                                                       </span>
<span  style=""> 381                                                                                                                    </span>
<span class="-6950650320634084190" onmouseenter="enter('-6950650320634084190');" onmouseout="out('-6950650320634084190');" style=""> 382          publishCopyButton.setOnClickListener(new View.OnClickListener() {                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 383              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 384              public void onClick(View v) {                                                                         </span>
<span class="4796955211675373396" onmouseenter="enter('4796955211675373396');" onmouseout="out('4796955211675373396');" style=""><abbr title=" 385                  ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 385                  ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SðŸ”µ</abbr></span>
<span class="-7278433972965562810" onmouseenter="enter('-7278433972965562810');" onmouseout="out('-7278433972965562810');" style=""> 386                  ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrl());     </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 387                  clipboard.setPrimaryClip(clip);                                                                   </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""> 388                  Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 390          });                                                                                                       </span>
<span  style=""> 391                                                                                                                    </span>
<span class="7858974346508965340" onmouseenter="enter('7858974346508965340');" onmouseout="out('7858974346508965340');" style=""> 392          publishShareButton.setOnClickListener(new View.OnClickListener() {                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 393              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 394              public void onClick(View v) {                                                                         </span>
<span class="-1084258541936962831" onmouseenter="enter('-1084258541936962831');" onmouseout="out('-1084258541936962831');" style=""> 395                  Intent i = new Intent(Intent.ACTION_SEND);                                                        </span>
<span class="-4820203166518762252" onmouseenter="enter('-4820203166518762252');" onmouseout="out('-4820203166518762252');" style=""> 396                  i.setType(&quot;text/plain&quot;);                                                                          </span>
<span class="-6000923337939610903" onmouseenter="enter('-6000923337939610903');" onmouseout="out('-6000923337939610903');" style=""> 397                  i.putExtra(Intent.EXTRA_TEXT, mNote.getPublishedUrl());                                           </span>
<span class="3733331565586339944" onmouseenter="enter('3733331565586339944');" onmouseout="out('3733331565586339944');" style=""> 398                  startActivity(Intent.createChooser(i, getString(R.string.share_url)));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 400          });                                                                                                       </span>
<span  style=""> 401                                                                                                                    </span>
<span class="-2067876314787213528" onmouseenter="enter('-2067876314787213528');" onmouseout="out('-2067876314787213528');" style=""> 402          updateWordCount(wordCountTextView);                                                                       </span>
<span  style=""> 403                                                                                                                    </span>
<span class="-1365615346790030662" onmouseenter="enter('-1365615346790030662');" onmouseout="out('-1365615346790030662');" style=""> 404          if (mNote.isPublished()) {                                                                                </span>
<span class="-8174565940676304202" onmouseenter="enter('-8174565940676304202');" onmouseout="out('-8174565940676304202');" style=""> 405              publishButtonTextView.setText(getString(R.string.published));                                         </span>
<span class="8297531220637406295" onmouseenter="enter('8297531220637406295');" onmouseout="out('8297531220637406295');" style=""> 406              publishButtonIcon.setVisibility(View.VISIBLE);                                                        </span>
<span class="-2988513566372186325" onmouseenter="enter('-2988513566372186325');" onmouseout="out('-2988513566372186325');" style=""> 407              publishTextView.setText(mNote.getPublishedUrl());                                                     </span>
<span class="6413899042811805294" onmouseenter="enter('6413899042811805294');" onmouseout="out('6413899042811805294');" style=""> 408              actionsView.setVisibility(View.VISIBLE);                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 409          } else {                                                                                                  </span>
<span class="843719504642786212" onmouseenter="enter('843719504642786212');" onmouseout="out('843719504642786212');" style=""> 410              publishButtonTextView.setText(getString(R.string.publish));                                           </span>
<span class="-2250731724671553485" onmouseenter="enter('-2250731724671553485');" onmouseout="out('-2250731724671553485');" style=""> 411              publishButtonIcon.setVisibility(View.GONE);                                                           </span>
<span class="1035970444036754268" onmouseenter="enter('1035970444036754268');" onmouseout="out('1035970444036754268');" style=""> 412              actionsView.setVisibility(View.GONE);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413          }                                                                                                         </span>
<span  style=""> 414                                                                                                                    </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 415          Simplenote currentApp = (Simplenote) getActivity().getApplication();                                      </span>
<span class="-1805411858302537149" onmouseenter="enter('-1805411858302537149');" onmouseout="out('-1805411858302537149');" style=""> 416          if (currentApp.getSimperium().needsAuthorization()) {                                                     </span>
<span class="5338357254244494547" onmouseenter="enter('5338357254244494547');" onmouseout="out('5338357254244494547');" style=""> 417              viewSwitcher.setVisibility(View.GONE);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 418          } else {                                                                                                  </span>
<span class="4598892846854382425" onmouseenter="enter('4598892846854382425');" onmouseout="out('4598892846854382425');" style=""> 419              viewSwitcher.setVisibility(View.VISIBLE);                                                             </span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 420              if (viewSwitcher.getDisplayedChild() == 1) {                                                          </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 421                  viewSwitcher.showPrevious();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424      }                                                                                                             </span>
<span  style=""> 425                                                                                                                    </span>
<span class="2878966018694925493" onmouseenter="enter('2878966018694925493');" onmouseout="out('2878966018694925493');" style=""> 426      private boolean noteIsEmpty() {                                                                               </span>
<span class="5142306291108152313" onmouseenter="enter('5142306291108152313');" onmouseout="out('5142306291108152313');" style=""> 427          return (getNoteContentString().trim().length() == 0 &amp;&amp; getNoteTagsString().trim().length() == 0);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428      }                                                                                                             </span>
<span  style=""> 429                                                                                                                    </span>
<span class="8710628914141899315" onmouseenter="enter('8710628914141899315');" onmouseout="out('8710628914141899315');" style=""> 430      public void setNote(String noteID){                                                                           </span>
<span class="-6972394152055286124" onmouseenter="enter('-6972394152055286124');" onmouseout="out('-6972394152055286124');" style=""> 431          setNote(noteID, null);                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432      }                                                                                                             </span>
<span  style=""> 433                                                                                                                    </span>
<span class="8195105300246755684" onmouseenter="enter('8195105300246755684');" onmouseout="out('8195105300246755684');" style=""> 434      public void setNote(String noteID, String matchOffsets) {                                                     </span>
<span class="-3646372507164546123" onmouseenter="enter('-3646372507164546123');" onmouseout="out('-3646372507164546123');" style=""> 435          if (mAutoSaveHandler != null)                                                                             </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 436              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span  style=""> 437                                                                                                                    </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 438          mPlaceholderView.setVisibility(View.GONE);                                                                </span>
<span  style=""> 439                                                                                                                    </span>
<span class="2077738191995360697" onmouseenter="enter('2077738191995360697');" onmouseout="out('2077738191995360697');" style=""> 440          if (matchOffsets != null)                                                                                 </span>
<span class="76822769413740338" onmouseenter="enter('76822769413740338');" onmouseout="out('76822769413740338');" style=""> 441              mMatchOffsets = matchOffsets;                                                                         </span>
<span  style=""> 442                                                                                                                    </span>
<span class="-4019470309104916899" onmouseenter="enter('-4019470309104916899');" onmouseout="out('-4019470309104916899');" style=""> 443          // If we have a note already (on a tablet in landscape), save the note.                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 444          if (mNote != null) {                                                                                      </span>
<span class="4900947620417658692" onmouseenter="enter('4900947620417658692');" onmouseout="out('4900947620417658692');" style=""> 445              if (mIsNewNote &amp;&amp; noteIsEmpty())                                                                      </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 446                  mNote.delete();                                                                                   </span>
<span class="-2440894158330100228" onmouseenter="enter('-2440894158330100228');" onmouseout="out('-2440894158330100228');" style=""> 447              else if (mNote != null)                                                                               </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 448                  saveNote();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449          }                                                                                                         </span>
<span  style=""> 450                                                                                                                    </span>
<span class="-3492920802008394842" onmouseenter="enter('-3492920802008394842');" onmouseout="out('-3492920802008394842');" style=""> 451          new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, noteID);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452      }                                                                                                             </span>
<span  style=""> 453                                                                                                                    </span>
<span class="-3433185850424102984" onmouseenter="enter('-3433185850424102984');" onmouseout="out('-3433185850424102984');" style=""> 454      public void updateNote(Note updatedNote) {                                                                    </span>
<span class="1053945494720623403" onmouseenter="enter('1053945494720623403');" onmouseout="out('1053945494720623403');" style=""> 455          // update note if network change arrived                                                                  </span>
<span class="8715526790189509580" onmouseenter="enter('8715526790189509580');" onmouseout="out('8715526790189509580');" style=""> 456          mNote = updatedNote;                                                                                      </span>
<span class="-1082183570760036139" onmouseenter="enter('-1082183570760036139');" onmouseout="out('-1082183570760036139');" style=""> 457          refreshContent(true);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458      }                                                                                                             </span>
<span  style=""> 459                                                                                                                    </span>
<span class="-5323752859114125708" onmouseenter="enter('-5323752859114125708');" onmouseout="out('-5323752859114125708');" style=""> 460      public void refreshContent(boolean isNoteUpdate) {                                                            </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 461          if (mNote != null) {                                                                                      </span>
<span class="9083634457699551889" onmouseenter="enter('9083634457699551889');" onmouseout="out('9083634457699551889');" style=""> 462              // Restore the cursor position if possible.                                                           </span>
<span  style=""> 463                                                                                                                    </span>
<span class="-3899995221280134201" onmouseenter="enter('-3899995221280134201');" onmouseout="out('-3899995221280134201');" style=""><abbr title=" 464              int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.getSelectionEnd());"> 464              int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.geðŸ”µ</abbr></span>
<span  style=""> 465                                                                                                                    </span>
<span class="4148799213240179760" onmouseenter="enter('4148799213240179760');" onmouseout="out('4148799213240179760');" style=""> 466              mContentEditText.setText(mNote.getContent());                                                         </span>
<span  style=""> 467                                                                                                                    </span>
<span class="2353268123342341866" onmouseenter="enter('2353268123342341866');" onmouseout="out('2353268123342341866');" style=""> 468              if (isNoteUpdate) {                                                                                   </span>
<span class="-1678402685678405938" onmouseenter="enter('-1678402685678405938');" onmouseout="out('-1678402685678405938');" style=""> 469                  // Save the note so any local changes get synced                                                  </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 470                  mNote.save();                                                                                     </span>
<span  style=""> 471                                                                                                                    </span>
<span class="-5094013145931261947" onmouseenter="enter('-5094013145931261947');" onmouseout="out('-5094013145931261947');" style=""> 472                  if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) {        </span>
<span class="2096054726124109686" onmouseenter="enter('2096054726124109686');" onmouseout="out('2096054726124109686');" style=""> 473                      mContentEditText.setSelection(cursorPosition);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 475              }                                                                                                     </span>
<span  style=""> 476                                                                                                                    </span>
<span class="-2853209662220592982" onmouseenter="enter('-2853209662220592982');" onmouseout="out('-2853209662220592982');" style=""> 477              afterTextChanged(mContentEditText.getText());                                                         </span>
<span  style=""> 478                                                                                                                    </span>
<span class="8723833736514346639" onmouseenter="enter('8723833736514346639');" onmouseout="out('8723833736514346639');" style=""> 479              mPinButton.setChecked(mNote.isPinned());                                                              </span>
<span  style=""> 480                                                                                                                    </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 481              updateTagList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 483      }                                                                                                             </span>
<span  style=""> 484                                                                                                                    </span>
<span class="-5496131723873966197" onmouseenter="enter('-5496131723873966197');" onmouseout="out('-5496131723873966197');" style=""> 485      public void updateTagList() {                                                                                 </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 486          Activity activity = getActivity();                                                                        </span>
<span class="5732290278551506292" onmouseenter="enter('5732290278551506292');" onmouseout="out('5732290278551506292');" style=""> 487          if (activity == null) return;                                                                             </span>
<span  style=""> 488                                                                                                                    </span>
<span class="-8748481830530330770" onmouseenter="enter('-8748481830530330770');" onmouseout="out('-8748481830530330770');" style=""> 489          // Populate this note&#x27;s tags in the tagView                                                               </span>
<span class="-3805230291902185366" onmouseenter="enter('-3805230291902185366');" onmouseout="out('-3805230291902185366');" style=""> 490          mTagView.setChips(mNote.getTagString());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491      }                                                                                                             </span>
<span  style=""> 492                                                                                                                    </span>
<span class="-3598917219400102100" onmouseenter="enter('-3598917219400102100');" onmouseout="out('-3598917219400102100');" style=""> 493      int newCursorLocation(String newText, String oldText, int cursorLocation) {                                   </span>
<span class="9215253731107462720" onmouseenter="enter('9215253731107462720');" onmouseout="out('9215253731107462720');" style=""> 494          // Ported from the iOS app :)                                                                             </span>
<span class="746416875920517525" onmouseenter="enter('746416875920517525');" onmouseout="out('746416875920517525');" style=""> 495          // Cases:                                                                                                 </span>
<span class="5532692154938930485" onmouseenter="enter('5532692154938930485');" onmouseout="out('5532692154938930485');" style=""> 496          // 0. All text after cursor (and possibly more) was removed ==&gt; put cursor at end                         </span>
<span class="7679522442911259243" onmouseenter="enter('7679522442911259243');" onmouseout="out('7679522442911259243');" style=""> 497          // 1. Text was added after the cursor ==&gt; no change                                                       </span>
<span class="-7894032746042607578" onmouseenter="enter('-7894032746042607578');" onmouseout="out('-7894032746042607578');" style=""> 498          // 2. Text was added before the cursor ==&gt; location advances                                              </span>
<span class="-2716138352653500367" onmouseenter="enter('-2716138352653500367');" onmouseout="out('-2716138352653500367');" style=""> 499          // 3. Text was removed after the cursor ==&gt; no change                                                     </span>
<span class="-5135222146548415418" onmouseenter="enter('-5135222146548415418');" onmouseout="out('-5135222146548415418');" style=""> 500          // 4. Text was removed before the cursor ==&gt; location retreats                                            </span>
<span class="-7558810491072030947" onmouseenter="enter('-7558810491072030947');" onmouseout="out('-7558810491072030947');" style=""> 501          // 5. Text was added/removed on both sides of the cursor ==&gt; not handled                                  </span>
<span  style=""> 502                                                                                                                    </span>
<span class="2494517364842646163" onmouseenter="enter('2494517364842646163');" onmouseout="out('2494517364842646163');" style=""> 503          int newCursorLocation = cursorLocation;                                                                   </span>
<span  style=""> 504                                                                                                                    </span>
<span class="5908042661332565473" onmouseenter="enter('5908042661332565473');" onmouseout="out('5908042661332565473');" style=""> 505          int deltaLength = newText.length() - oldText.length();                                                    </span>
<span  style=""> 506                                                                                                                    </span>
<span class="-6285488792309831531" onmouseenter="enter('-6285488792309831531');" onmouseout="out('-6285488792309831531');" style=""> 507          // Case 0                                                                                                 </span>
<span class="-3414403190560247865" onmouseenter="enter('-3414403190560247865');" onmouseout="out('-3414403190560247865');" style=""> 508          if (newText.length() &lt; cursorLocation)                                                                    </span>
<span class="-8431314608568195365" onmouseenter="enter('-8431314608568195365');" onmouseout="out('-8431314608568195365');" style=""> 509              return newText.length();                                                                              </span>
<span  style=""> 510                                                                                                                    </span>
<span class="-8591384106259708496" onmouseenter="enter('-8591384106259708496');" onmouseout="out('-8591384106259708496');" style=""> 511          boolean beforeCursorMatches = false;                                                                      </span>
<span class="-2836779116340504068" onmouseenter="enter('-2836779116340504068');" onmouseout="out('-2836779116340504068');" style=""> 512          boolean afterCursorMatches = false;                                                                       </span>
<span  style=""> 513                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 514          try {                                                                                                     </span>
<span class="535177221055952012" onmouseenter="enter('535177221055952012');" onmouseout="out('535177221055952012');" style=""><abbr title=" 515              beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation));"> 515              beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation)ðŸ”µ</abbr></span>
<span class="-6954326744185480821" onmouseenter="enter('-6954326744185480821');" onmouseout="out('-6954326744185480821');" style=""><abbr title=" 516              afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursorLocation + deltaLength, newText.length()));"> 516              afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 517          } catch (Exception e) {                                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 518              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519          }                                                                                                         </span>
<span  style=""> 520                                                                                                                    </span>
<span class="-8188204612528872149" onmouseenter="enter('-8188204612528872149');" onmouseout="out('-8188204612528872149');" style=""> 521          // Cases 2 and 4                                                                                          </span>
<span class="6616414540674367624" onmouseenter="enter('6616414540674367624');" onmouseout="out('6616414540674367624');" style=""> 522          if (!beforeCursorMatches &amp;&amp; afterCursorMatches)                                                           </span>
<span class="-4510977125628343614" onmouseenter="enter('-4510977125628343614');" onmouseout="out('-4510977125628343614');" style=""> 523              newCursorLocation += deltaLength;                                                                     </span>
<span  style=""> 524                                                                                                                    </span>
<span class="6867115481875645839" onmouseenter="enter('6867115481875645839');" onmouseout="out('6867115481875645839');" style=""> 525          // Cases 1, 3 and 5 have no change                                                                        </span>
<span class="-7784410696724573059" onmouseenter="enter('-7784410696724573059');" onmouseout="out('-7784410696724573059');" style=""> 526          return newCursorLocation;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527      }                                                                                                             </span>
<span  style=""> 528                                                                                                                    </span>
<span class="-4880079435078668080" onmouseenter="enter('-4880079435078668080');" onmouseout="out('-4880079435078668080');" style=""> 529      private Runnable mAutoSaveRunnable = new Runnable() {                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 530          @Override                                                                                                 </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 531          public void run() {                                                                                       </span>
<span class="-2186856349666885424" onmouseenter="enter('-2186856349666885424');" onmouseout="out('-2186856349666885424');" style=""> 532              saveAndSyncNote();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 533          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 534      };                                                                                                            </span>
<span  style=""> 535                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 536      @Override                                                                                                     </span>
<span class="-2796122281296135687" onmouseenter="enter('-2796122281296135687');" onmouseout="out('-2796122281296135687');" style=""> 537      public void onTagsChanged(String tagString) {                                                                 </span>
<span class="5357705753761437027" onmouseenter="enter('5357705753761437027');" onmouseout="out('5357705753761437027');" style=""> 538          if (mNote == null || !isAdded()) return;                                                                  </span>
<span  style=""> 539                                                                                                                    </span>
<span class="-6077287130430406243" onmouseenter="enter('-6077287130430406243');" onmouseout="out('-6077287130430406243');" style=""> 540          if (mNote.getTagString() != null &amp;&amp; tagString.length() &gt; mNote.getTagString().length()) {                 </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 541              mTracker.send(                                                                                        </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 542                      new HitBuilders.EventBuilder()                                                                </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 543                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="5410511239462362052" onmouseenter="enter('5410511239462362052');" onmouseout="out('5410511239462362052');" style=""> 544                              .setAction(&quot;added_tag&quot;)                                                               </span>
<span class="-4831158292382506824" onmouseenter="enter('-4831158292382506824');" onmouseout="out('-4831158292382506824');" style=""> 545                              .setLabel(&quot;tag_added_to_note&quot;)                                                        </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 546                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 547              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 548          }                                                                                                         </span>
<span class="4391598042186419731" onmouseenter="enter('4391598042186419731');" onmouseout="out('4391598042186419731');" style=""> 549          else {                                                                                                    </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 550              mTracker.send(                                                                                        </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 551                      new HitBuilders.EventBuilder()                                                                </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 552                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="-1624008121867682947" onmouseenter="enter('-1624008121867682947');" onmouseout="out('-1624008121867682947');" style=""> 553                              .setAction(&quot;removed_tag&quot;)                                                             </span>
<span class="-6979485583008136850" onmouseenter="enter('-6979485583008136850');" onmouseout="out('-6979485583008136850');" style=""> 554                              .setLabel(&quot;tag_removed_from_note&quot;)                                                    </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 555                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 556              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557          }                                                                                                         </span>
<span  style=""> 558                                                                                                                    </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 559          mNote.setTagString(tagString);                                                                            </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 560          mNote.setModificationDate(Calendar.getInstance());                                                        </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 561          updateTagList();                                                                                          </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 562          mNote.save();                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563      }                                                                                                             </span>
<span  style=""> 564                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 565      @Override                                                                                                     </span>
<span class="-5110897291356760413" onmouseenter="enter('-5110897291356760413');" onmouseout="out('-5110897291356760413');" style=""> 566      public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {                             </span>
<span class="7490540504293754116" onmouseenter="enter('7490540504293754116');" onmouseout="out('7490540504293754116');" style=""> 567          // Unused                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568      }                                                                                                             </span>
<span  style=""> 569                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 570      @Override                                                                                                     </span>
<span class="-3169498224421089624" onmouseenter="enter('-3169498224421089624');" onmouseout="out('-3169498224421089624');" style=""> 571      public void afterTextChanged(Editable editable) {                                                             </span>
<span class="7005237563799171506" onmouseenter="enter('7005237563799171506');" onmouseout="out('7005237563799171506');" style=""> 572          setTitleSpan(editable);                                                                                   </span>
<span class="4641646211430236365" onmouseenter="enter('4641646211430236365');" onmouseout="out('4641646211430236365');" style=""> 573          attemptAutoList(editable);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 574      }                                                                                                             </span>
<span  style=""> 575                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 576      @Override                                                                                                     </span>
<span class="-6004971105578563950" onmouseenter="enter('-6004971105578563950');" onmouseout="out('-6004971105578563950');" style=""> 577      public void onTextChanged(CharSequence charSequence, int start, int before, int count) {                      </span>
<span  style=""> 578                                                                                                                    </span>
<span class="2036741165452809133" onmouseenter="enter('2036741165452809133');" onmouseout="out('2036741165452809133');" style=""> 579          // When text changes, start timer that will fire after AUTOSAVE_DELAY_MILLIS passes                       </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 580          if (mAutoSaveHandler != null) {                                                                           </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 581              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span class="3237260668993885548" onmouseenter="enter('3237260668993885548');" onmouseout="out('3237260668993885548');" style=""> 582              mAutoSaveHandler.postDelayed(mAutoSaveRunnable, AUTOSAVE_DELAY_MILLIS);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583          }                                                                                                         </span>
<span  style=""> 584                                                                                                                    </span>
<span class="5409551732025834677" onmouseenter="enter('5409551732025834677');" onmouseout="out('5409551732025834677');" style=""> 585          // Remove search highlight spans when note content changes                                                </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 586          if (mMatchOffsets != null) {                                                                              </span>
<span class="-5254682256162211718" onmouseenter="enter('-5254682256162211718');" onmouseout="out('-5254682256162211718');" style=""> 587              mMatchOffsets = null;                                                                                 </span>
<span class="2930846742809702691" onmouseenter="enter('2930846742809702691');" onmouseout="out('2930846742809702691');" style=""> 588              mHighlighter.removeMatches();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 590      }                                                                                                             </span>
<span  style=""> 591                                                                                                                    </span>
<span class="6849776144692122373" onmouseenter="enter('6849776144692122373');" onmouseout="out('6849776144692122373');" style=""> 592      private void setTitleSpan(Editable editable) {                                                                </span>
<span class="-1378972571136516392" onmouseenter="enter('-1378972571136516392');" onmouseout="out('-1378972571136516392');" style=""> 593          // Set the note title to be a larger size                                                                 </span>
<span class="3997786880116952820" onmouseenter="enter('3997786880116952820');" onmouseout="out('3997786880116952820');" style=""> 594          // Remove any existing size spans                                                                         </span>
<span class="-8972916714996192672" onmouseenter="enter('-8972916714996192672');" onmouseout="out('-8972916714996192672');" style=""> 595          RelativeSizeSpan spans[] = editable.getSpans(0, editable.length(), RelativeSizeSpan.class);               </span>
<span class="2386014209880419735" onmouseenter="enter('2386014209880419735');" onmouseout="out('2386014209880419735');" style=""> 596          for (RelativeSizeSpan span : spans) {                                                                     </span>
<span class="-4538099325482792099" onmouseenter="enter('-4538099325482792099');" onmouseout="out('-4538099325482792099');" style=""> 597              editable.removeSpan(span);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598          }                                                                                                         </span>
<span class="-901734861574280266" onmouseenter="enter('-901734861574280266');" onmouseout="out('-901734861574280266');" style=""> 599          int newLinePosition = getNoteContentString().indexOf(&quot;\n&quot;);                                               </span>
<span class="-2560738681101946885" onmouseenter="enter('-2560738681101946885');" onmouseout="out('-2560738681101946885');" style=""> 600          if (newLinePosition == 0)                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 601              return;                                                                                               </span>
<span class="3283000540261653525" onmouseenter="enter('3283000540261653525');" onmouseout="out('3283000540261653525');" style=""><abbr title=" 602          editable.setSpan(new RelativeSizeSpan(1.222f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 602          editable.setSpan(new RelativeSizeSpan(1.222f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.lengtðŸ”µ</abbr></span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 603      }                                                                                                             </span>
<span  style=""> 604                                                                                                                    </span>
<span class="8395667075038215241" onmouseenter="enter('8395667075038215241');" onmouseout="out('8395667075038215241');" style=""> 605      private void attemptAutoList(Editable editable) {                                                             </span>
<span class="1630313539519665774" onmouseenter="enter('1630313539519665774');" onmouseout="out('1630313539519665774');" style=""> 606          int oldCursorPosition = mCurrentCursorPosition;                                                           </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 607          mCurrentCursorPosition = mContentEditText.getSelectionStart();                                            </span>
<span class="-1456162723219098064" onmouseenter="enter('-1456162723219098064');" onmouseout="out('-1456162723219098064');" style=""> 608          AutoBullet.apply(editable, oldCursorPosition, mCurrentCursorPosition);                                    </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 609          mCurrentCursorPosition = mContentEditText.getSelectionStart();                                            </span>
<span class="6723912502491086435" onmouseenter="enter('6723912502491086435');" onmouseout="out('6723912502491086435');" style=""> 610          android.util.Log.d(&quot;Simplenote&quot;, &quot;==&gt; post cursor position:&quot; + mCurrentCursorPosition);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 611      }                                                                                                             </span>
<span  style=""> 612                                                                                                                    </span>
<span class="-6933317077070028336" onmouseenter="enter('-6933317077070028336');" onmouseout="out('-6933317077070028336');" style=""> 613      private void saveAndSyncNote() {                                                                              </span>
<span class="8223376420483055518" onmouseenter="enter('8223376420483055518');" onmouseout="out('8223376420483055518');" style=""> 614          if (mNote == null)                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 615              return;                                                                                               </span>
<span  style=""> 616                                                                                                                    </span>
<span class="5987107161692050970" onmouseenter="enter('5987107161692050970');" onmouseout="out('5987107161692050970');" style=""> 617          new saveNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 618      }                                                                                                             </span>
<span  style=""> 619                                                                                                                    </span>
<span class="-4564004023547017377" onmouseenter="enter('-4564004023547017377');" onmouseout="out('-4564004023547017377');" style=""> 620      public void setPlaceholderVisible(boolean isVisible) {                                                        </span>
<span class="-6467031518050872536" onmouseenter="enter('-6467031518050872536');" onmouseout="out('-6467031518050872536');" style=""> 621          if (isVisible) {                                                                                          </span>
<span class="1687907534970456445" onmouseenter="enter('1687907534970456445');" onmouseout="out('1687907534970456445');" style=""> 622              mNote = null;                                                                                         </span>
<span class="-3407359796970873837" onmouseenter="enter('-3407359796970873837');" onmouseout="out('-3407359796970873837');" style=""> 623              mContentEditText.setText(&quot;&quot;);                                                                         </span>
<span class="-7997465605671669559" onmouseenter="enter('-7997465605671669559');" onmouseout="out('-7997465605671669559');" style=""> 624              mTagView.setText(&quot;&quot;);                                                                                 </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 625              if (mPlaceholderView != null)                                                                         </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 626                  mPlaceholderView.setVisibility(View.VISIBLE);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 627          } else {                                                                                                  </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 628              if (mPlaceholderView != null)                                                                         </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 629                  mPlaceholderView.setVisibility(View.GONE);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 630          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 631      }                                                                                                             </span>
<span  style=""> 632                                                                                                                    </span>
<span class="7106522413253020021" onmouseenter="enter('7106522413253020021');" onmouseout="out('7106522413253020021');" style=""> 633      public void setIsNewNote(boolean isNewNote) {                                                                 </span>
<span class="-5949421386499580587" onmouseenter="enter('-5949421386499580587');" onmouseout="out('-5949421386499580587');" style=""> 634          this.mIsNewNote = isNewNote;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 635      }                                                                                                             </span>
<span  style=""> 636                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 637      @Override                                                                                                     </span>
<span class="-3315120631467309087" onmouseenter="enter('-3315120631467309087');" onmouseout="out('-3315120631467309087');" style=""> 638      public void onFocusChange(View v, boolean hasFocus) {                                                         </span>
<span class="-6285712256166584728" onmouseenter="enter('-6285712256166584728');" onmouseout="out('-6285712256166584728');" style=""> 639          if (!hasFocus) {                                                                                          </span>
<span class="-6666174322440118634" onmouseenter="enter('-6666174322440118634');" onmouseout="out('-6666174322440118634');" style=""> 640              String tagString = getNoteTagsString().trim();                                                        </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 641              if (tagString.length() &gt; 0) {                                                                         </span>
<span class="8488340728323435918" onmouseenter="enter('8488340728323435918');" onmouseout="out('8488340728323435918');" style=""> 642                  mTagView.setChips(tagString);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 643              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 645      }                                                                                                             </span>
<span  style=""> 646                                                                                                                    </span>
<span class="-6849832043716883515" onmouseenter="enter('-6849832043716883515');" onmouseout="out('-6849832043716883515');" style=""> 647      public Note getNote() {                                                                                       </span>
<span class="6687317620803594982" onmouseenter="enter('6687317620803594982');" onmouseout="out('6687317620803594982');" style=""> 648          return mNote;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649      }                                                                                                             </span>
<span  style=""> 650                                                                                                                    </span>
<span class="5855058962481175207" onmouseenter="enter('5855058962481175207');" onmouseout="out('5855058962481175207');" style=""> 651      public String getNoteContentString() {                                                                        </span>
<span class="-8451380960236704581" onmouseenter="enter('-8451380960236704581');" onmouseout="out('-8451380960236704581');" style=""> 652          if (mContentEditText == null || mContentEditText.getText() == null) {                                     </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 653              return &quot;&quot;;                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 654          } else {                                                                                                  </span>
<span class="9069870454824528783" onmouseenter="enter('9069870454824528783');" onmouseout="out('9069870454824528783');" style=""> 655              return mContentEditText.getText().toString();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 656          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 657      }                                                                                                             </span>
<span  style=""> 658                                                                                                                    </span>
<span class="2486113532203564324" onmouseenter="enter('2486113532203564324');" onmouseout="out('2486113532203564324');" style=""> 659      public String getNoteTagsString() {                                                                           </span>
<span class="2201751553125502793" onmouseenter="enter('2201751553125502793');" onmouseout="out('2201751553125502793');" style=""> 660          if (mTagView == null || mTagView.getText() == null) {                                                     </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 661              return &quot;&quot;;                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 662          } else {                                                                                                  </span>
<span class="-3768945108519459655" onmouseenter="enter('-3768945108519459655');" onmouseout="out('-3768945108519459655');" style=""> 663              return mTagView.getText().toString();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 664          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 665      }                                                                                                             </span>
<span  style=""> 666                                                                                                                    </span>
<span class="4832835199818847464" onmouseenter="enter('4832835199818847464');" onmouseout="out('4832835199818847464');" style=""> 667      private class loadNoteTask extends AsyncTask&lt;String, Void, Void&gt; {                                            </span>
<span  style=""> 668                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 669          @Override                                                                                                 </span>
<span class="-2143377957271683587" onmouseenter="enter('-2143377957271683587');" onmouseout="out('-2143377957271683587');" style=""> 670          protected void onPreExecute() {                                                                           </span>
<span class="-4476633077483558762" onmouseenter="enter('-4476633077483558762');" onmouseout="out('-4476633077483558762');" style=""> 671              mContentEditText.removeTextChangedListener(NoteEditorFragment.this);                                  </span>
<span class="1885380990906425504" onmouseenter="enter('1885380990906425504');" onmouseout="out('1885380990906425504');" style=""> 672              mIsLoadingNote = true;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 673          }                                                                                                         </span>
<span  style=""> 674                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 675          @Override                                                                                                 </span>
<span class="2907103121668961470" onmouseenter="enter('2907103121668961470');" onmouseout="out('2907103121668961470');" style=""> 676          protected Void doInBackground(String... args) {                                                           </span>
<span class="-3170312762343778784" onmouseenter="enter('-3170312762343778784');" onmouseout="out('-3170312762343778784');" style=""> 677              if (getActivity() == null) {                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 678                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 679              }                                                                                                     </span>
<span  style=""> 680                                                                                                                    </span>
<span class="-6905640337159350056" onmouseenter="enter('-6905640337159350056');" onmouseout="out('-6905640337159350056');" style=""> 681              String noteID = args[0];                                                                              </span>
<span class="5105206001451632901" onmouseenter="enter('5105206001451632901');" onmouseout="out('5105206001451632901');" style=""> 682              Simplenote application = (Simplenote) getActivity().getApplication();                                 </span>
<span class="3820701427545927889" onmouseenter="enter('3820701427545927889');" onmouseout="out('3820701427545927889');" style=""> 683              Bucket&lt;Note&gt; notesBucket = application.getNotesBucket();                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 684              try {                                                                                                 </span>
<span class="1900948898960959991" onmouseenter="enter('1900948898960959991');" onmouseout="out('1900948898960959991');" style=""> 685                  mNote = notesBucket.get(noteID);                                                                  </span>
<span class="-8094446681246514952" onmouseenter="enter('-8094446681246514952');" onmouseout="out('-8094446681246514952');" style=""> 686                  // Set the current note in NotesActivity when on a tablet                                         </span>
<span class="-4385871719572971359" onmouseenter="enter('-4385871719572971359');" onmouseout="out('-4385871719572971359');" style=""> 687                  if (getActivity() instanceof NotesActivity) {                                                     </span>
<span class="-5437998525889410543" onmouseenter="enter('-5437998525889410543');" onmouseout="out('-5437998525889410543');" style=""> 688                      ((NotesActivity) getActivity()).setCurrentNote(mNote);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 689                  }                                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 690              } catch (BucketObjectMissingException e) {                                                            </span>
<span class="9016552103124647674" onmouseenter="enter('9016552103124647674');" onmouseout="out('9016552103124647674');" style=""> 691                  // TODO: Handle a missing note                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692              }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 693              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694          }                                                                                                         </span>
<span  style=""> 695                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 696          @Override                                                                                                 </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 697          protected void onPostExecute(Void nada) {                                                                 </span>
<span class="3019142402664254149" onmouseenter="enter('3019142402664254149');" onmouseout="out('3019142402664254149');" style=""> 698              if (getActivity() == null || getActivity().isFinishing())                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 699                  return;                                                                                           </span>
<span class="-2770512784578238911" onmouseenter="enter('-2770512784578238911');" onmouseout="out('-2770512784578238911');" style=""> 700              refreshContent(false);                                                                                </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 701              if (mMatchOffsets != null) {                                                                          </span>
<span class="4645759725865606036" onmouseenter="enter('4645759725865606036');" onmouseout="out('4645759725865606036');" style=""><abbr title=" 702                  int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROPERTY);"> 702                  int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROðŸ”µ</abbr></span>
<span class="1514128940236991067" onmouseenter="enter('1514128940236991067');" onmouseout="out('1514128940236991067');" style=""> 703                  mHighlighter.highlightMatches(mMatchOffsets, columnIndex);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704              }                                                                                                     </span>
<span class="2908988742356344281" onmouseenter="enter('2908988742356344281');" onmouseout="out('2908988742356344281');" style=""> 705              mContentEditText.addTextChangedListener(NoteEditorFragment.this);                                     </span>
<span class="1726616917938037339" onmouseenter="enter('1726616917938037339');" onmouseout="out('1726616917938037339');" style=""> 706              if (mNote != null &amp;&amp; mNote.getContent().isEmpty()) {                                                  </span>
<span class="-7639034409774462373" onmouseenter="enter('-7639034409774462373');" onmouseout="out('-7639034409774462373');" style=""> 707                  // Show soft keyboard                                                                             </span>
<span class="-5568483982770704985" onmouseenter="enter('-5568483982770704985');" onmouseout="out('-5568483982770704985');" style=""> 708                  mContentEditText.requestFocus();                                                                  </span>
<span class="7162501222170899627" onmouseenter="enter('7162501222170899627');" onmouseout="out('7162501222170899627');" style=""> 709                  new Handler().postDelayed(new Runnable() {                                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 710                      @Override                                                                                     </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 711                      public void run() {                                                                           </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 712                          InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 712                          InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemServicðŸ”µ</abbr></span>
<span class="-1476760297763804327" onmouseenter="enter('-1476760297763804327');" onmouseout="out('-1476760297763804327');" style=""> 713                          if (inputMethodManager != null)                                                           </span>
<span class="7954226653587797662" onmouseenter="enter('7954226653587797662');" onmouseout="out('7954226653587797662');" style=""> 714                              inputMethodManager.showSoftInput(mContentEditText, 0);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 715                      }                                                                                             </span>
<span class="-4884776244894547305" onmouseenter="enter('-4884776244894547305');" onmouseout="out('-4884776244894547305');" style=""> 716                  }, 100);                                                                                          </span>
<span  style=""> 717                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 718              }                                                                                                     </span>
<span  style=""> 719                                                                                                                    </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 720              SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                            </span>
<span  style=""> 721                                                                                                                    </span>
<span class="2296161227930019578" onmouseenter="enter('2296161227930019578');" onmouseout="out('2296161227930019578');" style=""> 722              mIsLoadingNote = false;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 723          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724      }                                                                                                             </span>
<span  style=""> 725                                                                                                                    </span>
<span class="-8015309924985109245" onmouseenter="enter('-8015309924985109245');" onmouseout="out('-8015309924985109245');" style=""> 726      private class saveNoteTask extends AsyncTask&lt;Void, Void, Void&gt; {                                              </span>
<span  style=""> 727                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 728          @Override                                                                                                 </span>
<span class="1259374977543247181" onmouseenter="enter('1259374977543247181');" onmouseout="out('1259374977543247181');" style=""> 729          protected Void doInBackground(Void... args) {                                                             </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 730              saveNote();                                                                                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 731              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 732          }                                                                                                         </span>
<span  style=""> 733                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 734          @Override                                                                                                 </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 735          protected void onPostExecute(Void nada) {                                                                 </span>
<span class="-8878355580113381449" onmouseenter="enter('-8878355580113381449');" onmouseout="out('-8878355580113381449');" style=""> 736              if (getActivity() != null &amp;&amp; !getActivity().isFinishing()) {                                          </span>
<span class="4157206213844518202" onmouseenter="enter('4157206213844518202');" onmouseout="out('4157206213844518202');" style=""> 737                  // Update links                                                                                   </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 738                  SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 740          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 741      }                                                                                                             </span>
<span  style=""> 742                                                                                                                    </span>
<span class="-2294831155573525866" onmouseenter="enter('-2294831155573525866');" onmouseout="out('-2294831155573525866');" style=""> 743      private void saveNote() {                                                                                     </span>
<span class="-6566957513776356959" onmouseenter="enter('-6566957513776356959');" onmouseout="out('-6566957513776356959');" style=""> 744          if (mNote == null) {                                                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 745              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 746          }                                                                                                         </span>
<span  style=""> 747                                                                                                                    </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 748          String content = getNoteContentString();                                                                  </span>
<span class="-8502490389039341280" onmouseenter="enter('-8502490389039341280');" onmouseout="out('-8502490389039341280');" style=""> 749          String tagString = getNoteTagsString();                                                                   </span>
<span class="-8359444972541895470" onmouseenter="enter('-8359444972541895470');" onmouseout="out('-8359444972541895470');" style=""> 750          if (mNote.hasChanges(content, tagString.trim(), mPinButton.isChecked())) {                                </span>
<span class="843504871988910810" onmouseenter="enter('843504871988910810');" onmouseout="out('843504871988910810');" style=""> 751              mNote.setContent(content);                                                                            </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 752              mNote.setTagString(tagString);                                                                        </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 753              mNote.setModificationDate(Calendar.getInstance());                                                    </span>
<span class="-5430078119462356953" onmouseenter="enter('-5430078119462356953');" onmouseout="out('-5430078119462356953');" style=""> 754              // Send pinned event to google analytics if changed                                                   </span>
<span class="-8280425794504398339" onmouseenter="enter('-8280425794504398339');" onmouseout="out('-8280425794504398339');" style=""> 755              mNote.setPinned(mPinButton.isChecked());                                                              </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 756              mNote.save();                                                                                         </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 757              if (getActivity() != null) {                                                                          </span>
<span class="9119823558701234173" onmouseenter="enter('9119823558701234173');" onmouseout="out('9119823558701234173');" style=""> 758                  if (mNote.isPinned() != mPinButton.isChecked()) {                                                 </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 759                      mTracker.send(                                                                                </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 760                              new HitBuilders.EventBuilder()                                                        </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 761                                      .setCategory(&quot;note&quot;)                                                          </span>
<span class="-653095590827548063" onmouseenter="enter('-653095590827548063');" onmouseout="out('-653095590827548063');" style=""> 762                                      .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;)        </span>
<span class="4917363824063796296" onmouseenter="enter('4917363824063796296');" onmouseout="out('4917363824063796296');" style=""> 763                                      .setLabel(&quot;pin_button&quot;)                                                       </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 764                                      .build()                                                                      </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 765                      );                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 766                  }                                                                                                 </span>
<span  style=""> 767                                                                                                                    </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 768                  mTracker.send(                                                                                    </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 769                          new HitBuilders.EventBuilder()                                                            </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 770                                  .setCategory(&quot;note&quot;)                                                              </span>
<span class="248231167587528808" onmouseenter="enter('248231167587528808');" onmouseout="out('248231167587528808');" style=""> 771                                  .setAction(&quot;edited_note&quot;)                                                         </span>
<span class="5457290577030983699" onmouseenter="enter('5457290577030983699');" onmouseout="out('5457290577030983699');" style=""> 772                                  .setLabel(&quot;editor_save&quot;)                                                          </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 773                                  .build()                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 774                  );                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 775              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 776          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 777      }                                                                                                             </span>
<span  style=""> 778                                                                                                                    </span>
<span class="9084056993766846780" onmouseenter="enter('9084056993766846780');" onmouseout="out('9084056993766846780');" style=""> 779      // Contextual action bar for dealing with links                                                               </span>
<span class="-23103958784499667" onmouseenter="enter('-23103958784499667');" onmouseout="out('-23103958784499667');" style=""> 780      private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {                                 </span>
<span  style=""> 781                                                                                                                    </span>
<span class="-5830922032047880245" onmouseenter="enter('-5830922032047880245');" onmouseout="out('-5830922032047880245');" style=""> 782          // Called when the action mode is created; startActionMode() was called                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 783          @Override                                                                                                 </span>
<span class="6869646826473679297" onmouseenter="enter('6869646826473679297');" onmouseout="out('6869646826473679297');" style=""> 784          public boolean onCreateActionMode(ActionMode mode, Menu menu) {                                           </span>
<span class="-5328486553851934265" onmouseenter="enter('-5328486553851934265');" onmouseout="out('-5328486553851934265');" style=""> 785              // Inflate a menu resource providing context menu items                                               </span>
<span class="8164139660214751060" onmouseenter="enter('8164139660214751060');" onmouseout="out('8164139660214751060');" style=""> 786              MenuInflater inflater = mode.getMenuInflater();                                                       </span>
<span class="-5537764272582475285" onmouseenter="enter('-5537764272582475285');" onmouseout="out('-5537764272582475285');" style=""> 787              if (inflater != null){                                                                                </span>
<span class="6552624979414277895" onmouseenter="enter('6552624979414277895');" onmouseout="out('6552624979414277895');" style=""> 788                  inflater.inflate(R.menu.view_link, menu);                                                         </span>
<span class="2045169504868185532" onmouseenter="enter('2045169504868185532');" onmouseout="out('2045169504868185532');" style=""> 789                  mViewLinkMenuItem = menu.findItem(R.id.menu_view_link);                                           </span>
<span class="4190298810187820509" onmouseenter="enter('4190298810187820509');" onmouseout="out('4190298810187820509');" style=""> 790                  mode.setTitle(getString(R.string.link));                                                          </span>
<span class="9015861346770894985" onmouseenter="enter('9015861346770894985');" onmouseout="out('9015861346770894985');" style=""> 791                  if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {                         </span>
<span class="-2927630225150463376" onmouseenter="enter('-2927630225150463376');" onmouseout="out('-2927630225150463376');" style=""> 792                      mode.setTitleOptionalHint(false);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 793                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 794              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 795              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 796          }                                                                                                         </span>
<span  style=""> 797                                                                                                                    </span>
<span class="-7885162724385925248" onmouseenter="enter('-7885162724385925248');" onmouseout="out('-7885162724385925248');" style=""> 798          // Called each time the action mode is shown. Always called after onCreateActionMode, but                 </span>
<span class="6140331646129020842" onmouseenter="enter('6140331646129020842');" onmouseout="out('6140331646129020842');" style=""> 799          // may be called multiple times if the mode is invalidated.                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 800          @Override                                                                                                 </span>
<span class="5392123371105216364" onmouseenter="enter('5392123371105216364');" onmouseout="out('5392123371105216364');" style=""> 801          public boolean onPrepareActionMode(ActionMode mode, Menu menu) {                                          </span>
<span class="9220029862843236189" onmouseenter="enter('9220029862843236189');" onmouseout="out('9220029862843236189');" style=""> 802              return false; // Return false if nothing is done                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 803          }                                                                                                         </span>
<span  style=""> 804                                                                                                                    </span>
<span class="-918812678605329556" onmouseenter="enter('-918812678605329556');" onmouseout="out('-918812678605329556');" style=""> 805          // Called when the user selects a contextual menu item                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 806          @Override                                                                                                 </span>
<span class="816131742774025467" onmouseenter="enter('816131742774025467');" onmouseout="out('816131742774025467');" style=""> 807          public boolean onActionItemClicked(ActionMode mode, MenuItem item) {                                      </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 808              switch (item.getItemId()) {                                                                           </span>
<span class="1241487664924667668" onmouseenter="enter('1241487664924667668');" onmouseout="out('1241487664924667668');" style=""> 809                  case R.id.menu_view_link:                                                                         </span>
<span class="2689068574112651560" onmouseenter="enter('2689068574112651560');" onmouseout="out('2689068574112651560');" style=""> 810                      if (mLinkUrl != null) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 811                          try {                                                                                     </span>
<span class="2961985398395482945" onmouseenter="enter('2961985398395482945');" onmouseout="out('2961985398395482945');" style=""> 812                              Uri uri = Uri.parse(mLinkUrl);                                                        </span>
<span class="-3647274578727323622" onmouseenter="enter('-3647274578727323622');" onmouseout="out('-3647274578727323622');" style=""> 813                              Intent i = new Intent(Intent.ACTION_VIEW);                                            </span>
<span class="3545520342926402522" onmouseenter="enter('3545520342926402522');" onmouseout="out('3545520342926402522');" style=""> 814                              i.setData(uri);                                                                       </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 815                              startActivity(i);                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 816                          } catch (Exception e) {                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 817                              e.printStackTrace();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 818                          }                                                                                         </span>
<span class="-5985541663234456921" onmouseenter="enter('-5985541663234456921');" onmouseout="out('-5985541663234456921');" style=""> 819                          mode.finish(); // Action picked, so close the CAB                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 820                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 821                      return true;                                                                                  </span>
<span class="1323072004784584241" onmouseenter="enter('1323072004784584241');" onmouseout="out('1323072004784584241');" style=""> 822                  case R.id.menu_copy:                                                                              </span>
<span class="5917848124130151943" onmouseenter="enter('5917848124130151943');" onmouseout="out('5917848124130151943');" style=""> 823                      if (mLinkText != null &amp;&amp; getActivity() != null) {                                             </span>
<span class="-1800885668589834003" onmouseenter="enter('-1800885668589834003');" onmouseout="out('-1800885668589834003');" style=""><abbr title=" 824                          ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 824                          ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPðŸ”µ</abbr></span>
<span class="-1681747336188731628" onmouseenter="enter('-1681747336188731628');" onmouseout="out('-1681747336188731628');" style=""> 825                          ClipData clip = ClipData.newPlainText(getString(R.string.app_name),mLinkText);            </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 826                          clipboard.setPrimaryClip(clip);                                                           </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""> 827                          Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();</span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 828                          mode.finish();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 829                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 830                      return true;                                                                                  </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 831                  case R.id.menu_share:                                                                             </span>
<span class="-6928924091126055668" onmouseenter="enter('-6928924091126055668');" onmouseout="out('-6928924091126055668');" style=""> 832                      if (mLinkText != null) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 833                          try {                                                                                     </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 834                              Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                  </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 835                              shareIntent.setType(&quot;text/plain&quot;);                                                    </span>
<span class="-5545338866841663037" onmouseenter="enter('-5545338866841663037');" onmouseout="out('-5545338866841663037');" style=""> 836                              shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mLinkText);                   </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 837                              startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 837                              startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.sharðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 838                          } catch (Exception e) {                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 839                              e.printStackTrace();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 840                          }                                                                                         </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 841                          mode.finish();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 843                      return true;                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 844                  default:                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 845                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 846              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 847          }                                                                                                         </span>
<span  style=""> 848                                                                                                                    </span>
<span class="2525157012953828009" onmouseenter="enter('2525157012953828009');" onmouseout="out('2525157012953828009');" style=""> 849          // Called when the user exits the action mode                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 850          @Override                                                                                                 </span>
<span class="-2232977199830239129" onmouseenter="enter('-2232977199830239129');" onmouseout="out('-2232977199830239129');" style=""> 851          public void onDestroyActionMode(ActionMode mode) {                                                        </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 852              mActionMode = null;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 853          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 854      };                                                                                                            </span>
<span  style=""> 855                                                                                                                    </span>
<span class="-6769383367293074987" onmouseenter="enter('-6769383367293074987');" onmouseout="out('-6769383367293074987');" style=""> 856      // Checks if cursor is at a URL when the selection changes                                                    </span>
<span class="499820509706145242" onmouseenter="enter('499820509706145242');" onmouseout="out('499820509706145242');" style=""> 857      // If it is a URL, show the contextual action bar                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 858      @Override                                                                                                     </span>
<span class="-6619706727651867065" onmouseenter="enter('-6619706727651867065');" onmouseout="out('-6619706727651867065');" style=""> 859      public void onSelectionChanged(int selStart, int selEnd) {                                                    </span>
<span class="-5773931921061181239" onmouseenter="enter('-5773931921061181239');" onmouseout="out('-5773931921061181239');" style=""> 860          if (selStart == selEnd) {                                                                                 </span>
<span class="-1073801886026856185" onmouseenter="enter('-1073801886026856185');" onmouseout="out('-1073801886026856185');" style=""> 861              Editable noteContent = mContentEditText.getText();                                                    </span>
<span class="6562974929235397620" onmouseenter="enter('6562974929235397620');" onmouseout="out('6562974929235397620');" style=""> 862              if (noteContent == null)                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 863                  return;                                                                                           </span>
<span  style=""> 864                                                                                                                    </span>
<span class="1258634593958745929" onmouseenter="enter('1258634593958745929');" onmouseout="out('1258634593958745929');" style=""> 865              URLSpan[] urlSpans = noteContent.getSpans(selStart, selStart, URLSpan.class);                         </span>
<span class="8265917182779455796" onmouseenter="enter('8265917182779455796');" onmouseout="out('8265917182779455796');" style=""> 866              if (urlSpans.length &gt; 0) {                                                                            </span>
<span class="379938049561077801" onmouseenter="enter('379938049561077801');" onmouseout="out('379938049561077801');" style=""> 867                  URLSpan urlSpan = urlSpans[0];                                                                    </span>
<span class="7382553573082356877" onmouseenter="enter('7382553573082356877');" onmouseout="out('7382553573082356877');" style=""> 868                  mLinkUrl = urlSpan.getURL();                                                                      </span>
<span class="-2685141031372274993" onmouseenter="enter('-2685141031372274993');" onmouseout="out('-2685141031372274993');" style=""><abbr title=" 869                  mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSpan)).toString();"> 869                  mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 870                  if (mActionMode != null) {                                                                        </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 871                      mActionMode.setSubtitle(mLinkText);                                                           </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 872                      setLinkMenuItem();                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 873                      return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 874                  }                                                                                                 </span>
<span  style=""> 875                                                                                                                    </span>
<span class="-4243988111679111503" onmouseenter="enter('-4243988111679111503');" onmouseout="out('-4243988111679111503');" style=""> 876                  // Show the Contextual Action Bar                                                                 </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 877                  if (getActivity() != null) {                                                                      </span>
<span class="-7828194884341615795" onmouseenter="enter('-7828194884341615795');" onmouseout="out('-7828194884341615795');" style=""> 878                      mActionMode = getActivity().startActionMode(mActionModeCallback);                             </span>

<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 879                      if (mActionMode != null) {                                                                    </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 880                          mActionMode.setSubtitle(mLinkText);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 881                      }                                                                                             </span>

<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 882                      setLinkMenuItem();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 883                  }                                                                                                 </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 884              } else if (mActionMode != null) {                                                                     </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 885                  mActionMode.finish();                                                                             </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 886                  mActionMode = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 887              }                                                                                                     </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 888          } else if (mActionMode != null) {                                                                         </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 889              mActionMode.finish();                                                                                 </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 890              mActionMode = null;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 891          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 892      }                                                                                                             </span>
<span  style=""> 893                                                                                                                    </span>
<span class="-1933854749523580289" onmouseenter="enter('-1933854749523580289');" onmouseout="out('-1933854749523580289');" style=""> 894      private void setLinkMenuItem() {                                                                              </span>
<span class="-4542884014549729251" onmouseenter="enter('-4542884014549729251');" onmouseout="out('-4542884014549729251');" style=""> 895          if (mViewLinkMenuItem != null &amp;&amp; mLinkUrl != null) {                                                      </span>
<span class="7070835845876331574" onmouseenter="enter('7070835845876331574');" onmouseout="out('7070835845876331574');" style=""> 896              if (mLinkUrl.startsWith(&quot;tel:&quot;)) {                                                                    </span>
<span class="4608769072092705594" onmouseenter="enter('4608769072092705594');" onmouseout="out('4608769072092705594');" style=""> 897                  mViewLinkMenuItem.setIcon(mCallIconResId);                                                        </span>
<span class="-1045706461125369539" onmouseenter="enter('-1045706461125369539');" onmouseout="out('-1045706461125369539');" style=""> 898                  mViewLinkMenuItem.setTitle(getString(R.string.call));                                             </span>
<span class="-4087102511435152339" onmouseenter="enter('-4087102511435152339');" onmouseout="out('-4087102511435152339');" style=""> 899              } else if (mLinkUrl.startsWith(&quot;mailto:&quot;)) {                                                          </span>
<span class="112818067677115399" onmouseenter="enter('112818067677115399');" onmouseout="out('112818067677115399');" style=""> 900                  mViewLinkMenuItem.setIcon(mEmailIconResId);                                                       </span>
<span class="7417350135164215691" onmouseenter="enter('7417350135164215691');" onmouseout="out('7417350135164215691');" style=""> 901                  mViewLinkMenuItem.setTitle(getString(R.string.email));                                            </span>
<span class="-1372170246346381865" onmouseenter="enter('-1372170246346381865');" onmouseout="out('-1372170246346381865');" style=""> 902              } else if (mLinkUrl.startsWith(&quot;geo:&quot;)) {                                                             </span>
<span class="-5464734295170160558" onmouseenter="enter('-5464734295170160558');" onmouseout="out('-5464734295170160558');" style=""> 903                  mViewLinkMenuItem.setIcon(mMapIconResId);                                                         </span>
<span class="5018205442899714685" onmouseenter="enter('5018205442899714685');" onmouseout="out('5018205442899714685');" style=""> 904                  mViewLinkMenuItem.setTitle(getString(R.string.view_map));                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 905              } else {                                                                                              </span>
<span class="-4632312324298999235" onmouseenter="enter('-4632312324298999235');" onmouseout="out('-4632312324298999235');" style=""> 906                  mViewLinkMenuItem.setIcon(mWebIconResId);                                                         </span>
<span class="4171282647008223100" onmouseenter="enter('4171282647008223100');" onmouseout="out('4171282647008223100');" style=""> 907                  mViewLinkMenuItem.setTitle(getString(R.string.view_in_browser));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 908              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 909          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 910      }                                                                                                             </span>
<span  style=""> 911                                                                                                                    </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 912      // Resets note publish status if Simperium never returned the new publish status                              </span>
<span class="-7747131454054684363" onmouseenter="enter('-7747131454054684363');" onmouseout="out('-7747131454054684363');" style=""> 913      private Runnable mPublishTimeoutRunnable = new Runnable() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 914          @Override                                                                                                 </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 915          public void run() {                                                                                       </span>
<span class="6112154992837754036" onmouseenter="enter('6112154992837754036');" onmouseout="out('6112154992837754036');" style=""> 916              if (!isAdded()) return;                                                                               </span>
<span  style=""> 917                                                                                                                    </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 918              getActivity().runOnUiThread(new Runnable() {                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 919                  @Override                                                                                         </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 920                  public void run() {                                                                               </span>
<span class="-46541338249551852" onmouseenter="enter('-46541338249551852');" onmouseout="out('-46541338249551852');" style=""> 921                      Toast.makeText(                                                                               </span>
<span class="1251951171853107838" onmouseenter="enter('1251951171853107838');" onmouseout="out('1251951171853107838');" style=""> 922                              getActivity(),                                                                        </span>
<span class="112353621179497368" onmouseenter="enter('112353621179497368');" onmouseout="out('112353621179497368');" style=""> 923                              mNote.isPublished() ? R.string.publish_error : R.string.unpublish_error,              </span>
<span class="-5464445565121122409" onmouseenter="enter('-5464445565121122409');" onmouseout="out('-5464445565121122409');" style=""> 924                              Toast.LENGTH_SHORT                                                                    </span>
<span class="1929519410657596695" onmouseenter="enter('1929519410657596695');" onmouseout="out('1929519410657596695');" style=""> 925                      ).show();                                                                                     </span>
<span  style=""> 926                                                                                                                    </span>
<span class="-6752199236124778161" onmouseenter="enter('-6752199236124778161');" onmouseout="out('-6752199236124778161');" style=""> 927                      mNote.setPublished(!mNote.isPublished());                                                     </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 928                      mNote.save();                                                                                 </span>
<span  style=""> 929                                                                                                                    </span>
<span class="-4813280994160595323" onmouseenter="enter('-4813280994160595323');" onmouseout="out('-4813280994160595323');" style=""> 930                      if (mInfoPopupWindow != null &amp;&amp; mInfoPopupWindow.isShowing()) {                               </span>
<span class="-6944825779591395660" onmouseenter="enter('-6944825779591395660');" onmouseout="out('-6944825779591395660');" style=""><abbr title=" 931                          ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(R.id.publish_view_switcher);"> 931                          ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(RðŸ”µ</abbr></span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 932                          if (viewSwitcher.getDisplayedChild() == 1) {                                              </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 933                              viewSwitcher.showPrevious();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 934                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 935                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 936                  }                                                                                                 </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 937              });                                                                                                   </span>
<span  style=""> 938                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 940      };                                                                                                            </span>
<span  style=""> 941                                                                                                                    </span>
<span class="1779789763575252159" onmouseenter="enter('1779789763575252159');" onmouseout="out('1779789763575252159');" style=""> 942      private void updateWordCount(TextView textView) {                                                             </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 943          String content = getNoteContentString();                                                                  </span>
<span  style=""> 944                                                                                                                    </span>
<span class="-1008232604726066894" onmouseenter="enter('-1008232604726066894');" onmouseout="out('-1008232604726066894');" style=""> 945          if (content == null || textView == null) return;                                                          </span>
<span  style=""> 946                                                                                                                    </span>
<span class="-1430881109113489374" onmouseenter="enter('-1430881109113489374');" onmouseout="out('-1430881109113489374');" style=""> 947          int numWords = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;              </span>
<span  style=""> 948                                                                                                                    </span>
<span class="7366599842051642465" onmouseenter="enter('7366599842051642465');" onmouseout="out('7366599842051642465');" style=""> 949          String wordCountString = getResources().getQuantityString(R.plurals.word_count, numWords);                </span>
<span class="6184855737129992397" onmouseenter="enter('6184855737129992397');" onmouseout="out('6184855737129992397');" style=""> 950          String formattedWordCount = NumberFormat.getInstance().format(numWords);                                  </span>
<span  style=""> 951                                                                                                                    </span>
<span class="-8359331938088478069" onmouseenter="enter('-8359331938088478069');" onmouseout="out('-8359331938088478069');" style=""> 952          textView.setText(formattedWordCount + &quot; &quot; + wordCountString);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 953      }                                                                                                             </span>
<span  style=""> 954                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 955      /**                                                                                                           </span>
<span class="-1711188639399183775" onmouseenter="enter('-1711188639399183775');" onmouseout="out('-1711188639399183775');" style=""> 956       * Simperium listeners                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 957       */                                                                                                           </span>
<span  style=""> 958                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 959      @Override                                                                                                     </span>
<span class="3459602708969445883" onmouseenter="enter('3459602708969445883');" onmouseout="out('3459602708969445883');" style=""> 960      public void onDeleteObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                              </span>
<span  style=""> 961                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 962      }                                                                                                             </span>
<span  style=""> 963                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 964      @Override                                                                                                     </span>
<span class="-391573795721253888" onmouseenter="enter('-391573795721253888');" onmouseout="out('-391573795721253888');" style=""> 965      public void onChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {               </span>

<span class="6607037711761945955" onmouseenter="enter('6607037711761945955');" onmouseout="out('6607037711761945955');" style=""> 966          if (changeType == Bucket.ChangeType.MODIFY) {                                                             </span>
<span class="-6254872391725782597" onmouseenter="enter('-6254872391725782597');" onmouseout="out('-6254872391725782597');" style=""> 967              if (getNote() != null &amp;&amp; getNote().getSimperiumKey().equals(key)) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 968                  try {                                                                                             </span>
<span class="3951885723067312215" onmouseenter="enter('3951885723067312215');" onmouseout="out('3951885723067312215');" style=""> 969                      final Note updatedNote = mNotesBucket.get(key);                                               </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 970                      if (getActivity() != null) {                                                                  </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 971                          getActivity().runOnUiThread(new Runnable() {                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 972                              @Override                                                                             </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 973                              public void run() {                                                                   </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 974                                  if (mPublishTimeoutHandler != null) {                                             </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 975                                      mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 976                                  }                                                                                 </span>
<span  style=""> 977                                                                                                                    </span>
<span class="-8617980127286778731" onmouseenter="enter('-8617980127286778731');" onmouseout="out('-8617980127286778731');" style=""> 978                                  updateNote(updatedNote);                                                          </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 979                                  updateInfoPopup();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 980                              }                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 981                          });                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 982                      }                                                                                             </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 983                  } catch (BucketObjectMissingException e) {                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 984                      e.printStackTrace();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 985                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 986              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 987          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 988      }                                                                                                             </span>
<span  style=""> 989                                                                                                                    </span>
<span  style=""> 990                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 991      @Override                                                                                                     </span>
<span class="1835476648918604123" onmouseenter="enter('1835476648918604123');" onmouseout="out('1835476648918604123');" style=""> 992      public void onSaveObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                                </span>
<span class="-5784091718421357269" onmouseenter="enter('-5784091718421357269');" onmouseout="out('-5784091718421357269');" style=""> 993          // noop                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 994      }                                                                                                             </span>
<span  style=""> 995                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 996      @Override                                                                                                     </span>
<span class="-5956849782971602831" onmouseenter="enter('-5956849782971602831');" onmouseout="out('-5956849782971602831');" style=""> 997      public void onBeforeUpdateObject(Bucket&lt;Note&gt; bucket, Note note) {                                            </span>
<span class="9133977848896323437" onmouseenter="enter('9133977848896323437');" onmouseout="out('9133977848896323437');" style=""> 998          // Don&#x27;t apply updates if we haven&#x27;t loaded the note yet                                                  </span>
<span class="-1541782922582123662" onmouseenter="enter('-1541782922582123662');" onmouseout="out('-1541782922582123662');" style=""> 999          if (mIsLoadingNote)                                                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1000              return;                                                                                               </span>
<span  style="">1001                                                                                                                    </span>
<span class="1341660593539808393" onmouseenter="enter('1341660593539808393');" onmouseout="out('1341660593539808393');" style="">1002          Note openNote = getNote();                                                                                </span>
<span class="-6997098079508589023" onmouseenter="enter('-6997098079508589023');" onmouseout="out('-6997098079508589023');" style="">1003          if (openNote == null || !openNote.getSimperiumKey().equals(note.getSimperiumKey()))                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1004              return;                                                                                               </span>
<span  style="">1005                                                                                                                    </span>
<span class="4441072062127767636" onmouseenter="enter('4441072062127767636');" onmouseout="out('4441072062127767636');" style="">1006          note.setContent(getNoteContentString());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1007      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1008  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="8328120990598135231" onmouseenter="enter('8328120990598135231');" onmouseout="out('8328120990598135231');" style="">   1  package com.automattic.simplenote;                                                                                </span>
<span  style="">   2                                                                                                                    </span>
<span class="-7090287939251728203" onmouseenter="enter('-7090287939251728203');" onmouseout="out('-7090287939251728203');" style="">   3  import android.app.Activity;                                                                                      </span>
<span class="7622566010320033225" onmouseenter="enter('7622566010320033225');" onmouseout="out('7622566010320033225');" style="">   4  import android.app.Fragment;                                                                                      </span>
<span class="-1500972560159629307" onmouseenter="enter('-1500972560159629307');" onmouseout="out('-1500972560159629307');" style="">   5  import android.content.ClipData;                                                                                  </span>
<span class="-1154037727824652611" onmouseenter="enter('-1154037727824652611');" onmouseout="out('-1154037727824652611');" style="">   6  import android.content.ClipboardManager;                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   7  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">   8  import android.content.Intent;                                                                                    </span>
<span class="-840652079464298178" onmouseenter="enter('-840652079464298178');" onmouseout="out('-840652079464298178');" style="">   9  import android.content.res.TypedArray;                                                                            </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  10  import android.database.Cursor;                                                                                   </span>
<span class="1216741051675613788" onmouseenter="enter('1216741051675613788');" onmouseout="out('1216741051675613788');" style="">  11  import android.graphics.drawable.ColorDrawable;                                                                   </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  12  import android.net.Uri;                                                                                           </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  13  import android.os.AsyncTask;                                                                                      </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  14  import android.os.Build;                                                                                          </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  15  import android.os.Bundle;                                                                                         </span>
<span class="-1086316590722027623" onmouseenter="enter('-1086316590722027623');" onmouseout="out('-1086316590722027623');" style="">  16  import android.os.Handler;                                                                                        </span>
<span class="2386702825235411308" onmouseenter="enter('2386702825235411308');" onmouseout="out('2386702825235411308');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  17 +import android.support.v4.app.ActivityCompat;                                                                     </span>
<span class="-8226814767277370585" onmouseenter="enter('-8226814767277370585');" onmouseout="out('-8226814767277370585');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  18 +import android.support.v7.view.ActionMode;                                                                        </span>
<span class="4177373235046048356" onmouseenter="enter('4177373235046048356');" onmouseout="out('4177373235046048356');" style="">  19  import android.text.Editable;                                                                                     </span>
<span class="7731806713123176572" onmouseenter="enter('7731806713123176572');" onmouseout="out('7731806713123176572');" style="">  20  import android.text.Spanned;                                                                                      </span>
<span class="4038639591141008331" onmouseenter="enter('4038639591141008331');" onmouseout="out('4038639591141008331');" style="">  21  import android.text.TextWatcher;                                                                                  </span>
<span class="2374973474356501783" onmouseenter="enter('2374973474356501783');" onmouseout="out('2374973474356501783');" style="">  22  import android.text.style.RelativeSizeSpan;                                                                       </span>
<span class="-1165963660754430642" onmouseenter="enter('-1165963660754430642');" onmouseout="out('-1165963660754430642');" style="">  23  import android.text.style.URLSpan;                                                                                </span>
<span class="-3804250137032727253" onmouseenter="enter('-3804250137032727253');" onmouseout="out('-3804250137032727253');" style="">  24  import android.text.util.Linkify;                                                                                 </span>

<span class="-153541495165582031" onmouseenter="enter('-153541495165582031');" onmouseout="out('-153541495165582031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import android.view.ActionMode;                                                                                   </span>
<span class="8553241717595905778" onmouseenter="enter('8553241717595905778');" onmouseout="out('8553241717595905778');" style="">  26  import android.view.LayoutInflater;                                                                               </span>
<span class="-603490076395619238" onmouseenter="enter('-603490076395619238');" onmouseout="out('-603490076395619238');" style="">  27  import android.view.Menu;                                                                                         </span>
<span class="-434306062495579804" onmouseenter="enter('-434306062495579804');" onmouseout="out('-434306062495579804');" style="">  28  import android.view.MenuInflater;                                                                                 </span>
<span class="6391706839654240930" onmouseenter="enter('6391706839654240930');" onmouseout="out('6391706839654240930');" style="">  29  import android.view.MenuItem;                                                                                     </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  30  import android.view.View;                                                                                         </span>
<span class="7569314084591619834" onmouseenter="enter('7569314084591619834');" onmouseout="out('7569314084591619834');" style="">  31  import android.view.ViewGroup;                                                                                    </span>
<span class="-3054355229537475035" onmouseenter="enter('-3054355229537475035');" onmouseout="out('-3054355229537475035');" style="">  32  import android.view.WindowManager;                                                                                </span>
<span class="-3117363671899680167" onmouseenter="enter('-3117363671899680167');" onmouseout="out('-3117363671899680167');" style="">  33  import android.view.inputmethod.InputMethodManager;                                                               </span>
<span class="5634491474902588492" onmouseenter="enter('5634491474902588492');" onmouseout="out('5634491474902588492');" style="">  34  import android.widget.CursorAdapter;                                                                              </span>
<span class="-7136991092569948508" onmouseenter="enter('-7136991092569948508');" onmouseout="out('-7136991092569948508');" style="">  35  import android.widget.ImageButton;                                                                                </span>
<span class="-8478546344938881111" onmouseenter="enter('-8478546344938881111');" onmouseout="out('-8478546344938881111');" style="">  36  import android.widget.ImageView;                                                                                  </span>
<span class="5987800420235491716" onmouseenter="enter('5987800420235491716');" onmouseout="out('5987800420235491716');" style="">  37  import android.widget.LinearLayout;                                                                               </span>
<span class="842268080202249770" onmouseenter="enter('842268080202249770');" onmouseout="out('842268080202249770');" style="">  38  import android.widget.PopupWindow;                                                                                </span>
<span class="-4961528671422147708" onmouseenter="enter('-4961528671422147708');" onmouseout="out('-4961528671422147708');" style="">  39  import android.widget.TextView;                                                                                   </span>
<span class="-4373317539211938720" onmouseenter="enter('-4373317539211938720');" onmouseout="out('-4373317539211938720');" style="">  40  import android.widget.Toast;                                                                                      </span>
<span class="-1505700250942826116" onmouseenter="enter('-1505700250942826116');" onmouseout="out('-1505700250942826116');" style="">  41  import android.widget.ToggleButton;                                                                               </span>
<span class="737425360271515900" onmouseenter="enter('737425360271515900');" onmouseout="out('737425360271515900');" style="">  42  import android.widget.ViewSwitcher;                                                                               </span>
<span  style="">  43                                                                                                                    </span>
<span class="9061368408436996655" onmouseenter="enter('9061368408436996655');" onmouseout="out('9061368408436996655');" style="">  44  import com.automattic.simplenote.models.Note;                                                                     </span>
<span class="107771998888903823" onmouseenter="enter('107771998888903823');" onmouseout="out('107771998888903823');" style="">  45  import com.automattic.simplenote.models.Tag;                                                                      </span>
<span class="-4380838228434146133" onmouseenter="enter('-4380838228434146133');" onmouseout="out('-4380838228434146133');" style="">  46  import com.automattic.simplenote.utils.AutoBullet;                                                                </span>
<span class="8577850632926167445" onmouseenter="enter('8577850632926167445');" onmouseout="out('8577850632926167445');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import com.automattic.simplenote.utils.DisplayUtils;                                                              </span>
<span class="1327521140651609704" onmouseenter="enter('1327521140651609704');" onmouseout="out('1327521140651609704');" style="">  48  import com.automattic.simplenote.utils.MatchOffsetHighlighter;                                                    </span>

<span class="13513923158165555" onmouseenter="enter('13513923158165555');" onmouseout="out('13513923158165555');" style="">  49  import com.automattic.simplenote.utils.SpaceTokenizer;                                                            </span>
<span class="4834384566534786428" onmouseenter="enter('4834384566534786428');" onmouseout="out('4834384566534786428');" style="">  50  import com.automattic.simplenote.widgets.SimplenoteEditText;                                                      </span>
<span class="2537926396801226048" onmouseenter="enter('2537926396801226048');" onmouseout="out('2537926396801226048');" style="">  51  import com.automattic.simplenote.utils.SimplenoteLinkify;                                                         </span>
<span class="-4652171765784917488" onmouseenter="enter('-4652171765784917488');" onmouseout="out('-4652171765784917488');" style="">  52  import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView;                                             </span>
<span class="451633977271230846" onmouseenter="enter('451633977271230846');" onmouseout="out('451633977271230846');" style="">  53  import com.automattic.simplenote.utils.TagsMultiAutoCompleteTextView.OnTagAddedListener;                          </span>
<span class="3055903766206676561" onmouseenter="enter('3055903766206676561');" onmouseout="out('3055903766206676561');" style="">  54  import com.automattic.simplenote.utils.TextHighlighter;                                                           </span>
<span class="-454400291627646237" onmouseenter="enter('-454400291627646237');" onmouseout="out('-454400291627646237');" style="">  55  import com.google.android.gms.analytics.HitBuilders;                                                              </span>
<span class="-1389398410172463659" onmouseenter="enter('-1389398410172463659');" onmouseout="out('-1389398410172463659');" style="">  56  import com.google.android.gms.analytics.Tracker;                                                                  </span>
<span class="-8170925370861558125" onmouseenter="enter('-8170925370861558125');" onmouseout="out('-8170925370861558125');" style="">  57  import com.simperium.client.Bucket;                                                                               </span>
<span class="-8454203534157102839" onmouseenter="enter('-8454203534157102839');" onmouseout="out('-8454203534157102839');" style="">  58  import com.simperium.client.BucketObjectMissingException;                                                         </span>
<span class="-6020507013779766735" onmouseenter="enter('-6020507013779766735');" onmouseout="out('-6020507013779766735');" style="">  59  import com.simperium.client.Query;                                                                                </span>
<span  style="">  60                                                                                                                    </span>
<span class="-76499702739685611" onmouseenter="enter('-76499702739685611');" onmouseout="out('-76499702739685611');" style="">  61  import java.text.NumberFormat;                                                                                    </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  62  import java.util.Calendar;                                                                                        </span>
<span  style="">  63                                                                                                                    </span>
<span class="7280890691619564888" onmouseenter="enter('7280890691619564888');" onmouseout="out('7280890691619564888');" style=""><abbr title="  64  public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListener, View.OnFocusChangeListener, SimplenoteEditText.OnSelectionChangedListener {">  64  public class NoteEditorFragment extends Fragment implements Bucket.Listener&lt;Note&gt;, TextWatcher, OnTagAddedListenerðŸ”µ</abbr></span>
<span  style="">  65                                                                                                                    </span>
<span class="-4619625032881090052" onmouseenter="enter('-4619625032881090052');" onmouseout="out('-4619625032881090052');" style="">  66      public static final String ARG_ITEM_ID = &quot;item_id&quot;;                                                           </span>
<span class="-7299684920632401552" onmouseenter="enter('-7299684920632401552');" onmouseout="out('-7299684920632401552');" style="">  67      public static final String ARG_NEW_NOTE = &quot;new_note&quot;;                                                         </span>
<span class="7663325037782331899" onmouseenter="enter('7663325037782331899');" onmouseout="out('7663325037782331899');" style="">  68      static public final String ARG_MATCH_OFFSETS = &quot;match_offsets&quot;;                                               </span>
<span class="8491452362607628076" onmouseenter="enter('8491452362607628076');" onmouseout="out('8491452362607628076');" style="">  69      private static final int AUTOSAVE_DELAY_MILLIS = 2000;                                                        </span>
<span  style="">  70                                                                                                                    </span>
<span class="-6846870049312317979" onmouseenter="enter('-6846870049312317979');" onmouseout="out('-6846870049312317979');" style="">  71      private Note mNote;                                                                                           </span>
<span class="-7913886194286774922" onmouseenter="enter('-7913886194286774922');" onmouseout="out('-7913886194286774922');" style="">  72      private Bucket&lt;Note&gt; mNotesBucket;                                                                            </span>
<span  style="">  73                                                                                                                    </span>
<span class="7126484835826685301" onmouseenter="enter('7126484835826685301');" onmouseout="out('7126484835826685301');" style="">  74      private Tracker mTracker;                                                                                     </span>
<span  style="">  75                                                                                                                    </span>
<span class="6580801006778009663" onmouseenter="enter('6580801006778009663');" onmouseout="out('6580801006778009663');" style="">  76      private SimplenoteEditText mContentEditText;                                                                  </span>
<span class="-6964345898478101017" onmouseenter="enter('-6964345898478101017');" onmouseout="out('-6964345898478101017');" style="">  77      private TagsMultiAutoCompleteTextView mTagView;                                                               </span>
<span class="5165556704755836097" onmouseenter="enter('5165556704755836097');" onmouseout="out('5165556704755836097');" style="">  78      private PopupWindow mInfoPopupWindow;                                                                         </span>
<span class="2959047860003936172" onmouseenter="enter('2959047860003936172');" onmouseout="out('2959047860003936172');" style="">  79      private ToggleButton mPinButton;                                                                              </span>
<span class="6494121288462075344" onmouseenter="enter('6494121288462075344');" onmouseout="out('6494121288462075344');" style="">  80      private Handler mAutoSaveHandler;                                                                             </span>
<span class="8783277907965445564" onmouseenter="enter('8783277907965445564');" onmouseout="out('8783277907965445564');" style="">  81      private Handler mPublishTimeoutHandler;                                                                       </span>
<span class="-1776320876088405367" onmouseenter="enter('-1776320876088405367');" onmouseout="out('-1776320876088405367');" style="">  82      private LinearLayout mPlaceholderView;                                                                        </span>
<span class="-5862875858497045082" onmouseenter="enter('-5862875858497045082');" onmouseout="out('-5862875858497045082');" style="">  83      private CursorAdapter mAutocompleteAdapter;                                                                   </span>
<span class="275494556225166536" onmouseenter="enter('275494556225166536');" onmouseout="out('275494556225166536');" style="">  84      private boolean mIsNewNote, mIsLoadingNote;                                                                   </span>
<span class="7307228847460234411" onmouseenter="enter('7307228847460234411');" onmouseout="out('7307228847460234411');" style="">  85      private ActionMode mActionMode;                                                                               </span>
<span class="-1934738222867341331" onmouseenter="enter('-1934738222867341331');" onmouseout="out('-1934738222867341331');" style="">  86      private MenuItem mViewLinkMenuItem;                                                                           </span>
<span class="-3624836155172024592" onmouseenter="enter('-3624836155172024592');" onmouseout="out('-3624836155172024592');" style="">  87      private String mLinkUrl;                                                                                      </span>
<span class="-680149036339568713" onmouseenter="enter('-680149036339568713');" onmouseout="out('-680149036339568713');" style="">  88      private String mLinkText;                                                                                     </span>
<span class="-8355060532383088001" onmouseenter="enter('-8355060532383088001');" onmouseout="out('-8355060532383088001');" style="">  89      private MatchOffsetHighlighter mHighlighter;                                                                  </span>
<span class="-2809999858206249165" onmouseenter="enter('-2809999858206249165');" onmouseout="out('-2809999858206249165');" style="">  90      private int mEmailIconResId, mWebIconResId, mMapIconResId, mCallIconResId;                                    </span>
<span class="-7542236593744276396" onmouseenter="enter('-7542236593744276396');" onmouseout="out('-7542236593744276396');" style="">  91      private MatchOffsetHighlighter.SpanFactory mMatchHighlighter;                                                 </span>
<span class="2689815831275839045" onmouseenter="enter('2689815831275839045');" onmouseout="out('2689815831275839045');" style="">  92      private String mMatchOffsets;                                                                                 </span>
<span class="-7790101837861097441" onmouseenter="enter('-7790101837861097441');" onmouseout="out('-7790101837861097441');" style="">  93      private int mCurrentCursorPosition;                                                                           </span>
<span  style="">  94                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95      /**                                                                                                           </span>
<span class="7780585517980788373" onmouseenter="enter('7780585517980788373');" onmouseout="out('7780585517980788373');" style="">  96       * Mandatory empty constructor for the fragment manager to instantiate the                                    </span>
<span class="7130060501227883159" onmouseenter="enter('7130060501227883159');" onmouseout="out('7130060501227883159');" style="">  97       * fragment (e.g. upon screen orientation changes).                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  98       */                                                                                                           </span>
<span class="2055429757813344166" onmouseenter="enter('2055429757813344166');" onmouseout="out('2055429757813344166');" style="">  99      public NoteEditorFragment() {                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100      }                                                                                                             </span>
<span  style=""> 101                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 102      @Override                                                                                                     </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 103      public void onCreate(Bundle savedInstanceState) {                                                             </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 104          super.onCreate(savedInstanceState);                                                                       </span>
<span  style=""> 105                                                                                                                    </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 106          if (getActivity() != null) {                                                                              </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 107              Simplenote currentApp = (Simplenote) getActivity().getApplication();                                  </span>
<span class="3464165486447434608" onmouseenter="enter('3464165486447434608');" onmouseout="out('3464165486447434608');" style=""> 108              mNotesBucket = currentApp.getNotesBucket();                                                           </span>
<span class="8395901407898834802" onmouseenter="enter('8395901407898834802');" onmouseout="out('8395901407898834802');" style=""> 109              mTracker = currentApp.getTracker();                                                                   </span>
<span  style=""> 110                                                                                                                    </span>
<span class="6390134422937918444" onmouseenter="enter('6390134422937918444');" onmouseout="out('6390134422937918444');" style=""><abbr title=" 111              TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionBarIconWeb, R.attr.actionBarIconMap, R.attr.actionBarIconCall});"> 111              TypedArray a = getActivity().obtainStyledAttributes(new int[]{R.attr.actionBarIconEmail, R.attr.actionðŸ”µ</abbr></span>
<span class="-368005650607593546" onmouseenter="enter('-368005650607593546');" onmouseout="out('-368005650607593546');" style=""> 112              if (a != null) {                                                                                      </span>
<span class="156477903530707073" onmouseenter="enter('156477903530707073');" onmouseout="out('156477903530707073');" style=""> 113                  mEmailIconResId = a.getResourceId(0, 0);                                                          </span>
<span class="2237960387607406884" onmouseenter="enter('2237960387607406884');" onmouseout="out('2237960387607406884');" style=""> 114                  mWebIconResId = a.getResourceId(1, 0);                                                            </span>
<span class="-2587404817224189880" onmouseenter="enter('-2587404817224189880');" onmouseout="out('-2587404817224189880');" style=""> 115                  mMapIconResId = a.getResourceId(2, 0);                                                            </span>
<span class="7397862531502718567" onmouseenter="enter('7397862531502718567');" onmouseout="out('7397862531502718567');" style=""> 116                  mCallIconResId = a.getResourceId(3, 0);                                                           </span>
<span class="7664438635535969272" onmouseenter="enter('7664438635535969272');" onmouseout="out('7664438635535969272');" style=""> 117                  a.recycle();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119          }                                                                                                         </span>
<span  style=""> 120                                                                                                                    </span>
<span class="-7557436274459739944" onmouseenter="enter('-7557436274459739944');" onmouseout="out('-7557436274459739944');" style=""> 121          mAutoSaveHandler = new Handler();                                                                         </span>
<span class="5311700283685025064" onmouseenter="enter('5311700283685025064');" onmouseout="out('5311700283685025064');" style=""> 122          mPublishTimeoutHandler = new Handler();                                                                   </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-8863028397307166255" onmouseenter="enter('-8863028397307166255');" onmouseout="out('-8863028397307166255');" style=""> 124          mMatchHighlighter = new TextHighlighter(getActivity(),                                                    </span>
<span class="5690198221529347900" onmouseenter="enter('5690198221529347900');" onmouseout="out('5690198221529347900');" style=""> 125                  R.attr.editorSearchHighlightForegroundColor, R.attr.editorSearchHighlightBackgroundColor);        </span>
<span class="3992270686517948303" onmouseenter="enter('3992270686517948303');" onmouseout="out('3992270686517948303');" style=""> 126          mAutocompleteAdapter = new CursorAdapter(getActivity(), null, 0x0){                                       </span>
<span  style=""> 127                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 128              @Override                                                                                             </span>
<span class="5082230411214880762" onmouseenter="enter('5082230411214880762');" onmouseout="out('5082230411214880762');" style=""> 129              public View newView(Context context, Cursor cursor, ViewGroup parent) {                               </span>
<span class="-7341849400851650995" onmouseenter="enter('-7341849400851650995');" onmouseout="out('-7341849400851650995');" style=""> 130                  Activity activity = (Activity) context;                                                           </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 131                  if (activity == null) return null;                                                                </span>
<span class="-3314008061858345993" onmouseenter="enter('-3314008061858345993');" onmouseout="out('-3314008061858345993');" style=""> 132                  return activity.getLayoutInflater().inflate(R.layout.tag_autocomplete_list_item, null);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133              }                                                                                                     </span>
<span  style=""> 134                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 135              @Override                                                                                             </span>
<span class="19024103499623332" onmouseenter="enter('19024103499623332');" onmouseout="out('19024103499623332');" style=""> 136              public void bindView(View view, Context context, Cursor cursor) {                                     </span>
<span class="1800045997788095368" onmouseenter="enter('1800045997788095368');" onmouseout="out('1800045997788095368');" style=""> 137                  TextView textView = (TextView) view;                                                              </span>
<span class="6731261465219202848" onmouseenter="enter('6731261465219202848');" onmouseout="out('6731261465219202848');" style=""> 138                  textView.setText(convertToString(cursor));                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139              }                                                                                                     </span>
<span  style=""> 140                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141              @Override                                                                                             </span>
<span class="-1664730445059241307" onmouseenter="enter('-1664730445059241307');" onmouseout="out('-1664730445059241307');" style=""> 142              public CharSequence convertToString(Cursor cursor){                                                   </span>
<span class="-7149458698442797769" onmouseenter="enter('-7149458698442797769');" onmouseout="out('-7149458698442797769');" style=""> 143                  return cursor.getString(cursor.getColumnIndex(Tag.NAME_PROPERTY));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144              }                                                                                                     </span>
<span  style=""> 145                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 146              @Override                                                                                             </span>
<span class="-6792310640715402890" onmouseenter="enter('-6792310640715402890');" onmouseout="out('-6792310640715402890');" style=""> 147              public Cursor runQueryOnBackgroundThread(CharSequence filter) {                                       </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 148                  Activity activity = getActivity();                                                                </span>
<span class="-4259990117100818562" onmouseenter="enter('-4259990117100818562');" onmouseout="out('-4259990117100818562');" style=""> 149                  if (activity == null) return null;                                                                </span>
<span class="9016693485500608067" onmouseenter="enter('9016693485500608067');" onmouseout="out('9016693485500608067');" style=""> 150                  Simplenote application = (Simplenote) activity.getApplication();                                  </span>
<span class="-288329532637656436" onmouseenter="enter('-288329532637656436');" onmouseout="out('-288329532637656436');" style=""> 151                  Query&lt;Tag&gt; query = application.getTagsBucket().query();                                           </span>
<span class="-1263658484466254954" onmouseenter="enter('-1263658484466254954');" onmouseout="out('-1263658484466254954');" style=""> 152                  // make the tag name available to the cursor                                                      </span>
<span class="5748018636045801946" onmouseenter="enter('5748018636045801946');" onmouseout="out('5748018636045801946');" style=""> 153                  query.include(Tag.NAME_PROPERTY);                                                                 </span>
<span class="-7615810455976629564" onmouseenter="enter('-7615810455976629564');" onmouseout="out('-7615810455976629564');" style=""> 154                  // sort the tags by their names                                                                   </span>
<span class="5674220988188306819" onmouseenter="enter('5674220988188306819');" onmouseout="out('5674220988188306819');" style=""> 155                  query.order(Tag.NAME_PROPERTY);                                                                   </span>
<span class="8185275162074884971" onmouseenter="enter('8185275162074884971');" onmouseout="out('8185275162074884971');" style=""> 156                  // if there&#x27;s a filter string find only matching tag names                                        </span>
<span class="-1465062097430607325" onmouseenter="enter('-1465062097430607325');" onmouseout="out('-1465062097430607325');" style=""><abbr title=" 157                  if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%&quot;, filter));"> 157                  if (filter != null ) query.where(Tag.NAME_PROPERTY, Query.ComparisonType.LIKE, String.format(&quot;%s%%ðŸ”µ</abbr></span>
<span class="8392918727668200780" onmouseenter="enter('8392918727668200780');" onmouseout="out('8392918727668200780');" style=""> 158                  return query.execute();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159              }                                                                                                     </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 160          };                                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161      }                                                                                                             </span>
<span  style=""> 162                                                                                                                    </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="-7355940524539913821" onmouseenter="enter('-7355940524539913821');" onmouseout="out('-7355940524539913821');" style=""> 165      public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {           </span>
<span class="7823602444079418117" onmouseenter="enter('7823602444079418117');" onmouseout="out('7823602444079418117');" style=""> 166          setHasOptionsMenu(true);                                                                                  </span>
<span class="6339769591252564933" onmouseenter="enter('6339769591252564933');" onmouseout="out('6339769591252564933');" style=""> 167          View rootView = inflater.inflate(R.layout.fragment_note_editor, container, false);                        </span>
<span class="7145177453793333411" onmouseenter="enter('7145177453793333411');" onmouseout="out('7145177453793333411');" style=""> 168          mContentEditText = ((SimplenoteEditText) rootView.findViewById(R.id.note_content));                       </span>
<span class="-2924083774161461664" onmouseenter="enter('-2924083774161461664');" onmouseout="out('-2924083774161461664');" style=""> 169          mContentEditText.addOnSelectionChangedListener(this);                                                     </span>
<span class="-5685601943521108416" onmouseenter="enter('-5685601943521108416');" onmouseout="out('-5685601943521108416');" style=""> 170          mTagView = (TagsMultiAutoCompleteTextView) rootView.findViewById(R.id.tag_view);                          </span>
<span class="-1710279282572635872" onmouseenter="enter('-1710279282572635872');" onmouseout="out('-1710279282572635872');" style=""> 171          mTagView.setTokenizer(new SpaceTokenizer());                                                              </span>
<span class="-905473657518076069" onmouseenter="enter('-905473657518076069');" onmouseout="out('-905473657518076069');" style=""> 172          mTagView.setOnFocusChangeListener(this);                                                                  </span>
<span  style=""> 173                                                                                                                    </span>
<span class="6080374810605667863" onmouseenter="enter('6080374810605667863');" onmouseout="out('6080374810605667863');" style=""> 174          mHighlighter = new MatchOffsetHighlighter(mMatchHighlighter, mContentEditText);                           </span>
<span  style=""> 175                                                                                                                    </span>
<span class="8838498328861850169" onmouseenter="enter('8838498328861850169');" onmouseout="out('8838498328861850169');" style=""> 176          mPinButton = (ToggleButton) rootView.findViewById(R.id.pinButton);                                        </span>
<span class="-6233419192957625397" onmouseenter="enter('-6233419192957625397');" onmouseout="out('-6233419192957625397');" style=""> 177          mPinButton.setOnClickListener(new View.OnClickListener() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 178              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 179              public void onClick(View v) {                                                                         </span>
<span class="-1510302136918940941" onmouseenter="enter('-1510302136918940941');" onmouseout="out('-1510302136918940941');" style=""> 180                  if (mPinButton.isChecked()) {                                                                     </span>
<span class="-7637598965692605019" onmouseenter="enter('-7637598965692605019');" onmouseout="out('-7637598965692605019');" style=""> 181                      // Friendly message to the user as to what this button does.                                  </span>
<span class="5938443200552047425" onmouseenter="enter('5938443200552047425');" onmouseout="out('5938443200552047425');" style=""> 182                      Toast.makeText(getActivity(), R.string.note_pinned, Toast.LENGTH_SHORT).show();               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 185          });                                                                                                       </span>
<span  style=""> 186                                                                                                                    </span>
<span class="-3806018576171196544" onmouseenter="enter('-3806018576171196544');" onmouseout="out('-3806018576171196544');" style=""> 187          mPlaceholderView = (LinearLayout) rootView.findViewById(R.id.placeholder);                                </span>
<span class="8670904764944796201" onmouseenter="enter('8670904764944796201');" onmouseout="out('8670904764944796201');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 188 -        if ((getActivity() instanceof NotesActivity) &amp;&amp; ((NotesActivity) getActivity()).isLargeScreenLandscape() &amp;&amp; mNote == null)"> 188 -        if ((getActivity() instanceof NotesActivity) &amp;&amp; ((NotesActivity) getActivity()).isLargeScreenLandscape() &amp;ðŸ”µ</abbr></span>
<span class="2017772049978674307" onmouseenter="enter('2017772049978674307');" onmouseout="out('2017772049978674307');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +        if (DisplayUtils.isLargeLandscape(getActivity()) &amp;&amp; mNote == null) {                                      </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 190              mPlaceholderView.setVisibility(View.VISIBLE);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +        }                                                                                                         </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-8386469275367064070" onmouseenter="enter('-8386469275367064070');" onmouseout="out('-8386469275367064070');" style=""> 193          mTagView.setAdapter(mAutocompleteAdapter);                                                                </span>
<span  style=""> 194                                                                                                                    </span>
<span class="592168733134676120" onmouseenter="enter('592168733134676120');" onmouseout="out('592168733134676120');" style=""> 195          // Load note if we were passed a note Id                                                                  </span>
<span class="-512438581163180757" onmouseenter="enter('-512438581163180757');" onmouseout="out('-512438581163180757');" style=""> 196          Bundle arguments = getArguments();                                                                        </span>
<span class="5652609996770636291" onmouseenter="enter('5652609996770636291');" onmouseout="out('5652609996770636291');" style=""> 197          if (arguments != null &amp;&amp; arguments.containsKey(ARG_ITEM_ID)) {                                            </span>
<span class="-30854459346766710" onmouseenter="enter('-30854459346766710');" onmouseout="out('-30854459346766710');" style=""> 198              String key = arguments.getString(ARG_ITEM_ID);                                                        </span>
<span class="9138949033848867696" onmouseenter="enter('9138949033848867696');" onmouseout="out('9138949033848867696');" style=""> 199              if (arguments.containsKey(ARG_MATCH_OFFSETS)) {                                                       </span>
<span class="-1831707694683903303" onmouseenter="enter('-1831707694683903303');" onmouseout="out('-1831707694683903303');" style=""> 200                  mMatchOffsets = arguments.getString(ARG_MATCH_OFFSETS);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201              }                                                                                                     </span>
<span class="-3890643464976908836" onmouseenter="enter('-3890643464976908836');" onmouseout="out('-3890643464976908836');" style=""> 202              new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, key);                            </span>
<span class="-4954549700347163589" onmouseenter="enter('-4954549700347163589');" onmouseout="out('-4954549700347163589');" style=""> 203              setIsNewNote(getArguments().getBoolean(ARG_NEW_NOTE, false));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204          }                                                                                                         </span>
<span  style=""> 205                                                                                                                    </span>
<span class="4654908577906893139" onmouseenter="enter('4654908577906893139');" onmouseout="out('4654908577906893139');" style=""> 206  		return rootView;                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207  	}                                                                                                                </span>
<span  style=""> 208                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 209      @Override                                                                                                     </span>
<span class="3212580988936830895" onmouseenter="enter('3212580988936830895');" onmouseout="out('3212580988936830895');" style=""> 210      public void onResume() {                                                                                      </span>
<span class="-6840488528374549322" onmouseenter="enter('-6840488528374549322');" onmouseout="out('-6840488528374549322');" style=""> 211          super.onResume();                                                                                         </span>
<span class="-295722270474880574" onmouseenter="enter('-295722270474880574');" onmouseout="out('-295722270474880574');" style=""> 212          mNotesBucket.start();                                                                                     </span>
<span class="8320491026461558488" onmouseenter="enter('8320491026461558488');" onmouseout="out('8320491026461558488');" style=""> 213          mNotesBucket.addListener(this);                                                                           </span>
<span  style=""> 214                                                                                                                    </span>
<span class="2283760307260285965" onmouseenter="enter('2283760307260285965');" onmouseout="out('2283760307260285965');" style=""> 215          mTagView.setOnTagAddedListener(this);                                                                     </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216      }                                                                                                             </span>
<span  style=""> 217                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 218      @Override                                                                                                     </span>
<span class="3108783673391190151" onmouseenter="enter('3108783673391190151');" onmouseout="out('3108783673391190151');" style=""> 219      public void onPause() {                                                                                       </span>
<span class="-1649552973291504175" onmouseenter="enter('-1649552973291504175');" onmouseout="out('-1649552973291504175');" style=""> 220          mNotesBucket.removeListener(this);                                                                        </span>
<span class="-4286062678685908757" onmouseenter="enter('-4286062678685908757');" onmouseout="out('-4286062678685908757');" style=""> 221          // Hide soft keyboard if it is showing...                                                                 </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 222          if (getActivity() != null) {                                                                              </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 223              InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 223              InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INðŸ”µ</abbr></span>
<span class="-9213036537020298306" onmouseenter="enter('-9213036537020298306');" onmouseout="out('-9213036537020298306');" style=""> 224              if (inputMethodManager != null) {                                                                     </span>
<span class="159022051514418479" onmouseenter="enter('159022051514418479');" onmouseout="out('159022051514418479');" style=""> 225                  inputMethodManager.hideSoftInputFromWindow(mContentEditText.getWindowToken(), 0);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227          }                                                                                                         </span>
<span  style=""> 228                                                                                                                    </span>
<span class="-2832208055092409078" onmouseenter="enter('-2832208055092409078');" onmouseout="out('-2832208055092409078');" style=""> 229          // Delete the note if it is new and has empty fields                                                      </span>
<span class="-2219905285758853631" onmouseenter="enter('-2219905285758853631');" onmouseout="out('-2219905285758853631');" style=""> 230          if (mNote != null &amp;&amp; mIsNewNote &amp;&amp; noteIsEmpty()) {                                                       </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 231              mNote.delete();                                                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 232          } else {                                                                                                  </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 233              saveNote();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234          }                                                                                                         </span>
<span  style=""> 235                                                                                                                    </span>
<span class="-5824468190651999684" onmouseenter="enter('-5824468190651999684');" onmouseout="out('-5824468190651999684');" style=""> 236          mTagView.setOnTagAddedListener(null);                                                                     </span>
<span  style=""> 237                                                                                                                    </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 238          if (mAutoSaveHandler != null) {                                                                           </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 239              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240          }                                                                                                         </span>
<span  style=""> 241                                                                                                                    </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 242          if (mPublishTimeoutHandler != null) {                                                                     </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 243              mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244          }                                                                                                         </span>
<span  style=""> 245                                                                                                                    </span>
<span class="212618759798230270" onmouseenter="enter('212618759798230270');" onmouseout="out('212618759798230270');" style=""> 246          mHighlighter.stop();                                                                                      </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-7508449912261312872" onmouseenter="enter('-7508449912261312872');" onmouseout="out('-7508449912261312872');" style=""> 248          super.onPause();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249      }                                                                                                             </span>
<span  style=""> 250                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 251      @Override                                                                                                     </span>
<span class="-6208734081302594375" onmouseenter="enter('-6208734081302594375');" onmouseout="out('-6208734081302594375');" style=""> 252      public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {                                           </span>
<span class="-5591635883999644357" onmouseenter="enter('-5591635883999644357');" onmouseout="out('-5591635883999644357');" style=""> 253          inflater.inflate(R.menu.note_editor, menu);                                                               </span>
<span  style=""> 254                                                                                                                    </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 255          if (mNote != null) {                                                                                      </span>
<span class="3411369858029698957" onmouseenter="enter('3411369858029698957');" onmouseout="out('3411369858029698957');" style=""> 256              MenuItem viewPublishedNoteItem = menu.findItem(R.id.menu_view_info);                                  </span>
<span class="-2499359923625437976" onmouseenter="enter('-2499359923625437976');" onmouseout="out('-2499359923625437976');" style=""> 257              viewPublishedNoteItem.setVisible(true);                                                               </span>
<span  style=""> 258                                                                                                                    </span>
<span class="7674470390729338414" onmouseenter="enter('7674470390729338414');" onmouseout="out('7674470390729338414');" style=""> 259              MenuItem trashItem = menu.findItem(R.id.menu_delete).setTitle(R.string.undelete);                     </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 260              if (mNote.isDeleted())                                                                                </span>
<span class="2395244797129247894" onmouseenter="enter('2395244797129247894');" onmouseout="out('2395244797129247894');" style=""> 261                  trashItem.setTitle(R.string.undelete);                                                            </span>
<span class="-7436048164614400339" onmouseenter="enter('-7436048164614400339');" onmouseout="out('-7436048164614400339');" style=""> 262              else                                                                                                  </span>
<span class="-2747782095374702281" onmouseenter="enter('-2747782095374702281');" onmouseout="out('-2747782095374702281');" style=""> 263                  trashItem.setTitle(R.string.delete);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span  style=""> 265                                                                                                                    </span>
<span class="5772887857065615623" onmouseenter="enter('5772887857065615623');" onmouseout="out('5772887857065615623');" style=""> 266          super.onCreateOptionsMenu(menu, inflater);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267      }                                                                                                             </span>
<span  style=""> 268                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 269      @Override                                                                                                     </span>
<span class="8334131658156286818" onmouseenter="enter('8334131658156286818');" onmouseout="out('8334131658156286818');" style=""> 270      public boolean onOptionsItemSelected(MenuItem item) {                                                         </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 271          switch (item.getItemId()) {                                                                               </span>
<span class="-3574644309369097250" onmouseenter="enter('-3574644309369097250');" onmouseout="out('-3574644309369097250');" style=""> 272              case R.id.menu_view_info:                                                                             </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 273                  if (mNote != null) {                                                                              </span>
<span class="-5974815457760504487" onmouseenter="enter('-5974815457760504487');" onmouseout="out('-5974815457760504487');" style=""> 274                      View menuItemView = getActivity().findViewById(R.id.menu_view_info);                          </span>
<span class="2497222703395221844" onmouseenter="enter('2497222703395221844');" onmouseout="out('2497222703395221844');" style=""> 275                      showInfoPopup(menuItemView);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276                  }                                                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 277                  return true;                                                                                      </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 278              case R.id.menu_share:                                                                                 </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 279                  if (mNote != null) {                                                                              </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 280                      Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                          </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 281                      shareIntent.setType(&quot;text/plain&quot;);                                                            </span>
<span class="2565640458837084796" onmouseenter="enter('2565640458837084796');" onmouseout="out('2565640458837084796');" style=""> 282                      shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mNote.getContent());                  </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 283                      startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 283                      startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note))ðŸ”µ</abbr></span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 284                      mTracker.send(                                                                                </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 285                              new HitBuilders.EventBuilder()                                                        </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 286                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="2679386718058736721" onmouseenter="enter('2679386718058736721');" onmouseout="out('2679386718058736721');" style=""> 287                              .setAction(&quot;shared_note&quot;)                                                             </span>
<span class="-1410195237862732008" onmouseenter="enter('-1410195237862732008');" onmouseout="out('-1410195237862732008');" style=""> 288                              .setLabel(&quot;action_bar_share_button&quot;)                                                  </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 289                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 290                      );                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291                  }                                                                                                 </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 292                  return true;                                                                                      </span>
<span class="6443133868746637198" onmouseenter="enter('6443133868746637198');" onmouseout="out('6443133868746637198');" style=""> 293              case R.id.menu_delete:                                                                                </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 294                  if (mNote != null) {                                                                              </span>
<span class="-929724925513034279" onmouseenter="enter('-929724925513034279');" onmouseout="out('-929724925513034279');" style=""> 295                      mNote.setDeleted(!mNote.isDeleted());                                                         </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 296                      mNote.setModificationDate(Calendar.getInstance());                                            </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 297                      mNote.save();                                                                                 </span>
<span class="-8654137458864067059" onmouseenter="enter('-8654137458864067059');" onmouseout="out('-8654137458864067059');" style=""> 298                      Intent resultIntent = new Intent();                                                           </span>
<span class="-2276441912091728676" onmouseenter="enter('-2276441912091728676');" onmouseout="out('-2276441912091728676');" style=""> 299                      if (mNote.isDeleted())                                                                        </span>
<span class="-4555570864561374481" onmouseenter="enter('-4555570864561374481');" onmouseout="out('-4555570864561374481');" style=""> 300                          resultIntent.putExtra(Simplenote.DELETED_NOTE_ID, mNote.getSimperiumKey());               </span>
<span class="2925812847088143790" onmouseenter="enter('2925812847088143790');" onmouseout="out('2925812847088143790');" style=""> 301                      getActivity().setResult(Activity.RESULT_OK, resultIntent);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302                  }                                                                                                 </span>
<span class="2776709281245151825" onmouseenter="enter('2776709281245151825');" onmouseout="out('2776709281245151825');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -                getActivity().finish();                                                                           </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 304 +                                                                                                                  </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +                ActivityCompat.finishAfterTransition(getActivity());                                              </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 306                  return true;                                                                                      </span>
<span class="4538874991877816092" onmouseenter="enter('4538874991877816092');" onmouseout="out('4538874991877816092');" style=""> 307              case android.R.id.home:                                                                               </span>
<span class="2776709281245151825" onmouseenter="enter('2776709281245151825');" onmouseout="out('2776709281245151825');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                getActivity().finish();                                                                           </span>
<span class="7129378594490139747" onmouseenter="enter('7129378594490139747');" onmouseout="out('7129378594490139747');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +                ActivityCompat.finishAfterTransition(getActivity());                                              </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 310                  return true;                                                                                      </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 311              default:                                                                                              </span>
<span class="-3863613010288750787" onmouseenter="enter('-3863613010288750787');" onmouseout="out('-3863613010288750787');" style=""> 312                  return super.onOptionsItemSelected(item);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314      }                                                                                                             </span>
<span  style=""> 315                                                                                                                    </span>
<span class="8271468180839847847" onmouseenter="enter('8271468180839847847');" onmouseout="out('8271468180839847847');" style=""> 316      // show a popup view from the info action bar item                                                            </span>
<span class="301694884727727095" onmouseenter="enter('301694884727727095');" onmouseout="out('301694884727727095');" style=""> 317      private void showInfoPopup(View view) {                                                                       </span>
<span class="-8824124309160747557" onmouseenter="enter('-8824124309160747557');" onmouseout="out('-8824124309160747557');" style=""> 318          if (!isAdded() || view == null) return;                                                                   </span>
<span  style=""> 319                                                                                                                    </span>
<span class="-6163322818153177863" onmouseenter="enter('-6163322818153177863');" onmouseout="out('-6163322818153177863');" style=""> 320          if (mInfoPopupWindow == null) {                                                                           </span>
<span class="6416634994496998699" onmouseenter="enter('6416634994496998699');" onmouseout="out('6416634994496998699');" style=""> 321              mInfoPopupWindow = new PopupWindow(getActivity());                                                    </span>
<span class="-7704183450622301834" onmouseenter="enter('-7704183450622301834');" onmouseout="out('-7704183450622301834');" style=""> 322              mInfoPopupWindow.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);                                   </span>
<span class="-3987029803100381492" onmouseenter="enter('-3987029803100381492');" onmouseout="out('-3987029803100381492');" style=""> 323              mInfoPopupWindow.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);                                  </span>
<span class="-8327124619089985465" onmouseenter="enter('-8327124619089985465');" onmouseout="out('-8327124619089985465');" style=""> 324              mInfoPopupWindow.setBackgroundDrawable(new ColorDrawable(0));                                         </span>
<span class="3466073935356821559" onmouseenter="enter('3466073935356821559');" onmouseout="out('3466073935356821559');" style=""> 325              mInfoPopupWindow.setOutsideTouchable(true);                                                           </span>
<span class="-1875471742113799055" onmouseenter="enter('-1875471742113799055');" onmouseout="out('-1875471742113799055');" style=""> 326              mInfoPopupWindow.setFocusable(true);                                                                  </span>
<span  style=""> 327                                                                                                                    </span>
<span class="5212568524712573915" onmouseenter="enter('5212568524712573915');" onmouseout="out('5212568524712573915');" style=""> 328              LayoutInflater inflater = LayoutInflater.from(getActivity());                                         </span>
<span class="-7758049233010801507" onmouseenter="enter('-7758049233010801507');" onmouseout="out('-7758049233010801507');" style=""> 329              View popupView = inflater.inflate(R.layout.popup_info, null);                                         </span>
<span class="536077715701124131" onmouseenter="enter('536077715701124131');" onmouseout="out('536077715701124131');" style=""> 330              mInfoPopupWindow.setContentView(popupView);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331          }                                                                                                         </span>
<span  style=""> 332                                                                                                                    </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 333          updateInfoPopup();                                                                                        </span>
<span  style=""> 334                                                                                                                    </span>
<span class="4487253113225225144" onmouseenter="enter('4487253113225225144');" onmouseout="out('4487253113225225144');" style=""> 335          mInfoPopupWindow.showAsDropDown(view);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336      }                                                                                                             </span>
<span  style=""> 337                                                                                                                    </span>
<span class="-8758077771583595367" onmouseenter="enter('-8758077771583595367');" onmouseout="out('-8758077771583595367');" style=""> 338      // update the content of the popupview                                                                        </span>
<span class="-7181846678873590508" onmouseenter="enter('-7181846678873590508');" onmouseout="out('-7181846678873590508');" style=""> 339      private void updateInfoPopup() {                                                                              </span>
<span class="-8697403400729029020" onmouseenter="enter('-8697403400729029020');" onmouseout="out('-8697403400729029020');" style=""> 340          if (mInfoPopupWindow == null || mInfoPopupWindow.getContentView() == null) return;                        </span>
<span  style=""> 341                                                                                                                    </span>
<span class="3837773520867540996" onmouseenter="enter('3837773520867540996');" onmouseout="out('3837773520867540996');" style=""> 342          View popupView = mInfoPopupWindow.getContentView();                                                       </span>
<span  style=""> 343                                                                                                                    </span>
<span class="-5563348291777194716" onmouseenter="enter('-5563348291777194716');" onmouseout="out('-5563348291777194716');" style=""> 344          View publishButton = popupView.findViewById(R.id.publish_note_button);                                    </span>
<span class="4581310412057978293" onmouseenter="enter('4581310412057978293');" onmouseout="out('4581310412057978293');" style=""> 345          TextView publishButtonTextView = (TextView)popupView.findViewById(R.id.publish_note_button_text);         </span>
<span class="-6410915739065156574" onmouseenter="enter('-6410915739065156574');" onmouseout="out('-6410915739065156574');" style=""> 346          ImageView publishButtonIcon = (ImageView)popupView.findViewById(R.id.publish_note_button_icon);           </span>
<span class="-6918482493044946592" onmouseenter="enter('-6918482493044946592');" onmouseout="out('-6918482493044946592');" style=""> 347          TextView publishTextView = (TextView) popupView.findViewById(R.id.publish_url_textview);                  </span>
<span class="1038347291336054559" onmouseenter="enter('1038347291336054559');" onmouseout="out('1038347291336054559');" style=""> 348          TextView wordCountTextView = (TextView) popupView.findViewById(R.id.word_count);                          </span>
<span class="-7977646551049898553" onmouseenter="enter('-7977646551049898553');" onmouseout="out('-7977646551049898553');" style=""> 349          ImageButton publishCopyButton = (ImageButton) popupView.findViewById(R.id.publish_copy_url);              </span>
<span class="7101383467626352915" onmouseenter="enter('7101383467626352915');" onmouseout="out('7101383467626352915');" style=""> 350          ImageButton publishShareButton = (ImageButton) popupView.findViewById(R.id.publish_share_url);            </span>
<span class="3150325744662714786" onmouseenter="enter('3150325744662714786');" onmouseout="out('3150325744662714786');" style=""> 351          View actionsView = popupView.findViewById(R.id.publish_actions);                                          </span>
<span  style=""> 352                                                                                                                    </span>
<span class="1432622249676412210" onmouseenter="enter('1432622249676412210');" onmouseout="out('1432622249676412210');" style=""> 353          final ViewSwitcher viewSwitcher = (ViewSwitcher) popupView.findViewById(R.id.publish_view_switcher);      </span>
<span  style=""> 354                                                                                                                    </span>
<span class="-7759606836018483289" onmouseenter="enter('-7759606836018483289');" onmouseout="out('-7759606836018483289');" style=""> 355          publishButton.setOnClickListener(new View.OnClickListener() {                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 356              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 357              public void onClick(View v) {                                                                         </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 358                  if (mNote != null) {                                                                              </span>
<span class="5563864695602119989" onmouseenter="enter('5563864695602119989');" onmouseout="out('5563864695602119989');" style=""> 359                      boolean newPublishedStatus = !mNote.isPublished();                                            </span>
<span class="-3191807331109519265" onmouseenter="enter('-3191807331109519265');" onmouseout="out('-3191807331109519265');" style=""> 360                      mNote.setPublished(newPublishedStatus);                                                       </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 361                      mNote.save();                                                                                 </span>
<span  style=""> 362                                                                                                                    </span>
<span class="-6566894946886815467" onmouseenter="enter('-6566894946886815467');" onmouseout="out('-6566894946886815467');" style=""> 363                      if (viewSwitcher.getDisplayedChild() == 0) {                                                  </span>
<span class="1964540099195163034" onmouseenter="enter('1964540099195163034');" onmouseout="out('1964540099195163034');" style=""> 364                          viewSwitcher.showNext();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365                      }                                                                                             </span>
<span  style=""> 366                                                                                                                    </span>
<span class="3198515589608942377" onmouseenter="enter('3198515589608942377');" onmouseout="out('3198515589608942377');" style=""> 367                      // reset publish status in 20 seconds if we don&#x27;t hear back from Simperium                    </span>
<span class="-4829904289357833951" onmouseenter="enter('-4829904289357833951');" onmouseout="out('-4829904289357833951');" style=""> 368                      mPublishTimeoutHandler.postDelayed(mPublishTimeoutRunnable, 20000);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 371          });                                                                                                       </span>
<span  style=""> 372                                                                                                                    </span>
<span class="4045844893437359317" onmouseenter="enter('4045844893437359317');" onmouseout="out('4045844893437359317');" style=""> 373          publishTextView.setOnClickListener(new View.OnClickListener() {                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 374              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 375              public void onClick(View v) {                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 376                  try {                                                                                             </span>
<span class="-8142976939479350202" onmouseenter="enter('-8142976939479350202');" onmouseout="out('-8142976939479350202');" style=""> 377                      startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(mNote.getPublishedUrl())));            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 378                  } catch (Exception e) {                                                                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 379                      e.printStackTrace();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 382          });                                                                                                       </span>
<span  style=""> 383                                                                                                                    </span>
<span class="-6950650320634084190" onmouseenter="enter('-6950650320634084190');" onmouseout="out('-6950650320634084190');" style=""> 384          publishCopyButton.setOnClickListener(new View.OnClickListener() {                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 385              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 386              public void onClick(View v) {                                                                         </span>
<span class="4796955211675373396" onmouseenter="enter('4796955211675373396');" onmouseout="out('4796955211675373396');" style=""><abbr title=" 387                  ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 387                  ClipboardManager clipboard = (ClipboardManager) getActivity().getSystemService(Context.CLIPBOARD_SðŸ”µ</abbr></span>
<span class="-7278433972965562810" onmouseenter="enter('-7278433972965562810');" onmouseout="out('-7278433972965562810');" style=""> 388                  ClipData clip = ClipData.newPlainText(getString(R.string.app_name), mNote.getPublishedUrl());     </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 389                  clipboard.setPrimaryClip(clip);                                                                   </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""> 390                  Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 392          });                                                                                                       </span>
<span  style=""> 393                                                                                                                    </span>
<span class="7858974346508965340" onmouseenter="enter('7858974346508965340');" onmouseout="out('7858974346508965340');" style=""> 394          publishShareButton.setOnClickListener(new View.OnClickListener() {                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 395              @Override                                                                                             </span>
<span class="-6587489291029443051" onmouseenter="enter('-6587489291029443051');" onmouseout="out('-6587489291029443051');" style=""> 396              public void onClick(View v) {                                                                         </span>
<span class="-1084258541936962831" onmouseenter="enter('-1084258541936962831');" onmouseout="out('-1084258541936962831');" style=""> 397                  Intent i = new Intent(Intent.ACTION_SEND);                                                        </span>
<span class="-4820203166518762252" onmouseenter="enter('-4820203166518762252');" onmouseout="out('-4820203166518762252');" style=""> 398                  i.setType(&quot;text/plain&quot;);                                                                          </span>
<span class="-6000923337939610903" onmouseenter="enter('-6000923337939610903');" onmouseout="out('-6000923337939610903');" style=""> 399                  i.putExtra(Intent.EXTRA_TEXT, mNote.getPublishedUrl());                                           </span>
<span class="3733331565586339944" onmouseenter="enter('3733331565586339944');" onmouseout="out('3733331565586339944');" style=""> 400                  startActivity(Intent.createChooser(i, getString(R.string.share_url)));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 402          });                                                                                                       </span>
<span  style=""> 403                                                                                                                    </span>
<span class="-2067876314787213528" onmouseenter="enter('-2067876314787213528');" onmouseout="out('-2067876314787213528');" style=""> 404          updateWordCount(wordCountTextView);                                                                       </span>
<span  style=""> 405                                                                                                                    </span>
<span class="-1365615346790030662" onmouseenter="enter('-1365615346790030662');" onmouseout="out('-1365615346790030662');" style=""> 406          if (mNote.isPublished()) {                                                                                </span>
<span class="-8174565940676304202" onmouseenter="enter('-8174565940676304202');" onmouseout="out('-8174565940676304202');" style=""> 407              publishButtonTextView.setText(getString(R.string.published));                                         </span>
<span class="8297531220637406295" onmouseenter="enter('8297531220637406295');" onmouseout="out('8297531220637406295');" style=""> 408              publishButtonIcon.setVisibility(View.VISIBLE);                                                        </span>
<span class="-2988513566372186325" onmouseenter="enter('-2988513566372186325');" onmouseout="out('-2988513566372186325');" style=""> 409              publishTextView.setText(mNote.getPublishedUrl());                                                     </span>
<span class="6413899042811805294" onmouseenter="enter('6413899042811805294');" onmouseout="out('6413899042811805294');" style=""> 410              actionsView.setVisibility(View.VISIBLE);                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 411          } else {                                                                                                  </span>
<span class="843719504642786212" onmouseenter="enter('843719504642786212');" onmouseout="out('843719504642786212');" style=""> 412              publishButtonTextView.setText(getString(R.string.publish));                                           </span>
<span class="-2250731724671553485" onmouseenter="enter('-2250731724671553485');" onmouseout="out('-2250731724671553485');" style=""> 413              publishButtonIcon.setVisibility(View.GONE);                                                           </span>
<span class="1035970444036754268" onmouseenter="enter('1035970444036754268');" onmouseout="out('1035970444036754268');" style=""> 414              actionsView.setVisibility(View.GONE);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415          }                                                                                                         </span>
<span  style=""> 416                                                                                                                    </span>
<span class="-6431499321301904544" onmouseenter="enter('-6431499321301904544');" onmouseout="out('-6431499321301904544');" style=""> 417          Simplenote currentApp = (Simplenote) getActivity().getApplication();                                      </span>
<span class="-1805411858302537149" onmouseenter="enter('-1805411858302537149');" onmouseout="out('-1805411858302537149');" style=""> 418          if (currentApp.getSimperium().needsAuthorization()) {                                                     </span>
<span class="5338357254244494547" onmouseenter="enter('5338357254244494547');" onmouseout="out('5338357254244494547');" style=""> 419              viewSwitcher.setVisibility(View.GONE);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 420          } else {                                                                                                  </span>
<span class="4598892846854382425" onmouseenter="enter('4598892846854382425');" onmouseout="out('4598892846854382425');" style=""> 421              viewSwitcher.setVisibility(View.VISIBLE);                                                             </span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 422              if (viewSwitcher.getDisplayedChild() == 1) {                                                          </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 423                  viewSwitcher.showPrevious();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426      }                                                                                                             </span>
<span  style=""> 427                                                                                                                    </span>
<span class="2878966018694925493" onmouseenter="enter('2878966018694925493');" onmouseout="out('2878966018694925493');" style=""> 428      private boolean noteIsEmpty() {                                                                               </span>
<span class="5142306291108152313" onmouseenter="enter('5142306291108152313');" onmouseout="out('5142306291108152313');" style=""> 429          return (getNoteContentString().trim().length() == 0 &amp;&amp; getNoteTagsString().trim().length() == 0);         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430      }                                                                                                             </span>
<span  style=""> 431                                                                                                                    </span>
<span class="8710628914141899315" onmouseenter="enter('8710628914141899315');" onmouseout="out('8710628914141899315');" style=""> 432      public void setNote(String noteID){                                                                           </span>
<span class="-6972394152055286124" onmouseenter="enter('-6972394152055286124');" onmouseout="out('-6972394152055286124');" style=""> 433          setNote(noteID, null);                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434      }                                                                                                             </span>
<span  style=""> 435                                                                                                                    </span>
<span class="8195105300246755684" onmouseenter="enter('8195105300246755684');" onmouseout="out('8195105300246755684');" style=""> 436      public void setNote(String noteID, String matchOffsets) {                                                     </span>
<span class="-3646372507164546123" onmouseenter="enter('-3646372507164546123');" onmouseout="out('-3646372507164546123');" style=""> 437          if (mAutoSaveHandler != null)                                                                             </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 438              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span  style=""> 439                                                                                                                    </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 440          mPlaceholderView.setVisibility(View.GONE);                                                                </span>
<span  style=""> 441                                                                                                                    </span>
<span class="2077738191995360697" onmouseenter="enter('2077738191995360697');" onmouseout="out('2077738191995360697');" style=""> 442          if (matchOffsets != null)                                                                                 </span>
<span class="76822769413740338" onmouseenter="enter('76822769413740338');" onmouseout="out('76822769413740338');" style=""> 443              mMatchOffsets = matchOffsets;                                                                         </span>
<span  style=""> 444                                                                                                                    </span>
<span class="-4019470309104916899" onmouseenter="enter('-4019470309104916899');" onmouseout="out('-4019470309104916899');" style=""> 445          // If we have a note already (on a tablet in landscape), save the note.                                   </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 446          if (mNote != null) {                                                                                      </span>
<span class="4900947620417658692" onmouseenter="enter('4900947620417658692');" onmouseout="out('4900947620417658692');" style=""> 447              if (mIsNewNote &amp;&amp; noteIsEmpty())                                                                      </span>
<span class="-3796820634556305720" onmouseenter="enter('-3796820634556305720');" onmouseout="out('-3796820634556305720');" style=""> 448                  mNote.delete();                                                                                   </span>
<span class="-2440894158330100228" onmouseenter="enter('-2440894158330100228');" onmouseout="out('-2440894158330100228');" style=""> 449              else if (mNote != null)                                                                               </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 450                  saveNote();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 451          }                                                                                                         </span>
<span  style=""> 452                                                                                                                    </span>
<span class="-3492920802008394842" onmouseenter="enter('-3492920802008394842');" onmouseout="out('-3492920802008394842');" style=""> 453          new loadNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, noteID);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454      }                                                                                                             </span>
<span  style=""> 455                                                                                                                    </span>
<span class="-3433185850424102984" onmouseenter="enter('-3433185850424102984');" onmouseout="out('-3433185850424102984');" style=""> 456      public void updateNote(Note updatedNote) {                                                                    </span>
<span class="1053945494720623403" onmouseenter="enter('1053945494720623403');" onmouseout="out('1053945494720623403');" style=""> 457          // update note if network change arrived                                                                  </span>
<span class="8715526790189509580" onmouseenter="enter('8715526790189509580');" onmouseout="out('8715526790189509580');" style=""> 458          mNote = updatedNote;                                                                                      </span>
<span class="-1082183570760036139" onmouseenter="enter('-1082183570760036139');" onmouseout="out('-1082183570760036139');" style=""> 459          refreshContent(true);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460      }                                                                                                             </span>
<span  style=""> 461                                                                                                                    </span>
<span class="-5323752859114125708" onmouseenter="enter('-5323752859114125708');" onmouseout="out('-5323752859114125708');" style=""> 462      public void refreshContent(boolean isNoteUpdate) {                                                            </span>
<span class="1654833331703303198" onmouseenter="enter('1654833331703303198');" onmouseout="out('1654833331703303198');" style=""> 463          if (mNote != null) {                                                                                      </span>
<span class="9083634457699551889" onmouseenter="enter('9083634457699551889');" onmouseout="out('9083634457699551889');" style=""> 464              // Restore the cursor position if possible.                                                           </span>
<span  style=""> 465                                                                                                                    </span>
<span class="-3899995221280134201" onmouseenter="enter('-3899995221280134201');" onmouseout="out('-3899995221280134201');" style=""><abbr title=" 466              int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.getSelectionEnd());"> 466              int cursorPosition = newCursorLocation(mNote.getContent(), getNoteContentString(), mContentEditText.geðŸ”µ</abbr></span>
<span  style=""> 467                                                                                                                    </span>
<span class="4148799213240179760" onmouseenter="enter('4148799213240179760');" onmouseout="out('4148799213240179760');" style=""> 468              mContentEditText.setText(mNote.getContent());                                                         </span>
<span  style=""> 469                                                                                                                    </span>
<span class="2353268123342341866" onmouseenter="enter('2353268123342341866');" onmouseout="out('2353268123342341866');" style=""> 470              if (isNoteUpdate) {                                                                                   </span>
<span class="-1678402685678405938" onmouseenter="enter('-1678402685678405938');" onmouseout="out('-1678402685678405938');" style=""> 471                  // Save the note so any local changes get synced                                                  </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 472                  mNote.save();                                                                                     </span>
<span  style=""> 473                                                                                                                    </span>
<span class="-5094013145931261947" onmouseenter="enter('-5094013145931261947');" onmouseout="out('-5094013145931261947');" style=""> 474                  if (mContentEditText.hasFocus() &amp;&amp; cursorPosition != mContentEditText.getSelectionEnd()) {        </span>
<span class="2096054726124109686" onmouseenter="enter('2096054726124109686');" onmouseout="out('2096054726124109686');" style=""> 475                      mContentEditText.setSelection(cursorPosition);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477              }                                                                                                     </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-2853209662220592982" onmouseenter="enter('-2853209662220592982');" onmouseout="out('-2853209662220592982');" style=""> 479              afterTextChanged(mContentEditText.getText());                                                         </span>
<span  style=""> 480                                                                                                                    </span>
<span class="8723833736514346639" onmouseenter="enter('8723833736514346639');" onmouseout="out('8723833736514346639');" style=""> 481              mPinButton.setChecked(mNote.isPinned());                                                              </span>
<span  style=""> 482                                                                                                                    </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 483              updateTagList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485      }                                                                                                             </span>
<span  style=""> 486                                                                                                                    </span>
<span class="-5496131723873966197" onmouseenter="enter('-5496131723873966197');" onmouseout="out('-5496131723873966197');" style=""> 487      public void updateTagList() {                                                                                 </span>
<span class="-5071525869541290984" onmouseenter="enter('-5071525869541290984');" onmouseout="out('-5071525869541290984');" style=""> 488          Activity activity = getActivity();                                                                        </span>
<span class="5732290278551506292" onmouseenter="enter('5732290278551506292');" onmouseout="out('5732290278551506292');" style=""> 489          if (activity == null) return;                                                                             </span>
<span  style=""> 490                                                                                                                    </span>
<span class="-8748481830530330770" onmouseenter="enter('-8748481830530330770');" onmouseout="out('-8748481830530330770');" style=""> 491          // Populate this note&#x27;s tags in the tagView                                                               </span>
<span class="-3805230291902185366" onmouseenter="enter('-3805230291902185366');" onmouseout="out('-3805230291902185366');" style=""> 492          mTagView.setChips(mNote.getTagString());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 493      }                                                                                                             </span>
<span  style=""> 494                                                                                                                    </span>
<span class="-3598917219400102100" onmouseenter="enter('-3598917219400102100');" onmouseout="out('-3598917219400102100');" style=""> 495      int newCursorLocation(String newText, String oldText, int cursorLocation) {                                   </span>
<span class="9215253731107462720" onmouseenter="enter('9215253731107462720');" onmouseout="out('9215253731107462720');" style=""> 496          // Ported from the iOS app :)                                                                             </span>
<span class="746416875920517525" onmouseenter="enter('746416875920517525');" onmouseout="out('746416875920517525');" style=""> 497          // Cases:                                                                                                 </span>
<span class="5532692154938930485" onmouseenter="enter('5532692154938930485');" onmouseout="out('5532692154938930485');" style=""> 498          // 0. All text after cursor (and possibly more) was removed ==&gt; put cursor at end                         </span>
<span class="7679522442911259243" onmouseenter="enter('7679522442911259243');" onmouseout="out('7679522442911259243');" style=""> 499          // 1. Text was added after the cursor ==&gt; no change                                                       </span>
<span class="-7894032746042607578" onmouseenter="enter('-7894032746042607578');" onmouseout="out('-7894032746042607578');" style=""> 500          // 2. Text was added before the cursor ==&gt; location advances                                              </span>
<span class="-2716138352653500367" onmouseenter="enter('-2716138352653500367');" onmouseout="out('-2716138352653500367');" style=""> 501          // 3. Text was removed after the cursor ==&gt; no change                                                     </span>
<span class="-5135222146548415418" onmouseenter="enter('-5135222146548415418');" onmouseout="out('-5135222146548415418');" style=""> 502          // 4. Text was removed before the cursor ==&gt; location retreats                                            </span>
<span class="-7558810491072030947" onmouseenter="enter('-7558810491072030947');" onmouseout="out('-7558810491072030947');" style=""> 503          // 5. Text was added/removed on both sides of the cursor ==&gt; not handled                                  </span>
<span  style=""> 504                                                                                                                    </span>
<span class="2494517364842646163" onmouseenter="enter('2494517364842646163');" onmouseout="out('2494517364842646163');" style=""> 505          int newCursorLocation = cursorLocation;                                                                   </span>
<span  style=""> 506                                                                                                                    </span>
<span class="5908042661332565473" onmouseenter="enter('5908042661332565473');" onmouseout="out('5908042661332565473');" style=""> 507          int deltaLength = newText.length() - oldText.length();                                                    </span>
<span  style=""> 508                                                                                                                    </span>
<span class="-6285488792309831531" onmouseenter="enter('-6285488792309831531');" onmouseout="out('-6285488792309831531');" style=""> 509          // Case 0                                                                                                 </span>
<span class="-3414403190560247865" onmouseenter="enter('-3414403190560247865');" onmouseout="out('-3414403190560247865');" style=""> 510          if (newText.length() &lt; cursorLocation)                                                                    </span>
<span class="-8431314608568195365" onmouseenter="enter('-8431314608568195365');" onmouseout="out('-8431314608568195365');" style=""> 511              return newText.length();                                                                              </span>
<span  style=""> 512                                                                                                                    </span>
<span class="-8591384106259708496" onmouseenter="enter('-8591384106259708496');" onmouseout="out('-8591384106259708496');" style=""> 513          boolean beforeCursorMatches = false;                                                                      </span>
<span class="-2836779116340504068" onmouseenter="enter('-2836779116340504068');" onmouseout="out('-2836779116340504068');" style=""> 514          boolean afterCursorMatches = false;                                                                       </span>
<span  style=""> 515                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 516          try {                                                                                                     </span>
<span class="535177221055952012" onmouseenter="enter('535177221055952012');" onmouseout="out('535177221055952012');" style=""><abbr title=" 517              beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation));"> 517              beforeCursorMatches = oldText.substring(0, cursorLocation).equals(newText.substring(0, cursorLocation)ðŸ”µ</abbr></span>
<span class="-6954326744185480821" onmouseenter="enter('-6954326744185480821');" onmouseout="out('-6954326744185480821');" style=""><abbr title=" 518              afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursorLocation + deltaLength, newText.length()));"> 518              afterCursorMatches = oldText.substring(cursorLocation, oldText.length()).equals(newText.substring(cursðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 519          } catch (Exception e) {                                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 520              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521          }                                                                                                         </span>
<span  style=""> 522                                                                                                                    </span>
<span class="-8188204612528872149" onmouseenter="enter('-8188204612528872149');" onmouseout="out('-8188204612528872149');" style=""> 523          // Cases 2 and 4                                                                                          </span>
<span class="6616414540674367624" onmouseenter="enter('6616414540674367624');" onmouseout="out('6616414540674367624');" style=""> 524          if (!beforeCursorMatches &amp;&amp; afterCursorMatches)                                                           </span>
<span class="-4510977125628343614" onmouseenter="enter('-4510977125628343614');" onmouseout="out('-4510977125628343614');" style=""> 525              newCursorLocation += deltaLength;                                                                     </span>
<span  style=""> 526                                                                                                                    </span>
<span class="6867115481875645839" onmouseenter="enter('6867115481875645839');" onmouseout="out('6867115481875645839');" style=""> 527          // Cases 1, 3 and 5 have no change                                                                        </span>
<span class="-7784410696724573059" onmouseenter="enter('-7784410696724573059');" onmouseout="out('-7784410696724573059');" style=""> 528          return newCursorLocation;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 529      }                                                                                                             </span>
<span  style=""> 530                                                                                                                    </span>
<span class="-4880079435078668080" onmouseenter="enter('-4880079435078668080');" onmouseout="out('-4880079435078668080');" style=""> 531      private Runnable mAutoSaveRunnable = new Runnable() {                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 532          @Override                                                                                                 </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 533          public void run() {                                                                                       </span>
<span class="-2186856349666885424" onmouseenter="enter('-2186856349666885424');" onmouseout="out('-2186856349666885424');" style=""> 534              saveAndSyncNote();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 536      };                                                                                                            </span>
<span  style=""> 537                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 538      @Override                                                                                                     </span>
<span class="-2796122281296135687" onmouseenter="enter('-2796122281296135687');" onmouseout="out('-2796122281296135687');" style=""> 539      public void onTagsChanged(String tagString) {                                                                 </span>
<span class="5357705753761437027" onmouseenter="enter('5357705753761437027');" onmouseout="out('5357705753761437027');" style=""> 540          if (mNote == null || !isAdded()) return;                                                                  </span>
<span  style=""> 541                                                                                                                    </span>
<span class="-6077287130430406243" onmouseenter="enter('-6077287130430406243');" onmouseout="out('-6077287130430406243');" style=""> 542          if (mNote.getTagString() != null &amp;&amp; tagString.length() &gt; mNote.getTagString().length()) {                 </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 543              mTracker.send(                                                                                        </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 544                      new HitBuilders.EventBuilder()                                                                </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 545                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="5410511239462362052" onmouseenter="enter('5410511239462362052');" onmouseout="out('5410511239462362052');" style=""> 546                              .setAction(&quot;added_tag&quot;)                                                               </span>
<span class="-4831158292382506824" onmouseenter="enter('-4831158292382506824');" onmouseout="out('-4831158292382506824');" style=""> 547                              .setLabel(&quot;tag_added_to_note&quot;)                                                        </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 548                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 549              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550          }                                                                                                         </span>
<span class="4391598042186419731" onmouseenter="enter('4391598042186419731');" onmouseout="out('4391598042186419731');" style=""> 551          else {                                                                                                    </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 552              mTracker.send(                                                                                        </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 553                      new HitBuilders.EventBuilder()                                                                </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 554                              .setCategory(&quot;note&quot;)                                                                  </span>
<span class="-1624008121867682947" onmouseenter="enter('-1624008121867682947');" onmouseout="out('-1624008121867682947');" style=""> 555                              .setAction(&quot;removed_tag&quot;)                                                             </span>
<span class="-6979485583008136850" onmouseenter="enter('-6979485583008136850');" onmouseout="out('-6979485583008136850');" style=""> 556                              .setLabel(&quot;tag_removed_from_note&quot;)                                                    </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 557                              .build()                                                                              </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 558              );                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 559          }                                                                                                         </span>
<span  style=""> 560                                                                                                                    </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 561          mNote.setTagString(tagString);                                                                            </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 562          mNote.setModificationDate(Calendar.getInstance());                                                        </span>
<span class="3745953297761259324" onmouseenter="enter('3745953297761259324');" onmouseout="out('3745953297761259324');" style=""> 563          updateTagList();                                                                                          </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 564          mNote.save();                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 565      }                                                                                                             </span>
<span  style=""> 566                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 567      @Override                                                                                                     </span>
<span class="-5110897291356760413" onmouseenter="enter('-5110897291356760413');" onmouseout="out('-5110897291356760413');" style=""> 568      public void beforeTextChanged(CharSequence charSequence, int i, int i2, int i3) {                             </span>
<span class="7490540504293754116" onmouseenter="enter('7490540504293754116');" onmouseout="out('7490540504293754116');" style=""> 569          // Unused                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 570      }                                                                                                             </span>
<span  style=""> 571                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 572      @Override                                                                                                     </span>
<span class="-3169498224421089624" onmouseenter="enter('-3169498224421089624');" onmouseout="out('-3169498224421089624');" style=""> 573      public void afterTextChanged(Editable editable) {                                                             </span>
<span class="7005237563799171506" onmouseenter="enter('7005237563799171506');" onmouseout="out('7005237563799171506');" style=""> 574          setTitleSpan(editable);                                                                                   </span>
<span class="4641646211430236365" onmouseenter="enter('4641646211430236365');" onmouseout="out('4641646211430236365');" style=""> 575          attemptAutoList(editable);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 576      }                                                                                                             </span>
<span  style=""> 577                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 578      @Override                                                                                                     </span>
<span class="-6004971105578563950" onmouseenter="enter('-6004971105578563950');" onmouseout="out('-6004971105578563950');" style=""> 579      public void onTextChanged(CharSequence charSequence, int start, int before, int count) {                      </span>
<span  style=""> 580                                                                                                                    </span>
<span class="2036741165452809133" onmouseenter="enter('2036741165452809133');" onmouseout="out('2036741165452809133');" style=""> 581          // When text changes, start timer that will fire after AUTOSAVE_DELAY_MILLIS passes                       </span>
<span class="-2149096896161266035" onmouseenter="enter('-2149096896161266035');" onmouseout="out('-2149096896161266035');" style=""> 582          if (mAutoSaveHandler != null) {                                                                           </span>
<span class="-5465787548318672754" onmouseenter="enter('-5465787548318672754');" onmouseout="out('-5465787548318672754');" style=""> 583              mAutoSaveHandler.removeCallbacks(mAutoSaveRunnable);                                                  </span>
<span class="3237260668993885548" onmouseenter="enter('3237260668993885548');" onmouseout="out('3237260668993885548');" style=""> 584              mAutoSaveHandler.postDelayed(mAutoSaveRunnable, AUTOSAVE_DELAY_MILLIS);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585          }                                                                                                         </span>
<span  style=""> 586                                                                                                                    </span>
<span class="5409551732025834677" onmouseenter="enter('5409551732025834677');" onmouseout="out('5409551732025834677');" style=""> 587          // Remove search highlight spans when note content changes                                                </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 588          if (mMatchOffsets != null) {                                                                              </span>
<span class="-5254682256162211718" onmouseenter="enter('-5254682256162211718');" onmouseout="out('-5254682256162211718');" style=""> 589              mMatchOffsets = null;                                                                                 </span>
<span class="2930846742809702691" onmouseenter="enter('2930846742809702691');" onmouseout="out('2930846742809702691');" style=""> 590              mHighlighter.removeMatches();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 591          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 592      }                                                                                                             </span>
<span  style=""> 593                                                                                                                    </span>
<span class="6849776144692122373" onmouseenter="enter('6849776144692122373');" onmouseout="out('6849776144692122373');" style=""> 594      private void setTitleSpan(Editable editable) {                                                                </span>
<span class="-1378972571136516392" onmouseenter="enter('-1378972571136516392');" onmouseout="out('-1378972571136516392');" style=""> 595          // Set the note title to be a larger size                                                                 </span>
<span class="3997786880116952820" onmouseenter="enter('3997786880116952820');" onmouseout="out('3997786880116952820');" style=""> 596          // Remove any existing size spans                                                                         </span>
<span class="-8972916714996192672" onmouseenter="enter('-8972916714996192672');" onmouseout="out('-8972916714996192672');" style=""> 597          RelativeSizeSpan spans[] = editable.getSpans(0, editable.length(), RelativeSizeSpan.class);               </span>
<span class="2386014209880419735" onmouseenter="enter('2386014209880419735');" onmouseout="out('2386014209880419735');" style=""> 598          for (RelativeSizeSpan span : spans) {                                                                     </span>
<span class="-4538099325482792099" onmouseenter="enter('-4538099325482792099');" onmouseout="out('-4538099325482792099');" style=""> 599              editable.removeSpan(span);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600          }                                                                                                         </span>
<span class="-901734861574280266" onmouseenter="enter('-901734861574280266');" onmouseout="out('-901734861574280266');" style=""> 601          int newLinePosition = getNoteContentString().indexOf(&quot;\n&quot;);                                               </span>
<span class="-2560738681101946885" onmouseenter="enter('-2560738681101946885');" onmouseout="out('-2560738681101946885');" style=""> 602          if (newLinePosition == 0)                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 603              return;                                                                                               </span>
<span class="3283000540261653525" onmouseenter="enter('3283000540261653525');" onmouseout="out('3283000540261653525');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 604 -        editable.setSpan(new RelativeSizeSpan(1.222f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 604 -        editable.setSpan(new RelativeSizeSpan(1.222f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.lengtðŸ”µ</abbr></span>
<span class="-2775800673646162791" onmouseenter="enter('-2775800673646162791');" onmouseout="out('-2775800673646162791');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 605 +        editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE);"> 605 +        editable.setSpan(new RelativeSizeSpan(1.227f), 0, (newLinePosition &gt; 0) ? newLinePosition : editable.lengtðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 606      }                                                                                                             </span>
<span  style=""> 607                                                                                                                    </span>
<span class="8395667075038215241" onmouseenter="enter('8395667075038215241');" onmouseout="out('8395667075038215241');" style=""> 608      private void attemptAutoList(Editable editable) {                                                             </span>
<span class="1630313539519665774" onmouseenter="enter('1630313539519665774');" onmouseout="out('1630313539519665774');" style=""> 609          int oldCursorPosition = mCurrentCursorPosition;                                                           </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 610          mCurrentCursorPosition = mContentEditText.getSelectionStart();                                            </span>
<span class="-1456162723219098064" onmouseenter="enter('-1456162723219098064');" onmouseout="out('-1456162723219098064');" style=""> 611          AutoBullet.apply(editable, oldCursorPosition, mCurrentCursorPosition);                                    </span>
<span class="2154628209294087333" onmouseenter="enter('2154628209294087333');" onmouseout="out('2154628209294087333');" style=""> 612          mCurrentCursorPosition = mContentEditText.getSelectionStart();                                            </span>
<span class="6723912502491086435" onmouseenter="enter('6723912502491086435');" onmouseout="out('6723912502491086435');" style=""> 613          android.util.Log.d(&quot;Simplenote&quot;, &quot;==&gt; post cursor position:&quot; + mCurrentCursorPosition);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 614      }                                                                                                             </span>
<span  style=""> 615                                                                                                                    </span>
<span class="-6933317077070028336" onmouseenter="enter('-6933317077070028336');" onmouseout="out('-6933317077070028336');" style=""> 616      private void saveAndSyncNote() {                                                                              </span>
<span class="8223376420483055518" onmouseenter="enter('8223376420483055518');" onmouseout="out('8223376420483055518');" style=""> 617          if (mNote == null)                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 618              return;                                                                                               </span>
<span  style=""> 619                                                                                                                    </span>
<span class="5987107161692050970" onmouseenter="enter('5987107161692050970');" onmouseout="out('5987107161692050970');" style=""> 620          new saveNoteTask().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 621      }                                                                                                             </span>
<span  style=""> 622                                                                                                                    </span>
<span class="-4564004023547017377" onmouseenter="enter('-4564004023547017377');" onmouseout="out('-4564004023547017377');" style=""> 623      public void setPlaceholderVisible(boolean isVisible) {                                                        </span>
<span class="-6467031518050872536" onmouseenter="enter('-6467031518050872536');" onmouseout="out('-6467031518050872536');" style=""> 624          if (isVisible) {                                                                                          </span>
<span class="1687907534970456445" onmouseenter="enter('1687907534970456445');" onmouseout="out('1687907534970456445');" style=""> 625              mNote = null;                                                                                         </span>
<span class="-3407359796970873837" onmouseenter="enter('-3407359796970873837');" onmouseout="out('-3407359796970873837');" style=""> 626              mContentEditText.setText(&quot;&quot;);                                                                         </span>
<span class="-7997465605671669559" onmouseenter="enter('-7997465605671669559');" onmouseout="out('-7997465605671669559');" style=""> 627              mTagView.setText(&quot;&quot;);                                                                                 </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 628              if (mPlaceholderView != null)                                                                         </span>
<span class="-5306578928333558235" onmouseenter="enter('-5306578928333558235');" onmouseout="out('-5306578928333558235');" style=""> 629                  mPlaceholderView.setVisibility(View.VISIBLE);                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 630          } else {                                                                                                  </span>
<span class="8595752396614116138" onmouseenter="enter('8595752396614116138');" onmouseout="out('8595752396614116138');" style=""> 631              if (mPlaceholderView != null)                                                                         </span>
<span class="-2690182352330934584" onmouseenter="enter('-2690182352330934584');" onmouseout="out('-2690182352330934584');" style=""> 632                  mPlaceholderView.setVisibility(View.GONE);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 633          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 634      }                                                                                                             </span>
<span  style=""> 635                                                                                                                    </span>
<span class="7106522413253020021" onmouseenter="enter('7106522413253020021');" onmouseout="out('7106522413253020021');" style=""> 636      public void setIsNewNote(boolean isNewNote) {                                                                 </span>
<span class="-5949421386499580587" onmouseenter="enter('-5949421386499580587');" onmouseout="out('-5949421386499580587');" style=""> 637          this.mIsNewNote = isNewNote;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 638      }                                                                                                             </span>
<span  style=""> 639                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 640      @Override                                                                                                     </span>
<span class="-3315120631467309087" onmouseenter="enter('-3315120631467309087');" onmouseout="out('-3315120631467309087');" style=""> 641      public void onFocusChange(View v, boolean hasFocus) {                                                         </span>
<span class="-6285712256166584728" onmouseenter="enter('-6285712256166584728');" onmouseout="out('-6285712256166584728');" style=""> 642          if (!hasFocus) {                                                                                          </span>
<span class="-6666174322440118634" onmouseenter="enter('-6666174322440118634');" onmouseout="out('-6666174322440118634');" style=""> 643              String tagString = getNoteTagsString().trim();                                                        </span>
<span class="2918711019922442395" onmouseenter="enter('2918711019922442395');" onmouseout="out('2918711019922442395');" style=""> 644              if (tagString.length() &gt; 0) {                                                                         </span>
<span class="8488340728323435918" onmouseenter="enter('8488340728323435918');" onmouseout="out('8488340728323435918');" style=""> 645                  mTagView.setChips(tagString);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 646              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 647          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 648      }                                                                                                             </span>
<span  style=""> 649                                                                                                                    </span>
<span class="-6849832043716883515" onmouseenter="enter('-6849832043716883515');" onmouseout="out('-6849832043716883515');" style=""> 650      public Note getNote() {                                                                                       </span>
<span class="6687317620803594982" onmouseenter="enter('6687317620803594982');" onmouseout="out('6687317620803594982');" style=""> 651          return mNote;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 652      }                                                                                                             </span>
<span  style=""> 653                                                                                                                    </span>
<span class="5855058962481175207" onmouseenter="enter('5855058962481175207');" onmouseout="out('5855058962481175207');" style=""> 654      public String getNoteContentString() {                                                                        </span>
<span class="-8451380960236704581" onmouseenter="enter('-8451380960236704581');" onmouseout="out('-8451380960236704581');" style=""> 655          if (mContentEditText == null || mContentEditText.getText() == null) {                                     </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 656              return &quot;&quot;;                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 657          } else {                                                                                                  </span>
<span class="9069870454824528783" onmouseenter="enter('9069870454824528783');" onmouseout="out('9069870454824528783');" style=""> 658              return mContentEditText.getText().toString();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660      }                                                                                                             </span>
<span  style=""> 661                                                                                                                    </span>
<span class="2486113532203564324" onmouseenter="enter('2486113532203564324');" onmouseout="out('2486113532203564324');" style=""> 662      public String getNoteTagsString() {                                                                           </span>
<span class="2201751553125502793" onmouseenter="enter('2201751553125502793');" onmouseout="out('2201751553125502793');" style=""> 663          if (mTagView == null || mTagView.getText() == null) {                                                     </span>
<span class="-8289946804601166879" onmouseenter="enter('-8289946804601166879');" onmouseout="out('-8289946804601166879');" style=""> 664              return &quot;&quot;;                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 665          } else {                                                                                                  </span>
<span class="-3768945108519459655" onmouseenter="enter('-3768945108519459655');" onmouseout="out('-3768945108519459655');" style=""> 666              return mTagView.getText().toString();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 668      }                                                                                                             </span>
<span  style=""> 669                                                                                                                    </span>
<span class="4832835199818847464" onmouseenter="enter('4832835199818847464');" onmouseout="out('4832835199818847464');" style=""> 670      private class loadNoteTask extends AsyncTask&lt;String, Void, Void&gt; {                                            </span>
<span  style=""> 671                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 672          @Override                                                                                                 </span>
<span class="-2143377957271683587" onmouseenter="enter('-2143377957271683587');" onmouseout="out('-2143377957271683587');" style=""> 673          protected void onPreExecute() {                                                                           </span>
<span class="-4476633077483558762" onmouseenter="enter('-4476633077483558762');" onmouseout="out('-4476633077483558762');" style=""> 674              mContentEditText.removeTextChangedListener(NoteEditorFragment.this);                                  </span>
<span class="1885380990906425504" onmouseenter="enter('1885380990906425504');" onmouseout="out('1885380990906425504');" style=""> 675              mIsLoadingNote = true;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 676          }                                                                                                         </span>
<span  style=""> 677                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 678          @Override                                                                                                 </span>
<span class="2907103121668961470" onmouseenter="enter('2907103121668961470');" onmouseout="out('2907103121668961470');" style=""> 679          protected Void doInBackground(String... args) {                                                           </span>
<span class="-3170312762343778784" onmouseenter="enter('-3170312762343778784');" onmouseout="out('-3170312762343778784');" style=""> 680              if (getActivity() == null) {                                                                          </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 681                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 682              }                                                                                                     </span>
<span  style=""> 683                                                                                                                    </span>
<span class="-6905640337159350056" onmouseenter="enter('-6905640337159350056');" onmouseout="out('-6905640337159350056');" style=""> 684              String noteID = args[0];                                                                              </span>
<span class="5105206001451632901" onmouseenter="enter('5105206001451632901');" onmouseout="out('5105206001451632901');" style=""> 685              Simplenote application = (Simplenote) getActivity().getApplication();                                 </span>
<span class="3820701427545927889" onmouseenter="enter('3820701427545927889');" onmouseout="out('3820701427545927889');" style=""> 686              Bucket&lt;Note&gt; notesBucket = application.getNotesBucket();                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 687              try {                                                                                                 </span>
<span class="1900948898960959991" onmouseenter="enter('1900948898960959991');" onmouseout="out('1900948898960959991');" style=""> 688                  mNote = notesBucket.get(noteID);                                                                  </span>
<span class="-8094446681246514952" onmouseenter="enter('-8094446681246514952');" onmouseout="out('-8094446681246514952');" style=""> 689                  // Set the current note in NotesActivity when on a tablet                                         </span>
<span class="-4385871719572971359" onmouseenter="enter('-4385871719572971359');" onmouseout="out('-4385871719572971359');" style=""> 690                  if (getActivity() instanceof NotesActivity) {                                                     </span>
<span class="-5437998525889410543" onmouseenter="enter('-5437998525889410543');" onmouseout="out('-5437998525889410543');" style=""> 691                      ((NotesActivity) getActivity()).setCurrentNote(mNote);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692                  }                                                                                                 </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 693              } catch (BucketObjectMissingException e) {                                                            </span>
<span class="9016552103124647674" onmouseenter="enter('9016552103124647674');" onmouseout="out('9016552103124647674');" style=""> 694                  // TODO: Handle a missing note                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 695              }                                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 696              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 697          }                                                                                                         </span>
<span  style=""> 698                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 699          @Override                                                                                                 </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 700          protected void onPostExecute(Void nada) {                                                                 </span>
<span class="3019142402664254149" onmouseenter="enter('3019142402664254149');" onmouseout="out('3019142402664254149');" style=""> 701              if (getActivity() == null || getActivity().isFinishing())                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 702                  return;                                                                                           </span>
<span class="-2770512784578238911" onmouseenter="enter('-2770512784578238911');" onmouseout="out('-2770512784578238911');" style=""> 703              refreshContent(false);                                                                                </span>
<span class="5721815250190525804" onmouseenter="enter('5721815250190525804');" onmouseout="out('5721815250190525804');" style=""> 704              if (mMatchOffsets != null) {                                                                          </span>
<span class="4645759725865606036" onmouseenter="enter('4645759725865606036');" onmouseout="out('4645759725865606036');" style=""><abbr title=" 705                  int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROPERTY);"> 705                  int columnIndex = mNote.getBucket().getSchema().getFullTextIndex().getColumnIndex(Note.CONTENT_PROðŸ”µ</abbr></span>
<span class="1514128940236991067" onmouseenter="enter('1514128940236991067');" onmouseout="out('1514128940236991067');" style=""> 706                  mHighlighter.highlightMatches(mMatchOffsets, columnIndex);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 707              }                                                                                                     </span>
<span class="2908988742356344281" onmouseenter="enter('2908988742356344281');" onmouseout="out('2908988742356344281');" style=""> 708              mContentEditText.addTextChangedListener(NoteEditorFragment.this);                                     </span>
<span class="1726616917938037339" onmouseenter="enter('1726616917938037339');" onmouseout="out('1726616917938037339');" style=""> 709              if (mNote != null &amp;&amp; mNote.getContent().isEmpty()) {                                                  </span>
<span class="-7639034409774462373" onmouseenter="enter('-7639034409774462373');" onmouseout="out('-7639034409774462373');" style=""> 710                  // Show soft keyboard                                                                             </span>
<span class="-5568483982770704985" onmouseenter="enter('-5568483982770704985');" onmouseout="out('-5568483982770704985');" style=""> 711                  mContentEditText.requestFocus();                                                                  </span>
<span class="7162501222170899627" onmouseenter="enter('7162501222170899627');" onmouseout="out('7162501222170899627');" style=""> 712                  new Handler().postDelayed(new Runnable() {                                                        </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 713                      @Override                                                                                     </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 714                      public void run() {                                                                           </span>
<span class="6943331498658216188" onmouseenter="enter('6943331498658216188');" onmouseout="out('6943331498658216188');" style=""><abbr title=" 715                          InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);"> 715                          InputMethodManager inputMethodManager = (InputMethodManager) getActivity().getSystemServicðŸ”µ</abbr></span>
<span class="-1476760297763804327" onmouseenter="enter('-1476760297763804327');" onmouseout="out('-1476760297763804327');" style=""> 716                          if (inputMethodManager != null)                                                           </span>
<span class="7954226653587797662" onmouseenter="enter('7954226653587797662');" onmouseout="out('7954226653587797662');" style=""> 717                              inputMethodManager.showSoftInput(mContentEditText, 0);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 718                      }                                                                                             </span>
<span class="-4884776244894547305" onmouseenter="enter('-4884776244894547305');" onmouseout="out('-4884776244894547305');" style=""> 719                  }, 100);                                                                                          </span>
<span  style=""> 720                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 721              }                                                                                                     </span>
<span  style=""> 722                                                                                                                    </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 723              SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                            </span>
<span  style=""> 724                                                                                                                    </span>
<span class="2296161227930019578" onmouseenter="enter('2296161227930019578');" onmouseout="out('2296161227930019578');" style=""> 725              mIsLoadingNote = false;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 726          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 727      }                                                                                                             </span>
<span  style=""> 728                                                                                                                    </span>
<span class="-8015309924985109245" onmouseenter="enter('-8015309924985109245');" onmouseout="out('-8015309924985109245');" style=""> 729      private class saveNoteTask extends AsyncTask&lt;Void, Void, Void&gt; {                                              </span>
<span  style=""> 730                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 731          @Override                                                                                                 </span>
<span class="1259374977543247181" onmouseenter="enter('1259374977543247181');" onmouseout="out('1259374977543247181');" style=""> 732          protected Void doInBackground(Void... args) {                                                             </span>
<span class="640220419932528956" onmouseenter="enter('640220419932528956');" onmouseout="out('640220419932528956');" style=""> 733              saveNote();                                                                                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 734              return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 735          }                                                                                                         </span>
<span  style=""> 736                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 737          @Override                                                                                                 </span>
<span class="2295103304779241059" onmouseenter="enter('2295103304779241059');" onmouseout="out('2295103304779241059');" style=""> 738          protected void onPostExecute(Void nada) {                                                                 </span>
<span class="-8878355580113381449" onmouseenter="enter('-8878355580113381449');" onmouseout="out('-8878355580113381449');" style=""> 739              if (getActivity() != null &amp;&amp; !getActivity().isFinishing()) {                                          </span>
<span class="4157206213844518202" onmouseenter="enter('4157206213844518202');" onmouseout="out('4157206213844518202');" style=""> 740                  // Update links                                                                                   </span>
<span class="-5493645025534883433" onmouseenter="enter('-5493645025534883433');" onmouseout="out('-5493645025534883433');" style=""> 741                  SimplenoteLinkify.addLinks(mContentEditText, Linkify.ALL);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 742              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 744      }                                                                                                             </span>
<span  style=""> 745                                                                                                                    </span>
<span class="-2294831155573525866" onmouseenter="enter('-2294831155573525866');" onmouseout="out('-2294831155573525866');" style=""> 746      private void saveNote() {                                                                                     </span>
<span class="-6566957513776356959" onmouseenter="enter('-6566957513776356959');" onmouseout="out('-6566957513776356959');" style=""> 747          if (mNote == null) {                                                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 748              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 749          }                                                                                                         </span>
<span  style=""> 750                                                                                                                    </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 751          String content = getNoteContentString();                                                                  </span>
<span class="-8502490389039341280" onmouseenter="enter('-8502490389039341280');" onmouseout="out('-8502490389039341280');" style=""> 752          String tagString = getNoteTagsString();                                                                   </span>
<span class="-8359444972541895470" onmouseenter="enter('-8359444972541895470');" onmouseout="out('-8359444972541895470');" style=""> 753          if (mNote.hasChanges(content, tagString.trim(), mPinButton.isChecked())) {                                </span>
<span class="843504871988910810" onmouseenter="enter('843504871988910810');" onmouseout="out('843504871988910810');" style=""> 754              mNote.setContent(content);                                                                            </span>
<span class="1553130968631643861" onmouseenter="enter('1553130968631643861');" onmouseout="out('1553130968631643861');" style=""> 755              mNote.setTagString(tagString);                                                                        </span>
<span class="-3343075472306200704" onmouseenter="enter('-3343075472306200704');" onmouseout="out('-3343075472306200704');" style=""> 756              mNote.setModificationDate(Calendar.getInstance());                                                    </span>
<span class="-5430078119462356953" onmouseenter="enter('-5430078119462356953');" onmouseout="out('-5430078119462356953');" style=""> 757              // Send pinned event to google analytics if changed                                                   </span>
<span class="-8280425794504398339" onmouseenter="enter('-8280425794504398339');" onmouseout="out('-8280425794504398339');" style=""> 758              mNote.setPinned(mPinButton.isChecked());                                                              </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 759              mNote.save();                                                                                         </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 760              if (getActivity() != null) {                                                                          </span>
<span class="9119823558701234173" onmouseenter="enter('9119823558701234173');" onmouseout="out('9119823558701234173');" style=""> 761                  if (mNote.isPinned() != mPinButton.isChecked()) {                                                 </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 762                      mTracker.send(                                                                                </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 763                              new HitBuilders.EventBuilder()                                                        </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 764                                      .setCategory(&quot;note&quot;)                                                          </span>
<span class="-653095590827548063" onmouseenter="enter('-653095590827548063');" onmouseout="out('-653095590827548063');" style=""> 765                                      .setAction((mPinButton.isChecked()) ? &quot;pinned_note&quot; : &quot;unpinned_note&quot;)        </span>
<span class="4917363824063796296" onmouseenter="enter('4917363824063796296');" onmouseout="out('4917363824063796296');" style=""> 766                                      .setLabel(&quot;pin_button&quot;)                                                       </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 767                                      .build()                                                                      </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 768                      );                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 769                  }                                                                                                 </span>
<span  style=""> 770                                                                                                                    </span>
<span class="-6284125578603942393" onmouseenter="enter('-6284125578603942393');" onmouseout="out('-6284125578603942393');" style=""> 771                  mTracker.send(                                                                                    </span>
<span class="4089558766919565524" onmouseenter="enter('4089558766919565524');" onmouseout="out('4089558766919565524');" style=""> 772                          new HitBuilders.EventBuilder()                                                            </span>
<span class="7688062753755212272" onmouseenter="enter('7688062753755212272');" onmouseout="out('7688062753755212272');" style=""> 773                                  .setCategory(&quot;note&quot;)                                                              </span>
<span class="248231167587528808" onmouseenter="enter('248231167587528808');" onmouseout="out('248231167587528808');" style=""> 774                                  .setAction(&quot;edited_note&quot;)                                                         </span>
<span class="5457290577030983699" onmouseenter="enter('5457290577030983699');" onmouseout="out('5457290577030983699');" style=""> 775                                  .setLabel(&quot;editor_save&quot;)                                                          </span>
<span class="3616109827455273093" onmouseenter="enter('3616109827455273093');" onmouseout="out('3616109827455273093');" style=""> 776                                  .build()                                                                          </span>
<span class="-4075588097149809180" onmouseenter="enter('-4075588097149809180');" onmouseout="out('-4075588097149809180');" style=""> 777                  );                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 778              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 779          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 780      }                                                                                                             </span>
<span  style=""> 781                                                                                                                    </span>
<span class="9084056993766846780" onmouseenter="enter('9084056993766846780');" onmouseout="out('9084056993766846780');" style=""> 782      // Contextual action bar for dealing with links                                                               </span>
<span class="-23103958784499667" onmouseenter="enter('-23103958784499667');" onmouseout="out('-23103958784499667');" style=""> 783      private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {                                 </span>
<span  style=""> 784                                                                                                                    </span>
<span class="-5830922032047880245" onmouseenter="enter('-5830922032047880245');" onmouseout="out('-5830922032047880245');" style=""> 785          // Called when the action mode is created; startActionMode() was called                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 786          @Override                                                                                                 </span>
<span class="6869646826473679297" onmouseenter="enter('6869646826473679297');" onmouseout="out('6869646826473679297');" style=""> 787          public boolean onCreateActionMode(ActionMode mode, Menu menu) {                                           </span>
<span class="-5328486553851934265" onmouseenter="enter('-5328486553851934265');" onmouseout="out('-5328486553851934265');" style=""> 788              // Inflate a menu resource providing context menu items                                               </span>
<span class="8164139660214751060" onmouseenter="enter('8164139660214751060');" onmouseout="out('8164139660214751060');" style=""> 789              MenuInflater inflater = mode.getMenuInflater();                                                       </span>
<span class="-5537764272582475285" onmouseenter="enter('-5537764272582475285');" onmouseout="out('-5537764272582475285');" style=""> 790              if (inflater != null){                                                                                </span>
<span class="6552624979414277895" onmouseenter="enter('6552624979414277895');" onmouseout="out('6552624979414277895');" style=""> 791                  inflater.inflate(R.menu.view_link, menu);                                                         </span>
<span class="2045169504868185532" onmouseenter="enter('2045169504868185532');" onmouseout="out('2045169504868185532');" style=""> 792                  mViewLinkMenuItem = menu.findItem(R.id.menu_view_link);                                           </span>
<span class="4190298810187820509" onmouseenter="enter('4190298810187820509');" onmouseout="out('4190298810187820509');" style=""> 793                  mode.setTitle(getString(R.string.link));                                                          </span>
<span class="9015861346770894985" onmouseenter="enter('9015861346770894985');" onmouseout="out('9015861346770894985');" style=""> 794                  if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {                         </span>
<span class="-2927630225150463376" onmouseenter="enter('-2927630225150463376');" onmouseout="out('-2927630225150463376');" style=""> 795                      mode.setTitleOptionalHint(false);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 796                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797              }                                                                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 798              return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 799          }                                                                                                         </span>
<span  style=""> 800                                                                                                                    </span>
<span class="-7885162724385925248" onmouseenter="enter('-7885162724385925248');" onmouseout="out('-7885162724385925248');" style=""> 801          // Called each time the action mode is shown. Always called after onCreateActionMode, but                 </span>
<span class="6140331646129020842" onmouseenter="enter('6140331646129020842');" onmouseout="out('6140331646129020842');" style=""> 802          // may be called multiple times if the mode is invalidated.                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 803          @Override                                                                                                 </span>
<span class="5392123371105216364" onmouseenter="enter('5392123371105216364');" onmouseout="out('5392123371105216364');" style=""> 804          public boolean onPrepareActionMode(ActionMode mode, Menu menu) {                                          </span>
<span class="9220029862843236189" onmouseenter="enter('9220029862843236189');" onmouseout="out('9220029862843236189');" style=""> 805              return false; // Return false if nothing is done                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806          }                                                                                                         </span>
<span  style=""> 807                                                                                                                    </span>
<span class="-918812678605329556" onmouseenter="enter('-918812678605329556');" onmouseout="out('-918812678605329556');" style=""> 808          // Called when the user selects a contextual menu item                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 809          @Override                                                                                                 </span>
<span class="816131742774025467" onmouseenter="enter('816131742774025467');" onmouseout="out('816131742774025467');" style=""> 810          public boolean onActionItemClicked(ActionMode mode, MenuItem item) {                                      </span>
<span class="2068182408853392247" onmouseenter="enter('2068182408853392247');" onmouseout="out('2068182408853392247');" style=""> 811              switch (item.getItemId()) {                                                                           </span>
<span class="1241487664924667668" onmouseenter="enter('1241487664924667668');" onmouseout="out('1241487664924667668');" style=""> 812                  case R.id.menu_view_link:                                                                         </span>
<span class="2689068574112651560" onmouseenter="enter('2689068574112651560');" onmouseout="out('2689068574112651560');" style=""> 813                      if (mLinkUrl != null) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 814                          try {                                                                                     </span>
<span class="2961985398395482945" onmouseenter="enter('2961985398395482945');" onmouseout="out('2961985398395482945');" style=""> 815                              Uri uri = Uri.parse(mLinkUrl);                                                        </span>
<span class="-3647274578727323622" onmouseenter="enter('-3647274578727323622');" onmouseout="out('-3647274578727323622');" style=""> 816                              Intent i = new Intent(Intent.ACTION_VIEW);                                            </span>
<span class="3545520342926402522" onmouseenter="enter('3545520342926402522');" onmouseout="out('3545520342926402522');" style=""> 817                              i.setData(uri);                                                                       </span>
<span class="-9112757235036963275" onmouseenter="enter('-9112757235036963275');" onmouseout="out('-9112757235036963275');" style=""> 818                              startActivity(i);                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 819                          } catch (Exception e) {                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 820                              e.printStackTrace();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 821                          }                                                                                         </span>
<span class="-5985541663234456921" onmouseenter="enter('-5985541663234456921');" onmouseout="out('-5985541663234456921');" style=""> 822                          mode.finish(); // Action picked, so close the CAB                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 823                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 824                      return true;                                                                                  </span>
<span class="1323072004784584241" onmouseenter="enter('1323072004784584241');" onmouseout="out('1323072004784584241');" style=""> 825                  case R.id.menu_copy:                                                                              </span>
<span class="5917848124130151943" onmouseenter="enter('5917848124130151943');" onmouseout="out('5917848124130151943');" style=""> 826                      if (mLinkText != null &amp;&amp; getActivity() != null) {                                             </span>
<span class="-1800885668589834003" onmouseenter="enter('-1800885668589834003');" onmouseout="out('-1800885668589834003');" style=""><abbr title=" 827                          ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPBOARD_SERVICE);"> 827                          ClipboardManager clipboard = (ClipboardManager)getActivity().getSystemService(Context.CLIPðŸ”µ</abbr></span>
<span class="-1681747336188731628" onmouseenter="enter('-1681747336188731628');" onmouseout="out('-1681747336188731628');" style=""> 828                          ClipData clip = ClipData.newPlainText(getString(R.string.app_name),mLinkText);            </span>
<span class="4071695444394328890" onmouseenter="enter('4071695444394328890');" onmouseout="out('4071695444394328890');" style=""> 829                          clipboard.setPrimaryClip(clip);                                                           </span>
<span class="-7641316965107241771" onmouseenter="enter('-7641316965107241771');" onmouseout="out('-7641316965107241771');" style=""> 830                          Toast.makeText(getActivity(), getString(R.string.link_copied), Toast.LENGTH_SHORT).show();</span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 831                          mode.finish();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 833                      return true;                                                                                  </span>
<span class="4712317589059090097" onmouseenter="enter('4712317589059090097');" onmouseout="out('4712317589059090097');" style=""> 834                  case R.id.menu_share:                                                                             </span>
<span class="-6928924091126055668" onmouseenter="enter('-6928924091126055668');" onmouseout="out('-6928924091126055668');" style=""> 835                      if (mLinkText != null) {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 836                          try {                                                                                     </span>
<span class="-5295005974020567837" onmouseenter="enter('-5295005974020567837');" onmouseout="out('-5295005974020567837');" style=""> 837                              Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);                  </span>
<span class="5746492194121968101" onmouseenter="enter('5746492194121968101');" onmouseout="out('5746492194121968101');" style=""> 838                              shareIntent.setType(&quot;text/plain&quot;);                                                    </span>
<span class="-5545338866841663037" onmouseenter="enter('-5545338866841663037');" onmouseout="out('-5545338866841663037');" style=""> 839                              shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, mLinkText);                   </span>
<span class="7073775982354198335" onmouseenter="enter('7073775982354198335');" onmouseout="out('7073775982354198335');" style=""><abbr title=" 840                              startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.share_note)));"> 840                              startActivity(Intent.createChooser(shareIntent, getResources().getString(R.string.sharðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 841                          } catch (Exception e) {                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 842                              e.printStackTrace();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 843                          }                                                                                         </span>
<span class="5768223614092288606" onmouseenter="enter('5768223614092288606');" onmouseout="out('5768223614092288606');" style=""> 844                          mode.finish();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 845                      }                                                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 846                      return true;                                                                                  </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 847                  default:                                                                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 848                      return false;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 849              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 850          }                                                                                                         </span>
<span  style=""> 851                                                                                                                    </span>
<span class="2525157012953828009" onmouseenter="enter('2525157012953828009');" onmouseout="out('2525157012953828009');" style=""> 852          // Called when the user exits the action mode                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 853          @Override                                                                                                 </span>
<span class="-2232977199830239129" onmouseenter="enter('-2232977199830239129');" onmouseout="out('-2232977199830239129');" style=""> 854          public void onDestroyActionMode(ActionMode mode) {                                                        </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 855              mActionMode = null;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 856          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 857      };                                                                                                            </span>
<span  style=""> 858                                                                                                                    </span>
<span class="-6769383367293074987" onmouseenter="enter('-6769383367293074987');" onmouseout="out('-6769383367293074987');" style=""> 859      // Checks if cursor is at a URL when the selection changes                                                    </span>
<span class="499820509706145242" onmouseenter="enter('499820509706145242');" onmouseout="out('499820509706145242');" style=""> 860      // If it is a URL, show the contextual action bar                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 861      @Override                                                                                                     </span>
<span class="-6619706727651867065" onmouseenter="enter('-6619706727651867065');" onmouseout="out('-6619706727651867065');" style=""> 862      public void onSelectionChanged(int selStart, int selEnd) {                                                    </span>
<span class="-5773931921061181239" onmouseenter="enter('-5773931921061181239');" onmouseout="out('-5773931921061181239');" style=""> 863          if (selStart == selEnd) {                                                                                 </span>
<span class="-1073801886026856185" onmouseenter="enter('-1073801886026856185');" onmouseout="out('-1073801886026856185');" style=""> 864              Editable noteContent = mContentEditText.getText();                                                    </span>
<span class="6562974929235397620" onmouseenter="enter('6562974929235397620');" onmouseout="out('6562974929235397620');" style=""> 865              if (noteContent == null)                                                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 866                  return;                                                                                           </span>
<span  style=""> 867                                                                                                                    </span>
<span class="1258634593958745929" onmouseenter="enter('1258634593958745929');" onmouseout="out('1258634593958745929');" style=""> 868              URLSpan[] urlSpans = noteContent.getSpans(selStart, selStart, URLSpan.class);                         </span>
<span class="8265917182779455796" onmouseenter="enter('8265917182779455796');" onmouseout="out('8265917182779455796');" style=""> 869              if (urlSpans.length &gt; 0) {                                                                            </span>
<span class="379938049561077801" onmouseenter="enter('379938049561077801');" onmouseout="out('379938049561077801');" style=""> 870                  URLSpan urlSpan = urlSpans[0];                                                                    </span>
<span class="7382553573082356877" onmouseenter="enter('7382553573082356877');" onmouseout="out('7382553573082356877');" style=""> 871                  mLinkUrl = urlSpan.getURL();                                                                      </span>
<span class="-2685141031372274993" onmouseenter="enter('-2685141031372274993');" onmouseout="out('-2685141031372274993');" style=""><abbr title=" 872                  mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSpan)).toString();"> 872                  mLinkText = noteContent.subSequence(noteContent.getSpanStart(urlSpan), noteContent.getSpanEnd(urlSðŸ”µ</abbr></span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 873                  if (mActionMode != null) {                                                                        </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 874                      mActionMode.setSubtitle(mLinkText);                                                           </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 875                      setLinkMenuItem();                                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 876                      return;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 877                  }                                                                                                 </span>
<span  style=""> 878                                                                                                                    </span>
<span class="-4243988111679111503" onmouseenter="enter('-4243988111679111503');" onmouseout="out('-4243988111679111503');" style=""> 879                  // Show the Contextual Action Bar                                                                 </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 880                  if (getActivity() != null) {                                                                      </span>
<span class="-7828194884341615795" onmouseenter="enter('-7828194884341615795');" onmouseout="out('-7828194884341615795');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 881 -                    mActionMode = getActivity().startActionMode(mActionModeCallback);                             </span>
<span class="-7108116137017669118" onmouseenter="enter('-7108116137017669118');" onmouseout="out('-7108116137017669118');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 882 +                    mActionMode = ((NoteEditorActivity)getActivity()).startSupportActionMode(mActionModeCallback);</span>
<span class="-1291529600191394909" onmouseenter="enter('-1291529600191394909');" onmouseout="out('-1291529600191394909');" style=""> 883                      if (mActionMode != null) {                                                                    </span>
<span class="8256553390773794578" onmouseenter="enter('8256553390773794578');" onmouseout="out('8256553390773794578');" style=""> 884                          mActionMode.setSubtitle(mLinkText);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 885                      }                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 886 +                                                                                                                  </span>
<span class="130933127965357900" onmouseenter="enter('130933127965357900');" onmouseout="out('130933127965357900');" style=""> 887                      setLinkMenuItem();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 888                  }                                                                                                 </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 889              } else if (mActionMode != null) {                                                                     </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 890                  mActionMode.finish();                                                                             </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 891                  mActionMode = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 892              }                                                                                                     </span>
<span class="7515827566305000834" onmouseenter="enter('7515827566305000834');" onmouseout="out('7515827566305000834');" style=""> 893          } else if (mActionMode != null) {                                                                         </span>
<span class="7165201847947665807" onmouseenter="enter('7165201847947665807');" onmouseout="out('7165201847947665807');" style=""> 894              mActionMode.finish();                                                                                 </span>
<span class="291405596407736607" onmouseenter="enter('291405596407736607');" onmouseout="out('291405596407736607');" style=""> 895              mActionMode = null;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 896          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 897      }                                                                                                             </span>
<span  style=""> 898                                                                                                                    </span>
<span class="-1933854749523580289" onmouseenter="enter('-1933854749523580289');" onmouseout="out('-1933854749523580289');" style=""> 899      private void setLinkMenuItem() {                                                                              </span>
<span class="-4542884014549729251" onmouseenter="enter('-4542884014549729251');" onmouseout="out('-4542884014549729251');" style=""> 900          if (mViewLinkMenuItem != null &amp;&amp; mLinkUrl != null) {                                                      </span>
<span class="7070835845876331574" onmouseenter="enter('7070835845876331574');" onmouseout="out('7070835845876331574');" style=""> 901              if (mLinkUrl.startsWith(&quot;tel:&quot;)) {                                                                    </span>
<span class="4608769072092705594" onmouseenter="enter('4608769072092705594');" onmouseout="out('4608769072092705594');" style=""> 902                  mViewLinkMenuItem.setIcon(mCallIconResId);                                                        </span>
<span class="-1045706461125369539" onmouseenter="enter('-1045706461125369539');" onmouseout="out('-1045706461125369539');" style=""> 903                  mViewLinkMenuItem.setTitle(getString(R.string.call));                                             </span>
<span class="-4087102511435152339" onmouseenter="enter('-4087102511435152339');" onmouseout="out('-4087102511435152339');" style=""> 904              } else if (mLinkUrl.startsWith(&quot;mailto:&quot;)) {                                                          </span>
<span class="112818067677115399" onmouseenter="enter('112818067677115399');" onmouseout="out('112818067677115399');" style=""> 905                  mViewLinkMenuItem.setIcon(mEmailIconResId);                                                       </span>
<span class="7417350135164215691" onmouseenter="enter('7417350135164215691');" onmouseout="out('7417350135164215691');" style=""> 906                  mViewLinkMenuItem.setTitle(getString(R.string.email));                                            </span>
<span class="-1372170246346381865" onmouseenter="enter('-1372170246346381865');" onmouseout="out('-1372170246346381865');" style=""> 907              } else if (mLinkUrl.startsWith(&quot;geo:&quot;)) {                                                             </span>
<span class="-5464734295170160558" onmouseenter="enter('-5464734295170160558');" onmouseout="out('-5464734295170160558');" style=""> 908                  mViewLinkMenuItem.setIcon(mMapIconResId);                                                         </span>
<span class="5018205442899714685" onmouseenter="enter('5018205442899714685');" onmouseout="out('5018205442899714685');" style=""> 909                  mViewLinkMenuItem.setTitle(getString(R.string.view_map));                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 910              } else {                                                                                              </span>
<span class="-4632312324298999235" onmouseenter="enter('-4632312324298999235');" onmouseout="out('-4632312324298999235');" style=""> 911                  mViewLinkMenuItem.setIcon(mWebIconResId);                                                         </span>
<span class="4171282647008223100" onmouseenter="enter('4171282647008223100');" onmouseout="out('4171282647008223100');" style=""> 912                  mViewLinkMenuItem.setTitle(getString(R.string.view_in_browser));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 913              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 914          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 915      }                                                                                                             </span>
<span  style=""> 916                                                                                                                    </span>
<span class="1686976550776889109" onmouseenter="enter('1686976550776889109');" onmouseout="out('1686976550776889109');" style=""> 917      // Resets note publish status if Simperium never returned the new publish status                              </span>
<span class="-7747131454054684363" onmouseenter="enter('-7747131454054684363');" onmouseout="out('-7747131454054684363');" style=""> 918      private Runnable mPublishTimeoutRunnable = new Runnable() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 919          @Override                                                                                                 </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 920          public void run() {                                                                                       </span>
<span class="6112154992837754036" onmouseenter="enter('6112154992837754036');" onmouseout="out('6112154992837754036');" style=""> 921              if (!isAdded()) return;                                                                               </span>
<span  style=""> 922                                                                                                                    </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 923              getActivity().runOnUiThread(new Runnable() {                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 924                  @Override                                                                                         </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 925                  public void run() {                                                                               </span>
<span class="-46541338249551852" onmouseenter="enter('-46541338249551852');" onmouseout="out('-46541338249551852');" style=""> 926                      Toast.makeText(                                                                               </span>
<span class="1251951171853107838" onmouseenter="enter('1251951171853107838');" onmouseout="out('1251951171853107838');" style=""> 927                              getActivity(),                                                                        </span>
<span class="112353621179497368" onmouseenter="enter('112353621179497368');" onmouseout="out('112353621179497368');" style=""> 928                              mNote.isPublished() ? R.string.publish_error : R.string.unpublish_error,              </span>
<span class="-5464445565121122409" onmouseenter="enter('-5464445565121122409');" onmouseout="out('-5464445565121122409');" style=""> 929                              Toast.LENGTH_SHORT                                                                    </span>
<span class="1929519410657596695" onmouseenter="enter('1929519410657596695');" onmouseout="out('1929519410657596695');" style=""> 930                      ).show();                                                                                     </span>
<span  style=""> 931                                                                                                                    </span>
<span class="-6752199236124778161" onmouseenter="enter('-6752199236124778161');" onmouseout="out('-6752199236124778161');" style=""> 932                      mNote.setPublished(!mNote.isPublished());                                                     </span>
<span class="-7698918877261210749" onmouseenter="enter('-7698918877261210749');" onmouseout="out('-7698918877261210749');" style=""> 933                      mNote.save();                                                                                 </span>
<span  style=""> 934                                                                                                                    </span>
<span class="-4813280994160595323" onmouseenter="enter('-4813280994160595323');" onmouseout="out('-4813280994160595323');" style=""> 935                      if (mInfoPopupWindow != null &amp;&amp; mInfoPopupWindow.isShowing()) {                               </span>
<span class="-6944825779591395660" onmouseenter="enter('-6944825779591395660');" onmouseout="out('-6944825779591395660');" style=""><abbr title=" 936                          ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(R.id.publish_view_switcher);"> 936                          ViewSwitcher viewSwitcher = (ViewSwitcher)mInfoPopupWindow.getContentView().findViewById(RðŸ”µ</abbr></span>
<span class="3959257289291069285" onmouseenter="enter('3959257289291069285');" onmouseout="out('3959257289291069285');" style=""> 937                          if (viewSwitcher.getDisplayedChild() == 1) {                                              </span>
<span class="-7472993052671010203" onmouseenter="enter('-7472993052671010203');" onmouseout="out('-7472993052671010203');" style=""> 938                              viewSwitcher.showPrevious();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 939                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 940                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 941                  }                                                                                                 </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 942              });                                                                                                   </span>
<span  style=""> 943                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 944          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 945      };                                                                                                            </span>
<span  style=""> 946                                                                                                                    </span>
<span class="1779789763575252159" onmouseenter="enter('1779789763575252159');" onmouseout="out('1779789763575252159');" style=""> 947      private void updateWordCount(TextView textView) {                                                             </span>
<span class="-2495587771059662618" onmouseenter="enter('-2495587771059662618');" onmouseout="out('-2495587771059662618');" style=""> 948          String content = getNoteContentString();                                                                  </span>
<span  style=""> 949                                                                                                                    </span>
<span class="-1008232604726066894" onmouseenter="enter('-1008232604726066894');" onmouseout="out('-1008232604726066894');" style=""> 950          if (content == null || textView == null) return;                                                          </span>
<span  style=""> 951                                                                                                                    </span>
<span class="-1430881109113489374" onmouseenter="enter('-1430881109113489374');" onmouseout="out('-1430881109113489374');" style=""> 952          int numWords = (content.trim().length() == 0) ? 0 : content.trim().split(&quot;([\\W]+)&quot;).length;              </span>
<span  style=""> 953                                                                                                                    </span>
<span class="7366599842051642465" onmouseenter="enter('7366599842051642465');" onmouseout="out('7366599842051642465');" style=""> 954          String wordCountString = getResources().getQuantityString(R.plurals.word_count, numWords);                </span>
<span class="6184855737129992397" onmouseenter="enter('6184855737129992397');" onmouseout="out('6184855737129992397');" style=""> 955          String formattedWordCount = NumberFormat.getInstance().format(numWords);                                  </span>
<span  style=""> 956                                                                                                                    </span>
<span class="-8359331938088478069" onmouseenter="enter('-8359331938088478069');" onmouseout="out('-8359331938088478069');" style=""> 957          textView.setText(formattedWordCount + &quot; &quot; + wordCountString);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 958      }                                                                                                             </span>
<span  style=""> 959                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 960      /**                                                                                                           </span>
<span class="-1711188639399183775" onmouseenter="enter('-1711188639399183775');" onmouseout="out('-1711188639399183775');" style=""> 961       * Simperium listeners                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 962       */                                                                                                           </span>
<span  style=""> 963                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 964      @Override                                                                                                     </span>
<span class="3459602708969445883" onmouseenter="enter('3459602708969445883');" onmouseout="out('3459602708969445883');" style=""> 965      public void onDeleteObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                              </span>
<span  style=""> 966                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 967      }                                                                                                             </span>
<span  style=""> 968                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 969      @Override                                                                                                     </span>
<span class="-391573795721253888" onmouseenter="enter('-391573795721253888');" onmouseout="out('-391573795721253888');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 970 -    public void onChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {               </span>
<span class="-2970240973750057256" onmouseenter="enter('-2970240973750057256');" onmouseout="out('-2970240973750057256');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 971 +    public void onNetworkChange(Bucket&lt;Note&gt; noteBucket, Bucket.ChangeType changeType, final String key) {        </span>
<span class="6607037711761945955" onmouseenter="enter('6607037711761945955');" onmouseout="out('6607037711761945955');" style=""> 972          if (changeType == Bucket.ChangeType.MODIFY) {                                                             </span>
<span class="-6254872391725782597" onmouseenter="enter('-6254872391725782597');" onmouseout="out('-6254872391725782597');" style=""> 973              if (getNote() != null &amp;&amp; getNote().getSimperiumKey().equals(key)) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 974                  try {                                                                                             </span>
<span class="3951885723067312215" onmouseenter="enter('3951885723067312215');" onmouseout="out('3951885723067312215');" style=""> 975                      final Note updatedNote = mNotesBucket.get(key);                                               </span>
<span class="4809573797151136036" onmouseenter="enter('4809573797151136036');" onmouseout="out('4809573797151136036');" style=""> 976                      if (getActivity() != null) {                                                                  </span>
<span class="-3876200887541462175" onmouseenter="enter('-3876200887541462175');" onmouseout="out('-3876200887541462175');" style=""> 977                          getActivity().runOnUiThread(new Runnable() {                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 978                              @Override                                                                             </span>
<span class="5292860430507443886" onmouseenter="enter('5292860430507443886');" onmouseout="out('5292860430507443886');" style=""> 979                              public void run() {                                                                   </span>
<span class="-8758788084050668688" onmouseenter="enter('-8758788084050668688');" onmouseout="out('-8758788084050668688');" style=""> 980                                  if (mPublishTimeoutHandler != null) {                                             </span>
<span class="-1646454762641300025" onmouseenter="enter('-1646454762641300025');" onmouseout="out('-1646454762641300025');" style=""> 981                                      mPublishTimeoutHandler.removeCallbacks(mPublishTimeoutRunnable);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 982                                  }                                                                                 </span>
<span  style=""> 983                                                                                                                    </span>
<span class="-8617980127286778731" onmouseenter="enter('-8617980127286778731');" onmouseout="out('-8617980127286778731');" style=""> 984                                  updateNote(updatedNote);                                                          </span>
<span class="-4651993534606395663" onmouseenter="enter('-4651993534606395663');" onmouseout="out('-4651993534606395663');" style=""> 985                                  updateInfoPopup();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 986                              }                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 987                          });                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 988                      }                                                                                             </span>
<span class="-1560847995217927266" onmouseenter="enter('-1560847995217927266');" onmouseout="out('-1560847995217927266');" style=""> 989                  } catch (BucketObjectMissingException e) {                                                        </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 990                      e.printStackTrace();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 991                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 992              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 993          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 994      }                                                                                                             </span>
<span  style=""> 995                                                                                                                    </span>
<span  style=""> 996                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 997      @Override                                                                                                     </span>
<span class="1835476648918604123" onmouseenter="enter('1835476648918604123');" onmouseout="out('1835476648918604123');" style=""> 998      public void onSaveObject(Bucket&lt;Note&gt; noteBucket, Note note) {                                                </span>
<span class="-5784091718421357269" onmouseenter="enter('-5784091718421357269');" onmouseout="out('-5784091718421357269');" style=""> 999          // noop                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1000      }                                                                                                             </span>
<span  style="">1001                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">1002      @Override                                                                                                     </span>
<span class="-5956849782971602831" onmouseenter="enter('-5956849782971602831');" onmouseout="out('-5956849782971602831');" style="">1003      public void onBeforeUpdateObject(Bucket&lt;Note&gt; bucket, Note note) {                                            </span>
<span class="9133977848896323437" onmouseenter="enter('9133977848896323437');" onmouseout="out('9133977848896323437');" style="">1004          // Don&#x27;t apply updates if we haven&#x27;t loaded the note yet                                                  </span>
<span class="-1541782922582123662" onmouseenter="enter('-1541782922582123662');" onmouseout="out('-1541782922582123662');" style="">1005          if (mIsLoadingNote)                                                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1006              return;                                                                                               </span>
<span  style="">1007                                                                                                                    </span>
<span class="1341660593539808393" onmouseenter="enter('1341660593539808393');" onmouseout="out('1341660593539808393');" style="">1008          Note openNote = getNote();                                                                                </span>
<span class="-6997098079508589023" onmouseenter="enter('-6997098079508589023');" onmouseout="out('-6997098079508589023');" style="">1009          if (openNote == null || !openNote.getSimperiumKey().equals(note.getSimperiumKey()))                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">1010              return;                                                                                               </span>
<span  style="">1011                                                                                                                    </span>
<span class="4441072062127767636" onmouseenter="enter('4441072062127767636');" onmouseout="out('4441072062127767636');" style="">1012          note.setContent(getNoteContentString());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1013      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">1014  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            