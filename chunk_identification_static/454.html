<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>454</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    454
                    <a href="453.html">prev</a>
                    <a href="455.html">next</a>
                    <a href="454_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_e346a804d69c8cd0124b4eb3d35156cfb5cd0779_elasticsearch6/elasticsearch6-side/elasticsearch6-async-side/src/main/java/com/dtstack/flink/sql/side/elasticsearch6/Elasticsearch6AsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779:elasticsearch6/elasticsearch6-side/elasticsearch6-async-side/src/main/java/com/dtstack/flink/sql/side/elasticsearch6/Elasticsearch6AsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^1:elasticsearch6/elasticsearch6-side/elasticsearch6-async-side/src/main/java/com/dtstack/flink/sql/side/elasticsearch6/Elasticsearch6AsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e346a804d69c8cd0124b4eb3d35156cfb5cd0779^2:elasticsearch6/elasticsearch6-side/elasticsearch6-async-side/src/main/java/com/dtstack/flink/sql/side/elasticsearch6/Elasticsearch6AsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6e351a99f6e8449c76ad55e517a5da6cbb108379:elasticsearch6/elasticsearch6-side/elasticsearch6-async-side/src/main/java/com/dtstack/flink/sql/side/elasticsearch6/Elasticsearch6AsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [b], [b], [j]], subset: [[b], [bj], [b], [b], [b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-6877897769465959367" onmouseenter="enter('-6877897769465959367');" onmouseout="out('-6877897769465959367');" style="">  19 package com.dtstack.flink.sql.side.elasticsearch6;                                                       </span>
<span  style="">  20                                                                                                          </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  21 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  25 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  26 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  27                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  28 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-4677472867777569519" onmouseenter="enter('-4677472867777569519');" onmouseout="out('-4677472867777569519');" style="">  29 import com.dtstack.flink.sql.side.*;                                                                     </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  30 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="388410541738591361" onmouseenter="enter('388410541738591361');" onmouseout="out('388410541738591361');" style="">  31 import com.dtstack.flink.sql.side.elasticsearch6.table.Elasticsearch6SideTableInfo;                      </span>
<span class="290690444034872857" onmouseenter="enter('290690444034872857');" onmouseout="out('290690444034872857');" style="">  32 import com.dtstack.flink.sql.side.elasticsearch6.util.Es6Util;                                           </span>
<span class="5967037440424460461" onmouseenter="enter('5967037440424460461');" onmouseout="out('5967037440424460461');" style="">  33 import com.dtstack.flink.sql.side.elasticsearch6.util.SwitchUtil;                                        </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  34 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  35 import com.google.common.collect.Lists;                                                                  </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  36 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  37 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="-3489337718349463205" onmouseenter="enter('-3489337718349463205');" onmouseout="out('-3489337718349463205');" style="">  38 import org.elasticsearch.action.ActionListener;                                                          </span>
<span class="-5662954158270406888" onmouseenter="enter('-5662954158270406888');" onmouseout="out('-5662954158270406888');" style="">  39 import org.elasticsearch.action.search.SearchRequest;                                                    </span>
<span class="7546585836699577478" onmouseenter="enter('7546585836699577478');" onmouseout="out('7546585836699577478');" style="">  40 import org.elasticsearch.action.search.SearchResponse;                                                   </span>
<span class="-1439206680157962857" onmouseenter="enter('-1439206680157962857');" onmouseout="out('-1439206680157962857');" style="">  41 import org.elasticsearch.client.RequestOptions;                                                          </span>
<span class="-7957925609215861115" onmouseenter="enter('-7957925609215861115');" onmouseout="out('-7957925609215861115');" style="">  42 import org.elasticsearch.client.RestHighLevelClient;                                                     </span>
<span class="-3798447231110012333" onmouseenter="enter('-3798447231110012333');" onmouseout="out('-3798447231110012333');" style="">  43 import org.elasticsearch.index.query.BoolQueryBuilder;                                                   </span>
<span class="4378821268051739093" onmouseenter="enter('4378821268051739093');" onmouseout="out('4378821268051739093');" style="">  44 import org.elasticsearch.search.SearchHit;                                                               </span>
<span class="-2631063383852475600" onmouseenter="enter('-2631063383852475600');" onmouseout="out('-2631063383852475600');" style="">  45 import org.elasticsearch.search.builder.SearchSourceBuilder;                                             </span>
<span class="-9133781105073271748" onmouseenter="enter('-9133781105073271748');" onmouseout="out('-9133781105073271748');" style="">  46 import org.elasticsearch.search.sort.SortOrder;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  49                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  50 import java.io.IOException;                                                                              </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  51 import java.io.Serializable;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  52 import java.sql.Timestamp;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  53 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  54 import java.util.Map;                                                                                    </span>
<span  style="">  55                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56 /**                                                                                                      </span>
<span class="5111762851773435404" onmouseenter="enter('5111762851773435404');" onmouseout="out('5111762851773435404');" style="">  57  * @author yinxi                                                                                         </span>
<span class="3057923479999432457" onmouseenter="enter('3057923479999432457');" onmouseout="out('3057923479999432457');" style="">  58  * @date 2020/2/13 - 13:10                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  59  */                                                                                                      </span>
<span class="-3970196844700911415" onmouseenter="enter('-3970196844700911415');" onmouseout="out('-3970196844700911415');" style="">  60 public class Elasticsearch6AsyncReqRow extends BaseAsyncReqRow implements Serializable {                 </span>
<span  style="">  61                                                                                                          </span>
<span class="6474827903234901622" onmouseenter="enter('6474827903234901622');" onmouseout="out('6474827903234901622');" style="">  62     private static final Logger LOG = LoggerFactory.getLogger(Elasticsearch6AsyncReqRow.class);          </span>
<span class="-7435725468078760432" onmouseenter="enter('-7435725468078760432');" onmouseout="out('-7435725468078760432');" style="">  63     private transient RestHighLevelClient rhlClient;                                                     </span>
<span class="941714068177323601" onmouseenter="enter('941714068177323601');" onmouseout="out('941714068177323601');" style="">  64     private SearchRequest searchRequest;                                                                 </span>
<span class="8452196761380421775" onmouseenter="enter('8452196761380421775');" onmouseout="out('8452196761380421775');" style="">  65     private List&lt;String&gt; sqlJoinCompareOperate = Lists.newArrayList();                                   </span>
<span  style="">  66                                                                                                          </span>
<span class="1364237773091800774" onmouseenter="enter('1364237773091800774');" onmouseout="out('1364237773091800774');" style=""><abbr title="  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outField🔵</abbr></span>
<span class="-2472437240349800506" onmouseenter="enter('-2472437240349800506');" onmouseout="out('-2472437240349800506');" style="">  68         super(new Elasticsearch6AsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));  </span>
<span class="-5960460390984536216" onmouseenter="enter('-5960460390984536216');" onmouseout="out('-5960460390984536216');" style="">  69         SqlNode conditionNode = joinInfo.getCondition();                                                 </span>
<span class="-328306808041221760" onmouseenter="enter('-328306808041221760');" onmouseout="out('-328306808041221760');" style="">  70         ParseUtils.parseJoinCompareOperate(conditionNode, sqlJoinCompareOperate);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  73     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  74     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  75         super.open(parameters);                                                                          </span>
<span class="-6049088456160341398" onmouseenter="enter('-6049088456160341398');" onmouseout="out('-6049088456160341398');" style=""><abbr title="  76         Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();">  76         Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo()🔵</abbr></span>
<span class="-86728648582584645" onmouseenter="enter('-86728648582584645');" onmouseout="out('-86728648582584645');" style=""><abbr title="  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());">  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserNa🔵</abbr></span>
<span class="5314623451052488943" onmouseenter="enter('5314623451052488943');" onmouseout="out('5314623451052488943');" style="">  78         searchRequest = Es6Util.setSearchRequest(sideInfo);                                              </span>
<span  style="">  79                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80     }                                                                                                    </span>
<span  style="">  81                                                                                                          </span>
<span  style="">  82                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  84 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  85     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {">  85     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) th🔵</abbr></span>
<span class="-6148511544784959050" onmouseenter="enter('-6148511544784959050');" onmouseout="out('-6148511544784959050');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  86         Tuple2&lt;Boolean,Row&gt; copyInput= Tuple2.of(input.f0,input.f1);                                     </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  87         List&lt;Object&gt; inputParams = Lists.newArrayList();                                                 </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  88         for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                        </span>
<span class="2327228719565533889" onmouseenter="enter('2327228719565533889');" onmouseout="out('2327228719565533889');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  89             Object equalObj = copyInput.f1.getField(conValIndex);                                        </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  90             if (equalObj == null) {                                                                      </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  91                 dealMissKey(copyInput, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  92                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  93             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  94             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  95         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  96                                                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  97 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="8199636546826191717" onmouseenter="enter('8199636546826191717');" onmouseout="out('8199636546826191717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104         CRow copyCrow = new CRow(input.row(), input.change());                                           </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105         List&lt;Object&gt; inputParams = Lists.newArrayList();                                                 </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106         for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                        </span>
<span class="-6239108829717719894" onmouseenter="enter('-6239108829717719894');" onmouseout="out('-6239108829717719894');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107             Object equalObj = copyCrow.row().getField(conValIndex);                                      </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108             if (equalObj == null) {                                                                      </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                 dealMissKey(copyCrow, resultFuture);                                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 110 =======                                                                                                  </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 111     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 111     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 112 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 113         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 114 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 115         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 116             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 117             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 118                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 119                     dealMissKey(copyInput, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 120                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 121                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 122                     try {                                                                                </span>
<span class="-3756338097207210798" onmouseenter="enter('-3756338097207210798');" onmouseout="out('-3756338097207210798');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 123                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = getRows(copyInput, null, (List) val.getContent());"> 123                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = getRows(copyInput, null, (List) val.getConten🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 124                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 125                     } catch (Exception e) {                                                              </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 126                         dealFillDataError(resultFuture, e, copyInput);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 127                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 128                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 129                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 129                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134                                                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 135 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136         List&lt;Object&gt; inputParams = Lists.newArrayList();                                                 </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                        </span>
<span class="-6239108829717719894" onmouseenter="enter('-6239108829717719894');" onmouseout="out('-6239108829717719894');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138             Object equalObj = copyCrow.row().getField(conValIndex);                                      </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139             if (equalObj == null) {                                                                      </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140                 dealMissKey(copyCrow, resultFuture);                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151                     dealMissKey(copyCrow, resultFuture);                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154                     try {                                                                                </span>
<span class="-1861720300228581922" onmouseenter="enter('-1861720300228581922');" onmouseout="out('-1861720300228581922');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155                         List&lt;CRow&gt; rowList = getRows(copyCrow, null, (List) val.getContent());           </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157                     } catch (Exception e) {                                                              </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158                         dealFillDataError(resultFuture, e, copyCrow);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 161                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 161                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 162 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 163 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style=""> 164         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style=""> 165         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style=""> 166         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style=""> 167         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 168         searchRequest.source(searchSourceBuilder);                                                       </span>
<span  style=""> 169                                                                                                          </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style=""> 170         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style=""><abbr title=" 171         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {"> 171         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span  style=""> 172                                                                                                          </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style=""> 173             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 174             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style=""> 175             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style=""> 176                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style=""> 177                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style=""> 178                 List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style=""> 179                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style=""> 180                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style=""> 181                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style=""> 182                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 183                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style=""> 184                         while (true) {                                                                   </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 185 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="2370498136787547017" onmouseenter="enter('2370498136787547017');" onmouseout="out('2370498136787547017');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 186                             loadDataToCache(searchHits, rowList, cacheContent, copyInput);               </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 187 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                     } catch (Exception e) {                                                              </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                         dealFillDataError(resultFuture, e, copyCrow);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 192                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 192                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                                                                                                          </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202         searchRequest.source(searchSourceBuilder);                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                                                                                                          </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 205         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {"> 205         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                                                                                                          </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                 List&lt;CRow&gt; rowList = Lists.newArrayList();                                               </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 215 =======                                                                                                  </span>
<span class="1204073371029062027" onmouseenter="enter('1204073371029062027');" onmouseout="out('1204073371029062027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216                             loadDataToCache(searchHits, rowList, cacheContent, input);                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 217 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style=""> 218                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style=""> 219                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 220                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style=""> 222                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style=""> 223                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style=""> 224                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style=""><abbr title=" 225                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 225                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style=""><abbr title=" 227                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 227                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style=""> 228                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 229                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style=""> 230                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style=""> 231                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style=""><abbr title=" 233                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 233                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 234                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 235                     } catch (Exception e) {                                                              </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 236 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 237                         dealFillDataError(resultFuture, e, copyInput);                                   </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 238 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                 List&lt;CRow&gt; rowList = Lists.newArrayList();                                               </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                         while (true) {                                                                   </span>
<span class="-6131328030105119458" onmouseenter="enter('-6131328030105119458');" onmouseout="out('-6131328030105119458');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                             loadDataToCache(searchHits, rowList, cacheContent, copyCrow);                </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 259                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 259                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 261                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 261                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 266 =======                                                                                                  </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 268 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 269                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style=""> 270                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 271                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style=""> 272                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 273                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style=""> 274                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 278                 } else {                                                                                 </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 279 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 280                     dealMissKey(copyInput, resultFuture);                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 281 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                         while (true) {                                                                   </span>
<span class="-6131328030105119458" onmouseenter="enter('-6131328030105119458');" onmouseout="out('-6131328030105119458');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                             loadDataToCache(searchHits, rowList, cacheContent, copyCrow);                </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 291                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 291                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 293                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 293                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 299                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 299                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                     } catch (Exception e) {                                                              </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302                         dealFillDataError(resultFuture, e, copyCrow);                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 309 =======                                                                                                  </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 311 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 312                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314             }                                                                                            </span>
<span  style=""> 315                                                                                                          </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style=""> 316             // 响应失败处理                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 317             @Override                                                                                    </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style=""> 318             public void onFailure(Exception e) {                                                         </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style=""> 319                 LOG.error(&quot;&quot; + e);                                                                       </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style=""> 320                 resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 322         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323     }                                                                                                    </span>
<span  style=""> 324                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 325     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 326     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 327         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 328         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 329             sb.append(ele.toString())                                                                    </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 330                     .append(&quot;_&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331         }                                                                                                </span>
<span  style=""> 332                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 333         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334     }                                                                                                    </span>
<span  style=""> 335                                                                                                          </span>
<span class="-1831473572126915406" onmouseenter="enter('-1831473572126915406');" onmouseout="out('-1831473572126915406');" style=""><abbr title=" 336     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; cacheContent, Tuple2&lt;Boolean,Row&gt; copyCrow) {"> 336     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; 🔵</abbr></span>
<span class="3556353181550267351" onmouseenter="enter('3556353181550267351');" onmouseout="out('3556353181550267351');" style=""> 337         List&lt;Object&gt; results = Lists.newArrayList();                                                     </span>
<span class="4685904830571915876" onmouseenter="enter('4685904830571915876');" onmouseout="out('4685904830571915876');" style=""> 338         for (SearchHit searchHit : searchHits) {                                                         </span>
<span class="1081112597355792399" onmouseenter="enter('1081112597355792399');" onmouseout="out('1081112597355792399');" style=""> 339             Map&lt;String, Object&gt; object = searchHit.getSourceAsMap();                                     </span>
<span class="1222213862426007956" onmouseenter="enter('1222213862426007956');" onmouseout="out('1222213862426007956');" style=""> 340             results.add(object);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341         }                                                                                                </span>
<span class="-6436299581459780666" onmouseenter="enter('-6436299581459780666');" onmouseout="out('-6436299581459780666');" style=""> 342         rowList.addAll(getRows(copyCrow, cacheContent, results));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343     }                                                                                                    </span>
<span  style=""> 344                                                                                                          </span>
<span class="-1771224653431662395" onmouseenter="enter('-1771224653431662395');" onmouseout="out('-1771224653431662395');" style=""><abbr title=" 345     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {"> 345     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent🔵</abbr></span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style=""> 346         List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                                       </span>
<span class="-2659868438082068725" onmouseenter="enter('-2659868438082068725');" onmouseout="out('-2659868438082068725');" style=""> 347         for (Object line : results) {                                                                    </span>
<span class="-8884479733353684638" onmouseenter="enter('-8884479733353684638');" onmouseout="out('-8884479733353684638');" style=""> 348             Row row = fillData(inputRow.f1, line);                                                       </span>
<span class="-831233364265775285" onmouseenter="enter('-831233364265775285');" onmouseout="out('-831233364265775285');" style=""> 349             if (null != cacheContent &amp;&amp; openCache()) {                                                   </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 350                 cacheContent.add(line);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351             }                                                                                            </span>
<span class="823570819765115521" onmouseenter="enter('823570819765115521');" onmouseout="out('823570819765115521');" style=""> 352             rowList.add(Tuple2.of(inputRow.f0, row));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353         }                                                                                                </span>
<span class="-6950772790073726521" onmouseenter="enter('-6950772790073726521');" onmouseout="out('-6950772790073726521');" style=""> 354         return rowList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 355     }                                                                                                    </span>
<span  style=""> 356                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 357     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 358     public Row fillData(Row input, Object line) {                                                        </span>
<span  style=""> 359                                                                                                          </span>
<span class="-7430439483757714737" onmouseenter="enter('-7430439483757714737');" onmouseout="out('-7430439483757714737');" style=""> 360         Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) line;                                      </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 361         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="110652579211477887" onmouseenter="enter('110652579211477887');" onmouseout="out('110652579211477887');" style=""> 362         String[] fields = sideInfo.getSideTableInfo().getFieldTypes();                                   </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 363         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 364             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 365             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 365             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 366             if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 367                 obj = ((Timestamp) obj).getTime();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368             }                                                                                            </span>
<span  style=""> 369                                                                                                          </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 370             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371         }                                                                                                </span>
<span  style=""> 372                                                                                                          </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 373         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 374             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 375                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 376             } else {                                                                                     </span>
<span class="4790469862100725386" onmouseenter="enter('4790469862100725386');" onmouseout="out('4790469862100725386');" style=""><abbr title=" 377                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getKey())), fields[entry.getValue()]);"> 377                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(e🔵</abbr></span>
<span class="-83073312517818987" onmouseenter="enter('-83073312517818987');" onmouseout="out('-83073312517818987');" style=""> 378                 row.setField(entry.getKey(), object);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380         }                                                                                                </span>
<span  style=""> 381                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 382         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383     }                                                                                                    </span>
<span  style=""> 384                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 385     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 386     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 387         super.close();                                                                                   </span>
<span class="-7971333903947873763" onmouseenter="enter('-7971333903947873763');" onmouseout="out('-7971333903947873763');" style=""> 388         if (rhlClient != null) {                                                                         </span>
<span class="-1010227642904461194" onmouseenter="enter('-1010227642904461194');" onmouseout="out('-1010227642904461194');" style=""> 389             rhlClient.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390         }                                                                                                </span>
<span  style=""> 391                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392     }                                                                                                    </span>
<span  style=""> 393                                                                                                          </span>
<span class="8595548133522297711" onmouseenter="enter('8595548133522297711');" onmouseout="out('8595548133522297711');" style=""> 394     private SearchSourceBuilder initConfiguration() {                                                    </span>
<span class="-3057155605199132792" onmouseenter="enter('-3057155605199132792');" onmouseout="out('-3057155605199132792');" style=""> 395         SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();                             </span>
<span class="9166141955334164362" onmouseenter="enter('9166141955334164362');" onmouseout="out('9166141955334164362');" style=""> 396         searchSourceBuilder.size(getFetchSize());                                                        </span>
<span class="4871961152897776065" onmouseenter="enter('4871961152897776065');" onmouseout="out('4871961152897776065');" style=""> 397         searchSourceBuilder.sort(&quot;_id&quot;, SortOrder.DESC);                                                 </span>
<span class="8809866232242294416" onmouseenter="enter('8809866232242294416');" onmouseout="out('8809866232242294416');" style=""> 398         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields().trim(), &quot;,&quot;);         </span>
<span class="834931586921422776" onmouseenter="enter('834931586921422776');" onmouseout="out('834931586921422776');" style=""> 399         searchSourceBuilder.fetchSource(sideFieldNames, null);                                           </span>
<span  style=""> 400                                                                                                          </span>
<span class="6987226028729546159" onmouseenter="enter('6987226028729546159');" onmouseout="out('6987226028729546159');" style=""> 401         return searchSourceBuilder;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402     }                                                                                                    </span>
<span  style=""> 403                                                                                                          </span>
<span class="4920427788170952721" onmouseenter="enter('4920427788170952721');" onmouseout="out('4920427788170952721');" style=""><abbr title=" 404     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) {"> 404     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBu🔵</abbr></span>
<span class="-3342193056550698313" onmouseenter="enter('-3342193056550698313');" onmouseout="out('-3342193056550698313');" style=""> 405         if (boolQueryBuilder == null) {                                                                  </span>
<span class="7333898073462756397" onmouseenter="enter('7333898073462756397');" onmouseout="out('7333898073462756397');" style=""> 406             boolQueryBuilder = new BoolQueryBuilder();                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407         }                                                                                                </span>
<span  style=""> 408                                                                                                          </span>
<span class="-376702721623965324" onmouseenter="enter('-376702721623965324');" onmouseout="out('-376702721623965324');" style=""> 409         for (int i = 0; i &lt; sqlJoinCompareOperate.size(); i++) {                                         </span>
<span class="2520409669614252080" onmouseenter="enter('2520409669614252080');" onmouseout="out('2520409669614252080');" style=""> 410             String fieldName = sideInfo.getEqualFieldList().get(i);                                      </span>
<span class="5839403981341076602" onmouseenter="enter('5839403981341076602');" onmouseout="out('5839403981341076602');" style=""><abbr title=" 411             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldName));"> 411             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldNam🔵</abbr></span>
<span class="5213198617102891771" onmouseenter="enter('5213198617102891771');" onmouseout="out('5213198617102891771');" style=""> 412             String condition = String.valueOf(inputParams.get(fieldName));                               </span>
<span class="6650387404622288325" onmouseenter="enter('6650387404622288325');" onmouseout="out('6650387404622288325');" style=""><abbr title=" 413             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind, null, fieldName, condition), sideInfo);"> 413             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, ope🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414         }                                                                                                </span>
<span  style=""> 415                                                                                                          </span>
<span class="715229971287047855" onmouseenter="enter('715229971287047855');" onmouseout="out('715229971287047855');" style=""> 416         return boolQueryBuilder;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417     }                                                                                                    </span>
<span  style=""> 418                                                                                                          </span>
<span class="-7768596139566319511" onmouseenter="enter('-7768596139566319511');" onmouseout="out('-7768596139566319511');" style=""> 419     public int getFetchSize() {                                                                          </span>
<span class="-5665804692852603146" onmouseenter="enter('-5665804692852603146');" onmouseout="out('-5665804692852603146');" style=""> 420         return 1000;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422 }                                                                                                        </span>
<span  style=""> 423                                                                                                          </span>




























</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-6877897769465959367" onmouseenter="enter('-6877897769465959367');" onmouseout="out('-6877897769465959367');" style="">  19 package com.dtstack.flink.sql.side.elasticsearch6;                                                       </span>
<span  style="">  20                                                                                                          </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  21 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  25 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  26 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  27                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  28 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-4677472867777569519" onmouseenter="enter('-4677472867777569519');" onmouseout="out('-4677472867777569519');" style="">  29 import com.dtstack.flink.sql.side.*;                                                                     </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  30 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="388410541738591361" onmouseenter="enter('388410541738591361');" onmouseout="out('388410541738591361');" style="">  31 import com.dtstack.flink.sql.side.elasticsearch6.table.Elasticsearch6SideTableInfo;                      </span>
<span class="290690444034872857" onmouseenter="enter('290690444034872857');" onmouseout="out('290690444034872857');" style="">  32 import com.dtstack.flink.sql.side.elasticsearch6.util.Es6Util;                                           </span>
<span class="5967037440424460461" onmouseenter="enter('5967037440424460461');" onmouseout="out('5967037440424460461');" style="">  33 import com.dtstack.flink.sql.side.elasticsearch6.util.SwitchUtil;                                        </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  34 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  35 import com.google.common.collect.Lists;                                                                  </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  36 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  37 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="-3489337718349463205" onmouseenter="enter('-3489337718349463205');" onmouseout="out('-3489337718349463205');" style="">  38 import org.elasticsearch.action.ActionListener;                                                          </span>
<span class="-5662954158270406888" onmouseenter="enter('-5662954158270406888');" onmouseout="out('-5662954158270406888');" style="">  39 import org.elasticsearch.action.search.SearchRequest;                                                    </span>
<span class="7546585836699577478" onmouseenter="enter('7546585836699577478');" onmouseout="out('7546585836699577478');" style="">  40 import org.elasticsearch.action.search.SearchResponse;                                                   </span>
<span class="-1439206680157962857" onmouseenter="enter('-1439206680157962857');" onmouseout="out('-1439206680157962857');" style="">  41 import org.elasticsearch.client.RequestOptions;                                                          </span>
<span class="-7957925609215861115" onmouseenter="enter('-7957925609215861115');" onmouseout="out('-7957925609215861115');" style="">  42 import org.elasticsearch.client.RestHighLevelClient;                                                     </span>
<span class="-3798447231110012333" onmouseenter="enter('-3798447231110012333');" onmouseout="out('-3798447231110012333');" style="">  43 import org.elasticsearch.index.query.BoolQueryBuilder;                                                   </span>
<span class="4378821268051739093" onmouseenter="enter('4378821268051739093');" onmouseout="out('4378821268051739093');" style="">  44 import org.elasticsearch.search.SearchHit;                                                               </span>
<span class="-2631063383852475600" onmouseenter="enter('-2631063383852475600');" onmouseout="out('-2631063383852475600');" style="">  45 import org.elasticsearch.search.builder.SearchSourceBuilder;                                             </span>
<span class="-9133781105073271748" onmouseenter="enter('-9133781105073271748');" onmouseout="out('-9133781105073271748');" style="">  46 import org.elasticsearch.search.sort.SortOrder;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  49                                                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  50 import java.io.IOException;                                                                              </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  51 import java.io.Serializable;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  52 import java.sql.Timestamp;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  53 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  54 import java.util.Map;                                                                                    </span>
<span  style="">  55                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56 /**                                                                                                      </span>
<span class="5111762851773435404" onmouseenter="enter('5111762851773435404');" onmouseout="out('5111762851773435404');" style="">  57  * @author yinxi                                                                                         </span>
<span class="3057923479999432457" onmouseenter="enter('3057923479999432457');" onmouseout="out('3057923479999432457');" style="">  58  * @date 2020/2/13 - 13:10                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  59  */                                                                                                      </span>
<span class="-3970196844700911415" onmouseenter="enter('-3970196844700911415');" onmouseout="out('-3970196844700911415');" style="">  60 public class Elasticsearch6AsyncReqRow extends BaseAsyncReqRow implements Serializable {                 </span>
<span  style="">  61                                                                                                          </span>
<span class="6474827903234901622" onmouseenter="enter('6474827903234901622');" onmouseout="out('6474827903234901622');" style="">  62     private static final Logger LOG = LoggerFactory.getLogger(Elasticsearch6AsyncReqRow.class);          </span>
<span class="-7435725468078760432" onmouseenter="enter('-7435725468078760432');" onmouseout="out('-7435725468078760432');" style="">  63     private transient RestHighLevelClient rhlClient;                                                     </span>
<span class="941714068177323601" onmouseenter="enter('941714068177323601');" onmouseout="out('941714068177323601');" style="">  64     private SearchRequest searchRequest;                                                                 </span>
<span class="8452196761380421775" onmouseenter="enter('8452196761380421775');" onmouseout="out('8452196761380421775');" style="">  65     private List&lt;String&gt; sqlJoinCompareOperate = Lists.newArrayList();                                   </span>
<span  style="">  66                                                                                                          </span>
<span class="1364237773091800774" onmouseenter="enter('1364237773091800774');" onmouseout="out('1364237773091800774');" style=""><abbr title="  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outField🔵</abbr></span>
<span class="-2472437240349800506" onmouseenter="enter('-2472437240349800506');" onmouseout="out('-2472437240349800506');" style="">  68         super(new Elasticsearch6AsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));  </span>
<span class="-5960460390984536216" onmouseenter="enter('-5960460390984536216');" onmouseout="out('-5960460390984536216');" style="">  69         SqlNode conditionNode = joinInfo.getCondition();                                                 </span>
<span class="-328306808041221760" onmouseenter="enter('-328306808041221760');" onmouseout="out('-328306808041221760');" style="">  70         ParseUtils.parseJoinCompareOperate(conditionNode, sqlJoinCompareOperate);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  73     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  74     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  75         super.open(parameters);                                                                          </span>
<span class="-6049088456160341398" onmouseenter="enter('-6049088456160341398');" onmouseout="out('-6049088456160341398');" style=""><abbr title="  76         Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();">  76         Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo()🔵</abbr></span>
<span class="-86728648582584645" onmouseenter="enter('-86728648582584645');" onmouseout="out('-86728648582584645');" style=""><abbr title="  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());">  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserNa🔵</abbr></span>
<span class="5314623451052488943" onmouseenter="enter('5314623451052488943');" onmouseout="out('5314623451052488943');" style="">  78         searchRequest = Es6Util.setSearchRequest(sideInfo);                                              </span>
<span  style="">  79                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  80     }                                                                                                    </span>
<span  style="">  81                                                                                                          </span>
<span  style="">  82                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  83 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  84     @Override                                                                                            </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  85     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {">  85     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) th🔵</abbr></span>
<span class="-6148511544784959050" onmouseenter="enter('-6148511544784959050');" onmouseout="out('-6148511544784959050');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  86         Tuple2&lt;Boolean,Row&gt; copyInput= Tuple2.of(input.f0,input.f1);                                     </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  87         List&lt;Object&gt; inputParams = Lists.newArrayList();                                                 </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  88         for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                        </span>
<span class="2327228719565533889" onmouseenter="enter('2327228719565533889');" onmouseout="out('2327228719565533889');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  89             Object equalObj = copyInput.f1.getField(conValIndex);                                        </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  90             if (equalObj == null) {                                                                      </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  91                 dealMissKey(copyInput, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  92                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  93             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  94             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  95         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  96                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  97         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  98         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  99             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 100             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 101                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 102                     dealMissKey(copyInput, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 103                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 104                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105                     try {                                                                                </span>
<span class="-3756338097207210798" onmouseenter="enter('-3756338097207210798');" onmouseout="out('-3756338097207210798');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 106                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = getRows(copyInput, null, (List) val.getContent());"> 106                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = getRows(copyInput, null, (List) val.getConten🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 107                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 108                     } catch (Exception e) {                                                              </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109                         dealFillDataError(resultFuture, e, copyInput);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 110                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 111                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 112                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 112                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 113                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 114                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 115             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 116         }                                                                                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 117                                                                                                          </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 118         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 119         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 120         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 121         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 122         searchRequest.source(searchSourceBuilder);                                                       </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 123                                                                                                          </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 124         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 125         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {"> 125         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 126                                                                                                          </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 127             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 128             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132                 List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138                         while (true) {                                                                   </span>
<span class="2370498136787547017" onmouseenter="enter('2370498136787547017');" onmouseout="out('2370498136787547017');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139                             loadDataToCache(searchHits, rowList, cacheContent, copyInput);               </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 147                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 147                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 148                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 149                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 149                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 151                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 155                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 155                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157                     } catch (Exception e) {                                                              </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 158                         dealFillDataError(resultFuture, e, copyInput);                                   </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 159                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 160                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 161                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 162                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 163                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 164                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 165                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 166                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 167                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 168                 } else {                                                                                 </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 169                     dealMissKey(copyInput, resultFuture);                                                </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 170                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 171                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 172             }                                                                                            </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 173                                                                                                          </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 174             // 响应失败处理                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 175             @Override                                                                                    </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 176             public void onFailure(Exception e) {                                                         </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 177                 LOG.error(&quot;&quot; + e);                                                                       </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 178                 resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 179             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 180         });                                                                                              </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 181                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 182     }                                                                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 183 ||||||| BASE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184     @Override                                                                                            </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="8199636546826191717" onmouseenter="enter('8199636546826191717');" onmouseout="out('8199636546826191717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186         CRow copyCrow = new CRow(input.row(), input.change());                                           </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187         List&lt;Object&gt; inputParams = Lists.newArrayList();                                                 </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188         for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                        </span>
<span class="-6239108829717719894" onmouseenter="enter('-6239108829717719894');" onmouseout="out('-6239108829717719894');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189             Object equalObj = copyCrow.row().getField(conValIndex);                                      </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190             if (equalObj == null) {                                                                      </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                 dealMissKey(copyCrow, resultFuture);                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194             inputParams.add(equalObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                     dealMissKey(copyCrow, resultFuture);                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                     try {                                                                                </span>
<span class="-1861720300228581922" onmouseenter="enter('-1861720300228581922');" onmouseout="out('-1861720300228581922');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                         List&lt;CRow&gt; rowList = getRows(copyCrow, null, (List) val.getContent());           </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                     } catch (Exception e) {                                                              </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                         dealFillDataError(resultFuture, e, copyCrow);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 212                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 212                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217                                                                                                          </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222         searchRequest.source(searchSourceBuilder);                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223                                                                                                          </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 225         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {"> 225         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226                                                                                                          </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232                 List&lt;CRow&gt; rowList = Lists.newArrayList();                                               </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238                         while (true) {                                                                   </span>
<span class="-6131328030105119458" onmouseenter="enter('-6131328030105119458');" onmouseout="out('-6131328030105119458');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239                             loadDataToCache(searchHits, rowList, cacheContent, copyCrow);                </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 247                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 247                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 249                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 249                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 255                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 255                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                     } catch (Exception e) {                                                              </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                         dealFillDataError(resultFuture, e, copyCrow);                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                 } else {                                                                                 </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                     dealMissKey(copyCrow, resultFuture);                                                 </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                                                                                                          </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274             // 响应失败处理                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275             @Override                                                                                    </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276             public void onFailure(Exception e) {                                                         </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277                 LOG.error(&quot;&quot; + e);                                                                       </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                 resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280         });                                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 283 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284                                                                                                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 285 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 286                                                                                                          </span>
<span class="-1831473572126915406" onmouseenter="enter('-1831473572126915406');" onmouseout="out('-1831473572126915406');" style=""><abbr title=" 287     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; cacheContent, Tuple2&lt;Boolean,Row&gt; copyCrow) {"> 287     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; 🔵</abbr></span>
<span class="3556353181550267351" onmouseenter="enter('3556353181550267351');" onmouseout="out('3556353181550267351');" style=""> 288         List&lt;Object&gt; results = Lists.newArrayList();                                                     </span>
<span class="4685904830571915876" onmouseenter="enter('4685904830571915876');" onmouseout="out('4685904830571915876');" style=""> 289         for (SearchHit searchHit : searchHits) {                                                         </span>
<span class="1081112597355792399" onmouseenter="enter('1081112597355792399');" onmouseout="out('1081112597355792399');" style=""> 290             Map&lt;String, Object&gt; object = searchHit.getSourceAsMap();                                     </span>
<span class="1222213862426007956" onmouseenter="enter('1222213862426007956');" onmouseout="out('1222213862426007956');" style=""> 291             results.add(object);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292         }                                                                                                </span>
<span class="-6436299581459780666" onmouseenter="enter('-6436299581459780666');" onmouseout="out('-6436299581459780666');" style=""> 293         rowList.addAll(getRows(copyCrow, cacheContent, results));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="-1771224653431662395" onmouseenter="enter('-1771224653431662395');" onmouseout="out('-1771224653431662395');" style=""><abbr title=" 296     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {"> 296     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent🔵</abbr></span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style=""> 297         List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                                       </span>
<span class="-2659868438082068725" onmouseenter="enter('-2659868438082068725');" onmouseout="out('-2659868438082068725');" style=""> 298         for (Object line : results) {                                                                    </span>
<span class="-8884479733353684638" onmouseenter="enter('-8884479733353684638');" onmouseout="out('-8884479733353684638');" style=""> 299             Row row = fillData(inputRow.f1, line);                                                       </span>
<span class="-831233364265775285" onmouseenter="enter('-831233364265775285');" onmouseout="out('-831233364265775285');" style=""> 300             if (null != cacheContent &amp;&amp; openCache()) {                                                   </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 301                 cacheContent.add(line);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302             }                                                                                            </span>
<span class="823570819765115521" onmouseenter="enter('823570819765115521');" onmouseout="out('823570819765115521');" style=""> 303             rowList.add(Tuple2.of(inputRow.f0, row));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304         }                                                                                                </span>
<span class="-6950772790073726521" onmouseenter="enter('-6950772790073726521');" onmouseout="out('-6950772790073726521');" style=""> 305         return rowList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span  style=""> 308                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 309     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 310     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 310     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 311         String key = buildCacheKey(inputParams);                                                         </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style=""> 312         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style=""> 313         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style=""> 314         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style=""> 315         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 316         searchRequest.source(searchSourceBuilder);                                                       </span>
<span  style=""> 317                                                                                                          </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style=""> 318         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style=""><abbr title=" 319         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {"> 319         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span  style=""> 320                                                                                                          </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style=""> 321             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 322             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style=""> 323             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span  style=""> 324                                                                                                          </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style=""> 325                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 326                 List&lt;CRow&gt; rowList = Lists.newArrayList();                                               </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style=""> 327                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style=""> 328                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style=""> 329                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style=""> 330                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 331                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style=""> 332                         while (true) {                                                                   </span>
<span class="1204073371029062027" onmouseenter="enter('1204073371029062027');" onmouseout="out('1204073371029062027');" style=""> 333                             loadDataToCache(searchHits, rowList, cacheContent, input);                   </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style=""> 334                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style=""> 335                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 336                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337                             }                                                                            </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style=""> 338                             if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                             </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style=""> 339                                 // create new connection to fetch data                                   </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style=""> 340                                 tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();   </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style=""><abbr title=" 341                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 341                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style=""><abbr title=" 343                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 343                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style=""> 344                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 345                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style=""> 346                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style=""> 347                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style=""><abbr title=" 349                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 349                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 350                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 351                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 352                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 353                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style=""> 354                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 355                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style=""> 356                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 357                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style=""> 358                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 360                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 362                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 363                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 364                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366             }                                                                                            </span>
<span  style=""> 367                                                                                                          </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style=""> 368             // 响应失败处理                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 369             @Override                                                                                    </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style=""> 370             public void onFailure(Exception e) {                                                         </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style=""> 371                 LOG.error(&quot;&quot; + e);                                                                       </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style=""> 372                 resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 373             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 374         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375     }                                                                                                    </span>
<span  style=""> 376                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 377     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 378     public Row fillData(Row input, Object line) {                                                        </span>
<span  style=""> 379                                                                                                          </span>
<span class="-7430439483757714737" onmouseenter="enter('-7430439483757714737');" onmouseout="out('-7430439483757714737');" style=""> 380         Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) line;                                      </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 381         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="110652579211477887" onmouseenter="enter('110652579211477887');" onmouseout="out('110652579211477887');" style=""> 382         String[] fields = sideInfo.getSideTableInfo().getFieldTypes();                                   </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 383         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 384             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 385             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 385             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 386             if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 387                 obj = ((Timestamp) obj).getTime();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388             }                                                                                            </span>
<span  style=""> 389                                                                                                          </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 390             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391         }                                                                                                </span>
<span  style=""> 392                                                                                                          </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 393         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 394             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 395                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 396             } else {                                                                                     </span>
<span class="4790469862100725386" onmouseenter="enter('4790469862100725386');" onmouseout="out('4790469862100725386');" style=""><abbr title=" 397                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getKey())), fields[entry.getValue()]);"> 397                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(e🔵</abbr></span>
<span class="-83073312517818987" onmouseenter="enter('-83073312517818987');" onmouseout="out('-83073312517818987');" style=""> 398                 row.setField(entry.getKey(), object);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400         }                                                                                                </span>
<span  style=""> 401                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 402         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403     }                                                                                                    </span>
<span  style=""> 404                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 405     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 406     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 407         super.close();                                                                                   </span>
<span class="-7971333903947873763" onmouseenter="enter('-7971333903947873763');" onmouseout="out('-7971333903947873763');" style=""> 408         if (rhlClient != null) {                                                                         </span>
<span class="-1010227642904461194" onmouseenter="enter('-1010227642904461194');" onmouseout="out('-1010227642904461194');" style=""> 409             rhlClient.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410         }                                                                                                </span>
<span  style=""> 411                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 412     }                                                                                                    </span>
<span  style=""> 413                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 414     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 415     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 416         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 417         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 418             sb.append(ele.toString())                                                                    </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 419                     .append(&quot;_&quot;);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420         }                                                                                                </span>
<span  style=""> 421                                                                                                          </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 422         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423     }                                                                                                    </span>
<span  style=""> 424                                                                                                          </span>
<span class="8595548133522297711" onmouseenter="enter('8595548133522297711');" onmouseout="out('8595548133522297711');" style=""> 425     private SearchSourceBuilder initConfiguration() {                                                    </span>
<span class="-3057155605199132792" onmouseenter="enter('-3057155605199132792');" onmouseout="out('-3057155605199132792');" style=""> 426         SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();                             </span>
<span class="9166141955334164362" onmouseenter="enter('9166141955334164362');" onmouseout="out('9166141955334164362');" style=""> 427         searchSourceBuilder.size(getFetchSize());                                                        </span>
<span class="4871961152897776065" onmouseenter="enter('4871961152897776065');" onmouseout="out('4871961152897776065');" style=""> 428         searchSourceBuilder.sort(&quot;_id&quot;, SortOrder.DESC);                                                 </span>
<span class="8809866232242294416" onmouseenter="enter('8809866232242294416');" onmouseout="out('8809866232242294416');" style=""> 429         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields().trim(), &quot;,&quot;);         </span>
<span class="834931586921422776" onmouseenter="enter('834931586921422776');" onmouseout="out('834931586921422776');" style=""> 430         searchSourceBuilder.fetchSource(sideFieldNames, null);                                           </span>
<span  style=""> 431                                                                                                          </span>
<span class="6987226028729546159" onmouseenter="enter('6987226028729546159');" onmouseout="out('6987226028729546159');" style=""> 432         return searchSourceBuilder;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433     }                                                                                                    </span>
<span  style=""> 434                                                                                                          </span>
<span class="4920427788170952721" onmouseenter="enter('4920427788170952721');" onmouseout="out('4920427788170952721');" style=""><abbr title=" 435     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) {"> 435     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBu🔵</abbr></span>
<span class="-3342193056550698313" onmouseenter="enter('-3342193056550698313');" onmouseout="out('-3342193056550698313');" style=""> 436         if (boolQueryBuilder == null) {                                                                  </span>
<span class="7333898073462756397" onmouseenter="enter('7333898073462756397');" onmouseout="out('7333898073462756397');" style=""> 437             boolQueryBuilder = new BoolQueryBuilder();                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438         }                                                                                                </span>
<span  style=""> 439                                                                                                          </span>
<span class="-376702721623965324" onmouseenter="enter('-376702721623965324');" onmouseout="out('-376702721623965324');" style=""> 440         for (int i = 0; i &lt; sqlJoinCompareOperate.size(); i++) {                                         </span>
<span class="2520409669614252080" onmouseenter="enter('2520409669614252080');" onmouseout="out('2520409669614252080');" style=""> 441             String fieldName = sideInfo.getEqualFieldList().get(i);                                      </span>
<span class="5839403981341076602" onmouseenter="enter('5839403981341076602');" onmouseout="out('5839403981341076602');" style=""><abbr title=" 442             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldName));"> 442             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldNam🔵</abbr></span>
<span class="5213198617102891771" onmouseenter="enter('5213198617102891771');" onmouseout="out('5213198617102891771');" style=""> 443             String condition = String.valueOf(inputParams.get(fieldName));                               </span>
<span class="6650387404622288325" onmouseenter="enter('6650387404622288325');" onmouseout="out('6650387404622288325');" style=""><abbr title=" 444             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind, null, fieldName, condition), sideInfo);"> 444             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, ope🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445         }                                                                                                </span>
<span  style=""> 446                                                                                                          </span>
<span class="715229971287047855" onmouseenter="enter('715229971287047855');" onmouseout="out('715229971287047855');" style=""> 447         return boolQueryBuilder;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="-7768596139566319511" onmouseenter="enter('-7768596139566319511');" onmouseout="out('-7768596139566319511');" style=""> 450     public int getFetchSize() {                                                                          </span>
<span class="-5665804692852603146" onmouseenter="enter('-5665804692852603146');" onmouseout="out('-5665804692852603146');" style=""> 451         return 1000;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-6877897769465959367" onmouseenter="enter('-6877897769465959367');" onmouseout="out('-6877897769465959367');" style="">  18 package com.dtstack.flink.sql.side.elasticsearch6;                                                       </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-4677472867777569519" onmouseenter="enter('-4677472867777569519');" onmouseout="out('-4677472867777569519');" style="">  21 import com.dtstack.flink.sql.side.*;                                                                     </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  22 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="388410541738591361" onmouseenter="enter('388410541738591361');" onmouseout="out('388410541738591361');" style="">  23 import com.dtstack.flink.sql.side.elasticsearch6.table.Elasticsearch6SideTableInfo;                      </span>
<span class="290690444034872857" onmouseenter="enter('290690444034872857');" onmouseout="out('290690444034872857');" style="">  24 import com.dtstack.flink.sql.side.elasticsearch6.util.Es6Util;                                           </span>
<span class="5967037440424460461" onmouseenter="enter('5967037440424460461');" onmouseout="out('5967037440424460461');" style="">  25 import com.dtstack.flink.sql.side.elasticsearch6.util.SwitchUtil;                                        </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  26 import com.dtstack.flink.sql.util.ParseUtils;                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  27 import com.google.common.collect.Lists;                                                                  </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  28 import java.io.IOException;                                                                              </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  29 import java.io.Serializable;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  30 import java.sql.Timestamp;                                                                               </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  31 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  32 import java.util.Map;                                                                                    </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  33 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  34 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  35 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  36 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  37 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  38 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  39 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  40 import org.apache.flink.types.Row;                                                                       </span>
<span class="-3489337718349463205" onmouseenter="enter('-3489337718349463205');" onmouseout="out('-3489337718349463205');" style="">  41 import org.elasticsearch.action.ActionListener;                                                          </span>
<span class="-5662954158270406888" onmouseenter="enter('-5662954158270406888');" onmouseout="out('-5662954158270406888');" style="">  42 import org.elasticsearch.action.search.SearchRequest;                                                    </span>
<span class="7546585836699577478" onmouseenter="enter('7546585836699577478');" onmouseout="out('7546585836699577478');" style="">  43 import org.elasticsearch.action.search.SearchResponse;                                                   </span>
<span class="-1439206680157962857" onmouseenter="enter('-1439206680157962857');" onmouseout="out('-1439206680157962857');" style="">  44 import org.elasticsearch.client.RequestOptions;                                                          </span>
<span class="-7957925609215861115" onmouseenter="enter('-7957925609215861115');" onmouseout="out('-7957925609215861115');" style="">  45 import org.elasticsearch.client.RestHighLevelClient;                                                     </span>
<span class="-3798447231110012333" onmouseenter="enter('-3798447231110012333');" onmouseout="out('-3798447231110012333');" style="">  46 import org.elasticsearch.index.query.BoolQueryBuilder;                                                   </span>
<span class="4378821268051739093" onmouseenter="enter('4378821268051739093');" onmouseout="out('4378821268051739093');" style="">  47 import org.elasticsearch.search.SearchHit;                                                               </span>
<span class="-2631063383852475600" onmouseenter="enter('-2631063383852475600');" onmouseout="out('-2631063383852475600');" style="">  48 import org.elasticsearch.search.builder.SearchSourceBuilder;                                             </span>
<span class="-9133781105073271748" onmouseenter="enter('-9133781105073271748');" onmouseout="out('-9133781105073271748');" style="">  49 import org.elasticsearch.search.sort.SortOrder;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  50 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  51 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  52                                                                                                          </span>
<span  style="">  53                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54 /**                                                                                                      </span>
<span class="5111762851773435404" onmouseenter="enter('5111762851773435404');" onmouseout="out('5111762851773435404');" style="">  55  * @author yinxi                                                                                         </span>
<span class="3057923479999432457" onmouseenter="enter('3057923479999432457');" onmouseout="out('3057923479999432457');" style="">  56  * @date 2020/2/13 - 13:10                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57  */                                                                                                      </span>
<span class="-3970196844700911415" onmouseenter="enter('-3970196844700911415');" onmouseout="out('-3970196844700911415');" style="">  58 public class Elasticsearch6AsyncReqRow extends BaseAsyncReqRow implements Serializable {                 </span>
<span class="6474827903234901622" onmouseenter="enter('6474827903234901622');" onmouseout="out('6474827903234901622');" style="">  59     private static final Logger LOG = LoggerFactory.getLogger(Elasticsearch6AsyncReqRow.class);          </span>
<span  style="">  60                                                                                                          </span>
<span class="-7435725468078760432" onmouseenter="enter('-7435725468078760432');" onmouseout="out('-7435725468078760432');" style="">  61     private transient RestHighLevelClient rhlClient;                                                     </span>
<span  style="">  62                                                                                                          </span>
<span class="941714068177323601" onmouseenter="enter('941714068177323601');" onmouseout="out('941714068177323601');" style="">  63     private SearchRequest searchRequest;                                                                 </span>
<span  style="">  64                                                                                                          </span>
<span class="8452196761380421775" onmouseenter="enter('8452196761380421775');" onmouseout="out('8452196761380421775');" style="">  65     private List&lt;String&gt; sqlJoinCompareOperate = Lists.newArrayList();                                   </span>
<span  style="">  66                                                                                                          </span>
<span class="1364237773091800774" onmouseenter="enter('1364237773091800774');" onmouseout="out('1364237773091800774');" style=""><abbr title="  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  67     public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outField🔵</abbr></span>
<span class="-2472437240349800506" onmouseenter="enter('-2472437240349800506');" onmouseout="out('-2472437240349800506');" style="">  68         super(new Elasticsearch6AsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));  </span>
<span class="-5960460390984536216" onmouseenter="enter('-5960460390984536216');" onmouseout="out('-5960460390984536216');" style="">  69         SqlNode conditionNode = joinInfo.getCondition();                                                 </span>
<span class="-328306808041221760" onmouseenter="enter('-328306808041221760');" onmouseout="out('-328306808041221760');" style="">  70         ParseUtils.parseJoinCompareOperate(conditionNode, sqlJoinCompareOperate);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  73     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  74     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  75         super.open(parameters);                                                                          </span>
<span class="7524265269708261201" onmouseenter="enter('7524265269708261201');" onmouseout="out('7524265269708261201');" style=""><abbr title="  76         Elasticsearch6SideTableInfo tableInfo = ((Elasticsearch6SideTableInfo) (sideInfo.getSideTableInfo()));">  76         Elasticsearch6SideTableInfo tableInfo = ((Elasticsearch6SideTableInfo) (sideInfo.getSideTableInfo🔵</abbr></span>
<span class="-86728648582584645" onmouseenter="enter('-86728648582584645');" onmouseout="out('-86728648582584645');" style=""><abbr title="  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());">  77         rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserNa🔵</abbr></span>
<span class="5314623451052488943" onmouseenter="enter('5314623451052488943');" onmouseout="out('5314623451052488943');" style="">  78         searchRequest = Es6Util.setSearchRequest(sideInfo);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="2104652039667641752" onmouseenter="enter('2104652039667641752');" onmouseout="out('2104652039667641752');" style=""><abbr title="  82     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception {">  82     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFutu🔵</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="">  83         String key = buildCacheKey(inputParams);                                                         </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style="">  84         BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                        </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style="">  85         boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style="">  86         SearchSourceBuilder searchSourceBuilder = initConfiguration();                                   </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style="">  87         searchSourceBuilder.query(boolQueryBuilder);                                                     </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style="">  88         searchRequest.source(searchSourceBuilder);                                                       </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style="">  89         // 异步查询数据                                                                                        </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style=""><abbr title="  90         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {">  90         rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;()🔵</abbr></span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style="">  91             //成功响应时                                                                                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92             @Override                                                                                    </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style="">  93             public void onResponse(SearchResponse searchResponse) {                                      </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style="">  94                 List&lt;Object&gt; cacheContent = Lists.newArrayList();                                        </span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style="">  95                 List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                               </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style="">  96                 SearchHit[] searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style="">  97                 if (searchHits.length &gt; 0) {                                                             </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style="">  98                     Elasticsearch6SideTableInfo tableInfo = null;                                        </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style="">  99                     RestHighLevelClient tmpRhlClient = null;                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 100                     try {                                                                                </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style=""> 101                         while (true) {                                                                   </span>
<span class="1204073371029062027" onmouseenter="enter('1204073371029062027');" onmouseout="out('1204073371029062027');" style=""> 102                             loadDataToCache(searchHits, rowList, cacheContent, input);                   </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style=""> 103                             // determine if all results haven been ferched                               </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style=""> 104                             if (searchHits.length &lt; getFetchSize()) {                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 105                                 break;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106                             }                                                                            </span>
<span class="-6803535788307619159" onmouseenter="enter('-6803535788307619159');" onmouseout="out('-6803535788307619159');" style=""> 107                             if ((tableInfo == null) &amp;&amp; (tmpRhlClient == null)) {                         </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style=""> 108                                 // create new connection to fetch data                                   </span>
<span class="3991253982397355924" onmouseenter="enter('3991253982397355924');" onmouseout="out('3991253982397355924');" style=""><abbr title=" 109                                 tableInfo = ((Elasticsearch6SideTableInfo) (sideInfo.getSideTableInfo()));"> 109                                 tableInfo = ((Elasticsearch6SideTableInfo) (sideInfo.getSideTableInfo()))🔵</abbr></span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style=""><abbr title=" 110                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 110                                 tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuth🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111                             }                                                                            </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style=""><abbr title=" 112                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();"> 112                             Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValu🔵</abbr></span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style=""> 113                             searchSourceBuilder.searchAfter(searchAfterParameter);                       </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 114                             searchRequest.source(searchSourceBuilder);                                   </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style=""> 115                             searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT); </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style=""> 116                             searchHits = searchResponse.getHits().getHits();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117                         }                                                                                </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style=""><abbr title=" 118                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));"> 118                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheConte🔵</abbr></span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 119                         resultFuture.complete(rowList);                                                  </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 120                     } catch (java.lang.Exception e) {                                                    </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 121                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 122                     } finally {                                                                          </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style=""> 123                         if (tmpRhlClient != null) {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 124                             try {                                                                        </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style=""> 125                                 tmpRhlClient.close();                                                    </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 126                             } catch (IOException e) {                                                    </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style=""> 127                                 LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128                             }                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 131                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 132                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 133                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135             }                                                                                            </span>
<span  style=""> 136                                                                                                          </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style=""> 137             // 响应失败处理                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138             @Override                                                                                    </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style=""> 139             public void onFailure(Exception e) {                                                         </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style=""> 140                 LOG.error(&quot;&quot; + e);                                                                       </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style=""> 141                 resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 143         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144     }                                                                                                    </span>
<span  style=""> 145                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 146     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 147     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 148         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 149         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style=""> 150             sb.append(ele.toString()).append(&quot;_&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 152         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153     }                                                                                                    </span>
<span  style=""> 154                                                                                                          </span>
<span class="8729953889188139177" onmouseenter="enter('8729953889188139177');" onmouseout="out('8729953889188139177');" style=""><abbr title=" 155     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList, List&lt;Object&gt; cacheContent, Tuple2&lt;Boolean, Row&gt; copyCrow) {"> 155     private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList, List&lt;Object&gt;🔵</abbr></span>
<span class="3556353181550267351" onmouseenter="enter('3556353181550267351');" onmouseout="out('3556353181550267351');" style=""> 156         List&lt;Object&gt; results = Lists.newArrayList();                                                     </span>
<span class="4685904830571915876" onmouseenter="enter('4685904830571915876');" onmouseout="out('4685904830571915876');" style=""> 157         for (SearchHit searchHit : searchHits) {                                                         </span>
<span class="1081112597355792399" onmouseenter="enter('1081112597355792399');" onmouseout="out('1081112597355792399');" style=""> 158             Map&lt;String, Object&gt; object = searchHit.getSourceAsMap();                                     </span>
<span class="1222213862426007956" onmouseenter="enter('1222213862426007956');" onmouseout="out('1222213862426007956');" style=""> 159             results.add(object);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160         }                                                                                                </span>
<span class="-6436299581459780666" onmouseenter="enter('-6436299581459780666');" onmouseout="out('-6436299581459780666');" style=""> 161         rowList.addAll(getRows(copyCrow, cacheContent, results));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="-1771224653431662395" onmouseenter="enter('-1771224653431662395');" onmouseout="out('-1771224653431662395');" style=""><abbr title=" 164     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {"> 164     protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent🔵</abbr></span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style=""> 165         List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                                       </span>
<span class="-2659868438082068725" onmouseenter="enter('-2659868438082068725');" onmouseout="out('-2659868438082068725');" style=""> 166         for (Object line : results) {                                                                    </span>
<span class="-8884479733353684638" onmouseenter="enter('-8884479733353684638');" onmouseout="out('-8884479733353684638');" style=""> 167             Row row = fillData(inputRow.f1, line);                                                       </span>
<span class="8134143339641316216" onmouseenter="enter('8134143339641316216');" onmouseout="out('8134143339641316216');" style=""> 168             if ((null != cacheContent) &amp;&amp; openCache()) {                                                 </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 169                 cacheContent.add(line);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170             }                                                                                            </span>
<span class="823570819765115521" onmouseenter="enter('823570819765115521');" onmouseout="out('823570819765115521');" style=""> 171             rowList.add(Tuple2.of(inputRow.f0, row));                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172         }                                                                                                </span>
<span class="-6950772790073726521" onmouseenter="enter('-6950772790073726521');" onmouseout="out('-6950772790073726521');" style=""> 173         return rowList;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174     }                                                                                                    </span>
<span  style=""> 175                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 176     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 177     public Row fillData(Row input, Object line) {                                                        </span>
<span class="8798193991646429806" onmouseenter="enter('8798193991646429806');" onmouseout="out('8798193991646429806');" style=""> 178         Map&lt;String, Object&gt; cacheInfo = ((Map&lt;String, Object&gt;) (line));                                  </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 179         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="110652579211477887" onmouseenter="enter('110652579211477887');" onmouseout="out('110652579211477887');" style=""> 180         String[] fields = sideInfo.getSideTableInfo().getFieldTypes();                                   </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 181         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 182             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 183             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 183             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span class="3767123813453103125" onmouseenter="enter('3767123813453103125');" onmouseout="out('3767123813453103125');" style=""> 184             if ((obj instanceof Timestamp) &amp;&amp; isTimeIndicatorTypeInfo) {                                 </span>
<span class="2964353443849532826" onmouseenter="enter('2964353443849532826');" onmouseout="out('2964353443849532826');" style=""> 185                 obj = ((Timestamp) (obj)).getTime();                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186             }                                                                                            </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 187             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 189         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 190             if (cacheInfo == null) {                                                                     </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 191                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 192             } else {                                                                                     </span>
<span class="4790469862100725386" onmouseenter="enter('4790469862100725386');" onmouseout="out('4790469862100725386');" style=""><abbr title=" 193                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getKey())), fields[entry.getValue()]);"> 193                 Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(e🔵</abbr></span>
<span class="-83073312517818987" onmouseenter="enter('-83073312517818987');" onmouseout="out('-83073312517818987');" style=""> 194                 row.setField(entry.getKey(), object);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196         }                                                                                                </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 197         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 200     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 201     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 202         super.close();                                                                                   </span>
<span class="-7971333903947873763" onmouseenter="enter('-7971333903947873763');" onmouseout="out('-7971333903947873763');" style=""> 203         if (rhlClient != null) {                                                                         </span>
<span class="-1010227642904461194" onmouseenter="enter('-1010227642904461194');" onmouseout="out('-1010227642904461194');" style=""> 204             rhlClient.close();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206     }                                                                                                    </span>
<span  style=""> 207                                                                                                          </span>
<span class="8595548133522297711" onmouseenter="enter('8595548133522297711');" onmouseout="out('8595548133522297711');" style=""> 208     private SearchSourceBuilder initConfiguration() {                                                    </span>
<span class="-3057155605199132792" onmouseenter="enter('-3057155605199132792');" onmouseout="out('-3057155605199132792');" style=""> 209         SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();                             </span>
<span class="9166141955334164362" onmouseenter="enter('9166141955334164362');" onmouseout="out('9166141955334164362');" style=""> 210         searchSourceBuilder.size(getFetchSize());                                                        </span>
<span class="4871961152897776065" onmouseenter="enter('4871961152897776065');" onmouseout="out('4871961152897776065');" style=""> 211         searchSourceBuilder.sort(&quot;_id&quot;, SortOrder.DESC);                                                 </span>
<span class="8809866232242294416" onmouseenter="enter('8809866232242294416');" onmouseout="out('8809866232242294416');" style=""> 212         String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields().trim(), &quot;,&quot;);         </span>
<span class="834931586921422776" onmouseenter="enter('834931586921422776');" onmouseout="out('834931586921422776');" style=""> 213         searchSourceBuilder.fetchSource(sideFieldNames, null);                                           </span>
<span class="6987226028729546159" onmouseenter="enter('6987226028729546159');" onmouseout="out('6987226028729546159');" style=""> 214         return searchSourceBuilder;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215     }                                                                                                    </span>
<span  style=""> 216                                                                                                          </span>
<span class="4920427788170952721" onmouseenter="enter('4920427788170952721');" onmouseout="out('4920427788170952721');" style=""><abbr title=" 217     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) {"> 217     private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBu🔵</abbr></span>
<span class="-3342193056550698313" onmouseenter="enter('-3342193056550698313');" onmouseout="out('-3342193056550698313');" style=""> 218         if (boolQueryBuilder == null) {                                                                  </span>
<span class="7333898073462756397" onmouseenter="enter('7333898073462756397');" onmouseout="out('7333898073462756397');" style=""> 219             boolQueryBuilder = new BoolQueryBuilder();                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220         }                                                                                                </span>
<span class="-376702721623965324" onmouseenter="enter('-376702721623965324');" onmouseout="out('-376702721623965324');" style=""> 221         for (int i = 0; i &lt; sqlJoinCompareOperate.size(); i++) {                                         </span>
<span class="2520409669614252080" onmouseenter="enter('2520409669614252080');" onmouseout="out('2520409669614252080');" style=""> 222             String fieldName = sideInfo.getEqualFieldList().get(i);                                      </span>
<span class="5839403981341076602" onmouseenter="enter('5839403981341076602');" onmouseout="out('5839403981341076602');" style=""><abbr title=" 223             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldName));"> 223             String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldNam🔵</abbr></span>
<span class="5213198617102891771" onmouseenter="enter('5213198617102891771');" onmouseout="out('5213198617102891771');" style=""> 224             String condition = String.valueOf(inputParams.get(fieldName));                               </span>
<span class="6650387404622288325" onmouseenter="enter('6650387404622288325');" onmouseout="out('6650387404622288325');" style=""><abbr title=" 225             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind, null, fieldName, condition), sideInfo);"> 225             boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, ope🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226         }                                                                                                </span>
<span class="715229971287047855" onmouseenter="enter('715229971287047855');" onmouseout="out('715229971287047855');" style=""> 227         return boolQueryBuilder;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228     }                                                                                                    </span>
<span  style=""> 229                                                                                                          </span>
<span class="-7768596139566319511" onmouseenter="enter('-7768596139566319511');" onmouseout="out('-7768596139566319511');" style=""> 230     public int getFetchSize() {                                                                          </span>
<span class="-5665804692852603146" onmouseenter="enter('-5665804692852603146');" onmouseout="out('-5665804692852603146');" style=""> 231         return 1000;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233 }                                                                                                        </span>


























































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-6877897769465959367" onmouseenter="enter('-6877897769465959367');" onmouseout="out('-6877897769465959367');" style="">  19  package com.dtstack.flink.sql.side.elasticsearch6;                                                                </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.dtstack.flink.sql.side.PredicateInfo;                                                                  </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  28  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  29  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  30  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  32  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  33  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  34                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  35  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-4677472867777569519" onmouseenter="enter('-4677472867777569519');" onmouseout="out('-4677472867777569519');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +import com.dtstack.flink.sql.side.*;                                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  37  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="388410541738591361" onmouseenter="enter('388410541738591361');" onmouseout="out('388410541738591361');" style="">  38  import com.dtstack.flink.sql.side.elasticsearch6.table.Elasticsearch6SideTableInfo;                               </span>
<span class="290690444034872857" onmouseenter="enter('290690444034872857');" onmouseout="out('290690444034872857');" style="">  39  import com.dtstack.flink.sql.side.elasticsearch6.util.Es6Util;                                                    </span>
<span class="5967037440424460461" onmouseenter="enter('5967037440424460461');" onmouseout="out('5967037440424460461');" style="">  40  import com.dtstack.flink.sql.side.elasticsearch6.util.SwitchUtil;                                                 </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  41  import com.dtstack.flink.sql.util.ParseUtils;                                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  42  import com.google.common.collect.Lists;                                                                           </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  43  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  44  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="-3489337718349463205" onmouseenter="enter('-3489337718349463205');" onmouseout="out('-3489337718349463205');" style="">  45  import org.elasticsearch.action.ActionListener;                                                                   </span>
<span class="-5662954158270406888" onmouseenter="enter('-5662954158270406888');" onmouseout="out('-5662954158270406888');" style="">  46  import org.elasticsearch.action.search.SearchRequest;                                                             </span>
<span class="7546585836699577478" onmouseenter="enter('7546585836699577478');" onmouseout="out('7546585836699577478');" style="">  47  import org.elasticsearch.action.search.SearchResponse;                                                            </span>
<span class="-1439206680157962857" onmouseenter="enter('-1439206680157962857');" onmouseout="out('-1439206680157962857');" style="">  48  import org.elasticsearch.client.RequestOptions;                                                                   </span>
<span class="-7957925609215861115" onmouseenter="enter('-7957925609215861115');" onmouseout="out('-7957925609215861115');" style="">  49  import org.elasticsearch.client.RestHighLevelClient;                                                              </span>
<span class="-3798447231110012333" onmouseenter="enter('-3798447231110012333');" onmouseout="out('-3798447231110012333');" style="">  50  import org.elasticsearch.index.query.BoolQueryBuilder;                                                            </span>
<span class="4378821268051739093" onmouseenter="enter('4378821268051739093');" onmouseout="out('4378821268051739093');" style="">  51  import org.elasticsearch.search.SearchHit;                                                                        </span>
<span class="-2631063383852475600" onmouseenter="enter('-2631063383852475600');" onmouseout="out('-2631063383852475600');" style="">  52  import org.elasticsearch.search.builder.SearchSourceBuilder;                                                      </span>
<span class="-9133781105073271748" onmouseenter="enter('-9133781105073271748');" onmouseout="out('-9133781105073271748');" style="">  53  import org.elasticsearch.search.sort.SortOrder;                                                                   </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  54  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  55  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  56                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  57  import java.io.IOException;                                                                                       </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  58  import java.io.Serializable;                                                                                      </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  59  import java.sql.Timestamp;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  60  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  61  import java.util.Map;                                                                                             </span>
<span  style="">  62                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63  /**                                                                                                               </span>
<span class="5111762851773435404" onmouseenter="enter('5111762851773435404');" onmouseout="out('5111762851773435404');" style="">  64   * @author yinxi                                                                                                  </span>
<span class="3057923479999432457" onmouseenter="enter('3057923479999432457');" onmouseout="out('3057923479999432457');" style="">  65   * @date 2020/2/13 - 13:10                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66   */                                                                                                               </span>
<span class="-3970196844700911415" onmouseenter="enter('-3970196844700911415');" onmouseout="out('-3970196844700911415');" style="">  67  public class Elasticsearch6AsyncReqRow extends BaseAsyncReqRow implements Serializable {                          </span>
<span  style="">  68                                                                                                                    </span>
<span class="6474827903234901622" onmouseenter="enter('6474827903234901622');" onmouseout="out('6474827903234901622');" style="">  69      private static final Logger LOG = LoggerFactory.getLogger(Elasticsearch6AsyncReqRow.class);                   </span>
<span class="-7435725468078760432" onmouseenter="enter('-7435725468078760432');" onmouseout="out('-7435725468078760432');" style="">  70      private transient RestHighLevelClient rhlClient;                                                              </span>
<span class="941714068177323601" onmouseenter="enter('941714068177323601');" onmouseout="out('941714068177323601');" style="">  71      private SearchRequest searchRequest;                                                                          </span>
<span class="8452196761380421775" onmouseenter="enter('8452196761380421775');" onmouseout="out('8452196761380421775');" style="">  72      private List&lt;String&gt; sqlJoinCompareOperate = Lists.newArrayList();                                            </span>
<span  style="">  73                                                                                                                    </span>
<span class="1364237773091800774" onmouseenter="enter('1364237773091800774');" onmouseout="out('1364237773091800774');" style=""><abbr title="  74      public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  74      public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,🔵</abbr></span>
<span class="-2472437240349800506" onmouseenter="enter('-2472437240349800506');" onmouseout="out('-2472437240349800506');" style="">  75          super(new Elasticsearch6AsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-5960460390984536216" onmouseenter="enter('-5960460390984536216');" onmouseout="out('-5960460390984536216');" style="">  76          SqlNode conditionNode = joinInfo.getCondition();                                                          </span>
<span class="-328306808041221760" onmouseenter="enter('-328306808041221760');" onmouseout="out('-328306808041221760');" style="">  77          ParseUtils.parseJoinCompareOperate(conditionNode, sqlJoinCompareOperate);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78      }                                                                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  80      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  81      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  82          super.open(parameters);                                                                                   </span>
<span class="-6049088456160341398" onmouseenter="enter('-6049088456160341398');" onmouseout="out('-6049088456160341398');" style="">  83          Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();        </span>
<span class="-86728648582584645" onmouseenter="enter('-86728648582584645');" onmouseout="out('-86728648582584645');" style=""><abbr title="  84          rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());">  84          rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tab🔵</abbr></span>
<span class="5314623451052488943" onmouseenter="enter('5314623451052488943');" onmouseout="out('5314623451052488943');" style="">  85          searchRequest = Es6Util.setSearchRequest(sideInfo);                                                       </span>
<span  style="">  86                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87      }                                                                                                             </span>
<span  style="">  88                                                                                                                    </span>
<span  style="">  89                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  90      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="8199636546826191717" onmouseenter="enter('8199636546826191717');" onmouseout="out('8199636546826191717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -        CRow copyCrow = new CRow(input.row(), input.change());                                                    </span>
<span class="2879440514228719226" onmouseenter="enter('2879440514228719226');" onmouseout="out('2879440514228719226');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  93 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {">  93 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exce🔵</abbr></span>
<span class="-6148511544784959050" onmouseenter="enter('-6148511544784959050');" onmouseout="out('-6148511544784959050');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +        Tuple2&lt;Boolean,Row&gt; copyInput= Tuple2.of(input.f0,input.f1);                                              </span>
<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="">  95          List&lt;Object&gt; inputParams = Lists.newArrayList();                                                          </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="">  96          for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                                 </span>
<span class="-6239108829717719894" onmouseenter="enter('-6239108829717719894');" onmouseout="out('-6239108829717719894');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -            Object equalObj = copyCrow.row().getField(conValIndex);                                               </span>
<span class="2327228719565533889" onmouseenter="enter('2327228719565533889');" onmouseout="out('2327228719565533889');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +            Object equalObj = copyInput.f1.getField(conValIndex);                                                 </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="">  99              if (equalObj == null) {                                                                               </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -                dealMissKey(copyCrow, resultFuture);                                                              </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +                dealMissKey(copyInput, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 102                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103              }                                                                                                     </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style=""> 104              inputParams.add(equalObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105          }                                                                                                         </span>
<span  style=""> 106                                                                                                                    </span>

<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 107          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 108          if (openCache()) {                                                                                        </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style=""> 109              CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 110              if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 111                  if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                    dealMissKey(copyCrow, resultFuture);                                                          </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +                    dealMissKey(copyInput, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 114                      return;                                                                                       </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 115                  } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 116                      try {                                                                                         </span>
<span class="-1861720300228581922" onmouseenter="enter('-1861720300228581922');" onmouseout="out('-1861720300228581922');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -                        List&lt;CRow&gt; rowList = getRows(copyCrow, null, (List) val.getContent());                    </span>
<span class="-3756338097207210798" onmouseenter="enter('-3756338097207210798');" onmouseout="out('-3756338097207210798');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                        List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = getRows(copyInput, null, (List) val.getContent());    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 119                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 120                      } catch (Exception e) {                                                                       </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -                        dealFillDataError(resultFuture, e, copyCrow);                                             </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                        dealFillDataError(resultFuture, e, copyInput);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 124                  } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 125                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 125                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 127                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129          }                                                                                                         </span>
<span  style=""> 130                                                                                                                    </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style=""> 131          BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                                 </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style=""> 132          boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                         </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style=""> 133          SearchSourceBuilder searchSourceBuilder = initConfiguration();                                            </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style=""> 134          searchSourceBuilder.query(boolQueryBuilder);                                                              </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 135          searchRequest.source(searchSourceBuilder);                                                                </span>
<span  style=""> 136                                                                                                                    </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style=""> 137          // 异步查询数据                                                                                                 </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style=""> 138          rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {       </span>
<span  style=""> 139                                                                                                                    </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style=""> 140              //成功响应时                                                                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 141              @Override                                                                                             </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style=""> 142              public void onResponse(SearchResponse searchResponse) {                                               </span>
<span  style=""> 143                                                                                                                    </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style=""> 144                  List&lt;Object&gt; cacheContent = Lists.newArrayList();                                                 </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -                List&lt;CRow&gt; rowList = Lists.newArrayList();                                                        </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +                List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                         </span>
<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style=""> 147                  SearchHit[] searchHits = searchResponse.getHits().getHits();                                      </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style=""> 148                  if (searchHits.length &gt; 0) {                                                                      </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style=""> 149                      Elasticsearch6SideTableInfo tableInfo = null;                                                 </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style=""> 150                      RestHighLevelClient tmpRhlClient = null;                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 151                      try {                                                                                         </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style=""> 152                          while (true) {                                                                            </span>
<span class="-6131328030105119458" onmouseenter="enter('-6131328030105119458');" onmouseout="out('-6131328030105119458');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -                            loadDataToCache(searchHits, rowList, cacheContent, copyCrow);                         </span>
<span class="2370498136787547017" onmouseenter="enter('2370498136787547017');" onmouseout="out('2370498136787547017');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +                            loadDataToCache(searchHits, rowList, cacheContent, copyInput);                        </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style=""> 155                              // determine if all results haven been ferched                                        </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style=""> 156                              if (searchHits.length &lt; getFetchSize()) {                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 157                                  break;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                              }                                                                                     </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style=""> 159                              if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                                      </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style=""> 160                                  // create new connection to fetch data                                            </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style=""> 161                                  tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();            </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style=""><abbr title=" 162                                  tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 162                                  tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), t🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                              }                                                                                     </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style=""> 164                              Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();    </span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style=""> 165                              searchSourceBuilder.searchAfter(searchAfterParameter);                                </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 166                              searchRequest.source(searchSourceBuilder);                                            </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style=""> 167                              searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT);          </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style=""> 168                              searchHits = searchResponse.getHits().getHits();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169                          }                                                                                         </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style=""> 170                          dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 171                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 172                      } catch (Exception e) {                                                                       </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -                        dealFillDataError(resultFuture, e, copyCrow);                                             </span>
<span class="-6797318763488965903" onmouseenter="enter('-6797318763488965903');" onmouseout="out('-6797318763488965903');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +                        dealFillDataError(resultFuture, e, copyInput);                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 175                      } finally {                                                                                   </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style=""> 176                          if (tmpRhlClient != null) {                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 177                              try {                                                                                 </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style=""> 178                                  tmpRhlClient.close();                                                             </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 179                              } catch (IOException e) {                                                             </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style=""> 180                                  LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 184                  } else {                                                                                          </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                    dealMissKey(copyCrow, resultFuture);                                                          </span>
<span class="5357501937291303672" onmouseenter="enter('5357501937291303672');" onmouseout="out('5357501937291303672');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +                    dealMissKey(copyInput, resultFuture);                                                         </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 187                      dealCacheData(key, CacheMissVal.getMissKeyObj());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189              }                                                                                                     </span>
<span  style=""> 190                                                                                                                    </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style=""> 191              // 响应失败处理                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 192              @Override                                                                                             </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style=""> 193              public void onFailure(Exception e) {                                                                  </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style=""> 194                  LOG.error(&quot;&quot; + e);                                                                                </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style=""> 195                  resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 197          });                                                                                                       </span>
<span  style=""> 198                                                                                                                    </span>











<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199      }                                                                                                             </span>
<span  style=""> 200                                                                                                                    </span>
<span class="-4544381189301585527" onmouseenter="enter('-4544381189301585527');" onmouseout="out('-4544381189301585527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 201 -    private void loadDataToCache(SearchHit[] searchHits, List&lt;CRow&gt; rowList, List&lt;Object&gt; cacheContent, CRow copyCrow) {"> 201 -    private void loadDataToCache(SearchHit[] searchHits, List&lt;CRow&gt; rowList, List&lt;Object&gt; cacheContent, CRow copyC🔵</abbr></span>
<span class="-1831473572126915406" onmouseenter="enter('-1831473572126915406');" onmouseout="out('-1831473572126915406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 202 +    private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; cacheContent, Tuple2&lt;Boolean,Row&gt; copyCrow) {"> 202 +    private void loadDataToCache(SearchHit[] searchHits, List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList, List&lt;Object&gt; cacheCont🔵</abbr></span>
<span class="3556353181550267351" onmouseenter="enter('3556353181550267351');" onmouseout="out('3556353181550267351');" style=""> 203          List&lt;Object&gt; results = Lists.newArrayList();                                                              </span>
<span class="4685904830571915876" onmouseenter="enter('4685904830571915876');" onmouseout="out('4685904830571915876');" style=""> 204          for (SearchHit searchHit : searchHits) {                                                                  </span>
<span class="1081112597355792399" onmouseenter="enter('1081112597355792399');" onmouseout="out('1081112597355792399');" style=""> 205              Map&lt;String, Object&gt; object = searchHit.getSourceAsMap();                                              </span>
<span class="1222213862426007956" onmouseenter="enter('1222213862426007956');" onmouseout="out('1222213862426007956');" style=""> 206              results.add(object);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207          }                                                                                                         </span>
<span class="-6436299581459780666" onmouseenter="enter('-6436299581459780666');" onmouseout="out('-6436299581459780666');" style=""> 208          rowList.addAll(getRows(copyCrow, cacheContent, results));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209      }                                                                                                             </span>
<span  style=""> 210                                                                                                                    </span>
<span class="7149157550499060002" onmouseenter="enter('7149157550499060002');" onmouseout="out('7149157550499060002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -    protected List&lt;CRow&gt; getRows(CRow inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                                </span>
<span class="-1771224653431662395" onmouseenter="enter('-1771224653431662395');" onmouseout="out('-1771224653431662395');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 213 +    protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {"> 213 +    protected List&lt;Tuple2&lt;Boolean, Row&gt;&gt; getRows(Tuple2&lt;Boolean, Row&gt; inputRow, List&lt;Object&gt; cacheContent, List&lt;Ob🔵</abbr></span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 214 +        List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                                                </span>
<span class="-2659868438082068725" onmouseenter="enter('-2659868438082068725');" onmouseout="out('-2659868438082068725');" style=""> 215          for (Object line : results) {                                                                             </span>
<span class="6603283091960501091" onmouseenter="enter('6603283091960501091');" onmouseout="out('6603283091960501091');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -            Row row = fillData(inputRow.row(), line);                                                             </span>
<span class="-8884479733353684638" onmouseenter="enter('-8884479733353684638');" onmouseout="out('-8884479733353684638');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +            Row row = fillData(inputRow.f1, line);                                                                </span>
<span class="-831233364265775285" onmouseenter="enter('-831233364265775285');" onmouseout="out('-831233364265775285');" style=""> 218              if (null != cacheContent &amp;&amp; openCache()) {                                                            </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 219                  cacheContent.add(line);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220              }                                                                                                     </span>
<span class="-9214808964898811038" onmouseenter="enter('-9214808964898811038');" onmouseout="out('-9214808964898811038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -            rowList.add(new CRow(row, inputRow.change()));                                                        </span>
<span class="823570819765115521" onmouseenter="enter('823570819765115521');" onmouseout="out('823570819765115521');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +            rowList.add(Tuple2.of(inputRow.f0, row));                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223          }                                                                                                         </span>
<span class="-6950772790073726521" onmouseenter="enter('-6950772790073726521');" onmouseout="out('-6950772790073726521');" style=""> 224          return rowList;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225      }                                                                                                             </span>
<span  style=""> 226                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 227      @Override                                                                                                     </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 228      public Row fillData(Row input, Object line) {                                                                 </span>
<span  style=""> 229                                                                                                                    </span>
<span class="-7430439483757714737" onmouseenter="enter('-7430439483757714737');" onmouseout="out('-7430439483757714737');" style=""> 230          Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) line;                                               </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 231          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="110652579211477887" onmouseenter="enter('110652579211477887');" onmouseout="out('110652579211477887');" style=""> 232          String[] fields = sideInfo.getSideTableInfo().getFieldTypes();                                            </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 233          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 234              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 235              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 235              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 236              if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 237                  obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238              }                                                                                                     </span>
<span  style=""> 239                                                                                                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 240              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span  style=""> 242                                                                                                                    </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 243          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {                       </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 244              if (cacheInfo == null) {                                                                              </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 245                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 246              } else {                                                                                              </span>
<span class="4790469862100725386" onmouseenter="enter('4790469862100725386');" onmouseout="out('4790469862100725386');" style=""><abbr title=" 247                  Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getKey())), fields[entry.getValue()]);"> 247                  Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getK🔵</abbr></span>
<span class="-83073312517818987" onmouseenter="enter('-83073312517818987');" onmouseout="out('-83073312517818987');" style=""> 248                  row.setField(entry.getKey(), object);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250          }                                                                                                         </span>
<span  style=""> 251                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 252          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253      }                                                                                                             </span>
<span  style=""> 254                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 255      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 256      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 257          super.close();                                                                                            </span>
<span class="-7971333903947873763" onmouseenter="enter('-7971333903947873763');" onmouseout="out('-7971333903947873763');" style=""> 258          if (rhlClient != null) {                                                                                  </span>
<span class="-1010227642904461194" onmouseenter="enter('-1010227642904461194');" onmouseout="out('-1010227642904461194');" style=""> 259              rhlClient.close();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260          }                                                                                                         </span>
<span  style=""> 261                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262      }                                                                                                             </span>
<span  style=""> 263                                                                                                                    </span>
<span class="8381596313408135185" onmouseenter="enter('8381596313408135185');" onmouseout="out('8381596313408135185');" style=""> 264      public String buildCacheKey(List equalValList) {                                                              </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 265          StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="-2954267244038924423" onmouseenter="enter('-2954267244038924423');" onmouseout="out('-2954267244038924423');" style=""> 266          for (Object ele : equalValList) {                                                                         </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 267              sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 268                      .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269          }                                                                                                         </span>
<span  style=""> 270                                                                                                                    </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 271          return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span class="8595548133522297711" onmouseenter="enter('8595548133522297711');" onmouseout="out('8595548133522297711');" style=""> 274      private SearchSourceBuilder initConfiguration() {                                                             </span>
<span class="-3057155605199132792" onmouseenter="enter('-3057155605199132792');" onmouseout="out('-3057155605199132792');" style=""> 275          SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();                                      </span>
<span class="9166141955334164362" onmouseenter="enter('9166141955334164362');" onmouseout="out('9166141955334164362');" style=""> 276          searchSourceBuilder.size(getFetchSize());                                                                 </span>
<span class="4871961152897776065" onmouseenter="enter('4871961152897776065');" onmouseout="out('4871961152897776065');" style=""> 277          searchSourceBuilder.sort(&quot;_id&quot;, SortOrder.DESC);                                                          </span>
<span class="8809866232242294416" onmouseenter="enter('8809866232242294416');" onmouseout="out('8809866232242294416');" style=""> 278          String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields().trim(), &quot;,&quot;);                  </span>
<span class="834931586921422776" onmouseenter="enter('834931586921422776');" onmouseout="out('834931586921422776');" style=""> 279          searchSourceBuilder.fetchSource(sideFieldNames, null);                                                    </span>
<span  style=""> 280                                                                                                                    </span>
<span class="6987226028729546159" onmouseenter="enter('6987226028729546159');" onmouseout="out('6987226028729546159');" style=""> 281          return searchSourceBuilder;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282      }                                                                                                             </span>
<span  style=""> 283                                                                                                                    </span>
<span class="-3730630656770699376" onmouseenter="enter('-3730630656770699376');" onmouseout="out('-3730630656770699376');" style=""> 284      private BoolQueryBuilder setInputParams(List&lt;Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) {        </span>

<span class="-3342193056550698313" onmouseenter="enter('-3342193056550698313');" onmouseout="out('-3342193056550698313');" style=""> 285          if (boolQueryBuilder == null) {                                                                           </span>
<span class="7333898073462756397" onmouseenter="enter('7333898073462756397');" onmouseout="out('7333898073462756397');" style=""> 286              boolQueryBuilder = new BoolQueryBuilder();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287          }                                                                                                         </span>
<span  style=""> 288                                                                                                                    </span>
<span class="-376702721623965324" onmouseenter="enter('-376702721623965324');" onmouseout="out('-376702721623965324');" style=""> 289          for (int i = 0; i &lt; sqlJoinCompareOperate.size(); i++) {                                                  </span>
<span class="2520409669614252080" onmouseenter="enter('2520409669614252080');" onmouseout="out('2520409669614252080');" style=""> 290              String fieldName = sideInfo.getEqualFieldList().get(i);                                               </span>
<span class="5839403981341076602" onmouseenter="enter('5839403981341076602');" onmouseout="out('5839403981341076602');" style=""> 291              String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldName));     </span>
<span class="-1399945515306319928" onmouseenter="enter('-1399945515306319928');" onmouseout="out('-1399945515306319928');" style=""> 292              String condition = String.valueOf(inputParams.get(i));                                                </span>

<span class="6650387404622288325" onmouseenter="enter('6650387404622288325');" onmouseout="out('6650387404622288325');" style=""><abbr title=" 293              boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind, null, fieldName, condition), sideInfo);"> 293              boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294          }                                                                                                         </span>
<span  style=""> 295                                                                                                                    </span>
<span class="715229971287047855" onmouseenter="enter('715229971287047855');" onmouseout="out('715229971287047855');" style=""> 296          return boolQueryBuilder;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297      }                                                                                                             </span>
<span  style=""> 298                                                                                                                    </span>
<span class="-7768596139566319511" onmouseenter="enter('-7768596139566319511');" onmouseout="out('-7768596139566319511');" style=""> 299      public int getFetchSize() {                                                                                   </span>
<span class="-5665804692852603146" onmouseenter="enter('-5665804692852603146');" onmouseout="out('-5665804692852603146');" style=""> 300          return 1000;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-6877897769465959367" onmouseenter="enter('-6877897769465959367');" onmouseout="out('-6877897769465959367');" style="">  19  package com.dtstack.flink.sql.side.elasticsearch6;                                                                </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="1614892075588798997" onmouseenter="enter('1614892075588798997');" onmouseout="out('1614892075588798997');" style="">  26  import com.dtstack.flink.sql.side.PredicateInfo;                                                                  </span>

<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  27  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  28  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  29  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  30  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  31  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  32  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  33                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  34  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>

<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  35  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="388410541738591361" onmouseenter="enter('388410541738591361');" onmouseout="out('388410541738591361');" style="">  36  import com.dtstack.flink.sql.side.elasticsearch6.table.Elasticsearch6SideTableInfo;                               </span>
<span class="290690444034872857" onmouseenter="enter('290690444034872857');" onmouseout="out('290690444034872857');" style="">  37  import com.dtstack.flink.sql.side.elasticsearch6.util.Es6Util;                                                    </span>
<span class="5967037440424460461" onmouseenter="enter('5967037440424460461');" onmouseout="out('5967037440424460461');" style="">  38  import com.dtstack.flink.sql.side.elasticsearch6.util.SwitchUtil;                                                 </span>
<span class="-4585055968129153397" onmouseenter="enter('-4585055968129153397');" onmouseout="out('-4585055968129153397');" style="">  39  import com.dtstack.flink.sql.util.ParseUtils;                                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  40  import com.google.common.collect.Lists;                                                                           </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  41  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  42  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="-3489337718349463205" onmouseenter="enter('-3489337718349463205');" onmouseout="out('-3489337718349463205');" style="">  43  import org.elasticsearch.action.ActionListener;                                                                   </span>
<span class="-5662954158270406888" onmouseenter="enter('-5662954158270406888');" onmouseout="out('-5662954158270406888');" style="">  44  import org.elasticsearch.action.search.SearchRequest;                                                             </span>
<span class="7546585836699577478" onmouseenter="enter('7546585836699577478');" onmouseout="out('7546585836699577478');" style="">  45  import org.elasticsearch.action.search.SearchResponse;                                                            </span>
<span class="-1439206680157962857" onmouseenter="enter('-1439206680157962857');" onmouseout="out('-1439206680157962857');" style="">  46  import org.elasticsearch.client.RequestOptions;                                                                   </span>
<span class="-7957925609215861115" onmouseenter="enter('-7957925609215861115');" onmouseout="out('-7957925609215861115');" style="">  47  import org.elasticsearch.client.RestHighLevelClient;                                                              </span>
<span class="-3798447231110012333" onmouseenter="enter('-3798447231110012333');" onmouseout="out('-3798447231110012333');" style="">  48  import org.elasticsearch.index.query.BoolQueryBuilder;                                                            </span>
<span class="4378821268051739093" onmouseenter="enter('4378821268051739093');" onmouseout="out('4378821268051739093');" style="">  49  import org.elasticsearch.search.SearchHit;                                                                        </span>
<span class="-2631063383852475600" onmouseenter="enter('-2631063383852475600');" onmouseout="out('-2631063383852475600');" style="">  50  import org.elasticsearch.search.builder.SearchSourceBuilder;                                                      </span>
<span class="-9133781105073271748" onmouseenter="enter('-9133781105073271748');" onmouseout="out('-9133781105073271748');" style="">  51  import org.elasticsearch.search.sort.SortOrder;                                                                   </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  52  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  53  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  54                                                                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  55  import java.io.IOException;                                                                                       </span>
<span class="5998602906817463685" onmouseenter="enter('5998602906817463685');" onmouseout="out('5998602906817463685');" style="">  56  import java.io.Serializable;                                                                                      </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  57  import java.sql.Timestamp;                                                                                        </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  58  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  59  import java.util.Map;                                                                                             </span>
<span  style="">  60                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61  /**                                                                                                               </span>
<span class="5111762851773435404" onmouseenter="enter('5111762851773435404');" onmouseout="out('5111762851773435404');" style="">  62   * @author yinxi                                                                                                  </span>
<span class="3057923479999432457" onmouseenter="enter('3057923479999432457');" onmouseout="out('3057923479999432457');" style="">  63   * @date 2020/2/13 - 13:10                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  64   */                                                                                                               </span>
<span class="-3970196844700911415" onmouseenter="enter('-3970196844700911415');" onmouseout="out('-3970196844700911415');" style="">  65  public class Elasticsearch6AsyncReqRow extends BaseAsyncReqRow implements Serializable {                          </span>
<span  style="">  66                                                                                                                    </span>
<span class="6474827903234901622" onmouseenter="enter('6474827903234901622');" onmouseout="out('6474827903234901622');" style="">  67      private static final Logger LOG = LoggerFactory.getLogger(Elasticsearch6AsyncReqRow.class);                   </span>
<span class="-7435725468078760432" onmouseenter="enter('-7435725468078760432');" onmouseout="out('-7435725468078760432');" style="">  68      private transient RestHighLevelClient rhlClient;                                                              </span>
<span class="941714068177323601" onmouseenter="enter('941714068177323601');" onmouseout="out('941714068177323601');" style="">  69      private SearchRequest searchRequest;                                                                          </span>
<span class="8452196761380421775" onmouseenter="enter('8452196761380421775');" onmouseout="out('8452196761380421775');" style="">  70      private List&lt;String&gt; sqlJoinCompareOperate = Lists.newArrayList();                                            </span>
<span  style="">  71                                                                                                                    </span>
<span class="1364237773091800774" onmouseenter="enter('1364237773091800774');" onmouseout="out('1364237773091800774');" style=""><abbr title="  72      public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  72      public Elasticsearch6AsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,🔵</abbr></span>
<span class="-2472437240349800506" onmouseenter="enter('-2472437240349800506');" onmouseout="out('-2472437240349800506');" style="">  73          super(new Elasticsearch6AsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-5960460390984536216" onmouseenter="enter('-5960460390984536216');" onmouseout="out('-5960460390984536216');" style="">  74          SqlNode conditionNode = joinInfo.getCondition();                                                          </span>
<span class="-328306808041221760" onmouseenter="enter('-328306808041221760');" onmouseout="out('-328306808041221760');" style="">  75          ParseUtils.parseJoinCompareOperate(conditionNode, sqlJoinCompareOperate);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80          super.open(parameters);                                                                                   </span>
<span class="-6049088456160341398" onmouseenter="enter('-6049088456160341398');" onmouseout="out('-6049088456160341398');" style="">  81          Elasticsearch6SideTableInfo tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();        </span>
<span class="-86728648582584645" onmouseenter="enter('-86728648582584645');" onmouseout="out('-86728648582584645');" style=""><abbr title="  82          rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());">  82          rhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tab🔵</abbr></span>
<span class="5314623451052488943" onmouseenter="enter('5314623451052488943');" onmouseout="out('5314623451052488943');" style="">  83          searchRequest = Es6Util.setSearchRequest(sideInfo);                                                       </span>
<span  style="">  84                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85      }                                                                                                             </span>
<span  style="">  86                                                                                                                    </span>
<span  style="">  87                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  88      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="8199636546826191717" onmouseenter="enter('8199636546826191717');" onmouseout="out('8199636546826191717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -        CRow copyCrow = new CRow(input.row(), input.change());                                                    </span>


<span class="1294520002002775526" onmouseenter="enter('1294520002002775526');" onmouseout="out('1294520002002775526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -        List&lt;Object&gt; inputParams = Lists.newArrayList();                                                          </span>
<span class="1792900147144305199" onmouseenter="enter('1792900147144305199');" onmouseout="out('1792900147144305199');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -        for (Integer conValIndex : sideInfo.getEqualValIndex()) {                                                 </span>
<span class="-6239108829717719894" onmouseenter="enter('-6239108829717719894');" onmouseout="out('-6239108829717719894');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -            Object equalObj = copyCrow.row().getField(conValIndex);                                               </span>

<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -            if (equalObj == null) {                                                                               </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -                dealMissKey(copyCrow, resultFuture);                                                              </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -            }                                                                                                     </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -            inputParams.add(equalObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -                                                                                                                  </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 101 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 101 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) th🔵</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 102          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        if (openCache()) {                                                                                        </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -            CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -            if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -                if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -                    dealMissKey(copyCrow, resultFuture);                                                          </span>

<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                    return;                                                                                       </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -                } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -                    try {                                                                                         </span>
<span class="-1861720300228581922" onmouseenter="enter('-1861720300228581922');" onmouseout="out('-1861720300228581922');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -                        List&lt;CRow&gt; rowList = getRows(copyCrow, null, (List) val.getContent());                    </span>

<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                        resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                    } catch (Exception e) {                                                                       </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -                        dealFillDataError(resultFuture, e, copyCrow);                                             </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -                    }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 117 -                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 117 -                    resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.ge🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                                                                                                                  </span>
<span class="3707506999844862155" onmouseenter="enter('3707506999844862155');" onmouseout="out('3707506999844862155');" style=""> 123          BoolQueryBuilder boolQueryBuilder = Es6Util.setPredicateclause(sideInfo);                                 </span>
<span class="-533364629675809349" onmouseenter="enter('-533364629675809349');" onmouseout="out('-533364629675809349');" style=""> 124          boolQueryBuilder = setInputParams(inputParams, boolQueryBuilder);                                         </span>
<span class="6682316605732226750" onmouseenter="enter('6682316605732226750');" onmouseout="out('6682316605732226750');" style=""> 125          SearchSourceBuilder searchSourceBuilder = initConfiguration();                                            </span>
<span class="2112246244941479873" onmouseenter="enter('2112246244941479873');" onmouseout="out('2112246244941479873');" style=""> 126          searchSourceBuilder.query(boolQueryBuilder);                                                              </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 127          searchRequest.source(searchSourceBuilder);                                                                </span>
<span  style=""> 128                                                                                                                    </span>
<span class="2132737234351118534" onmouseenter="enter('2132737234351118534');" onmouseout="out('2132737234351118534');" style=""> 129          // 异步查询数据                                                                                                 </span>
<span class="-6254128621766264949" onmouseenter="enter('-6254128621766264949');" onmouseout="out('-6254128621766264949');" style=""> 130          rhlClient.searchAsync(searchRequest, RequestOptions.DEFAULT, new ActionListener&lt;SearchResponse&gt;() {       </span>
<span  style=""> 131                                                                                                                    </span>
<span class="-5163456444740659172" onmouseenter="enter('-5163456444740659172');" onmouseout="out('-5163456444740659172');" style=""> 132              //成功响应时                                                                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 133              @Override                                                                                             </span>
<span class="7459571434093225260" onmouseenter="enter('7459571434093225260');" onmouseout="out('7459571434093225260');" style=""> 134              public void onResponse(SearchResponse searchResponse) {                                               </span>
<span  style=""> 135                                                                                                                    </span>
<span class="3199692622197570508" onmouseenter="enter('3199692622197570508');" onmouseout="out('3199692622197570508');" style=""> 136                  List&lt;Object&gt; cacheContent = Lists.newArrayList();                                                 </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 137                  List&lt;CRow&gt; rowList = Lists.newArrayList();                                                        </span>

<span class="6929829759803496555" onmouseenter="enter('6929829759803496555');" onmouseout="out('6929829759803496555');" style=""> 138                  SearchHit[] searchHits = searchResponse.getHits().getHits();                                      </span>
<span class="-2266508065647663284" onmouseenter="enter('-2266508065647663284');" onmouseout="out('-2266508065647663284');" style=""> 139                  if (searchHits.length &gt; 0) {                                                                      </span>
<span class="-3241432136714626476" onmouseenter="enter('-3241432136714626476');" onmouseout="out('-3241432136714626476');" style=""> 140                      Elasticsearch6SideTableInfo tableInfo = null;                                                 </span>
<span class="-702141723686603188" onmouseenter="enter('-702141723686603188');" onmouseout="out('-702141723686603188');" style=""> 141                      RestHighLevelClient tmpRhlClient = null;                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 142                      try {                                                                                         </span>
<span class="-3127950886903104513" onmouseenter="enter('-3127950886903104513');" onmouseout="out('-3127950886903104513');" style=""> 143                          while (true) {                                                                            </span>
<span class="-6131328030105119458" onmouseenter="enter('-6131328030105119458');" onmouseout="out('-6131328030105119458');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                            loadDataToCache(searchHits, rowList, cacheContent, copyCrow);                         </span>
<span class="1204073371029062027" onmouseenter="enter('1204073371029062027');" onmouseout="out('1204073371029062027');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +                            loadDataToCache(searchHits, rowList, cacheContent, input);                            </span>
<span class="1406579108093514578" onmouseenter="enter('1406579108093514578');" onmouseout="out('1406579108093514578');" style=""> 146                              // determine if all results haven been ferched                                        </span>
<span class="1973318889644552850" onmouseenter="enter('1973318889644552850');" onmouseout="out('1973318889644552850');" style=""> 147                              if (searchHits.length &lt; getFetchSize()) {                                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 148                                  break;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149                              }                                                                                     </span>
<span class="-5892033248751199038" onmouseenter="enter('-5892033248751199038');" onmouseout="out('-5892033248751199038');" style=""> 150                              if (tableInfo == null &amp;&amp; tmpRhlClient == null) {                                      </span>
<span class="6798101901285030509" onmouseenter="enter('6798101901285030509');" onmouseout="out('6798101901285030509');" style=""> 151                                  // create new connection to fetch data                                            </span>
<span class="9165334535155958751" onmouseenter="enter('9165334535155958751');" onmouseout="out('9165334535155958751');" style=""> 152                                  tableInfo = (Elasticsearch6SideTableInfo) sideInfo.getSideTableInfo();            </span>
<span class="-7081381593353839453" onmouseenter="enter('-7081381593353839453');" onmouseout="out('-7081381593353839453');" style=""><abbr title=" 153                                  tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), tableInfo.getUserName(), tableInfo.getPassword());"> 153                                  tmpRhlClient = Es6Util.getClient(tableInfo.getAddress(), tableInfo.isAuthMesh(), t🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                              }                                                                                     </span>
<span class="-6401531919499729398" onmouseenter="enter('-6401531919499729398');" onmouseout="out('-6401531919499729398');" style=""> 155                              Object[] searchAfterParameter = searchHits[searchHits.length - 1].getSortValues();    </span>
<span class="-1605613418950762671" onmouseenter="enter('-1605613418950762671');" onmouseout="out('-1605613418950762671');" style=""> 156                              searchSourceBuilder.searchAfter(searchAfterParameter);                                </span>
<span class="-1428606878545121206" onmouseenter="enter('-1428606878545121206');" onmouseout="out('-1428606878545121206');" style=""> 157                              searchRequest.source(searchSourceBuilder);                                            </span>
<span class="4104031697084177578" onmouseenter="enter('4104031697084177578');" onmouseout="out('4104031697084177578');" style=""> 158                              searchResponse = tmpRhlClient.search(searchRequest, RequestOptions.DEFAULT);          </span>
<span class="-5450331146729317410" onmouseenter="enter('-5450331146729317410');" onmouseout="out('-5450331146729317410');" style=""> 159                              searchHits = searchResponse.getHits().getHits();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160                          }                                                                                         </span>
<span class="6077196592369723389" onmouseenter="enter('6077196592369723389');" onmouseout="out('6077196592369723389');" style=""> 161                          dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 162                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 163                      } catch (Exception e) {                                                                       </span>
<span class="-5195820402776579611" onmouseenter="enter('-5195820402776579611');" onmouseout="out('-5195820402776579611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -                        dealFillDataError(resultFuture, e, copyCrow);                                             </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +                        dealFillDataError(input, resultFuture, e);                                                </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 166                      } finally {                                                                                   </span>
<span class="4085483267574322897" onmouseenter="enter('4085483267574322897');" onmouseout="out('4085483267574322897');" style=""> 167                          if (tmpRhlClient != null) {                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 168                              try {                                                                                 </span>
<span class="7850927806873541940" onmouseenter="enter('7850927806873541940');" onmouseout="out('7850927806873541940');" style=""> 169                                  tmpRhlClient.close();                                                             </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 170                              } catch (IOException e) {                                                             </span>
<span class="-8675732820740656071" onmouseenter="enter('-8675732820740656071');" onmouseout="out('-8675732820740656071');" style=""> 171                                  LOG.warn(&quot;Failed to shut down tmpRhlClient.&quot;, e);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172                              }                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 175                  } else {                                                                                          </span>
<span class="-76198849307899404" onmouseenter="enter('-76198849307899404');" onmouseout="out('-76198849307899404');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                    dealMissKey(copyCrow, resultFuture);                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +                    dealMissKey(input, resultFuture);                                                             </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 178                      dealCacheData(key, CacheMissVal.getMissKeyObj());                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180              }                                                                                                     </span>
<span  style=""> 181                                                                                                                    </span>
<span class="4003793367426976429" onmouseenter="enter('4003793367426976429');" onmouseout="out('4003793367426976429');" style=""> 182              // 响应失败处理                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 183              @Override                                                                                             </span>
<span class="-7163255827414151868" onmouseenter="enter('-7163255827414151868');" onmouseout="out('-7163255827414151868');" style=""> 184              public void onFailure(Exception e) {                                                                  </span>
<span class="4414564665994806745" onmouseenter="enter('4414564665994806745');" onmouseout="out('4414564665994806745');" style=""> 185                  LOG.error(&quot;&quot; + e);                                                                                </span>
<span class="4670696633206156403" onmouseenter="enter('4670696633206156403');" onmouseout="out('4670696633206156403');" style=""> 186                  resultFuture.completeExceptionally(new RuntimeException(&quot;Response failed!&quot;));                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 188          });                                                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +    @Override                                                                                                     </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +    public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                                </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +        for (Object ele : inputParams.values()) {                                                                 </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 196 +            sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +                    .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 200 +        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201      }                                                                                                             </span>
<span  style=""> 202                                                                                                                    </span>
<span class="-4544381189301585527" onmouseenter="enter('-4544381189301585527');" onmouseout="out('-4544381189301585527');" style=""><abbr title=" 203      private void loadDataToCache(SearchHit[] searchHits, List&lt;CRow&gt; rowList, List&lt;Object&gt; cacheContent, CRow copyCrow) {"> 203      private void loadDataToCache(SearchHit[] searchHits, List&lt;CRow&gt; rowList, List&lt;Object&gt; cacheContent, CRow copyC🔵</abbr></span>

<span class="3556353181550267351" onmouseenter="enter('3556353181550267351');" onmouseout="out('3556353181550267351');" style=""> 204          List&lt;Object&gt; results = Lists.newArrayList();                                                              </span>
<span class="4685904830571915876" onmouseenter="enter('4685904830571915876');" onmouseout="out('4685904830571915876');" style=""> 205          for (SearchHit searchHit : searchHits) {                                                                  </span>
<span class="1081112597355792399" onmouseenter="enter('1081112597355792399');" onmouseout="out('1081112597355792399');" style=""> 206              Map&lt;String, Object&gt; object = searchHit.getSourceAsMap();                                              </span>
<span class="1222213862426007956" onmouseenter="enter('1222213862426007956');" onmouseout="out('1222213862426007956');" style=""> 207              results.add(object);                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208          }                                                                                                         </span>
<span class="-6436299581459780666" onmouseenter="enter('-6436299581459780666');" onmouseout="out('-6436299581459780666');" style=""> 209          rowList.addAll(getRows(copyCrow, cacheContent, results));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210      }                                                                                                             </span>
<span  style=""> 211                                                                                                                    </span>
<span class="7149157550499060002" onmouseenter="enter('7149157550499060002');" onmouseout="out('7149157550499060002');" style=""> 212      protected List&lt;CRow&gt; getRows(CRow inputRow, List&lt;Object&gt; cacheContent, List&lt;Object&gt; results) {                </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 213          List&lt;CRow&gt; rowList = Lists.newArrayList();                                                                </span>


<span class="-2659868438082068725" onmouseenter="enter('-2659868438082068725');" onmouseout="out('-2659868438082068725');" style=""> 214          for (Object line : results) {                                                                             </span>
<span class="6603283091960501091" onmouseenter="enter('6603283091960501091');" onmouseout="out('6603283091960501091');" style=""> 215              Row row = fillData(inputRow.row(), line);                                                             </span>

<span class="-831233364265775285" onmouseenter="enter('-831233364265775285');" onmouseout="out('-831233364265775285');" style=""> 216              if (null != cacheContent &amp;&amp; openCache()) {                                                            </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 217                  cacheContent.add(line);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218              }                                                                                                     </span>
<span class="-9214808964898811038" onmouseenter="enter('-9214808964898811038');" onmouseout="out('-9214808964898811038');" style=""> 219              rowList.add(new CRow(row, inputRow.change()));                                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220          }                                                                                                         </span>
<span class="-6950772790073726521" onmouseenter="enter('-6950772790073726521');" onmouseout="out('-6950772790073726521');" style=""> 221          return rowList;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222      }                                                                                                             </span>
<span  style=""> 223                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224      @Override                                                                                                     </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 225      public Row fillData(Row input, Object line) {                                                                 </span>
<span  style=""> 226                                                                                                                    </span>
<span class="-7430439483757714737" onmouseenter="enter('-7430439483757714737');" onmouseout="out('-7430439483757714737');" style=""> 227          Map&lt;String, Object&gt; cacheInfo = (Map&lt;String, Object&gt;) line;                                               </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 228          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="110652579211477887" onmouseenter="enter('110652579211477887');" onmouseout="out('110652579211477887');" style=""> 229          String[] fields = sideInfo.getSideTableInfo().getFieldTypes();                                            </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 230          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 231              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 232              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 232              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 233              if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 234                  obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235              }                                                                                                     </span>
<span  style=""> 236                                                                                                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 237              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238          }                                                                                                         </span>
<span  style=""> 239                                                                                                                    </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 240          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {                       </span>
<span class="-7181958017753483377" onmouseenter="enter('-7181958017753483377');" onmouseout="out('-7181958017753483377');" style=""> 241              if (cacheInfo == null) {                                                                              </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 242                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 243              } else {                                                                                              </span>
<span class="4790469862100725386" onmouseenter="enter('4790469862100725386');" onmouseout="out('4790469862100725386');" style=""><abbr title=" 244                  Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getKey())), fields[entry.getValue()]);"> 244                  Object object = SwitchUtil.getTarget(cacheInfo.get(sideInfo.getSideFieldNameIndex().get(entry.getK🔵</abbr></span>
<span class="-83073312517818987" onmouseenter="enter('-83073312517818987');" onmouseout="out('-83073312517818987');" style=""> 245                  row.setField(entry.getKey(), object);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247          }                                                                                                         </span>
<span  style=""> 248                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 249          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250      }                                                                                                             </span>
<span  style=""> 251                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 252      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 253      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 254          super.close();                                                                                            </span>
<span class="-7971333903947873763" onmouseenter="enter('-7971333903947873763');" onmouseout="out('-7971333903947873763');" style=""> 255          if (rhlClient != null) {                                                                                  </span>
<span class="-1010227642904461194" onmouseenter="enter('-1010227642904461194');" onmouseout="out('-1010227642904461194');" style=""> 256              rhlClient.close();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257          }                                                                                                         </span>
<span  style=""> 258                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259      }                                                                                                             </span>
<span  style=""> 260                                                                                                                    </span>
<span class="8381596313408135185" onmouseenter="enter('8381596313408135185');" onmouseout="out('8381596313408135185');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -    public String buildCacheKey(List equalValList) {                                                              </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="-2954267244038924423" onmouseenter="enter('-2954267244038924423');" onmouseout="out('-2954267244038924423');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -        for (Object ele : equalValList) {                                                                         </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -            sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                    .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                                                                                                                  </span>
<span class="8595548133522297711" onmouseenter="enter('8595548133522297711');" onmouseout="out('8595548133522297711');" style=""> 271      private SearchSourceBuilder initConfiguration() {                                                             </span>
<span class="-3057155605199132792" onmouseenter="enter('-3057155605199132792');" onmouseout="out('-3057155605199132792');" style=""> 272          SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();                                      </span>
<span class="9166141955334164362" onmouseenter="enter('9166141955334164362');" onmouseout="out('9166141955334164362');" style=""> 273          searchSourceBuilder.size(getFetchSize());                                                                 </span>
<span class="4871961152897776065" onmouseenter="enter('4871961152897776065');" onmouseout="out('4871961152897776065');" style=""> 274          searchSourceBuilder.sort(&quot;_id&quot;, SortOrder.DESC);                                                          </span>
<span class="8809866232242294416" onmouseenter="enter('8809866232242294416');" onmouseout="out('8809866232242294416');" style=""> 275          String[] sideFieldNames = StringUtils.split(sideInfo.getSideSelectFields().trim(), &quot;,&quot;);                  </span>
<span class="834931586921422776" onmouseenter="enter('834931586921422776');" onmouseout="out('834931586921422776');" style=""> 276          searchSourceBuilder.fetchSource(sideFieldNames, null);                                                    </span>
<span  style=""> 277                                                                                                                    </span>
<span class="6987226028729546159" onmouseenter="enter('6987226028729546159');" onmouseout="out('6987226028729546159');" style=""> 278          return searchSourceBuilder;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279      }                                                                                                             </span>
<span  style=""> 280                                                                                                                    </span>
<span class="-3730630656770699376" onmouseenter="enter('-3730630656770699376');" onmouseout="out('-3730630656770699376');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -    private BoolQueryBuilder setInputParams(List&lt;Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) {        </span>
<span class="4920427788170952721" onmouseenter="enter('4920427788170952721');" onmouseout="out('4920427788170952721');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 282 +    private BoolQueryBuilder setInputParams(Map&lt;String, Object&gt; inputParams, BoolQueryBuilder boolQueryBuilder) { </span>
<span class="-3342193056550698313" onmouseenter="enter('-3342193056550698313');" onmouseout="out('-3342193056550698313');" style=""> 283          if (boolQueryBuilder == null) {                                                                           </span>
<span class="7333898073462756397" onmouseenter="enter('7333898073462756397');" onmouseout="out('7333898073462756397');" style=""> 284              boolQueryBuilder = new BoolQueryBuilder();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285          }                                                                                                         </span>
<span  style=""> 286                                                                                                                    </span>
<span class="-376702721623965324" onmouseenter="enter('-376702721623965324');" onmouseout="out('-376702721623965324');" style=""> 287          for (int i = 0; i &lt; sqlJoinCompareOperate.size(); i++) {                                                  </span>
<span class="2520409669614252080" onmouseenter="enter('2520409669614252080');" onmouseout="out('2520409669614252080');" style=""> 288              String fieldName = sideInfo.getEqualFieldList().get(i);                                               </span>
<span class="5839403981341076602" onmouseenter="enter('5839403981341076602');" onmouseout="out('5839403981341076602');" style=""> 289              String operatorKind = sqlJoinCompareOperate.get(sideInfo.getEqualFieldList().indexOf(fieldName));     </span>
<span class="-1399945515306319928" onmouseenter="enter('-1399945515306319928');" onmouseout="out('-1399945515306319928');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -            String condition = String.valueOf(inputParams.get(i));                                                </span>
<span class="5213198617102891771" onmouseenter="enter('5213198617102891771');" onmouseout="out('5213198617102891771');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 291 +            String condition = String.valueOf(inputParams.get(fieldName));                                        </span>
<span class="6650387404622288325" onmouseenter="enter('6650387404622288325');" onmouseout="out('6650387404622288325');" style=""><abbr title=" 292              boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind, null, fieldName, condition), sideInfo);"> 292              boolQueryBuilder = Es6Util.buildFilterCondition(boolQueryBuilder, new PredicateInfo(null, operatorKind🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293          }                                                                                                         </span>
<span  style=""> 294                                                                                                                    </span>
<span class="715229971287047855" onmouseenter="enter('715229971287047855');" onmouseout="out('715229971287047855');" style=""> 295          return boolQueryBuilder;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296      }                                                                                                             </span>
<span  style=""> 297                                                                                                                    </span>
<span class="-7768596139566319511" onmouseenter="enter('-7768596139566319511');" onmouseout="out('-7768596139566319511');" style=""> 298      public int getFetchSize() {                                                                                   </span>
<span class="-5665804692852603146" onmouseenter="enter('-5665804692852603146');" onmouseout="out('-5665804692852603146');" style=""> 299          return 1000;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            