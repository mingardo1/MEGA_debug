<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>436</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    436
                    <a href="435.html">prev</a>
                    <a href="437.html">next</a>
                    <a href="436_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_08eab84481ddc54518a8d0a2edc0fe5de5815a24_launcher/src/main/java/com/dtstack/flink/sql/launcher/perjob/PerJobSubmitter.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;08eab84481ddc54518a8d0a2edc0fe5de5815a24:launcher/src/main/java/com/dtstack/flink/sql/launcher/perjob/PerJobSubmitter.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;08eab84481ddc54518a8d0a2edc0fe5de5815a24^1:launcher/src/main/java/com/dtstack/flink/sql/launcher/perjob/PerJobSubmitter.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;08eab84481ddc54518a8d0a2edc0fe5de5815a24^2:launcher/src/main/java/com/dtstack/flink/sql/launcher/perjob/PerJobSubmitter.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;37844f41df13ae43fdf96bea35193ae6991feb67:launcher/src/main/java/com/dtstack/flink/sql/launcher/perjob/PerJobSubmitter.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bsj]], subset: [[bsj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">   2 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.launcher.perjob;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import org.apache.flink.client.deployment.ClusterSpecification;                                          </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import org.apache.flink.client.program.ClusterClient;                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.flink.core.fs.Path;                                                                    </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import org.apache.hadoop.yarn.api.records.ApplicationId;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import java.net.URLDecoder;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.util.List;                                                                                   </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.Properties;                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 /**                                                                                                      </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43  * per job mode submitter                                                                                </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44  * Date: 2018/11/17                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48                                                                                                          </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 public class PerJobSubmitter {                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50                                                                                                          </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51     private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52                                                                                                          </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  53     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {">  53     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) thðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 		if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                               </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 			String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());        </span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 			List&lt;String&gt; paths = getJarPaths(addjarPath);                                                         </span>
<span class="-7680899635305784064" onmouseenter="enter('-7680899635305784064');" onmouseout="out('-7680899635305784064');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 			paths.forEach( path -&gt; {                                                                              </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 				jobGraph.addJar(new Path(&quot;file://&quot; + path));                                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 			});                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 		}                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61                                                                                                          </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62 		String confProp = launcherOptions.getConfProp();                                                       </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  65         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);">  65         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(coðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66                                                                                                          </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67         PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();        </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68         perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69                                                                                                          </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70         String flinkJarPath = launcherOptions.getFlinkJarPath();                                         </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  71         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);">  71         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusðŸ”µ</abbr></span>
<span class="8364713403186571412" onmouseenter="enter('8364713403186571412');" onmouseout="out('8364713403186571412');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  72         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph,true);">  72         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecifðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73                                                                                                          </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74         String applicationId = clusterClient.getClusterId().toString();                                  </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75         String flinkJobId = jobGraph.getJobID().toString();                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  77         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);">  77         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobIdðŸ”µ</abbr></span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78         LOG.info(tips);                                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80         return applicationId;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82                                                                                                          </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83 	private static List&lt;String&gt; getJarPaths(String addjarPath) {                                            </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84 		if (addjarPath.length() &gt; 2) {                                                                         </span>
<span class="1423622025708366882" onmouseenter="enter('1423622025708366882');" onmouseout="out('1423622025708366882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85 			addjarPath = addjarPath.substring(1,addjarPath.length()-1).replace(&quot;\&quot;&quot;,&quot;&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86 		}                                                                                                      </span>
<span class="5305471409849642157" onmouseenter="enter('5305471409849642157');" onmouseout="out('5305471409849642157');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87         List&lt;String&gt; paths = Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                          </span>
<span class="8186781474104762938" onmouseenter="enter('8186781474104762938');" onmouseout="out('8186781474104762938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88 		return paths;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  92 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  96  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  97  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  98  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  99  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 100  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 101  *                                                                                                       </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 103  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 104  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110                                                                                                          </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111 package com.dtstack.flink.sql.launcher.perjob;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112                                                                                                          </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113 import org.apache.flink.client.deployment.ClusterSpecification;                                          </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114 import org.apache.flink.client.program.ClusterClient;                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116 import org.apache.flink.core.fs.Path;                                                                    </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118 import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124 import org.apache.hadoop.yarn.api.records.ApplicationId;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127                                                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128 import java.net.URLDecoder;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130 import java.util.List;                                                                                   </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131 import java.util.Properties;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133 /**                                                                                                      </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134  * per job mode submitter                                                                                </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135  * Date: 2018/11/17                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137  *                                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140                                                                                                          </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141 public class PerJobSubmitter {                                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142                                                                                                          </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143     private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                                                                                                          </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 145     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {"> 145     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) thðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146         if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                         </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 147             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());"> 147             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString())ðŸ”µ</abbr></span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148             List&lt;String&gt; paths = getJarPaths(addjarPath);                                                </span>
<span class="1044164680324517553" onmouseenter="enter('1044164680324517553');" onmouseout="out('1044164680324517553');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149             paths.forEach(path -&gt; {                                                                      </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                 jobGraph.addJar(new Path(&quot;file://&quot; + path));                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                                                                                                          </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154         String confProp = launcherOptions.getConfProp();                                                 </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 157         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);"> 157         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(coðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158                                                                                                          </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159         PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();        </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160         perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161                                                                                                          </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162         String flinkJarPath = launcherOptions.getFlinkJarPath();                                         </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 163         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);"> 163         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusðŸ”µ</abbr></span>
<span class="-1346885163643707620" onmouseenter="enter('-1346885163643707620');" onmouseout="out('-1346885163643707620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 164         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph, true);"> 164         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecifðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165                                                                                                          </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166         String applicationId = clusterClient.getClusterId().toString();                                  </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167         String flinkJobId = jobGraph.getJobID().toString();                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168                                                                                                          </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 169         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);"> 169         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobIdðŸ”µ</abbr></span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170         LOG.info(tips);                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171                                                                                                          </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172         return applicationId;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174                                                                                                          </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175     private static List&lt;String&gt; getJarPaths(String addjarPath) {                                         </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176         if (addjarPath.length() &gt; 2) {                                                                   </span>
<span class="-8318412785367110951" onmouseenter="enter('-8318412785367110951');" onmouseout="out('-8318412785367110951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177             addjarPath = addjarPath.substring(1, addjarPath.length() - 1).replace(&quot;\&quot;&quot;, &quot;&quot;);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178         }                                                                                                </span>
<span class="-4387555468779506163" onmouseenter="enter('-4387555468779506163');" onmouseout="out('-4387555468779506163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179         return Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182 }                                                                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 183 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span></pre></td>
                            <td><pre><span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.launcher.perjob;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import org.apache.flink.client.deployment.ClusterSpecification;                                          </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import org.apache.flink.client.program.ClusterClient;                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.flink.core.fs.Path;                                                                    </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import org.apache.hadoop.yarn.api.records.ApplicationId;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import java.net.URLDecoder;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.util.List;                                                                                   </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.Properties;                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 /**                                                                                                      </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43  * per job mode submitter                                                                                </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44  * Date: 2018/11/17                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48                                                                                                          </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 public class PerJobSubmitter {                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50                                                                                                          </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51     private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52                                                                                                          </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  53     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {">  53     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) thðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 		if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                               </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 			String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());        </span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 			List&lt;String&gt; paths = getJarPaths(addjarPath);                                                         </span>
<span class="-7680899635305784064" onmouseenter="enter('-7680899635305784064');" onmouseout="out('-7680899635305784064');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 			paths.forEach( path -&gt; {                                                                              </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 				jobGraph.addJar(new Path(&quot;file://&quot; + path));                                                         </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 			});                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 		}                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61                                                                                                          </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62 		String confProp = launcherOptions.getConfProp();                                                       </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  65         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);">  65         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(coðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66                                                                                                          </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67         PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();        </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68         perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69                                                                                                          </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70         String flinkJarPath = launcherOptions.getFlinkJarPath();                                         </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  71         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);">  71         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusðŸ”µ</abbr></span>
<span class="8364713403186571412" onmouseenter="enter('8364713403186571412');" onmouseout="out('8364713403186571412');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  72         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph,true);">  72         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecifðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73                                                                                                          </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74         String applicationId = clusterClient.getClusterId().toString();                                  </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75         String flinkJobId = jobGraph.getJobID().toString();                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  77         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);">  77         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobIdðŸ”µ</abbr></span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78         LOG.info(tips);                                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80         return applicationId;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82                                                                                                          </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83 	private static List&lt;String&gt; getJarPaths(String addjarPath) {                                            </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84 		if (addjarPath.length() &gt; 2) {                                                                         </span>
<span class="1423622025708366882" onmouseenter="enter('1423622025708366882');" onmouseout="out('1423622025708366882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85 			addjarPath = addjarPath.substring(1,addjarPath.length()-1).replace(&quot;\&quot;&quot;,&quot;&quot;);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86 		}                                                                                                      </span>
<span class="5305471409849642157" onmouseenter="enter('5305471409849642157');" onmouseout="out('5305471409849642157');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87         List&lt;String&gt; paths = Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                          </span>
<span class="8186781474104762938" onmouseenter="enter('8186781474104762938');" onmouseout="out('8186781474104762938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88 		return paths;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  92 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  96  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  97  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  98  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  99  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 100  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 101  *                                                                                                       </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 103  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 104  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110                                                                                                          </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111 package com.dtstack.flink.sql.launcher.perjob;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112                                                                                                          </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113 import org.apache.flink.client.deployment.ClusterSpecification;                                          </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114 import org.apache.flink.client.program.ClusterClient;                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116 import org.apache.flink.core.fs.Path;                                                                    </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118 import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124 import org.apache.hadoop.yarn.api.records.ApplicationId;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127                                                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128 import java.net.URLDecoder;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130 import java.util.List;                                                                                   </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131 import java.util.Properties;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133 /**                                                                                                      </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134  * per job mode submitter                                                                                </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135  * Date: 2018/11/17                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137  *                                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140                                                                                                          </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141 public class PerJobSubmitter {                                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142                                                                                                          </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143     private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                                                                                                          </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 145     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {"> 145     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) thðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146         if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                         </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 147             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());"> 147             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString())ðŸ”µ</abbr></span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148             List&lt;String&gt; paths = getJarPaths(addjarPath);                                                </span>
<span class="1044164680324517553" onmouseenter="enter('1044164680324517553');" onmouseout="out('1044164680324517553');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149             paths.forEach(path -&gt; {                                                                      </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150                 jobGraph.addJar(new Path(&quot;file://&quot; + path));                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                                                                                                          </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154         String confProp = launcherOptions.getConfProp();                                                 </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 157         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);"> 157         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(coðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158                                                                                                          </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159         PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();        </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160         perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161                                                                                                          </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162         String flinkJarPath = launcherOptions.getFlinkJarPath();                                         </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 163         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);"> 163         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusðŸ”µ</abbr></span>
<span class="-1346885163643707620" onmouseenter="enter('-1346885163643707620');" onmouseout="out('-1346885163643707620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 164         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph, true);"> 164         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecifðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165                                                                                                          </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166         String applicationId = clusterClient.getClusterId().toString();                                  </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167         String flinkJobId = jobGraph.getJobID().toString();                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168                                                                                                          </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 169         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);"> 169         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobIdðŸ”µ</abbr></span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170         LOG.info(tips);                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171                                                                                                          </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172         return applicationId;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174                                                                                                          </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175     private static List&lt;String&gt; getJarPaths(String addjarPath) {                                         </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176         if (addjarPath.length() &gt; 2) {                                                                   </span>
<span class="-8318412785367110951" onmouseenter="enter('-8318412785367110951');" onmouseout="out('-8318412785367110951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177             addjarPath = addjarPath.substring(1, addjarPath.length() - 1).replace(&quot;\&quot;&quot;, &quot;&quot;);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178         }                                                                                                </span>
<span class="-4387555468779506163" onmouseenter="enter('-4387555468779506163');" onmouseout="out('-4387555468779506163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179         return Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182 }                                                                                                        </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 183 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span></pre></td>
                            <td><pre><span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">   4 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   5                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   6 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   7  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   8  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   9  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  10  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  11  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  12  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  13  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  14  *                                                                                                       </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  15  * http://www.apache.org/licenses/LICENSE-2.0                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  16  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  17  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  18  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  19  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  20  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  21  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  22  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  23                                                                                                          </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  24 package com.dtstack.flink.sql.launcher.perjob;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  25                                                                                                          </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  26 import org.apache.flink.client.deployment.ClusterSpecification;                                          </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  27 import org.apache.flink.client.program.ClusterClient;                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  28 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  29 import org.apache.flink.core.fs.Path;                                                                    </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  30 import org.apache.flink.runtime.jobgraph.JobGraph;                                                       </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  31 import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import org.apache.hadoop.yarn.api.records.ApplicationId;                                                 </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  39 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  40                                                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  41 import java.net.URLDecoder;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  43 import java.util.List;                                                                                   </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  44 import java.util.Properties;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  45                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  46 /**                                                                                                      </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  47  * per job mode submitter                                                                                </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  48  * Date: 2018/11/17                                                                                      </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  49  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  50  *                                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  53                                                                                                          </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  54 public class PerJobSubmitter {                                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55                                                                                                          </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56     private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  57                                                                                                          </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  58     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {">  58     public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) thðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59         if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                         </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  60             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());">  60             String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString())ðŸ”µ</abbr></span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61             List&lt;String&gt; paths = getJarPaths(addjarPath);                                                </span>
<span class="1044164680324517553" onmouseenter="enter('1044164680324517553');" onmouseout="out('1044164680324517553');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62             paths.forEach(path -&gt; {                                                                      </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63                 jobGraph.addJar(new Path(&quot;file://&quot; + path));                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66                                                                                                          </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67         String confProp = launcherOptions.getConfProp();                                                 </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  68         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  70         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);">  70         ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(coðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  71                                                                                                          </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72         PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();        </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  73         perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  74                                                                                                          </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  75         String flinkJarPath = launcherOptions.getFlinkJarPath();                                         </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  76         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);">  76         AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusðŸ”µ</abbr></span>
<span class="-1346885163643707620" onmouseenter="enter('-1346885163643707620');" onmouseout="out('-1346885163643707620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  77         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph, true);">  77         ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecifðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  78                                                                                                          </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  79         String applicationId = clusterClient.getClusterId().toString();                                  </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  80         String flinkJobId = jobGraph.getJobID().toString();                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81                                                                                                          </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  82         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);">  82         String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobIdðŸ”µ</abbr></span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83         LOG.info(tips);                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  84                                                                                                          </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  85         return applicationId;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  86     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  87                                                                                                          </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88     private static List&lt;String&gt; getJarPaths(String addjarPath) {                                         </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89         if (addjarPath.length() &gt; 2) {                                                                   </span>
<span class="-8318412785367110951" onmouseenter="enter('-8318412785367110951');" onmouseout="out('-8318412785367110951');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  90             addjarPath = addjarPath.substring(1, addjarPath.length() - 1).replace(&quot;\&quot;&quot;, &quot;&quot;);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91         }                                                                                                </span>
<span class="-4387555468779506163" onmouseenter="enter('-4387555468779506163');" onmouseout="out('-4387555468779506163');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  92         return Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95 }                                                                                                        </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style="">  96 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>





















































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   1 -/*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   2 - * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   3 - * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   4 - * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   5 - * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   6 - * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   7 - * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   8 - * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   9 - *                                                                                                                </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  10 - * http://www.apache.org/licenses/LICENSE-2.0                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  11 - *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  12 - * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  13 - * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  14 - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  15 - * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  16 - * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  17 - */                                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  18 -                                                                                                                  </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -package com.dtstack.flink.sql.launcher.perjob;                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -                                                                                                                  </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import org.apache.flink.client.deployment.ClusterSpecification;                                                   </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import org.apache.flink.client.program.ClusterClient;                                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import org.apache.flink.core.fs.Path;                                                                             </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import org.apache.flink.runtime.jobgraph.JobGraph;                                                                </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -                                                                                                                  </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import org.apache.hadoop.yarn.api.records.ApplicationId;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.slf4j.LoggerFactory;                                                                                   </span>

<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import java.net.URLDecoder;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import java.util.List;                                                                                            </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import java.util.Properties;                                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -/**                                                                                                               </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 - * per job mode submitter                                                                                         </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 - * Date: 2018/11/17                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 - * Company: www.dtstack.com                                                                                       </span>

<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 - * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 - */                                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -                                                                                                                  </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -public class PerJobSubmitter {                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -                                                                                                                  </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -    private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -                                                                                                                  </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  51 -    public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {">  51 -    public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws ExceðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -		if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                                        </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -			String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());                 </span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -			List&lt;String&gt; paths = getJarPaths(addjarPath);                                                                  </span>
<span class="-7680899635305784064" onmouseenter="enter('-7680899635305784064');" onmouseout="out('-7680899635305784064');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -			paths.forEach( path -&gt; {                                                                                       </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -				jobGraph.addJar(new Path(&quot;file://&quot; + path));                                                                  </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -			});                                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -		}                                                                                                               </span>







<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -                                                                                                                  </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -		String confProp = launcherOptions.getConfProp();                                                                </span>

<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -        confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -        Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  63 -        ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);">  63 -        ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confPropertðŸ”µ</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -                                                                                                                  </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -        PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();                 </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -        perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -                                                                                                                  </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -        String flinkJarPath = launcherOptions.getFlinkJarPath();                                                  </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  69 -        AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);">  69 -        AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriðŸ”µ</abbr></span>
<span class="8364713403186571412" onmouseenter="enter('8364713403186571412');" onmouseout="out('8364713403186571412');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  70 -        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph,true);">  70 -        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, ðŸ”µ</abbr></span>

<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -                                                                                                                  </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -        String applicationId = clusterClient.getClusterId().toString();                                           </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -        String flinkJobId = jobGraph.getJobID().toString();                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -                                                                                                                  </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -        String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);       </span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -        LOG.info(tips);                                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -        return applicationId;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -                                                                                                                  </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -	private static List&lt;String&gt; getJarPaths(String addjarPath) {                                                     </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -		if (addjarPath.length() &gt; 2) {                                                                                  </span>
<span class="1423622025708366882" onmouseenter="enter('1423622025708366882');" onmouseout="out('1423622025708366882');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -			addjarPath = addjarPath.substring(1,addjarPath.length()-1).replace(&quot;\&quot;&quot;,&quot;&quot;);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -		}                                                                                                               </span>
<span class="5305471409849642157" onmouseenter="enter('5305471409849642157');" onmouseout="out('5305471409849642157');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -        List&lt;String&gt; paths = Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                   </span>
<span class="8186781474104762938" onmouseenter="enter('8186781474104762938');" onmouseout="out('8186781474104762938');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -		return paths;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -	}                                                                                                                </span>






<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -}                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="3430964305904514764" onmouseenter="enter('3430964305904514764');" onmouseout="out('3430964305904514764');" style="">  10   * http://www.apache.org/licenses/LICENSE-2.0                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-5006285784235111074" onmouseenter="enter('-5006285784235111074');" onmouseout="out('-5006285784235111074');" style="">  19  package com.dtstack.flink.sql.launcher.perjob;                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="4663628025268732131" onmouseenter="enter('4663628025268732131');" onmouseout="out('4663628025268732131');" style="">  21  import org.apache.flink.client.deployment.ClusterSpecification;                                                   </span>
<span class="-5018311972488265281" onmouseenter="enter('-5018311972488265281');" onmouseout="out('-5018311972488265281');" style="">  22  import org.apache.flink.client.program.ClusterClient;                                                             </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-8526143383380423845" onmouseenter="enter('-8526143383380423845');" onmouseout="out('-8526143383380423845');" style="">  24  import org.apache.flink.core.fs.Path;                                                                             </span>
<span class="-6474637415233155773" onmouseenter="enter('-6474637415233155773');" onmouseout="out('-6474637415233155773');" style="">  25  import org.apache.flink.runtime.jobgraph.JobGraph;                                                                </span>
<span class="2707853699459523291" onmouseenter="enter('2707853699459523291');" onmouseout="out('2707853699459523291');" style="">  26  import org.apache.flink.yarn.AbstractYarnClusterDescriptor;                                                       </span>
<span  style="">  27                                                                                                                    </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="">  28  import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="">  29  import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="">  30  import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  31  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="8458556742018191597" onmouseenter="enter('8458556742018191597');" onmouseout="out('8458556742018191597');" style="">  32  import org.apache.hadoop.yarn.api.records.ApplicationId;                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +                                                                                                                  </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  36  import java.net.URLDecoder;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  37  import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  38  import java.util.List;                                                                                            </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  39  import java.util.Properties;                                                                                      </span>
<span  style="">  40                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  41  /**                                                                                                               </span>
<span class="7123715817141786168" onmouseenter="enter('7123715817141786168');" onmouseout="out('7123715817141786168');" style="">  42   * per job mode submitter                                                                                         </span>
<span class="7837567593544302859" onmouseenter="enter('7837567593544302859');" onmouseout="out('7837567593544302859');" style="">  43   * Date: 2018/11/17                                                                                               </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  44   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 + *                                                                                                                </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  46   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47   */                                                                                                               </span>
<span  style="">  48                                                                                                                    </span>
<span class="3377122969497866415" onmouseenter="enter('3377122969497866415');" onmouseout="out('3377122969497866415');" style="">  49  public class PerJobSubmitter {                                                                                    </span>
<span  style="">  50                                                                                                                    </span>
<span class="-1017361202027765577" onmouseenter="enter('-1017361202027765577');" onmouseout="out('-1017361202027765577');" style="">  51      private static final Logger LOG = LoggerFactory.getLogger(PerJobSubmitter.class);                             </span>
<span  style="">  52                                                                                                                    </span>
<span class="3092889695602608034" onmouseenter="enter('3092889695602608034');" onmouseout="out('3092889695602608034');" style=""><abbr title="  53      public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws Exception {">  53      public static String submit(Options launcherOptions, JobGraph jobGraph, Configuration flinkConfig) throws ExceðŸ”µ</abbr></span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -		if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                                        </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -			String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());                 </span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -			List&lt;String&gt; paths = getJarPaths(addjarPath);                                                                  </span>
<span class="-7680899635305784064" onmouseenter="enter('-7680899635305784064');" onmouseout="out('-7680899635305784064');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -			paths.forEach( path -&gt; {                                                                                       </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -				jobGraph.addJar(new Path(&quot;file://&quot; + path));                                                                  </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -			});                                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -		}                                                                                                               </span>
<span class="-7802743365346051264" onmouseenter="enter('-7802743365346051264');" onmouseout="out('-7802743365346051264');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +        if (!StringUtils.isBlank(launcherOptions.getAddjar())) {                                                  </span>
<span class="1818214181612695148" onmouseenter="enter('1818214181612695148');" onmouseout="out('1818214181612695148');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +            String addjarPath = URLDecoder.decode(launcherOptions.getAddjar(), Charsets.UTF_8.toString());        </span>
<span class="-2689018095776785871" onmouseenter="enter('-2689018095776785871');" onmouseout="out('-2689018095776785871');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +            List&lt;String&gt; paths = getJarPaths(addjarPath);                                                         </span>
<span class="1044164680324517553" onmouseenter="enter('1044164680324517553');" onmouseout="out('1044164680324517553');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +            paths.forEach(path -&gt; {                                                                               </span>
<span class="8965903125941207284" onmouseenter="enter('8965903125941207284');" onmouseout="out('8965903125941207284');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +                jobGraph.addJar(new Path(&quot;file://&quot; + path));                                                      </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +            });                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +        }                                                                                                         </span>
<span  style="">  68                                                                                                                    </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -		String confProp = launcherOptions.getConfProp();                                                                </span>
<span class="-8613862997215694955" onmouseenter="enter('-8613862997215694955');" onmouseout="out('-8613862997215694955');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +        String confProp = launcherOptions.getConfProp();                                                          </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="">  71          confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="">  72          Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6440692160337964346" onmouseenter="enter('-6440692160337964346');" onmouseout="out('-6440692160337964346');" style=""><abbr title="  73          ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confProperties);">  73          ClusterSpecification clusterSpecification = FLinkPerJobResourceUtil.createClusterSpecification(confPropertðŸ”µ</abbr></span>
<span  style="">  74                                                                                                                    </span>
<span class="-5522307872332397616" onmouseenter="enter('-5522307872332397616');" onmouseout="out('-5522307872332397616');" style="">  75          PerJobClusterClientBuilder perJobClusterClientBuilder = new PerJobClusterClientBuilder();                 </span>
<span class="-514331363493710865" onmouseenter="enter('-514331363493710865');" onmouseout="out('-514331363493710865');" style="">  76          perJobClusterClientBuilder.init(launcherOptions.getYarnconf(), flinkConfig, confProperties);              </span>
<span  style="">  77                                                                                                                    </span>
<span class="4151944349689154750" onmouseenter="enter('4151944349689154750');" onmouseout="out('4151944349689154750');" style="">  78          String flinkJarPath = launcherOptions.getFlinkJarPath();                                                  </span>
<span class="-5441110087747984200" onmouseenter="enter('-5441110087747984200');" onmouseout="out('-5441110087747984200');" style=""><abbr title="  79          AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriptor(flinkJarPath, launcherOptions, jobGraph);">  79          AbstractYarnClusterDescriptor yarnClusterDescriptor = perJobClusterClientBuilder.createPerJobClusterDescriðŸ”µ</abbr></span>
<span class="8364713403186571412" onmouseenter="enter('8364713403186571412');" onmouseout="out('8364713403186571412');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title="  80 -        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph,true);">  80 -        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, ðŸ”µ</abbr></span>
<span class="-1346885163643707620" onmouseenter="enter('-1346885163643707620');" onmouseout="out('-1346885163643707620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  81 +        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, jobGraph, true);">  81 +        ClusterClient&lt;ApplicationId&gt; clusterClient = yarnClusterDescriptor.deployJobCluster(clusterSpecification, ðŸ”µ</abbr></span>
<span  style="">  82                                                                                                                    </span>
<span class="-2096753616670243855" onmouseenter="enter('-2096753616670243855');" onmouseout="out('-2096753616670243855');" style="">  83          String applicationId = clusterClient.getClusterId().toString();                                           </span>
<span class="1386237746623420087" onmouseenter="enter('1386237746623420087');" onmouseout="out('1386237746623420087');" style="">  84          String flinkJobId = jobGraph.getJobID().toString();                                                       </span>
<span  style="">  85                                                                                                                    </span>
<span class="-6884409582660527683" onmouseenter="enter('-6884409582660527683');" onmouseout="out('-6884409582660527683');" style="">  86          String tips = String.format(&quot;deploy per_job with appId: %s, jobId: %s&quot;, applicationId, flinkJobId);       </span>
<span class="5007677796089481960" onmouseenter="enter('5007677796089481960');" onmouseout="out('5007677796089481960');" style="">  87          LOG.info(tips);                                                                                           </span>
<span  style="">  88                                                                                                                    </span>
<span class="5985572316486027976" onmouseenter="enter('5985572316486027976');" onmouseout="out('5985572316486027976');" style="">  89          return applicationId;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -	private static List&lt;String&gt; getJarPaths(String addjarPath) {                                                     </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -		if (addjarPath.length() &gt; 2) {                                                                                  </span>
<span class="1423622025708366882" onmouseenter="enter('1423622025708366882');" onmouseout="out('1423622025708366882');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -			addjarPath = addjarPath.substring(1,addjarPath.length()-1).replace(&quot;\&quot;&quot;,&quot;&quot;);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -		}                                                                                                               </span>
<span class="5305471409849642157" onmouseenter="enter('5305471409849642157');" onmouseout="out('5305471409849642157');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -        List&lt;String&gt; paths = Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                   </span>
<span class="8186781474104762938" onmouseenter="enter('8186781474104762938');" onmouseout="out('8186781474104762938');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -		return paths;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -	}                                                                                                                </span>
<span class="-8631295093790721471" onmouseenter="enter('-8631295093790721471');" onmouseout="out('-8631295093790721471');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +    private static List&lt;String&gt; getJarPaths(String addjarPath) {                                                  </span>
<span class="-2710628728024984859" onmouseenter="enter('-2710628728024984859');" onmouseout="out('-2710628728024984859');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +        if (addjarPath.length() &gt; 2) {                                                                            </span>
<span class="-8318412785367110951" onmouseenter="enter('-8318412785367110951');" onmouseout="out('-8318412785367110951');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +            addjarPath = addjarPath.substring(1, addjarPath.length() - 1).replace(&quot;\&quot;&quot;, &quot;&quot;);                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +        }                                                                                                         </span>
<span class="-4387555468779506163" onmouseenter="enter('-4387555468779506163');" onmouseout="out('-4387555468779506163');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +        return Arrays.asList(StringUtils.split(addjarPath, &quot;,&quot;));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +    }                                                                                                             </span>
<span  style=""> 105                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            