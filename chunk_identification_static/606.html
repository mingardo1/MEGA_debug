<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>606</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    606
                    <a href="605.html">prev</a>
                    <a href="607.html">next</a>
                    <a href="606_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_f389ba111b6d691ecd5b0f2b8c9c050a03e595ad_core/src/main/java/com/dtstack/flink/sql/Main.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f389ba111b6d691ecd5b0f2b8c9c050a03e595ad:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f389ba111b6d691ecd5b0f2b8c9c050a03e595ad^1:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f389ba111b6d691ecd5b0f2b8c9c050a03e595ad^2:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;7c3f0a268d1fad776168ebb3b721653f7043ca97:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [b], [j], [j]], subset: [[b], [b], [b], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20 package com.dtstack.flink.sql;                                                                           </span>
<span  style="">  21                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  22 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23                                                                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24                                                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  25 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import com.dtstack.flink.sql.config.CalciteConfig;                                                       </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                             </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import com.dtstack.flink.sql.enums.ClusterMode;                                                          </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                       </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                         </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import com.dtstack.flink.sql.option.OptionParser;                                                        </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import com.dtstack.flink.sql.parser.CreateFuncParser;                                                    </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import com.dtstack.flink.sql.parser.InsertSqlParser;                                                     </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import com.dtstack.flink.sql.parser.SqlParser;                                                           </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import com.dtstack.flink.sql.parser.SqlTree;                                                             </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import com.dtstack.flink.sql.side.SideSqlExec;                                                           </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import com.dtstack.flink.sql.side.SideTableInfo;                                                         </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import com.dtstack.flink.sql.table.SourceTableInfo;                                                      </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import com.dtstack.flink.sql.table.TargetTableInfo;                                                      </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44 import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                     </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import com.dtstack.flink.sql.source.StreamSourceFactory;                                                 </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                            </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import com.dtstack.flink.sql.function.FunctionManager;                                                   </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 import com.google.common.base.Strings;                                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 import com.google.common.collect.Maps;                                                                   </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 import com.google.common.collect.Sets;                                                                   </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  62 =======                                                                                                  </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63 import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                             </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64 import com.dtstack.flink.sql.enums.ClusterMode;                                                          </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66 import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                       </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67 import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                         </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  68 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69 import com.dtstack.flink.sql.option.OptionParser;                                                        </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  70 import com.dtstack.flink.sql.parser.CreateFuncParser;                                                    </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  71 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  73 import com.dtstack.flink.sql.parser.InsertSqlParser;                                                     </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  74 import com.dtstack.flink.sql.parser.SqlParser;                                                           </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  75 import com.dtstack.flink.sql.parser.SqlTree;                                                             </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  76 import com.dtstack.flink.sql.side.SideSqlExec;                                                           </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  77 import com.dtstack.flink.sql.side.SideTableInfo;                                                         </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  78 import com.dtstack.flink.sql.table.SourceTableInfo;                                                      </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  79 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  80 import com.dtstack.flink.sql.table.TargetTableInfo;                                                      </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81 import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                     </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  82 import com.dtstack.flink.sql.source.StreamSourceFactory;                                                 </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  84 import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                            </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  85 import com.dtstack.flink.sql.function.FunctionManager;                                                   </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  86 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  87 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  90 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  92 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93 import com.google.common.base.Strings;                                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95 import com.google.common.collect.Maps;                                                                   </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  96 import com.google.common.collect.Sets;                                                                   </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  97 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  98 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  99 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style=""> 100 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 101 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 102                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 103 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 104 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 105 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107 import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                       </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108 import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                         </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109 import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                          </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110 import com.dtstack.flink.sql.option.OptionParser;                                                        </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111 import com.dtstack.flink.sql.parser.CreateFuncParser;                                                    </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113 import com.dtstack.flink.sql.parser.InsertSqlParser;                                                     </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114 import com.dtstack.flink.sql.parser.SqlParser;                                                           </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115 import com.dtstack.flink.sql.parser.SqlTree;                                                             </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116 import com.dtstack.flink.sql.side.SideSqlExec;                                                           </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117 import com.dtstack.flink.sql.side.SideTableInfo;                                                         </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118 import com.dtstack.flink.sql.table.SourceTableInfo;                                                      </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120 import com.dtstack.flink.sql.table.TargetTableInfo;                                                      </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121 import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                     </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122 import com.dtstack.flink.sql.source.StreamSourceFactory;                                                 </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124 import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                            </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125 import com.dtstack.flink.sql.function.FunctionManager;                                                   </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133 import com.google.common.base.Strings;                                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135 import com.google.common.collect.Maps;                                                                   </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136 import com.google.common.collect.Sets;                                                                   </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142 import org.apache.flink.table.api.TableEnvironment;                                                      </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144 import org.apache.flink.table.sinks.TableSink;                                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146 import org.slf4j.Logger;                                                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 147 =======                                                                                                  </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150 import org.apache.flink.table.api.TableEnvironment;                                                      </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153 import org.apache.flink.table.sinks.TableSink;                                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154 import org.apache.flink.types.Row;                                                                       </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 155 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style=""> 156 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style=""> 157 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style=""> 158                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 159 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 160 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161 import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162 import com.dtstack.flink.sql.parser.InsertSqlParser;                                                     </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163 import com.dtstack.flink.sql.parser.SqlParser;                                                           </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164 import com.dtstack.flink.sql.parser.SqlTree;                                                             </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 import com.dtstack.flink.sql.side.SideSqlExec;                                                           </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166 import com.dtstack.flink.sql.side.SideTableInfo;                                                         </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167 import com.dtstack.flink.sql.table.SourceTableInfo;                                                      </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168 import com.dtstack.flink.sql.table.TableInfo;                                                            </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169 import com.dtstack.flink.sql.table.TargetTableInfo;                                                      </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170 import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                     </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171 import com.dtstack.flink.sql.source.StreamSourceFactory;                                                 </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173 import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                            </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174 import com.dtstack.flink.sql.function.FunctionManager;                                                   </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182 import com.google.common.base.Strings;                                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184 import com.google.common.collect.Maps;                                                                   </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185 import com.google.common.collect.Sets;                                                                   </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191 import org.apache.flink.table.api.TableEnvironment;                                                      </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193 import org.apache.flink.table.sinks.TableSink;                                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198 import java.io.File;                                                                                     </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200 import java.net.URL;                                                                                     </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201 import java.net.URLClassLoader;                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202 import java.net.URLDecoder;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204 import java.util.Map;                                                                                    </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205 import java.util.Optional;                                                                               </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206 import java.util.Properties;                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207 import java.util.Set;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 210 =======                                                                                                  </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211 import java.io.File;                                                                                     </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213 import java.net.URL;                                                                                     </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214 import java.net.URLClassLoader;                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215 import java.net.URLDecoder;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217 import java.util.Map;                                                                                    </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218 import java.util.Properties;                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219 import java.util.Set;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 222 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 223                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 224 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style=""> 225  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style=""> 226  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style=""> 227  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 228  */                                                                                                      </span>
<span  style=""> 229                                                                                                          </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style=""> 230 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style=""> 231     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style=""> 232                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style=""> 233     public static void main(String[] args) throws Exception {                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 234 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 235         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 236         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 237         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 238         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 239 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240 import com.dtstack.flink.sql.util.DtStringUtil;                                                          </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241 import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                            </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242 import com.dtstack.flink.sql.function.FunctionManager;                                                   </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243 import com.dtstack.flink.sql.util.PluginUtil;                                                            </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244 import org.apache.calcite.sql.SqlInsert;                                                                 </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245 import org.apache.calcite.sql.SqlNode;                                                                   </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246 import org.apache.commons.io.Charsets;                                                                   </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247 import org.apache.flink.api.common.typeinfo.TypeInformation;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250 import com.google.common.base.Strings;                                                                   </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252 import com.google.common.collect.Maps;                                                                   </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253 import com.google.common.collect.Sets;                                                                   </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254 import com.fasterxml.jackson.databind.ObjectMapper;                                                      </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255 import org.apache.flink.streaming.api.datastream.DataStream;                                             </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257 import org.apache.flink.table.api.StreamQueryConfig;                                                     </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258 import org.apache.flink.table.api.Table;                                                                 </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259 import org.apache.flink.table.api.TableEnvironment;                                                      </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260 import org.apache.flink.table.api.java.StreamTableEnvironment;                                           </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261 import org.apache.flink.table.sinks.TableSink;                                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266 import java.io.File;                                                                                     </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268 import java.net.URL;                                                                                     </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269 import java.net.URLClassLoader;                                                                          </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270 import java.net.URLDecoder;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272 import java.util.Map;                                                                                    </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273 import java.util.Optional;                                                                               </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274 import java.util.Properties;                                                                             </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275 import java.util.Set;                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                                                                                                          </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277 import com.dtstack.flink.sql.option.Options;                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                                                                                                          </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285 public class Main {                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                                                                                                          </span>
<span class="4013471696637392789" onmouseenter="enter('4013471696637392789');" onmouseout="out('4013471696637392789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287     private static final String CLASS_FILE_NAME_FMT = &quot;class_path_%d&quot;;                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                                                                                                          </span>
<span class="-6402274289576443243" onmouseenter="enter('-6402274289576443243');" onmouseout="out('-6402274289576443243');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289     private static final ObjectMapper objMapper = new ObjectMapper();                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                                                                                                          </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294     public static void main(String[] args) throws Exception {                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                                                                                                          </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296         OptionParser optionParser = new OptionParser(args);                                              </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297         Options options = optionParser.getOptions();                                                     </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298         String sql = options.getSql();                                                                   </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299         String name = options.getName();                                                                 </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300         String addJarListStr = options.getAddjar();                                                      </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301         String localSqlPluginPath = options.getLocalSqlPluginPath();                                     </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302         String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                   </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303         String pluginLoadMode = options.getPluginLoadMode();                                             </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304         String deployMode = options.getMode();                                                           </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305         String confProp = options.getConfProp();                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                                                                                                          </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307         sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                             </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308         SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                                                                                                          </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310         List&lt;String&gt; addJarFileList = Lists.newArrayList();                                              </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311         if (!Strings.isNullOrEmpty(addJarListStr)) {                                                     </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312             addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                     </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313             addJarFileList = objMapper.readValue(addJarListStr, List.class);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315                                                                                                          </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318         StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                    </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319         StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);              </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 320         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 320         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confP🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321                                                                                                          </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322         List&lt;URL&gt; jarURList = Lists.newArrayList();                                                      </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323         SqlTree sqlTree = SqlParser.parseSql(sql);                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324                                                                                                          </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325         //Get External jar to load                                                                       </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326         for (String addJarPath : addJarFileList) {                                                       </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             File tmpFile = new File(addJarPath);                                                         </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328             jarURList.add(tmpFile.toURI().toURL());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330                                                                                                          </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331         Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                     </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332         Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333                                                                                                          </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334         //register udf                                                                                   </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335         registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                       </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336         //register table schema                                                                          </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 337         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 337         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPlugi🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338         // cache classPathSets                                                                           </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339         registerPluginUrlToCachedFile(env, classPathSets);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340                                                                                                          </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 341         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 341         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQue🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342                                                                                                          </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343         if (env instanceof MyLocalStreamEnvironment) {                                                   </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344             ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346                                                                                                          </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347         env.execute(name);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349                                                                                                          </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 350     private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 350     private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree🔵</abbr></span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351         SideSqlExec sideSqlExec = new SideSqlExec();                                                     </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352         sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                           </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353         for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                    </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 354             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 354             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356                                                                                                          </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357         for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                         </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358             if (LOG.isInfoEnabled()) {                                                                   </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359                 LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360             }                                                                                            </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361             boolean isSide = false;                                                                      </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362             for (String tableName : result.getTargetTableList()) {                                       </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363                 if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                   </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364                     CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);  </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365                     String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366                                                                                                          </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 367                     SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 367                     SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConf🔵</abbr></span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368                     String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                        </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 369                     tmp.setExecSql(tmpSql);                                                              </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 370                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 370                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryC🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 371                 } else {                                                                                 </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 372                     for (String sourceTable : result.getSourceTableList()) {                             </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373                         if (sideTableMap.containsKey(sourceTable)) {                                     </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374                             isSide = true;                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 375                             break;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 376                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 377                     }                                                                                    </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 378                     if (isSide) {                                                                        </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 379                         //sql-dimensional table contains the dimension table of execution                </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 380                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 380                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache,🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 381                     }else{                                                                               </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 382                         System.out.println(&quot;----------exec sql without dimension join-----------&quot; );     </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 383                         System.out.println(&quot;----------real sql exec is--------------------------&quot;);      </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 384                         System.out.println(result.getExecSql());                                         </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 385                         FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);              </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 386                         if(LOG.isInfoEnabled()){                                                         </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 387                             System.out.println();                                                        </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 388                             LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 389                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 390                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 391                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 392             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 393         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 394                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 395                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 396     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 397                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 398                                                                                                          </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 399     private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 399     private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironmen🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 400             throws IllegalAccessException, InvocationTargetException {                                   </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 401         // udf和tableEnv须由同一个类加载器加载                                                                       </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 402         ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                             </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 403         URLClassLoader classLoader = null;                                                               </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 404         List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                     </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 405         for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                     </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 406             //classloader                                                                                </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 407             if (classLoader == null) {                                                                   </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 408                 classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);"> 408                 classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoade🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 409             }                                                                                            </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 410             FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 410             FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 411         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 412     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 413                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 414     /**                                                                                                  </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 415      *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                    </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 416      * @param sqlTree                                                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 417      * @param env                                                                                        </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 418      * @param tableEnv                                                                                   </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 419      * @param localSqlPluginPath                                                                         </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 420      * @param remoteSqlPluginPath                                                                        </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 421      * @param pluginLoadMode   插件加载模式 classpath or shipfile                                              </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422      * @param sideTableMap                                                                               </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423      * @param registerTableCache                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424      * @return                                                                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426      */                                                                                                  </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 427     private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 427     private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnv🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 428                                           String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 428                                           String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, 🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429         Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                               </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430         WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                             </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431         for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432                                                                                                          </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433             if (tableInfo instanceof SourceTableInfo) {                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434                                                                                                          </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435                 SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                           </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 436                 Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 436                 Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSq🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437                 tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                           </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 438                 //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 438                 //Note --- parameter conversion function can not be used inside a function of the type of🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439                 //Create table in which the function is arranged only need adaptation sql                </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440                 String adaptSql = sourceTableInfo.getAdaptSelectSql();                                   </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441                 Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442                                                                                                          </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 443                 RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 443                 RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getS🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444                 DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                  </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445                         .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                      </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446                         .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                         </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447                         .returns(typeInfo);                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448                                                                                                          </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449                 String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450                                                                                                          </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451                 if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                   </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 452                     adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);"> 452                     adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTabl🔵</abbr></span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453                     fields += &quot;,ROWTIME.ROWTIME&quot;;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454                 } else {                                                                                 </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455                     fields += &quot;,PROCTIME.PROCTIME&quot;;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457                                                                                                          </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458                 Table regTable = tableEnv.fromDataStream(adaptStream, fields);                           </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459                 tableEnv.registerTable(tableInfo.getName(), regTable);                                   </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460                 if (LOG.isInfoEnabled()) {                                                               </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461                     LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462                 }                                                                                        </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463                 registerTableCache.put(tableInfo.getName(), regTable);                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464                                                                                                          </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 465                 URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 465                 URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(),🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466                 pluginClassPatshSets.add(sourceTablePathUrl);                                            </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467             } else if (tableInfo instanceof TargetTableInfo) {                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468                                                                                                          </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 469                 TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 469                 TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSq🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 470                 TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());"> 470                 TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses()🔵</abbr></span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 471                 tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);"> 471                 tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableS🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472                                                                                                          </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 473                 URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 473                 URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), T🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474                 pluginClassPatshSets.add(sinkTablePathUrl);                                              </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475             } else if (tableInfo instanceof SideTableInfo) {                                             </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 476                 String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 476                 String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheTy🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477                 sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478                                                                                                          </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 479                 URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 479                 URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperat🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480                 pluginClassPatshSets.add(sideTablePathUrl);                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481             } else {                                                                                     </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482                 throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484         }                                                                                                </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485         return pluginClassPatshSets;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488     /**                                                                                                  </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489      *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                           </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490      * @param env                                                                                        </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491      * @param classPathSet                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492      */                                                                                                  </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 493     private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {"> 493     private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathS🔵</abbr></span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 494         int i = 0;                                                                                       </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495         for (URL url : classPathSet) {                                                                   </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496             String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497             env.registerCachedFile(url.getPath(), classFileName, true);                                  </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498             i++;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501                                                                                                          </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 502     private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 502     private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMod🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503         StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                  </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504                 StreamExecutionEnvironment.getExecutionEnvironment() :                                   </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505                 new MyLocalStreamEnvironment();                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 506                                                                                                          </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 507         StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                    </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 508         return env;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 509     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 510 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 511 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512                                                                                                          </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513         OptionParser optionParser = new OptionParser(args);                                              </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514         Options options = optionParser.getOptions();                                                     </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515         String sql = options.getSql();                                                                   </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516         String name = options.getName();                                                                 </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517         String addJarListStr = options.getAddjar();                                                      </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518         String localSqlPluginPath = options.getLocalSqlPluginPath();                                     </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519         String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                   </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520         String pluginLoadMode = options.getPluginLoadMode();                                             </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521         String deployMode = options.getMode();                                                           </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522         String confProp = options.getConfProp();                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523                                                                                                          </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524         sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                             </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525         SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526                                                                                                          </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527         List&lt;String&gt; addJarFileList = Lists.newArrayList();                                              </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528         if (!Strings.isNullOrEmpty(addJarListStr)) {                                                     </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529             addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                     </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530             addJarFileList = objMapper.readValue(addJarListStr, List.class);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532                                                                                                          </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535         StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                    </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536         StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);              </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 537         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 537         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confP🔵</abbr></span>
<span class="-2835870593631471587" onmouseenter="enter('-2835870593631471587');" onmouseout="out('-2835870593631471587');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538         // init global flinkPlanner                                                                      </span>
<span class="8665787724040957126" onmouseenter="enter('8665787724040957126');" onmouseout="out('8665787724040957126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 539         FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.getTypeFactory());"> 539         FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.ge🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540                                                                                                          </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541         List&lt;URL&gt; jarURList = Lists.newArrayList();                                                      </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542         SqlTree sqlTree = SqlParser.parseSql(sql);                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543                                                                                                          </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544         //Get External jar to load                                                                       </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545         for (String addJarPath : addJarFileList) {                                                       </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546             File tmpFile = new File(addJarPath);                                                         </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547             jarURList.add(tmpFile.toURI().toURL());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549                                                                                                          </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550         Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                     </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551         Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552                                                                                                          </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553         //register udf                                                                                   </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554         registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                       </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555         //register table schema                                                                          </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 556         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 556         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPlugi🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557         // cache classPathSets                                                                           </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558         registerPluginUrlToCachedFile(env, classPathSets);                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559                                                                                                          </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 560         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 560         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQue🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561                                                                                                          </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562         if (env instanceof MyLocalStreamEnvironment) {                                                   </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563             ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565                                                                                                          </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566         env.execute(name);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568                                                                                                          </span>
<span class="-291658623025297689" onmouseenter="enter('-291658623025297689');" onmouseout="out('-291658623025297689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569     private static void sqlTranslation(String localSqlPluginPath,                                        </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570                                        StreamTableEnvironment tableEnv,                                  </span>
<span class="-485281931312886761" onmouseenter="enter('-485281931312886761');" onmouseout="out('-485281931312886761');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571                                        SqlTree sqlTree,                                                  </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572                                        Map&lt;String, SideTableInfo&gt; sideTableMap,                          </span>
<span class="3151258365792163168" onmouseenter="enter('3151258365792163168');" onmouseout="out('3151258365792163168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573                                        Map&lt;String, Table&gt; registerTableCache,                            </span>
<span class="988765244170420280" onmouseenter="enter('988765244170420280');" onmouseout="out('988765244170420280');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574                                        StreamQueryConfig queryConfig) throws Exception {                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575                                                                                                          </span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576         SideSqlExec sideSqlExec = new SideSqlExec();                                                     </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577         sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                           </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578         for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                    </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 579             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 579             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581                                                                                                          </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582         for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                         </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583             if (LOG.isInfoEnabled()) {                                                                   </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                 LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585             }                                                                                            </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586             boolean isSide = false;                                                                      </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587             for (String tableName : result.getTargetTableList()) {                                       </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588                 if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                   </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589                     CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);  </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590                     String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);      </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591                     FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592                                                                                                          </span>
<span class="-1169903474645440554" onmouseenter="enter('-1169903474645440554');" onmouseout="out('-1169903474645440554');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593                     SqlNode sqlNode = flinkPlanner.parse(realSql);                                       </span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594                     String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                        </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595                     tmp.setExecSql(tmpSql);                                                              </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 596                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 596                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryC🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597                 } else {                                                                                 </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598                     for (String sourceTable : result.getSourceTableList()) {                             </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599                         if (sideTableMap.containsKey(sourceTable)) {                                     </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600                             isSide = true;                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601                             break;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603                     }                                                                                    </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604                     if (isSide) {                                                                        </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605                         //sql-dimensional table contains the dimension table of execution                </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 606                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 606                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache,🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607                     }else{                                                                               </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608                         System.out.println(&quot;----------exec sql without dimension join-----------&quot; );     </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609                         System.out.println(&quot;----------real sql exec is--------------------------&quot;);      </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610                         System.out.println(result.getExecSql());                                         </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611                         FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);              </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612                         if(LOG.isInfoEnabled()){                                                         </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613                             System.out.println();                                                        </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614                             LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624                                                                                                          </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 625     private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 625     private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironmen🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626             throws IllegalAccessException, InvocationTargetException {                                   </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627         // udf和tableEnv须由同一个类加载器加载                                                                       </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628         ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                             </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629         URLClassLoader classLoader = null;                                                               </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630         List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                     </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631         for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                     </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632             //classloader                                                                                </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633             if (classLoader == null) {                                                                   </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 634                 classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);"> 634                 classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoade🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635             }                                                                                            </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 636             FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 636             FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), 🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640     /**                                                                                                  </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641      *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                    </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642      * @param sqlTree                                                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643      * @param env                                                                                        </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644      * @param tableEnv                                                                                   </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645      * @param localSqlPluginPath                                                                         </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646      * @param remoteSqlPluginPath                                                                        </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647      * @param pluginLoadMode   插件加载模式 classpath or shipfile                                              </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648      * @param sideTableMap                                                                               </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649      * @param registerTableCache                                                                         </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650      * @return                                                                                           </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651      * @throws Exception                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652      */                                                                                                  </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 653     private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 653     private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnv🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 654                                           String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 654                                           String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, 🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655         Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                               </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656         WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                             </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657         for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658                                                                                                          </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659             if (tableInfo instanceof SourceTableInfo) {                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660                                                                                                          </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661                 SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                           </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 662                 Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 662                 Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSq🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663                 tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                           </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 664                 //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 664                 //Note --- parameter conversion function can not be used inside a function of the type of🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665                 //Create table in which the function is arranged only need adaptation sql                </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666                 String adaptSql = sourceTableInfo.getAdaptSelectSql();                                   </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667                 Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668                                                                                                          </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 669                 RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 669                 RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getS🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670                 DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                  </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671                         .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                      </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672                         .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                         </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673                         .returns(typeInfo);                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674                                                                                                          </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675                 String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                                                                                                          </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677                 if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                   </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 678                     adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);"> 678                     adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTabl🔵</abbr></span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679                     fields += &quot;,ROWTIME.ROWTIME&quot;;                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680                 } else {                                                                                 </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681                     fields += &quot;,PROCTIME.PROCTIME&quot;;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682                 }                                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683                                                                                                          </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684                 Table regTable = tableEnv.fromDataStream(adaptStream, fields);                           </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685                 tableEnv.registerTable(tableInfo.getName(), regTable);                                   </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686                 if (LOG.isInfoEnabled()) {                                                               </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687                     LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688                 }                                                                                        </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689                 registerTableCache.put(tableInfo.getName(), regTable);                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690                                                                                                          </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 691                 URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 691                 URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(),🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692                 pluginClassPatshSets.add(sourceTablePathUrl);                                            </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693             } else if (tableInfo instanceof TargetTableInfo) {                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694                                                                                                          </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 695                 TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 695                 TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSq🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 696                 TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());"> 696                 TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses()🔵</abbr></span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 697                 tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);"> 697                 tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableS🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                                                                                                          </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 699                 URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 699                 URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), T🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                 pluginClassPatshSets.add(sinkTablePathUrl);                                              </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701             } else if (tableInfo instanceof SideTableInfo) {                                             </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 702                 String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 702                 String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheTy🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703                 sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704                                                                                                          </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 705                 URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 705                 URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperat🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706                 pluginClassPatshSets.add(sideTablePathUrl);                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707             } else {                                                                                     </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708                 throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710         }                                                                                                </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711         return pluginClassPatshSets;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714     /**                                                                                                  </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715      *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                           </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716      * @param env                                                                                        </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717      * @param classPathSet                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718      */                                                                                                  </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 719     private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {"> 719     private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathS🔵</abbr></span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720         int i = 0;                                                                                       </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721         for (URL url : classPathSet) {                                                                   </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722             String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723             env.registerCachedFile(url.getPath(), classFileName, true);                                  </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724             i++;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727                                                                                                          </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 728     private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 728     private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMod🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729         StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                  </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                 StreamExecutionEnvironment.getExecutionEnvironment() :                                   </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731                 new MyLocalStreamEnvironment();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732                                                                                                          </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733         StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                    </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734         return env;                                                                                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 735 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 736     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 737 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20 package com.dtstack.flink.sql;                                                                           </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  21 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span  style="">  22                                                                                                          </span>
<span  style="">  23                                                                                                          </span>
<span  style="">  24                                                                                                          </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  25 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span  style="">  26                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="">  27 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="">  28 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  29 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  30 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  31 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  32                                                                                                          </span>
<span  style="">  33                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  34 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  35  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  36  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  37  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  38  */                                                                                                      </span>
<span  style="">  39                                                                                                          </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  40 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  41     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="">  42                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  43     public static void main(String[] args) throws Exception {                                            </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  44 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  45         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  46         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  47         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  48         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  49 ||||||| BASE                                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50                                                                                                          </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51         OptionParser optionParser = new OptionParser(args);                                              </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52         Options options = optionParser.getOptions();                                                     </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53         String sql = options.getSql();                                                                   </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54         String name = options.getName();                                                                 </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55         String addJarListStr = options.getAddjar();                                                      </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56         String localSqlPluginPath = options.getLocalSqlPluginPath();                                     </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57         String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                   </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58         String pluginLoadMode = options.getPluginLoadMode();                                             </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59         String deployMode = options.getMode();                                                           </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60         String confProp = options.getConfProp();                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61                                                                                                          </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62         sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                             </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63         SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64                                                                                                          </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65         List&lt;String&gt; addJarFileList = Lists.newArrayList();                                              </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66         if (!Strings.isNullOrEmpty(addJarListStr)) {                                                     </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67             addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                     </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68             addJarFileList = objMapper.readValue(addJarListStr, List.class);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70                                                                                                          </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73         StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                    </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74         StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);              </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  75         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);">  75         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confP🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77         List&lt;URL&gt; jarURList = Lists.newArrayList();                                                      </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78         SqlTree sqlTree = SqlParser.parseSql(sql);                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80         //Get External jar to load                                                                       </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81         for (String addJarPath : addJarFileList) {                                                       </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82             File tmpFile = new File(addJarPath);                                                         </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83             jarURList.add(tmpFile.toURI().toURL());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85                                                                                                          </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86         Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                     </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87         Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88                                                                                                          </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89         //register udf                                                                                   </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90         registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                       </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91         //register table schema                                                                          </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  92         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);">  92         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPlugi🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93         // cache classPathSets                                                                           </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94         registerPluginUrlToCachedFile(env, classPathSets);                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95                                                                                                          </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  96         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);">  96         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQue🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97                                                                                                          </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98         if (env instanceof MyLocalStreamEnvironment) {                                                   </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99             ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101                                                                                                          </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102         env.execute(name);                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 104 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105                                                                                                          </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106         OptionParser optionParser = new OptionParser(args);                                              </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107         Options options = optionParser.getOptions();                                                     </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108         String sql = options.getSql();                                                                   </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109         String name = options.getName();                                                                 </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110         String addJarListStr = options.getAddjar();                                                      </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111         String localSqlPluginPath = options.getLocalSqlPluginPath();                                     </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112         String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                   </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113         String pluginLoadMode = options.getPluginLoadMode();                                             </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114         String deployMode = options.getMode();                                                           </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115         String confProp = options.getConfProp();                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116                                                                                                          </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117         sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                             </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118         SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119                                                                                                          </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120         List&lt;String&gt; addJarFileList = Lists.newArrayList();                                              </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121         if (!Strings.isNullOrEmpty(addJarListStr)) {                                                     </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122             addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                     </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123             addJarFileList = objMapper.readValue(addJarListStr, List.class);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125                                                                                                          </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126         confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                               </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127         Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);              </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128         StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                    </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129         StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);              </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 130         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 130         StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confP🔵</abbr></span>
<span class="-2835870593631471587" onmouseenter="enter('-2835870593631471587');" onmouseout="out('-2835870593631471587');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131         // init global flinkPlanner                                                                      </span>
<span class="8665787724040957126" onmouseenter="enter('8665787724040957126');" onmouseout="out('8665787724040957126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 132         FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.getTypeFactory());"> 132         FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.ge🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133                                                                                                          </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134         List&lt;URL&gt; jarURList = Lists.newArrayList();                                                      </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135         SqlTree sqlTree = SqlParser.parseSql(sql);                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136                                                                                                          </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137         //Get External jar to load                                                                       </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138         for (String addJarPath : addJarFileList) {                                                       </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139             File tmpFile = new File(addJarPath);                                                         </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140             jarURList.add(tmpFile.toURI().toURL());                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142                                                                                                          </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143         Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                     </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144         Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145                                                                                                          </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146         //register udf                                                                                   </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147         registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                       </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148         //register table schema                                                                          </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 149         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 149         Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPlugi🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150         // cache classPathSets                                                                           </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151         registerPluginUrlToCachedFile(env, classPathSets);                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152                                                                                                          </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 153         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 153         sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQue🔵</abbr></span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                                                                                                          </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155         if (env instanceof MyLocalStreamEnvironment) {                                                   </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156             ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158                                                                                                          </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159         env.execute(name);                                                                               </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 160 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 162 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 163 ||||||| BASE                                                                                             </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 164 private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 164 private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sql🔵</abbr></span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         SideSqlExec sideSqlExec = new SideSqlExec();                                                     </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166         sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                           </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                    </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 168             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 168             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                                                                                                          </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                         </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172             if (LOG.isInfoEnabled()) {                                                                   </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173                 LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174             }                                                                                            </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             boolean isSide = false;                                                                      </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176             for (String tableName : result.getTargetTableList()) {                                       </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177                 if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                   </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178                     CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);  </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179                     String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180                                                                                                          </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 181                     SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 181                     SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConf🔵</abbr></span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182                     String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                        </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183                     tmp.setExecSql(tmpSql);                                                              </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 184                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 184                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryC🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                 } else {                                                                                 </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                     for (String sourceTable : result.getSourceTableList()) {                             </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                         if (sideTableMap.containsKey(sourceTable)) {                                     </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                             isSide = true;                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                             break;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                     }                                                                                    </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                     if (isSide) {                                                                        </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                         //sql-dimensional table contains the dimension table of execution                </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 194                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 194                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache,🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                     }else{                                                                               </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                         System.out.println(&quot;----------exec sql without dimension join-----------&quot; );     </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                         System.out.println(&quot;----------real sql exec is--------------------------&quot;);      </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                         System.out.println(result.getExecSql());                                         </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                         FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);              </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                         if(LOG.isInfoEnabled()){                                                         </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201                             System.out.println();                                                        </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                             LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 211 =======                                                                                                  </span>
<span class="-291658623025297689" onmouseenter="enter('-291658623025297689');" onmouseout="out('-291658623025297689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212 private static void sqlTranslation(String localSqlPluginPath,                                            </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213                                        StreamTableEnvironment tableEnv,                                  </span>
<span class="-485281931312886761" onmouseenter="enter('-485281931312886761');" onmouseout="out('-485281931312886761');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214                                        SqlTree sqlTree,                                                  </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215                                        Map&lt;String, SideTableInfo&gt; sideTableMap,                          </span>
<span class="3151258365792163168" onmouseenter="enter('3151258365792163168');" onmouseout="out('3151258365792163168');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216                                        Map&lt;String, Table&gt; registerTableCache,                            </span>
<span class="988765244170420280" onmouseenter="enter('988765244170420280');" onmouseout="out('988765244170420280');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217                                        StreamQueryConfig queryConfig) throws Exception {                 </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218                                                                                                          </span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219         SideSqlExec sideSqlExec = new SideSqlExec();                                                     </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220         sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                           </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221         for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                    </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 222             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 222             sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224                                                                                                          </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225         for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                         </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226             if (LOG.isInfoEnabled()) {                                                                   </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227                 LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228             }                                                                                            </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229             boolean isSide = false;                                                                      </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230             for (String tableName : result.getTargetTableList()) {                                       </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231                 if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                   </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232                     CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);  </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233                     String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);      </span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234                     FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235                                                                                                          </span>
<span class="-1169903474645440554" onmouseenter="enter('-1169903474645440554');" onmouseout="out('-1169903474645440554');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236                     SqlNode sqlNode = flinkPlanner.parse(realSql);                                       </span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237                     String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                        </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238                     tmp.setExecSql(tmpSql);                                                              </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 239                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 239                     sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryC🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240                 } else {                                                                                 </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241                     for (String sourceTable : result.getSourceTableList()) {                             </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242                         if (sideTableMap.containsKey(sourceTable)) {                                     </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243                             isSide = true;                                                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244                             break;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246                     }                                                                                    </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247                     if (isSide) {                                                                        </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248                         //sql-dimensional table contains the dimension table of execution                </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 249                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 249                         sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache,🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250                     }else{                                                                               </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251                         System.out.println(&quot;----------exec sql without dimension join-----------&quot; );     </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252                         System.out.println(&quot;----------real sql exec is--------------------------&quot;);      </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253                         System.out.println(result.getExecSql());                                         </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254                         FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);              </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255                         if(LOG.isInfoEnabled()){                                                         </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256                             System.out.println();                                                        </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257                             LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 266 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 267                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268 }                                                                                                        </span>



















































































































































































































































































































































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  18 package com.dtstack.flink.sql;                                                                           </span>
<span  style="">  19                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="">  20 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="">  21 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="">  22 import com.dtstack.flink.sql.parser.FlinkPlanner;                                                        </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  23 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="">  24 import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  25 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  26 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  27                                                                                                          </span>
<span  style="">  28                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  29 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  30  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  31  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  32  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  33  */                                                                                                      </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  34 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  35     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="">  36                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  37     public static void main(String[] args) throws Exception {                                            </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="">  38         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="">  39         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="">  40         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="">  41         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  42     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  43 }                                                                                                        </span>




















































































































































































































































































































































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20  package com.dtstack.flink.sql;                                                                                    </span>
<span  style="">  21                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                                      </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.dtstack.flink.sql.enums.ClusterMode;                                                                   </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                                </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                                  </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import com.dtstack.flink.sql.option.OptionParser;                                                                 </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import com.dtstack.flink.sql.parser.CreateFuncParser;                                                             </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>

<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import com.dtstack.flink.sql.parser.InsertSqlParser;                                                              </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import com.dtstack.flink.sql.parser.SqlParser;                                                                    </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import com.dtstack.flink.sql.parser.SqlTree;                                                                      </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import com.dtstack.flink.sql.side.SideSqlExec;                                                                    </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import com.dtstack.flink.sql.side.SideTableInfo;                                                                  </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import com.dtstack.flink.sql.table.SourceTableInfo;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import com.dtstack.flink.sql.table.TargetTableInfo;                                                               </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                              </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import com.dtstack.flink.sql.source.StreamSourceFactory;                                                          </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                                     </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -import com.dtstack.flink.sql.function.FunctionManager;                                                            </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import com.google.common.base.Strings;                                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import com.google.common.collect.Sets;                                                                            </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  60  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -import org.apache.flink.table.api.TableEnvironment;                                                               </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>

<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -import org.apache.flink.table.sinks.TableSink;                                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -import org.apache.flink.types.Row;                                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                                                                                                                  </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                           </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +import com.dtstack.flink.sql.exec.ParamsInfo;                                                                     </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  70  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  71  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  72                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -import java.io.File;                                                                                              </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -import java.net.URL;                                                                                              </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -import java.net.URLClassLoader;                                                                                   </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -import java.net.URLDecoder;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -import java.util.Map;                                                                                             </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -import java.util.Properties;                                                                                      </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -import java.util.Set;                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -                                                                                                                  </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span  style="">  85                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  86  /**                                                                                                               </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  87   * Date: 2018/6/26                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  88   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  89   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90   */                                                                                                               </span>
<span  style="">  91                                                                                                                    </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  92  public class Main {                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -                                                                                                                  </span>
<span class="4013471696637392789" onmouseenter="enter('4013471696637392789');" onmouseout="out('4013471696637392789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -    private static final String CLASS_FILE_NAME_FMT = &quot;class_path_%d&quot;;                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -                                                                                                                  </span>
<span class="-6402274289576443243" onmouseenter="enter('-6402274289576443243');" onmouseout="out('-6402274289576443243');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -    private static final ObjectMapper objMapper = new ObjectMapper();                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -                                                                                                                  </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  98      private static final Logger LOG = LoggerFactory.getLogger(Main.class);                                        </span>
<span  style="">  99                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -                                                                                                                  </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style=""> 101      public static void main(String[] args) throws Exception {                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -                                                                                                                  </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        OptionParser optionParser = new OptionParser(args);                                                       </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -        Options options = optionParser.getOptions();                                                              </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -        String sql = options.getSql();                                                                            </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -        String name = options.getName();                                                                          </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -        String addJarListStr = options.getAddjar();                                                               </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -        String localSqlPluginPath = options.getLocalSqlPluginPath();                                              </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -        String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                            </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -        String pluginLoadMode = options.getPluginLoadMode();                                                      </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -        String deployMode = options.getMode();                                                                    </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -        String confProp = options.getConfProp();                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                                                                                                                  </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -        sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                                      </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -        SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                                                                                                                  </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -        List&lt;String&gt; addJarFileList = Lists.newArrayList();                                                       </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -        if (!Strings.isNullOrEmpty(addJarListStr)) {                                                              </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -            addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                              </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -            addJarFileList = objMapper.readValue(addJarListStr, List.class);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                                                                                                                  </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -        Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -        StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                             </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -        StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);                       </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 127 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 127 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties🔵</abbr></span>


<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -                                                                                                                  </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -        List&lt;URL&gt; jarURList = Lists.newArrayList();                                                               </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -        SqlTree sqlTree = SqlParser.parseSql(sql);                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -        //Get External jar to load                                                                                </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -        for (String addJarPath : addJarFileList) {                                                                </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -            File tmpFile = new File(addJarPath);                                                                  </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -            jarURList.add(tmpFile.toURI().toURL());                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -                                                                                                                  </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -        Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                              </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -        Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -                                                                                                                  </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        //register udf                                                                                            </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                                </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -        //register table schema                                                                                   </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 144 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 144 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pl🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        // cache classPathSets                                                                                    </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -        registerPluginUrlToCachedFile(env, classPathSets);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                                                                                                                  </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 148 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 148 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig)🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                                                                                                                  </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -        if (env instanceof MyLocalStreamEnvironment) {                                                            </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -            ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -                                                                                                                  </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -        env.execute(name);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -                                                                                                                  </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 157 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 157 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,🔵</abbr></span>







<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -        SideSqlExec sideSqlExec = new SideSqlExec();                                                              </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -        sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                                    </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -        for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                             </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 161 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 161 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -                                                                                                                  </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -        for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                                  </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -            if (LOG.isInfoEnabled()) {                                                                            </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -                LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -            }                                                                                                     </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -            boolean isSide = false;                                                                               </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -            for (String tableName : result.getTargetTableList()) {                                                </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                            </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -                    CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);           </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -                    String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -                                                                                                                  </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 174 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 174 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_🔵</abbr></span>



<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                    String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                                 </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                    tmp.setExecSql(tmpSql);                                                                       </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 177 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 177 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tm🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -                } else {                                                                                          </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -                    for (String sourceTable : result.getSourceTableList()) {                                      </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                        if (sideTableMap.containsKey(sourceTable)) {                                              </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                            isSide = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                            break;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -                    }                                                                                             </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                    if (isSide) {                                                                                 </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -                        //sql-dimensional table contains the dimension table of execution                         </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 187 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 187 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryCon🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                    }else{                                                                                        </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                        System.out.println(&quot;----------exec sql without dimension join-----------&quot; );              </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                        System.out.println(&quot;----------real sql exec is--------------------------&quot;);               </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                        System.out.println(result.getExecSql());                                                  </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                        FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);                       </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                        if(LOG.isInfoEnabled()){                                                                  </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                            System.out.println();                                                                 </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                            LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                                                                                                                  </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 206 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 206 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEn🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            throws IllegalAccessException, InvocationTargetException {                                            </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        // udf和tableEnv须由同一个类加载器加载                                                                                </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                                      </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -        URLClassLoader classLoader = null;                                                                        </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -        List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                              </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -        for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                              </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            //classloader                                                                                         </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -            if (classLoader == null) {                                                                            </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -                classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -            }                                                                                                     </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 217 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 217 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv,🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -    /**                                                                                                           </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -     *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                             </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -     * @param sqlTree                                                                                             </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -     * @param env                                                                                                 </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -     * @param tableEnv                                                                                            </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -     * @param localSqlPluginPath                                                                                  </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -     * @param remoteSqlPluginPath                                                                                 </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -     * @param pluginLoadMode   插件加载模式 classpath or shipfile                                                       </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -     * @param sideTableMap                                                                                        </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -     * @param registerTableCache                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -     * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -     * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -     */                                                                                                           </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 234 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 234 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment 🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 235 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 235 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTable🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                                        </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -        WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                                      </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -        for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -                                                                                                                  </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -            if (tableInfo instanceof SourceTableInfo) {                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -                                                                                                                  </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -                SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                                    </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 243 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 243 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPa🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -                tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                                    </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 245 -                //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 245 -                //Note --- parameter conversion function can not be used inside a function of the type of polymeri🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                //Create table in which the function is arranged only need adaptation sql                         </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                String adaptSql = sourceTableInfo.getAdaptSelectSql();                                            </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -                                                                                                                  </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 250 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 250 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().g🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                           </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                        .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                               </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                        .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                                  </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                        .returns(typeInfo);                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                                                                                                                  </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                                                                                                                  </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                            </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                    adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);  </span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                    fields += &quot;,ROWTIME.ROWTIME&quot;;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                } else {                                                                                          </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                    fields += &quot;,PROCTIME.PROCTIME&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                                                                                                                  </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                Table regTable = tableEnv.fromDataStream(adaptStream, fields);                                    </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                tableEnv.registerTable(tableInfo.getName(), regTable);                                            </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                if (LOG.isInfoEnabled()) {                                                                        </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                    LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                }                                                                                                 </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                registerTableCache.put(tableInfo.getName(), regTable);                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                                                                                                                  </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 272 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 272 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTa🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                pluginClassPatshSets.add(sourceTablePathUrl);                                                     </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -            } else if (tableInfo instanceof TargetTableInfo) {                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -                                                                                                                  </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 276 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 276 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPa🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());       </span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -                tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                                                                                                                  </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 280 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 280 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTabl🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -                pluginClassPatshSets.add(sinkTablePathUrl);                                                       </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -            } else if (tableInfo instanceof SideTableInfo) {                                                      </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 283 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 283 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -                sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -                                                                                                                  </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 286 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 286 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideT🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -                pluginClassPatshSets.add(sideTablePathUrl);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -            } else {                                                                                              </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -                throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -        }                                                                                                         </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -        return pluginClassPatshSets;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -    /**                                                                                                           </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -     *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -     * @param env                                                                                                 </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -     * @param classPathSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -     */                                                                                                           </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -    private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -        int i = 0;                                                                                                </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -        for (URL url : classPathSet) {                                                                            </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -            String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                         </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -            env.registerCachedFile(url.getPath(), classFileName, true);                                           </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -            i++;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                                                                                                                  </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 309 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 309 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -        StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                           </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -                StreamExecutionEnvironment.getExecutionEnvironment() :                                            </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -                new MyLocalStreamEnvironment();                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -                                                                                                                  </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -        StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                             </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -        return env;                                                                                               </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +        ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                           </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +        StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);                     </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 318 +        env.execute(paramsInfo.getName());                                                                        </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +        LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20  package com.dtstack.flink.sql;                                                                                    </span>
<span  style="">  21                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="">  23  import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                                      </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="">  24  import com.dtstack.flink.sql.enums.ClusterMode;                                                                   </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  25  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="">  26  import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                                </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="">  27  import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                                  </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="">  28  import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="">  29  import com.dtstack.flink.sql.option.OptionParser;                                                                 </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="">  30  import com.dtstack.flink.sql.parser.CreateFuncParser;                                                             </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="">  31  import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>
<span class="-283888887417937620" onmouseenter="enter('-283888887417937620');" onmouseout="out('-283888887417937620');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +import com.dtstack.flink.sql.parser.FlinkPlanner;                                                                 </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="">  33  import com.dtstack.flink.sql.parser.InsertSqlParser;                                                              </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="">  34  import com.dtstack.flink.sql.parser.SqlParser;                                                                    </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="">  35  import com.dtstack.flink.sql.parser.SqlTree;                                                                      </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="">  36  import com.dtstack.flink.sql.side.SideSqlExec;                                                                    </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="">  37  import com.dtstack.flink.sql.side.SideTableInfo;                                                                  </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="">  38  import com.dtstack.flink.sql.table.SourceTableInfo;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="">  39  import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="">  40  import com.dtstack.flink.sql.table.TargetTableInfo;                                                               </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="">  41  import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                              </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="">  42  import com.dtstack.flink.sql.source.StreamSourceFactory;                                                          </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="">  43  import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="">  44  import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                                     </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="">  45  import com.dtstack.flink.sql.function.FunctionManager;                                                            </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="">  46  import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="">  47  import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="">  48  import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="">  49  import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="">  50  import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  51  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  52  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="">  53  import com.google.common.base.Strings;                                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  54  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  55  import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="">  56  import com.google.common.collect.Sets;                                                                            </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="">  57  import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="">  58  import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>


<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  59  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="">  60  import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="">  61  import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="">  62  import org.apache.flink.table.api.TableEnvironment;                                                               </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="">  63  import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>
<span class="-3548577539000853351" onmouseenter="enter('-3548577539000853351');" onmouseout="out('-3548577539000853351');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +import org.apache.flink.table.calcite.FlinkPlannerImpl;                                                           </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="">  65  import org.apache.flink.table.sinks.TableSink;                                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  66  import org.apache.flink.types.Row;                                                                                </span>



<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  67  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  68  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  69                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  70  import java.io.File;                                                                                              </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="">  71  import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="">  72  import java.net.URL;                                                                                              </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="">  73  import java.net.URLClassLoader;                                                                                   </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="">  74  import java.net.URLDecoder;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  75  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  76  import java.util.Map;                                                                                             </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="">  78  import java.util.Properties;                                                                                      </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  79  import java.util.Set;                                                                                             </span>
<span  style="">  80                                                                                                                    </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="">  81  import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span  style="">  82                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83  /**                                                                                                               </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  84   * Date: 2018/6/26                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  85   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  86   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87   */                                                                                                               </span>
<span  style="">  88                                                                                                                    </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  89  public class Main {                                                                                               </span>
<span  style="">  90                                                                                                                    </span>
<span class="4013471696637392789" onmouseenter="enter('4013471696637392789');" onmouseout="out('4013471696637392789');" style="">  91      private static final String CLASS_FILE_NAME_FMT = &quot;class_path_%d&quot;;                                            </span>
<span  style="">  92                                                                                                                    </span>
<span class="-6402274289576443243" onmouseenter="enter('-6402274289576443243');" onmouseout="out('-6402274289576443243');" style="">  93      private static final ObjectMapper objMapper = new ObjectMapper();                                             </span>
<span  style="">  94                                                                                                                    </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  95      private static final Logger LOG = LoggerFactory.getLogger(Main.class);                                        </span>
<span  style="">  96                                                                                                                    </span>
<span  style="">  97                                                                                                                    </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  98      public static void main(String[] args) throws Exception {                                                     </span>
<span  style="">  99                                                                                                                    </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style=""> 100          OptionParser optionParser = new OptionParser(args);                                                       </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style=""> 101          Options options = optionParser.getOptions();                                                              </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style=""> 102          String sql = options.getSql();                                                                            </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style=""> 103          String name = options.getName();                                                                          </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style=""> 104          String addJarListStr = options.getAddjar();                                                               </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style=""> 105          String localSqlPluginPath = options.getLocalSqlPluginPath();                                              </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style=""> 106          String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                            </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style=""> 107          String pluginLoadMode = options.getPluginLoadMode();                                                      </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style=""> 108          String deployMode = options.getMode();                                                                    </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style=""> 109          String confProp = options.getConfProp();                                                                  </span>
<span  style=""> 110                                                                                                                    </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style=""> 111          sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                                      </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style=""> 112          SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                                      </span>
<span  style=""> 113                                                                                                                    </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style=""> 114          List&lt;String&gt; addJarFileList = Lists.newArrayList();                                                       </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style=""> 115          if (!Strings.isNullOrEmpty(addJarListStr)) {                                                              </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style=""> 116              addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                              </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style=""> 117              addJarFileList = objMapper.readValue(addJarListStr, List.class);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118          }                                                                                                         </span>
<span  style=""> 119                                                                                                                    </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style=""> 120          confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style=""> 121          Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style=""> 122          StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                             </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style=""> 123          StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);                       </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style=""><abbr title=" 124          StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 124          StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties🔵</abbr></span>
<span class="-2835870593631471587" onmouseenter="enter('-2835870593631471587');" onmouseout="out('-2835870593631471587');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        // init global flinkPlanner                                                                               </span>
<span class="8665787724040957126" onmouseenter="enter('8665787724040957126');" onmouseout="out('8665787724040957126');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 126 +        FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.getTypeFactory());"> 126 +        FlinkPlanner.createFlinkPlanner(tableEnv.getFrameworkConfig(), tableEnv.getPlanner(), tableEnv.getTypeFact🔵</abbr></span>
<span  style=""> 127                                                                                                                    </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style=""> 128          List&lt;URL&gt; jarURList = Lists.newArrayList();                                                               </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style=""> 129          SqlTree sqlTree = SqlParser.parseSql(sql);                                                                </span>
<span  style=""> 130                                                                                                                    </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style=""> 131          //Get External jar to load                                                                                </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style=""> 132          for (String addJarPath : addJarFileList) {                                                                </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style=""> 133              File tmpFile = new File(addJarPath);                                                                  </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style=""> 134              jarURList.add(tmpFile.toURI().toURL());                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span  style=""> 136                                                                                                                    </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style=""> 137          Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                              </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style=""> 138          Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                                </span>
<span  style=""> 139                                                                                                                    </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style=""> 140          //register udf                                                                                            </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style=""> 141          registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                                </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style=""> 142          //register table schema                                                                                   </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style=""><abbr title=" 143          Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 143          Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pl🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style=""> 144          // cache classPathSets                                                                                    </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style=""> 145          registerPluginUrlToCachedFile(env, classPathSets);                                                        </span>
<span  style=""> 146                                                                                                                    </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style=""><abbr title=" 147          sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 147          sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig)🔵</abbr></span>
<span  style=""> 148                                                                                                                    </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style=""> 149          if (env instanceof MyLocalStreamEnvironment) {                                                            </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style=""> 150              ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151          }                                                                                                         </span>
<span  style=""> 152                                                                                                                    </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style=""> 153          env.execute(name);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154      }                                                                                                             </span>
<span  style=""> 155                                                                                                                    </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 156 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 156 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,🔵</abbr></span>
<span class="-291658623025297689" onmouseenter="enter('-291658623025297689');" onmouseout="out('-291658623025297689');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +    private static void sqlTranslation(String localSqlPluginPath,                                                 </span>
<span class="4244108408582304218" onmouseenter="enter('4244108408582304218');" onmouseout="out('4244108408582304218');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +                                       StreamTableEnvironment tableEnv,                                           </span>
<span class="-485281931312886761" onmouseenter="enter('-485281931312886761');" onmouseout="out('-485281931312886761');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +                                       SqlTree sqlTree,                                                           </span>
<span class="-8143700939579661824" onmouseenter="enter('-8143700939579661824');" onmouseout="out('-8143700939579661824');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +                                       Map&lt;String, SideTableInfo&gt; sideTableMap,                                   </span>
<span class="3151258365792163168" onmouseenter="enter('3151258365792163168');" onmouseout="out('3151258365792163168');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +                                       Map&lt;String, Table&gt; registerTableCache,                                     </span>
<span class="988765244170420280" onmouseenter="enter('988765244170420280');" onmouseout="out('988765244170420280');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +                                       StreamQueryConfig queryConfig) throws Exception {                          </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +                                                                                                                  </span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style=""> 164          SideSqlExec sideSqlExec = new SideSqlExec();                                                              </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style=""> 165          sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                                    </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style=""> 166          for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                             </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style=""><abbr title=" 167              sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 167              sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168          }                                                                                                         </span>
<span  style=""> 169                                                                                                                    </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style=""> 170          for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                                  </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 171              if (LOG.isInfoEnabled()) {                                                                            </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style=""> 172                  LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173              }                                                                                                     </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style=""> 174              boolean isSide = false;                                                                               </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style=""> 175              for (String tableName : result.getTargetTableList()) {                                                </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style=""> 176                  if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                            </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style=""> 177                      CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);           </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style=""> 178                      String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -                                                                                                                  </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 180 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 180 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_🔵</abbr></span>
<span class="-1075958635284917181" onmouseenter="enter('-1075958635284917181');" onmouseout="out('-1075958635284917181');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +                    FlinkPlannerImpl flinkPlanner = FlinkPlanner.getFlinkPlanner();                               </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +                                                                                                                  </span>
<span class="-1169903474645440554" onmouseenter="enter('-1169903474645440554');" onmouseout="out('-1169903474645440554');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +                    SqlNode sqlNode = flinkPlanner.parse(realSql);                                                </span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style=""> 184                      String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                                 </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style=""> 185                      tmp.setExecSql(tmpSql);                                                                       </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style=""><abbr title=" 186                      sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 186                      sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tm🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 187                  } else {                                                                                          </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style=""> 188                      for (String sourceTable : result.getSourceTableList()) {                                      </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style=""> 189                          if (sideTableMap.containsKey(sourceTable)) {                                              </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style=""> 190                              isSide = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 191                              break;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193                      }                                                                                             </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style=""> 194                      if (isSide) {                                                                                 </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style=""> 195                          //sql-dimensional table contains the dimension table of execution                         </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style=""><abbr title=" 196                          sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 196                          sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryCon🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 197                      }else{                                                                                        </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style=""> 198                          System.out.println(&quot;----------exec sql without dimension join-----------&quot; );              </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style=""> 199                          System.out.println(&quot;----------real sql exec is--------------------------&quot;);               </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style=""> 200                          System.out.println(result.getExecSql());                                                  </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style=""> 201                          FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);                       </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style=""> 202                          if(LOG.isInfoEnabled()){                                                                  </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style=""> 203                              System.out.println();                                                                 </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style=""> 204                              LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209          }                                                                                                         </span>
<span  style=""> 210                                                                                                                    </span>
<span  style=""> 211                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212      }                                                                                                             </span>
<span  style=""> 213                                                                                                                    </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style=""><abbr title=" 215      private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 215      private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEn🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style=""> 216              throws IllegalAccessException, InvocationTargetException {                                            </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style=""> 217          // udf和tableEnv须由同一个类加载器加载                                                                                </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style=""> 218          ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                                      </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style=""> 219          URLClassLoader classLoader = null;                                                                        </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style=""> 220          List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                              </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style=""> 221          for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                              </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style=""> 222              //classloader                                                                                         </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style=""> 223              if (classLoader == null) {                                                                            </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style=""> 224                  classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225              }                                                                                                     </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style=""><abbr title=" 226              FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 226              FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv,🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228      }                                                                                                             </span>
<span  style=""> 229                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 230      /**                                                                                                           </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style=""> 231       *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                             </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style=""> 232       * @param sqlTree                                                                                             </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style=""> 233       * @param env                                                                                                 </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style=""> 234       * @param tableEnv                                                                                            </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style=""> 235       * @param localSqlPluginPath                                                                                  </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style=""> 236       * @param remoteSqlPluginPath                                                                                 </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style=""> 237       * @param pluginLoadMode   插件加载模式 classpath or shipfile                                                       </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style=""> 238       * @param sideTableMap                                                                                        </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style=""> 239       * @param registerTableCache                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 240       * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style=""> 241       * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 242       */                                                                                                           </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style=""><abbr title=" 243      private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 243      private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment 🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style=""><abbr title=" 244                                            String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 244                                            String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTable🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style=""> 245          Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                                        </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style=""> 246          WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                                      </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style=""> 247          for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                          </span>
<span  style=""> 248                                                                                                                    </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style=""> 249              if (tableInfo instanceof SourceTableInfo) {                                                           </span>
<span  style=""> 250                                                                                                                    </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style=""> 251                  SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                                    </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style=""><abbr title=" 252                  Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 252                  Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPa🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style=""> 253                  tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                                    </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style=""><abbr title=" 254                  //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 254                  //Note --- parameter conversion function can not be used inside a function of the type of polymeri🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style=""> 255                  //Create table in which the function is arranged only need adaptation sql                         </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style=""> 256                  String adaptSql = sourceTableInfo.getAdaptSelectSql();                                            </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style=""> 257                  Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);                        </span>
<span  style=""> 258                                                                                                                    </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style=""><abbr title=" 259                  RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 259                  RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().g🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style=""> 260                  DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                           </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style=""> 261                          .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                               </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style=""> 262                          .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                                  </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style=""> 263                          .returns(typeInfo);                                                                       </span>
<span  style=""> 264                                                                                                                    </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style=""> 265                  String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                                       </span>
<span  style=""> 266                                                                                                                    </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style=""> 267                  if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                            </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style=""> 268                      adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);  </span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style=""> 269                      fields += &quot;,ROWTIME.ROWTIME&quot;;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 270                  } else {                                                                                          </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style=""> 271                      fields += &quot;,PROCTIME.PROCTIME&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272                  }                                                                                                 </span>
<span  style=""> 273                                                                                                                    </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style=""> 274                  Table regTable = tableEnv.fromDataStream(adaptStream, fields);                                    </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style=""> 275                  tableEnv.registerTable(tableInfo.getName(), regTable);                                            </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style=""> 276                  if (LOG.isInfoEnabled()) {                                                                        </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style=""> 277                      LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278                  }                                                                                                 </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style=""> 279                  registerTableCache.put(tableInfo.getName(), regTable);                                            </span>
<span  style=""> 280                                                                                                                    </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style=""><abbr title=" 281                  URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 281                  URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTa🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style=""> 282                  pluginClassPatshSets.add(sourceTablePathUrl);                                                     </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style=""> 283              } else if (tableInfo instanceof TargetTableInfo) {                                                    </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style=""><abbr title=" 285                  TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 285                  TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPa🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style=""> 286                  TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());       </span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style=""> 287                  tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);    </span>
<span  style=""> 288                                                                                                                    </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style=""><abbr title=" 289                  URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 289                  URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTabl🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style=""> 290                  pluginClassPatshSets.add(sinkTablePathUrl);                                                       </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style=""> 291              } else if (tableInfo instanceof SideTableInfo) {                                                      </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style=""><abbr title=" 292                  String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 292                  String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style=""> 293                  sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                                 </span>
<span  style=""> 294                                                                                                                    </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style=""><abbr title=" 295                  URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 295                  URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideT🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style=""> 296                  pluginClassPatshSets.add(sideTablePathUrl);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 297              } else {                                                                                              </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style=""> 298                  throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300          }                                                                                                         </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style=""> 301          return pluginClassPatshSets;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302      }                                                                                                             </span>
<span  style=""> 303                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 304      /**                                                                                                           </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style=""> 305       *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style=""> 306       * @param env                                                                                                 </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style=""> 307       * @param classPathSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 308       */                                                                                                           </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style=""> 309      private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style=""> 310          int i = 0;                                                                                                </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style=""> 311          for (URL url : classPathSet) {                                                                            </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style=""> 312              String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                         </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style=""> 313              env.registerCachedFile(url.getPath(), classFileName, true);                                           </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style=""> 314              i++;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316      }                                                                                                             </span>
<span  style=""> 317                                                                                                                    </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style=""><abbr title=" 318      private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 318      private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style=""> 319          StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                           </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style=""> 320                  StreamExecutionEnvironment.getExecutionEnvironment() :                                            </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style=""> 321                  new MyLocalStreamEnvironment();                                                                   </span>
<span  style=""> 322                                                                                                                    </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style=""> 323          StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                             </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style=""> 324          return env;                                                                                               </span>




<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            