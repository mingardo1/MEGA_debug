<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>193</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    193
                    <a href="192.html">prev</a>
                    <a href="194.html">next</a>
                    <a href="193_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_89e275c67fd74f0edf3ff03711c8c7a4a9610791_core/broadleaf-framework/src/test/java/org/broadleafcommerce/core/offer/service/processor/FulfillmentGroupOfferProcessorTest.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;89e275c67fd74f0edf3ff03711c8c7a4a9610791:core/broadleaf-framework/src/test/java/org/broadleafcommerce/core/offer/service/processor/FulfillmentGroupOfferProcessorTest.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;89e275c67fd74f0edf3ff03711c8c7a4a9610791^1:core/broadleaf-framework/src/test/java/org/broadleafcommerce/core/offer/service/processor/FulfillmentGroupOfferProcessorTest.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;89e275c67fd74f0edf3ff03711c8c7a4a9610791^2:core/broadleaf-framework/src/test/java/org/broadleafcommerce/core/offer/service/processor/FulfillmentGroupOfferProcessorTest.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;a48cd6ca647e4a58cde4097171bd233ed3e8511d:core/broadleaf-framework/src/test/java/org/broadleafcommerce/core/offer/service/processor/FulfillmentGroupOfferProcessorTest.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [bsj], [bj]], subset: [[b], [b], [bsj], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-5062573030309236877" onmouseenter="enter('-5062573030309236877');" onmouseout="out('-5062573030309236877');" style="">   3  * BroadleafCommerce Framework                                                                           </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4156106492343801428" onmouseenter="enter('-4156106492343801428');" onmouseout="out('-4156106492343801428');" style="">  18 package org.broadleafcommerce.core.offer.service.processor;                                              </span>
<span  style="">  19                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  20 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import junit.framework.TestCase;                                                                         </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22                                                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  23 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                            </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  26 =======                                                                                                  </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  27 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  28 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="">  29 import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                            </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="">  30 import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                </span>
<span class="-2793633202507663758" onmouseenter="enter('-2793633202507663758');" onmouseout="out('-2793633202507663758');" style="">  31 import org.broadleafcommerce.core.offer.dao.OfferDao;                                                    </span>
<span class="796126113999839594" onmouseenter="enter('796126113999839594');" onmouseout="out('796126113999839594');" style="">  32 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;                           </span>
<span class="2150723484434835298" onmouseenter="enter('2150723484434835298');" onmouseout="out('2150723484434835298');" style="">  33 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;                       </span>
<span class="4011152823911960428" onmouseenter="enter('4011152823911960428');" onmouseout="out('4011152823911960428');" style="">  34 import org.broadleafcommerce.core.offer.domain.CandidateItemOffer;                                       </span>
<span class="-735428748329738672" onmouseenter="enter('-735428748329738672');" onmouseout="out('-735428748329738672');" style="">  35 import org.broadleafcommerce.core.offer.domain.CandidateItemOfferImpl;                                   </span>
<span class="5599608658353832247" onmouseenter="enter('5599608658353832247');" onmouseout="out('5599608658353832247');" style="">  36 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;                               </span>
<span class="6308539507696801789" onmouseenter="enter('6308539507696801789');" onmouseout="out('6308539507696801789');" style="">  37 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;                           </span>
<span class="4081153142019712377" onmouseenter="enter('4081153142019712377');" onmouseout="out('4081153142019712377');" style="">  38 import org.broadleafcommerce.core.offer.domain.Offer;                                                    </span>
<span class="-7025591891527881733" onmouseenter="enter('-7025591891527881733');" onmouseout="out('-7025591891527881733');" style="">  39 import org.broadleafcommerce.core.offer.domain.OfferImpl;                                                </span>
<span class="1133170227846016200" onmouseenter="enter('1133170227846016200');" onmouseout="out('1133170227846016200');" style="">  40 import org.broadleafcommerce.core.offer.domain.OfferQualifyingCriteriaXref;                              </span>
<span class="-1124625745990626401" onmouseenter="enter('-1124625745990626401');" onmouseout="out('-1124625745990626401');" style="">  41 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustment;                                      </span>
<span class="-6005336697873394325" onmouseenter="enter('-6005336697873394325');" onmouseout="out('-6005336697873394325');" style="">  42 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustmentImpl;                                  </span>
<span class="1848619708404770384" onmouseenter="enter('1848619708404770384');" onmouseout="out('1848619708404770384');" style="">  43 import org.broadleafcommerce.core.offer.service.OfferDataItemProvider;                                   </span>
<span class="-6326345691456347408" onmouseenter="enter('-6326345691456347408');" onmouseout="out('-6326345691456347408');" style="">  44 import org.broadleafcommerce.core.offer.service.OfferServiceImpl;                                        </span>
<span class="2599349157106653381" onmouseenter="enter('2599349157106653381');" onmouseout="out('2599349157106653381');" style="">  45 import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;                                   </span>
<span class="-3097197529305387536" onmouseenter="enter('-3097197529305387536');" onmouseout="out('-3097197529305387536');" style="">  46 import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;                               </span>
<span class="212527052176527689" onmouseenter="enter('212527052176527689');" onmouseout="out('212527052176527689');" style="">  47 import org.broadleafcommerce.core.offer.service.discount.CandidatePromotionItems;                        </span>
<span class="4287099423657810905" onmouseenter="enter('4287099423657810905');" onmouseout="out('4287099423657810905');" style="">  48 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateFulfillmentGroupOffer;</span>
<span class="4826353322748911550" onmouseenter="enter('4826353322748911550');" onmouseout="out('4826353322748911550');" style="">  49 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableFulfillmentGroup;              </span>
<span class="-7261038068657094491" onmouseenter="enter('-7261038068657094491');" onmouseout="out('-7261038068657094491');" style="">  50 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableItemFactoryImpl;               </span>
<span class="5738750158392070" onmouseenter="enter('5738750158392070');" onmouseout="out('5738750158392070');" style="">  51 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;                  </span>
<span class="8873929720094471664" onmouseenter="enter('8873929720094471664');" onmouseout="out('8873929720094471664');" style="">  52 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;              </span>
<span class="-6456406933954769040" onmouseenter="enter('-6456406933954769040');" onmouseout="out('-6456406933954769040');" style="">  53 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrder;                         </span>
<span class="-7733804833771661823" onmouseenter="enter('-7733804833771661823');" onmouseout="out('-7733804833771661823');" style="">  54 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItem;                     </span>
<span class="-5253725521220244448" onmouseenter="enter('-5253725521220244448');" onmouseout="out('-5253725521220244448');" style="">  55 import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;                                  </span>
<span class="-4951365057913084569" onmouseenter="enter('-4951365057913084569');" onmouseout="out('-4951365057913084569');" style="">  56 import org.broadleafcommerce.core.order.dao.FulfillmentGroupItemDao;                                     </span>
<span class="-7012758821456487335" onmouseenter="enter('-7012758821456487335');" onmouseout="out('-7012758821456487335');" style="">  57 import org.broadleafcommerce.core.order.dao.OrderItemDao;                                                </span>
<span class="-6302349778747925467" onmouseenter="enter('-6302349778747925467');" onmouseout="out('-6302349778747925467');" style="">  58 import org.broadleafcommerce.core.order.domain.FulfillmentGroup;                                         </span>
<span class="-7855842771160128779" onmouseenter="enter('-7855842771160128779');" onmouseout="out('-7855842771160128779');" style="">  59 import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;                                     </span>
<span class="-6039448701992847179" onmouseenter="enter('-6039448701992847179');" onmouseout="out('-6039448701992847179');" style="">  60 import org.broadleafcommerce.core.order.domain.Order;                                                    </span>
<span class="-3117062451881073195" onmouseenter="enter('-3117062451881073195');" onmouseout="out('-3117062451881073195');" style="">  61 import org.broadleafcommerce.core.order.domain.OrderItem;                                                </span>
<span class="230297408131782266" onmouseenter="enter('230297408131782266');" onmouseout="out('230297408131782266');" style="">  62 import org.broadleafcommerce.core.order.domain.OrderItemPriceDetail;                                     </span>
<span class="1218446574017128210" onmouseenter="enter('1218446574017128210');" onmouseout="out('1218446574017128210');" style="">  63 import org.broadleafcommerce.core.order.domain.OrderMultishipOption;                                     </span>
<span class="5244138541064665880" onmouseenter="enter('5244138541064665880');" onmouseout="out('5244138541064665880');" style="">  64 import org.broadleafcommerce.core.order.domain.OrderMultishipOptionImpl;                                 </span>
<span class="9050710118625717230" onmouseenter="enter('9050710118625717230');" onmouseout="out('9050710118625717230');" style="">  65 import org.broadleafcommerce.core.order.service.FulfillmentGroupService;                                 </span>
<span class="2043331085843421951" onmouseenter="enter('2043331085843421951');" onmouseout="out('2043331085843421951');" style="">  66 import org.broadleafcommerce.core.order.service.OrderItemService;                                        </span>
<span class="-4438462058374014857" onmouseenter="enter('-4438462058374014857');" onmouseout="out('-4438462058374014857');" style="">  67 import org.broadleafcommerce.core.order.service.OrderMultishipOptionService;                             </span>
<span class="-4523094285760083742" onmouseenter="enter('-4523094285760083742');" onmouseout="out('-4523094285760083742');" style="">  68 import org.broadleafcommerce.core.order.service.OrderService;                                            </span>
<span class="426062199469058864" onmouseenter="enter('426062199469058864');" onmouseout="out('426062199469058864');" style="">  69 import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;                        </span>
<span class="1499051134121889616" onmouseenter="enter('1499051134121889616');" onmouseout="out('1499051134121889616');" style="">  70 import org.broadleafcommerce.profile.core.domain.Address;                                                </span>
<span class="8043089028015557901" onmouseenter="enter('8043089028015557901');" onmouseout="out('8043089028015557901');" style="">  71 import org.easymock.EasyMock;                                                                            </span>
<span class="8773851019359685182" onmouseenter="enter('8773851019359685182');" onmouseout="out('8773851019359685182');" style="">  72 import org.easymock.IAnswer;                                                                             </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  73 import java.math.BigDecimal;                                                                             </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  74 import java.util.ArrayList;                                                                              </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  75 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  76 import java.util.List;                                                                                   </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  77 import java.util.TimeZone;                                                                               </span>
<span  style="">  78                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  79 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  80  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  81  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  82  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  83  */                                                                                                      </span>
<span class="-6422014710110996402" onmouseenter="enter('-6422014710110996402');" onmouseout="out('-6422014710110996402');" style="">  84 public class FulfillmentGroupOfferProcessorTest extends TestCase {                                       </span>
<span  style="">  85                                                                                                          </span>
<span class="2764411618740579830" onmouseenter="enter('2764411618740579830');" onmouseout="out('2764411618740579830');" style="">  86     protected OfferDao offerDaoMock;                                                                     </span>
<span class="-1028825014202044443" onmouseenter="enter('-1028825014202044443');" onmouseout="out('-1028825014202044443');" style="">  87     protected OrderItemDao orderItemDaoMock;                                                             </span>
<span class="3942591246150891792" onmouseenter="enter('3942591246150891792');" onmouseout="out('3942591246150891792');" style="">  88     protected OfferServiceImpl offerService;                                                             </span>
<span class="2155154311276627388" onmouseenter="enter('2155154311276627388');" onmouseout="out('2155154311276627388');" style="">  89     protected final OfferDataItemProvider dataProvider = new OfferDataItemProvider();                    </span>
<span class="-5369679977326057444" onmouseenter="enter('-5369679977326057444');" onmouseout="out('-5369679977326057444');" style="">  90     protected OrderService orderServiceMock;                                                             </span>
<span class="-2082308031004269425" onmouseenter="enter('-2082308031004269425');" onmouseout="out('-2082308031004269425');" style="">  91     protected OrderItemService orderItemServiceMock;                                                     </span>
<span class="8143262996519322151" onmouseenter="enter('8143262996519322151');" onmouseout="out('8143262996519322151');" style="">  92     protected FulfillmentGroupItemDao fgItemDaoMock;                                                     </span>
<span class="3331618624366763309" onmouseenter="enter('3331618624366763309');" onmouseout="out('3331618624366763309');" style="">  93     protected FulfillmentGroupService fgServiceMock;                                                     </span>
<span class="2038085072144601851" onmouseenter="enter('2038085072144601851');" onmouseout="out('2038085072144601851');" style="">  94     protected OrderMultishipOptionService multishipOptionServiceMock;                                    </span>
<span class="1636757603740185885" onmouseenter="enter('1636757603740185885');" onmouseout="out('1636757603740185885');" style="">  95     protected OfferTimeZoneProcessor offerTimeZoneProcessorMock;                                         </span>
<span class="-8980537951567645236" onmouseenter="enter('-8980537951567645236');" onmouseout="out('-8980537951567645236');" style="">  96     protected OfferServiceUtilities offerServiceUtilitiesMock;                                           </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  97 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-363767546438432308" onmouseenter="enter('-363767546438432308');" onmouseout="out('-363767546438432308');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  98     protected PromotableOfferUtility promotableOfferUtility;                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  99 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100     protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                            </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 101 =======                                                                                                  </span>
<span class="8126767976686599164" onmouseenter="enter('8126767976686599164');" onmouseout="out('8126767976686599164');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102     protected GenericEntityService genericEntityServiceMock;                                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 103 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 104                                                                                                          </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style=""> 105     protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                            </span>
<span  style=""> 106                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 107     /**                                                                                                  </span>
<span class="-1217892123140267909" onmouseenter="enter('-1217892123140267909');" onmouseout="out('-1217892123140267909');" style=""><abbr title=" 108      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and"> 108      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application coðŸ”µ</abbr></span>
<span class="-8822842737667556133" onmouseenter="enter('-8822842737667556133');" onmouseout="out('-8822842737667556133');" style=""> 109      * system properties service since it uses BLCSystemProperty                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 110      *                                                                                                   </span>
<span class="2670632328160232809" onmouseenter="enter('2670632328160232809');" onmouseout="out('2670632328160232809');" style=""> 111      * @author Phillip Verheyden (phillipuniverse)                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 112      */                                                                                                  </span>
<span class="8403268836763647235" onmouseenter="enter('8403268836763647235');" onmouseout="out('8403268836763647235');" style=""><abbr title=" 113     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {"> 113     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorIðŸ”µ</abbr></span>
<span class="7280310143433037386" onmouseenter="enter('7280310143433037386');" onmouseout="out('7280310143433037386');" style=""> 114         public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {   </span>
<span class="386697006679121838" onmouseenter="enter('386697006679121838');" onmouseout="out('386697006679121838');" style=""> 115             super(promotableOfferUtility);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116         }                                                                                                </span>
<span  style=""> 117                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 118         @Override                                                                                        </span>
<span class="-5327199138035207588" onmouseenter="enter('-5327199138035207588');" onmouseout="out('-5327199138035207588');" style=""> 119         protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 120             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="2289017037938349582" onmouseenter="enter('2289017037938349582');" onmouseout="out('2289017037938349582');" style=""> 125     protected void setUp() throws Exception {                                                            </span>
<span class="-7001064742117532685" onmouseenter="enter('-7001064742117532685');" onmouseout="out('-7001064742117532685');" style=""> 126         offerService = new OfferServiceImpl();                                                           </span>
<span class="-5376116141285812671" onmouseenter="enter('-5376116141285812671');" onmouseout="out('-5376116141285812671');" style=""> 127         CustomerOfferDao customerOfferDaoMock = EasyMock.createMock(CustomerOfferDao.class);             </span>
<span class="-570975167499705701" onmouseenter="enter('-570975167499705701');" onmouseout="out('-570975167499705701');" style=""> 128         OfferCodeDao offerCodeDaoMock = EasyMock.createMock(OfferCodeDao.class);                         </span>
<span class="393627947078248392" onmouseenter="enter('393627947078248392');" onmouseout="out('393627947078248392');" style=""> 129         orderServiceMock = EasyMock.createMock(OrderService.class);                                      </span>
<span class="7274735973437056507" onmouseenter="enter('7274735973437056507');" onmouseout="out('7274735973437056507');" style=""> 130         orderItemDaoMock = EasyMock.createMock(OrderItemDao.class);                                      </span>
<span  style=""> 131                                                                                                          </span>
<span class="1993264780541814880" onmouseenter="enter('1993264780541814880');" onmouseout="out('1993264780541814880');" style=""> 132         orderItemServiceMock = EasyMock.createMock(OrderItemService.class);                              </span>
<span class="-3213369057155598174" onmouseenter="enter('-3213369057155598174');" onmouseout="out('-3213369057155598174');" style=""> 133         fgItemDaoMock = EasyMock.createMock(FulfillmentGroupItemDao.class);                              </span>
<span class="3258640190833853601" onmouseenter="enter('3258640190833853601');" onmouseout="out('3258640190833853601');" style=""> 134         offerDaoMock = EasyMock.createMock(OfferDao.class);                                              </span>
<span class="6964150545963317885" onmouseenter="enter('6964150545963317885');" onmouseout="out('6964150545963317885');" style=""> 135         fgServiceMock = EasyMock.createMock(FulfillmentGroupService.class);                              </span>
<span class="-3871783238737974896" onmouseenter="enter('-3871783238737974896');" onmouseout="out('-3871783238737974896');" style=""> 136         multishipOptionServiceMock = EasyMock.createMock(OrderMultishipOptionService.class);             </span>
<span class="616226227087806826" onmouseenter="enter('616226227087806826');" onmouseout="out('616226227087806826');" style=""> 137         offerServiceUtilitiesMock = EasyMock.createMock(OfferServiceUtilities.class);                    </span>
<span class="-3280473616402059983" onmouseenter="enter('-3280473616402059983');" onmouseout="out('-3280473616402059983');" style=""> 138         offerTimeZoneProcessorMock = EasyMock.createMock(OfferTimeZoneProcessor.class);                  </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 139 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-5708051595893590327" onmouseenter="enter('-5708051595893590327');" onmouseout="out('-5708051595893590327');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140         promotableOfferUtility = new PromotableOfferUtilityImpl();                                       </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 141 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142         fgProcessor.setOfferDao(offerDaoMock);                                                           </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         fgProcessor.setOrderItemDao(orderItemDaoMock);                                                   </span>
<span class="-9198117990764754611" onmouseenter="enter('-9198117990764754611');" onmouseout="out('-9198117990764754611');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                           </span>
<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145         fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 147 =======                                                                                                  </span>
<span class="-8978123556236380411" onmouseenter="enter('-8978123556236380411');" onmouseout="out('-8978123556236380411');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148         genericEntityServiceMock = EasyMock.createMock(GenericEntityService.class);                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 149 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 150                                                                                                          </span>
<span class="-6566235364085313060" onmouseenter="enter('-6566235364085313060');" onmouseout="out('-6566235364085313060');" style=""> 151         fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);                </span>
<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style=""> 152         fgProcessor.setOfferDao(offerDaoMock);                                                           </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style=""> 153         fgProcessor.setOrderItemDao(orderItemDaoMock);                                                   </span>
<span class="3776294526577008852" onmouseenter="enter('3776294526577008852');" onmouseout="out('3776294526577008852');" style=""> 154         fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));     </span>
<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style=""> 155         fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                 </span>
<span  style=""> 156                                                                                                          </span>
<span class="3514247750798048226" onmouseenter="enter('3514247750798048226');" onmouseout="out('3514247750798048226');" style=""><abbr title=" 157         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);"> 157         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtðŸ”µ</abbr></span>
<span class="4393308911552043332" onmouseenter="enter('4393308911552043332');" onmouseout="out('4393308911552043332');" style=""> 158         offerServiceUtilities.setOfferDao(offerDaoMock);                                                 </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 159 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="7561232175961587910" onmouseenter="enter('7561232175961587910');" onmouseout="out('7561232175961587910');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 160         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));"> 160         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtiliðŸ”µ</abbr></span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 161 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162         orderProcessor.setOfferDao(offerDaoMock);                                                        </span>
<span class="7588180708377269856" onmouseenter="enter('7588180708377269856');" onmouseout="out('7588180708377269856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                        </span>
<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164         orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                              </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                            </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166         orderProcessor.setOrderItemDao(orderItemDaoMock);                                                </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 167 =======                                                                                                  </span>
<span class="8672470870156482430" onmouseenter="enter('8672470870156482430');" onmouseout="out('8672470870156482430');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());                 </span>
<span class="8346807884110674152" onmouseenter="enter('8346807884110674152');" onmouseout="out('8346807884110674152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169         offerServiceUtilities.setGenericEntityService(genericEntityServiceMock);                         </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 170 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 171                                                                                                          </span>
<span class="-7168324839350089956" onmouseenter="enter('-7168324839350089956');" onmouseout="out('-7168324839350089956');" style=""> 172         OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);    </span>
<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style=""> 173         orderProcessor.setOfferDao(offerDaoMock);                                                        </span>
<span class="5575229934633988866" onmouseenter="enter('5575229934633988866');" onmouseout="out('5575229934633988866');" style=""> 174         orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));  </span>
<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style=""> 175         orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                              </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style=""> 176         orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                            </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style=""> 177         orderProcessor.setOrderItemDao(orderItemDaoMock);                                                </span>
<span class="-8932862412317704790" onmouseenter="enter('-8932862412317704790');" onmouseout="out('-8932862412317704790');" style=""> 178         orderProcessor.setOfferServiceUtilities(offerServiceUtilities);                                  </span>
<span  style=""> 179                                                                                                          </span>
<span class="4016707405384637073" onmouseenter="enter('4016707405384637073');" onmouseout="out('4016707405384637073');" style=""> 180         ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);       </span>
<span class="-7004957386218896406" onmouseenter="enter('-7004957386218896406');" onmouseout="out('-7004957386218896406');" style=""> 181         itemProcessor.setOfferDao(offerDaoMock);                                                         </span>
<span class="-2793185480423849018" onmouseenter="enter('-2793185480423849018');" onmouseout="out('-2793185480423849018');" style=""> 182         itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));   </span>
<span class="-7985735156898326914" onmouseenter="enter('-7985735156898326914');" onmouseout="out('-7985735156898326914');" style=""> 183         itemProcessor.setOrderItemDao(orderItemDaoMock);                                                 </span>
<span class="1873271206223196651" onmouseenter="enter('1873271206223196651');" onmouseout="out('1873271206223196651');" style=""> 184         itemProcessor.setOfferServiceUtilities(offerServiceUtilities);                                   </span>
<span  style=""> 185                                                                                                          </span>
<span class="-7594314374485898167" onmouseenter="enter('-7594314374485898167');" onmouseout="out('-7594314374485898167');" style=""> 186         offerService.setCustomerOfferDao(customerOfferDaoMock);                                          </span>
<span class="483175997286853822" onmouseenter="enter('483175997286853822');" onmouseout="out('483175997286853822');" style=""> 187         offerService.setOfferCodeDao(offerCodeDaoMock);                                                  </span>
<span class="-157638129368187663" onmouseenter="enter('-157638129368187663');" onmouseout="out('-157638129368187663');" style=""> 188         offerService.setOfferDao(offerDaoMock);                                                          </span>
<span class="-2861300639666845512" onmouseenter="enter('-2861300639666845512');" onmouseout="out('-2861300639666845512');" style=""> 189         offerService.setOrderOfferProcessor(orderProcessor);                                             </span>
<span class="4668119620018038426" onmouseenter="enter('4668119620018038426');" onmouseout="out('4668119620018038426');" style=""> 190         offerService.setItemOfferProcessor(itemProcessor);                                               </span>
<span class="-4412724488869175480" onmouseenter="enter('-4412724488869175480');" onmouseout="out('-4412724488869175480');" style=""> 191         offerService.setFulfillmentGroupOfferProcessor(fgProcessor);                                     </span>
<span class="-2798583477021709202" onmouseenter="enter('-2798583477021709202');" onmouseout="out('-2798583477021709202');" style=""> 192         offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));    </span>
<span class="-7013122243510448528" onmouseenter="enter('-7013122243510448528');" onmouseout="out('-7013122243510448528');" style=""> 193         offerService.setOrderService(orderServiceMock);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="3027682741895790020" onmouseenter="enter('3027682741895790020');" onmouseout="out('3027682741895790020');" style=""> 196     public void replay() {                                                                               </span>
<span class="4039967104390893601" onmouseenter="enter('4039967104390893601');" onmouseout="out('4039967104390893601');" style=""> 197         EasyMock.replay(offerDaoMock);                                                                   </span>
<span class="-8438798452743116996" onmouseenter="enter('-8438798452743116996');" onmouseout="out('-8438798452743116996');" style=""> 198         EasyMock.replay(orderItemDaoMock);                                                               </span>
<span class="-306516478140011318" onmouseenter="enter('-306516478140011318');" onmouseout="out('-306516478140011318');" style=""> 199         EasyMock.replay(orderServiceMock);                                                               </span>
<span class="-1764805494951210013" onmouseenter="enter('-1764805494951210013');" onmouseout="out('-1764805494951210013');" style=""> 200         EasyMock.replay(orderItemServiceMock);                                                           </span>
<span class="1127149787736159594" onmouseenter="enter('1127149787736159594');" onmouseout="out('1127149787736159594');" style=""> 201         EasyMock.replay(fgItemDaoMock);                                                                  </span>
<span class="220377317211655869" onmouseenter="enter('220377317211655869');" onmouseout="out('220377317211655869');" style=""> 202         EasyMock.replay(fgServiceMock);                                                                  </span>
<span class="7141248576860687210" onmouseenter="enter('7141248576860687210');" onmouseout="out('7141248576860687210');" style=""> 203         EasyMock.replay(multishipOptionServiceMock);                                                     </span>
<span class="1625398624145697967" onmouseenter="enter('1625398624145697967');" onmouseout="out('1625398624145697967');" style=""> 204         EasyMock.replay(offerTimeZoneProcessorMock);                                                     </span>
<span class="7441173554159837333" onmouseenter="enter('7441173554159837333');" onmouseout="out('7441173554159837333');" style=""> 205         EasyMock.replay(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206     }                                                                                                    </span>
<span  style=""> 207                                                                                                          </span>
<span class="6267001839391766981" onmouseenter="enter('6267001839391766981');" onmouseout="out('6267001839391766981');" style=""> 208     public void verify() {                                                                               </span>
<span class="6756940960390862422" onmouseenter="enter('6756940960390862422');" onmouseout="out('6756940960390862422');" style=""> 209         EasyMock.verify(offerDaoMock);                                                                   </span>
<span class="-5117344946758939057" onmouseenter="enter('-5117344946758939057');" onmouseout="out('-5117344946758939057');" style=""> 210         EasyMock.verify(orderItemDaoMock);                                                               </span>
<span class="-6538245312297088944" onmouseenter="enter('-6538245312297088944');" onmouseout="out('-6538245312297088944');" style=""> 211         EasyMock.verify(orderServiceMock);                                                               </span>
<span class="4656187310788509663" onmouseenter="enter('4656187310788509663');" onmouseout="out('4656187310788509663');" style=""> 212         EasyMock.verify(orderItemServiceMock);                                                           </span>
<span class="-3344344690958109982" onmouseenter="enter('-3344344690958109982');" onmouseout="out('-3344344690958109982');" style=""> 213         EasyMock.verify(fgItemDaoMock);                                                                  </span>
<span class="-7107457974865616724" onmouseenter="enter('-7107457974865616724');" onmouseout="out('-7107457974865616724');" style=""> 214         EasyMock.verify(fgServiceMock);                                                                  </span>
<span class="3082501288673197520" onmouseenter="enter('3082501288673197520');" onmouseout="out('3082501288673197520');" style=""> 215         EasyMock.verify(multishipOptionServiceMock);                                                     </span>
<span class="8968216054532738001" onmouseenter="enter('8968216054532738001');" onmouseout="out('8968216054532738001');" style=""> 216         EasyMock.verify(offerTimeZoneProcessorMock);                                                     </span>
<span class="1970601797097358226" onmouseenter="enter('1970601797097358226');" onmouseout="out('1970601797097358226');" style=""> 217         EasyMock.verify(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="4350196711973577847" onmouseenter="enter('4350196711973577847');" onmouseout="out('4350196711973577847');" style=""> 220     public void testApplyAllFulfillmentGroupOffersWithOrderItemOffers() throws Exception {               </span>
<span class="8446165972037001535" onmouseenter="enter('8446165972037001535');" onmouseout="out('8446165972037001535');" style=""> 221         final ThreadLocal&lt;Order&gt; myOrder = new ThreadLocal&lt;Order&gt;();                                     </span>
<span class="3688914841313020601" onmouseenter="enter('3688914841313020601');" onmouseout="out('3688914841313020601');" style=""><abbr title=" 222         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAnswer()).anyTimes();"> 222         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.geðŸ”µ</abbr></span>
<span  style=""> 223                                                                                                          </span>
<span class="244050499009988211" onmouseenter="enter('244050499009988211');" onmouseout="out('244050499009988211');" style=""><abbr title=" 224         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrderItemQualifierAnswer()).atLeastOnce();"> 224         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCðŸ”µ</abbr></span>
<span  style=""> 225                                                                                                          </span>
<span class="-4805711593793558927" onmouseenter="enter('-4805711593793558927');" onmouseout="out('-4805711593793558927');" style=""><abbr title=" 226         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getAddItemToFulfillmentGroupAnswer()).anyTimes();"> 226         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.ðŸ”µ</abbr></span>
<span class="-4648578783612235576" onmouseenter="enter('-4648578783612235576');" onmouseout="out('-4648578783612235576');" style=""><abbr title=" 227         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getRemoveItemFromOrderAnswer()).anyTimes();"> 227         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EðŸ”µ</abbr></span>
<span class="-25100646963641968" onmouseenter="enter('-25100646963641968');" onmouseout="out('-25100646963641968');" style=""><abbr title=" 228         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OfferDataItemProvider.getSaveOrderAnswer()).anyTimes();"> 228         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).anðŸ”µ</abbr></span>
<span  style=""> 229                                                                                                          </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 230         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 230         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 231         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 231         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span  style=""> 232                                                                                                          </span>
<span class="2160564019413082164" onmouseenter="enter('2160564019413082164');" onmouseout="out('2160564019413082164');" style=""> 233         EasyMock.expect(orderServiceMock.getAutomaticallyMergeLikeItems()).andReturn(true).anyTimes();   </span>
<span class="-8884522234726007395" onmouseenter="enter('-8884522234726007395');" onmouseout="out('-8884522234726007395');" style=""><abbr title=" 234         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemProvider.getSaveOrderItemAnswer()).anyTimes();"> 234         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OffeðŸ”µ</abbr></span>
<span class="-3554631046904274751" onmouseenter="enter('-3554631046904274751');" onmouseout="out('-3554631046904274751');" style=""><abbr title=" 235         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProvider.getSaveFulfillmentGroupItemAnswer()).anyTimes();"> 235         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataðŸ”µ</abbr></span>
<span  style=""> 236                                                                                                          </span>
<span class="3313434268437563429" onmouseenter="enter('3313434268437563429');" onmouseout="out('3313434268437563429');" style=""><abbr title=" 237         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAdjustmentAnswer()).anyTimes();"> 237         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProviðŸ”µ</abbr></span>
<span class="-3718636667900446110" onmouseenter="enter('-3718636667900446110');" onmouseout="out('-3718636667900446110');" style=""><abbr title=" 238         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupAdjustmentAnswer()).anyTimes();"> 238         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.ðŸ”µ</abbr></span>
<span  style=""> 239                                                                                                          </span>
<span class="-3815074675149067237" onmouseenter="enter('-3815074675149067237');" onmouseout="out('-3815074675149067237');" style=""><abbr title=" 240         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;Order&gt;() {"> 240         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;OðŸ”µ</abbr></span>
<span  style=""> 241                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 242             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 243             public Order answer() throws Throwable {                                                     </span>
<span class="-2641290802290262879" onmouseenter="enter('-2641290802290262879');" onmouseout="out('-2641290802290262879');" style=""> 244                 return myOrder.get();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 246         }).anyTimes();                                                                                   </span>
<span  style=""> 247                                                                                                          </span>
<span class="2031702441279524669" onmouseenter="enter('2031702441279524669');" onmouseout="out('2031702441279524669');" style=""><abbr title=" 248         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;List&lt;OrderMultishipOption&gt;&gt;() {"> 248         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).aðŸ”µ</abbr></span>
<span  style=""> 249                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 250             @Override                                                                                    </span>
<span class="4982536128511672004" onmouseenter="enter('4982536128511672004');" onmouseout="out('4982536128511672004');" style=""> 251             public List&lt;OrderMultishipOption&gt; answer() throws Throwable {                                </span>
<span class="3348167234255574763" onmouseenter="enter('3348167234255574763');" onmouseout="out('3348167234255574763');" style=""> 252                 List&lt;OrderMultishipOption&gt; options = new ArrayList&lt;OrderMultishipOption&gt;();              </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 253                 PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility); </span>
<span class="-6747846520377446395" onmouseenter="enter('-6747846520377446395');" onmouseout="out('-6747846520377446395');" style=""> 254                 for (FulfillmentGroup fg : order.getOrder().getFulfillmentGroups()) {                    </span>
<span class="-6367521286140114289" onmouseenter="enter('-6367521286140114289');" onmouseout="out('-6367521286140114289');" style=""> 255                     Address address = fg.getAddress();                                                   </span>
<span class="8028460309176757050" onmouseenter="enter('8028460309176757050');" onmouseout="out('8028460309176757050');" style=""> 256                     for (FulfillmentGroupItem fgItem : fg.getFulfillmentGroupItems()) {                  </span>
<span class="8402583593129976695" onmouseenter="enter('8402583593129976695');" onmouseout="out('8402583593129976695');" style=""> 257                         for (int j = 0; j &lt; fgItem.getQuantity(); j++) {                                 </span>
<span class="3921661458783293685" onmouseenter="enter('3921661458783293685');" onmouseout="out('3921661458783293685');" style=""> 258                             OrderMultishipOption option = new OrderMultishipOptionImpl();                </span>
<span class="6971594022266833915" onmouseenter="enter('6971594022266833915');" onmouseout="out('6971594022266833915');" style=""> 259                             option.setOrder(order.getOrder());                                           </span>
<span class="-7842023912465695186" onmouseenter="enter('-7842023912465695186');" onmouseout="out('-7842023912465695186');" style=""> 260                             option.setAddress(address);                                                  </span>
<span class="-8979996557527707436" onmouseenter="enter('-8979996557527707436');" onmouseout="out('-8979996557527707436');" style=""> 261                             option.setOrderItem(fgItem.getOrderItem());                                  </span>
<span class="3662213946586141634" onmouseenter="enter('3662213946586141634');" onmouseout="out('3662213946586141634');" style=""> 262                             options.add(option);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265                 }                                                                                        </span>
<span  style=""> 266                                                                                                          </span>
<span class="7754614799802233964" onmouseenter="enter('7754614799802233964');" onmouseout="out('7754614799802233964');" style=""> 267                 return options;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 269         }).anyTimes();                                                                                   </span>
<span  style=""> 270                                                                                                          </span>
<span class="5730763888734231228" onmouseenter="enter('5730763888734231228');" onmouseout="out('5730763888734231228');" style=""> 271         multishipOptionServiceMock.deleteAllOrderMultishipOptions(EasyMock.isA(Order.class));            </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 272         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="-2684793509385343472" onmouseenter="enter('-2684793509385343472');" onmouseout="out('-2684793509385343472');" style=""><abbr title=" 273         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eq(false))).andAnswer(new IAnswer&lt;Order&gt;() {"> 273         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EðŸ”µ</abbr></span>
<span  style=""> 274                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 275             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 276             public Order answer() throws Throwable {                                                     </span>
<span class="-2361682080301650618" onmouseenter="enter('-2361682080301650618');" onmouseout="out('-2361682080301650618');" style=""> 277                 Order order = (Order) EasyMock.getCurrentArguments()[0];                                 </span>
<span class="6377062998999459231" onmouseenter="enter('6377062998999459231');" onmouseout="out('6377062998999459231');" style=""><abbr title=" 278                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups().get(1).getFulfillmentGroupItems());"> 278                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmenðŸ”µ</abbr></span>
<span class="8328438890662847465" onmouseenter="enter('8328438890662847465');" onmouseout="out('8328438890662847465');" style=""> 279                 order.getFulfillmentGroups().remove(order.getFulfillmentGroups().get(1));                </span>
<span  style=""> 280                                                                                                          </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 281                 return order;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 283         }).anyTimes();                                                                                   </span>
<span class="7005207656442723333" onmouseenter="enter('7005207656442723333');" onmouseout="out('7005207656442723333');" style=""><abbr title=" 284         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnswer()).anyTimes();"> 284         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupðŸ”µ</abbr></span>
<span class="3552856255510166668" onmouseenter="enter('3552856255510166668');" onmouseout="out('3552856255510166668');" style=""> 285         fgItemDaoMock.delete(EasyMock.isA(FulfillmentGroupItem.class));                                  </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 286         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="602433099109498087" onmouseenter="enter('602433099109498087');" onmouseout="out('602433099109498087');" style=""><abbr title=" 287         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.getTimeZone(&quot;CST&quot;)).anyTimes();"> 287         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(ðŸ”µ</abbr></span>
<span  style=""> 288                                                                                                          </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 289         replay();                                                                                        </span>
<span  style=""> 290                                                                                                          </span>
<span class="5984499010113424780" onmouseenter="enter('5984499010113424780');" onmouseout="out('5984499010113424780');" style=""><abbr title=" 291         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);"> 291         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility)ðŸ”µ</abbr></span>
<span class="-396343315567854895" onmouseenter="enter('-396343315567854895');" onmouseout="out('-396343315567854895');" style=""> 292         Order order = promotableOrder.getOrder();                                                        </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 293         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 294         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 294         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 295         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 295         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 296         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 296         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 297         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span  style=""> 298                                                                                                          </span>
<span class="-374141704093766947" onmouseenter="enter('-374141704093766947');" onmouseout="out('-374141704093766947');" style=""> 299         offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(                                 </span>
<span class="-971526457565278793" onmouseenter="enter('-971526457565278793');" onmouseout="out('-971526457565278793');" style=""> 300                 &quot;order.subTotal.getAmount()&gt;20&quot;,                                                         </span>
<span class="8626574580727552658" onmouseenter="enter('8626574580727552658');" onmouseout="out('8626574580727552658');" style=""> 301                 OfferDiscountType.PERCENT_OFF,                                                           </span>
<span class="-1086407973911983614" onmouseenter="enter('-1086407973911983614');" onmouseout="out('-1086407973911983614');" style=""><abbr title=" 302                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;,"> 302                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contaiðŸ”µ</abbr></span>
<span class="-6157256577419644919" onmouseenter="enter('-6157256577419644919');" onmouseout="out('-6157256577419644919');" style=""><abbr title=" 303                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;"> 303                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contaiðŸ”µ</abbr></span>
<span class="3699784701886273761" onmouseenter="enter('3699784701886273761');" onmouseout="out('3699784701886273761');" style=""> 304                 ));                                                                                      </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 305         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span  style=""> 306                                                                                                          </span>
<span class="-5783701790519827054" onmouseenter="enter('-5783701790519827054');" onmouseout="out('-5783701790519827054');" style=""> 307         offers.get(0).setTotalitarianOffer(true);                                                        </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 308         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span  style=""> 309                                                                                                          </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 310         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 311         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 312             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313         }                                                                                                </span>
<span class="-6281142585732833119" onmouseenter="enter('-6281142585732833119');" onmouseout="out('-6281142585732833119');" style=""><abbr title=" 314         //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order item offers"> 314         //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than thðŸ”µ</abbr></span>
<span class="-7018201492040868931" onmouseenter="enter('-7018201492040868931');" onmouseout="out('-7018201492040868931');" style=""> 315         // - it is therefore ignored                                                                     </span>
<span class="8464783908245837933" onmouseenter="enter('8464783908245837933');" onmouseout="out('8464783908245837933');" style=""> 316         //However, the second combinable fg offer is allowed to be applied.                              </span>
<span class="1322310588171640590" onmouseenter="enter('1322310588171640590');" onmouseout="out('1322310588171640590');" style=""> 317         assertTrue(fgAdjustmentCount == 1);                                                              </span>
<span  style=""> 318                                                                                                          </span>
<span class="-1191672713468750443" onmouseenter="enter('-1191672713468750443');" onmouseout="out('-1191672713468750443');" style=""> 319         promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);               </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 320         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="4605867479195622271" onmouseenter="enter('4605867479195622271');" onmouseout="out('4605867479195622271');" style=""> 321         offers.get(2).setValue(new BigDecimal(&quot;1&quot;));                                                     </span>
<span  style=""> 322                                                                                                          </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 323         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 324         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span  style=""> 325                                                                                                          </span>
<span class="5070682841290639966" onmouseenter="enter('5070682841290639966');" onmouseout="out('5070682841290639966');" style=""> 326         fgAdjustmentCount = 0;                                                                           </span>
<span class="-1030185999544814128" onmouseenter="enter('-1030185999544814128');" onmouseout="out('-1030185999544814128');" style=""> 327         order = promotableOrder.getOrder();                                                              </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 328         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 329             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span  style=""> 331                                                                                                          </span>
<span class="-6528829480981189501" onmouseenter="enter('-6528829480981189501');" onmouseout="out('-6528829480981189501');" style=""><abbr title=" 332         //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fg offer is applied"> 332         //The totalitarian fg offer is now a better deal than the order item offers, therefore the totaliðŸ”µ</abbr></span>
<span class="-8173222409402387748" onmouseenter="enter('-8173222409402387748');" onmouseout="out('-8173222409402387748');" style=""> 333         //and the order item offers are removed                                                          </span>
<span class="3307702501962124755" onmouseenter="enter('3307702501962124755');" onmouseout="out('3307702501962124755');" style=""> 334         assertTrue(fgAdjustmentCount == 2);                                                              </span>
<span  style=""> 335                                                                                                          </span>
<span class="-2665219164306343886" onmouseenter="enter('-2665219164306343886');" onmouseout="out('-2665219164306343886');" style=""> 336         int itemAdjustmentCount = 0;                                                                     </span>
<span class="820796442257070700" onmouseenter="enter('820796442257070700');" onmouseout="out('820796442257070700');" style=""> 337         for (OrderItem item : order.getOrderItems()) {                                                   </span>
<span class="773323050474809935" onmouseenter="enter('773323050474809935');" onmouseout="out('773323050474809935');" style=""> 338             for (OrderItemPriceDetail detail : item.getOrderItemPriceDetails()) {                        </span>
<span class="-2721944390925153219" onmouseenter="enter('-2721944390925153219');" onmouseout="out('-2721944390925153219');" style=""> 339                 itemAdjustmentCount += detail.getOrderItemPriceDetailAdjustments().size();               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341         }                                                                                                </span>
<span  style=""> 342                                                                                                          </span>
<span class="-5059339364425280634" onmouseenter="enter('-5059339364425280634');" onmouseout="out('-5059339364425280634');" style=""> 343         //Confirm that the order item offers are removed                                                 </span>
<span class="8413015744603539595" onmouseenter="enter('8413015744603539595');" onmouseout="out('8413015744603539595');" style=""> 344         assertTrue(itemAdjustmentCount == 0);                                                            </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 345         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346     }                                                                                                    </span>
<span  style=""> 347                                                                                                          </span>
<span class="5292901739910789200" onmouseenter="enter('5292901739910789200');" onmouseout="out('5292901739910789200');" style=""> 348     public void testApplyAllFulfillmentGroupOffers() {                                                   </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 349         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 349         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 350         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 350         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 351         replay();                                                                                        </span>
<span  style=""> 352                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 353         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 354                                                                                                          </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 355         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 355         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 356         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 356         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 357         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 358                                                                                                          </span>
<span class="-8566543852517619753" onmouseenter="enter('-8566543852517619753');" onmouseout="out('-8566543852517619753');" style=""> 359         boolean offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);       </span>
<span  style=""> 360                                                                                                          </span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 361         assertTrue(offerApplied);                                                                        </span>
<span  style=""> 362                                                                                                          </span>
<span class="485587340594496069" onmouseenter="enter('485587340594496069');" onmouseout="out('485587340594496069');" style=""> 363         order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                         </span>
<span  style=""> 364                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 365         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-2396210347480358039" onmouseenter="enter('-2396210347480358039');" onmouseout="out('-2396210347480358039');" style=""><abbr title=" 366         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 366         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 367         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 367         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 368         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 369         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="1761556730467108563" onmouseenter="enter('1761556730467108563');" onmouseout="out('1761556730467108563');" style=""> 370         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(1));             </span>
<span  style=""> 371                                                                                                          </span>
<span class="2518449647151254078" onmouseenter="enter('2518449647151254078');" onmouseout="out('2518449647151254078');" style=""> 372         offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);               </span>
<span  style=""> 373                                                                                                          </span>
<span class="8343302181900945855" onmouseenter="enter('8343302181900945855');" onmouseout="out('8343302181900945855');" style=""><abbr title=" 374         //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfillment groups"> 374         //the first offer applies to both fulfillment groups, but the second offer only applies to one ofðŸ”µ</abbr></span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 375         assertTrue(offerApplied);                                                                        </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 376         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1134830134613695083" onmouseenter="enter('-1134830134613695083');" onmouseout="out('-1134830134613695083');" style=""> 377         for (PromotableFulfillmentGroup fg : order.getFulfillmentGroups()) {                             </span>
<span class="5611483739197685885" onmouseenter="enter('5611483739197685885');" onmouseout="out('5611483739197685885');" style=""> 378             fgAdjustmentCount += fg.getCandidateFulfillmentGroupAdjustments().size();                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379         }                                                                                                </span>
<span class="6786894656890298013" onmouseenter="enter('6786894656890298013');" onmouseout="out('6786894656890298013');" style=""> 380         assertTrue(fgAdjustmentCount == 3);                                                              </span>
<span  style=""> 381                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 382         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383     }                                                                                                    </span>
<span  style=""> 384                                                                                                          </span>
<span class="-6111721081814302723" onmouseenter="enter('-6111721081814302723');" onmouseout="out('-6111721081814302723');" style=""> 385     public void testFilterFulfillmentGroupLevelOffer() {                                                 </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 386         replay();                                                                                        </span>
<span  style=""> 387                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 388         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 389                                                                                                          </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 390         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 390         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 391         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 391         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 392         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 393                                                                                                          </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 394         //test that the valid fg offer is included                                                       </span>
<span class="-68824863773413969" onmouseenter="enter('-68824863773413969');" onmouseout="out('-68824863773413969');" style=""> 395         //No item criteria, so each fulfillment group applies                                            </span>
<span class="8944166164976093148" onmouseenter="enter('8944166164976093148');" onmouseout="out('8944166164976093148');" style=""><abbr title=" 396         assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 396         assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0))ðŸ”µ</abbr></span>
<span  style=""> 397                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 398         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-794484836397434919" onmouseenter="enter('-794484836397434919');" onmouseout="out('-794484836397434919');" style=""><abbr title=" 399         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 399         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 400         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 401                                                                                                          </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 402         //test that the valid fg offer is included                                                       </span>
<span class="-5258373286153459716" onmouseenter="enter('-5258373286153459716');" onmouseout="out('-5258373286153459716');" style=""> 403         //only 1 fulfillment group has qualifying items                                                  </span>
<span class="-786785952090327245" onmouseenter="enter('-786785952090327245');" onmouseout="out('-786785952090327245');" style=""><abbr title=" 404         assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 404         assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0))ðŸ”µ</abbr></span>
<span  style=""> 405                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 406         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1175553281482923867" onmouseenter="enter('-1175553281482923867');" onmouseout="out('-1175553281482923867');" style=""><abbr title=" 407         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 407         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 408         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 409                                                                                                          </span>
<span class="8365537088151996583" onmouseenter="enter('8365537088151996583');" onmouseout="out('8365537088151996583');" style=""> 410         //test that the invalid fg offer is excluded - zipcode is wrong                                  </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 411         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span  style=""> 412                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 413         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1725928204111497608" onmouseenter="enter('-1725928204111497608');" onmouseout="out('-1725928204111497608');" style=""><abbr title=" 414         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 414         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 415         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 416                                                                                                          </span>
<span class="-6532959924497274331" onmouseenter="enter('-6532959924497274331');" onmouseout="out('-6532959924497274331');" style=""> 417         //test that the invalid fg offer is excluded - no qualifying items                               </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 418         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span  style=""> 419                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 420         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421     }                                                                                                    </span>
<span  style=""> 422                                                                                                          </span>
<span class="-4776997419015764151" onmouseenter="enter('-4776997419015764151');" onmouseout="out('-4776997419015764151');" style=""> 423     public void testCouldOfferApplyToFulfillmentGroup() {                                                </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 424         replay();                                                                                        </span>
<span  style=""> 425                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 426         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 427         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 427         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="6925194278348061796" onmouseenter="enter('6925194278348061796');" onmouseout="out('6925194278348061796');" style=""><abbr title=" 428         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 428         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfilðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 429         //test that the valid fg offer is included                                                       </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 430         assertTrue(couldApply);                                                                          </span>
<span  style=""> 431                                                                                                          </span>
<span class="-3097227128962316937" onmouseenter="enter('-3097227128962316937');" onmouseout="out('-3097227128962316937');" style=""><abbr title=" 432         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF);"> 432         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="-1233560991880639261" onmouseenter="enter('-1233560991880639261');" onmouseout="out('-1233560991880639261');" style=""><abbr title=" 433         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 433         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 434         //test that the invalid fg offer is excluded                                                     </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 435         assertFalse(couldApply);                                                                         </span>
<span  style=""> 436                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 437         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438     }                                                                                                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="3929316778716445185" onmouseenter="enter('3929316778716445185');" onmouseout="out('3929316778716445185');" style=""> 440     public void testCouldOrderItemMeetOfferRequirement() {                                               </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 441         replay();                                                                                        </span>
<span  style=""> 442                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 443         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 444         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 444         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="1501673451570831850" onmouseenter="enter('1501673451570831850');" onmouseout="out('1501673451570831850');" style=""><abbr title=" 445         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();"> 445         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next(ðŸ”µ</abbr></span>
<span class="7919750782802558587" onmouseenter="enter('7919750782802558587');" onmouseout="out('7919750782802558587');" style=""><abbr title=" 446         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 446         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), ðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 447         //test that the valid fg offer is included                                                       </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 448         assertTrue(couldApply);                                                                          </span>
<span  style=""> 449                                                                                                          </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 450         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 450         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="2238137642305281390" onmouseenter="enter('2238137642305281390');" onmouseout="out('2238137642305281390');" style=""> 451         xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();                          </span>
<span class="-3043998037798990151" onmouseenter="enter('-3043998037798990151');" onmouseout="out('-3043998037798990151');" style=""><abbr title=" 452         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 452         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.geðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 453         //test that the invalid fg offer is excluded                                                     </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 454         assertFalse(couldApply);                                                                         </span>
<span  style=""> 455                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 456         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457     }                                                                                                    </span>
<span  style=""> 458                                                                                                          </span>
<span class="-4499124276559625962" onmouseenter="enter('-4499124276559625962');" onmouseout="out('-4499124276559625962');" style=""> 459     public void testCouldOfferApplyToOrderItems() {                                                      </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 460         replay();                                                                                        </span>
<span  style=""> 461                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 462         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 463                                                                                                          </span>
<span class="-4222545078163101091" onmouseenter="enter('-4222545078163101091');" onmouseout="out('-4222545078163101091');" style=""> 464         List&lt;PromotableOrderItem&gt; orderItems = new ArrayList&lt;PromotableOrderItem&gt;();                     </span>
<span class="-7372483979901719352" onmouseenter="enter('-7372483979901719352');" onmouseout="out('-7372483979901719352');" style=""> 465         for (PromotableOrderItem orderItem : order.getDiscountableOrderItems()) {                        </span>
<span class="5423314879443576267" onmouseenter="enter('5423314879443576267');" onmouseout="out('5423314879443576267');" style=""> 466             orderItems.add(orderItem);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467         }                                                                                                </span>
<span  style=""> 468                                                                                                          </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 469         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 469         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="8410448623592275924" onmouseenter="enter('8410448623592275924');" onmouseout="out('8410448623592275924');" style=""><abbr title=" 470         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);"> 470         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 471         //test that the valid fg offer is included                                                       </span>
<span class="4437229577970519009" onmouseenter="enter('4437229577970519009');" onmouseout="out('4437229577970519009');" style=""><abbr title=" 472         assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);"> 472         assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1)ðŸ”µ</abbr></span>
<span  style=""> 473                                                                                                          </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 474         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 474         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="-3576845332244688046" onmouseenter="enter('-3576845332244688046');" onmouseout="out('-3576845332244688046');" style=""> 475         candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);                 </span>
<span class="6941245118706647267" onmouseenter="enter('6941245118706647267');" onmouseout="out('6941245118706647267');" style=""> 476         //test that the invalid fg offer is excluded because there are no qualifying items               </span>
<span class="-265242688274418245" onmouseenter="enter('-265242688274418245');" onmouseout="out('-265242688274418245');" style=""><abbr title=" 477         assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);"> 477         assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1ðŸ”µ</abbr></span>
<span  style=""> 478                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 479         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="5648347102432971432" onmouseenter="enter('5648347102432971432');" onmouseout="out('5648347102432971432');" style=""><abbr title=" 482     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; {"> 482     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; ðŸ”µ</abbr></span>
<span  style=""> 483                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 484         @Override                                                                                        </span>
<span class="-3723008217761904240" onmouseenter="enter('-3723008217761904240');" onmouseout="out('-3723008217761904240');" style=""> 485         public CandidateFulfillmentGroupOffer answer() throws Throwable {                                </span>
<span class="-8755543066605634487" onmouseenter="enter('-8755543066605634487');" onmouseout="out('-8755543066605634487');" style=""> 486             return new CandidateFulfillmentGroupOfferImpl();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487         }                                                                                                </span>
<span  style=""> 488                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489     }                                                                                                    </span>
<span  style=""> 490                                                                                                          </span>
<span class="3886526384953801028" onmouseenter="enter('3886526384953801028');" onmouseout="out('3886526384953801028');" style=""> 491     public class FulfillmentGroupAdjustmentAnswer implements IAnswer&lt;FulfillmentGroupAdjustment&gt; {       </span>
<span  style=""> 492                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 493         @Override                                                                                        </span>
<span class="2396386951594711402" onmouseenter="enter('2396386951594711402');" onmouseout="out('2396386951594711402');" style=""> 494         public FulfillmentGroupAdjustment answer() throws Throwable {                                    </span>
<span class="4220759534941126036" onmouseenter="enter('4220759534941126036');" onmouseout="out('4220759534941126036');" style=""> 495             return new FulfillmentGroupAdjustmentImpl();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496         }                                                                                                </span>
<span  style=""> 497                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498     }                                                                                                    </span>
<span  style=""> 499                                                                                                          </span>
<span class="1687502207616012454" onmouseenter="enter('1687502207616012454');" onmouseout="out('1687502207616012454');" style=""> 500     public class CandidateItemOfferAnswer implements IAnswer&lt;CandidateItemOffer&gt; {                       </span>
<span  style=""> 501                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 502         @Override                                                                                        </span>
<span class="2347184973793483651" onmouseenter="enter('2347184973793483651');" onmouseout="out('2347184973793483651');" style=""> 503         public CandidateItemOffer answer() throws Throwable {                                            </span>
<span class="7644422100596500085" onmouseenter="enter('7644422100596500085');" onmouseout="out('7644422100596500085');" style=""> 504             return new CandidateItemOfferImpl();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505         }                                                                                                </span>
<span  style=""> 506                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507     }                                                                                                    </span>
<span  style=""> 508                                                                                                          </span>
<span class="6834818405609520876" onmouseenter="enter('6834818405609520876');" onmouseout="out('6834818405609520876');" style=""> 509     public class OrderItemAdjustmentAnswer implements IAnswer&lt;OrderItemAdjustment&gt; {                     </span>
<span  style=""> 510                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 511         @Override                                                                                        </span>
<span class="4861248105020273136" onmouseenter="enter('4861248105020273136');" onmouseout="out('4861248105020273136');" style=""> 512         public OrderItemAdjustment answer() throws Throwable {                                           </span>
<span class="7697130786892874769" onmouseenter="enter('7697130786892874769');" onmouseout="out('7697130786892874769');" style=""> 513             return new OrderItemAdjustmentImpl();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514         }                                                                                                </span>
<span  style=""> 515                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-5062573030309236877" onmouseenter="enter('-5062573030309236877');" onmouseout="out('-5062573030309236877');" style="">   3  * BroadleafCommerce Framework                                                                           </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4156106492343801428" onmouseenter="enter('-4156106492343801428');" onmouseout="out('-4156106492343801428');" style="">  18 package org.broadleafcommerce.core.offer.service.processor;                                              </span>
<span  style="">  19                                                                                                          </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  20 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="">  21 import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                            </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="">  22 import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                </span>
<span class="-2793633202507663758" onmouseenter="enter('-2793633202507663758');" onmouseout="out('-2793633202507663758');" style="">  23 import org.broadleafcommerce.core.offer.dao.OfferDao;                                                    </span>
<span class="796126113999839594" onmouseenter="enter('796126113999839594');" onmouseout="out('796126113999839594');" style="">  24 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;                           </span>
<span class="2150723484434835298" onmouseenter="enter('2150723484434835298');" onmouseout="out('2150723484434835298');" style="">  25 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;                       </span>
<span class="4011152823911960428" onmouseenter="enter('4011152823911960428');" onmouseout="out('4011152823911960428');" style="">  26 import org.broadleafcommerce.core.offer.domain.CandidateItemOffer;                                       </span>
<span class="-735428748329738672" onmouseenter="enter('-735428748329738672');" onmouseout="out('-735428748329738672');" style="">  27 import org.broadleafcommerce.core.offer.domain.CandidateItemOfferImpl;                                   </span>
<span class="5599608658353832247" onmouseenter="enter('5599608658353832247');" onmouseout="out('5599608658353832247');" style="">  28 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;                               </span>
<span class="6308539507696801789" onmouseenter="enter('6308539507696801789');" onmouseout="out('6308539507696801789');" style="">  29 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;                           </span>
<span class="4081153142019712377" onmouseenter="enter('4081153142019712377');" onmouseout="out('4081153142019712377');" style="">  30 import org.broadleafcommerce.core.offer.domain.Offer;                                                    </span>
<span class="-7025591891527881733" onmouseenter="enter('-7025591891527881733');" onmouseout="out('-7025591891527881733');" style="">  31 import org.broadleafcommerce.core.offer.domain.OfferImpl;                                                </span>
<span class="1133170227846016200" onmouseenter="enter('1133170227846016200');" onmouseout="out('1133170227846016200');" style="">  32 import org.broadleafcommerce.core.offer.domain.OfferQualifyingCriteriaXref;                              </span>
<span class="-1124625745990626401" onmouseenter="enter('-1124625745990626401');" onmouseout="out('-1124625745990626401');" style="">  33 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustment;                                      </span>
<span class="-6005336697873394325" onmouseenter="enter('-6005336697873394325');" onmouseout="out('-6005336697873394325');" style="">  34 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustmentImpl;                                  </span>
<span class="1848619708404770384" onmouseenter="enter('1848619708404770384');" onmouseout="out('1848619708404770384');" style="">  35 import org.broadleafcommerce.core.offer.service.OfferDataItemProvider;                                   </span>
<span class="-6326345691456347408" onmouseenter="enter('-6326345691456347408');" onmouseout="out('-6326345691456347408');" style="">  36 import org.broadleafcommerce.core.offer.service.OfferServiceImpl;                                        </span>
<span class="2599349157106653381" onmouseenter="enter('2599349157106653381');" onmouseout="out('2599349157106653381');" style="">  37 import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;                                   </span>
<span class="-3097197529305387536" onmouseenter="enter('-3097197529305387536');" onmouseout="out('-3097197529305387536');" style="">  38 import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;                               </span>
<span class="212527052176527689" onmouseenter="enter('212527052176527689');" onmouseout="out('212527052176527689');" style="">  39 import org.broadleafcommerce.core.offer.service.discount.CandidatePromotionItems;                        </span>
<span class="4287099423657810905" onmouseenter="enter('4287099423657810905');" onmouseout="out('4287099423657810905');" style="">  40 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateFulfillmentGroupOffer;</span>
<span class="4826353322748911550" onmouseenter="enter('4826353322748911550');" onmouseout="out('4826353322748911550');" style="">  41 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableFulfillmentGroup;              </span>
<span class="-7261038068657094491" onmouseenter="enter('-7261038068657094491');" onmouseout="out('-7261038068657094491');" style="">  42 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableItemFactoryImpl;               </span>
<span class="5738750158392070" onmouseenter="enter('5738750158392070');" onmouseout="out('5738750158392070');" style="">  43 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;                  </span>
<span class="8873929720094471664" onmouseenter="enter('8873929720094471664');" onmouseout="out('8873929720094471664');" style="">  44 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;              </span>
<span class="-6456406933954769040" onmouseenter="enter('-6456406933954769040');" onmouseout="out('-6456406933954769040');" style="">  45 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrder;                         </span>
<span class="-7733804833771661823" onmouseenter="enter('-7733804833771661823');" onmouseout="out('-7733804833771661823');" style="">  46 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItem;                     </span>
<span class="-5253725521220244448" onmouseenter="enter('-5253725521220244448');" onmouseout="out('-5253725521220244448');" style="">  47 import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;                                  </span>
<span class="-4951365057913084569" onmouseenter="enter('-4951365057913084569');" onmouseout="out('-4951365057913084569');" style="">  48 import org.broadleafcommerce.core.order.dao.FulfillmentGroupItemDao;                                     </span>
<span class="-7012758821456487335" onmouseenter="enter('-7012758821456487335');" onmouseout="out('-7012758821456487335');" style="">  49 import org.broadleafcommerce.core.order.dao.OrderItemDao;                                                </span>
<span class="-6302349778747925467" onmouseenter="enter('-6302349778747925467');" onmouseout="out('-6302349778747925467');" style="">  50 import org.broadleafcommerce.core.order.domain.FulfillmentGroup;                                         </span>
<span class="-7855842771160128779" onmouseenter="enter('-7855842771160128779');" onmouseout="out('-7855842771160128779');" style="">  51 import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;                                     </span>
<span class="-6039448701992847179" onmouseenter="enter('-6039448701992847179');" onmouseout="out('-6039448701992847179');" style="">  52 import org.broadleafcommerce.core.order.domain.Order;                                                    </span>
<span class="-3117062451881073195" onmouseenter="enter('-3117062451881073195');" onmouseout="out('-3117062451881073195');" style="">  53 import org.broadleafcommerce.core.order.domain.OrderItem;                                                </span>
<span class="230297408131782266" onmouseenter="enter('230297408131782266');" onmouseout="out('230297408131782266');" style="">  54 import org.broadleafcommerce.core.order.domain.OrderItemPriceDetail;                                     </span>
<span class="1218446574017128210" onmouseenter="enter('1218446574017128210');" onmouseout="out('1218446574017128210');" style="">  55 import org.broadleafcommerce.core.order.domain.OrderMultishipOption;                                     </span>
<span class="5244138541064665880" onmouseenter="enter('5244138541064665880');" onmouseout="out('5244138541064665880');" style="">  56 import org.broadleafcommerce.core.order.domain.OrderMultishipOptionImpl;                                 </span>
<span class="9050710118625717230" onmouseenter="enter('9050710118625717230');" onmouseout="out('9050710118625717230');" style="">  57 import org.broadleafcommerce.core.order.service.FulfillmentGroupService;                                 </span>
<span class="2043331085843421951" onmouseenter="enter('2043331085843421951');" onmouseout="out('2043331085843421951');" style="">  58 import org.broadleafcommerce.core.order.service.OrderItemService;                                        </span>
<span class="-4438462058374014857" onmouseenter="enter('-4438462058374014857');" onmouseout="out('-4438462058374014857');" style="">  59 import org.broadleafcommerce.core.order.service.OrderMultishipOptionService;                             </span>
<span class="-4523094285760083742" onmouseenter="enter('-4523094285760083742');" onmouseout="out('-4523094285760083742');" style="">  60 import org.broadleafcommerce.core.order.service.OrderService;                                            </span>
<span class="426062199469058864" onmouseenter="enter('426062199469058864');" onmouseout="out('426062199469058864');" style="">  61 import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;                        </span>
<span class="1499051134121889616" onmouseenter="enter('1499051134121889616');" onmouseout="out('1499051134121889616');" style="">  62 import org.broadleafcommerce.profile.core.domain.Address;                                                </span>
<span class="8043089028015557901" onmouseenter="enter('8043089028015557901');" onmouseout="out('8043089028015557901');" style="">  63 import org.easymock.EasyMock;                                                                            </span>
<span class="8773851019359685182" onmouseenter="enter('8773851019359685182');" onmouseout="out('8773851019359685182');" style="">  64 import org.easymock.IAnswer;                                                                             </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  65 import java.math.BigDecimal;                                                                             </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  66 import java.util.ArrayList;                                                                              </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  67 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  68 import java.util.List;                                                                                   </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  69 import java.util.TimeZone;                                                                               </span>
<span  style="">  70                                                                                                          </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="">  71 import junit.framework.TestCase;                                                                         </span>
<span  style="">  72                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  74  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  75  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  77  */                                                                                                      </span>
<span class="-6422014710110996402" onmouseenter="enter('-6422014710110996402');" onmouseout="out('-6422014710110996402');" style="">  78 public class FulfillmentGroupOfferProcessorTest extends TestCase {                                       </span>
<span  style="">  79                                                                                                          </span>
<span class="2764411618740579830" onmouseenter="enter('2764411618740579830');" onmouseout="out('2764411618740579830');" style="">  80     protected OfferDao offerDaoMock;                                                                     </span>
<span class="-1028825014202044443" onmouseenter="enter('-1028825014202044443');" onmouseout="out('-1028825014202044443');" style="">  81     protected OrderItemDao orderItemDaoMock;                                                             </span>
<span class="3942591246150891792" onmouseenter="enter('3942591246150891792');" onmouseout="out('3942591246150891792');" style="">  82     protected OfferServiceImpl offerService;                                                             </span>
<span class="2155154311276627388" onmouseenter="enter('2155154311276627388');" onmouseout="out('2155154311276627388');" style="">  83     protected final OfferDataItemProvider dataProvider = new OfferDataItemProvider();                    </span>
<span class="-5369679977326057444" onmouseenter="enter('-5369679977326057444');" onmouseout="out('-5369679977326057444');" style="">  84     protected OrderService orderServiceMock;                                                             </span>
<span class="-2082308031004269425" onmouseenter="enter('-2082308031004269425');" onmouseout="out('-2082308031004269425');" style="">  85     protected OrderItemService orderItemServiceMock;                                                     </span>
<span class="8143262996519322151" onmouseenter="enter('8143262996519322151');" onmouseout="out('8143262996519322151');" style="">  86     protected FulfillmentGroupItemDao fgItemDaoMock;                                                     </span>
<span class="3331618624366763309" onmouseenter="enter('3331618624366763309');" onmouseout="out('3331618624366763309');" style="">  87     protected FulfillmentGroupService fgServiceMock;                                                     </span>
<span class="2038085072144601851" onmouseenter="enter('2038085072144601851');" onmouseout="out('2038085072144601851');" style="">  88     protected OrderMultishipOptionService multishipOptionServiceMock;                                    </span>
<span class="1636757603740185885" onmouseenter="enter('1636757603740185885');" onmouseout="out('1636757603740185885');" style="">  89     protected OfferTimeZoneProcessor offerTimeZoneProcessorMock;                                         </span>
<span class="-8980537951567645236" onmouseenter="enter('-8980537951567645236');" onmouseout="out('-8980537951567645236');" style="">  90     protected OfferServiceUtilities offerServiceUtilitiesMock;                                           </span>
<span class="-363767546438432308" onmouseenter="enter('-363767546438432308');" onmouseout="out('-363767546438432308');" style="">  91     protected PromotableOfferUtility promotableOfferUtility;                                             </span>
<span class="8126767976686599164" onmouseenter="enter('8126767976686599164');" onmouseout="out('8126767976686599164');" style="">  92     protected GenericEntityService genericEntityServiceMock;                                             </span>
<span  style="">  93                                                                                                          </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style="">  94     protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                            </span>
<span  style="">  95                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96     /**                                                                                                  </span>
<span class="-1217892123140267909" onmouseenter="enter('-1217892123140267909');" onmouseout="out('-1217892123140267909');" style=""><abbr title="  97      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and">  97      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application coðŸ”µ</abbr></span>
<span class="-8822842737667556133" onmouseenter="enter('-8822842737667556133');" onmouseout="out('-8822842737667556133');" style="">  98      * system properties service since it uses BLCSystemProperty                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  99      *                                                                                                   </span>
<span class="2670632328160232809" onmouseenter="enter('2670632328160232809');" onmouseout="out('2670632328160232809');" style=""> 100      * @author Phillip Verheyden (phillipuniverse)                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 101      */                                                                                                  </span>
<span class="8403268836763647235" onmouseenter="enter('8403268836763647235');" onmouseout="out('8403268836763647235');" style=""><abbr title=" 102     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {"> 102     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorIðŸ”µ</abbr></span>
<span class="7280310143433037386" onmouseenter="enter('7280310143433037386');" onmouseout="out('7280310143433037386');" style=""> 103         public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {   </span>
<span class="386697006679121838" onmouseenter="enter('386697006679121838');" onmouseout="out('386697006679121838');" style=""> 104             super(promotableOfferUtility);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span  style=""> 106                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 107         @Override                                                                                        </span>
<span class="-5327199138035207588" onmouseenter="enter('-5327199138035207588');" onmouseout="out('-5327199138035207588');" style=""> 108         protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 109             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111     }                                                                                                    </span>
<span  style=""> 112                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 113     @Override                                                                                            </span>
<span class="2289017037938349582" onmouseenter="enter('2289017037938349582');" onmouseout="out('2289017037938349582');" style=""> 114     protected void setUp() throws Exception {                                                            </span>
<span class="-7001064742117532685" onmouseenter="enter('-7001064742117532685');" onmouseout="out('-7001064742117532685');" style=""> 115         offerService = new OfferServiceImpl();                                                           </span>
<span class="-5376116141285812671" onmouseenter="enter('-5376116141285812671');" onmouseout="out('-5376116141285812671');" style=""> 116         CustomerOfferDao customerOfferDaoMock = EasyMock.createMock(CustomerOfferDao.class);             </span>
<span class="-570975167499705701" onmouseenter="enter('-570975167499705701');" onmouseout="out('-570975167499705701');" style=""> 117         OfferCodeDao offerCodeDaoMock = EasyMock.createMock(OfferCodeDao.class);                         </span>
<span class="393627947078248392" onmouseenter="enter('393627947078248392');" onmouseout="out('393627947078248392');" style=""> 118         orderServiceMock = EasyMock.createMock(OrderService.class);                                      </span>
<span class="7274735973437056507" onmouseenter="enter('7274735973437056507');" onmouseout="out('7274735973437056507');" style=""> 119         orderItemDaoMock = EasyMock.createMock(OrderItemDao.class);                                      </span>
<span  style=""> 120                                                                                                          </span>
<span class="1993264780541814880" onmouseenter="enter('1993264780541814880');" onmouseout="out('1993264780541814880');" style=""> 121         orderItemServiceMock = EasyMock.createMock(OrderItemService.class);                              </span>
<span class="-3213369057155598174" onmouseenter="enter('-3213369057155598174');" onmouseout="out('-3213369057155598174');" style=""> 122         fgItemDaoMock = EasyMock.createMock(FulfillmentGroupItemDao.class);                              </span>
<span class="3258640190833853601" onmouseenter="enter('3258640190833853601');" onmouseout="out('3258640190833853601');" style=""> 123         offerDaoMock = EasyMock.createMock(OfferDao.class);                                              </span>
<span class="6964150545963317885" onmouseenter="enter('6964150545963317885');" onmouseout="out('6964150545963317885');" style=""> 124         fgServiceMock = EasyMock.createMock(FulfillmentGroupService.class);                              </span>
<span class="-3871783238737974896" onmouseenter="enter('-3871783238737974896');" onmouseout="out('-3871783238737974896');" style=""> 125         multishipOptionServiceMock = EasyMock.createMock(OrderMultishipOptionService.class);             </span>
<span class="616226227087806826" onmouseenter="enter('616226227087806826');" onmouseout="out('616226227087806826');" style=""> 126         offerServiceUtilitiesMock = EasyMock.createMock(OfferServiceUtilities.class);                    </span>
<span class="-3280473616402059983" onmouseenter="enter('-3280473616402059983');" onmouseout="out('-3280473616402059983');" style=""> 127         offerTimeZoneProcessorMock = EasyMock.createMock(OfferTimeZoneProcessor.class);                  </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 128 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-5708051595893590327" onmouseenter="enter('-5708051595893590327');" onmouseout="out('-5708051595893590327');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129         promotableOfferUtility = new PromotableOfferUtilityImpl();                                       </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 130 ||||||| BASE                                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 132 =======                                                                                                  </span>
<span class="-8978123556236380411" onmouseenter="enter('-8978123556236380411');" onmouseout="out('-8978123556236380411');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133         genericEntityServiceMock = EasyMock.createMock(GenericEntityService.class);                      </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 134 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 135                                                                                                          </span>
<span class="-6566235364085313060" onmouseenter="enter('-6566235364085313060');" onmouseout="out('-6566235364085313060');" style=""> 136         fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);                </span>
<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style=""> 137         fgProcessor.setOfferDao(offerDaoMock);                                                           </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style=""> 138         fgProcessor.setOrderItemDao(orderItemDaoMock);                                                   </span>
<span class="3776294526577008852" onmouseenter="enter('3776294526577008852');" onmouseout="out('3776294526577008852');" style=""> 139         fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));     </span>
<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style=""> 140         fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                 </span>
<span  style=""> 141                                                                                                          </span>
<span class="3514247750798048226" onmouseenter="enter('3514247750798048226');" onmouseout="out('3514247750798048226');" style=""><abbr title=" 142         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);"> 142         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtðŸ”µ</abbr></span>
<span class="4393308911552043332" onmouseenter="enter('4393308911552043332');" onmouseout="out('4393308911552043332');" style=""> 143         offerServiceUtilities.setOfferDao(offerDaoMock);                                                 </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 144 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7561232175961587910" onmouseenter="enter('7561232175961587910');" onmouseout="out('7561232175961587910');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 145         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));"> 145         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtiliðŸ”µ</abbr></span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 146 ||||||| BASE                                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147                                                                                                          </span>
<span class="-2065747208737510923" onmouseenter="enter('-2065747208737510923');" onmouseout="out('-2065747208737510923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148         OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 149 =======                                                                                                  </span>
<span class="8672470870156482430" onmouseenter="enter('8672470870156482430');" onmouseout="out('8672470870156482430');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());                 </span>
<span class="8346807884110674152" onmouseenter="enter('8346807884110674152');" onmouseout="out('8346807884110674152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151         offerServiceUtilities.setGenericEntityService(genericEntityServiceMock);                         </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 152 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 153                                                                                                          </span>
<span class="-7168324839350089956" onmouseenter="enter('-7168324839350089956');" onmouseout="out('-7168324839350089956');" style=""> 154         OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);    </span>
<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style=""> 155         orderProcessor.setOfferDao(offerDaoMock);                                                        </span>
<span class="5575229934633988866" onmouseenter="enter('5575229934633988866');" onmouseout="out('5575229934633988866');" style=""> 156         orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));  </span>
<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style=""> 157         orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                              </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style=""> 158         orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                            </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style=""> 159         orderProcessor.setOrderItemDao(orderItemDaoMock);                                                </span>
<span class="-8932862412317704790" onmouseenter="enter('-8932862412317704790');" onmouseout="out('-8932862412317704790');" style=""> 160         orderProcessor.setOfferServiceUtilities(offerServiceUtilities);                                  </span>
<span  style=""> 161                                                                                                          </span>
<span class="4016707405384637073" onmouseenter="enter('4016707405384637073');" onmouseout="out('4016707405384637073');" style=""> 162         ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);       </span>
<span class="-7004957386218896406" onmouseenter="enter('-7004957386218896406');" onmouseout="out('-7004957386218896406');" style=""> 163         itemProcessor.setOfferDao(offerDaoMock);                                                         </span>
<span class="-2793185480423849018" onmouseenter="enter('-2793185480423849018');" onmouseout="out('-2793185480423849018');" style=""> 164         itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));   </span>
<span class="-7985735156898326914" onmouseenter="enter('-7985735156898326914');" onmouseout="out('-7985735156898326914');" style=""> 165         itemProcessor.setOrderItemDao(orderItemDaoMock);                                                 </span>
<span class="1873271206223196651" onmouseenter="enter('1873271206223196651');" onmouseout="out('1873271206223196651');" style=""> 166         itemProcessor.setOfferServiceUtilities(offerServiceUtilities);                                   </span>
<span  style=""> 167                                                                                                          </span>
<span class="-7594314374485898167" onmouseenter="enter('-7594314374485898167');" onmouseout="out('-7594314374485898167');" style=""> 168         offerService.setCustomerOfferDao(customerOfferDaoMock);                                          </span>
<span class="483175997286853822" onmouseenter="enter('483175997286853822');" onmouseout="out('483175997286853822');" style=""> 169         offerService.setOfferCodeDao(offerCodeDaoMock);                                                  </span>
<span class="-157638129368187663" onmouseenter="enter('-157638129368187663');" onmouseout="out('-157638129368187663');" style=""> 170         offerService.setOfferDao(offerDaoMock);                                                          </span>
<span class="-2861300639666845512" onmouseenter="enter('-2861300639666845512');" onmouseout="out('-2861300639666845512');" style=""> 171         offerService.setOrderOfferProcessor(orderProcessor);                                             </span>
<span class="4668119620018038426" onmouseenter="enter('4668119620018038426');" onmouseout="out('4668119620018038426');" style=""> 172         offerService.setItemOfferProcessor(itemProcessor);                                               </span>
<span class="-4412724488869175480" onmouseenter="enter('-4412724488869175480');" onmouseout="out('-4412724488869175480');" style=""> 173         offerService.setFulfillmentGroupOfferProcessor(fgProcessor);                                     </span>
<span class="-2798583477021709202" onmouseenter="enter('-2798583477021709202');" onmouseout="out('-2798583477021709202');" style=""> 174         offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));    </span>
<span class="-7013122243510448528" onmouseenter="enter('-7013122243510448528');" onmouseout="out('-7013122243510448528');" style=""> 175         offerService.setOrderService(orderServiceMock);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176     }                                                                                                    </span>
<span  style=""> 177                                                                                                          </span>
<span class="3027682741895790020" onmouseenter="enter('3027682741895790020');" onmouseout="out('3027682741895790020');" style=""> 178     public void replay() {                                                                               </span>
<span class="4039967104390893601" onmouseenter="enter('4039967104390893601');" onmouseout="out('4039967104390893601');" style=""> 179         EasyMock.replay(offerDaoMock);                                                                   </span>
<span class="-8438798452743116996" onmouseenter="enter('-8438798452743116996');" onmouseout="out('-8438798452743116996');" style=""> 180         EasyMock.replay(orderItemDaoMock);                                                               </span>
<span class="-306516478140011318" onmouseenter="enter('-306516478140011318');" onmouseout="out('-306516478140011318');" style=""> 181         EasyMock.replay(orderServiceMock);                                                               </span>
<span class="-1764805494951210013" onmouseenter="enter('-1764805494951210013');" onmouseout="out('-1764805494951210013');" style=""> 182         EasyMock.replay(orderItemServiceMock);                                                           </span>
<span class="1127149787736159594" onmouseenter="enter('1127149787736159594');" onmouseout="out('1127149787736159594');" style=""> 183         EasyMock.replay(fgItemDaoMock);                                                                  </span>
<span class="220377317211655869" onmouseenter="enter('220377317211655869');" onmouseout="out('220377317211655869');" style=""> 184         EasyMock.replay(fgServiceMock);                                                                  </span>
<span class="7141248576860687210" onmouseenter="enter('7141248576860687210');" onmouseout="out('7141248576860687210');" style=""> 185         EasyMock.replay(multishipOptionServiceMock);                                                     </span>
<span class="1625398624145697967" onmouseenter="enter('1625398624145697967');" onmouseout="out('1625398624145697967');" style=""> 186         EasyMock.replay(offerTimeZoneProcessorMock);                                                     </span>
<span class="7441173554159837333" onmouseenter="enter('7441173554159837333');" onmouseout="out('7441173554159837333');" style=""> 187         EasyMock.replay(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188     }                                                                                                    </span>
<span  style=""> 189                                                                                                          </span>
<span class="6267001839391766981" onmouseenter="enter('6267001839391766981');" onmouseout="out('6267001839391766981');" style=""> 190     public void verify() {                                                                               </span>
<span class="6756940960390862422" onmouseenter="enter('6756940960390862422');" onmouseout="out('6756940960390862422');" style=""> 191         EasyMock.verify(offerDaoMock);                                                                   </span>
<span class="-5117344946758939057" onmouseenter="enter('-5117344946758939057');" onmouseout="out('-5117344946758939057');" style=""> 192         EasyMock.verify(orderItemDaoMock);                                                               </span>
<span class="-6538245312297088944" onmouseenter="enter('-6538245312297088944');" onmouseout="out('-6538245312297088944');" style=""> 193         EasyMock.verify(orderServiceMock);                                                               </span>
<span class="4656187310788509663" onmouseenter="enter('4656187310788509663');" onmouseout="out('4656187310788509663');" style=""> 194         EasyMock.verify(orderItemServiceMock);                                                           </span>
<span class="-3344344690958109982" onmouseenter="enter('-3344344690958109982');" onmouseout="out('-3344344690958109982');" style=""> 195         EasyMock.verify(fgItemDaoMock);                                                                  </span>
<span class="-7107457974865616724" onmouseenter="enter('-7107457974865616724');" onmouseout="out('-7107457974865616724');" style=""> 196         EasyMock.verify(fgServiceMock);                                                                  </span>
<span class="3082501288673197520" onmouseenter="enter('3082501288673197520');" onmouseout="out('3082501288673197520');" style=""> 197         EasyMock.verify(multishipOptionServiceMock);                                                     </span>
<span class="8968216054532738001" onmouseenter="enter('8968216054532738001');" onmouseout="out('8968216054532738001');" style=""> 198         EasyMock.verify(offerTimeZoneProcessorMock);                                                     </span>
<span class="1970601797097358226" onmouseenter="enter('1970601797097358226');" onmouseout="out('1970601797097358226');" style=""> 199         EasyMock.verify(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="4350196711973577847" onmouseenter="enter('4350196711973577847');" onmouseout="out('4350196711973577847');" style=""> 202     public void testApplyAllFulfillmentGroupOffersWithOrderItemOffers() throws Exception {               </span>
<span class="8446165972037001535" onmouseenter="enter('8446165972037001535');" onmouseout="out('8446165972037001535');" style=""> 203         final ThreadLocal&lt;Order&gt; myOrder = new ThreadLocal&lt;Order&gt;();                                     </span>
<span class="3688914841313020601" onmouseenter="enter('3688914841313020601');" onmouseout="out('3688914841313020601');" style=""><abbr title=" 204         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAnswer()).anyTimes();"> 204         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.geðŸ”µ</abbr></span>
<span  style=""> 205                                                                                                          </span>
<span class="244050499009988211" onmouseenter="enter('244050499009988211');" onmouseout="out('244050499009988211');" style=""><abbr title=" 206         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrderItemQualifierAnswer()).atLeastOnce();"> 206         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCðŸ”µ</abbr></span>
<span  style=""> 207                                                                                                          </span>
<span class="-4805711593793558927" onmouseenter="enter('-4805711593793558927');" onmouseout="out('-4805711593793558927');" style=""><abbr title=" 208         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getAddItemToFulfillmentGroupAnswer()).anyTimes();"> 208         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.ðŸ”µ</abbr></span>
<span class="-4648578783612235576" onmouseenter="enter('-4648578783612235576');" onmouseout="out('-4648578783612235576');" style=""><abbr title=" 209         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getRemoveItemFromOrderAnswer()).anyTimes();"> 209         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EðŸ”µ</abbr></span>
<span class="-25100646963641968" onmouseenter="enter('-25100646963641968');" onmouseout="out('-25100646963641968');" style=""><abbr title=" 210         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OfferDataItemProvider.getSaveOrderAnswer()).anyTimes();"> 210         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).anðŸ”µ</abbr></span>
<span  style=""> 211                                                                                                          </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 212         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 212         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 213         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 213         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span  style=""> 214                                                                                                          </span>
<span class="2160564019413082164" onmouseenter="enter('2160564019413082164');" onmouseout="out('2160564019413082164');" style=""> 215         EasyMock.expect(orderServiceMock.getAutomaticallyMergeLikeItems()).andReturn(true).anyTimes();   </span>
<span class="-8884522234726007395" onmouseenter="enter('-8884522234726007395');" onmouseout="out('-8884522234726007395');" style=""><abbr title=" 216         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemProvider.getSaveOrderItemAnswer()).anyTimes();"> 216         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OffeðŸ”µ</abbr></span>
<span class="-3554631046904274751" onmouseenter="enter('-3554631046904274751');" onmouseout="out('-3554631046904274751');" style=""><abbr title=" 217         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProvider.getSaveFulfillmentGroupItemAnswer()).anyTimes();"> 217         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataðŸ”µ</abbr></span>
<span  style=""> 218                                                                                                          </span>
<span class="3313434268437563429" onmouseenter="enter('3313434268437563429');" onmouseout="out('3313434268437563429');" style=""><abbr title=" 219         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAdjustmentAnswer()).anyTimes();"> 219         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProviðŸ”µ</abbr></span>
<span class="-3718636667900446110" onmouseenter="enter('-3718636667900446110');" onmouseout="out('-3718636667900446110');" style=""><abbr title=" 220         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupAdjustmentAnswer()).anyTimes();"> 220         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.ðŸ”µ</abbr></span>
<span  style=""> 221                                                                                                          </span>
<span class="-3815074675149067237" onmouseenter="enter('-3815074675149067237');" onmouseout="out('-3815074675149067237');" style=""><abbr title=" 222         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;Order&gt;() {"> 222         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;OðŸ”µ</abbr></span>
<span  style=""> 223                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 225             public Order answer() throws Throwable {                                                     </span>
<span class="-2641290802290262879" onmouseenter="enter('-2641290802290262879');" onmouseout="out('-2641290802290262879');" style=""> 226                 return myOrder.get();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 228         }).anyTimes();                                                                                   </span>
<span  style=""> 229                                                                                                          </span>
<span class="2031702441279524669" onmouseenter="enter('2031702441279524669');" onmouseout="out('2031702441279524669');" style=""><abbr title=" 230         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;List&lt;OrderMultishipOption&gt;&gt;() {"> 230         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).aðŸ”µ</abbr></span>
<span  style=""> 231                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 232             @Override                                                                                    </span>
<span class="4982536128511672004" onmouseenter="enter('4982536128511672004');" onmouseout="out('4982536128511672004');" style=""> 233             public List&lt;OrderMultishipOption&gt; answer() throws Throwable {                                </span>
<span class="3348167234255574763" onmouseenter="enter('3348167234255574763');" onmouseout="out('3348167234255574763');" style=""> 234                 List&lt;OrderMultishipOption&gt; options = new ArrayList&lt;OrderMultishipOption&gt;();              </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 235                 PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility); </span>
<span class="-6747846520377446395" onmouseenter="enter('-6747846520377446395');" onmouseout="out('-6747846520377446395');" style=""> 236                 for (FulfillmentGroup fg : order.getOrder().getFulfillmentGroups()) {                    </span>
<span class="-6367521286140114289" onmouseenter="enter('-6367521286140114289');" onmouseout="out('-6367521286140114289');" style=""> 237                     Address address = fg.getAddress();                                                   </span>
<span class="8028460309176757050" onmouseenter="enter('8028460309176757050');" onmouseout="out('8028460309176757050');" style=""> 238                     for (FulfillmentGroupItem fgItem : fg.getFulfillmentGroupItems()) {                  </span>
<span class="8402583593129976695" onmouseenter="enter('8402583593129976695');" onmouseout="out('8402583593129976695');" style=""> 239                         for (int j = 0; j &lt; fgItem.getQuantity(); j++) {                                 </span>
<span class="3921661458783293685" onmouseenter="enter('3921661458783293685');" onmouseout="out('3921661458783293685');" style=""> 240                             OrderMultishipOption option = new OrderMultishipOptionImpl();                </span>
<span class="6971594022266833915" onmouseenter="enter('6971594022266833915');" onmouseout="out('6971594022266833915');" style=""> 241                             option.setOrder(order.getOrder());                                           </span>
<span class="-7842023912465695186" onmouseenter="enter('-7842023912465695186');" onmouseout="out('-7842023912465695186');" style=""> 242                             option.setAddress(address);                                                  </span>
<span class="-8979996557527707436" onmouseenter="enter('-8979996557527707436');" onmouseout="out('-8979996557527707436');" style=""> 243                             option.setOrderItem(fgItem.getOrderItem());                                  </span>
<span class="3662213946586141634" onmouseenter="enter('3662213946586141634');" onmouseout="out('3662213946586141634');" style=""> 244                             options.add(option);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247                 }                                                                                        </span>
<span  style=""> 248                                                                                                          </span>
<span class="7754614799802233964" onmouseenter="enter('7754614799802233964');" onmouseout="out('7754614799802233964');" style=""> 249                 return options;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 251         }).anyTimes();                                                                                   </span>
<span  style=""> 252                                                                                                          </span>
<span class="5730763888734231228" onmouseenter="enter('5730763888734231228');" onmouseout="out('5730763888734231228');" style=""> 253         multishipOptionServiceMock.deleteAllOrderMultishipOptions(EasyMock.isA(Order.class));            </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 254         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="-2684793509385343472" onmouseenter="enter('-2684793509385343472');" onmouseout="out('-2684793509385343472');" style=""><abbr title=" 255         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eq(false))).andAnswer(new IAnswer&lt;Order&gt;() {"> 255         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EðŸ”µ</abbr></span>
<span  style=""> 256                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 257             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 258             public Order answer() throws Throwable {                                                     </span>
<span class="-2361682080301650618" onmouseenter="enter('-2361682080301650618');" onmouseout="out('-2361682080301650618');" style=""> 259                 Order order = (Order) EasyMock.getCurrentArguments()[0];                                 </span>
<span class="6377062998999459231" onmouseenter="enter('6377062998999459231');" onmouseout="out('6377062998999459231');" style=""><abbr title=" 260                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups().get(1).getFulfillmentGroupItems());"> 260                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmenðŸ”µ</abbr></span>
<span class="8328438890662847465" onmouseenter="enter('8328438890662847465');" onmouseout="out('8328438890662847465');" style=""> 261                 order.getFulfillmentGroups().remove(order.getFulfillmentGroups().get(1));                </span>
<span  style=""> 262                                                                                                          </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 263                 return order;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 265         }).anyTimes();                                                                                   </span>
<span class="7005207656442723333" onmouseenter="enter('7005207656442723333');" onmouseout="out('7005207656442723333');" style=""><abbr title=" 266         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnswer()).anyTimes();"> 266         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupðŸ”µ</abbr></span>
<span class="3552856255510166668" onmouseenter="enter('3552856255510166668');" onmouseout="out('3552856255510166668');" style=""> 267         fgItemDaoMock.delete(EasyMock.isA(FulfillmentGroupItem.class));                                  </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 268         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="602433099109498087" onmouseenter="enter('602433099109498087');" onmouseout="out('602433099109498087');" style=""><abbr title=" 269         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.getTimeZone(&quot;CST&quot;)).anyTimes();"> 269         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(ðŸ”µ</abbr></span>
<span  style=""> 270                                                                                                          </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 271         replay();                                                                                        </span>
<span  style=""> 272                                                                                                          </span>
<span class="5984499010113424780" onmouseenter="enter('5984499010113424780');" onmouseout="out('5984499010113424780');" style=""><abbr title=" 273         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);"> 273         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility)ðŸ”µ</abbr></span>
<span class="-396343315567854895" onmouseenter="enter('-396343315567854895');" onmouseout="out('-396343315567854895');" style=""> 274         Order order = promotableOrder.getOrder();                                                        </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 275         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 276         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 276         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 277         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 277         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 278         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 278         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 279         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span  style=""> 280                                                                                                          </span>
<span class="-374141704093766947" onmouseenter="enter('-374141704093766947');" onmouseout="out('-374141704093766947');" style=""> 281         offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(                                 </span>
<span class="-971526457565278793" onmouseenter="enter('-971526457565278793');" onmouseout="out('-971526457565278793');" style=""> 282                 &quot;order.subTotal.getAmount()&gt;20&quot;,                                                         </span>
<span class="8626574580727552658" onmouseenter="enter('8626574580727552658');" onmouseout="out('8626574580727552658');" style=""> 283                 OfferDiscountType.PERCENT_OFF,                                                           </span>
<span class="-1086407973911983614" onmouseenter="enter('-1086407973911983614');" onmouseout="out('-1086407973911983614');" style=""><abbr title=" 284                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;,"> 284                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contaiðŸ”µ</abbr></span>
<span class="-6157256577419644919" onmouseenter="enter('-6157256577419644919');" onmouseout="out('-6157256577419644919');" style=""><abbr title=" 285                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;"> 285                 &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contaiðŸ”µ</abbr></span>
<span class="3699784701886273761" onmouseenter="enter('3699784701886273761');" onmouseout="out('3699784701886273761');" style=""> 286                 ));                                                                                      </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 287         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span  style=""> 288                                                                                                          </span>
<span class="-5783701790519827054" onmouseenter="enter('-5783701790519827054');" onmouseout="out('-5783701790519827054');" style=""> 289         offers.get(0).setTotalitarianOffer(true);                                                        </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 290         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span  style=""> 291                                                                                                          </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 292         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 293         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 294             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295         }                                                                                                </span>
<span class="-6281142585732833119" onmouseenter="enter('-6281142585732833119');" onmouseout="out('-6281142585732833119');" style=""><abbr title=" 296         //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order item offers"> 296         //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than thðŸ”µ</abbr></span>
<span class="-7018201492040868931" onmouseenter="enter('-7018201492040868931');" onmouseout="out('-7018201492040868931');" style=""> 297         // - it is therefore ignored                                                                     </span>
<span class="8464783908245837933" onmouseenter="enter('8464783908245837933');" onmouseout="out('8464783908245837933');" style=""> 298         //However, the second combinable fg offer is allowed to be applied.                              </span>
<span class="1322310588171640590" onmouseenter="enter('1322310588171640590');" onmouseout="out('1322310588171640590');" style=""> 299         assertTrue(fgAdjustmentCount == 1);                                                              </span>
<span  style=""> 300                                                                                                          </span>
<span class="-1191672713468750443" onmouseenter="enter('-1191672713468750443');" onmouseout="out('-1191672713468750443');" style=""> 301         promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);               </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 302         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="4605867479195622271" onmouseenter="enter('4605867479195622271');" onmouseout="out('4605867479195622271');" style=""> 303         offers.get(2).setValue(new BigDecimal(&quot;1&quot;));                                                     </span>
<span  style=""> 304                                                                                                          </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 305         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 306         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span  style=""> 307                                                                                                          </span>
<span class="5070682841290639966" onmouseenter="enter('5070682841290639966');" onmouseout="out('5070682841290639966');" style=""> 308         fgAdjustmentCount = 0;                                                                           </span>
<span class="-1030185999544814128" onmouseenter="enter('-1030185999544814128');" onmouseout="out('-1030185999544814128');" style=""> 309         order = promotableOrder.getOrder();                                                              </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 310         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 311             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312         }                                                                                                </span>
<span  style=""> 313                                                                                                          </span>
<span class="-6528829480981189501" onmouseenter="enter('-6528829480981189501');" onmouseout="out('-6528829480981189501');" style=""><abbr title=" 314         //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fg offer is applied"> 314         //The totalitarian fg offer is now a better deal than the order item offers, therefore the totaliðŸ”µ</abbr></span>
<span class="-8173222409402387748" onmouseenter="enter('-8173222409402387748');" onmouseout="out('-8173222409402387748');" style=""> 315         //and the order item offers are removed                                                          </span>
<span class="3307702501962124755" onmouseenter="enter('3307702501962124755');" onmouseout="out('3307702501962124755');" style=""> 316         assertTrue(fgAdjustmentCount == 2);                                                              </span>
<span  style=""> 317                                                                                                          </span>
<span class="-2665219164306343886" onmouseenter="enter('-2665219164306343886');" onmouseout="out('-2665219164306343886');" style=""> 318         int itemAdjustmentCount = 0;                                                                     </span>
<span class="820796442257070700" onmouseenter="enter('820796442257070700');" onmouseout="out('820796442257070700');" style=""> 319         for (OrderItem item : order.getOrderItems()) {                                                   </span>
<span class="773323050474809935" onmouseenter="enter('773323050474809935');" onmouseout="out('773323050474809935');" style=""> 320             for (OrderItemPriceDetail detail : item.getOrderItemPriceDetails()) {                        </span>
<span class="-2721944390925153219" onmouseenter="enter('-2721944390925153219');" onmouseout="out('-2721944390925153219');" style=""> 321                 itemAdjustmentCount += detail.getOrderItemPriceDetailAdjustments().size();               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323         }                                                                                                </span>
<span  style=""> 324                                                                                                          </span>
<span class="-5059339364425280634" onmouseenter="enter('-5059339364425280634');" onmouseout="out('-5059339364425280634');" style=""> 325         //Confirm that the order item offers are removed                                                 </span>
<span class="8413015744603539595" onmouseenter="enter('8413015744603539595');" onmouseout="out('8413015744603539595');" style=""> 326         assertTrue(itemAdjustmentCount == 0);                                                            </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 327         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328     }                                                                                                    </span>
<span  style=""> 329                                                                                                          </span>
<span class="5292901739910789200" onmouseenter="enter('5292901739910789200');" onmouseout="out('5292901739910789200');" style=""> 330     public void testApplyAllFulfillmentGroupOffers() {                                                   </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 331         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 331         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 332         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 332         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 333         replay();                                                                                        </span>
<span  style=""> 334                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 335         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 336                                                                                                          </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 337         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 337         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 338         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 338         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 339         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 340                                                                                                          </span>
<span class="-8566543852517619753" onmouseenter="enter('-8566543852517619753');" onmouseout="out('-8566543852517619753');" style=""> 341         boolean offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);       </span>
<span  style=""> 342                                                                                                          </span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 343         assertTrue(offerApplied);                                                                        </span>
<span  style=""> 344                                                                                                          </span>
<span class="485587340594496069" onmouseenter="enter('485587340594496069');" onmouseout="out('485587340594496069');" style=""> 345         order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                         </span>
<span  style=""> 346                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 347         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-2396210347480358039" onmouseenter="enter('-2396210347480358039');" onmouseout="out('-2396210347480358039');" style=""><abbr title=" 348         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 348         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 349         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 349         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 350         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 351         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="1761556730467108563" onmouseenter="enter('1761556730467108563');" onmouseout="out('1761556730467108563');" style=""> 352         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(1));             </span>
<span  style=""> 353                                                                                                          </span>
<span class="2518449647151254078" onmouseenter="enter('2518449647151254078');" onmouseout="out('2518449647151254078');" style=""> 354         offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);               </span>
<span  style=""> 355                                                                                                          </span>
<span class="8343302181900945855" onmouseenter="enter('8343302181900945855');" onmouseout="out('8343302181900945855');" style=""><abbr title=" 356         //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfillment groups"> 356         //the first offer applies to both fulfillment groups, but the second offer only applies to one ofðŸ”µ</abbr></span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 357         assertTrue(offerApplied);                                                                        </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 358         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1134830134613695083" onmouseenter="enter('-1134830134613695083');" onmouseout="out('-1134830134613695083');" style=""> 359         for (PromotableFulfillmentGroup fg : order.getFulfillmentGroups()) {                             </span>
<span class="5611483739197685885" onmouseenter="enter('5611483739197685885');" onmouseout="out('5611483739197685885');" style=""> 360             fgAdjustmentCount += fg.getCandidateFulfillmentGroupAdjustments().size();                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361         }                                                                                                </span>
<span class="6786894656890298013" onmouseenter="enter('6786894656890298013');" onmouseout="out('6786894656890298013');" style=""> 362         assertTrue(fgAdjustmentCount == 3);                                                              </span>
<span  style=""> 363                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 364         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365     }                                                                                                    </span>
<span  style=""> 366                                                                                                          </span>
<span class="-6111721081814302723" onmouseenter="enter('-6111721081814302723');" onmouseout="out('-6111721081814302723');" style=""> 367     public void testFilterFulfillmentGroupLevelOffer() {                                                 </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 368         replay();                                                                                        </span>
<span  style=""> 369                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 370         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 371                                                                                                          </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 372         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 372         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 373         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 373         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 374         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 375                                                                                                          </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 376         //test that the valid fg offer is included                                                       </span>
<span class="-68824863773413969" onmouseenter="enter('-68824863773413969');" onmouseout="out('-68824863773413969');" style=""> 377         //No item criteria, so each fulfillment group applies                                            </span>
<span class="8944166164976093148" onmouseenter="enter('8944166164976093148');" onmouseout="out('8944166164976093148');" style=""><abbr title=" 378         assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 378         assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0))ðŸ”µ</abbr></span>
<span  style=""> 379                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 380         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-794484836397434919" onmouseenter="enter('-794484836397434919');" onmouseout="out('-794484836397434919');" style=""><abbr title=" 381         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 381         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 382         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 383                                                                                                          </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 384         //test that the valid fg offer is included                                                       </span>
<span class="-5258373286153459716" onmouseenter="enter('-5258373286153459716');" onmouseout="out('-5258373286153459716');" style=""> 385         //only 1 fulfillment group has qualifying items                                                  </span>
<span class="-786785952090327245" onmouseenter="enter('-786785952090327245');" onmouseout="out('-786785952090327245');" style=""><abbr title=" 386         assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 386         assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0))ðŸ”µ</abbr></span>
<span  style=""> 387                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 388         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1175553281482923867" onmouseenter="enter('-1175553281482923867');" onmouseout="out('-1175553281482923867');" style=""><abbr title=" 389         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 389         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 390         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 391                                                                                                          </span>
<span class="8365537088151996583" onmouseenter="enter('8365537088151996583');" onmouseout="out('8365537088151996583');" style=""> 392         //test that the invalid fg offer is excluded - zipcode is wrong                                  </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 393         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span  style=""> 394                                                                                                          </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 395         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1725928204111497608" onmouseenter="enter('-1725928204111497608');" onmouseout="out('-1725928204111497608');" style=""><abbr title=" 396         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 396         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 397         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span  style=""> 398                                                                                                          </span>
<span class="-6532959924497274331" onmouseenter="enter('-6532959924497274331');" onmouseout="out('-6532959924497274331');" style=""> 399         //test that the invalid fg offer is excluded - no qualifying items                               </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 400         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span  style=""> 401                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 402         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403     }                                                                                                    </span>
<span  style=""> 404                                                                                                          </span>
<span class="-4776997419015764151" onmouseenter="enter('-4776997419015764151');" onmouseout="out('-4776997419015764151');" style=""> 405     public void testCouldOfferApplyToFulfillmentGroup() {                                                </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 406         replay();                                                                                        </span>
<span  style=""> 407                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 408         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 409         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 409         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="6925194278348061796" onmouseenter="enter('6925194278348061796');" onmouseout="out('6925194278348061796');" style=""><abbr title=" 410         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 410         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfilðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 411         //test that the valid fg offer is included                                                       </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 412         assertTrue(couldApply);                                                                          </span>
<span  style=""> 413                                                                                                          </span>
<span class="-3097227128962316937" onmouseenter="enter('-3097227128962316937');" onmouseout="out('-3097227128962316937');" style=""><abbr title=" 414         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF);"> 414         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="-1233560991880639261" onmouseenter="enter('-1233560991880639261');" onmouseout="out('-1233560991880639261');" style=""><abbr title=" 415         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 415         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 416         //test that the invalid fg offer is excluded                                                     </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 417         assertFalse(couldApply);                                                                         </span>
<span  style=""> 418                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 419         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420     }                                                                                                    </span>
<span  style=""> 421                                                                                                          </span>
<span class="3929316778716445185" onmouseenter="enter('3929316778716445185');" onmouseout="out('3929316778716445185');" style=""> 422     public void testCouldOrderItemMeetOfferRequirement() {                                               </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 423         replay();                                                                                        </span>
<span  style=""> 424                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 425         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 426         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 426         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="1501673451570831850" onmouseenter="enter('1501673451570831850');" onmouseout="out('1501673451570831850');" style=""><abbr title=" 427         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();"> 427         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next(ðŸ”µ</abbr></span>
<span class="7919750782802558587" onmouseenter="enter('7919750782802558587');" onmouseout="out('7919750782802558587');" style=""><abbr title=" 428         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 428         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), ðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 429         //test that the valid fg offer is included                                                       </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 430         assertTrue(couldApply);                                                                          </span>
<span  style=""> 431                                                                                                          </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 432         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 432         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="2238137642305281390" onmouseenter="enter('2238137642305281390');" onmouseout="out('2238137642305281390');" style=""> 433         xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();                          </span>
<span class="-3043998037798990151" onmouseenter="enter('-3043998037798990151');" onmouseout="out('-3043998037798990151');" style=""><abbr title=" 434         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 434         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.geðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 435         //test that the invalid fg offer is excluded                                                     </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 436         assertFalse(couldApply);                                                                         </span>
<span  style=""> 437                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 438         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439     }                                                                                                    </span>
<span  style=""> 440                                                                                                          </span>
<span class="-4499124276559625962" onmouseenter="enter('-4499124276559625962');" onmouseout="out('-4499124276559625962');" style=""> 441     public void testCouldOfferApplyToOrderItems() {                                                      </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 442         replay();                                                                                        </span>
<span  style=""> 443                                                                                                          </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 444         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span  style=""> 445                                                                                                          </span>
<span class="-4222545078163101091" onmouseenter="enter('-4222545078163101091');" onmouseout="out('-4222545078163101091');" style=""> 446         List&lt;PromotableOrderItem&gt; orderItems = new ArrayList&lt;PromotableOrderItem&gt;();                     </span>
<span class="-7372483979901719352" onmouseenter="enter('-7372483979901719352');" onmouseout="out('-7372483979901719352');" style=""> 447         for (PromotableOrderItem orderItem : order.getDiscountableOrderItems()) {                        </span>
<span class="5423314879443576267" onmouseenter="enter('5423314879443576267');" onmouseout="out('5423314879443576267');" style=""> 448             orderItems.add(orderItem);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 449         }                                                                                                </span>
<span  style=""> 450                                                                                                          </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 451         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 451         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="8410448623592275924" onmouseenter="enter('8410448623592275924');" onmouseout="out('8410448623592275924');" style=""><abbr title=" 452         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);"> 452         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 453         //test that the valid fg offer is included                                                       </span>
<span class="4437229577970519009" onmouseenter="enter('4437229577970519009');" onmouseout="out('4437229577970519009');" style=""><abbr title=" 454         assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);"> 454         assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1)ðŸ”µ</abbr></span>
<span  style=""> 455                                                                                                          </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 456         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 456         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="-3576845332244688046" onmouseenter="enter('-3576845332244688046');" onmouseout="out('-3576845332244688046');" style=""> 457         candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);                 </span>
<span class="6941245118706647267" onmouseenter="enter('6941245118706647267');" onmouseout="out('6941245118706647267');" style=""> 458         //test that the invalid fg offer is excluded because there are no qualifying items               </span>
<span class="-265242688274418245" onmouseenter="enter('-265242688274418245');" onmouseout="out('-265242688274418245');" style=""><abbr title=" 459         assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);"> 459         assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1ðŸ”µ</abbr></span>
<span  style=""> 460                                                                                                          </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 461         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462     }                                                                                                    </span>
<span  style=""> 463                                                                                                          </span>
<span class="5648347102432971432" onmouseenter="enter('5648347102432971432');" onmouseout="out('5648347102432971432');" style=""><abbr title=" 464     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; {"> 464     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; ðŸ”µ</abbr></span>
<span  style=""> 465                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 466         @Override                                                                                        </span>
<span class="-3723008217761904240" onmouseenter="enter('-3723008217761904240');" onmouseout="out('-3723008217761904240');" style=""> 467         public CandidateFulfillmentGroupOffer answer() throws Throwable {                                </span>
<span class="-8755543066605634487" onmouseenter="enter('-8755543066605634487');" onmouseout="out('-8755543066605634487');" style=""> 468             return new CandidateFulfillmentGroupOfferImpl();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469         }                                                                                                </span>
<span  style=""> 470                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 471     }                                                                                                    </span>
<span  style=""> 472                                                                                                          </span>
<span class="3886526384953801028" onmouseenter="enter('3886526384953801028');" onmouseout="out('3886526384953801028');" style=""> 473     public class FulfillmentGroupAdjustmentAnswer implements IAnswer&lt;FulfillmentGroupAdjustment&gt; {       </span>
<span  style=""> 474                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 475         @Override                                                                                        </span>
<span class="2396386951594711402" onmouseenter="enter('2396386951594711402');" onmouseout="out('2396386951594711402');" style=""> 476         public FulfillmentGroupAdjustment answer() throws Throwable {                                    </span>
<span class="4220759534941126036" onmouseenter="enter('4220759534941126036');" onmouseout="out('4220759534941126036');" style=""> 477             return new FulfillmentGroupAdjustmentImpl();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478         }                                                                                                </span>
<span  style=""> 479                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="1687502207616012454" onmouseenter="enter('1687502207616012454');" onmouseout="out('1687502207616012454');" style=""> 482     public class CandidateItemOfferAnswer implements IAnswer&lt;CandidateItemOffer&gt; {                       </span>
<span  style=""> 483                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 484         @Override                                                                                        </span>
<span class="2347184973793483651" onmouseenter="enter('2347184973793483651');" onmouseout="out('2347184973793483651');" style=""> 485         public CandidateItemOffer answer() throws Throwable {                                            </span>
<span class="7644422100596500085" onmouseenter="enter('7644422100596500085');" onmouseout="out('7644422100596500085');" style=""> 486             return new CandidateItemOfferImpl();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487         }                                                                                                </span>
<span  style=""> 488                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489     }                                                                                                    </span>
<span  style=""> 490                                                                                                          </span>
<span class="6834818405609520876" onmouseenter="enter('6834818405609520876');" onmouseout="out('6834818405609520876');" style=""> 491     public class OrderItemAdjustmentAnswer implements IAnswer&lt;OrderItemAdjustment&gt; {                     </span>
<span  style=""> 492                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 493         @Override                                                                                        </span>
<span class="4861248105020273136" onmouseenter="enter('4861248105020273136');" onmouseout="out('4861248105020273136');" style=""> 494         public OrderItemAdjustment answer() throws Throwable {                                           </span>
<span class="7697130786892874769" onmouseenter="enter('7697130786892874769');" onmouseout="out('7697130786892874769');" style=""> 495             return new OrderItemAdjustmentImpl();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496         }                                                                                                </span>
<span  style=""> 497                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499 }                                                                                                        </span>
















</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-5062573030309236877" onmouseenter="enter('-5062573030309236877');" onmouseout="out('-5062573030309236877');" style="">   3  * BroadleafCommerce Framework                                                                           </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4156106492343801428" onmouseenter="enter('-4156106492343801428');" onmouseout="out('-4156106492343801428');" style="">  18 package org.broadleafcommerce.core.offer.service.processor;                                              </span>
<span  style="">  19                                                                                                          </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  20 import java.math.BigDecimal;                                                                             </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  21 import java.util.ArrayList;                                                                              </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  22 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  23 import java.util.List;                                                                                   </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  24 import java.util.TimeZone;                                                                               </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="">  25 import junit.framework.TestCase;                                                                         </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="">  26 import org.broadleafcommerce.common.service.GenericEntityService;                                        </span>
<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="">  27 import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                            </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="">  28 import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                </span>
<span class="-2793633202507663758" onmouseenter="enter('-2793633202507663758');" onmouseout="out('-2793633202507663758');" style="">  29 import org.broadleafcommerce.core.offer.dao.OfferDao;                                                    </span>
<span class="796126113999839594" onmouseenter="enter('796126113999839594');" onmouseout="out('796126113999839594');" style="">  30 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;                           </span>
<span class="2150723484434835298" onmouseenter="enter('2150723484434835298');" onmouseout="out('2150723484434835298');" style="">  31 import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;                       </span>
<span class="4011152823911960428" onmouseenter="enter('4011152823911960428');" onmouseout="out('4011152823911960428');" style="">  32 import org.broadleafcommerce.core.offer.domain.CandidateItemOffer;                                       </span>
<span class="-735428748329738672" onmouseenter="enter('-735428748329738672');" onmouseout="out('-735428748329738672');" style="">  33 import org.broadleafcommerce.core.offer.domain.CandidateItemOfferImpl;                                   </span>
<span class="5599608658353832247" onmouseenter="enter('5599608658353832247');" onmouseout="out('5599608658353832247');" style="">  34 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;                               </span>
<span class="6308539507696801789" onmouseenter="enter('6308539507696801789');" onmouseout="out('6308539507696801789');" style="">  35 import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;                           </span>
<span class="4081153142019712377" onmouseenter="enter('4081153142019712377');" onmouseout="out('4081153142019712377');" style="">  36 import org.broadleafcommerce.core.offer.domain.Offer;                                                    </span>
<span class="-7025591891527881733" onmouseenter="enter('-7025591891527881733');" onmouseout="out('-7025591891527881733');" style="">  37 import org.broadleafcommerce.core.offer.domain.OfferImpl;                                                </span>
<span class="1133170227846016200" onmouseenter="enter('1133170227846016200');" onmouseout="out('1133170227846016200');" style="">  38 import org.broadleafcommerce.core.offer.domain.OfferQualifyingCriteriaXref;                              </span>
<span class="-1124625745990626401" onmouseenter="enter('-1124625745990626401');" onmouseout="out('-1124625745990626401');" style="">  39 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustment;                                      </span>
<span class="-6005336697873394325" onmouseenter="enter('-6005336697873394325');" onmouseout="out('-6005336697873394325');" style="">  40 import org.broadleafcommerce.core.offer.domain.OrderItemAdjustmentImpl;                                  </span>
<span class="1848619708404770384" onmouseenter="enter('1848619708404770384');" onmouseout="out('1848619708404770384');" style="">  41 import org.broadleafcommerce.core.offer.service.OfferDataItemProvider;                                   </span>
<span class="-6326345691456347408" onmouseenter="enter('-6326345691456347408');" onmouseout="out('-6326345691456347408');" style="">  42 import org.broadleafcommerce.core.offer.service.OfferServiceImpl;                                        </span>
<span class="2599349157106653381" onmouseenter="enter('2599349157106653381');" onmouseout="out('2599349157106653381');" style="">  43 import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;                                   </span>
<span class="-3097197529305387536" onmouseenter="enter('-3097197529305387536');" onmouseout="out('-3097197529305387536');" style="">  44 import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;                               </span>
<span class="212527052176527689" onmouseenter="enter('212527052176527689');" onmouseout="out('212527052176527689');" style="">  45 import org.broadleafcommerce.core.offer.service.discount.CandidatePromotionItems;                        </span>
<span class="4287099423657810905" onmouseenter="enter('4287099423657810905');" onmouseout="out('4287099423657810905');" style="">  46 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateFulfillmentGroupOffer;</span>
<span class="4826353322748911550" onmouseenter="enter('4826353322748911550');" onmouseout="out('4826353322748911550');" style="">  47 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableFulfillmentGroup;              </span>
<span class="-7261038068657094491" onmouseenter="enter('-7261038068657094491');" onmouseout="out('-7261038068657094491');" style="">  48 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableItemFactoryImpl;               </span>
<span class="5738750158392070" onmouseenter="enter('5738750158392070');" onmouseout="out('5738750158392070');" style="">  49 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;                  </span>
<span class="8873929720094471664" onmouseenter="enter('8873929720094471664');" onmouseout="out('8873929720094471664');" style="">  50 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;              </span>
<span class="-6456406933954769040" onmouseenter="enter('-6456406933954769040');" onmouseout="out('-6456406933954769040');" style="">  51 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrder;                         </span>
<span class="-7733804833771661823" onmouseenter="enter('-7733804833771661823');" onmouseout="out('-7733804833771661823');" style="">  52 import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItem;                     </span>
<span class="-5253725521220244448" onmouseenter="enter('-5253725521220244448');" onmouseout="out('-5253725521220244448');" style="">  53 import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;                                  </span>
<span class="-4951365057913084569" onmouseenter="enter('-4951365057913084569');" onmouseout="out('-4951365057913084569');" style="">  54 import org.broadleafcommerce.core.order.dao.FulfillmentGroupItemDao;                                     </span>
<span class="-7012758821456487335" onmouseenter="enter('-7012758821456487335');" onmouseout="out('-7012758821456487335');" style="">  55 import org.broadleafcommerce.core.order.dao.OrderItemDao;                                                </span>
<span class="-6302349778747925467" onmouseenter="enter('-6302349778747925467');" onmouseout="out('-6302349778747925467');" style="">  56 import org.broadleafcommerce.core.order.domain.FulfillmentGroup;                                         </span>
<span class="-7855842771160128779" onmouseenter="enter('-7855842771160128779');" onmouseout="out('-7855842771160128779');" style="">  57 import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;                                     </span>
<span class="-6039448701992847179" onmouseenter="enter('-6039448701992847179');" onmouseout="out('-6039448701992847179');" style="">  58 import org.broadleafcommerce.core.order.domain.Order;                                                    </span>
<span class="-3117062451881073195" onmouseenter="enter('-3117062451881073195');" onmouseout="out('-3117062451881073195');" style="">  59 import org.broadleafcommerce.core.order.domain.OrderItem;                                                </span>
<span class="230297408131782266" onmouseenter="enter('230297408131782266');" onmouseout="out('230297408131782266');" style="">  60 import org.broadleafcommerce.core.order.domain.OrderItemPriceDetail;                                     </span>
<span class="1218446574017128210" onmouseenter="enter('1218446574017128210');" onmouseout="out('1218446574017128210');" style="">  61 import org.broadleafcommerce.core.order.domain.OrderMultishipOption;                                     </span>
<span class="5244138541064665880" onmouseenter="enter('5244138541064665880');" onmouseout="out('5244138541064665880');" style="">  62 import org.broadleafcommerce.core.order.domain.OrderMultishipOptionImpl;                                 </span>
<span class="9050710118625717230" onmouseenter="enter('9050710118625717230');" onmouseout="out('9050710118625717230');" style="">  63 import org.broadleafcommerce.core.order.service.FulfillmentGroupService;                                 </span>
<span class="2043331085843421951" onmouseenter="enter('2043331085843421951');" onmouseout="out('2043331085843421951');" style="">  64 import org.broadleafcommerce.core.order.service.OrderItemService;                                        </span>
<span class="-4438462058374014857" onmouseenter="enter('-4438462058374014857');" onmouseout="out('-4438462058374014857');" style="">  65 import org.broadleafcommerce.core.order.service.OrderMultishipOptionService;                             </span>
<span class="-4523094285760083742" onmouseenter="enter('-4523094285760083742');" onmouseout="out('-4523094285760083742');" style="">  66 import org.broadleafcommerce.core.order.service.OrderService;                                            </span>
<span class="426062199469058864" onmouseenter="enter('426062199469058864');" onmouseout="out('426062199469058864');" style="">  67 import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;                        </span>
<span class="1499051134121889616" onmouseenter="enter('1499051134121889616');" onmouseout="out('1499051134121889616');" style="">  68 import org.broadleafcommerce.profile.core.domain.Address;                                                </span>
<span class="8043089028015557901" onmouseenter="enter('8043089028015557901');" onmouseout="out('8043089028015557901');" style="">  69 import org.easymock.EasyMock;                                                                            </span>
<span class="8773851019359685182" onmouseenter="enter('8773851019359685182');" onmouseout="out('8773851019359685182');" style="">  70 import org.easymock.IAnswer;                                                                             </span>
<span  style="">  71                                                                                                          </span>
<span  style="">  72                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  74  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  75  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  77  */                                                                                                      </span>
<span class="-6422014710110996402" onmouseenter="enter('-6422014710110996402');" onmouseout="out('-6422014710110996402');" style="">  78 public class FulfillmentGroupOfferProcessorTest extends TestCase {                                       </span>
<span class="2764411618740579830" onmouseenter="enter('2764411618740579830');" onmouseout="out('2764411618740579830');" style="">  79     protected OfferDao offerDaoMock;                                                                     </span>
<span  style="">  80                                                                                                          </span>
<span class="-1028825014202044443" onmouseenter="enter('-1028825014202044443');" onmouseout="out('-1028825014202044443');" style="">  81     protected OrderItemDao orderItemDaoMock;                                                             </span>
<span  style="">  82                                                                                                          </span>
<span class="3942591246150891792" onmouseenter="enter('3942591246150891792');" onmouseout="out('3942591246150891792');" style="">  83     protected OfferServiceImpl offerService;                                                             </span>
<span  style="">  84                                                                                                          </span>
<span class="2155154311276627388" onmouseenter="enter('2155154311276627388');" onmouseout="out('2155154311276627388');" style="">  85     protected final OfferDataItemProvider dataProvider = new OfferDataItemProvider();                    </span>
<span  style="">  86                                                                                                          </span>
<span class="-5369679977326057444" onmouseenter="enter('-5369679977326057444');" onmouseout="out('-5369679977326057444');" style="">  87     protected OrderService orderServiceMock;                                                             </span>
<span  style="">  88                                                                                                          </span>
<span class="-2082308031004269425" onmouseenter="enter('-2082308031004269425');" onmouseout="out('-2082308031004269425');" style="">  89     protected OrderItemService orderItemServiceMock;                                                     </span>
<span  style="">  90                                                                                                          </span>
<span class="8143262996519322151" onmouseenter="enter('8143262996519322151');" onmouseout="out('8143262996519322151');" style="">  91     protected FulfillmentGroupItemDao fgItemDaoMock;                                                     </span>
<span  style="">  92                                                                                                          </span>
<span class="3331618624366763309" onmouseenter="enter('3331618624366763309');" onmouseout="out('3331618624366763309');" style="">  93     protected FulfillmentGroupService fgServiceMock;                                                     </span>
<span  style="">  94                                                                                                          </span>
<span class="2038085072144601851" onmouseenter="enter('2038085072144601851');" onmouseout="out('2038085072144601851');" style="">  95     protected OrderMultishipOptionService multishipOptionServiceMock;                                    </span>
<span  style="">  96                                                                                                          </span>
<span class="1636757603740185885" onmouseenter="enter('1636757603740185885');" onmouseout="out('1636757603740185885');" style="">  97     protected OfferTimeZoneProcessor offerTimeZoneProcessorMock;                                         </span>
<span  style="">  98                                                                                                          </span>
<span class="-8980537951567645236" onmouseenter="enter('-8980537951567645236');" onmouseout="out('-8980537951567645236');" style="">  99     protected OfferServiceUtilities offerServiceUtilitiesMock;                                           </span>
<span  style=""> 100                                                                                                          </span>
<span class="-363767546438432308" onmouseenter="enter('-363767546438432308');" onmouseout="out('-363767546438432308');" style=""> 101     protected PromotableOfferUtility promotableOfferUtility;                                             </span>
<span  style=""> 102                                                                                                          </span>
<span class="8126767976686599164" onmouseenter="enter('8126767976686599164');" onmouseout="out('8126767976686599164');" style=""> 103     protected GenericEntityService genericEntityServiceMock;                                             </span>
<span  style=""> 104                                                                                                          </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style=""> 105     protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                            </span>
<span  style=""> 106                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 107     /**                                                                                                  </span>
<span class="-1217892123140267909" onmouseenter="enter('-1217892123140267909');" onmouseout="out('-1217892123140267909');" style=""><abbr title=" 108      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and"> 108      * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application coðŸ”µ</abbr></span>
<span class="-8822842737667556133" onmouseenter="enter('-8822842737667556133');" onmouseout="out('-8822842737667556133');" style=""> 109      * system properties service since it uses BLCSystemProperty                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 110      *                                                                                                   </span>
<span class="2670632328160232809" onmouseenter="enter('2670632328160232809');" onmouseout="out('2670632328160232809');" style=""> 111      * @author Phillip Verheyden (phillipuniverse)                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 112      */                                                                                                  </span>
<span class="8403268836763647235" onmouseenter="enter('8403268836763647235');" onmouseout="out('8403268836763647235');" style=""><abbr title=" 113     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {"> 113     protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorIðŸ”µ</abbr></span>
<span class="7280310143433037386" onmouseenter="enter('7280310143433037386');" onmouseout="out('7280310143433037386');" style=""> 114         public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {   </span>
<span class="386697006679121838" onmouseenter="enter('386697006679121838');" onmouseout="out('386697006679121838');" style=""> 115             super(promotableOfferUtility);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116         }                                                                                                </span>
<span  style=""> 117                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 118         @Override                                                                                        </span>
<span class="-5327199138035207588" onmouseenter="enter('-5327199138035207588');" onmouseout="out('-5327199138035207588');" style=""> 119         protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 120             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="2289017037938349582" onmouseenter="enter('2289017037938349582');" onmouseout="out('2289017037938349582');" style=""> 125     protected void setUp() throws Exception {                                                            </span>
<span class="-7001064742117532685" onmouseenter="enter('-7001064742117532685');" onmouseout="out('-7001064742117532685');" style=""> 126         offerService = new OfferServiceImpl();                                                           </span>
<span class="-5376116141285812671" onmouseenter="enter('-5376116141285812671');" onmouseout="out('-5376116141285812671');" style=""> 127         CustomerOfferDao customerOfferDaoMock = EasyMock.createMock(CustomerOfferDao.class);             </span>
<span class="-570975167499705701" onmouseenter="enter('-570975167499705701');" onmouseout="out('-570975167499705701');" style=""> 128         OfferCodeDao offerCodeDaoMock = EasyMock.createMock(OfferCodeDao.class);                         </span>
<span class="393627947078248392" onmouseenter="enter('393627947078248392');" onmouseout="out('393627947078248392');" style=""> 129         orderServiceMock = EasyMock.createMock(OrderService.class);                                      </span>
<span class="7274735973437056507" onmouseenter="enter('7274735973437056507');" onmouseout="out('7274735973437056507');" style=""> 130         orderItemDaoMock = EasyMock.createMock(OrderItemDao.class);                                      </span>
<span class="1993264780541814880" onmouseenter="enter('1993264780541814880');" onmouseout="out('1993264780541814880');" style=""> 131         orderItemServiceMock = EasyMock.createMock(OrderItemService.class);                              </span>
<span class="-3213369057155598174" onmouseenter="enter('-3213369057155598174');" onmouseout="out('-3213369057155598174');" style=""> 132         fgItemDaoMock = EasyMock.createMock(FulfillmentGroupItemDao.class);                              </span>
<span class="3258640190833853601" onmouseenter="enter('3258640190833853601');" onmouseout="out('3258640190833853601');" style=""> 133         offerDaoMock = EasyMock.createMock(OfferDao.class);                                              </span>
<span class="6964150545963317885" onmouseenter="enter('6964150545963317885');" onmouseout="out('6964150545963317885');" style=""> 134         fgServiceMock = EasyMock.createMock(FulfillmentGroupService.class);                              </span>
<span class="-3871783238737974896" onmouseenter="enter('-3871783238737974896');" onmouseout="out('-3871783238737974896');" style=""> 135         multishipOptionServiceMock = EasyMock.createMock(OrderMultishipOptionService.class);             </span>
<span class="616226227087806826" onmouseenter="enter('616226227087806826');" onmouseout="out('616226227087806826');" style=""> 136         offerServiceUtilitiesMock = EasyMock.createMock(OfferServiceUtilities.class);                    </span>
<span class="-3280473616402059983" onmouseenter="enter('-3280473616402059983');" onmouseout="out('-3280473616402059983');" style=""> 137         offerTimeZoneProcessorMock = EasyMock.createMock(OfferTimeZoneProcessor.class);                  </span>
<span  style=""> 138                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 139 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-5708051595893590327" onmouseenter="enter('-5708051595893590327');" onmouseout="out('-5708051595893590327');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140         promotableOfferUtility = new PromotableOfferUtilityImpl();                                       </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 141 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 142 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 142 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 143 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                                                                                                          </span>
<span class="-8978123556236380411" onmouseenter="enter('-8978123556236380411');" onmouseout="out('-8978123556236380411');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145         genericEntityServiceMock = EasyMock.createMock(GenericEntityService.class);                      </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 146 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span  style=""> 147                                                                                                          </span>
<span class="-6566235364085313060" onmouseenter="enter('-6566235364085313060');" onmouseout="out('-6566235364085313060');" style=""> 148         fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);                </span>
<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style=""> 149         fgProcessor.setOfferDao(offerDaoMock);                                                           </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style=""> 150         fgProcessor.setOrderItemDao(orderItemDaoMock);                                                   </span>
<span class="3776294526577008852" onmouseenter="enter('3776294526577008852');" onmouseout="out('3776294526577008852');" style=""> 151         fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));     </span>
<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style=""> 152         fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                 </span>
<span class="3514247750798048226" onmouseenter="enter('3514247750798048226');" onmouseout="out('3514247750798048226');" style=""><abbr title=" 153         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);"> 153         OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtðŸ”µ</abbr></span>
<span class="4393308911552043332" onmouseenter="enter('4393308911552043332');" onmouseout="out('4393308911552043332');" style=""> 154         offerServiceUtilities.setOfferDao(offerDaoMock);                                                 </span>
<span class="7561232175961587910" onmouseenter="enter('7561232175961587910');" onmouseout="out('7561232175961587910');" style=""><abbr title=" 155         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));"> 155         offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtiliðŸ”µ</abbr></span>
<span class="8346807884110674152" onmouseenter="enter('8346807884110674152');" onmouseout="out('8346807884110674152');" style=""> 156         offerServiceUtilities.setGenericEntityService(genericEntityServiceMock);                         </span>
<span class="-7168324839350089956" onmouseenter="enter('-7168324839350089956');" onmouseout="out('-7168324839350089956');" style=""> 157         OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);    </span>
<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style=""> 158         orderProcessor.setOfferDao(offerDaoMock);                                                        </span>
<span class="5575229934633988866" onmouseenter="enter('5575229934633988866');" onmouseout="out('5575229934633988866');" style=""> 159         orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));  </span>
<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style=""> 160         orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                              </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style=""> 161         orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                            </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style=""> 162         orderProcessor.setOrderItemDao(orderItemDaoMock);                                                </span>
<span class="-8932862412317704790" onmouseenter="enter('-8932862412317704790');" onmouseout="out('-8932862412317704790');" style=""> 163         orderProcessor.setOfferServiceUtilities(offerServiceUtilities);                                  </span>
<span class="4016707405384637073" onmouseenter="enter('4016707405384637073');" onmouseout="out('4016707405384637073');" style=""> 164         ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);       </span>
<span class="-7004957386218896406" onmouseenter="enter('-7004957386218896406');" onmouseout="out('-7004957386218896406');" style=""> 165         itemProcessor.setOfferDao(offerDaoMock);                                                         </span>
<span class="-2793185480423849018" onmouseenter="enter('-2793185480423849018');" onmouseout="out('-2793185480423849018');" style=""> 166         itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));   </span>
<span class="-7985735156898326914" onmouseenter="enter('-7985735156898326914');" onmouseout="out('-7985735156898326914');" style=""> 167         itemProcessor.setOrderItemDao(orderItemDaoMock);                                                 </span>
<span class="1873271206223196651" onmouseenter="enter('1873271206223196651');" onmouseout="out('1873271206223196651');" style=""> 168         itemProcessor.setOfferServiceUtilities(offerServiceUtilities);                                   </span>
<span class="-7594314374485898167" onmouseenter="enter('-7594314374485898167');" onmouseout="out('-7594314374485898167');" style=""> 169         offerService.setCustomerOfferDao(customerOfferDaoMock);                                          </span>
<span class="483175997286853822" onmouseenter="enter('483175997286853822');" onmouseout="out('483175997286853822');" style=""> 170         offerService.setOfferCodeDao(offerCodeDaoMock);                                                  </span>
<span class="-157638129368187663" onmouseenter="enter('-157638129368187663');" onmouseout="out('-157638129368187663');" style=""> 171         offerService.setOfferDao(offerDaoMock);                                                          </span>
<span class="-2861300639666845512" onmouseenter="enter('-2861300639666845512');" onmouseout="out('-2861300639666845512');" style=""> 172         offerService.setOrderOfferProcessor(orderProcessor);                                             </span>
<span class="4668119620018038426" onmouseenter="enter('4668119620018038426');" onmouseout="out('4668119620018038426');" style=""> 173         offerService.setItemOfferProcessor(itemProcessor);                                               </span>
<span class="-4412724488869175480" onmouseenter="enter('-4412724488869175480');" onmouseout="out('-4412724488869175480');" style=""> 174         offerService.setFulfillmentGroupOfferProcessor(fgProcessor);                                     </span>
<span class="-2798583477021709202" onmouseenter="enter('-2798583477021709202');" onmouseout="out('-2798583477021709202');" style=""> 175         offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));    </span>
<span class="-7013122243510448528" onmouseenter="enter('-7013122243510448528');" onmouseout="out('-7013122243510448528');" style=""> 176         offerService.setOrderService(orderServiceMock);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177     }                                                                                                    </span>
<span  style=""> 178                                                                                                          </span>
<span class="3027682741895790020" onmouseenter="enter('3027682741895790020');" onmouseout="out('3027682741895790020');" style=""> 179     public void replay() {                                                                               </span>
<span class="4039967104390893601" onmouseenter="enter('4039967104390893601');" onmouseout="out('4039967104390893601');" style=""> 180         EasyMock.replay(offerDaoMock);                                                                   </span>
<span class="-8438798452743116996" onmouseenter="enter('-8438798452743116996');" onmouseout="out('-8438798452743116996');" style=""> 181         EasyMock.replay(orderItemDaoMock);                                                               </span>
<span class="-306516478140011318" onmouseenter="enter('-306516478140011318');" onmouseout="out('-306516478140011318');" style=""> 182         EasyMock.replay(orderServiceMock);                                                               </span>
<span class="-1764805494951210013" onmouseenter="enter('-1764805494951210013');" onmouseout="out('-1764805494951210013');" style=""> 183         EasyMock.replay(orderItemServiceMock);                                                           </span>
<span class="1127149787736159594" onmouseenter="enter('1127149787736159594');" onmouseout="out('1127149787736159594');" style=""> 184         EasyMock.replay(fgItemDaoMock);                                                                  </span>
<span class="220377317211655869" onmouseenter="enter('220377317211655869');" onmouseout="out('220377317211655869');" style=""> 185         EasyMock.replay(fgServiceMock);                                                                  </span>
<span class="7141248576860687210" onmouseenter="enter('7141248576860687210');" onmouseout="out('7141248576860687210');" style=""> 186         EasyMock.replay(multishipOptionServiceMock);                                                     </span>
<span class="1625398624145697967" onmouseenter="enter('1625398624145697967');" onmouseout="out('1625398624145697967');" style=""> 187         EasyMock.replay(offerTimeZoneProcessorMock);                                                     </span>
<span class="7441173554159837333" onmouseenter="enter('7441173554159837333');" onmouseout="out('7441173554159837333');" style=""> 188         EasyMock.replay(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="6267001839391766981" onmouseenter="enter('6267001839391766981');" onmouseout="out('6267001839391766981');" style=""> 191     public void verify() {                                                                               </span>
<span class="6756940960390862422" onmouseenter="enter('6756940960390862422');" onmouseout="out('6756940960390862422');" style=""> 192         EasyMock.verify(offerDaoMock);                                                                   </span>
<span class="-5117344946758939057" onmouseenter="enter('-5117344946758939057');" onmouseout="out('-5117344946758939057');" style=""> 193         EasyMock.verify(orderItemDaoMock);                                                               </span>
<span class="-6538245312297088944" onmouseenter="enter('-6538245312297088944');" onmouseout="out('-6538245312297088944');" style=""> 194         EasyMock.verify(orderServiceMock);                                                               </span>
<span class="4656187310788509663" onmouseenter="enter('4656187310788509663');" onmouseout="out('4656187310788509663');" style=""> 195         EasyMock.verify(orderItemServiceMock);                                                           </span>
<span class="-3344344690958109982" onmouseenter="enter('-3344344690958109982');" onmouseout="out('-3344344690958109982');" style=""> 196         EasyMock.verify(fgItemDaoMock);                                                                  </span>
<span class="-7107457974865616724" onmouseenter="enter('-7107457974865616724');" onmouseout="out('-7107457974865616724');" style=""> 197         EasyMock.verify(fgServiceMock);                                                                  </span>
<span class="3082501288673197520" onmouseenter="enter('3082501288673197520');" onmouseout="out('3082501288673197520');" style=""> 198         EasyMock.verify(multishipOptionServiceMock);                                                     </span>
<span class="8968216054532738001" onmouseenter="enter('8968216054532738001');" onmouseout="out('8968216054532738001');" style=""> 199         EasyMock.verify(offerTimeZoneProcessorMock);                                                     </span>
<span class="1970601797097358226" onmouseenter="enter('1970601797097358226');" onmouseout="out('1970601797097358226');" style=""> 200         EasyMock.verify(offerServiceUtilitiesMock);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="4350196711973577847" onmouseenter="enter('4350196711973577847');" onmouseout="out('4350196711973577847');" style=""> 203     public void testApplyAllFulfillmentGroupOffersWithOrderItemOffers() throws Exception {               </span>
<span class="8446165972037001535" onmouseenter="enter('8446165972037001535');" onmouseout="out('8446165972037001535');" style=""> 204         final ThreadLocal&lt;Order&gt; myOrder = new ThreadLocal&lt;Order&gt;();                                     </span>
<span class="3688914841313020601" onmouseenter="enter('3688914841313020601');" onmouseout="out('3688914841313020601');" style=""><abbr title=" 205         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAnswer()).anyTimes();"> 205         EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.geðŸ”µ</abbr></span>
<span class="244050499009988211" onmouseenter="enter('244050499009988211');" onmouseout="out('244050499009988211');" style=""><abbr title=" 206         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrderItemQualifierAnswer()).atLeastOnce();"> 206         EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCðŸ”µ</abbr></span>
<span class="-4805711593793558927" onmouseenter="enter('-4805711593793558927');" onmouseout="out('-4805711593793558927');" style=""><abbr title=" 207         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getAddItemToFulfillmentGroupAnswer()).anyTimes();"> 207         EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.ðŸ”µ</abbr></span>
<span class="-6333386513522988817" onmouseenter="enter('-6333386513522988817');" onmouseout="out('-6333386513522988817');" style=""><abbr title=" 208         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(java.lang.Long.class), EasyMock.isA(java.lang.Long.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getRemoveItemFromOrderAnswer()).anyTimes();"> 208         EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(java.lang.Long.class), EasyMock.isA(javaðŸ”µ</abbr></span>
<span class="-7302172700820287866" onmouseenter="enter('-7302172700820287866');" onmouseout="out('-7302172700820287866');" style=""><abbr title=" 209         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(java.lang.Boolean.class))).andAnswer(OfferDataItemProvider.getSaveOrderAnswer()).anyTimes();"> 209         EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(java.lang.Boolean.cðŸ”µ</abbr></span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 210         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 210         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 211         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 211         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span class="2160564019413082164" onmouseenter="enter('2160564019413082164');" onmouseout="out('2160564019413082164');" style=""> 212         EasyMock.expect(orderServiceMock.getAutomaticallyMergeLikeItems()).andReturn(true).anyTimes();   </span>
<span class="-8884522234726007395" onmouseenter="enter('-8884522234726007395');" onmouseout="out('-8884522234726007395');" style=""><abbr title=" 213         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemProvider.getSaveOrderItemAnswer()).anyTimes();"> 213         EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OffeðŸ”µ</abbr></span>
<span class="-3554631046904274751" onmouseenter="enter('-3554631046904274751');" onmouseout="out('-3554631046904274751');" style=""><abbr title=" 214         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProvider.getSaveFulfillmentGroupItemAnswer()).anyTimes();"> 214         EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataðŸ”µ</abbr></span>
<span class="3313434268437563429" onmouseenter="enter('3313434268437563429');" onmouseout="out('3313434268437563429');" style=""><abbr title=" 215         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAdjustmentAnswer()).anyTimes();"> 215         EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProviðŸ”µ</abbr></span>
<span class="-3718636667900446110" onmouseenter="enter('-3718636667900446110');" onmouseout="out('-3718636667900446110');" style=""><abbr title=" 216         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupAdjustmentAnswer()).anyTimes();"> 216         EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.ðŸ”µ</abbr></span>
<span class="-3717121550809889088" onmouseenter="enter('-3717121550809889088');" onmouseout="out('-3717121550809889088');" style=""><abbr title=" 217         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(java.lang.Long.class))).andAnswer(new IAnswer&lt;Order&gt;() {"> 217         EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(java.lang.Long.class))).andAnswer(newðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 218             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 219             public Order answer() throws Throwable {                                                     </span>
<span class="-2641290802290262879" onmouseenter="enter('-2641290802290262879');" onmouseout="out('-2641290802290262879');" style=""> 220                 return myOrder.get();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 222         }).anyTimes();                                                                                   </span>
<span class="-5059829523645999828" onmouseenter="enter('-5059829523645999828');" onmouseout="out('-5059829523645999828');" style=""><abbr title=" 223         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(java.lang.Long.class))).andAnswer(new IAnswer&lt;List&lt;OrderMultishipOption&gt;&gt;() {"> 223         EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(java.lang.Long.ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224             @Override                                                                                    </span>
<span class="4982536128511672004" onmouseenter="enter('4982536128511672004');" onmouseout="out('4982536128511672004');" style=""> 225             public List&lt;OrderMultishipOption&gt; answer() throws Throwable {                                </span>
<span class="3348167234255574763" onmouseenter="enter('3348167234255574763');" onmouseout="out('3348167234255574763');" style=""> 226                 List&lt;OrderMultishipOption&gt; options = new ArrayList&lt;OrderMultishipOption&gt;();              </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 227                 PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility); </span>
<span class="-6747846520377446395" onmouseenter="enter('-6747846520377446395');" onmouseout="out('-6747846520377446395');" style=""> 228                 for (FulfillmentGroup fg : order.getOrder().getFulfillmentGroups()) {                    </span>
<span class="-6367521286140114289" onmouseenter="enter('-6367521286140114289');" onmouseout="out('-6367521286140114289');" style=""> 229                     Address address = fg.getAddress();                                                   </span>
<span class="8028460309176757050" onmouseenter="enter('8028460309176757050');" onmouseout="out('8028460309176757050');" style=""> 230                     for (FulfillmentGroupItem fgItem : fg.getFulfillmentGroupItems()) {                  </span>
<span class="8402583593129976695" onmouseenter="enter('8402583593129976695');" onmouseout="out('8402583593129976695');" style=""> 231                         for (int j = 0; j &lt; fgItem.getQuantity(); j++) {                                 </span>
<span class="3921661458783293685" onmouseenter="enter('3921661458783293685');" onmouseout="out('3921661458783293685');" style=""> 232                             OrderMultishipOption option = new OrderMultishipOptionImpl();                </span>
<span class="6971594022266833915" onmouseenter="enter('6971594022266833915');" onmouseout="out('6971594022266833915');" style=""> 233                             option.setOrder(order.getOrder());                                           </span>
<span class="-7842023912465695186" onmouseenter="enter('-7842023912465695186');" onmouseout="out('-7842023912465695186');" style=""> 234                             option.setAddress(address);                                                  </span>
<span class="-8979996557527707436" onmouseenter="enter('-8979996557527707436');" onmouseout="out('-8979996557527707436');" style=""> 235                             option.setOrderItem(fgItem.getOrderItem());                                  </span>
<span class="3662213946586141634" onmouseenter="enter('3662213946586141634');" onmouseout="out('3662213946586141634');" style=""> 236                             options.add(option);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237                         }                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239                 }                                                                                        </span>
<span class="7754614799802233964" onmouseenter="enter('7754614799802233964');" onmouseout="out('7754614799802233964');" style=""> 240                 return options;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 242         }).anyTimes();                                                                                   </span>
<span class="5730763888734231228" onmouseenter="enter('5730763888734231228');" onmouseout="out('5730763888734231228');" style=""> 243         multishipOptionServiceMock.deleteAllOrderMultishipOptions(EasyMock.isA(Order.class));            </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 244         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="-2684793509385343472" onmouseenter="enter('-2684793509385343472');" onmouseout="out('-2684793509385343472');" style=""><abbr title=" 245         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eq(false))).andAnswer(new IAnswer&lt;Order&gt;() {"> 245         EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 246             @Override                                                                                    </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 247             public Order answer() throws Throwable {                                                     </span>
<span class="-805219023314288319" onmouseenter="enter('-805219023314288319');" onmouseout="out('-805219023314288319');" style=""> 248                 Order order = ((Order) (EasyMock.getCurrentArguments()[0]));                             </span>
<span class="6377062998999459231" onmouseenter="enter('6377062998999459231');" onmouseout="out('6377062998999459231');" style=""><abbr title=" 249                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups().get(1).getFulfillmentGroupItems());"> 249                 order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmenðŸ”µ</abbr></span>
<span class="8328438890662847465" onmouseenter="enter('8328438890662847465');" onmouseout="out('8328438890662847465');" style=""> 250                 order.getFulfillmentGroups().remove(order.getFulfillmentGroups().get(1));                </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 251                 return order;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 253         }).anyTimes();                                                                                   </span>
<span class="7005207656442723333" onmouseenter="enter('7005207656442723333');" onmouseout="out('7005207656442723333');" style=""><abbr title=" 254         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnswer()).anyTimes();"> 254         EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupðŸ”µ</abbr></span>
<span class="3552856255510166668" onmouseenter="enter('3552856255510166668');" onmouseout="out('3552856255510166668');" style=""> 255         fgItemDaoMock.delete(EasyMock.isA(FulfillmentGroupItem.class));                                  </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 256         EasyMock.expectLastCall().anyTimes();                                                            </span>
<span class="602433099109498087" onmouseenter="enter('602433099109498087');" onmouseout="out('602433099109498087');" style=""><abbr title=" 257         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.getTimeZone(&quot;CST&quot;)).anyTimes();"> 257         EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(ðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 258         replay();                                                                                        </span>
<span class="5984499010113424780" onmouseenter="enter('5984499010113424780');" onmouseout="out('5984499010113424780');" style=""><abbr title=" 259         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);"> 259         PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility)ðŸ”µ</abbr></span>
<span class="-396343315567854895" onmouseenter="enter('-396343315567854895');" onmouseout="out('-396343315567854895');" style=""> 260         Order order = promotableOrder.getOrder();                                                        </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 261         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 262         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 262         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 263         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 263         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 264         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 264         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 265         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span class="3192944363804549847" onmouseenter="enter('3192944363804549847');" onmouseout="out('3192944363804549847');" style=""><abbr title=" 266         offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 266         offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, ðŸ”µ</abbr></span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 267         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span class="-5783701790519827054" onmouseenter="enter('-5783701790519827054');" onmouseout="out('-5783701790519827054');" style=""> 268         offers.get(0).setTotalitarianOffer(true);                                                        </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 269         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 270         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 271         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 272             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273         }                                                                                                </span>
<span class="866990830965641498" onmouseenter="enter('866990830965641498');" onmouseout="out('866990830965641498');" style=""><abbr title=" 274         // The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order item offers"> 274         // The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than tðŸ”µ</abbr></span>
<span class="-7018201492040868931" onmouseenter="enter('-7018201492040868931');" onmouseout="out('-7018201492040868931');" style=""> 275         // - it is therefore ignored                                                                     </span>
<span class="-2157560082767373771" onmouseenter="enter('-2157560082767373771');" onmouseout="out('-2157560082767373771');" style=""> 276         // However, the second combinable fg offer is allowed to be applied.                             </span>
<span class="1322310588171640590" onmouseenter="enter('1322310588171640590');" onmouseout="out('1322310588171640590');" style=""> 277         assertTrue(fgAdjustmentCount == 1);                                                              </span>
<span class="-1191672713468750443" onmouseenter="enter('-1191672713468750443');" onmouseout="out('-1191672713468750443');" style=""> 278         promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);               </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 279         myOrder.set(promotableOrder.getOrder());                                                         </span>
<span class="4605867479195622271" onmouseenter="enter('4605867479195622271');" onmouseout="out('4605867479195622271');" style=""> 280         offers.get(2).setValue(new BigDecimal(&quot;1&quot;));                                                     </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 281         offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                      </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 282         offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());      </span>
<span class="5070682841290639966" onmouseenter="enter('5070682841290639966');" onmouseout="out('5070682841290639966');" style=""> 283         fgAdjustmentCount = 0;                                                                           </span>
<span class="-1030185999544814128" onmouseenter="enter('-1030185999544814128');" onmouseout="out('-1030185999544814128');" style=""> 284         order = promotableOrder.getOrder();                                                              </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 285         for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                       </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 286             fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287         }                                                                                                </span>
<span class="6577823276127191812" onmouseenter="enter('6577823276127191812');" onmouseout="out('6577823276127191812');" style=""><abbr title=" 288         // The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fg offer is applied"> 288         // The totalitarian fg offer is now a better deal than the order item offers, therefore the totalðŸ”µ</abbr></span>
<span class="138071343337541509" onmouseenter="enter('138071343337541509');" onmouseout="out('138071343337541509');" style=""> 289         // and the order item offers are removed                                                         </span>
<span class="3307702501962124755" onmouseenter="enter('3307702501962124755');" onmouseout="out('3307702501962124755');" style=""> 290         assertTrue(fgAdjustmentCount == 2);                                                              </span>
<span class="-2665219164306343886" onmouseenter="enter('-2665219164306343886');" onmouseout="out('-2665219164306343886');" style=""> 291         int itemAdjustmentCount = 0;                                                                     </span>
<span class="820796442257070700" onmouseenter="enter('820796442257070700');" onmouseout="out('820796442257070700');" style=""> 292         for (OrderItem item : order.getOrderItems()) {                                                   </span>
<span class="773323050474809935" onmouseenter="enter('773323050474809935');" onmouseout="out('773323050474809935');" style=""> 293             for (OrderItemPriceDetail detail : item.getOrderItemPriceDetails()) {                        </span>
<span class="-2721944390925153219" onmouseenter="enter('-2721944390925153219');" onmouseout="out('-2721944390925153219');" style=""> 294                 itemAdjustmentCount += detail.getOrderItemPriceDetailAdjustments().size();               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296         }                                                                                                </span>
<span class="3524586044178117313" onmouseenter="enter('3524586044178117313');" onmouseout="out('3524586044178117313');" style=""> 297         // Confirm that the order item offers are removed                                                </span>
<span class="8413015744603539595" onmouseenter="enter('8413015744603539595');" onmouseout="out('8413015744603539595');" style=""> 298         assertTrue(itemAdjustmentCount == 0);                                                            </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 299         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300     }                                                                                                    </span>
<span  style=""> 301                                                                                                          </span>
<span class="5292901739910789200" onmouseenter="enter('5292901739910789200');" onmouseout="out('5292901739910789200');" style=""> 302     public void testApplyAllFulfillmentGroupOffers() {                                                   </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 303         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 303         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 304         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 304         EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 305         replay();                                                                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 306         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 307         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 307         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 308         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 308         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 309         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="-8566543852517619753" onmouseenter="enter('-8566543852517619753');" onmouseout="out('-8566543852517619753');" style=""> 310         boolean offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);       </span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 311         assertTrue(offerApplied);                                                                        </span>
<span class="485587340594496069" onmouseenter="enter('485587340594496069');" onmouseout="out('485587340594496069');" style=""> 312         order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                         </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 313         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-2396210347480358039" onmouseenter="enter('-2396210347480358039');" onmouseout="out('-2396210347480358039');" style=""><abbr title=" 314         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 314         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 315         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 315         offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 316         offers.get(1).setName(&quot;secondOffer&quot;);                                                            </span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 317         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="1761556730467108563" onmouseenter="enter('1761556730467108563');" onmouseout="out('1761556730467108563');" style=""> 318         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(1));             </span>
<span class="2518449647151254078" onmouseenter="enter('2518449647151254078');" onmouseout="out('2518449647151254078');" style=""> 319         offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);               </span>
<span class="-7765969774094159537" onmouseenter="enter('-7765969774094159537');" onmouseout="out('-7765969774094159537');" style=""><abbr title=" 320         // the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfillment groups"> 320         // the first offer applies to both fulfillment groups, but the second offer only applies to one oðŸ”µ</abbr></span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 321         assertTrue(offerApplied);                                                                        </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 322         int fgAdjustmentCount = 0;                                                                       </span>
<span class="-1134830134613695083" onmouseenter="enter('-1134830134613695083');" onmouseout="out('-1134830134613695083');" style=""> 323         for (PromotableFulfillmentGroup fg : order.getFulfillmentGroups()) {                             </span>
<span class="5611483739197685885" onmouseenter="enter('5611483739197685885');" onmouseout="out('5611483739197685885');" style=""> 324             fgAdjustmentCount += fg.getCandidateFulfillmentGroupAdjustments().size();                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325         }                                                                                                </span>
<span class="6786894656890298013" onmouseenter="enter('6786894656890298013');" onmouseout="out('6786894656890298013');" style=""> 326         assertTrue(fgAdjustmentCount == 3);                                                              </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 327         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328     }                                                                                                    </span>
<span  style=""> 329                                                                                                          </span>
<span class="-6111721081814302723" onmouseenter="enter('-6111721081814302723');" onmouseout="out('-6111721081814302723');" style=""> 330     public void testFilterFulfillmentGroupLevelOffer() {                                                 </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 331         replay();                                                                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 332         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 333         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 333         List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidatðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 334         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 334         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 335         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="6836361971008634540" onmouseenter="enter('6836361971008634540');" onmouseout="out('6836361971008634540');" style=""> 336         // test that the valid fg offer is included                                                      </span>
<span class="309173820059293664" onmouseenter="enter('309173820059293664');" onmouseout="out('309173820059293664');" style=""> 337         // No item criteria, so each fulfillment group applies                                           </span>
<span class="7232931750942567320" onmouseenter="enter('7232931750942567320');" onmouseout="out('7232931750942567320');" style=""><abbr title=" 338         assertTrue((qualifiedOffers.size() == 2) &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 338         assertTrue((qualifiedOffers.size() == 2) &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0ðŸ”µ</abbr></span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 339         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-794484836397434919" onmouseenter="enter('-794484836397434919');" onmouseout="out('-794484836397434919');" style=""><abbr title=" 340         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 340         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 341         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="6836361971008634540" onmouseenter="enter('6836361971008634540');" onmouseout="out('6836361971008634540');" style=""> 342         // test that the valid fg offer is included                                                      </span>
<span class="6039406680321057622" onmouseenter="enter('6039406680321057622');" onmouseout="out('6039406680321057622');" style=""> 343         // only 1 fulfillment group has qualifying items                                                 </span>
<span class="5367568380052553015" onmouseenter="enter('5367568380052553015');" onmouseout="out('5367568380052553015');" style=""><abbr title=" 344         assertTrue((qualifiedOffers.size() == 1) &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));"> 344         assertTrue((qualifiedOffers.size() == 1) &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0ðŸ”µ</abbr></span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 345         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1175553281482923867" onmouseenter="enter('-1175553281482923867');" onmouseout="out('-1175553281482923867');" style=""><abbr title=" 346         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 346         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 347         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="9157501328475415885" onmouseenter="enter('9157501328475415885');" onmouseout="out('9157501328475415885');" style=""> 348         // test that the invalid fg offer is excluded - zipcode is wrong                                 </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 349         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 350         qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                     </span>
<span class="-1725928204111497608" onmouseenter="enter('-1725928204111497608');" onmouseout="out('-1725928204111497608');" style=""><abbr title=" 351         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 351         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 352         fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));             </span>
<span class="3272393000977668596" onmouseenter="enter('3272393000977668596');" onmouseout="out('3272393000977668596');" style=""> 353         // test that the invalid fg offer is excluded - no qualifying items                              </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 354         assertTrue(qualifiedOffers.size() == 0);                                                         </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 355         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356     }                                                                                                    </span>
<span  style=""> 357                                                                                                          </span>
<span class="-4776997419015764151" onmouseenter="enter('-4776997419015764151');" onmouseout="out('-4776997419015764151');" style=""> 358     public void testCouldOfferApplyToFulfillmentGroup() {                                                </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 359         replay();                                                                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 360         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 361         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 361         List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="6925194278348061796" onmouseenter="enter('6925194278348061796');" onmouseout="out('6925194278348061796');" style=""><abbr title=" 362         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 362         boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfilðŸ”µ</abbr></span>
<span class="6836361971008634540" onmouseenter="enter('6836361971008634540');" onmouseout="out('6836361971008634540');" style=""> 363         // test that the valid fg offer is included                                                      </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 364         assertTrue(couldApply);                                                                          </span>
<span class="-3097227128962316937" onmouseenter="enter('-3097227128962316937');" onmouseout="out('-3097227128962316937');" style=""><abbr title=" 365         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF);"> 365         offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.addreðŸ”µ</abbr></span>
<span class="-1233560991880639261" onmouseenter="enter('-1233560991880639261');" onmouseout="out('-1233560991880639261');" style=""><abbr title=" 366         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 366         couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroðŸ”µ</abbr></span>
<span class="-2144886919987329344" onmouseenter="enter('-2144886919987329344');" onmouseout="out('-2144886919987329344');" style=""> 367         // test that the invalid fg offer is excluded                                                    </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 368         assertFalse(couldApply);                                                                         </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 369         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370     }                                                                                                    </span>
<span  style=""> 371                                                                                                          </span>
<span class="3929316778716445185" onmouseenter="enter('3929316778716445185');" onmouseout="out('3929316778716445185');" style=""> 372     public void testCouldOrderItemMeetOfferRequirement() {                                               </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 373         replay();                                                                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 374         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 375         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 375         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="1501673451570831850" onmouseenter="enter('1501673451570831850');" onmouseout="out('1501673451570831850');" style=""><abbr title=" 376         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();"> 376         OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next(ðŸ”µ</abbr></span>
<span class="7919750782802558587" onmouseenter="enter('7919750782802558587');" onmouseout="out('7919750782802558587');" style=""><abbr title=" 377         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 377         boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), ðŸ”µ</abbr></span>
<span class="6836361971008634540" onmouseenter="enter('6836361971008634540');" onmouseout="out('6836361971008634540');" style=""> 378         // test that the valid fg offer is included                                                      </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 379         assertTrue(couldApply);                                                                          </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 380         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 380         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="2238137642305281390" onmouseenter="enter('2238137642305281390');" onmouseout="out('2238137642305281390');" style=""> 381         xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();                          </span>
<span class="-3043998037798990151" onmouseenter="enter('-3043998037798990151');" onmouseout="out('-3043998037798990151');" style=""><abbr title=" 382         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 382         couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.geðŸ”µ</abbr></span>
<span class="-2144886919987329344" onmouseenter="enter('-2144886919987329344');" onmouseout="out('-2144886919987329344');" style=""> 383         // test that the invalid fg offer is excluded                                                    </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 384         assertFalse(couldApply);                                                                         </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 385         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386     }                                                                                                    </span>
<span  style=""> 387                                                                                                          </span>
<span class="-4499124276559625962" onmouseenter="enter('-4499124276559625962');" onmouseout="out('-4499124276559625962');" style=""> 388     public void testCouldOfferApplyToOrderItems() {                                                      </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 389         replay();                                                                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style=""> 390         PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);         </span>
<span class="-4222545078163101091" onmouseenter="enter('-4222545078163101091');" onmouseout="out('-4222545078163101091');" style=""> 391         List&lt;PromotableOrderItem&gt; orderItems = new ArrayList&lt;PromotableOrderItem&gt;();                     </span>
<span class="-7372483979901719352" onmouseenter="enter('-7372483979901719352');" onmouseout="out('-7372483979901719352');" style=""> 392         for (PromotableOrderItem orderItem : order.getDiscountableOrderItems()) {                        </span>
<span class="5423314879443576267" onmouseenter="enter('5423314879443576267');" onmouseout="out('5423314879443576267');" style=""> 393             orderItems.add(orderItem);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 395         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 395         List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;ðŸ”µ</abbr></span>
<span class="8410448623592275924" onmouseenter="enter('8410448623592275924');" onmouseout="out('8410448623592275924');" style=""><abbr title=" 396         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);"> 396         CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderðŸ”µ</abbr></span>
<span class="6836361971008634540" onmouseenter="enter('6836361971008634540');" onmouseout="out('6836361971008634540');" style=""> 397         // test that the valid fg offer is included                                                      </span>
<span class="8949735111778388694" onmouseenter="enter('8949735111778388694');" onmouseout="out('8949735111778388694');" style=""><abbr title=" 398         assertTrue(candidates.isMatchedQualifier() &amp;&amp; (candidates.getCandidateQualifiersMap().size() == 1));"> 398         assertTrue(candidates.isMatchedQualifier() &amp;&amp; (candidates.getCandidateQualifiersMap().size() == 1ðŸ”µ</abbr></span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 399         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 399         offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfilðŸ”µ</abbr></span>
<span class="-3576845332244688046" onmouseenter="enter('-3576845332244688046');" onmouseout="out('-3576845332244688046');" style=""> 400         candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);                 </span>
<span class="6495376501253236594" onmouseenter="enter('6495376501253236594');" onmouseout="out('6495376501253236594');" style=""> 401         // test that the invalid fg offer is excluded because there are no qualifying items              </span>
<span class="1594257511686915167" onmouseenter="enter('1594257511686915167');" onmouseout="out('1594257511686915167');" style=""><abbr title=" 402         assertFalse(candidates.isMatchedQualifier() &amp;&amp; (candidates.getCandidateQualifiersMap().size() == 1));"> 402         assertFalse(candidates.isMatchedQualifier() &amp;&amp; (candidates.getCandidateQualifiersMap().size() == ðŸ”µ</abbr></span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 403         verify();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404     }                                                                                                    </span>
<span  style=""> 405                                                                                                          </span>
<span class="5648347102432971432" onmouseenter="enter('5648347102432971432');" onmouseout="out('5648347102432971432');" style=""><abbr title=" 406     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; {"> 406     public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; ðŸ”µ</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 407         @Override                                                                                        </span>
<span class="-3723008217761904240" onmouseenter="enter('-3723008217761904240');" onmouseout="out('-3723008217761904240');" style=""> 408         public CandidateFulfillmentGroupOffer answer() throws Throwable {                                </span>
<span class="-8755543066605634487" onmouseenter="enter('-8755543066605634487');" onmouseout="out('-8755543066605634487');" style=""> 409             return new CandidateFulfillmentGroupOfferImpl();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411     }                                                                                                    </span>
<span  style=""> 412                                                                                                          </span>
<span class="3886526384953801028" onmouseenter="enter('3886526384953801028');" onmouseout="out('3886526384953801028');" style=""> 413     public class FulfillmentGroupAdjustmentAnswer implements IAnswer&lt;FulfillmentGroupAdjustment&gt; {       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 414         @Override                                                                                        </span>
<span class="2396386951594711402" onmouseenter="enter('2396386951594711402');" onmouseout="out('2396386951594711402');" style=""> 415         public FulfillmentGroupAdjustment answer() throws Throwable {                                    </span>
<span class="4220759534941126036" onmouseenter="enter('4220759534941126036');" onmouseout="out('4220759534941126036');" style=""> 416             return new FulfillmentGroupAdjustmentImpl();                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418     }                                                                                                    </span>
<span  style=""> 419                                                                                                          </span>
<span class="1687502207616012454" onmouseenter="enter('1687502207616012454');" onmouseout="out('1687502207616012454');" style=""> 420     public class CandidateItemOfferAnswer implements IAnswer&lt;CandidateItemOffer&gt; {                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 421         @Override                                                                                        </span>
<span class="2347184973793483651" onmouseenter="enter('2347184973793483651');" onmouseout="out('2347184973793483651');" style=""> 422         public CandidateItemOffer answer() throws Throwable {                                            </span>
<span class="7644422100596500085" onmouseenter="enter('7644422100596500085');" onmouseout="out('7644422100596500085');" style=""> 423             return new CandidateItemOfferImpl();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425     }                                                                                                    </span>
<span  style=""> 426                                                                                                          </span>
<span class="6834818405609520876" onmouseenter="enter('6834818405609520876');" onmouseout="out('6834818405609520876');" style=""> 427     public class OrderItemAdjustmentAnswer implements IAnswer&lt;OrderItemAdjustment&gt; {                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 428         @Override                                                                                        </span>
<span class="4861248105020273136" onmouseenter="enter('4861248105020273136');" onmouseout="out('4861248105020273136');" style=""> 429         public OrderItemAdjustment answer() throws Throwable {                                           </span>
<span class="7697130786892874769" onmouseenter="enter('7697130786892874769');" onmouseout="out('7697130786892874769');" style=""> 430             return new OrderItemAdjustmentImpl();                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433 }                                                                                                        </span>


















































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-5062573030309236877" onmouseenter="enter('-5062573030309236877');" onmouseout="out('-5062573030309236877');" style="">   3   * BroadleafCommerce Framework                                                                                    </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-4156106492343801428" onmouseenter="enter('-4156106492343801428');" onmouseout="out('-4156106492343801428');" style="">  18  package org.broadleafcommerce.core.offer.service.processor;                                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  19 +                                                                                                                  </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  20 +import junit.framework.TestCase;                                                                                  </span>
<span  style="">  21                                                                                                                    </span>

<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="">  22  import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                                     </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="">  23  import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                         </span>
<span class="-2793633202507663758" onmouseenter="enter('-2793633202507663758');" onmouseout="out('-2793633202507663758');" style="">  24  import org.broadleafcommerce.core.offer.dao.OfferDao;                                                             </span>
<span class="796126113999839594" onmouseenter="enter('796126113999839594');" onmouseout="out('796126113999839594');" style="">  25  import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;                                    </span>
<span class="2150723484434835298" onmouseenter="enter('2150723484434835298');" onmouseout="out('2150723484434835298');" style="">  26  import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;                                </span>
<span class="4011152823911960428" onmouseenter="enter('4011152823911960428');" onmouseout="out('4011152823911960428');" style="">  27  import org.broadleafcommerce.core.offer.domain.CandidateItemOffer;                                                </span>
<span class="-735428748329738672" onmouseenter="enter('-735428748329738672');" onmouseout="out('-735428748329738672');" style="">  28  import org.broadleafcommerce.core.offer.domain.CandidateItemOfferImpl;                                            </span>
<span class="5599608658353832247" onmouseenter="enter('5599608658353832247');" onmouseout="out('5599608658353832247');" style="">  29  import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;                                        </span>
<span class="6308539507696801789" onmouseenter="enter('6308539507696801789');" onmouseout="out('6308539507696801789');" style="">  30  import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;                                    </span>
<span class="4081153142019712377" onmouseenter="enter('4081153142019712377');" onmouseout="out('4081153142019712377');" style="">  31  import org.broadleafcommerce.core.offer.domain.Offer;                                                             </span>
<span class="-7025591891527881733" onmouseenter="enter('-7025591891527881733');" onmouseout="out('-7025591891527881733');" style="">  32  import org.broadleafcommerce.core.offer.domain.OfferImpl;                                                         </span>
<span class="1133170227846016200" onmouseenter="enter('1133170227846016200');" onmouseout="out('1133170227846016200');" style="">  33  import org.broadleafcommerce.core.offer.domain.OfferQualifyingCriteriaXref;                                       </span>
<span class="-1124625745990626401" onmouseenter="enter('-1124625745990626401');" onmouseout="out('-1124625745990626401');" style="">  34  import org.broadleafcommerce.core.offer.domain.OrderItemAdjustment;                                               </span>
<span class="-6005336697873394325" onmouseenter="enter('-6005336697873394325');" onmouseout="out('-6005336697873394325');" style="">  35  import org.broadleafcommerce.core.offer.domain.OrderItemAdjustmentImpl;                                           </span>
<span class="1848619708404770384" onmouseenter="enter('1848619708404770384');" onmouseout="out('1848619708404770384');" style="">  36  import org.broadleafcommerce.core.offer.service.OfferDataItemProvider;                                            </span>
<span class="-6326345691456347408" onmouseenter="enter('-6326345691456347408');" onmouseout="out('-6326345691456347408');" style="">  37  import org.broadleafcommerce.core.offer.service.OfferServiceImpl;                                                 </span>
<span class="2599349157106653381" onmouseenter="enter('2599349157106653381');" onmouseout="out('2599349157106653381');" style="">  38  import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;                                            </span>
<span class="-3097197529305387536" onmouseenter="enter('-3097197529305387536');" onmouseout="out('-3097197529305387536');" style="">  39  import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;                                        </span>
<span class="212527052176527689" onmouseenter="enter('212527052176527689');" onmouseout="out('212527052176527689');" style="">  40  import org.broadleafcommerce.core.offer.service.discount.CandidatePromotionItems;                                 </span>
<span class="4287099423657810905" onmouseenter="enter('4287099423657810905');" onmouseout="out('4287099423657810905');" style="">  41  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateFulfillmentGroupOffer;         </span>
<span class="4826353322748911550" onmouseenter="enter('4826353322748911550');" onmouseout="out('4826353322748911550');" style="">  42  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableFulfillmentGroup;                       </span>
<span class="-7261038068657094491" onmouseenter="enter('-7261038068657094491');" onmouseout="out('-7261038068657094491');" style="">  43  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableItemFactoryImpl;                        </span>
<span class="5738750158392070" onmouseenter="enter('5738750158392070');" onmouseout="out('5738750158392070');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;                           </span>
<span class="8873929720094471664" onmouseenter="enter('8873929720094471664');" onmouseout="out('8873929720094471664');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;                       </span>
<span class="-6456406933954769040" onmouseenter="enter('-6456406933954769040');" onmouseout="out('-6456406933954769040');" style="">  46  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrder;                                  </span>
<span class="-7733804833771661823" onmouseenter="enter('-7733804833771661823');" onmouseout="out('-7733804833771661823');" style="">  47  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItem;                              </span>
<span class="-5253725521220244448" onmouseenter="enter('-5253725521220244448');" onmouseout="out('-5253725521220244448');" style="">  48  import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;                                           </span>
<span class="-4951365057913084569" onmouseenter="enter('-4951365057913084569');" onmouseout="out('-4951365057913084569');" style="">  49  import org.broadleafcommerce.core.order.dao.FulfillmentGroupItemDao;                                              </span>
<span class="-7012758821456487335" onmouseenter="enter('-7012758821456487335');" onmouseout="out('-7012758821456487335');" style="">  50  import org.broadleafcommerce.core.order.dao.OrderItemDao;                                                         </span>
<span class="-6302349778747925467" onmouseenter="enter('-6302349778747925467');" onmouseout="out('-6302349778747925467');" style="">  51  import org.broadleafcommerce.core.order.domain.FulfillmentGroup;                                                  </span>
<span class="-7855842771160128779" onmouseenter="enter('-7855842771160128779');" onmouseout="out('-7855842771160128779');" style="">  52  import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;                                              </span>
<span class="-6039448701992847179" onmouseenter="enter('-6039448701992847179');" onmouseout="out('-6039448701992847179');" style="">  53  import org.broadleafcommerce.core.order.domain.Order;                                                             </span>
<span class="-3117062451881073195" onmouseenter="enter('-3117062451881073195');" onmouseout="out('-3117062451881073195');" style="">  54  import org.broadleafcommerce.core.order.domain.OrderItem;                                                         </span>
<span class="230297408131782266" onmouseenter="enter('230297408131782266');" onmouseout="out('230297408131782266');" style="">  55  import org.broadleafcommerce.core.order.domain.OrderItemPriceDetail;                                              </span>
<span class="1218446574017128210" onmouseenter="enter('1218446574017128210');" onmouseout="out('1218446574017128210');" style="">  56  import org.broadleafcommerce.core.order.domain.OrderMultishipOption;                                              </span>
<span class="5244138541064665880" onmouseenter="enter('5244138541064665880');" onmouseout="out('5244138541064665880');" style="">  57  import org.broadleafcommerce.core.order.domain.OrderMultishipOptionImpl;                                          </span>
<span class="9050710118625717230" onmouseenter="enter('9050710118625717230');" onmouseout="out('9050710118625717230');" style="">  58  import org.broadleafcommerce.core.order.service.FulfillmentGroupService;                                          </span>
<span class="2043331085843421951" onmouseenter="enter('2043331085843421951');" onmouseout="out('2043331085843421951');" style="">  59  import org.broadleafcommerce.core.order.service.OrderItemService;                                                 </span>
<span class="-4438462058374014857" onmouseenter="enter('-4438462058374014857');" onmouseout="out('-4438462058374014857');" style="">  60  import org.broadleafcommerce.core.order.service.OrderMultishipOptionService;                                      </span>
<span class="-4523094285760083742" onmouseenter="enter('-4523094285760083742');" onmouseout="out('-4523094285760083742');" style="">  61  import org.broadleafcommerce.core.order.service.OrderService;                                                     </span>
<span class="426062199469058864" onmouseenter="enter('426062199469058864');" onmouseout="out('426062199469058864');" style="">  62  import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;                                 </span>
<span class="1499051134121889616" onmouseenter="enter('1499051134121889616');" onmouseout="out('1499051134121889616');" style="">  63  import org.broadleafcommerce.profile.core.domain.Address;                                                         </span>
<span class="8043089028015557901" onmouseenter="enter('8043089028015557901');" onmouseout="out('8043089028015557901');" style="">  64  import org.easymock.EasyMock;                                                                                     </span>
<span class="8773851019359685182" onmouseenter="enter('8773851019359685182');" onmouseout="out('8773851019359685182');" style="">  65  import org.easymock.IAnswer;                                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -                                                                                                                  </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  67  import java.math.BigDecimal;                                                                                      </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  68  import java.util.ArrayList;                                                                                       </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  69  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  70  import java.util.List;                                                                                            </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  71  import java.util.TimeZone;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -                                                                                                                  </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -import junit.framework.TestCase;                                                                                  </span>
<span  style="">  74                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  76   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  77   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  78   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  79   */                                                                                                               </span>
<span class="-6422014710110996402" onmouseenter="enter('-6422014710110996402');" onmouseout="out('-6422014710110996402');" style="">  80  public class FulfillmentGroupOfferProcessorTest extends TestCase {                                                </span>
<span  style="">  81                                                                                                                    </span>
<span class="2764411618740579830" onmouseenter="enter('2764411618740579830');" onmouseout="out('2764411618740579830');" style="">  82      protected OfferDao offerDaoMock;                                                                              </span>
<span class="-1028825014202044443" onmouseenter="enter('-1028825014202044443');" onmouseout="out('-1028825014202044443');" style="">  83      protected OrderItemDao orderItemDaoMock;                                                                      </span>
<span class="3942591246150891792" onmouseenter="enter('3942591246150891792');" onmouseout="out('3942591246150891792');" style="">  84      protected OfferServiceImpl offerService;                                                                      </span>
<span class="2155154311276627388" onmouseenter="enter('2155154311276627388');" onmouseout="out('2155154311276627388');" style="">  85      protected final OfferDataItemProvider dataProvider = new OfferDataItemProvider();                             </span>
<span class="-5369679977326057444" onmouseenter="enter('-5369679977326057444');" onmouseout="out('-5369679977326057444');" style="">  86      protected OrderService orderServiceMock;                                                                      </span>
<span class="-2082308031004269425" onmouseenter="enter('-2082308031004269425');" onmouseout="out('-2082308031004269425');" style="">  87      protected OrderItemService orderItemServiceMock;                                                              </span>
<span class="8143262996519322151" onmouseenter="enter('8143262996519322151');" onmouseout="out('8143262996519322151');" style="">  88      protected FulfillmentGroupItemDao fgItemDaoMock;                                                              </span>
<span class="3331618624366763309" onmouseenter="enter('3331618624366763309');" onmouseout="out('3331618624366763309');" style="">  89      protected FulfillmentGroupService fgServiceMock;                                                              </span>
<span class="2038085072144601851" onmouseenter="enter('2038085072144601851');" onmouseout="out('2038085072144601851');" style="">  90      protected OrderMultishipOptionService multishipOptionServiceMock;                                             </span>
<span class="1636757603740185885" onmouseenter="enter('1636757603740185885');" onmouseout="out('1636757603740185885');" style="">  91      protected OfferTimeZoneProcessor offerTimeZoneProcessorMock;                                                  </span>
<span class="-8980537951567645236" onmouseenter="enter('-8980537951567645236');" onmouseout="out('-8980537951567645236');" style="">  92      protected OfferServiceUtilities offerServiceUtilitiesMock;                                                    </span>
<span class="-363767546438432308" onmouseenter="enter('-363767546438432308');" onmouseout="out('-363767546438432308');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +    protected PromotableOfferUtility promotableOfferUtility;                                                      </span>
<span  style="">  94                                                                                                                    </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style="">  95      protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                                     </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  97      /**                                                                                                           </span>
<span class="-1217892123140267909" onmouseenter="enter('-1217892123140267909');" onmouseout="out('-1217892123140267909');" style="">  98       * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and</span>
<span class="-8822842737667556133" onmouseenter="enter('-8822842737667556133');" onmouseout="out('-8822842737667556133');" style="">  99       * system properties service since it uses BLCSystemProperty                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 100       *                                                                                                            </span>
<span class="2670632328160232809" onmouseenter="enter('2670632328160232809');" onmouseout="out('2670632328160232809');" style=""> 101       * @author Phillip Verheyden (phillipuniverse)                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 102       */                                                                                                           </span>
<span class="8403268836763647235" onmouseenter="enter('8403268836763647235');" onmouseout="out('8403268836763647235');" style=""> 103      protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {    </span>
<span class="7280310143433037386" onmouseenter="enter('7280310143433037386');" onmouseout="out('7280310143433037386');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +        public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {            </span>
<span class="386697006679121838" onmouseenter="enter('386697006679121838');" onmouseout="out('386697006679121838');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 +            super(promotableOfferUtility);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 108          @Override                                                                                                 </span>
<span class="-5327199138035207588" onmouseenter="enter('-5327199138035207588');" onmouseout="out('-5327199138035207588');" style=""> 109          protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 110              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112      }                                                                                                             </span>
<span  style=""> 113                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 114      @Override                                                                                                     </span>
<span class="2289017037938349582" onmouseenter="enter('2289017037938349582');" onmouseout="out('2289017037938349582');" style=""> 115      protected void setUp() throws Exception {                                                                     </span>
<span class="-7001064742117532685" onmouseenter="enter('-7001064742117532685');" onmouseout="out('-7001064742117532685');" style=""> 116          offerService = new OfferServiceImpl();                                                                    </span>
<span class="-5376116141285812671" onmouseenter="enter('-5376116141285812671');" onmouseout="out('-5376116141285812671');" style=""> 117          CustomerOfferDao customerOfferDaoMock = EasyMock.createMock(CustomerOfferDao.class);                      </span>
<span class="-570975167499705701" onmouseenter="enter('-570975167499705701');" onmouseout="out('-570975167499705701');" style=""> 118          OfferCodeDao offerCodeDaoMock = EasyMock.createMock(OfferCodeDao.class);                                  </span>
<span class="393627947078248392" onmouseenter="enter('393627947078248392');" onmouseout="out('393627947078248392');" style=""> 119          orderServiceMock = EasyMock.createMock(OrderService.class);                                               </span>
<span class="7274735973437056507" onmouseenter="enter('7274735973437056507');" onmouseout="out('7274735973437056507');" style=""> 120          orderItemDaoMock = EasyMock.createMock(OrderItemDao.class);                                               </span>
<span  style=""> 121                                                                                                                    </span>
<span class="1993264780541814880" onmouseenter="enter('1993264780541814880');" onmouseout="out('1993264780541814880');" style=""> 122          orderItemServiceMock = EasyMock.createMock(OrderItemService.class);                                       </span>
<span class="-3213369057155598174" onmouseenter="enter('-3213369057155598174');" onmouseout="out('-3213369057155598174');" style=""> 123          fgItemDaoMock = EasyMock.createMock(FulfillmentGroupItemDao.class);                                       </span>
<span class="3258640190833853601" onmouseenter="enter('3258640190833853601');" onmouseout="out('3258640190833853601');" style=""> 124          offerDaoMock = EasyMock.createMock(OfferDao.class);                                                       </span>
<span class="6964150545963317885" onmouseenter="enter('6964150545963317885');" onmouseout="out('6964150545963317885');" style=""> 125          fgServiceMock = EasyMock.createMock(FulfillmentGroupService.class);                                       </span>
<span class="-3871783238737974896" onmouseenter="enter('-3871783238737974896');" onmouseout="out('-3871783238737974896');" style=""> 126          multishipOptionServiceMock = EasyMock.createMock(OrderMultishipOptionService.class);                      </span>
<span class="616226227087806826" onmouseenter="enter('616226227087806826');" onmouseout="out('616226227087806826');" style=""> 127          offerServiceUtilitiesMock = EasyMock.createMock(OfferServiceUtilities.class);                             </span>
<span class="-3280473616402059983" onmouseenter="enter('-3280473616402059983');" onmouseout="out('-3280473616402059983');" style=""> 128          offerTimeZoneProcessorMock = EasyMock.createMock(OfferTimeZoneProcessor.class);                           </span>

<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -                                                                                                                  </span>
<span class="-8146860948985884961" onmouseenter="enter('-8146860948985884961');" onmouseout="out('-8146860948985884961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -        fgProcessor = new TestableFulfillmentGroupOfferProcessor();                                               </span>
<span class="-5708051595893590327" onmouseenter="enter('-5708051595893590327');" onmouseout="out('-5708051595893590327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +        promotableOfferUtility = new PromotableOfferUtilityImpl();                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +                                                                                                                  </span>
<span class="-6566235364085313060" onmouseenter="enter('-6566235364085313060');" onmouseout="out('-6566235364085313060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);                         </span>
<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style=""> 134          fgProcessor.setOfferDao(offerDaoMock);                                                                    </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style=""> 135          fgProcessor.setOrderItemDao(orderItemDaoMock);                                                            </span>
<span class="-9198117990764754611" onmouseenter="enter('-9198117990764754611');" onmouseout="out('-9198117990764754611');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                    </span>
<span class="3776294526577008852" onmouseenter="enter('3776294526577008852');" onmouseout="out('3776294526577008852');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +        fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));              </span>
<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style=""> 138          fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                          </span>
<span  style=""> 139                                                                                                                    </span>
<span class="-2101358397833099204" onmouseenter="enter('-2101358397833099204');" onmouseout="out('-2101358397833099204');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -        OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();                        </span>
<span class="3514247750798048226" onmouseenter="enter('3514247750798048226');" onmouseout="out('3514247750798048226');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +        OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);  </span>
<span class="4393308911552043332" onmouseenter="enter('4393308911552043332');" onmouseout="out('4393308911552043332');" style=""> 142          offerServiceUtilities.setOfferDao(offerDaoMock);                                                          </span>
<span class="8672470870156482430" onmouseenter="enter('8672470870156482430');" onmouseout="out('8672470870156482430');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -        offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());                          </span>

<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                                                                                                                  </span>
<span class="-2065747208737510923" onmouseenter="enter('-2065747208737510923');" onmouseout="out('-2065747208737510923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();                                   </span>
<span class="7561232175961587910" onmouseenter="enter('7561232175961587910');" onmouseout="out('7561232175961587910');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +        offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +                                                                                                                  </span>
<span class="-7168324839350089956" onmouseenter="enter('-7168324839350089956');" onmouseout="out('-7168324839350089956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +        OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);             </span>
<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style=""> 149          orderProcessor.setOfferDao(offerDaoMock);                                                                 </span>
<span class="7588180708377269856" onmouseenter="enter('7588180708377269856');" onmouseout="out('7588180708377269856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -        orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                 </span>
<span class="5575229934633988866" onmouseenter="enter('5575229934633988866');" onmouseout="out('5575229934633988866');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +        orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));           </span>
<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style=""> 152          orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                       </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style=""> 153          orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                                     </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style=""> 154          orderProcessor.setOrderItemDao(orderItemDaoMock);                                                         </span>
<span class="-8932862412317704790" onmouseenter="enter('-8932862412317704790');" onmouseout="out('-8932862412317704790');" style=""> 155          orderProcessor.setOfferServiceUtilities(offerServiceUtilities);                                           </span>
<span  style=""> 156                                                                                                                    </span>
<span class="4013547806696404600" onmouseenter="enter('4013547806696404600');" onmouseout="out('4013547806696404600');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -        ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();                                      </span>
<span class="4016707405384637073" onmouseenter="enter('4016707405384637073');" onmouseout="out('4016707405384637073');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +        ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);                </span>
<span class="-7004957386218896406" onmouseenter="enter('-7004957386218896406');" onmouseout="out('-7004957386218896406');" style=""> 159          itemProcessor.setOfferDao(offerDaoMock);                                                                  </span>
<span class="-4774736295542748467" onmouseenter="enter('-4774736295542748467');" onmouseout="out('-4774736295542748467');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -        itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                  </span>
<span class="-2793185480423849018" onmouseenter="enter('-2793185480423849018');" onmouseout="out('-2793185480423849018');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +        itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));            </span>
<span class="-7985735156898326914" onmouseenter="enter('-7985735156898326914');" onmouseout="out('-7985735156898326914');" style=""> 162          itemProcessor.setOrderItemDao(orderItemDaoMock);                                                          </span>
<span class="1873271206223196651" onmouseenter="enter('1873271206223196651');" onmouseout="out('1873271206223196651');" style=""> 163          itemProcessor.setOfferServiceUtilities(offerServiceUtilities);                                            </span>
<span  style=""> 164                                                                                                                    </span>
<span class="-7594314374485898167" onmouseenter="enter('-7594314374485898167');" onmouseout="out('-7594314374485898167');" style=""> 165          offerService.setCustomerOfferDao(customerOfferDaoMock);                                                   </span>
<span class="483175997286853822" onmouseenter="enter('483175997286853822');" onmouseout="out('483175997286853822');" style=""> 166          offerService.setOfferCodeDao(offerCodeDaoMock);                                                           </span>
<span class="-157638129368187663" onmouseenter="enter('-157638129368187663');" onmouseout="out('-157638129368187663');" style=""> 167          offerService.setOfferDao(offerDaoMock);                                                                   </span>
<span class="-2861300639666845512" onmouseenter="enter('-2861300639666845512');" onmouseout="out('-2861300639666845512');" style=""> 168          offerService.setOrderOfferProcessor(orderProcessor);                                                      </span>
<span class="4668119620018038426" onmouseenter="enter('4668119620018038426');" onmouseout="out('4668119620018038426');" style=""> 169          offerService.setItemOfferProcessor(itemProcessor);                                                        </span>
<span class="-4412724488869175480" onmouseenter="enter('-4412724488869175480');" onmouseout="out('-4412724488869175480');" style=""> 170          offerService.setFulfillmentGroupOfferProcessor(fgProcessor);                                              </span>
<span class="-7075295889541966474" onmouseenter="enter('-7075295889541966474');" onmouseout="out('-7075295889541966474');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -        offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());                                   </span>
<span class="-2798583477021709202" onmouseenter="enter('-2798583477021709202');" onmouseout="out('-2798583477021709202');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +        offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));             </span>
<span class="-7013122243510448528" onmouseenter="enter('-7013122243510448528');" onmouseout="out('-7013122243510448528');" style=""> 173          offerService.setOrderService(orderServiceMock);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174      }                                                                                                             </span>
<span  style=""> 175                                                                                                                    </span>
<span class="3027682741895790020" onmouseenter="enter('3027682741895790020');" onmouseout="out('3027682741895790020');" style=""> 176      public void replay() {                                                                                        </span>
<span class="4039967104390893601" onmouseenter="enter('4039967104390893601');" onmouseout="out('4039967104390893601');" style=""> 177          EasyMock.replay(offerDaoMock);                                                                            </span>
<span class="-8438798452743116996" onmouseenter="enter('-8438798452743116996');" onmouseout="out('-8438798452743116996');" style=""> 178          EasyMock.replay(orderItemDaoMock);                                                                        </span>
<span class="-306516478140011318" onmouseenter="enter('-306516478140011318');" onmouseout="out('-306516478140011318');" style=""> 179          EasyMock.replay(orderServiceMock);                                                                        </span>
<span class="-1764805494951210013" onmouseenter="enter('-1764805494951210013');" onmouseout="out('-1764805494951210013');" style=""> 180          EasyMock.replay(orderItemServiceMock);                                                                    </span>
<span class="1127149787736159594" onmouseenter="enter('1127149787736159594');" onmouseout="out('1127149787736159594');" style=""> 181          EasyMock.replay(fgItemDaoMock);                                                                           </span>
<span class="220377317211655869" onmouseenter="enter('220377317211655869');" onmouseout="out('220377317211655869');" style=""> 182          EasyMock.replay(fgServiceMock);                                                                           </span>
<span class="7141248576860687210" onmouseenter="enter('7141248576860687210');" onmouseout="out('7141248576860687210');" style=""> 183          EasyMock.replay(multishipOptionServiceMock);                                                              </span>
<span class="1625398624145697967" onmouseenter="enter('1625398624145697967');" onmouseout="out('1625398624145697967');" style=""> 184          EasyMock.replay(offerTimeZoneProcessorMock);                                                              </span>
<span class="7441173554159837333" onmouseenter="enter('7441173554159837333');" onmouseout="out('7441173554159837333');" style=""> 185          EasyMock.replay(offerServiceUtilitiesMock);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="6267001839391766981" onmouseenter="enter('6267001839391766981');" onmouseout="out('6267001839391766981');" style=""> 188      public void verify() {                                                                                        </span>
<span class="6756940960390862422" onmouseenter="enter('6756940960390862422');" onmouseout="out('6756940960390862422');" style=""> 189          EasyMock.verify(offerDaoMock);                                                                            </span>
<span class="-5117344946758939057" onmouseenter="enter('-5117344946758939057');" onmouseout="out('-5117344946758939057');" style=""> 190          EasyMock.verify(orderItemDaoMock);                                                                        </span>
<span class="-6538245312297088944" onmouseenter="enter('-6538245312297088944');" onmouseout="out('-6538245312297088944');" style=""> 191          EasyMock.verify(orderServiceMock);                                                                        </span>
<span class="4656187310788509663" onmouseenter="enter('4656187310788509663');" onmouseout="out('4656187310788509663');" style=""> 192          EasyMock.verify(orderItemServiceMock);                                                                    </span>
<span class="-3344344690958109982" onmouseenter="enter('-3344344690958109982');" onmouseout="out('-3344344690958109982');" style=""> 193          EasyMock.verify(fgItemDaoMock);                                                                           </span>
<span class="-7107457974865616724" onmouseenter="enter('-7107457974865616724');" onmouseout="out('-7107457974865616724');" style=""> 194          EasyMock.verify(fgServiceMock);                                                                           </span>
<span class="3082501288673197520" onmouseenter="enter('3082501288673197520');" onmouseout="out('3082501288673197520');" style=""> 195          EasyMock.verify(multishipOptionServiceMock);                                                              </span>
<span class="8968216054532738001" onmouseenter="enter('8968216054532738001');" onmouseout="out('8968216054532738001');" style=""> 196          EasyMock.verify(offerTimeZoneProcessorMock);                                                              </span>
<span class="1970601797097358226" onmouseenter="enter('1970601797097358226');" onmouseout="out('1970601797097358226');" style=""> 197          EasyMock.verify(offerServiceUtilitiesMock);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198      }                                                                                                             </span>
<span  style=""> 199                                                                                                                    </span>
<span class="4350196711973577847" onmouseenter="enter('4350196711973577847');" onmouseout="out('4350196711973577847');" style=""> 200      public void testApplyAllFulfillmentGroupOffersWithOrderItemOffers() throws Exception {                        </span>
<span class="8446165972037001535" onmouseenter="enter('8446165972037001535');" onmouseout="out('8446165972037001535');" style=""> 201          final ThreadLocal&lt;Order&gt; myOrder = new ThreadLocal&lt;Order&gt;();                                              </span>
<span class="3688914841313020601" onmouseenter="enter('3688914841313020601');" onmouseout="out('3688914841313020601');" style=""><abbr title=" 202          EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAnswer()).anyTimes();"> 202          EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrðŸ”µ</abbr></span>
<span  style=""> 203                                                                                                                    </span>
<span class="244050499009988211" onmouseenter="enter('244050499009988211');" onmouseout="out('244050499009988211');" style=""><abbr title=" 204          EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrderItemQualifierAnswer()).atLeastOnce();"> 204          EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrdeðŸ”µ</abbr></span>
<span  style=""> 205                                                                                                                    </span>
<span class="-4805711593793558927" onmouseenter="enter('-4805711593793558927');" onmouseout="out('-4805711593793558927');" style=""><abbr title=" 206          EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getAddItemToFulfillmentGroupAnswer()).anyTimes();"> 206          EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EðŸ”µ</abbr></span>
<span class="-4648578783612235576" onmouseenter="enter('-4648578783612235576');" onmouseout="out('-4648578783612235576');" style=""><abbr title=" 207          EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getRemoveItemFromOrderAnswer()).anyTimes();"> 207          EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eðŸ”µ</abbr></span>
<span class="-25100646963641968" onmouseenter="enter('-25100646963641968');" onmouseout="out('-25100646963641968');" style=""><abbr title=" 208          EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OfferDataItemProvider.getSaveOrderAnswer()).anyTimes();"> 208          EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OðŸ”µ</abbr></span>
<span  style=""> 209                                                                                                                    </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 210          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 210          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 211          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 211          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.clasðŸ”µ</abbr></span>
<span  style=""> 212                                                                                                                    </span>
<span class="2160564019413082164" onmouseenter="enter('2160564019413082164');" onmouseout="out('2160564019413082164');" style=""> 213          EasyMock.expect(orderServiceMock.getAutomaticallyMergeLikeItems()).andReturn(true).anyTimes();            </span>
<span class="-8884522234726007395" onmouseenter="enter('-8884522234726007395');" onmouseout="out('-8884522234726007395');" style=""><abbr title=" 214          EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemProvider.getSaveOrderItemAnswer()).anyTimes();"> 214          EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemðŸ”µ</abbr></span>
<span class="-3554631046904274751" onmouseenter="enter('-3554631046904274751');" onmouseout="out('-3554631046904274751');" style=""><abbr title=" 215          EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProvider.getSaveFulfillmentGroupItemAnswer()).anyTimes();"> 215          EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProviðŸ”µ</abbr></span>
<span  style=""> 216                                                                                                                    </span>
<span class="3313434268437563429" onmouseenter="enter('3313434268437563429');" onmouseout="out('3313434268437563429');" style=""><abbr title=" 217          EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAdjustmentAnswer()).anyTimes();"> 217          EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCrðŸ”µ</abbr></span>
<span class="-3718636667900446110" onmouseenter="enter('-3718636667900446110');" onmouseout="out('-3718636667900446110');" style=""><abbr title=" 218          EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupAdjustmentAnswer()).anyTimes();"> 218          EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateðŸ”µ</abbr></span>
<span  style=""> 219                                                                                                                    </span>
<span class="-3815074675149067237" onmouseenter="enter('-3815074675149067237');" onmouseout="out('-3815074675149067237');" style=""> 220          EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;Order&gt;() {</span>
<span  style=""> 221                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 222              @Override                                                                                             </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 223              public Order answer() throws Throwable {                                                              </span>
<span class="-2641290802290262879" onmouseenter="enter('-2641290802290262879');" onmouseout="out('-2641290802290262879');" style=""> 224                  return myOrder.get();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 226          }).anyTimes();                                                                                            </span>
<span  style=""> 227                                                                                                                    </span>
<span class="2031702441279524669" onmouseenter="enter('2031702441279524669');" onmouseout="out('2031702441279524669');" style=""><abbr title=" 228          EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;List&lt;OrderMultishipOption&gt;&gt;() {"> 228          EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(ðŸ”µ</abbr></span>
<span  style=""> 229                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 230              @Override                                                                                             </span>
<span class="4982536128511672004" onmouseenter="enter('4982536128511672004');" onmouseout="out('4982536128511672004');" style=""> 231              public List&lt;OrderMultishipOption&gt; answer() throws Throwable {                                         </span>
<span class="3348167234255574763" onmouseenter="enter('3348167234255574763');" onmouseout="out('3348167234255574763');" style=""> 232                  List&lt;OrderMultishipOption&gt; options = new ArrayList&lt;OrderMultishipOption&gt;();                       </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -                PromotableOrder order = dataProvider.createBasicPromotableOrder();                                </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 234 +                PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);          </span>
<span class="-6747846520377446395" onmouseenter="enter('-6747846520377446395');" onmouseout="out('-6747846520377446395');" style=""> 235                  for (FulfillmentGroup fg : order.getOrder().getFulfillmentGroups()) {                             </span>
<span class="-6367521286140114289" onmouseenter="enter('-6367521286140114289');" onmouseout="out('-6367521286140114289');" style=""> 236                      Address address = fg.getAddress();                                                            </span>
<span class="8028460309176757050" onmouseenter="enter('8028460309176757050');" onmouseout="out('8028460309176757050');" style=""> 237                      for (FulfillmentGroupItem fgItem : fg.getFulfillmentGroupItems()) {                           </span>
<span class="8402583593129976695" onmouseenter="enter('8402583593129976695');" onmouseout="out('8402583593129976695');" style=""> 238                          for (int j = 0; j &lt; fgItem.getQuantity(); j++) {                                          </span>
<span class="3921661458783293685" onmouseenter="enter('3921661458783293685');" onmouseout="out('3921661458783293685');" style=""> 239                              OrderMultishipOption option = new OrderMultishipOptionImpl();                         </span>
<span class="6971594022266833915" onmouseenter="enter('6971594022266833915');" onmouseout="out('6971594022266833915');" style=""> 240                              option.setOrder(order.getOrder());                                                    </span>
<span class="-7842023912465695186" onmouseenter="enter('-7842023912465695186');" onmouseout="out('-7842023912465695186');" style=""> 241                              option.setAddress(address);                                                           </span>
<span class="-8979996557527707436" onmouseenter="enter('-8979996557527707436');" onmouseout="out('-8979996557527707436');" style=""> 242                              option.setOrderItem(fgItem.getOrderItem());                                           </span>
<span class="3662213946586141634" onmouseenter="enter('3662213946586141634');" onmouseout="out('3662213946586141634');" style=""> 243                              options.add(option);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246                  }                                                                                                 </span>
<span  style=""> 247                                                                                                                    </span>
<span class="7754614799802233964" onmouseenter="enter('7754614799802233964');" onmouseout="out('7754614799802233964');" style=""> 248                  return options;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 250          }).anyTimes();                                                                                            </span>
<span  style=""> 251                                                                                                                    </span>
<span class="5730763888734231228" onmouseenter="enter('5730763888734231228');" onmouseout="out('5730763888734231228');" style=""> 252          multishipOptionServiceMock.deleteAllOrderMultishipOptions(EasyMock.isA(Order.class));                     </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 253          EasyMock.expectLastCall().anyTimes();                                                                     </span>
<span class="-2684793509385343472" onmouseenter="enter('-2684793509385343472');" onmouseout="out('-2684793509385343472');" style=""><abbr title=" 254          EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eq(false))).andAnswer(new IAnswer&lt;Order&gt;() {"> 254          EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eðŸ”µ</abbr></span>
<span  style=""> 255                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 256              @Override                                                                                             </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 257              public Order answer() throws Throwable {                                                              </span>
<span class="-2361682080301650618" onmouseenter="enter('-2361682080301650618');" onmouseout="out('-2361682080301650618');" style=""> 258                  Order order = (Order) EasyMock.getCurrentArguments()[0];                                          </span>
<span class="6377062998999459231" onmouseenter="enter('6377062998999459231');" onmouseout="out('6377062998999459231');" style=""><abbr title=" 259                  order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups().get(1).getFulfillmentGroupItems());"> 259                  order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups()ðŸ”µ</abbr></span>
<span class="8328438890662847465" onmouseenter="enter('8328438890662847465');" onmouseout="out('8328438890662847465');" style=""> 260                  order.getFulfillmentGroups().remove(order.getFulfillmentGroups().get(1));                         </span>
<span  style=""> 261                                                                                                                    </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 262                  return order;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 264          }).anyTimes();                                                                                            </span>
<span class="7005207656442723333" onmouseenter="enter('7005207656442723333');" onmouseout="out('7005207656442723333');" style=""><abbr title=" 265          EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnswer()).anyTimes();"> 265          EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnsweðŸ”µ</abbr></span>
<span class="3552856255510166668" onmouseenter="enter('3552856255510166668');" onmouseout="out('3552856255510166668');" style=""> 266          fgItemDaoMock.delete(EasyMock.isA(FulfillmentGroupItem.class));                                           </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 267          EasyMock.expectLastCall().anyTimes();                                                                     </span>
<span class="602433099109498087" onmouseenter="enter('602433099109498087');" onmouseout="out('602433099109498087');" style=""><abbr title=" 268          EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.getTimeZone(&quot;CST&quot;)).anyTimes();"> 268          EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.ðŸ”µ</abbr></span>
<span  style=""> 269                                                                                                                    </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 270          replay();                                                                                                 </span>
<span  style=""> 271                                                                                                                    </span>
<span class="-1327825397201902636" onmouseenter="enter('-1327825397201902636');" onmouseout="out('-1327825397201902636');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -        PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();                              </span>
<span class="5984499010113424780" onmouseenter="enter('5984499010113424780');" onmouseout="out('5984499010113424780');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 273 +        PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);        </span>
<span class="-396343315567854895" onmouseenter="enter('-396343315567854895');" onmouseout="out('-396343315567854895');" style=""> 274          Order order = promotableOrder.getOrder();                                                                 </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 275          myOrder.set(promotableOrder.getOrder());                                                                  </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 276          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 276          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 277          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 277          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 278          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 278          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 279          offers.get(1).setName(&quot;secondOffer&quot;);                                                                     </span>
<span  style=""> 280                                                                                                                    </span>
<span class="-374141704093766947" onmouseenter="enter('-374141704093766947');" onmouseout="out('-374141704093766947');" style=""> 281          offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(                                          </span>
<span class="-971526457565278793" onmouseenter="enter('-971526457565278793');" onmouseout="out('-971526457565278793');" style=""> 282                  &quot;order.subTotal.getAmount()&gt;20&quot;,                                                                  </span>
<span class="8626574580727552658" onmouseenter="enter('8626574580727552658');" onmouseout="out('8626574580727552658');" style=""> 283                  OfferDiscountType.PERCENT_OFF,                                                                    </span>
<span class="-1086407973911983614" onmouseenter="enter('-1086407973911983614');" onmouseout="out('-1086407973911983614');" style=""><abbr title=" 284                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;,"> 284                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eðŸ”µ</abbr></span>
<span class="-6157256577419644919" onmouseenter="enter('-6157256577419644919');" onmouseout="out('-6157256577419644919');" style=""><abbr title=" 285                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;"> 285                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eðŸ”µ</abbr></span>
<span class="3699784701886273761" onmouseenter="enter('3699784701886273761');" onmouseout="out('3699784701886273761');" style=""> 286                  ));                                                                                               </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 287          offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                               </span>
<span  style=""> 288                                                                                                                    </span>
<span class="-5783701790519827054" onmouseenter="enter('-5783701790519827054');" onmouseout="out('-5783701790519827054');" style=""> 289          offers.get(0).setTotalitarianOffer(true);                                                                 </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 290          offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());               </span>
<span  style=""> 291                                                                                                                    </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 292          int fgAdjustmentCount = 0;                                                                                </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 293          for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                                </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 294              fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295          }                                                                                                         </span>
<span class="-6281142585732833119" onmouseenter="enter('-6281142585732833119');" onmouseout="out('-6281142585732833119');" style=""><abbr title=" 296          //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order item offers"> 296          //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order iðŸ”µ</abbr></span>
<span class="-7018201492040868931" onmouseenter="enter('-7018201492040868931');" onmouseout="out('-7018201492040868931');" style=""> 297          // - it is therefore ignored                                                                              </span>
<span class="8464783908245837933" onmouseenter="enter('8464783908245837933');" onmouseout="out('8464783908245837933');" style=""> 298          //However, the second combinable fg offer is allowed to be applied.                                       </span>
<span class="1322310588171640590" onmouseenter="enter('1322310588171640590');" onmouseout="out('1322310588171640590');" style=""> 299          assertTrue(fgAdjustmentCount == 1);                                                                       </span>
<span  style=""> 300                                                                                                                    </span>
<span class="7677156014156700928" onmouseenter="enter('7677156014156700928');" onmouseout="out('7677156014156700928');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -        promotableOrder = dataProvider.createBasicPromotableOrder();                                              </span>
<span class="-1191672713468750443" onmouseenter="enter('-1191672713468750443');" onmouseout="out('-1191672713468750443');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 302 +        promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                        </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 303          myOrder.set(promotableOrder.getOrder());                                                                  </span>
<span class="4605867479195622271" onmouseenter="enter('4605867479195622271');" onmouseout="out('4605867479195622271');" style=""> 304          offers.get(2).setValue(new BigDecimal(&quot;1&quot;));                                                              </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 306          offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                               </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 307          offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());               </span>
<span  style=""> 308                                                                                                                    </span>
<span class="5070682841290639966" onmouseenter="enter('5070682841290639966');" onmouseout="out('5070682841290639966');" style=""> 309          fgAdjustmentCount = 0;                                                                                    </span>
<span class="-1030185999544814128" onmouseenter="enter('-1030185999544814128');" onmouseout="out('-1030185999544814128');" style=""> 310          order = promotableOrder.getOrder();                                                                       </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 311          for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                                </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 312              fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313          }                                                                                                         </span>
<span  style=""> 314                                                                                                                    </span>
<span class="-6528829480981189501" onmouseenter="enter('-6528829480981189501');" onmouseout="out('-6528829480981189501');" style=""><abbr title=" 315          //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fg offer is applied"> 315          //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fgðŸ”µ</abbr></span>
<span class="-8173222409402387748" onmouseenter="enter('-8173222409402387748');" onmouseout="out('-8173222409402387748');" style=""> 316          //and the order item offers are removed                                                                   </span>
<span class="3307702501962124755" onmouseenter="enter('3307702501962124755');" onmouseout="out('3307702501962124755');" style=""> 317          assertTrue(fgAdjustmentCount == 2);                                                                       </span>
<span  style=""> 318                                                                                                                    </span>
<span class="-2665219164306343886" onmouseenter="enter('-2665219164306343886');" onmouseout="out('-2665219164306343886');" style=""> 319          int itemAdjustmentCount = 0;                                                                              </span>
<span class="820796442257070700" onmouseenter="enter('820796442257070700');" onmouseout="out('820796442257070700');" style=""> 320          for (OrderItem item : order.getOrderItems()) {                                                            </span>
<span class="773323050474809935" onmouseenter="enter('773323050474809935');" onmouseout="out('773323050474809935');" style=""> 321              for (OrderItemPriceDetail detail : item.getOrderItemPriceDetails()) {                                 </span>
<span class="-2721944390925153219" onmouseenter="enter('-2721944390925153219');" onmouseout="out('-2721944390925153219');" style=""> 322                  itemAdjustmentCount += detail.getOrderItemPriceDetailAdjustments().size();                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324          }                                                                                                         </span>
<span  style=""> 325                                                                                                                    </span>
<span class="-5059339364425280634" onmouseenter="enter('-5059339364425280634');" onmouseout="out('-5059339364425280634');" style=""> 326          //Confirm that the order item offers are removed                                                          </span>
<span class="8413015744603539595" onmouseenter="enter('8413015744603539595');" onmouseout="out('8413015744603539595');" style=""> 327          assertTrue(itemAdjustmentCount == 0);                                                                     </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 328          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329      }                                                                                                             </span>
<span  style=""> 330                                                                                                                    </span>
<span class="5292901739910789200" onmouseenter="enter('5292901739910789200');" onmouseout="out('5292901739910789200');" style=""> 331      public void testApplyAllFulfillmentGroupOffers() {                                                            </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 332          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 332          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 333          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 333          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.clasðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 334          replay();                                                                                                 </span>
<span  style=""> 335                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -        PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 337 +        PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                  </span>
<span  style=""> 338                                                                                                                    </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 339          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 339          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 340          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 340          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 341          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 342                                                                                                                    </span>
<span class="-8566543852517619753" onmouseenter="enter('-8566543852517619753');" onmouseout="out('-8566543852517619753');" style=""> 343          boolean offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);                </span>
<span  style=""> 344                                                                                                                    </span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 345          assertTrue(offerApplied);                                                                                 </span>
<span  style=""> 346                                                                                                                    </span>
<span class="-7443356352803382403" onmouseenter="enter('-7443356352803382403');" onmouseout="out('-7443356352803382403');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 347 -        order = dataProvider.createBasicPromotableOrder();                                                        </span>
<span class="485587340594496069" onmouseenter="enter('485587340594496069');" onmouseout="out('485587340594496069');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 348 +        order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                                  </span>
<span  style=""> 349                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 350          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-2396210347480358039" onmouseenter="enter('-2396210347480358039');" onmouseout="out('-2396210347480358039');" style=""><abbr title=" 351          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 351          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 352          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 352          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 353          offers.get(1).setName(&quot;secondOffer&quot;);                                                                     </span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 354          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span class="1761556730467108563" onmouseenter="enter('1761556730467108563');" onmouseout="out('1761556730467108563');" style=""> 355          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(1));                      </span>
<span  style=""> 356                                                                                                                    </span>
<span class="2518449647151254078" onmouseenter="enter('2518449647151254078');" onmouseout="out('2518449647151254078');" style=""> 357          offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);                        </span>
<span  style=""> 358                                                                                                                    </span>
<span class="8343302181900945855" onmouseenter="enter('8343302181900945855');" onmouseout="out('8343302181900945855');" style=""><abbr title=" 359          //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfillment groups"> 359          //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfðŸ”µ</abbr></span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 360          assertTrue(offerApplied);                                                                                 </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 361          int fgAdjustmentCount = 0;                                                                                </span>
<span class="-1134830134613695083" onmouseenter="enter('-1134830134613695083');" onmouseout="out('-1134830134613695083');" style=""> 362          for (PromotableFulfillmentGroup fg : order.getFulfillmentGroups()) {                                      </span>
<span class="5611483739197685885" onmouseenter="enter('5611483739197685885');" onmouseout="out('5611483739197685885');" style=""> 363              fgAdjustmentCount += fg.getCandidateFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 364          }                                                                                                         </span>
<span class="6786894656890298013" onmouseenter="enter('6786894656890298013');" onmouseout="out('6786894656890298013');" style=""> 365          assertTrue(fgAdjustmentCount == 3);                                                                       </span>
<span  style=""> 366                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 367          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368      }                                                                                                             </span>
<span  style=""> 369                                                                                                                    </span>
<span class="-6111721081814302723" onmouseenter="enter('-6111721081814302723');" onmouseout="out('-6111721081814302723');" style=""> 370      public void testFilterFulfillmentGroupLevelOffer() {                                                          </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 371          replay();                                                                                                 </span>
<span  style=""> 372                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 373 -        PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 374 +        PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                  </span>
<span  style=""> 375                                                                                                                    </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 376          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 376          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 377          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 377          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 378          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 379                                                                                                                    </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 380          //test that the valid fg offer is included                                                                </span>
<span class="-68824863773413969" onmouseenter="enter('-68824863773413969');" onmouseout="out('-68824863773413969');" style=""> 381          //No item criteria, so each fulfillment group applies                                                     </span>
<span class="8944166164976093148" onmouseenter="enter('8944166164976093148');" onmouseout="out('8944166164976093148');" style=""> 382          assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));       </span>
<span  style=""> 383                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 384          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-794484836397434919" onmouseenter="enter('-794484836397434919');" onmouseout="out('-794484836397434919');" style=""><abbr title=" 385          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 385          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 386          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 387                                                                                                                    </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 388          //test that the valid fg offer is included                                                                </span>
<span class="-5258373286153459716" onmouseenter="enter('-5258373286153459716');" onmouseout="out('-5258373286153459716');" style=""> 389          //only 1 fulfillment group has qualifying items                                                           </span>
<span class="-786785952090327245" onmouseenter="enter('-786785952090327245');" onmouseout="out('-786785952090327245');" style=""> 390          assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));       </span>
<span  style=""> 391                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 392          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-1175553281482923867" onmouseenter="enter('-1175553281482923867');" onmouseout="out('-1175553281482923867');" style=""><abbr title=" 393          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 393          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 394          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 395                                                                                                                    </span>
<span class="8365537088151996583" onmouseenter="enter('8365537088151996583');" onmouseout="out('8365537088151996583');" style=""> 396          //test that the invalid fg offer is excluded - zipcode is wrong                                           </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 397          assertTrue(qualifiedOffers.size() == 0);                                                                  </span>
<span  style=""> 398                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 399          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-1725928204111497608" onmouseenter="enter('-1725928204111497608');" onmouseout="out('-1725928204111497608');" style=""><abbr title=" 400          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 400          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 401          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 402                                                                                                                    </span>
<span class="-6532959924497274331" onmouseenter="enter('-6532959924497274331');" onmouseout="out('-6532959924497274331');" style=""> 403          //test that the invalid fg offer is excluded - no qualifying items                                        </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 404          assertTrue(qualifiedOffers.size() == 0);                                                                  </span>
<span  style=""> 405                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 406          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407      }                                                                                                             </span>
<span  style=""> 408                                                                                                                    </span>
<span class="-4776997419015764151" onmouseenter="enter('-4776997419015764151');" onmouseout="out('-4776997419015764151');" style=""> 409      public void testCouldOfferApplyToFulfillmentGroup() {                                                         </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 410          replay();                                                                                                 </span>
<span  style=""> 411                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 412 -        PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 413 +        PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                  </span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 414          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 414          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="6925194278348061796" onmouseenter="enter('6925194278348061796');" onmouseout="out('6925194278348061796');" style=""><abbr title=" 415          boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 415          boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGrouðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 416          //test that the valid fg offer is included                                                                </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 417          assertTrue(couldApply);                                                                                   </span>
<span  style=""> 418                                                                                                                    </span>
<span class="-3097227128962316937" onmouseenter="enter('-3097227128962316937');" onmouseout="out('-3097227128962316937');" style=""><abbr title=" 419          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF);"> 419          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalðŸ”µ</abbr></span>
<span class="-1233560991880639261" onmouseenter="enter('-1233560991880639261');" onmouseout="out('-1233560991880639261');" style=""><abbr title=" 420          couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 420          couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().getðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 421          //test that the invalid fg offer is excluded                                                              </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 422          assertFalse(couldApply);                                                                                  </span>
<span  style=""> 423                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 424          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425      }                                                                                                             </span>
<span  style=""> 426                                                                                                                    </span>
<span class="3929316778716445185" onmouseenter="enter('3929316778716445185');" onmouseout="out('3929316778716445185');" style=""> 427      public void testCouldOrderItemMeetOfferRequirement() {                                                        </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 428          replay();                                                                                                 </span>
<span  style=""> 429                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 430 -        PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 431 +        PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                  </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 432          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 432          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulðŸ”µ</abbr></span>
<span class="1501673451570831850" onmouseenter="enter('1501673451570831850');" onmouseout="out('1501673451570831850');" style=""> 433          OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();       </span>
<span class="7919750782802558587" onmouseenter="enter('7919750782802558587');" onmouseout="out('7919750782802558587');" style=""><abbr title=" 434          boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 434          boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 435          //test that the valid fg offer is included                                                                </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 436          assertTrue(couldApply);                                                                                   </span>
<span  style=""> 437                                                                                                                    </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 438          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 438          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="2238137642305281390" onmouseenter="enter('2238137642305281390');" onmouseout="out('2238137642305281390');" style=""> 439          xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();                                   </span>
<span class="-3043998037798990151" onmouseenter="enter('-3043998037798990151');" onmouseout="out('-3043998037798990151');" style=""><abbr title=" 440          couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 440          couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 441          //test that the invalid fg offer is excluded                                                              </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 442          assertFalse(couldApply);                                                                                  </span>
<span  style=""> 443                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 444          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 445      }                                                                                                             </span>
<span  style=""> 446                                                                                                                    </span>
<span class="-4499124276559625962" onmouseenter="enter('-4499124276559625962');" onmouseout="out('-4499124276559625962');" style=""> 447      public void testCouldOfferApplyToOrderItems() {                                                               </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 448          replay();                                                                                                 </span>
<span  style=""> 449                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 450 -        PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>
<span class="2989998759169393992" onmouseenter="enter('2989998759169393992');" onmouseout="out('2989998759169393992');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 451 +        PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);                  </span>
<span  style=""> 452                                                                                                                    </span>
<span class="-4222545078163101091" onmouseenter="enter('-4222545078163101091');" onmouseout="out('-4222545078163101091');" style=""> 453          List&lt;PromotableOrderItem&gt; orderItems = new ArrayList&lt;PromotableOrderItem&gt;();                              </span>
<span class="-7372483979901719352" onmouseenter="enter('-7372483979901719352');" onmouseout="out('-7372483979901719352');" style=""> 454          for (PromotableOrderItem orderItem : order.getDiscountableOrderItems()) {                                 </span>
<span class="5423314879443576267" onmouseenter="enter('5423314879443576267');" onmouseout="out('5423314879443576267');" style=""> 455              orderItems.add(orderItem);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456          }                                                                                                         </span>
<span  style=""> 457                                                                                                                    </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 458          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 458          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulðŸ”µ</abbr></span>
<span class="8410448623592275924" onmouseenter="enter('8410448623592275924');" onmouseout="out('8410448623592275924');" style=""> 459          CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);  </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 460          //test that the valid fg offer is included                                                                </span>
<span class="4437229577970519009" onmouseenter="enter('4437229577970519009');" onmouseout="out('4437229577970519009');" style=""> 461          assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);        </span>
<span  style=""> 462                                                                                                                    </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 463          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 463          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="-3576845332244688046" onmouseenter="enter('-3576845332244688046');" onmouseout="out('-3576845332244688046');" style=""> 464          candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);                          </span>
<span class="6941245118706647267" onmouseenter="enter('6941245118706647267');" onmouseout="out('6941245118706647267');" style=""> 465          //test that the invalid fg offer is excluded because there are no qualifying items                        </span>
<span class="-265242688274418245" onmouseenter="enter('-265242688274418245');" onmouseout="out('-265242688274418245');" style=""> 466          assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);       </span>
<span  style=""> 467                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 468          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469      }                                                                                                             </span>
<span  style=""> 470                                                                                                                    </span>
<span class="5648347102432971432" onmouseenter="enter('5648347102432971432');" onmouseout="out('5648347102432971432');" style=""> 471      public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; {        </span>
<span  style=""> 472                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 473          @Override                                                                                                 </span>
<span class="-3723008217761904240" onmouseenter="enter('-3723008217761904240');" onmouseout="out('-3723008217761904240');" style=""> 474          public CandidateFulfillmentGroupOffer answer() throws Throwable {                                         </span>
<span class="-8755543066605634487" onmouseenter="enter('-8755543066605634487');" onmouseout="out('-8755543066605634487');" style=""> 475              return new CandidateFulfillmentGroupOfferImpl();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476          }                                                                                                         </span>
<span  style=""> 477                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478      }                                                                                                             </span>
<span  style=""> 479                                                                                                                    </span>
<span class="3886526384953801028" onmouseenter="enter('3886526384953801028');" onmouseout="out('3886526384953801028');" style=""> 480      public class FulfillmentGroupAdjustmentAnswer implements IAnswer&lt;FulfillmentGroupAdjustment&gt; {                </span>
<span  style=""> 481                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 482          @Override                                                                                                 </span>
<span class="2396386951594711402" onmouseenter="enter('2396386951594711402');" onmouseout="out('2396386951594711402');" style=""> 483          public FulfillmentGroupAdjustment answer() throws Throwable {                                             </span>
<span class="4220759534941126036" onmouseenter="enter('4220759534941126036');" onmouseout="out('4220759534941126036');" style=""> 484              return new FulfillmentGroupAdjustmentImpl();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485          }                                                                                                         </span>
<span  style=""> 486                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 487      }                                                                                                             </span>
<span  style=""> 488                                                                                                                    </span>
<span class="1687502207616012454" onmouseenter="enter('1687502207616012454');" onmouseout="out('1687502207616012454');" style=""> 489      public class CandidateItemOfferAnswer implements IAnswer&lt;CandidateItemOffer&gt; {                                </span>
<span  style=""> 490                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 491          @Override                                                                                                 </span>
<span class="2347184973793483651" onmouseenter="enter('2347184973793483651');" onmouseout="out('2347184973793483651');" style=""> 492          public CandidateItemOffer answer() throws Throwable {                                                     </span>
<span class="7644422100596500085" onmouseenter="enter('7644422100596500085');" onmouseout="out('7644422100596500085');" style=""> 493              return new CandidateItemOfferImpl();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494          }                                                                                                         </span>
<span  style=""> 495                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496      }                                                                                                             </span>
<span  style=""> 497                                                                                                                    </span>
<span class="6834818405609520876" onmouseenter="enter('6834818405609520876');" onmouseout="out('6834818405609520876');" style=""> 498      public class OrderItemAdjustmentAnswer implements IAnswer&lt;OrderItemAdjustment&gt; {                              </span>
<span  style=""> 499                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 500          @Override                                                                                                 </span>
<span class="4861248105020273136" onmouseenter="enter('4861248105020273136');" onmouseout="out('4861248105020273136');" style=""> 501          public OrderItemAdjustment answer() throws Throwable {                                                    </span>
<span class="7697130786892874769" onmouseenter="enter('7697130786892874769');" onmouseout="out('7697130786892874769');" style=""> 502              return new OrderItemAdjustmentImpl();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503          }                                                                                                         </span>
<span  style=""> 504                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 505      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-5062573030309236877" onmouseenter="enter('-5062573030309236877');" onmouseout="out('-5062573030309236877');" style="">   3   * BroadleafCommerce Framework                                                                                    </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-4156106492343801428" onmouseenter="enter('-4156106492343801428');" onmouseout="out('-4156106492343801428');" style="">  18  package org.broadleafcommerce.core.offer.service.processor;                                                       </span>


<span  style="">  19                                                                                                                    </span>
<span class="-1492144387614747576" onmouseenter="enter('-1492144387614747576');" onmouseout="out('-1492144387614747576');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  20 +import org.broadleafcommerce.common.service.GenericEntityService;                                                 </span>
<span class="6205208880685044389" onmouseenter="enter('6205208880685044389');" onmouseout="out('6205208880685044389');" style="">  21  import org.broadleafcommerce.core.offer.dao.CustomerOfferDao;                                                     </span>
<span class="-7911436562744873568" onmouseenter="enter('-7911436562744873568');" onmouseout="out('-7911436562744873568');" style="">  22  import org.broadleafcommerce.core.offer.dao.OfferCodeDao;                                                         </span>
<span class="-2793633202507663758" onmouseenter="enter('-2793633202507663758');" onmouseout="out('-2793633202507663758');" style="">  23  import org.broadleafcommerce.core.offer.dao.OfferDao;                                                             </span>
<span class="796126113999839594" onmouseenter="enter('796126113999839594');" onmouseout="out('796126113999839594');" style="">  24  import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;                                    </span>
<span class="2150723484434835298" onmouseenter="enter('2150723484434835298');" onmouseout="out('2150723484434835298');" style="">  25  import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;                                </span>
<span class="4011152823911960428" onmouseenter="enter('4011152823911960428');" onmouseout="out('4011152823911960428');" style="">  26  import org.broadleafcommerce.core.offer.domain.CandidateItemOffer;                                                </span>
<span class="-735428748329738672" onmouseenter="enter('-735428748329738672');" onmouseout="out('-735428748329738672');" style="">  27  import org.broadleafcommerce.core.offer.domain.CandidateItemOfferImpl;                                            </span>
<span class="5599608658353832247" onmouseenter="enter('5599608658353832247');" onmouseout="out('5599608658353832247');" style="">  28  import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;                                        </span>
<span class="6308539507696801789" onmouseenter="enter('6308539507696801789');" onmouseout="out('6308539507696801789');" style="">  29  import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;                                    </span>
<span class="4081153142019712377" onmouseenter="enter('4081153142019712377');" onmouseout="out('4081153142019712377');" style="">  30  import org.broadleafcommerce.core.offer.domain.Offer;                                                             </span>
<span class="-7025591891527881733" onmouseenter="enter('-7025591891527881733');" onmouseout="out('-7025591891527881733');" style="">  31  import org.broadleafcommerce.core.offer.domain.OfferImpl;                                                         </span>
<span class="1133170227846016200" onmouseenter="enter('1133170227846016200');" onmouseout="out('1133170227846016200');" style="">  32  import org.broadleafcommerce.core.offer.domain.OfferQualifyingCriteriaXref;                                       </span>
<span class="-1124625745990626401" onmouseenter="enter('-1124625745990626401');" onmouseout="out('-1124625745990626401');" style="">  33  import org.broadleafcommerce.core.offer.domain.OrderItemAdjustment;                                               </span>
<span class="-6005336697873394325" onmouseenter="enter('-6005336697873394325');" onmouseout="out('-6005336697873394325');" style="">  34  import org.broadleafcommerce.core.offer.domain.OrderItemAdjustmentImpl;                                           </span>
<span class="1848619708404770384" onmouseenter="enter('1848619708404770384');" onmouseout="out('1848619708404770384');" style="">  35  import org.broadleafcommerce.core.offer.service.OfferDataItemProvider;                                            </span>
<span class="-6326345691456347408" onmouseenter="enter('-6326345691456347408');" onmouseout="out('-6326345691456347408');" style="">  36  import org.broadleafcommerce.core.offer.service.OfferServiceImpl;                                                 </span>
<span class="2599349157106653381" onmouseenter="enter('2599349157106653381');" onmouseout="out('2599349157106653381');" style="">  37  import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;                                            </span>
<span class="-3097197529305387536" onmouseenter="enter('-3097197529305387536');" onmouseout="out('-3097197529305387536');" style="">  38  import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;                                        </span>
<span class="212527052176527689" onmouseenter="enter('212527052176527689');" onmouseout="out('212527052176527689');" style="">  39  import org.broadleafcommerce.core.offer.service.discount.CandidatePromotionItems;                                 </span>
<span class="4287099423657810905" onmouseenter="enter('4287099423657810905');" onmouseout="out('4287099423657810905');" style="">  40  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateFulfillmentGroupOffer;         </span>
<span class="4826353322748911550" onmouseenter="enter('4826353322748911550');" onmouseout="out('4826353322748911550');" style="">  41  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableFulfillmentGroup;                       </span>
<span class="-7261038068657094491" onmouseenter="enter('-7261038068657094491');" onmouseout="out('-7261038068657094491');" style="">  42  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableItemFactoryImpl;                        </span>


<span class="-6456406933954769040" onmouseenter="enter('-6456406933954769040');" onmouseout="out('-6456406933954769040');" style="">  43  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrder;                                  </span>
<span class="-7733804833771661823" onmouseenter="enter('-7733804833771661823');" onmouseout="out('-7733804833771661823');" style="">  44  import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItem;                              </span>
<span class="-5253725521220244448" onmouseenter="enter('-5253725521220244448');" onmouseout="out('-5253725521220244448');" style="">  45  import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;                                           </span>
<span class="-4951365057913084569" onmouseenter="enter('-4951365057913084569');" onmouseout="out('-4951365057913084569');" style="">  46  import org.broadleafcommerce.core.order.dao.FulfillmentGroupItemDao;                                              </span>
<span class="-7012758821456487335" onmouseenter="enter('-7012758821456487335');" onmouseout="out('-7012758821456487335');" style="">  47  import org.broadleafcommerce.core.order.dao.OrderItemDao;                                                         </span>
<span class="-6302349778747925467" onmouseenter="enter('-6302349778747925467');" onmouseout="out('-6302349778747925467');" style="">  48  import org.broadleafcommerce.core.order.domain.FulfillmentGroup;                                                  </span>
<span class="-7855842771160128779" onmouseenter="enter('-7855842771160128779');" onmouseout="out('-7855842771160128779');" style="">  49  import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;                                              </span>
<span class="-6039448701992847179" onmouseenter="enter('-6039448701992847179');" onmouseout="out('-6039448701992847179');" style="">  50  import org.broadleafcommerce.core.order.domain.Order;                                                             </span>
<span class="-3117062451881073195" onmouseenter="enter('-3117062451881073195');" onmouseout="out('-3117062451881073195');" style="">  51  import org.broadleafcommerce.core.order.domain.OrderItem;                                                         </span>
<span class="230297408131782266" onmouseenter="enter('230297408131782266');" onmouseout="out('230297408131782266');" style="">  52  import org.broadleafcommerce.core.order.domain.OrderItemPriceDetail;                                              </span>
<span class="1218446574017128210" onmouseenter="enter('1218446574017128210');" onmouseout="out('1218446574017128210');" style="">  53  import org.broadleafcommerce.core.order.domain.OrderMultishipOption;                                              </span>
<span class="5244138541064665880" onmouseenter="enter('5244138541064665880');" onmouseout="out('5244138541064665880');" style="">  54  import org.broadleafcommerce.core.order.domain.OrderMultishipOptionImpl;                                          </span>
<span class="9050710118625717230" onmouseenter="enter('9050710118625717230');" onmouseout="out('9050710118625717230');" style="">  55  import org.broadleafcommerce.core.order.service.FulfillmentGroupService;                                          </span>
<span class="2043331085843421951" onmouseenter="enter('2043331085843421951');" onmouseout="out('2043331085843421951');" style="">  56  import org.broadleafcommerce.core.order.service.OrderItemService;                                                 </span>
<span class="-4438462058374014857" onmouseenter="enter('-4438462058374014857');" onmouseout="out('-4438462058374014857');" style="">  57  import org.broadleafcommerce.core.order.service.OrderMultishipOptionService;                                      </span>
<span class="-4523094285760083742" onmouseenter="enter('-4523094285760083742');" onmouseout="out('-4523094285760083742');" style="">  58  import org.broadleafcommerce.core.order.service.OrderService;                                                     </span>
<span class="426062199469058864" onmouseenter="enter('426062199469058864');" onmouseout="out('426062199469058864');" style="">  59  import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;                                 </span>
<span class="1499051134121889616" onmouseenter="enter('1499051134121889616');" onmouseout="out('1499051134121889616');" style="">  60  import org.broadleafcommerce.profile.core.domain.Address;                                                         </span>
<span class="8043089028015557901" onmouseenter="enter('8043089028015557901');" onmouseout="out('8043089028015557901');" style="">  61  import org.easymock.EasyMock;                                                                                     </span>
<span class="8773851019359685182" onmouseenter="enter('8773851019359685182');" onmouseout="out('8773851019359685182');" style="">  62  import org.easymock.IAnswer;                                                                                      </span>
<span  style="">  63                                                                                                                    </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  64  import java.math.BigDecimal;                                                                                      </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  65  import java.util.ArrayList;                                                                                       </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  66  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  67  import java.util.List;                                                                                            </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  68  import java.util.TimeZone;                                                                                        </span>
<span  style="">  69                                                                                                                    </span>
<span class="5589978463048615898" onmouseenter="enter('5589978463048615898');" onmouseout="out('5589978463048615898');" style="">  70  import junit.framework.TestCase;                                                                                  </span>
<span  style="">  71                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  72  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  74   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  75   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  76   */                                                                                                               </span>
<span class="-6422014710110996402" onmouseenter="enter('-6422014710110996402');" onmouseout="out('-6422014710110996402');" style="">  77  public class FulfillmentGroupOfferProcessorTest extends TestCase {                                                </span>
<span  style="">  78                                                                                                                    </span>
<span class="2764411618740579830" onmouseenter="enter('2764411618740579830');" onmouseout="out('2764411618740579830');" style="">  79      protected OfferDao offerDaoMock;                                                                              </span>
<span class="-1028825014202044443" onmouseenter="enter('-1028825014202044443');" onmouseout="out('-1028825014202044443');" style="">  80      protected OrderItemDao orderItemDaoMock;                                                                      </span>
<span class="3942591246150891792" onmouseenter="enter('3942591246150891792');" onmouseout="out('3942591246150891792');" style="">  81      protected OfferServiceImpl offerService;                                                                      </span>
<span class="2155154311276627388" onmouseenter="enter('2155154311276627388');" onmouseout="out('2155154311276627388');" style="">  82      protected final OfferDataItemProvider dataProvider = new OfferDataItemProvider();                             </span>
<span class="-5369679977326057444" onmouseenter="enter('-5369679977326057444');" onmouseout="out('-5369679977326057444');" style="">  83      protected OrderService orderServiceMock;                                                                      </span>
<span class="-2082308031004269425" onmouseenter="enter('-2082308031004269425');" onmouseout="out('-2082308031004269425');" style="">  84      protected OrderItemService orderItemServiceMock;                                                              </span>
<span class="8143262996519322151" onmouseenter="enter('8143262996519322151');" onmouseout="out('8143262996519322151');" style="">  85      protected FulfillmentGroupItemDao fgItemDaoMock;                                                              </span>
<span class="3331618624366763309" onmouseenter="enter('3331618624366763309');" onmouseout="out('3331618624366763309');" style="">  86      protected FulfillmentGroupService fgServiceMock;                                                              </span>
<span class="2038085072144601851" onmouseenter="enter('2038085072144601851');" onmouseout="out('2038085072144601851');" style="">  87      protected OrderMultishipOptionService multishipOptionServiceMock;                                             </span>
<span class="1636757603740185885" onmouseenter="enter('1636757603740185885');" onmouseout="out('1636757603740185885');" style="">  88      protected OfferTimeZoneProcessor offerTimeZoneProcessorMock;                                                  </span>
<span class="-8980537951567645236" onmouseenter="enter('-8980537951567645236');" onmouseout="out('-8980537951567645236');" style="">  89      protected OfferServiceUtilities offerServiceUtilitiesMock;                                                    </span>
<span class="8126767976686599164" onmouseenter="enter('8126767976686599164');" onmouseout="out('8126767976686599164');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +    protected GenericEntityService genericEntityServiceMock;                                                      </span>
<span  style="">  91                                                                                                                    </span>
<span class="8741687744928291933" onmouseenter="enter('8741687744928291933');" onmouseout="out('8741687744928291933');" style="">  92      protected FulfillmentGroupOfferProcessorImpl fgProcessor;                                                     </span>
<span  style="">  93                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  94      /**                                                                                                           </span>
<span class="-1217892123140267909" onmouseenter="enter('-1217892123140267909');" onmouseout="out('-1217892123140267909');" style="">  95       * Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and</span>
<span class="-8822842737667556133" onmouseenter="enter('-8822842737667556133');" onmouseout="out('-8822842737667556133');" style="">  96       * system properties service since it uses BLCSystemProperty                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  97       *                                                                                                            </span>
<span class="2670632328160232809" onmouseenter="enter('2670632328160232809');" onmouseout="out('2670632328160232809');" style="">  98       * @author Phillip Verheyden (phillipuniverse)                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  99       */                                                                                                           </span>
<span class="8403268836763647235" onmouseenter="enter('8403268836763647235');" onmouseout="out('8403268836763647235');" style=""> 100      protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {    </span>




<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101          @Override                                                                                                 </span>
<span class="-5327199138035207588" onmouseenter="enter('-5327199138035207588');" onmouseout="out('-5327199138035207588');" style=""> 102          protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 103              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105      }                                                                                                             </span>
<span  style=""> 106                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 107      @Override                                                                                                     </span>
<span class="2289017037938349582" onmouseenter="enter('2289017037938349582');" onmouseout="out('2289017037938349582');" style=""> 108      protected void setUp() throws Exception {                                                                     </span>
<span class="-7001064742117532685" onmouseenter="enter('-7001064742117532685');" onmouseout="out('-7001064742117532685');" style=""> 109          offerService = new OfferServiceImpl();                                                                    </span>
<span class="-5376116141285812671" onmouseenter="enter('-5376116141285812671');" onmouseout="out('-5376116141285812671');" style=""> 110          CustomerOfferDao customerOfferDaoMock = EasyMock.createMock(CustomerOfferDao.class);                      </span>
<span class="-570975167499705701" onmouseenter="enter('-570975167499705701');" onmouseout="out('-570975167499705701');" style=""> 111          OfferCodeDao offerCodeDaoMock = EasyMock.createMock(OfferCodeDao.class);                                  </span>
<span class="393627947078248392" onmouseenter="enter('393627947078248392');" onmouseout="out('393627947078248392');" style=""> 112          orderServiceMock = EasyMock.createMock(OrderService.class);                                               </span>
<span class="7274735973437056507" onmouseenter="enter('7274735973437056507');" onmouseout="out('7274735973437056507');" style=""> 113          orderItemDaoMock = EasyMock.createMock(OrderItemDao.class);                                               </span>
<span  style=""> 114                                                                                                                    </span>
<span class="1993264780541814880" onmouseenter="enter('1993264780541814880');" onmouseout="out('1993264780541814880');" style=""> 115          orderItemServiceMock = EasyMock.createMock(OrderItemService.class);                                       </span>
<span class="-3213369057155598174" onmouseenter="enter('-3213369057155598174');" onmouseout="out('-3213369057155598174');" style=""> 116          fgItemDaoMock = EasyMock.createMock(FulfillmentGroupItemDao.class);                                       </span>
<span class="3258640190833853601" onmouseenter="enter('3258640190833853601');" onmouseout="out('3258640190833853601');" style=""> 117          offerDaoMock = EasyMock.createMock(OfferDao.class);                                                       </span>
<span class="6964150545963317885" onmouseenter="enter('6964150545963317885');" onmouseout="out('6964150545963317885');" style=""> 118          fgServiceMock = EasyMock.createMock(FulfillmentGroupService.class);                                       </span>
<span class="-3871783238737974896" onmouseenter="enter('-3871783238737974896');" onmouseout="out('-3871783238737974896');" style=""> 119          multishipOptionServiceMock = EasyMock.createMock(OrderMultishipOptionService.class);                      </span>
<span class="616226227087806826" onmouseenter="enter('616226227087806826');" onmouseout="out('616226227087806826');" style=""> 120          offerServiceUtilitiesMock = EasyMock.createMock(OfferServiceUtilities.class);                             </span>
<span class="-3280473616402059983" onmouseenter="enter('-3280473616402059983');" onmouseout="out('-3280473616402059983');" style=""> 121          offerTimeZoneProcessorMock = EasyMock.createMock(OfferTimeZoneProcessor.class);                           </span>
<span class="-8978123556236380411" onmouseenter="enter('-8978123556236380411');" onmouseout="out('-8978123556236380411');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +        genericEntityServiceMock = EasyMock.createMock(GenericEntityService.class);                               </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-8146860948985884961" onmouseenter="enter('-8146860948985884961');" onmouseout="out('-8146860948985884961');" style=""> 124          fgProcessor = new TestableFulfillmentGroupOfferProcessor();                                               </span>



<span class="318927000718674479" onmouseenter="enter('318927000718674479');" onmouseout="out('318927000718674479');" style=""> 125          fgProcessor.setOfferDao(offerDaoMock);                                                                    </span>
<span class="209910556380023087" onmouseenter="enter('209910556380023087');" onmouseout="out('209910556380023087');" style=""> 126          fgProcessor.setOrderItemDao(orderItemDaoMock);                                                            </span>
<span class="-9198117990764754611" onmouseenter="enter('-9198117990764754611');" onmouseout="out('-9198117990764754611');" style=""> 127          fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                    </span>

<span class="7704480163157702704" onmouseenter="enter('7704480163157702704');" onmouseout="out('7704480163157702704');" style=""> 128          fgProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                          </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-2101358397833099204" onmouseenter="enter('-2101358397833099204');" onmouseout="out('-2101358397833099204');" style=""> 130          OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();                        </span>

<span class="4393308911552043332" onmouseenter="enter('4393308911552043332');" onmouseout="out('4393308911552043332');" style=""> 131          offerServiceUtilities.setOfferDao(offerDaoMock);                                                          </span>
<span class="8672470870156482430" onmouseenter="enter('8672470870156482430');" onmouseout="out('8672470870156482430');" style=""> 132          offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());                          </span>
<span class="8346807884110674152" onmouseenter="enter('8346807884110674152');" onmouseout="out('8346807884110674152');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        offerServiceUtilities.setGenericEntityService(genericEntityServiceMock);                                  </span>
<span  style=""> 134                                                                                                                    </span>
<span class="-2065747208737510923" onmouseenter="enter('-2065747208737510923');" onmouseout="out('-2065747208737510923');" style=""> 135          OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();                                   </span>



<span class="-8216532080679576302" onmouseenter="enter('-8216532080679576302');" onmouseout="out('-8216532080679576302');" style=""> 136          orderProcessor.setOfferDao(offerDaoMock);                                                                 </span>
<span class="7588180708377269856" onmouseenter="enter('7588180708377269856');" onmouseout="out('7588180708377269856');" style=""> 137          orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                 </span>

<span class="-4740125181186986858" onmouseenter="enter('-4740125181186986858');" onmouseout="out('-4740125181186986858');" style=""> 138          orderProcessor.setOfferServiceUtilities(offerServiceUtilitiesMock);                                       </span>
<span class="-4588344466186947569" onmouseenter="enter('-4588344466186947569');" onmouseout="out('-4588344466186947569');" style=""> 139          orderProcessor.setOfferTimeZoneProcessor(offerTimeZoneProcessorMock);                                     </span>
<span class="-7787408525763214442" onmouseenter="enter('-7787408525763214442');" onmouseout="out('-7787408525763214442');" style=""> 140          orderProcessor.setOrderItemDao(orderItemDaoMock);                                                         </span>
<span class="-8932862412317704790" onmouseenter="enter('-8932862412317704790');" onmouseout="out('-8932862412317704790');" style=""> 141          orderProcessor.setOfferServiceUtilities(offerServiceUtilities);                                           </span>
<span  style=""> 142                                                                                                                    </span>
<span class="4013547806696404600" onmouseenter="enter('4013547806696404600');" onmouseout="out('4013547806696404600');" style=""> 143          ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();                                      </span>

<span class="-7004957386218896406" onmouseenter="enter('-7004957386218896406');" onmouseout="out('-7004957386218896406');" style=""> 144          itemProcessor.setOfferDao(offerDaoMock);                                                                  </span>
<span class="-4774736295542748467" onmouseenter="enter('-4774736295542748467');" onmouseout="out('-4774736295542748467');" style=""> 145          itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());                                  </span>

<span class="-7985735156898326914" onmouseenter="enter('-7985735156898326914');" onmouseout="out('-7985735156898326914');" style=""> 146          itemProcessor.setOrderItemDao(orderItemDaoMock);                                                          </span>
<span class="1873271206223196651" onmouseenter="enter('1873271206223196651');" onmouseout="out('1873271206223196651');" style=""> 147          itemProcessor.setOfferServiceUtilities(offerServiceUtilities);                                            </span>
<span  style=""> 148                                                                                                                    </span>
<span class="-7594314374485898167" onmouseenter="enter('-7594314374485898167');" onmouseout="out('-7594314374485898167');" style=""> 149          offerService.setCustomerOfferDao(customerOfferDaoMock);                                                   </span>
<span class="483175997286853822" onmouseenter="enter('483175997286853822');" onmouseout="out('483175997286853822');" style=""> 150          offerService.setOfferCodeDao(offerCodeDaoMock);                                                           </span>
<span class="-157638129368187663" onmouseenter="enter('-157638129368187663');" onmouseout="out('-157638129368187663');" style=""> 151          offerService.setOfferDao(offerDaoMock);                                                                   </span>
<span class="-2861300639666845512" onmouseenter="enter('-2861300639666845512');" onmouseout="out('-2861300639666845512');" style=""> 152          offerService.setOrderOfferProcessor(orderProcessor);                                                      </span>
<span class="4668119620018038426" onmouseenter="enter('4668119620018038426');" onmouseout="out('4668119620018038426');" style=""> 153          offerService.setItemOfferProcessor(itemProcessor);                                                        </span>
<span class="-4412724488869175480" onmouseenter="enter('-4412724488869175480');" onmouseout="out('-4412724488869175480');" style=""> 154          offerService.setFulfillmentGroupOfferProcessor(fgProcessor);                                              </span>
<span class="-7075295889541966474" onmouseenter="enter('-7075295889541966474');" onmouseout="out('-7075295889541966474');" style=""> 155          offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());                                   </span>

<span class="-7013122243510448528" onmouseenter="enter('-7013122243510448528');" onmouseout="out('-7013122243510448528');" style=""> 156          offerService.setOrderService(orderServiceMock);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157      }                                                                                                             </span>
<span  style=""> 158                                                                                                                    </span>
<span class="3027682741895790020" onmouseenter="enter('3027682741895790020');" onmouseout="out('3027682741895790020');" style=""> 159      public void replay() {                                                                                        </span>
<span class="4039967104390893601" onmouseenter="enter('4039967104390893601');" onmouseout="out('4039967104390893601');" style=""> 160          EasyMock.replay(offerDaoMock);                                                                            </span>
<span class="-8438798452743116996" onmouseenter="enter('-8438798452743116996');" onmouseout="out('-8438798452743116996');" style=""> 161          EasyMock.replay(orderItemDaoMock);                                                                        </span>
<span class="-306516478140011318" onmouseenter="enter('-306516478140011318');" onmouseout="out('-306516478140011318');" style=""> 162          EasyMock.replay(orderServiceMock);                                                                        </span>
<span class="-1764805494951210013" onmouseenter="enter('-1764805494951210013');" onmouseout="out('-1764805494951210013');" style=""> 163          EasyMock.replay(orderItemServiceMock);                                                                    </span>
<span class="1127149787736159594" onmouseenter="enter('1127149787736159594');" onmouseout="out('1127149787736159594');" style=""> 164          EasyMock.replay(fgItemDaoMock);                                                                           </span>
<span class="220377317211655869" onmouseenter="enter('220377317211655869');" onmouseout="out('220377317211655869');" style=""> 165          EasyMock.replay(fgServiceMock);                                                                           </span>
<span class="7141248576860687210" onmouseenter="enter('7141248576860687210');" onmouseout="out('7141248576860687210');" style=""> 166          EasyMock.replay(multishipOptionServiceMock);                                                              </span>
<span class="1625398624145697967" onmouseenter="enter('1625398624145697967');" onmouseout="out('1625398624145697967');" style=""> 167          EasyMock.replay(offerTimeZoneProcessorMock);                                                              </span>
<span class="7441173554159837333" onmouseenter="enter('7441173554159837333');" onmouseout="out('7441173554159837333');" style=""> 168          EasyMock.replay(offerServiceUtilitiesMock);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169      }                                                                                                             </span>
<span  style=""> 170                                                                                                                    </span>
<span class="6267001839391766981" onmouseenter="enter('6267001839391766981');" onmouseout="out('6267001839391766981');" style=""> 171      public void verify() {                                                                                        </span>
<span class="6756940960390862422" onmouseenter="enter('6756940960390862422');" onmouseout="out('6756940960390862422');" style=""> 172          EasyMock.verify(offerDaoMock);                                                                            </span>
<span class="-5117344946758939057" onmouseenter="enter('-5117344946758939057');" onmouseout="out('-5117344946758939057');" style=""> 173          EasyMock.verify(orderItemDaoMock);                                                                        </span>
<span class="-6538245312297088944" onmouseenter="enter('-6538245312297088944');" onmouseout="out('-6538245312297088944');" style=""> 174          EasyMock.verify(orderServiceMock);                                                                        </span>
<span class="4656187310788509663" onmouseenter="enter('4656187310788509663');" onmouseout="out('4656187310788509663');" style=""> 175          EasyMock.verify(orderItemServiceMock);                                                                    </span>
<span class="-3344344690958109982" onmouseenter="enter('-3344344690958109982');" onmouseout="out('-3344344690958109982');" style=""> 176          EasyMock.verify(fgItemDaoMock);                                                                           </span>
<span class="-7107457974865616724" onmouseenter="enter('-7107457974865616724');" onmouseout="out('-7107457974865616724');" style=""> 177          EasyMock.verify(fgServiceMock);                                                                           </span>
<span class="3082501288673197520" onmouseenter="enter('3082501288673197520');" onmouseout="out('3082501288673197520');" style=""> 178          EasyMock.verify(multishipOptionServiceMock);                                                              </span>
<span class="8968216054532738001" onmouseenter="enter('8968216054532738001');" onmouseout="out('8968216054532738001');" style=""> 179          EasyMock.verify(offerTimeZoneProcessorMock);                                                              </span>
<span class="1970601797097358226" onmouseenter="enter('1970601797097358226');" onmouseout="out('1970601797097358226');" style=""> 180          EasyMock.verify(offerServiceUtilitiesMock);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span class="4350196711973577847" onmouseenter="enter('4350196711973577847');" onmouseout="out('4350196711973577847');" style=""> 183      public void testApplyAllFulfillmentGroupOffersWithOrderItemOffers() throws Exception {                        </span>
<span class="8446165972037001535" onmouseenter="enter('8446165972037001535');" onmouseout="out('8446165972037001535');" style=""> 184          final ThreadLocal&lt;Order&gt; myOrder = new ThreadLocal&lt;Order&gt;();                                              </span>
<span class="3688914841313020601" onmouseenter="enter('3688914841313020601');" onmouseout="out('3688914841313020601');" style=""><abbr title=" 185          EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAnswer()).anyTimes();"> 185          EasyMock.expect(orderItemDaoMock.createOrderItemPriceDetail()).andAnswer(OfferDataItemProvider.getCreateOrðŸ”µ</abbr></span>
<span  style=""> 186                                                                                                                    </span>
<span class="244050499009988211" onmouseenter="enter('244050499009988211');" onmouseout="out('244050499009988211');" style=""><abbr title=" 187          EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrderItemQualifierAnswer()).atLeastOnce();"> 187          EasyMock.expect(orderItemDaoMock.createOrderItemQualifier()).andAnswer(OfferDataItemProvider.getCreateOrdeðŸ”µ</abbr></span>
<span  style=""> 188                                                                                                                    </span>
<span class="-4805711593793558927" onmouseenter="enter('-4805711593793558927');" onmouseout="out('-4805711593793558927');" style=""><abbr title=" 189          EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getAddItemToFulfillmentGroupAnswer()).anyTimes();"> 189          EasyMock.expect(fgServiceMock.addItemToFulfillmentGroup(EasyMock.isA(FulfillmentGroupItemRequest.class), EðŸ”µ</abbr></span>
<span class="-4648578783612235576" onmouseenter="enter('-4648578783612235576');" onmouseout="out('-4648578783612235576');" style=""><abbr title=" 190          EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eq(false))).andAnswer(OfferDataItemProvider.getRemoveItemFromOrderAnswer()).anyTimes();"> 190          EasyMock.expect(orderServiceMock.removeItem(EasyMock.isA(Long.class), EasyMock.isA(Long.class), EasyMock.eðŸ”µ</abbr></span>
<span class="-25100646963641968" onmouseenter="enter('-25100646963641968');" onmouseout="out('-25100646963641968');" style=""><abbr title=" 191          EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OfferDataItemProvider.getSaveOrderAnswer()).anyTimes();"> 191          EasyMock.expect(orderServiceMock.save(EasyMock.isA(Order.class), EasyMock.isA(Boolean.class))).andAnswer(OðŸ”µ</abbr></span>
<span  style=""> 192                                                                                                                    </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 193          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 193          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 194          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 194          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.clasðŸ”µ</abbr></span>
<span  style=""> 195                                                                                                                    </span>
<span class="2160564019413082164" onmouseenter="enter('2160564019413082164');" onmouseout="out('2160564019413082164');" style=""> 196          EasyMock.expect(orderServiceMock.getAutomaticallyMergeLikeItems()).andReturn(true).anyTimes();            </span>
<span class="-8884522234726007395" onmouseenter="enter('-8884522234726007395');" onmouseout="out('-8884522234726007395');" style=""><abbr title=" 197          EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemProvider.getSaveOrderItemAnswer()).anyTimes();"> 197          EasyMock.expect(orderItemServiceMock.saveOrderItem(EasyMock.isA(OrderItem.class))).andAnswer(OfferDataItemðŸ”µ</abbr></span>
<span class="-3554631046904274751" onmouseenter="enter('-3554631046904274751');" onmouseout="out('-3554631046904274751');" style=""><abbr title=" 198          EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProvider.getSaveFulfillmentGroupItemAnswer()).anyTimes();"> 198          EasyMock.expect(fgItemDaoMock.save(EasyMock.isA(FulfillmentGroupItem.class))).andAnswer(OfferDataItemProviðŸ”µ</abbr></span>
<span  style=""> 199                                                                                                                    </span>
<span class="3313434268437563429" onmouseenter="enter('3313434268437563429');" onmouseout="out('3313434268437563429');" style=""><abbr title=" 200          EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCreateOrderItemPriceDetailAdjustmentAnswer()).anyTimes();"> 200          EasyMock.expect(offerDaoMock.createOrderItemPriceDetailAdjustment()).andAnswer(OfferDataItemProvider.getCrðŸ”µ</abbr></span>
<span class="-3718636667900446110" onmouseenter="enter('-3718636667900446110');" onmouseout="out('-3718636667900446110');" style=""><abbr title=" 201          EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupAdjustmentAnswer()).anyTimes();"> 201          EasyMock.expect(offerDaoMock.createFulfillmentGroupAdjustment()).andAnswer(OfferDataItemProvider.getCreateðŸ”µ</abbr></span>
<span  style=""> 202                                                                                                                    </span>
<span class="-3815074675149067237" onmouseenter="enter('-3815074675149067237');" onmouseout="out('-3815074675149067237');" style=""> 203          EasyMock.expect(orderServiceMock.findOrderById(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;Order&gt;() {</span>
<span  style=""> 204                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 205              @Override                                                                                             </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 206              public Order answer() throws Throwable {                                                              </span>
<span class="-2641290802290262879" onmouseenter="enter('-2641290802290262879');" onmouseout="out('-2641290802290262879');" style=""> 207                  return myOrder.get();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 209          }).anyTimes();                                                                                            </span>
<span  style=""> 210                                                                                                                    </span>
<span class="2031702441279524669" onmouseenter="enter('2031702441279524669');" onmouseout="out('2031702441279524669');" style=""><abbr title=" 211          EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(new IAnswer&lt;List&lt;OrderMultishipOption&gt;&gt;() {"> 211          EasyMock.expect(multishipOptionServiceMock.findOrderMultishipOptions(EasyMock.isA(Long.class))).andAnswer(ðŸ”µ</abbr></span>
<span  style=""> 212                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 213              @Override                                                                                             </span>
<span class="4982536128511672004" onmouseenter="enter('4982536128511672004');" onmouseout="out('4982536128511672004');" style=""> 214              public List&lt;OrderMultishipOption&gt; answer() throws Throwable {                                         </span>
<span class="3348167234255574763" onmouseenter="enter('3348167234255574763');" onmouseout="out('3348167234255574763');" style=""> 215                  List&lt;OrderMultishipOption&gt; options = new ArrayList&lt;OrderMultishipOption&gt;();                       </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 216                  PromotableOrder order = dataProvider.createBasicPromotableOrder();                                </span>

<span class="-6747846520377446395" onmouseenter="enter('-6747846520377446395');" onmouseout="out('-6747846520377446395');" style=""> 217                  for (FulfillmentGroup fg : order.getOrder().getFulfillmentGroups()) {                             </span>
<span class="-6367521286140114289" onmouseenter="enter('-6367521286140114289');" onmouseout="out('-6367521286140114289');" style=""> 218                      Address address = fg.getAddress();                                                            </span>
<span class="8028460309176757050" onmouseenter="enter('8028460309176757050');" onmouseout="out('8028460309176757050');" style=""> 219                      for (FulfillmentGroupItem fgItem : fg.getFulfillmentGroupItems()) {                           </span>
<span class="8402583593129976695" onmouseenter="enter('8402583593129976695');" onmouseout="out('8402583593129976695');" style=""> 220                          for (int j = 0; j &lt; fgItem.getQuantity(); j++) {                                          </span>
<span class="3921661458783293685" onmouseenter="enter('3921661458783293685');" onmouseout="out('3921661458783293685');" style=""> 221                              OrderMultishipOption option = new OrderMultishipOptionImpl();                         </span>
<span class="6971594022266833915" onmouseenter="enter('6971594022266833915');" onmouseout="out('6971594022266833915');" style=""> 222                              option.setOrder(order.getOrder());                                                    </span>
<span class="-7842023912465695186" onmouseenter="enter('-7842023912465695186');" onmouseout="out('-7842023912465695186');" style=""> 223                              option.setAddress(address);                                                           </span>
<span class="-8979996557527707436" onmouseenter="enter('-8979996557527707436');" onmouseout="out('-8979996557527707436');" style=""> 224                              option.setOrderItem(fgItem.getOrderItem());                                           </span>
<span class="3662213946586141634" onmouseenter="enter('3662213946586141634');" onmouseout="out('3662213946586141634');" style=""> 225                              options.add(option);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226                          }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228                  }                                                                                                 </span>
<span  style=""> 229                                                                                                                    </span>
<span class="7754614799802233964" onmouseenter="enter('7754614799802233964');" onmouseout="out('7754614799802233964');" style=""> 230                  return options;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 232          }).anyTimes();                                                                                            </span>
<span  style=""> 233                                                                                                                    </span>
<span class="5730763888734231228" onmouseenter="enter('5730763888734231228');" onmouseout="out('5730763888734231228');" style=""> 234          multishipOptionServiceMock.deleteAllOrderMultishipOptions(EasyMock.isA(Order.class));                     </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 235          EasyMock.expectLastCall().anyTimes();                                                                     </span>
<span class="-2684793509385343472" onmouseenter="enter('-2684793509385343472');" onmouseout="out('-2684793509385343472');" style=""><abbr title=" 236          EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eq(false))).andAnswer(new IAnswer&lt;Order&gt;() {"> 236          EasyMock.expect(fgServiceMock.collapseToOneShippableFulfillmentGroup(EasyMock.isA(Order.class), EasyMock.eðŸ”µ</abbr></span>
<span  style=""> 237                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 238              @Override                                                                                             </span>
<span class="-9160825572661903308" onmouseenter="enter('-9160825572661903308');" onmouseout="out('-9160825572661903308');" style=""> 239              public Order answer() throws Throwable {                                                              </span>
<span class="-2361682080301650618" onmouseenter="enter('-2361682080301650618');" onmouseout="out('-2361682080301650618');" style=""> 240                  Order order = (Order) EasyMock.getCurrentArguments()[0];                                          </span>
<span class="6377062998999459231" onmouseenter="enter('6377062998999459231');" onmouseout="out('6377062998999459231');" style=""><abbr title=" 241                  order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups().get(1).getFulfillmentGroupItems());"> 241                  order.getFulfillmentGroups().get(0).getFulfillmentGroupItems().addAll(order.getFulfillmentGroups()ðŸ”µ</abbr></span>
<span class="8328438890662847465" onmouseenter="enter('8328438890662847465');" onmouseout="out('8328438890662847465');" style=""> 242                  order.getFulfillmentGroups().remove(order.getFulfillmentGroups().get(1));                         </span>
<span  style=""> 243                                                                                                                    </span>
<span class="-5747246288187903060" onmouseenter="enter('-5747246288187903060');" onmouseout="out('-5747246288187903060');" style=""> 244                  return order;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245              }                                                                                                     </span>
<span class="-8356082990236199220" onmouseenter="enter('-8356082990236199220');" onmouseout="out('-8356082990236199220');" style=""> 246          }).anyTimes();                                                                                            </span>
<span class="7005207656442723333" onmouseenter="enter('7005207656442723333');" onmouseout="out('7005207656442723333');" style=""><abbr title=" 247          EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnswer()).anyTimes();"> 247          EasyMock.expect(fgItemDaoMock.create()).andAnswer(OfferDataItemProvider.getCreateFulfillmentGroupItemAnsweðŸ”µ</abbr></span>
<span class="3552856255510166668" onmouseenter="enter('3552856255510166668');" onmouseout="out('3552856255510166668');" style=""> 248          fgItemDaoMock.delete(EasyMock.isA(FulfillmentGroupItem.class));                                           </span>
<span class="-238683341484251031" onmouseenter="enter('-238683341484251031');" onmouseout="out('-238683341484251031');" style=""> 249          EasyMock.expectLastCall().anyTimes();                                                                     </span>
<span class="602433099109498087" onmouseenter="enter('602433099109498087');" onmouseout="out('602433099109498087');" style=""><abbr title=" 250          EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.getTimeZone(&quot;CST&quot;)).anyTimes();"> 250          EasyMock.expect(offerTimeZoneProcessorMock.getTimeZone(EasyMock.isA(OfferImpl.class))).andReturn(TimeZone.ðŸ”µ</abbr></span>
<span  style=""> 251                                                                                                                    </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 252          replay();                                                                                                 </span>
<span  style=""> 253                                                                                                                    </span>
<span class="-1327825397201902636" onmouseenter="enter('-1327825397201902636');" onmouseout="out('-1327825397201902636');" style=""> 254          PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();                              </span>

<span class="-396343315567854895" onmouseenter="enter('-396343315567854895');" onmouseout="out('-396343315567854895');" style=""> 255          Order order = promotableOrder.getOrder();                                                                 </span>
<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 256          myOrder.set(promotableOrder.getOrder());                                                                  </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 257          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 257          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 258          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 258          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 259          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 259          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 260          offers.get(1).setName(&quot;secondOffer&quot;);                                                                     </span>
<span  style=""> 261                                                                                                                    </span>
<span class="-374141704093766947" onmouseenter="enter('-374141704093766947');" onmouseout="out('-374141704093766947');" style=""> 262          offers.addAll(dataProvider.createItemBasedOfferWithItemCriteria(                                          </span>
<span class="-971526457565278793" onmouseenter="enter('-971526457565278793');" onmouseout="out('-971526457565278793');" style=""> 263                  &quot;order.subTotal.getAmount()&gt;20&quot;,                                                                  </span>
<span class="8626574580727552658" onmouseenter="enter('8626574580727552658');" onmouseout="out('8626574580727552658');" style=""> 264                  OfferDiscountType.PERCENT_OFF,                                                                    </span>
<span class="-1086407973911983614" onmouseenter="enter('-1086407973911983614');" onmouseout="out('-1086407973911983614');" style=""><abbr title=" 265                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;,"> 265                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eðŸ”µ</abbr></span>
<span class="-6157256577419644919" onmouseenter="enter('-6157256577419644919');" onmouseout="out('-6157256577419644919');" style=""><abbr title=" 266                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;"> 266                  &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eðŸ”µ</abbr></span>
<span class="3699784701886273761" onmouseenter="enter('3699784701886273761');" onmouseout="out('3699784701886273761');" style=""> 267                  ));                                                                                               </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 268          offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                               </span>
<span  style=""> 269                                                                                                                    </span>
<span class="-5783701790519827054" onmouseenter="enter('-5783701790519827054');" onmouseout="out('-5783701790519827054');" style=""> 270          offers.get(0).setTotalitarianOffer(true);                                                                 </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 271          offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());               </span>
<span  style=""> 272                                                                                                                    </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 273          int fgAdjustmentCount = 0;                                                                                </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 274          for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                                </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 275              fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276          }                                                                                                         </span>
<span class="-6281142585732833119" onmouseenter="enter('-6281142585732833119');" onmouseout="out('-6281142585732833119');" style=""><abbr title=" 277          //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order item offers"> 277          //The totalitarian offer that applies to both fg&#x27;s is not combinable and is a worse offer than the order iðŸ”µ</abbr></span>
<span class="-7018201492040868931" onmouseenter="enter('-7018201492040868931');" onmouseout="out('-7018201492040868931');" style=""> 278          // - it is therefore ignored                                                                              </span>
<span class="8464783908245837933" onmouseenter="enter('8464783908245837933');" onmouseout="out('8464783908245837933');" style=""> 279          //However, the second combinable fg offer is allowed to be applied.                                       </span>
<span class="1322310588171640590" onmouseenter="enter('1322310588171640590');" onmouseout="out('1322310588171640590');" style=""> 280          assertTrue(fgAdjustmentCount == 1);                                                                       </span>
<span  style=""> 281                                                                                                                    </span>
<span class="7677156014156700928" onmouseenter="enter('7677156014156700928');" onmouseout="out('7677156014156700928');" style=""> 282          promotableOrder = dataProvider.createBasicPromotableOrder();                                              </span>

<span class="9169182561123493003" onmouseenter="enter('9169182561123493003');" onmouseout="out('9169182561123493003');" style=""> 283          myOrder.set(promotableOrder.getOrder());                                                                  </span>
<span class="4605867479195622271" onmouseenter="enter('4605867479195622271');" onmouseout="out('4605867479195622271');" style=""> 284          offers.get(2).setValue(new BigDecimal(&quot;1&quot;));                                                              </span>
<span  style=""> 285                                                                                                                    </span>
<span class="-8850404678133765671" onmouseenter="enter('-8850404678133765671');" onmouseout="out('-8850404678133765671');" style=""> 286          offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());                               </span>
<span class="-4673275403777288461" onmouseenter="enter('-4673275403777288461');" onmouseout="out('-4673275403777288461');" style=""> 287          offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, promotableOrder.getOrder());               </span>
<span  style=""> 288                                                                                                                    </span>
<span class="5070682841290639966" onmouseenter="enter('5070682841290639966');" onmouseout="out('5070682841290639966');" style=""> 289          fgAdjustmentCount = 0;                                                                                    </span>
<span class="-1030185999544814128" onmouseenter="enter('-1030185999544814128');" onmouseout="out('-1030185999544814128');" style=""> 290          order = promotableOrder.getOrder();                                                                       </span>
<span class="-1206553190780034737" onmouseenter="enter('-1206553190780034737');" onmouseout="out('-1206553190780034737');" style=""> 291          for (FulfillmentGroup fg : order.getFulfillmentGroups()) {                                                </span>
<span class="-8493506504974165790" onmouseenter="enter('-8493506504974165790');" onmouseout="out('-8493506504974165790');" style=""> 292              fgAdjustmentCount += fg.getFulfillmentGroupAdjustments().size();                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293          }                                                                                                         </span>
<span  style=""> 294                                                                                                                    </span>
<span class="-6528829480981189501" onmouseenter="enter('-6528829480981189501');" onmouseout="out('-6528829480981189501');" style=""><abbr title=" 295          //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fg offer is applied"> 295          //The totalitarian fg offer is now a better deal than the order item offers, therefore the totalitarian fgðŸ”µ</abbr></span>
<span class="-8173222409402387748" onmouseenter="enter('-8173222409402387748');" onmouseout="out('-8173222409402387748');" style=""> 296          //and the order item offers are removed                                                                   </span>
<span class="3307702501962124755" onmouseenter="enter('3307702501962124755');" onmouseout="out('3307702501962124755');" style=""> 297          assertTrue(fgAdjustmentCount == 2);                                                                       </span>
<span  style=""> 298                                                                                                                    </span>
<span class="-2665219164306343886" onmouseenter="enter('-2665219164306343886');" onmouseout="out('-2665219164306343886');" style=""> 299          int itemAdjustmentCount = 0;                                                                              </span>
<span class="820796442257070700" onmouseenter="enter('820796442257070700');" onmouseout="out('820796442257070700');" style=""> 300          for (OrderItem item : order.getOrderItems()) {                                                            </span>
<span class="773323050474809935" onmouseenter="enter('773323050474809935');" onmouseout="out('773323050474809935');" style=""> 301              for (OrderItemPriceDetail detail : item.getOrderItemPriceDetails()) {                                 </span>
<span class="-2721944390925153219" onmouseenter="enter('-2721944390925153219');" onmouseout="out('-2721944390925153219');" style=""> 302                  itemAdjustmentCount += detail.getOrderItemPriceDetailAdjustments().size();                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304          }                                                                                                         </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-5059339364425280634" onmouseenter="enter('-5059339364425280634');" onmouseout="out('-5059339364425280634');" style=""> 306          //Confirm that the order item offers are removed                                                          </span>
<span class="8413015744603539595" onmouseenter="enter('8413015744603539595');" onmouseout="out('8413015744603539595');" style=""> 307          assertTrue(itemAdjustmentCount == 0);                                                                     </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 308          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309      }                                                                                                             </span>
<span  style=""> 310                                                                                                                    </span>
<span class="5292901739910789200" onmouseenter="enter('5292901739910789200');" onmouseout="out('5292901739910789200');" style=""> 311      public void testApplyAllFulfillmentGroupOffers() {                                                            </span>
<span class="7789625562417970218" onmouseenter="enter('7789625562417970218');" onmouseout="out('7789625562417970218');" style=""><abbr title=" 312          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class), EasyMock.isA(HashMap.class))).andReturn(true).anyTimes();"> 312          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsQualifyingSubtotalRequirements(EasyMock.isA(PromotableðŸ”µ</abbr></span>
<span class="-8271581028788098448" onmouseenter="enter('-8271581028788098448');" onmouseout="out('-8271581028788098448');" style=""><abbr title=" 313          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.class), EasyMock.isA(Offer.class))).andReturn(true).anyTimes();"> 313          EasyMock.expect(offerServiceUtilitiesMock.orderMeetsSubtotalRequirements(EasyMock.isA(PromotableOrder.clasðŸ”µ</abbr></span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 314          replay();                                                                                                 </span>
<span  style=""> 315                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 316          PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>

<span  style=""> 317                                                                                                                    </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 318          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 318          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 319          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 319          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 320          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 321                                                                                                                    </span>
<span class="-8566543852517619753" onmouseenter="enter('-8566543852517619753');" onmouseout="out('-8566543852517619753');" style=""> 322          boolean offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);                </span>
<span  style=""> 323                                                                                                                    </span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 324          assertTrue(offerApplied);                                                                                 </span>
<span  style=""> 325                                                                                                                    </span>
<span class="-7443356352803382403" onmouseenter="enter('-7443356352803382403');" onmouseout="out('-7443356352803382403');" style=""> 326          order = dataProvider.createBasicPromotableOrder();                                                        </span>

<span  style=""> 327                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 328          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-2396210347480358039" onmouseenter="enter('-2396210347480358039');" onmouseout="out('-2396210347480358039');" style=""><abbr title=" 329          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 329          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalðŸ”µ</abbr></span>
<span class="2011012972625329434" onmouseenter="enter('2011012972625329434');" onmouseout="out('2011012972625329434');" style=""><abbr title=" 330          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;));"> 330          offers.addAll(dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmenðŸ”µ</abbr></span>
<span class="-303951530137137208" onmouseenter="enter('-303951530137137208');" onmouseout="out('-303951530137137208');" style=""> 331          offers.get(1).setName(&quot;secondOffer&quot;);                                                                     </span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 332          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span class="1761556730467108563" onmouseenter="enter('1761556730467108563');" onmouseout="out('1761556730467108563');" style=""> 333          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(1));                      </span>
<span  style=""> 334                                                                                                                    </span>
<span class="2518449647151254078" onmouseenter="enter('2518449647151254078');" onmouseout="out('2518449647151254078');" style=""> 335          offerApplied = fgProcessor.applyAllFulfillmentGroupOffers(qualifiedOffers, order);                        </span>
<span  style=""> 336                                                                                                                    </span>
<span class="8343302181900945855" onmouseenter="enter('8343302181900945855');" onmouseout="out('8343302181900945855');" style=""><abbr title=" 337          //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfillment groups"> 337          //the first offer applies to both fulfillment groups, but the second offer only applies to one of the fulfðŸ”µ</abbr></span>
<span class="-1727294335187025808" onmouseenter="enter('-1727294335187025808');" onmouseout="out('-1727294335187025808');" style=""> 338          assertTrue(offerApplied);                                                                                 </span>
<span class="-3358859117153917119" onmouseenter="enter('-3358859117153917119');" onmouseout="out('-3358859117153917119');" style=""> 339          int fgAdjustmentCount = 0;                                                                                </span>
<span class="-1134830134613695083" onmouseenter="enter('-1134830134613695083');" onmouseout="out('-1134830134613695083');" style=""> 340          for (PromotableFulfillmentGroup fg : order.getFulfillmentGroups()) {                                      </span>
<span class="5611483739197685885" onmouseenter="enter('5611483739197685885');" onmouseout="out('5611483739197685885');" style=""> 341              fgAdjustmentCount += fg.getCandidateFulfillmentGroupAdjustments().size();                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342          }                                                                                                         </span>
<span class="6786894656890298013" onmouseenter="enter('6786894656890298013');" onmouseout="out('6786894656890298013');" style=""> 343          assertTrue(fgAdjustmentCount == 3);                                                                       </span>
<span  style=""> 344                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 345          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346      }                                                                                                             </span>
<span  style=""> 347                                                                                                                    </span>
<span class="-6111721081814302723" onmouseenter="enter('-6111721081814302723');" onmouseout="out('-6111721081814302723');" style=""> 348      public void testFilterFulfillmentGroupLevelOffer() {                                                          </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 349          replay();                                                                                                 </span>
<span  style=""> 350                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 351          PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>

<span  style=""> 352                                                                                                                    </span>
<span class="-1603860488477324518" onmouseenter="enter('-1603860488477324518');" onmouseout="out('-1603860488477324518');" style=""><abbr title=" 353          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();"> 353          List&lt;PromotableCandidateFulfillmentGroupOffer&gt; qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmðŸ”µ</abbr></span>
<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 354          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 354          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 355          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 356                                                                                                                    </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 357          //test that the valid fg offer is included                                                                </span>
<span class="-68824863773413969" onmouseenter="enter('-68824863773413969');" onmouseout="out('-68824863773413969');" style=""> 358          //No item criteria, so each fulfillment group applies                                                     </span>
<span class="8944166164976093148" onmouseenter="enter('8944166164976093148');" onmouseout="out('8944166164976093148');" style=""> 359          assertTrue(qualifiedOffers.size() == 2 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));       </span>
<span  style=""> 360                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 361          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-794484836397434919" onmouseenter="enter('-794484836397434919');" onmouseout="out('-794484836397434919');" style=""><abbr title=" 362          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 362          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 363          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 364                                                                                                                    </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 365          //test that the valid fg offer is included                                                                </span>
<span class="-5258373286153459716" onmouseenter="enter('-5258373286153459716');" onmouseout="out('-5258373286153459716');" style=""> 366          //only 1 fulfillment group has qualifying items                                                           </span>
<span class="-786785952090327245" onmouseenter="enter('-786785952090327245');" onmouseout="out('-786785952090327245');" style=""> 367          assertTrue(qualifiedOffers.size() == 1 &amp;&amp; qualifiedOffers.get(0).getOffer().equals(offers.get(0)));       </span>
<span  style=""> 368                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 369          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-1175553281482923867" onmouseenter="enter('-1175553281482923867');" onmouseout="out('-1175553281482923867');" style=""><abbr title=" 370          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 370          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 371          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 372                                                                                                                    </span>
<span class="8365537088151996583" onmouseenter="enter('8365537088151996583');" onmouseout="out('8365537088151996583');" style=""> 373          //test that the invalid fg offer is excluded - zipcode is wrong                                           </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 374          assertTrue(qualifiedOffers.size() == 0);                                                                  </span>
<span  style=""> 375                                                                                                                    </span>
<span class="8107460504466880499" onmouseenter="enter('8107460504466880499');" onmouseout="out('8107460504466880499');" style=""> 376          qualifiedOffers = new ArrayList&lt;PromotableCandidateFulfillmentGroupOffer&gt;();                              </span>
<span class="-1725928204111497608" onmouseenter="enter('-1725928204111497608');" onmouseout="out('-1725928204111497608');" style=""><abbr title=" 377          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;),MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 377          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="7554177343567840064" onmouseenter="enter('7554177343567840064');" onmouseout="out('7554177343567840064');" style=""> 378          fgProcessor.filterFulfillmentGroupLevelOffer(order, qualifiedOffers, offers.get(0));                      </span>
<span  style=""> 379                                                                                                                    </span>
<span class="-6532959924497274331" onmouseenter="enter('-6532959924497274331');" onmouseout="out('-6532959924497274331');" style=""> 380          //test that the invalid fg offer is excluded - no qualifying items                                        </span>
<span class="5374855092322283448" onmouseenter="enter('5374855092322283448');" onmouseout="out('5374855092322283448');" style=""> 381          assertTrue(qualifiedOffers.size() == 0);                                                                  </span>
<span  style=""> 382                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 383          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384      }                                                                                                             </span>
<span  style=""> 385                                                                                                                    </span>
<span class="-4776997419015764151" onmouseenter="enter('-4776997419015764151');" onmouseout="out('-4776997419015764151');" style=""> 386      public void testCouldOfferApplyToFulfillmentGroup() {                                                         </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 387          replay();                                                                                                 </span>
<span  style=""> 388                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 389          PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>

<span class="145544884351987069" onmouseenter="enter('145544884351987069');" onmouseout="out('145544884351987069');" style=""><abbr title=" 390          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF);"> 390          List&lt;Offer&gt; offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.adðŸ”µ</abbr></span>
<span class="6925194278348061796" onmouseenter="enter('6925194278348061796');" onmouseout="out('6925194278348061796');" style=""><abbr title=" 391          boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 391          boolean couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGrouðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 392          //test that the valid fg offer is included                                                                </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 393          assertTrue(couldApply);                                                                                   </span>
<span  style=""> 394                                                                                                                    </span>
<span class="-3097227128962316937" onmouseenter="enter('-3097227128962316937');" onmouseout="out('-3097227128962316937');" style=""><abbr title=" 395          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75240&quot;, OfferDiscountType.PERCENT_OFF);"> 395          offers = dataProvider.createFGBasedOffer(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalðŸ”µ</abbr></span>
<span class="-1233560991880639261" onmouseenter="enter('-1233560991880639261');" onmouseout="out('-1233560991880639261');" style=""><abbr title=" 396          couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().get(0));"> 396          couldApply = fgProcessor.couldOfferApplyToFulfillmentGroup(offers.get(0), order.getFulfillmentGroups().getðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 397          //test that the invalid fg offer is excluded                                                              </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 398          assertFalse(couldApply);                                                                                  </span>
<span  style=""> 399                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 400          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401      }                                                                                                             </span>
<span  style=""> 402                                                                                                                    </span>
<span class="3929316778716445185" onmouseenter="enter('3929316778716445185');" onmouseout="out('3929316778716445185');" style=""> 403      public void testCouldOrderItemMeetOfferRequirement() {                                                        </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 404          replay();                                                                                                 </span>
<span  style=""> 405                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 406          PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>

<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 407          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 407          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulðŸ”µ</abbr></span>
<span class="1501673451570831850" onmouseenter="enter('1501673451570831850');" onmouseout="out('1501673451570831850');" style=""> 408          OfferQualifyingCriteriaXref xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();       </span>
<span class="7919750782802558587" onmouseenter="enter('7919750782802558587');" onmouseout="out('7919750782802558587');" style=""><abbr title=" 409          boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 409          boolean couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getðŸ”µ</abbr></span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 410          //test that the valid fg offer is included                                                                </span>
<span class="7931914881113900287" onmouseenter="enter('7931914881113900287');" onmouseout="out('7931914881113900287');" style=""> 411          assertTrue(couldApply);                                                                                   </span>
<span  style=""> 412                                                                                                                    </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 413          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 413          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="2238137642305281390" onmouseenter="enter('2238137642305281390');" onmouseout="out('2238137642305281390');" style=""> 414          xref = offers.get(0).getQualifyingItemCriteriaXref().iterator().next();                                   </span>
<span class="-3043998037798990151" onmouseenter="enter('-3043998037798990151');" onmouseout="out('-3043998037798990151');" style=""><abbr title=" 415          couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountableOrderItems().get(0));"> 415          couldApply = fgProcessor.couldOrderItemMeetOfferRequirement(xref.getOfferItemCriteria(), order.getDiscountðŸ”µ</abbr></span>
<span class="8589960938578432825" onmouseenter="enter('8589960938578432825');" onmouseout="out('8589960938578432825');" style=""> 416          //test that the invalid fg offer is excluded                                                              </span>
<span class="2773091290643222945" onmouseenter="enter('2773091290643222945');" onmouseout="out('2773091290643222945');" style=""> 417          assertFalse(couldApply);                                                                                  </span>
<span  style=""> 418                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 419          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420      }                                                                                                             </span>
<span  style=""> 421                                                                                                                    </span>
<span class="-4499124276559625962" onmouseenter="enter('-4499124276559625962');" onmouseout="out('-4499124276559625962');" style=""> 422      public void testCouldOfferApplyToOrderItems() {                                                               </span>
<span class="3282532397622388039" onmouseenter="enter('3282532397622388039');" onmouseout="out('3282532397622388039');" style=""> 423          replay();                                                                                                 </span>
<span  style=""> 424                                                                                                                    </span>
<span class="-7122718500348489334" onmouseenter="enter('-7122718500348489334');" onmouseout="out('-7122718500348489334');" style=""> 425          PromotableOrder order = dataProvider.createBasicPromotableOrder();                                        </span>

<span  style=""> 426                                                                                                                    </span>
<span class="-4222545078163101091" onmouseenter="enter('-4222545078163101091');" onmouseout="out('-4222545078163101091');" style=""> 427          List&lt;PromotableOrderItem&gt; orderItems = new ArrayList&lt;PromotableOrderItem&gt;();                              </span>
<span class="-7372483979901719352" onmouseenter="enter('-7372483979901719352');" onmouseout="out('-7372483979901719352');" style=""> 428          for (PromotableOrderItem orderItem : order.getDiscountableOrderItems()) {                                 </span>
<span class="5423314879443576267" onmouseenter="enter('5423314879443576267');" onmouseout="out('5423314879443576267');" style=""> 429              orderItems.add(orderItem);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430          }                                                                                                         </span>
<span  style=""> 431                                                                                                                    </span>
<span class="-4158574972890114491" onmouseenter="enter('-4158574972890114491');" onmouseout="out('-4158574972890114491');" style=""><abbr title=" 432          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test1\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test2\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 432          List&lt;Offer&gt; offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulðŸ”µ</abbr></span>
<span class="8410448623592275924" onmouseenter="enter('8410448623592275924');" onmouseout="out('8410448623592275924');" style=""> 433          CandidatePromotionItems candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);  </span>
<span class="-5309500565940282875" onmouseenter="enter('-5309500565940282875');" onmouseout="out('-5309500565940282875');" style=""> 434          //test that the valid fg offer is included                                                                </span>
<span class="4437229577970519009" onmouseenter="enter('4437229577970519009');" onmouseout="out('4437229577970519009');" style=""> 435          assertTrue(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);        </span>
<span  style=""> 436                                                                                                                    </span>
<span class="-9084925119620672108" onmouseenter="enter('-9084925119620672108');" onmouseout="out('-9084925119620672108');" style=""><abbr title=" 437          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGroup.address.postalCode==75244&quot;, OfferDiscountType.PERCENT_OFF, &quot;([MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test5\&quot;), MVEL.eval(\&quot;toUpperCase()\&quot;,\&quot;test6\&quot;)] contains MVEL.eval(\&quot;toUpperCase()\&quot;, discreteOrderItem.category.name))&quot;);"> 437          offers = dataProvider.createFGBasedOfferWithItemCriteria(&quot;order.subTotal.getAmount()&gt;20&quot;, &quot;fulfillmentGrouðŸ”µ</abbr></span>
<span class="-3576845332244688046" onmouseenter="enter('-3576845332244688046');" onmouseout="out('-3576845332244688046');" style=""> 438          candidates = fgProcessor.couldOfferApplyToOrderItems(offers.get(0), orderItems);                          </span>
<span class="6941245118706647267" onmouseenter="enter('6941245118706647267');" onmouseout="out('6941245118706647267');" style=""> 439          //test that the invalid fg offer is excluded because there are no qualifying items                        </span>
<span class="-265242688274418245" onmouseenter="enter('-265242688274418245');" onmouseout="out('-265242688274418245');" style=""> 440          assertFalse(candidates.isMatchedQualifier() &amp;&amp; candidates.getCandidateQualifiersMap().size() == 1);       </span>
<span  style=""> 441                                                                                                                    </span>
<span class="-5058292317233132506" onmouseenter="enter('-5058292317233132506');" onmouseout="out('-5058292317233132506');" style=""> 442          verify();                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443      }                                                                                                             </span>
<span  style=""> 444                                                                                                                    </span>
<span class="5648347102432971432" onmouseenter="enter('5648347102432971432');" onmouseout="out('5648347102432971432');" style=""> 445      public class CandidateFulfillmentGroupOfferAnswer implements IAnswer&lt;CandidateFulfillmentGroupOffer&gt; {        </span>
<span  style=""> 446                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 447          @Override                                                                                                 </span>
<span class="-3723008217761904240" onmouseenter="enter('-3723008217761904240');" onmouseout="out('-3723008217761904240');" style=""> 448          public CandidateFulfillmentGroupOffer answer() throws Throwable {                                         </span>
<span class="-8755543066605634487" onmouseenter="enter('-8755543066605634487');" onmouseout="out('-8755543066605634487');" style=""> 449              return new CandidateFulfillmentGroupOfferImpl();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450          }                                                                                                         </span>
<span  style=""> 451                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452      }                                                                                                             </span>
<span  style=""> 453                                                                                                                    </span>
<span class="3886526384953801028" onmouseenter="enter('3886526384953801028');" onmouseout="out('3886526384953801028');" style=""> 454      public class FulfillmentGroupAdjustmentAnswer implements IAnswer&lt;FulfillmentGroupAdjustment&gt; {                </span>
<span  style=""> 455                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 456          @Override                                                                                                 </span>
<span class="2396386951594711402" onmouseenter="enter('2396386951594711402');" onmouseout="out('2396386951594711402');" style=""> 457          public FulfillmentGroupAdjustment answer() throws Throwable {                                             </span>
<span class="4220759534941126036" onmouseenter="enter('4220759534941126036');" onmouseout="out('4220759534941126036');" style=""> 458              return new FulfillmentGroupAdjustmentImpl();                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459          }                                                                                                         </span>
<span  style=""> 460                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461      }                                                                                                             </span>
<span  style=""> 462                                                                                                                    </span>
<span class="1687502207616012454" onmouseenter="enter('1687502207616012454');" onmouseout="out('1687502207616012454');" style=""> 463      public class CandidateItemOfferAnswer implements IAnswer&lt;CandidateItemOffer&gt; {                                </span>
<span  style=""> 464                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 465          @Override                                                                                                 </span>
<span class="2347184973793483651" onmouseenter="enter('2347184973793483651');" onmouseout="out('2347184973793483651');" style=""> 466          public CandidateItemOffer answer() throws Throwable {                                                     </span>
<span class="7644422100596500085" onmouseenter="enter('7644422100596500085');" onmouseout="out('7644422100596500085');" style=""> 467              return new CandidateItemOfferImpl();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468          }                                                                                                         </span>
<span  style=""> 469                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470      }                                                                                                             </span>
<span  style=""> 471                                                                                                                    </span>
<span class="6834818405609520876" onmouseenter="enter('6834818405609520876');" onmouseout="out('6834818405609520876');" style=""> 472      public class OrderItemAdjustmentAnswer implements IAnswer&lt;OrderItemAdjustment&gt; {                              </span>
<span  style=""> 473                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 474          @Override                                                                                                 </span>
<span class="4861248105020273136" onmouseenter="enter('4861248105020273136');" onmouseout="out('4861248105020273136');" style=""> 475          public OrderItemAdjustment answer() throws Throwable {                                                    </span>
<span class="7697130786892874769" onmouseenter="enter('7697130786892874769');" onmouseout="out('7697130786892874769');" style=""> 476              return new OrderItemAdjustmentImpl();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477          }                                                                                                         </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 479      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            