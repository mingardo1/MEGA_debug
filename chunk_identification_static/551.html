<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>551</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    551
                    <a href="550.html">prev</a>
                    <a href="552.html">next</a>
                    <a href="551_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Freeyourgadget/Gadgetbridge_3d3cc1f40c276a539644cd45b9b3c3739158b11d_app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/charts/AbstractChartFragment.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;3d3cc1f40c276a539644cd45b9b3c3739158b11d:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/charts/AbstractChartFragment.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;3d3cc1f40c276a539644cd45b9b3c3739158b11d^1:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/charts/AbstractChartFragment.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;3d3cc1f40c276a539644cd45b9b3c3739158b11d^2:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/charts/AbstractChartFragment.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;4d7c6974971d0a8bbe6791a734c339e68652f652:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/activities/charts/AbstractChartFragment.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-5200878630337924680" onmouseenter="enter('-5200878630337924680');" onmouseout="out('-5200878630337924680');" style="">   1 /*  Copyright (C) 2015-2018 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                   </span>
<span class="2448951400902124304" onmouseenter="enter('2448951400902124304');" onmouseout="out('2448951400902124304');" style="">   2     Daniele Gobbetti, walkjivefly                                                                        </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="8669690300131154388" onmouseenter="enter('8669690300131154388');" onmouseout="out('8669690300131154388');" style="">  18 package nodomain.freeyourgadget.gadgetbridge.activities.charts;                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-489389385851058391" onmouseenter="enter('-489389385851058391');" onmouseout="out('-489389385851058391');" style="">  20 import android.content.BroadcastReceiver;                                                                </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  21 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  22 import android.content.Intent;                                                                           </span>
<span class="8697221465021235869" onmouseenter="enter('8697221465021235869');" onmouseout="out('8697221465021235869');" style="">  23 import android.content.IntentFilter;                                                                     </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  24 import android.os.AsyncTask;                                                                             </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  25 import android.os.Bundle;                                                                                </span>
<span class="4394652512097310678" onmouseenter="enter('4394652512097310678');" onmouseout="out('4394652512097310678');" style="">  26 import android.support.annotation.Nullable;                                                              </span>
<span class="5561867782528330628" onmouseenter="enter('5561867782528330628');" onmouseout="out('5561867782528330628');" style="">  27 import android.support.v4.app.FragmentActivity;                                                          </span>
<span class="-3586823955743508894" onmouseenter="enter('-3586823955743508894');" onmouseout="out('-3586823955743508894');" style="">  28 import android.support.v4.content.ContextCompat;                                                         </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  29 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  30 import android.util.TypedValue;                                                                          </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  31 import android.view.View;                                                                                </span>
<span  style="">  32                                                                                                          </span>
<span class="2052752975691556393" onmouseenter="enter('2052752975691556393');" onmouseout="out('2052752975691556393');" style="">  33 import com.github.mikephil.charting.charts.BarChart;                                                     </span>
<span class="-7530008699315861247" onmouseenter="enter('-7530008699315861247');" onmouseout="out('-7530008699315861247');" style="">  34 import com.github.mikephil.charting.charts.BarLineChartBase;                                             </span>
<span class="-2340851656771232402" onmouseenter="enter('-2340851656771232402');" onmouseout="out('-2340851656771232402');" style="">  35 import com.github.mikephil.charting.charts.Chart;                                                        </span>
<span class="1306294111757562979" onmouseenter="enter('1306294111757562979');" onmouseout="out('1306294111757562979');" style="">  36 import com.github.mikephil.charting.components.AxisBase;                                                 </span>
<span class="-968159151538268968" onmouseenter="enter('-968159151538268968');" onmouseout="out('-968159151538268968');" style="">  37 import com.github.mikephil.charting.components.YAxis;                                                    </span>
<span class="4145381455536678498" onmouseenter="enter('4145381455536678498');" onmouseout="out('4145381455536678498');" style="">  38 import com.github.mikephil.charting.data.ChartData;                                                      </span>
<span class="-6979157771929244358" onmouseenter="enter('-6979157771929244358');" onmouseout="out('-6979157771929244358');" style="">  39 import com.github.mikephil.charting.data.Entry;                                                          </span>
<span class="-1647496247863422182" onmouseenter="enter('-1647496247863422182');" onmouseout="out('-1647496247863422182');" style="">  40 import com.github.mikephil.charting.data.LineData;                                                       </span>
<span class="-2418175485781437143" onmouseenter="enter('-2418175485781437143');" onmouseout="out('-2418175485781437143');" style="">  41 import com.github.mikephil.charting.data.LineDataSet;                                                    </span>
<span class="5272555707203763230" onmouseenter="enter('5272555707203763230');" onmouseout="out('5272555707203763230');" style="">  42 import com.github.mikephil.charting.formatter.IAxisValueFormatter;                                       </span>
<span class="2256452517983808356" onmouseenter="enter('2256452517983808356');" onmouseout="out('2256452517983808356');" style="">  43 import com.github.mikephil.charting.interfaces.datasets.ILineDataSet;                                    </span>
<span  style="">  44                                                                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  45 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  46 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  48 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  49 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  50 import java.util.Arrays;                                                                                 </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  51 import java.util.Calendar;                                                                               </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  52 import java.util.Date;                                                                                   </span>
<span class="-4685965902094386510" onmouseenter="enter('-4685965902094386510');" onmouseout="out('-4685965902094386510');" style="">  53 import java.util.GregorianCalendar;                                                                      </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  55 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  56 import java.util.Set;                                                                                    </span>
<span  style="">  57                                                                                                          </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                               </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="5401974517372835423" onmouseenter="enter('5401974517372835423');" onmouseout="out('5401974517372835423');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.activities.AbstractGBFragment;                               </span>
<span class="-7512545990884107322" onmouseenter="enter('-7512545990884107322');" onmouseout="out('-7512545990884107322');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;                                   </span>
<span class="-7899456532042317044" onmouseenter="enter('-7899456532042317044');" onmouseout="out('-7899456532042317044');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.database.DBAccess;                                           </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="6852267181356803593" onmouseenter="enter('6852267181356803593');" onmouseout="out('6852267181356803593');" style="">  64 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;                                   </span>
<span class="-4858662006453759829" onmouseenter="enter('-4858662006453759829');" onmouseout="out('-4858662006453759829');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.devices.SampleProvider;                                      </span>
<span class="6164643418103516215" onmouseenter="enter('6164643418103516215');" onmouseout="out('6164643418103516215');" style="">  66 import nodomain.freeyourgadget.gadgetbridge.entities.AbstractActivitySample;                             </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  67 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="5185434099904652174" onmouseenter="enter('5185434099904652174');" onmouseout="out('5185434099904652174');" style="">  68 import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind;                                          </span>
<span class="-4763610359710127205" onmouseenter="enter('-4763610359710127205');" onmouseout="out('-4763610359710127205');" style="">  69 import nodomain.freeyourgadget.gadgetbridge.model.ActivitySample;                                        </span>
<span class="-904534361809820117" onmouseenter="enter('-904534361809820117');" onmouseout="out('-904534361809820117');" style="">  70 import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils;                                          </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  71 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span  style="">  72                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73 /**                                                                                                      </span>
<span class="4382979016472627606" onmouseenter="enter('4382979016472627606');" onmouseout="out('4382979016472627606');" style="">  74  * A base class fragment to be used with ChartsActivity. The fragment can supply                         </span>
<span class="6198461617436424812" onmouseenter="enter('6198461617436424812');" onmouseout="out('6198461617436424812');" style="">  75  * a title to be displayed in the activity by returning non-null in #getTitle()                          </span>
<span class="-6728528830408447290" onmouseenter="enter('-6728528830408447290');" onmouseout="out('-6728528830408447290');" style="">  76  * Broadcast events can be received by overriding #onReceive(Context,Intent).                            </span>
<span class="-8995811574793439040" onmouseenter="enter('-8995811574793439040');" onmouseout="out('-8995811574793439040');" style="">  77  * The chart can be refreshed by calling #refresh()                                                      </span>
<span class="7522934711128650596" onmouseenter="enter('7522934711128650596');" onmouseout="out('7522934711128650596');" style="">  78  * Implement refreshInBackground(DBHandler, GBDevice) to fetch the samples from the DB,                  </span>
<span class="-6728676085228773380" onmouseenter="enter('-6728676085228773380');" onmouseout="out('-6728676085228773380');" style="">  79  * and add the samples to the chart. The actual rendering, which must be performed in the UI             </span>
<span class="-8407485021089725057" onmouseenter="enter('-8407485021089725057');" onmouseout="out('-8407485021089725057');" style="">  80  * thread, must be done in #renderCharts().                                                              </span>
<span class="-4722043031183050825" onmouseenter="enter('-4722043031183050825');" onmouseout="out('-4722043031183050825');" style="">  81  * Access functionality of the hosting activity with #getHost()                                          </span>
<span class="4294780129258405519" onmouseenter="enter('4294780129258405519');" onmouseout="out('4294780129258405519');" style="">  82  * &lt;p/&gt;                                                                                                  </span>
<span class="4386326732920470462" onmouseenter="enter('4386326732920470462');" onmouseout="out('4386326732920470462');" style="">  83  * The hosting ChartsHost activity provides a section for displaying a date or date range                </span>
<span class="6958843947366179987" onmouseenter="enter('6958843947366179987');" onmouseout="out('6958843947366179987');" style="">  84  * being the basis for the chart, as well as two buttons for moving backwards and forward                </span>
<span class="2417558347604794742" onmouseenter="enter('2417558347604794742');" onmouseout="out('2417558347604794742');" style="">  85  * in time. The date is held by the activity, so that it can be shared by multiple chart                 </span>
<span class="7607748487874207999" onmouseenter="enter('7607748487874207999');" onmouseout="out('7607748487874207999');" style="">  86  * fragments. It is still the responsibility of the (currently visible) chart fragment                   </span>
<span class="-3870094542515027002" onmouseenter="enter('-3870094542515027002');" onmouseout="out('-3870094542515027002');" style="">  87  * to set the desired date in the ChartsActivity via #setDateRange(Date,Date).                           </span>
<span class="3680713202748276357" onmouseenter="enter('3680713202748276357');" onmouseout="out('3680713202748276357');" style="">  88  * The default implementations #handleDatePrev(Date,Date) and #handleDateNext(Date,Date)                 </span>
<span class="-222466413472697410" onmouseenter="enter('-222466413472697410');" onmouseout="out('-222466413472697410');" style="">  89  * shift the date by one day.                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90  */                                                                                                      </span>
<span class="559507359319980575" onmouseenter="enter('559507359319980575');" onmouseout="out('559507359319980575');" style="">  91 public abstract class AbstractChartFragment extends AbstractGBFragment {                                 </span>
<span class="-5476773025248141464" onmouseenter="enter('-5476773025248141464');" onmouseout="out('-5476773025248141464');" style="">  92     protected final int ANIM_TIME = 250;                                                                 </span>
<span  style="">  93                                                                                                          </span>
<span class="2603683647820710396" onmouseenter="enter('2603683647820710396');" onmouseout="out('2603683647820710396');" style="">  94     private static final Logger LOG = LoggerFactory.getLogger(AbstractChartFragment.class);              </span>
<span  style="">  95                                                                                                          </span>
<span class="-7304707645666720924" onmouseenter="enter('-7304707645666720924');" onmouseout="out('-7304707645666720924');" style="">  96     private final Set&lt;String&gt; mIntentFilterActions;                                                      </span>
<span class="4625474178666977899" onmouseenter="enter('4625474178666977899');" onmouseout="out('4625474178666977899');" style="">  97     private final BroadcastReceiver mReceiver = new BroadcastReceiver() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  98         @Override                                                                                        </span>
<span class="-1520739091809898546" onmouseenter="enter('-1520739091809898546');" onmouseout="out('-1520739091809898546');" style="">  99         public void onReceive(Context context, Intent intent) {                                          </span>
<span class="1765483774466236680" onmouseenter="enter('1765483774466236680');" onmouseout="out('1765483774466236680');" style=""> 100             AbstractChartFragment.this.onReceive(context, intent);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 102     };                                                                                                   </span>
<span class="-5489121822050726001" onmouseenter="enter('-5489121822050726001');" onmouseout="out('-5489121822050726001');" style=""> 103     private boolean mChartDirty = true;                                                                  </span>
<span class="-5677382414532787847" onmouseenter="enter('-5677382414532787847');" onmouseout="out('-5677382414532787847');" style=""> 104     private AsyncTask refreshTask;                                                                       </span>
<span  style=""> 105                                                                                                          </span>
<span class="-4343134957952038703" onmouseenter="enter('-4343134957952038703');" onmouseout="out('-4343134957952038703');" style=""> 106     public boolean isChartDirty() {                                                                      </span>
<span class="-2572162510293790028" onmouseenter="enter('-2572162510293790028');" onmouseout="out('-2572162510293790028');" style=""> 107         return mChartDirty;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="-601773936482381085" onmouseenter="enter('-601773936482381085');" onmouseout="out('-601773936482381085');" style=""> 111     public abstract String getTitle();                                                                   </span>
<span  style=""> 112                                                                                                          </span>
<span class="-6644558066866151773" onmouseenter="enter('-6644558066866151773');" onmouseout="out('-6644558066866151773');" style=""> 113     public boolean supportsHeartrate(GBDevice device) {                                                  </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 114         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="-7840206560907481536" onmouseenter="enter('-7840206560907481536');" onmouseout="out('-7840206560907481536');" style=""> 115         return coordinator != null &amp;&amp; coordinator.supportsHeartRateMeasurement(device);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-8993184091203127788" onmouseenter="enter('-8993184091203127788');" onmouseout="out('-8993184091203127788');" style=""> 118     protected static final class ActivityConfig {                                                        </span>
<span class="-6704927139853267025" onmouseenter="enter('-6704927139853267025');" onmouseout="out('-6704927139853267025');" style=""> 119         public final int type;                                                                           </span>
<span class="8777140454183587055" onmouseenter="enter('8777140454183587055');" onmouseout="out('8777140454183587055');" style=""> 120         public final String label;                                                                       </span>
<span class="-5618013352645865591" onmouseenter="enter('-5618013352645865591');" onmouseout="out('-5618013352645865591');" style=""> 121         public final Integer color;                                                                      </span>
<span  style=""> 122                                                                                                          </span>
<span class="-5628392649151863187" onmouseenter="enter('-5628392649151863187');" onmouseout="out('-5628392649151863187');" style=""> 123         public ActivityConfig(int kind, String label, Integer color) {                                   </span>
<span class="-7354691670901086033" onmouseenter="enter('-7354691670901086033');" onmouseout="out('-7354691670901086033');" style=""> 124             this.type = kind;                                                                            </span>
<span class="-6752321514731327997" onmouseenter="enter('-6752321514731327997');" onmouseout="out('-6752321514731327997');" style=""> 125             this.label = label;                                                                          </span>
<span class="-589508620284177092" onmouseenter="enter('-589508620284177092');" onmouseout="out('-589508620284177092');" style=""> 126             this.color = color;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="-727072152722713884" onmouseenter="enter('-727072152722713884');" onmouseout="out('-727072152722713884');" style=""> 130     protected ActivityConfig akActivity;                                                                 </span>
<span class="1693165293269506698" onmouseenter="enter('1693165293269506698');" onmouseout="out('1693165293269506698');" style=""> 131     protected ActivityConfig akLightSleep;                                                               </span>
<span class="1060880569004609468" onmouseenter="enter('1060880569004609468');" onmouseout="out('1060880569004609468');" style=""> 132     protected ActivityConfig akDeepSleep;                                                                </span>
<span class="-4297327045522896814" onmouseenter="enter('-4297327045522896814');" onmouseout="out('-4297327045522896814');" style=""> 133     protected ActivityConfig akNotWorn;                                                                  </span>
<span  style=""> 134                                                                                                          </span>
<span  style=""> 135                                                                                                          </span>
<span class="-1563135362317192224" onmouseenter="enter('-1563135362317192224');" onmouseout="out('-1563135362317192224');" style=""> 136     protected int BACKGROUND_COLOR;                                                                      </span>
<span class="4601305514601887958" onmouseenter="enter('4601305514601887958');" onmouseout="out('4601305514601887958');" style=""> 137     protected int DESCRIPTION_COLOR;                                                                     </span>
<span class="-3468694148212670828" onmouseenter="enter('-3468694148212670828');" onmouseout="out('-3468694148212670828');" style=""> 138     protected int CHART_TEXT_COLOR;                                                                      </span>
<span class="655929690321793162" onmouseenter="enter('655929690321793162');" onmouseout="out('655929690321793162');" style=""> 139     protected int LEGEND_TEXT_COLOR;                                                                     </span>
<span class="-6693974409973768071" onmouseenter="enter('-6693974409973768071');" onmouseout="out('-6693974409973768071');" style=""> 140     protected int HEARTRATE_COLOR;                                                                       </span>
<span class="7021362809515932268" onmouseenter="enter('7021362809515932268');" onmouseout="out('7021362809515932268');" style=""> 141     protected int HEARTRATE_FILL_COLOR;                                                                  </span>
<span class="-4670234814499331326" onmouseenter="enter('-4670234814499331326');" onmouseout="out('-4670234814499331326');" style=""> 142     protected int AK_ACTIVITY_COLOR;                                                                     </span>
<span class="-5660897269888657930" onmouseenter="enter('-5660897269888657930');" onmouseout="out('-5660897269888657930');" style=""> 143     protected int AK_DEEP_SLEEP_COLOR;                                                                   </span>
<span class="-91394691221270038" onmouseenter="enter('-91394691221270038');" onmouseout="out('-91394691221270038');" style=""> 144     protected int AK_LIGHT_SLEEP_COLOR;                                                                  </span>
<span class="1634608154221638802" onmouseenter="enter('1634608154221638802');" onmouseout="out('1634608154221638802');" style=""> 145     protected int AK_NOT_WORN_COLOR;                                                                     </span>
<span  style=""> 146                                                                                                          </span>
<span class="-1398408580326282750" onmouseenter="enter('-1398408580326282750');" onmouseout="out('-1398408580326282750');" style=""> 147     protected String HEARTRATE_LABEL;                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="-2100943369183848946" onmouseenter="enter('-2100943369183848946');" onmouseout="out('-2100943369183848946');" style=""> 149     protected AbstractChartFragment(String... intentFilterActions) {                                     </span>
<span class="4300273923814153332" onmouseenter="enter('4300273923814153332');" onmouseout="out('4300273923814153332');" style=""> 150         mIntentFilterActions = new HashSet&lt;&gt;();                                                          </span>
<span class="1794017280726845715" onmouseenter="enter('1794017280726845715');" onmouseout="out('1794017280726845715');" style=""> 151         if (intentFilterActions != null) {                                                               </span>
<span class="-5245442559338563943" onmouseenter="enter('-5245442559338563943');" onmouseout="out('-5245442559338563943');" style=""> 152             mIntentFilterActions.addAll(Arrays.asList(intentFilterActions));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153         }                                                                                                </span>
<span class="-8699894582101860078" onmouseenter="enter('-8699894582101860078');" onmouseout="out('-8699894582101860078');" style=""> 154         mIntentFilterActions.add(ChartsHost.DATE_NEXT);                                                  </span>
<span class="6561361583014083383" onmouseenter="enter('6561361583014083383');" onmouseout="out('6561361583014083383');" style=""> 155         mIntentFilterActions.add(ChartsHost.DATE_PREV);                                                  </span>
<span class="775005401617860596" onmouseenter="enter('775005401617860596');" onmouseout="out('775005401617860596');" style=""> 156         mIntentFilterActions.add(ChartsHost.REFRESH);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 159     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 160     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 161         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 162                                                                                                          </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 163         init();                                                                                          </span>
<span  style=""> 164                                                                                                          </span>
<span class="1309295186849327913" onmouseenter="enter('1309295186849327913');" onmouseout="out('1309295186849327913');" style=""> 165         IntentFilter filter = new IntentFilter();                                                        </span>
<span class="6467646639596248655" onmouseenter="enter('6467646639596248655');" onmouseout="out('6467646639596248655');" style=""> 166         for (String action : mIntentFilterActions) {                                                     </span>
<span class="-2086107330814500487" onmouseenter="enter('-2086107330814500487');" onmouseout="out('-2086107330814500487');" style=""> 167             filter.addAction(action);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168         }                                                                                                </span>
<span class="3395895708962590803" onmouseenter="enter('3395895708962590803');" onmouseout="out('3395895708962590803');" style=""> 169         LocalBroadcastManager.getInstance(getActivity()).registerReceiver(mReceiver, filter);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="-2182533896997661648" onmouseenter="enter('-2182533896997661648');" onmouseout="out('-2182533896997661648');" style=""> 172     protected void init() {                                                                              </span>
<span class="-4278963507477628649" onmouseenter="enter('-4278963507477628649');" onmouseout="out('-4278963507477628649');" style=""> 173         TypedValue runningColor = new TypedValue();                                                      </span>
<span class="2364262805070128994" onmouseenter="enter('2364262805070128994');" onmouseout="out('2364262805070128994');" style=""> 174         BACKGROUND_COLOR = GBApplication.getBackgroundColor(getContext());                               </span>
<span class="4636662852620032981" onmouseenter="enter('4636662852620032981');" onmouseout="out('4636662852620032981');" style=""> 175         LEGEND_TEXT_COLOR = DESCRIPTION_COLOR = GBApplication.getTextColor(getContext());                </span>
<span class="7979803013168270964" onmouseenter="enter('7979803013168270964');" onmouseout="out('7979803013168270964');" style=""> 176         CHART_TEXT_COLOR = ContextCompat.getColor(getContext(), R.color.secondarytext);                  </span>
<span class="-5448842132740870532" onmouseenter="enter('-5448842132740870532');" onmouseout="out('-5448842132740870532');" style=""> 177         HEARTRATE_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate);                 </span>
<span class="3818219289719008809" onmouseenter="enter('3818219289719008809');" onmouseout="out('3818219289719008809');" style=""> 178         HEARTRATE_FILL_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate_fill);       </span>
<span class="-658032213271338857" onmouseenter="enter('-658032213271338857');" onmouseout="out('-658032213271338857');" style=""> 179         getContext().getTheme().resolveAttribute(R.attr.chart_activity, runningColor, true);             </span>
<span class="3784973835189342522" onmouseenter="enter('3784973835189342522');" onmouseout="out('3784973835189342522');" style=""> 180         AK_ACTIVITY_COLOR = runningColor.data;                                                           </span>
<span class="-7347375883805936743" onmouseenter="enter('-7347375883805936743');" onmouseout="out('-7347375883805936743');" style=""> 181         getContext().getTheme().resolveAttribute(R.attr.chart_deep_sleep, runningColor, true);           </span>
<span class="9138233377044964354" onmouseenter="enter('9138233377044964354');" onmouseout="out('9138233377044964354');" style=""> 182         AK_DEEP_SLEEP_COLOR = runningColor.data;                                                         </span>
<span class="-7879866390823759405" onmouseenter="enter('-7879866390823759405');" onmouseout="out('-7879866390823759405');" style=""> 183         getContext().getTheme().resolveAttribute(R.attr.chart_light_sleep, runningColor, true);          </span>
<span class="-7375963623584937470" onmouseenter="enter('-7375963623584937470');" onmouseout="out('-7375963623584937470');" style=""> 184         AK_LIGHT_SLEEP_COLOR = runningColor.data;                                                        </span>
<span class="-4015774126818841529" onmouseenter="enter('-4015774126818841529');" onmouseout="out('-4015774126818841529');" style=""> 185         getContext().getTheme().resolveAttribute(R.attr.chart_not_worn, runningColor, true);             </span>
<span class="-5596972182818856924" onmouseenter="enter('-5596972182818856924');" onmouseout="out('-5596972182818856924');" style=""> 186         AK_NOT_WORN_COLOR = runningColor.data;                                                           </span>
<span  style=""> 187                                                                                                          </span>
<span class="-8151372900676559714" onmouseenter="enter('-8151372900676559714');" onmouseout="out('-8151372900676559714');" style=""> 188         HEARTRATE_LABEL = getContext().getString(R.string.charts_legend_heartrate);                      </span>
<span  style=""> 189                                                                                                          </span>
<span class="7336078921795716816" onmouseenter="enter('7336078921795716816');" onmouseout="out('7336078921795716816');" style=""><abbr title=" 190         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kind_activity), AK_ACTIVITY_COLOR);"> 190         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fraðŸ”µ</abbr></span>
<span class="7421775491088103388" onmouseenter="enter('7421775491088103388');" onmouseout="out('7421775491088103388');" style=""><abbr title=" 191         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragment_kind_light_sleep), AK_LIGHT_SLEEP_COLOR);"> 191         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_charðŸ”µ</abbr></span>
<span class="-7577615369032967062" onmouseenter="enter('-7577615369032967062');" onmouseout="out('-7577615369032967062');" style=""><abbr title=" 192         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_kind_deep_sleep), AK_DEEP_SLEEP_COLOR);"> 192         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_ðŸ”µ</abbr></span>
<span class="4963911460392329978" onmouseenter="enter('4963911460392329978');" onmouseout="out('4963911460392329978');" style=""><abbr title=" 193         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kind_not_worn), AK_NOT_WORN_COLOR);"> 193         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="-495990486128602071" onmouseenter="enter('-495990486128602071');" onmouseout="out('-495990486128602071');" style=""> 196     private void setStartDate(Date date) {                                                               </span>
<span class="-1228970384434949212" onmouseenter="enter('-1228970384434949212');" onmouseout="out('-1228970384434949212');" style=""> 197         getChartsHost().setStartDate(date);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="2390100272250745956" onmouseenter="enter('2390100272250745956');" onmouseout="out('2390100272250745956');" style=""> 200     @Nullable                                                                                            </span>
<span class="3611118571382248517" onmouseenter="enter('3611118571382248517');" onmouseout="out('3611118571382248517');" style=""> 201     protected ChartsHost getChartsHost() {                                                               </span>
<span class="2661597057438137706" onmouseenter="enter('2661597057438137706');" onmouseout="out('2661597057438137706');" style=""> 202         return (ChartsHost) getActivity();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203     }                                                                                                    </span>
<span  style=""> 204                                                                                                          </span>
<span class="-1308916602749590522" onmouseenter="enter('-1308916602749590522');" onmouseout="out('-1308916602749590522');" style=""> 205     private void setEndDate(Date date) {                                                                 </span>
<span class="-3659353165994754543" onmouseenter="enter('-3659353165994754543');" onmouseout="out('-3659353165994754543');" style=""> 206         getChartsHost().setEndDate(date);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-2894059945991900133" onmouseenter="enter('-2894059945991900133');" onmouseout="out('-2894059945991900133');" style=""> 209     public Date getStartDate() {                                                                         </span>
<span class="8926139361389921832" onmouseenter="enter('8926139361389921832');" onmouseout="out('8926139361389921832');" style=""> 210         return getChartsHost().getStartDate();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="2846153489913780034" onmouseenter="enter('2846153489913780034');" onmouseout="out('2846153489913780034');" style=""> 213     public Date getEndDate() {                                                                           </span>
<span class="7835534291730041186" onmouseenter="enter('7835534291730041186');" onmouseout="out('7835534291730041186');" style=""> 214         return getChartsHost().getEndDate();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215     }                                                                                                    </span>
<span  style=""> 216                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 217     /**                                                                                                  </span>
<span class="3608187799695399223" onmouseenter="enter('3608187799695399223');" onmouseout="out('3608187799695399223');" style=""> 218      * Called when this fragment has been fully scrolled into the activity.                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 219      *                                                                                                   </span>
<span class="-6064668654679903662" onmouseenter="enter('-6064668654679903662');" onmouseout="out('-6064668654679903662');" style=""> 220      * @see #isVisibleInActivity()                                                                       </span>
<span class="-4201783166293447700" onmouseenter="enter('-4201783166293447700');" onmouseout="out('-4201783166293447700');" style=""> 221      * @see #onMadeInvisibleInActivity()                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 222      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 223     @Override                                                                                            </span>
<span class="-7073731466333062745" onmouseenter="enter('-7073731466333062745');" onmouseout="out('-7073731466333062745');" style=""> 224     protected void onMadeVisibleInActivity() {                                                           </span>
<span class="-2940429388425730341" onmouseenter="enter('-2940429388425730341');" onmouseout="out('-2940429388425730341');" style=""> 225         super.onMadeVisibleInActivity();                                                                 </span>
<span class="4333568825348773807" onmouseenter="enter('4333568825348773807');" onmouseout="out('4333568825348773807');" style=""> 226         showDateBar(true);                                                                               </span>
<span class="371374127972335382" onmouseenter="enter('371374127972335382');" onmouseout="out('371374127972335382');" style=""> 227         if (isChartDirty()) {                                                                            </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 228             refresh();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230     }                                                                                                    </span>
<span  style=""> 231                                                                                                          </span>
<span class="-2587903292449818582" onmouseenter="enter('-2587903292449818582');" onmouseout="out('-2587903292449818582');" style=""> 232     protected void showDateBar(boolean show) {                                                           </span>
<span class="1102668729830068636" onmouseenter="enter('1102668729830068636');" onmouseout="out('1102668729830068636');" style=""> 233         getChartsHost().getDateBar().setVisibility(show ? View.VISIBLE : View.INVISIBLE);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236     @Override                                                                                            </span>
<span class="658855826062432633" onmouseenter="enter('658855826062432633');" onmouseout="out('658855826062432633');" style=""> 237     public void onDestroy() {                                                                            </span>
<span class="7275190530034972367" onmouseenter="enter('7275190530034972367');" onmouseout="out('7275190530034972367');" style=""> 238         super.onDestroy();                                                                               </span>
<span class="-1904828397138023848" onmouseenter="enter('-1904828397138023848');" onmouseout="out('-1904828397138023848');" style=""> 239         LocalBroadcastManager.getInstance(getActivity()).unregisterReceiver(mReceiver);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240     }                                                                                                    </span>
<span  style=""> 241                                                                                                          </span>
<span class="-6518874138984288541" onmouseenter="enter('-6518874138984288541');" onmouseout="out('-6518874138984288541');" style=""> 242     protected void onReceive(Context context, Intent intent) {                                           </span>
<span class="5344227773413700857" onmouseenter="enter('5344227773413700857');" onmouseout="out('5344227773413700857');" style=""> 243         String action = intent.getAction();                                                              </span>
<span class="-494993687329631312" onmouseenter="enter('-494993687329631312');" onmouseout="out('-494993687329631312');" style=""> 244         if (ChartsHost.REFRESH.equals(action)) {                                                         </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 245             refresh();                                                                                   </span>
<span class="8208351658473141292" onmouseenter="enter('8208351658473141292');" onmouseout="out('8208351658473141292');" style=""> 246         } else if (ChartsHost.DATE_NEXT.equals(action)) {                                                </span>
<span class="3429530462558527400" onmouseenter="enter('3429530462558527400');" onmouseout="out('3429530462558527400');" style=""> 247             handleDateNext(getStartDate(), getEndDate());                                                </span>
<span class="6275594107476882748" onmouseenter="enter('6275594107476882748');" onmouseout="out('6275594107476882748');" style=""> 248         } else if (ChartsHost.DATE_PREV.equals(action)) {                                                </span>
<span class="-3035508152708713619" onmouseenter="enter('-3035508152708713619');" onmouseout="out('-3035508152708713619');" style=""> 249             handleDatePrev(getStartDate(), getEndDate());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251     }                                                                                                    </span>
<span  style=""> 252                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 253     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 254      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 255      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 256      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 257      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 258      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259      */                                                                                                  </span>
<span class="-3047400271509647247" onmouseenter="enter('-3047400271509647247');" onmouseout="out('-3047400271509647247');" style=""> 260     protected void handleDatePrev(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 261         if (isVisibleInActivity()) {                                                                     </span>
<span class="-2651860554468779719" onmouseenter="enter('-2651860554468779719');" onmouseout="out('-2651860554468779719');" style=""> 262             if (!shiftDates(startDate, endDate, -1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 263                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 266         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267     }                                                                                                    </span>
<span  style=""> 268                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 270      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 271      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 272      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 273      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 274      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 275      */                                                                                                  </span>
<span class="6615897495863858801" onmouseenter="enter('6615897495863858801');" onmouseout="out('6615897495863858801');" style=""> 276     protected void handleDateNext(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 277         if (isVisibleInActivity()) {                                                                     </span>
<span class="-6485278970310858803" onmouseenter="enter('-6485278970310858803');" onmouseout="out('-6485278970310858803');" style=""> 278             if (!shiftDates(startDate, endDate, +1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 279                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 282         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="5798655654202275728" onmouseenter="enter('5798655654202275728');" onmouseout="out('5798655654202275728');" style=""> 285     protected void refreshIfVisible() {                                                                  </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 286         if (isVisibleInActivity()) {                                                                     </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 287             refresh();                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 288         } else {                                                                                         </span>
<span class="427958345432566734" onmouseenter="enter('427958345432566734');" onmouseout="out('427958345432566734');" style=""> 289             mChartDirty = true;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293     /**                                                                                                  </span>
<span class="-6717682359676050907" onmouseenter="enter('-6717682359676050907');" onmouseout="out('-6717682359676050907');" style=""> 294      * Shifts the given dates by offset days. offset may be positive or negative.                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 296      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 297      * @param endDate                                                                                    </span>
<span class="-3834083067366288846" onmouseenter="enter('-3834083067366288846');" onmouseout="out('-3834083067366288846');" style=""> 298      * @param offset    a positive or negative number of days to shift the dates                         </span>
<span class="-6460740145491493882" onmouseenter="enter('-6460740145491493882');" onmouseout="out('-6460740145491493882');" style=""> 299      * @return true if the shift was successful and false otherwise                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 300      */                                                                                                  </span>
<span class="-1942902413678210438" onmouseenter="enter('-1942902413678210438');" onmouseout="out('-1942902413678210438');" style=""> 301     protected boolean shiftDates(Date startDate, Date endDate, int offset) {                             </span>
<span class="-6336809523669087720" onmouseenter="enter('-6336809523669087720');" onmouseout="out('-6336809523669087720');" style=""> 302         Date newStart = DateTimeUtils.shiftByDays(startDate, offset);                                    </span>
<span class="-2733879703924959637" onmouseenter="enter('-2733879703924959637');" onmouseout="out('-2733879703924959637');" style=""> 303         Date newEnd = DateTimeUtils.shiftByDays(endDate, offset);                                        </span>
<span  style=""> 304                                                                                                          </span>
<span class="-2856611894499161319" onmouseenter="enter('-2856611894499161319');" onmouseout="out('-2856611894499161319');" style=""> 305         return setDateRange(newStart, newEnd);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="-5091098020443224535" onmouseenter="enter('-5091098020443224535');" onmouseout="out('-5091098020443224535');" style=""> 308     protected Integer getColorFor(int activityKind) {                                                    </span>
<span class="1068460219870485515" onmouseenter="enter('1068460219870485515');" onmouseout="out('1068460219870485515');" style=""> 309         switch (activityKind) {                                                                          </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 310             case ActivityKind.TYPE_DEEP_SLEEP:                                                           </span>
<span class="5022727203055802055" onmouseenter="enter('5022727203055802055');" onmouseout="out('5022727203055802055');" style=""> 311                 return akDeepSleep.color;                                                                </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 312             case ActivityKind.TYPE_LIGHT_SLEEP:                                                          </span>
<span class="9202598133274813026" onmouseenter="enter('9202598133274813026');" onmouseout="out('9202598133274813026');" style=""> 313                 return akLightSleep.color;                                                               </span>
<span class="-1944461592116084883" onmouseenter="enter('-1944461592116084883');" onmouseout="out('-1944461592116084883');" style=""> 314             case ActivityKind.TYPE_ACTIVITY:                                                             </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 315                 return akActivity.color;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316         }                                                                                                </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 317         return akActivity.color;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318     }                                                                                                    </span>
<span  style=""> 319                                                                                                          </span>
<span class="7124995295832055820" onmouseenter="enter('7124995295832055820');" onmouseout="out('7124995295832055820');" style=""><abbr title=" 320     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device) {"> 320     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device)ðŸ”µ</abbr></span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 321         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="5252113264335521833" onmouseenter="enter('5252113264335521833');" onmouseout="out('5252113264335521833');" style=""> 322         return coordinator.getSampleProvider(device, db.getDaoSession());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323     }                                                                                                    </span>
<span  style=""> 324                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 325     /**                                                                                                  </span>
<span class="3872148434859025386" onmouseenter="enter('3872148434859025386');" onmouseout="out('3872148434859025386');" style=""> 326      * Returns all kinds of samples for the given device.                                                </span>
<span class="886766698730034078" onmouseenter="enter('886766698730034078');" onmouseout="out('886766698730034078');" style=""> 327      * To be called from a background thread.                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 328      *                                                                                                   </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 329      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 330      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 331      * @param tsTo                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332      */                                                                                                  </span>
<span class="3140984125721729972" onmouseenter="enter('3140984125721729972');" onmouseout="out('3140984125721729972');" style=""><abbr title=" 333     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 333     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, intðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 334         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="3618633972640587810" onmouseenter="enter('3618633972640587810');" onmouseout="out('3618633972640587810');" style=""> 335         return provider.getAllActivitySamples(tsFrom, tsTo);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336     }                                                                                                    </span>
<span  style=""> 337                                                                                                          </span>
<span class="911814376404307930" onmouseenter="enter('911814376404307930');" onmouseout="out('911814376404307930');" style=""><abbr title=" 338     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 338     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, inðŸ”µ</abbr></span>
<span class="5136693054641003501" onmouseenter="enter('5136693054641003501');" onmouseout="out('5136693054641003501');" style=""> 339         SampleProvider&lt;? extends AbstractActivitySample&gt; provider = getProvider(db, device);             </span>
<span class="85967298499632314" onmouseenter="enter('85967298499632314');" onmouseout="out('85967298499632314');" style=""> 340         return provider.getActivitySamples(tsFrom, tsTo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341     }                                                                                                    </span>
<span  style=""> 342                                                                                                          </span>
<span  style=""> 343                                                                                                          </span>
<span class="-241747733905569263" onmouseenter="enter('-241747733905569263');" onmouseout="out('-241747733905569263');" style=""><abbr title=" 344     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 344     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, iðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 345         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="-5906481120950290774" onmouseenter="enter('-5906481120950290774');" onmouseout="out('-5906481120950290774');" style=""> 346         return provider.getSleepSamples(tsFrom, tsTo);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="5612092723136709042" onmouseenter="enter('5612092723136709042');" onmouseout="out('5612092723136709042');" style=""> 349     protected void configureChartDefaults(Chart&lt;?&gt; chart) {                                              </span>
<span class="-7606632580747532983" onmouseenter="enter('-7606632580747532983');" onmouseout="out('-7606632580747532983');" style=""> 350         chart.getXAxis().setValueFormatter(new TimestampValueFormatter());                               </span>
<span class="6778504947781910997" onmouseenter="enter('6778504947781910997');" onmouseout="out('6778504947781910997');" style=""> 351         chart.getDescription().setText(&quot;&quot;);                                                              </span>
<span  style=""> 352                                                                                                          </span>
<span class="24609561265320879" onmouseenter="enter('24609561265320879');" onmouseout="out('24609561265320879');" style=""> 353         // if enabled, the chart will always start at zero on the y-axis                                 </span>
<span class="6529846037374092564" onmouseenter="enter('6529846037374092564');" onmouseout="out('6529846037374092564');" style=""> 354         chart.setNoDataText(getString(R.string.chart_no_data_synchronize));                              </span>
<span  style=""> 355                                                                                                          </span>
<span class="2162327714476306626" onmouseenter="enter('2162327714476306626');" onmouseout="out('2162327714476306626');" style=""> 356         // disable value highlighting                                                                    </span>
<span class="-1590348432070259774" onmouseenter="enter('-1590348432070259774');" onmouseout="out('-1590348432070259774');" style=""> 357         chart.setHighlightPerTapEnabled(false);                                                          </span>
<span  style=""> 358                                                                                                          </span>
<span class="-348919351774733305" onmouseenter="enter('-348919351774733305');" onmouseout="out('-348919351774733305');" style=""> 359         // enable touch gestures                                                                         </span>
<span class="5289310484488287391" onmouseenter="enter('5289310484488287391');" onmouseout="out('5289310484488287391');" style=""> 360         chart.setTouchEnabled(true);                                                                     </span>
<span  style=""> 361                                                                                                          </span>
<span class="-6098879767425938051" onmouseenter="enter('-6098879767425938051');" onmouseout="out('-6098879767425938051');" style=""> 362 // commented out: this has weird bugs/sideeffects at least on WeekStepsCharts                            </span>
<span class="8784253570401363075" onmouseenter="enter('8784253570401363075');" onmouseout="out('8784253570401363075');" style=""> 363 // where only the first Day-label is drawn, because AxisRenderer.computeAxisValues(float,float)          </span>
<span class="-8770575613400395593" onmouseenter="enter('-8770575613400395593');" onmouseout="out('-8770575613400395593');" style=""> 364 // appears to have an overflow when calculating &#x27;n&#x27; (number of entries)                                  </span>
<span class="3888896009006521991" onmouseenter="enter('3888896009006521991');" onmouseout="out('3888896009006521991');" style=""> 365 //        chart.getXAxis().setGranularity(60*5);                                                         </span>
<span  style=""> 366                                                                                                          </span>
<span class="5634570376801469004" onmouseenter="enter('5634570376801469004');" onmouseout="out('5634570376801469004');" style=""> 367         setupLegend(chart);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368     }                                                                                                    </span>
<span  style=""> 369                                                                                                          </span>
<span class="-1924974321468626199" onmouseenter="enter('-1924974321468626199');" onmouseout="out('-1924974321468626199');" style=""> 370     protected void configureBarLineChartDefaults(BarLineChartBase&lt;?&gt; chart) {                            </span>
<span class="5467508404297658352" onmouseenter="enter('5467508404297658352');" onmouseout="out('5467508404297658352');" style=""> 371         configureChartDefaults(chart);                                                                   </span>
<span class="-8169200756215735113" onmouseenter="enter('-8169200756215735113');" onmouseout="out('-8169200756215735113');" style=""> 372         if (chart instanceof BarChart) {                                                                 </span>
<span class="2718779115389378256" onmouseenter="enter('2718779115389378256');" onmouseout="out('2718779115389378256');" style=""> 373             ((BarChart) chart).setFitBars(true);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374         }                                                                                                </span>
<span  style=""> 375                                                                                                          </span>
<span class="-1346367465809520237" onmouseenter="enter('-1346367465809520237');" onmouseout="out('-1346367465809520237');" style=""> 376         // enable scaling and dragging                                                                   </span>
<span class="165705574276177801" onmouseenter="enter('165705574276177801');" onmouseout="out('165705574276177801');" style=""> 377         chart.setDragEnabled(true);                                                                      </span>
<span class="6107382641746821998" onmouseenter="enter('6107382641746821998');" onmouseout="out('6107382641746821998');" style=""> 378         chart.setScaleEnabled(true);                                                                     </span>
<span  style=""> 379                                                                                                          </span>
<span class="6424277115851676497" onmouseenter="enter('6424277115851676497');" onmouseout="out('6424277115851676497');" style=""> 380         // if disabled, scaling can be done on x- and y-axis separately                                  </span>
<span class="6432377865510855871" onmouseenter="enter('6432377865510855871');" onmouseout="out('6432377865510855871');" style=""> 381 //        chart.setPinchZoom(true);                                                                      </span>
<span  style=""> 382                                                                                                          </span>
<span class="-3757744149975665581" onmouseenter="enter('-3757744149975665581');" onmouseout="out('-3757744149975665581');" style=""> 383         chart.setDrawGridBackground(false);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384     }                                                                                                    </span>
<span  style=""> 385                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 386     /**                                                                                                  </span>
<span class="5100165395414783914" onmouseenter="enter('5100165395414783914');" onmouseout="out('5100165395414783914');" style=""> 387      * This method will invoke a background task to read the data from the                               </span>
<span class="5027852704688867372" onmouseenter="enter('5027852704688867372');" onmouseout="out('5027852704688867372');" style=""> 388      * database, analyze it, prepare it for the charts and eventually call                               </span>
<span class="-3918098027409993360" onmouseenter="enter('-3918098027409993360');" onmouseout="out('-3918098027409993360');" style=""> 389      * #renderCharts                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 390      */                                                                                                  </span>
<span class="2809394791911169685" onmouseenter="enter('2809394791911169685');" onmouseout="out('2809394791911169685');" style=""> 391     protected void refresh() {                                                                           </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 392         ChartsHost chartsHost = getChartsHost();                                                         </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 393         if (chartsHost != null) {                                                                        </span>
<span class="-103873194966226890" onmouseenter="enter('-103873194966226890');" onmouseout="out('-103873194966226890');" style=""> 394             if (chartsHost.getDevice() != null) {                                                        </span>
<span class="-5198511171031023043" onmouseenter="enter('-5198511171031023043');" onmouseout="out('-5198511171031023043');" style=""> 395                 mChartDirty = false;                                                                     </span>
<span class="7622323496435283090" onmouseenter="enter('7622323496435283090');" onmouseout="out('7622323496435283090');" style=""> 396                 updateDateInfo(getStartDate(), getEndDate());                                            </span>
<span class="3165810198377965313" onmouseenter="enter('3165810198377965313');" onmouseout="out('3165810198377965313');" style=""> 397                 if (refreshTask != null &amp;&amp; refreshTask.getStatus() != AsyncTask.Status.FINISHED) {       </span>
<span class="-3108005745869946167" onmouseenter="enter('-3108005745869946167');" onmouseout="out('-3108005745869946167');" style=""> 398                     refreshTask.cancel(true);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399                 }                                                                                        </span>
<span class="3840488977465298517" onmouseenter="enter('3840488977465298517');" onmouseout="out('3840488977465298517');" style=""> 400                 refreshTask = createRefreshTask(&quot;Visualizing data&quot;, getActivity()).execute();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403     }                                                                                                    </span>
<span  style=""> 404                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 405     /**                                                                                                  </span>
<span class="4268529485699346115" onmouseenter="enter('4268529485699346115');" onmouseout="out('4268529485699346115');" style=""> 406      * This method reads the data from the database, analyzes and prepares it for                        </span>
<span class="-3790527174834636702" onmouseenter="enter('-3790527174834636702');" onmouseout="out('-3790527174834636702');" style=""> 407      * the charts. This will be called from a background task, so there must not be                      </span>
<span class="8892366747213531989" onmouseenter="enter('8892366747213531989');" onmouseout="out('8892366747213531989');" style=""><abbr title=" 408      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this method."> 408      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this mðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 409      */                                                                                                  </span>
<span class="-9167766646201984999" onmouseenter="enter('-9167766646201984999');" onmouseout="out('-9167766646201984999');" style=""><abbr title=" 410     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice device);"> 410     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice devicðŸ”µ</abbr></span>
<span  style=""> 411                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 412     /**                                                                                                  </span>
<span class="7668378754224811352" onmouseenter="enter('7668378754224811352');" onmouseout="out('7668378754224811352');" style=""> 413      * Triggers the actual (re-) rendering of the chart.                                                 </span>
<span class="1258740047847480611" onmouseenter="enter('1258740047847480611');" onmouseout="out('1258740047847480611');" style=""> 414      * Always called from the UI thread.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 415      */                                                                                                  </span>
<span class="4159836083754598607" onmouseenter="enter('4159836083754598607');" onmouseout="out('4159836083754598607');" style=""> 416     protected abstract void renderCharts();                                                              </span>
<span  style=""> 417                                                                                                          </span>
<span class="1142774420965375266" onmouseenter="enter('1142774420965375266');" onmouseout="out('1142774420965375266');" style=""><abbr title=" 418     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samples) {"> 418     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samplðŸ”µ</abbr></span>
<span class="2571942157260224234" onmouseenter="enter('2571942157260224234');" onmouseout="out('2571942157260224234');" style=""> 419 //        Calendar cal = GregorianCalendar.getInstance();                                                </span>
<span class="4401062856956877488" onmouseenter="enter('4401062856956877488');" onmouseout="out('4401062856956877488');" style=""> 420 //        cal.clear();                                                                                   </span>
<span class="6028849563211801820" onmouseenter="enter('6028849563211801820');" onmouseout="out('6028849563211801820');" style=""> 421         TimestampTranslation tsTranslation = new TimestampTranslation();                                 </span>
<span class="-53760276184898045" onmouseenter="enter('-53760276184898045');" onmouseout="out('-53760276184898045');" style=""> 422 //        Date date;                                                                                     </span>
<span class="-6156197187638932942" onmouseenter="enter('-6156197187638932942');" onmouseout="out('-6156197187638932942');" style=""> 423 //        String dateStringFrom = &quot;&quot;;                                                                    </span>
<span class="4183977243651978214" onmouseenter="enter('4183977243651978214');" onmouseout="out('4183977243651978214');" style=""> 424 //        String dateStringTo = &quot;&quot;;                                                                      </span>
<span class="147032316452628113" onmouseenter="enter('147032316452628113');" onmouseout="out('147032316452628113');" style=""> 425 //        ArrayList&lt;String&gt; xLabels = null;                                                              </span>
<span  style=""> 426                                                                                                          </span>
<span class="-8827232702598725695" onmouseenter="enter('-8827232702598725695');" onmouseout="out('-8827232702598725695');" style=""> 427         LOG.info(&quot;&quot; + getTitle() + &quot;: number of samples:&quot; + samples.size());                             </span>
<span class="3654763384087017314" onmouseenter="enter('3654763384087017314');" onmouseout="out('3654763384087017314');" style=""> 428         LineData lineData;                                                                               </span>
<span class="-9107937003987659062" onmouseenter="enter('-9107937003987659062');" onmouseout="out('-9107937003987659062');" style=""> 429         if (samples.size() &gt; 1) {                                                                        </span>
<span class="-8527306736668810111" onmouseenter="enter('-8527306736668810111');" onmouseout="out('-8527306736668810111');" style=""> 430             boolean annotate = true;                                                                     </span>
<span class="1395829712909105015" onmouseenter="enter('1395829712909105015');" onmouseout="out('1395829712909105015');" style=""> 431             boolean use_steps_as_movement;                                                               </span>
<span  style=""> 432                                                                                                          </span>
<span class="4142243867024174482" onmouseenter="enter('4142243867024174482');" onmouseout="out('4142243867024174482');" style=""> 433             int last_type = ActivityKind.TYPE_UNKNOWN;                                                   </span>
<span  style=""> 434                                                                                                          </span>
<span class="-2031252584474024476" onmouseenter="enter('-2031252584474024476');" onmouseout="out('-2031252584474024476');" style=""> 435             int numEntries = samples.size();                                                             </span>
<span class="-8870011066494287543" onmouseenter="enter('-8870011066494287543');" onmouseout="out('-8870011066494287543');" style=""> 436             List&lt;Entry&gt; activityEntries = new ArrayList&lt;&gt;(numEntries);                                   </span>
<span class="4899105382649046594" onmouseenter="enter('4899105382649046594');" onmouseout="out('4899105382649046594');" style=""> 437             List&lt;Entry&gt; deepSleepEntries = new ArrayList&lt;&gt;(numEntries);                                  </span>
<span class="7486237668847997910" onmouseenter="enter('7486237668847997910');" onmouseout="out('7486237668847997910');" style=""> 438             List&lt;Entry&gt; lightSleepEntries = new ArrayList&lt;&gt;(numEntries);                                 </span>
<span class="-1233994828972266903" onmouseenter="enter('-1233994828972266903');" onmouseout="out('-1233994828972266903');" style=""> 439             List&lt;Entry&gt; notWornEntries = new ArrayList&lt;&gt;(numEntries);                                    </span>
<span class="-7435551010854374427" onmouseenter="enter('-7435551010854374427');" onmouseout="out('-7435551010854374427');" style=""> 440             boolean hr = supportsHeartrate(gbDevice);                                                    </span>
<span class="-5348686395661515277" onmouseenter="enter('-5348686395661515277');" onmouseout="out('-5348686395661515277');" style=""> 441             List&lt;Entry&gt; heartrateEntries = hr ? new ArrayList&lt;Entry&gt;(numEntries) : null;                 </span>
<span class="8656271717087272693" onmouseenter="enter('8656271717087272693');" onmouseout="out('8656271717087272693');" style=""> 442             List&lt;Integer&gt; colors = new ArrayList&lt;&gt;(numEntries); // this is kinda inefficient...          </span>
<span class="7529735733952592718" onmouseenter="enter('7529735733952592718');" onmouseout="out('7529735733952592718');" style=""> 443             int lastHrSampleIndex = -1;                                                                  </span>
<span  style=""> 444                                                                                                          </span>
<span class="4476749361735409543" onmouseenter="enter('4476749361735409543');" onmouseout="out('4476749361735409543');" style=""> 445             for (int i = 0; i &lt; numEntries; i++) {                                                       </span>
<span class="3246332292526896189" onmouseenter="enter('3246332292526896189');" onmouseout="out('3246332292526896189');" style=""> 446                 ActivitySample sample = samples.get(i);                                                  </span>
<span class="6576081203602242327" onmouseenter="enter('6576081203602242327');" onmouseout="out('6576081203602242327');" style=""> 447                 int type = sample.getKind();                                                             </span>
<span class="-9213760672368715167" onmouseenter="enter('-9213760672368715167');" onmouseout="out('-9213760672368715167');" style=""> 448                 int ts = tsTranslation.shorten(sample.getTimestamp());                                   </span>
<span  style=""> 449                                                                                                          </span>
<span class="-6141709027769286674" onmouseenter="enter('-6141709027769286674');" onmouseout="out('-6141709027769286674');" style=""> 450 //                System.out.println(ts);                                                                </span>
<span class="1901381804146795461" onmouseenter="enter('1901381804146795461');" onmouseout="out('1901381804146795461');" style=""> 451 //                ts = i;                                                                                </span>
<span class="5764290091373211945" onmouseenter="enter('5764290091373211945');" onmouseout="out('5764290091373211945');" style=""> 452                 // determine start and end dates                                                         </span>
<span class="5717361089680993355" onmouseenter="enter('5717361089680993355');" onmouseout="out('5717361089680993355');" style=""> 453 //                if (i == 0) {                                                                          </span>
<span class="7046397249359147146" onmouseenter="enter('7046397249359147146');" onmouseout="out('7046397249359147146');" style=""> 454 //                    cal.setTimeInMillis(ts * 1000L); // make sure it&#x27;s converted to long               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 455 //                    date = cal.getTime();                                                              </span>
<span class="5571666638688830790" onmouseenter="enter('5571666638688830790');" onmouseout="out('5571666638688830790');" style=""> 456 //                    dateStringFrom = dateFormat.format(date);                                          </span>
<span class="-1516242143504559710" onmouseenter="enter('-1516242143504559710');" onmouseout="out('-1516242143504559710');" style=""> 457 //                } else if (i == samples.size() - 1) {                                                  </span>
<span class="241708909740168031" onmouseenter="enter('241708909740168031');" onmouseout="out('241708909740168031');" style=""> 458 //                    cal.setTimeInMillis(ts * 1000L); // same here                                      </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 459 //                    date = cal.getTime();                                                              </span>
<span class="993250294615949060" onmouseenter="enter('993250294615949060');" onmouseout="out('993250294615949060');" style=""> 460 //                    dateStringTo = dateFormat.format(date);                                            </span>
<span class="8884174724223176501" onmouseenter="enter('8884174724223176501');" onmouseout="out('8884174724223176501');" style=""> 461 //                }                                                                                      </span>
<span  style=""> 462                                                                                                          </span>
<span class="-8914675673971344704" onmouseenter="enter('-8914675673971344704');" onmouseout="out('-8914675673971344704');" style=""> 463                 float movement = sample.getIntensity();                                                  </span>
<span  style=""> 464                                                                                                          </span>
<span class="5917499164651721508" onmouseenter="enter('5917499164651721508');" onmouseout="out('5917499164651721508');" style=""> 465                 float value = movement;                                                                  </span>
<span class="3474584951622682325" onmouseenter="enter('3474584951622682325');" onmouseout="out('3474584951622682325');" style=""> 466                 switch (type) {                                                                          </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 467                     case ActivityKind.TYPE_DEEP_SLEEP:                                                   </span>
<span class="8800766899670031569" onmouseenter="enter('8800766899670031569');" onmouseout="out('8800766899670031569');" style=""><abbr title=" 468                         if (last_type != type) { //FIXME: this is ugly but it works (repeated in each case)"> 468                         if (last_type != type) { //FIXME: this is ugly but it works (repeated in each casðŸ”µ</abbr></span>
<span class="-1661959904957213102" onmouseenter="enter('-1661959904957213102');" onmouseout="out('-1661959904957213102');" style=""> 469                             deepSleepEntries.add(createLineEntry(0, ts - 1));                            </span>
<span  style=""> 470                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 471                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 472                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 473                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                         }                                                                                </span>
<span class="-6180311285798694701" onmouseenter="enter('-6180311285798694701');" onmouseout="out('-6180311285798694701');" style=""> 475                         deepSleepEntries.add(createLineEntry(value + SleepUtils.Y_VALUE_DEEP_SLEEP, ts));</span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 476                         break;                                                                           </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 477                     case ActivityKind.TYPE_LIGHT_SLEEP:                                                  </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 478                         if (last_type != type) {                                                         </span>
<span class="7147575638574677011" onmouseenter="enter('7147575638574677011');" onmouseout="out('7147575638574677011');" style=""> 479                             lightSleepEntries.add(createLineEntry(0, ts - 1));                           </span>
<span  style=""> 480                                                                                                          </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 481                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 482                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 483                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                         }                                                                                </span>
<span class="-5875750109358144719" onmouseenter="enter('-5875750109358144719');" onmouseout="out('-5875750109358144719');" style=""> 485                         lightSleepEntries.add(createLineEntry(value, ts));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 486                         break;                                                                           </span>
<span class="-9132572973740238507" onmouseenter="enter('-9132572973740238507');" onmouseout="out('-9132572973740238507');" style=""> 487                     case ActivityKind.TYPE_NOT_WORN:                                                     </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 488                         if (last_type != type) {                                                         </span>
<span class="4292609800559774054" onmouseenter="enter('4292609800559774054');" onmouseout="out('4292609800559774054');" style=""> 489                             notWornEntries.add(createLineEntry(0, ts - 1));                              </span>
<span  style=""> 490                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 491                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 492                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 493                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494                         }                                                                                </span>
<span class="5412917281309595074" onmouseenter="enter('5412917281309595074');" onmouseout="out('5412917281309595074');" style=""><abbr title=" 495                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, just to show something on the graphs"> 495                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a smallðŸ”µ</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 496                         break;                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 497                     default:                                                                             </span>
<span class="-4054780187002246392" onmouseenter="enter('-4054780187002246392');" onmouseout="out('-4054780187002246392');" style=""> 498 //                        short steps = sample.getSteps();                                               </span>
<span class="-1494320471491276911" onmouseenter="enter('-1494320471491276911');" onmouseout="out('-1494320471491276911');" style=""> 499 //                        if (use_steps_as_movement &amp;&amp; steps != 0) {                                     </span>
<span class="-3251198952450992064" onmouseenter="enter('-3251198952450992064');" onmouseout="out('-3251198952450992064');" style=""> 500 //                            // I&#x27;m not sure using steps for this is actually a good idea               </span>
<span class="-6376968801115210935" onmouseenter="enter('-6376968801115210935');" onmouseout="out('-6376968801115210935');" style=""> 501 //                            movement = steps;                                                          </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 502 //                        }                                                                              </span>
<span class="-941684175082606672" onmouseenter="enter('-941684175082606672');" onmouseout="out('-941684175082606672');" style=""> 503 //                        value = ((float) movement) / movement_divisor;                                 </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 504                         if (last_type != type) {                                                         </span>
<span class="-6771781995837807247" onmouseenter="enter('-6771781995837807247');" onmouseout="out('-6771781995837807247');" style=""> 505                             activityEntries.add(createLineEntry(0, ts - 1));                             </span>
<span  style=""> 506                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 507                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 508                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 509                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510                         }                                                                                </span>
<span class="4080308283196262910" onmouseenter="enter('4080308283196262910');" onmouseout="out('4080308283196262910');" style=""> 511                         activityEntries.add(createLineEntry(value, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                 }                                                                                        </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 513 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="678415431212127122" onmouseenter="enter('678415431212127122');" onmouseout="out('678415431212127122');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 514                 if (hr &amp;&amp; HeartRateUtils.isValidHeartRateValue(sample.getHeartRate())) {                 </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 515 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="6502915003910560814" onmouseenter="enter('6502915003910560814');" onmouseout="out('6502915003910560814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 516                 if (hr &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {                                </span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 517                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 517                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEAðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 518 =======                                                                                                  </span>
<span class="6904435308673061248" onmouseenter="enter('6904435308673061248');" onmouseout="out('6904435308673061248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 519                 if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {"> 519                 if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.ðŸ”µ</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 520 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style=""><abbr title=" 521                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 521                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEAðŸ”µ</abbr></span>
<span class="7928119684647429254" onmouseenter="enter('7928119684647429254');" onmouseout="out('7928119684647429254');" style=""> 522                         heartrateEntries.add(createLineEntry(0, lastHrSampleIndex + 1));                 </span>
<span class="-5182503479458455454" onmouseenter="enter('-5182503479458455454');" onmouseout="out('-5182503479458455454');" style=""> 523                         heartrateEntries.add(createLineEntry(0, ts - 1));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524                     }                                                                                    </span>
<span  style=""> 525                                                                                                          </span>
<span class="-8554726460294545666" onmouseenter="enter('-8554726460294545666');" onmouseout="out('-8554726460294545666');" style=""> 526                     heartrateEntries.add(createLineEntry(sample.getHeartRate(), ts));                    </span>
<span class="1340167295380328410" onmouseenter="enter('1340167295380328410');" onmouseout="out('1340167295380328410');" style=""> 527                     lastHrSampleIndex = ts;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528                 }                                                                                        </span>
<span  style=""> 529                                                                                                          </span>
<span class="7730925444289024998" onmouseenter="enter('7730925444289024998');" onmouseout="out('7730925444289024998');" style=""> 530                 String xLabel = &quot;&quot;;                                                                      </span>
<span class="-5459254189226498661" onmouseenter="enter('-5459254189226498661');" onmouseout="out('-5459254189226498661');" style=""> 531                 if (annotate) {                                                                          </span>
<span class="-1465306111701045962" onmouseenter="enter('-1465306111701045962');" onmouseout="out('-1465306111701045962');" style=""> 532 //                    cal.setTimeInMillis((ts + tsOffset) * 1000L);                                      </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 533 //                    date = cal.getTime();                                                              </span>
<span class="-1086602658675179068" onmouseenter="enter('-1086602658675179068');" onmouseout="out('-1086602658675179068');" style=""> 534 //                    String dateString = annotationDateFormat.format(date);                             </span>
<span class="-2931946040942644368" onmouseenter="enter('-2931946040942644368');" onmouseout="out('-2931946040942644368');" style=""> 535 //                    xLabel = dateString;                                                               </span>
<span class="5566449710495547766" onmouseenter="enter('5566449710495547766');" onmouseout="out('5566449710495547766');" style=""> 536 //                    if (last_type != type) {                                                           </span>
<span class="7413255212379424149" onmouseenter="enter('7413255212379424149');" onmouseout="out('7413255212379424149');" style=""> 537 //                        if (isSleep(last_type) &amp;&amp; !isSleep(type)) {                                    </span>
<span class="-56714345320416604" onmouseenter="enter('-56714345320416604');" onmouseout="out('-56714345320416604');" style=""> 538 //                            // woken up                                                                </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 539 //                            LimitLine line = new LimitLine(i, dateString);                             </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 540 //                            line.enableDashedLine(8, 8, 0);                                            </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 541 //                            line.setTextColor(Color.WHITE);                                            </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 542 //                            line.setTextSize(15);                                                      </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 543 //                            chart.getXAxis().addLimitLine(line);                                       </span>
<span class="-5828290692175278159" onmouseenter="enter('-5828290692175278159');" onmouseout="out('-5828290692175278159');" style=""> 544 //                        } else if (!isSleep(last_type) &amp;&amp; isSleep(type)) {                             </span>
<span class="5244181556799794554" onmouseenter="enter('5244181556799794554');" onmouseout="out('5244181556799794554');" style=""> 545 //                            // fallen asleep                                                           </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 546 //                            LimitLine line = new LimitLine(i, dateString);                             </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 547 //                            line.enableDashedLine(8, 8, 0);                                            </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 548 //                            line.setTextSize(15);                                                      </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 549 //                            line.setTextColor(Color.WHITE);                                            </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 550 //                            chart.getXAxis().addLimitLine(line);                                       </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 551 //                        }                                                                              </span>
<span class="6051702211689751699" onmouseenter="enter('6051702211689751699');" onmouseout="out('6051702211689751699');" style=""> 552 //                    }                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 553                 }                                                                                        </span>
<span class="-1444147652675010833" onmouseenter="enter('-1444147652675010833');" onmouseout="out('-1444147652675010833');" style=""> 554                 last_type = type;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555             }                                                                                            </span>
<span  style=""> 556                                                                                                          </span>
<span  style=""> 557                                                                                                          </span>
<span class="-1579194111559420554" onmouseenter="enter('-1579194111559420554');" onmouseout="out('-1579194111559420554');" style=""> 558             List&lt;ILineDataSet&gt; lineDataSets = new ArrayList&lt;&gt;();                                         </span>
<span class="-1359387837948108742" onmouseenter="enter('-1359387837948108742');" onmouseout="out('-1359387837948108742');" style=""> 559             LineDataSet activitySet = createDataSet(activityEntries, akActivity.color, &quot;Activity&quot;);      </span>
<span class="-3354127768405521554" onmouseenter="enter('-3354127768405521554');" onmouseout="out('-3354127768405521554');" style=""> 560             lineDataSets.add(activitySet);                                                               </span>
<span class="7026895411091818045" onmouseenter="enter('7026895411091818045');" onmouseout="out('7026895411091818045');" style=""> 561             LineDataSet deepSleepSet = createDataSet(deepSleepEntries, akDeepSleep.color, &quot;Deep Sleep&quot;); </span>
<span class="-3446958151566211125" onmouseenter="enter('-3446958151566211125');" onmouseout="out('-3446958151566211125');" style=""> 562             lineDataSets.add(deepSleepSet);                                                              </span>
<span class="4693393103163137779" onmouseenter="enter('4693393103163137779');" onmouseout="out('4693393103163137779');" style=""><abbr title=" 563             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light Sleep&quot;);"> 563             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light SleepðŸ”µ</abbr></span>
<span class="8003351674511898289" onmouseenter="enter('8003351674511898289');" onmouseout="out('8003351674511898289');" style=""> 564             lineDataSets.add(lightSleepSet);                                                             </span>
<span class="-7108338871992330028" onmouseenter="enter('-7108338871992330028');" onmouseout="out('-7108338871992330028');" style=""> 565             LineDataSet notWornSet = createDataSet(notWornEntries, akNotWorn.color, &quot;Not worn&quot;);         </span>
<span class="64462528287934820" onmouseenter="enter('64462528287934820');" onmouseout="out('64462528287934820');" style=""> 566             lineDataSets.add(notWornSet);                                                                </span>
<span  style=""> 567                                                                                                          </span>
<span class="-8621348893512609171" onmouseenter="enter('-8621348893512609171');" onmouseout="out('-8621348893512609171');" style=""> 568             if (hr &amp;&amp; heartrateEntries.size() &gt; 0) {                                                     </span>
<span class="-6373591549531816713" onmouseenter="enter('-6373591549531816713');" onmouseout="out('-6373591549531816713');" style=""> 569                 LineDataSet heartrateSet = createHeartrateSet(heartrateEntries, &quot;Heart Rate&quot;);           </span>
<span  style=""> 570                                                                                                          </span>
<span class="8944960460471270621" onmouseenter="enter('8944960460471270621');" onmouseout="out('8944960460471270621');" style=""> 571                 lineDataSets.add(heartrateSet);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572             }                                                                                            </span>
<span class="2703760882318229208" onmouseenter="enter('2703760882318229208');" onmouseout="out('2703760882318229208');" style=""> 573             lineData = new LineData(lineDataSets);                                                       </span>
<span  style=""> 574                                                                                                          </span>
<span class="-6499460759915470269" onmouseenter="enter('-6499460759915470269');" onmouseout="out('-6499460759915470269');" style=""><abbr title=" 575 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStringTo));"> 575 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStriðŸ”µ</abbr></span>
<span class="-3762887228500678217" onmouseenter="enter('-3762887228500678217');" onmouseout="out('-3762887228500678217');" style=""> 576 //            chart.setDescriptionPosition(?, ?);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 577         } else {                                                                                         </span>
<span class="-2761320896669897238" onmouseenter="enter('-2761320896669897238');" onmouseout="out('-2761320896669897238');" style=""> 578             lineData = new LineData();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579         }                                                                                                </span>
<span  style=""> 580                                                                                                          </span>
<span class="-1609543182283032519" onmouseenter="enter('-1609543182283032519');" onmouseout="out('-1609543182283032519');" style=""> 581         IAxisValueFormatter xValueFormatter = new SampleXLabelFormatter(tsTranslation);                  </span>
<span class="-3441797761873957961" onmouseenter="enter('-3441797761873957961');" onmouseout="out('-3441797761873957961');" style=""> 582         return new DefaultChartsData(lineData, xValueFormatter);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583     }                                                                                                    </span>
<span  style=""> 584                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 585     /**                                                                                                  </span>
<span class="6334547652397213625" onmouseenter="enter('6334547652397213625');" onmouseout="out('6334547652397213625');" style=""> 586      * Implement this to supply the samples to be displayed.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 587      *                                                                                                   </span>
<span class="5464670662091686554" onmouseenter="enter('5464670662091686554');" onmouseout="out('5464670662091686554');" style=""> 588      * @param db                                                                                         </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 589      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 590      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 591      * @param tsTo                                                                                       </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 592      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 593      */                                                                                                  </span>
<span class="-4899824222168510613" onmouseenter="enter('-4899824222168510613');" onmouseout="out('-4899824222168510613');" style=""><abbr title=" 594     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo);"> 594     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFroðŸ”µ</abbr></span>
<span  style=""> 595                                                                                                          </span>
<span class="354769125648165857" onmouseenter="enter('354769125648165857');" onmouseout="out('354769125648165857');" style=""> 596     protected abstract void setupLegend(Chart chart);                                                    </span>
<span  style=""> 597                                                                                                          </span>
<span class="-188113346780130145" onmouseenter="enter('-188113346780130145');" onmouseout="out('-188113346780130145');" style=""> 598     protected Entry createLineEntry(float value, int xValue) {                                           </span>
<span class="5155334880625707837" onmouseenter="enter('5155334880625707837');" onmouseout="out('5155334880625707837');" style=""> 599         return new Entry(xValue, value);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600     }                                                                                                    </span>
<span  style=""> 601                                                                                                          </span>
<span class="5268984431672798069" onmouseenter="enter('5268984431672798069');" onmouseout="out('5268984431672798069');" style=""> 602     protected LineDataSet createDataSet(List&lt;Entry&gt; values, Integer color, String label) {               </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 603         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="820149155345415568" onmouseenter="enter('820149155345415568');" onmouseout="out('820149155345415568');" style=""> 604         set1.setColor(color);                                                                            </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 605 //        set1.setDrawCubic(true);                                                                       </span>
<span class="-7031616190320035410" onmouseenter="enter('-7031616190320035410');" onmouseout="out('-7031616190320035410');" style=""> 606 //        set1.setCubicIntensity(0.2f);                                                                  </span>
<span class="5358451272424367352" onmouseenter="enter('5358451272424367352');" onmouseout="out('5358451272424367352');" style=""> 607         set1.setDrawFilled(true);                                                                        </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 608         set1.setDrawCircles(false);                                                                      </span>
<span class="5314519233815368988" onmouseenter="enter('5314519233815368988');" onmouseout="out('5314519233815368988');" style=""> 609 //        set1.setLineWidth(2f);                                                                         </span>
<span class="4052186244749569041" onmouseenter="enter('4052186244749569041');" onmouseout="out('4052186244749569041');" style=""> 610 //        set1.setCircleSize(5f);                                                                        </span>
<span class="5178863964691876958" onmouseenter="enter('5178863964691876958');" onmouseout="out('5178863964691876958');" style=""> 611         set1.setFillColor(color);                                                                        </span>
<span class="-3615467214536174629" onmouseenter="enter('-3615467214536174629');" onmouseout="out('-3615467214536174629');" style=""> 612         set1.setFillAlpha(255);                                                                          </span>
<span class="-2764219564959910542" onmouseenter="enter('-2764219564959910542');" onmouseout="out('-2764219564959910542');" style=""> 613         set1.setDrawValues(false);                                                                       </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 614 //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 615 //        set1.setColor(Color.rgb(89, 178, 44));                                                         </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 616         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="-729266328453548997" onmouseenter="enter('-729266328453548997');" onmouseout="out('-729266328453548997');" style=""> 617         set1.setAxisDependency(YAxis.AxisDependency.LEFT);                                               </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 618         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619     }                                                                                                    </span>
<span  style=""> 620                                                                                                          </span>
<span class="812124301236032885" onmouseenter="enter('812124301236032885');" onmouseout="out('812124301236032885');" style=""> 621     protected LineDataSet createHeartrateSet(List&lt;Entry&gt; values, String label) {                         </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 622         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="5440468726562122008" onmouseenter="enter('5440468726562122008');" onmouseout="out('5440468726562122008');" style=""> 623         set1.setLineWidth(2.2f);                                                                         </span>
<span class="-6998111113207584878" onmouseenter="enter('-6998111113207584878');" onmouseout="out('-6998111113207584878');" style=""> 624         set1.setColor(HEARTRATE_COLOR);                                                                  </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 625 //        set1.setDrawCubic(true);                                                                       </span>
<span class="-5525611047697799836" onmouseenter="enter('-5525611047697799836');" onmouseout="out('-5525611047697799836');" style=""> 626         set1.setMode(LineDataSet.Mode.HORIZONTAL_BEZIER);                                                </span>
<span class="-6788168983082898765" onmouseenter="enter('-6788168983082898765');" onmouseout="out('-6788168983082898765');" style=""> 627         set1.setCubicIntensity(0.1f);                                                                    </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 628         set1.setDrawCircles(false);                                                                      </span>
<span class="8990366444861982417" onmouseenter="enter('8990366444861982417');" onmouseout="out('8990366444861982417');" style=""> 629 //        set1.setCircleRadius(2f);                                                                      </span>
<span class="7490911489692857332" onmouseenter="enter('7490911489692857332');" onmouseout="out('7490911489692857332');" style=""> 630 //        set1.setDrawFilled(true);                                                                      </span>
<span class="-2083836916768378283" onmouseenter="enter('-2083836916768378283');" onmouseout="out('-2083836916768378283');" style=""> 631 //        set1.setColor(getResources().getColor(android.R.color.background_light));                      </span>
<span class="5114874680539545534" onmouseenter="enter('5114874680539545534');" onmouseout="out('5114874680539545534');" style=""> 632 //        set1.setCircleColor(HEARTRATE_COLOR);                                                          </span>
<span class="2152854923555754112" onmouseenter="enter('2152854923555754112');" onmouseout="out('2152854923555754112');" style=""> 633 //        set1.setFillColor(ColorTemplate.getHoloBlue());                                                </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 634 //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 635 //        set1.setColor(Color.rgb(89, 178, 44));                                                         </span>
<span class="-6976214771678818552" onmouseenter="enter('-6976214771678818552');" onmouseout="out('-6976214771678818552');" style=""> 636         set1.setDrawValues(true);                                                                        </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 637         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="7444000937070277499" onmouseenter="enter('7444000937070277499');" onmouseout="out('7444000937070277499');" style=""> 638         set1.setAxisDependency(YAxis.AxisDependency.RIGHT);                                              </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 639         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640     }                                                                                                    </span>
<span  style=""> 641                                                                                                          </span>
<span class="-8033521169229713638" onmouseenter="enter('-8033521169229713638');" onmouseout="out('-8033521169229713638');" style=""> 642     protected RefreshTask createRefreshTask(String task, Context context) {                              </span>
<span class="4652327534384605753" onmouseenter="enter('4652327534384605753');" onmouseout="out('4652327534384605753');" style=""> 643         return new RefreshTask(task, context);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644     }                                                                                                    </span>
<span  style=""> 645                                                                                                          </span>
<span class="-546204840646058388" onmouseenter="enter('-546204840646058388');" onmouseout="out('-546204840646058388');" style=""> 646     public class RefreshTask extends DBAccess {                                                          </span>
<span class="3813756787288835606" onmouseenter="enter('3813756787288835606');" onmouseout="out('3813756787288835606');" style=""> 647         private ChartsData chartsData;                                                                   </span>
<span  style=""> 648                                                                                                          </span>
<span class="6265910281991326326" onmouseenter="enter('6265910281991326326');" onmouseout="out('6265910281991326326');" style=""> 649         public RefreshTask(String task, Context context) {                                               </span>
<span class="6170214191344158476" onmouseenter="enter('6170214191344158476');" onmouseout="out('6170214191344158476');" style=""> 650             super(task, context);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651         }                                                                                                </span>
<span  style=""> 652                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 653         @Override                                                                                        </span>
<span class="6769214505219419913" onmouseenter="enter('6769214505219419913');" onmouseout="out('6769214505219419913');" style=""> 654         protected void doInBackground(DBHandler db) {                                                    </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 655             ChartsHost chartsHost = getChartsHost();                                                     </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 656             if (chartsHost != null) {                                                                    </span>
<span class="-1872147130605113863" onmouseenter="enter('-1872147130605113863');" onmouseout="out('-1872147130605113863');" style=""> 657                 chartsData = refreshInBackground(chartsHost, db, chartsHost.getDevice());                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 658             } else {                                                                                     </span>
<span class="4351338677612212716" onmouseenter="enter('4351338677612212716');" onmouseout="out('4351338677612212716');" style=""> 659                 cancel(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661         }                                                                                                </span>
<span  style=""> 662                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 663         @Override                                                                                        </span>
<span class="7961646527709364830" onmouseenter="enter('7961646527709364830');" onmouseout="out('7961646527709364830');" style=""> 664         protected void onPostExecute(Object o) {                                                         </span>
<span class="1329337488051350495" onmouseenter="enter('1329337488051350495');" onmouseout="out('1329337488051350495');" style=""> 665             super.onPostExecute(o);                                                                      </span>
<span class="4343120289681205406" onmouseenter="enter('4343120289681205406');" onmouseout="out('4343120289681205406');" style=""> 666             FragmentActivity activity = getActivity();                                                   </span>
<span class="1646077047954275991" onmouseenter="enter('1646077047954275991');" onmouseout="out('1646077047954275991');" style=""> 667             if (activity != null &amp;&amp; !activity.isFinishing() &amp;&amp; !activity.isDestroyed()) {                </span>
<span class="-9005677599852802201" onmouseenter="enter('-9005677599852802201');" onmouseout="out('-9005677599852802201');" style=""> 668                 updateChartsnUIThread(chartsData);                                                       </span>
<span class="-4582773223831390369" onmouseenter="enter('-4582773223831390369');" onmouseout="out('-4582773223831390369');" style=""> 669                 renderCharts();                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 670             } else {                                                                                     </span>
<span class="-112827357653254579" onmouseenter="enter('-112827357653254579');" onmouseout="out('-112827357653254579');" style=""> 671                 LOG.info(&quot;Not rendering charts because activity is not available anymore&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 673         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674     }                                                                                                    </span>
<span  style=""> 675                                                                                                          </span>
<span class="4496803111214409190" onmouseenter="enter('4496803111214409190');" onmouseout="out('4496803111214409190');" style=""> 676     protected abstract void updateChartsnUIThread(ChartsData chartsData);                                </span>
<span  style=""> 677                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 678     /**                                                                                                  </span>
<span class="-5037778349112302453" onmouseenter="enter('-5037778349112302453');" onmouseout="out('-5037778349112302453');" style=""> 679      * Returns true if the date was successfully shifted, and false if the shift                         </span>
<span class="-2032571983951913696" onmouseenter="enter('-2032571983951913696');" onmouseout="out('-2032571983951913696');" style=""> 680      * was ignored, e.g. when the to-value is in the future.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 681      *                                                                                                   </span>
<span class="3294571698788299338" onmouseenter="enter('3294571698788299338');" onmouseout="out('3294571698788299338');" style=""> 682      * @param from                                                                                       </span>
<span class="-8398071401251508968" onmouseenter="enter('-8398071401251508968');" onmouseout="out('-8398071401251508968');" style=""> 683      * @param to                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 684      */                                                                                                  </span>
<span class="2489721831712552479" onmouseenter="enter('2489721831712552479');" onmouseout="out('2489721831712552479');" style=""> 685     public boolean setDateRange(Date from, Date to) {                                                    </span>
<span class="4190819803131113323" onmouseenter="enter('4190819803131113323');" onmouseout="out('4190819803131113323');" style=""> 686         if (from.compareTo(to) &gt; 0) {                                                                    </span>
<span class="8028532381572922008" onmouseenter="enter('8028532381572922008');" onmouseout="out('8028532381572922008');" style=""> 687             throw new IllegalArgumentException(&quot;Bad date range: &quot; + from + &quot;..&quot; + to);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688         }                                                                                                </span>
<span class="-968081081932492520" onmouseenter="enter('-968081081932492520');" onmouseout="out('-968081081932492520');" style=""> 689         Date now = new Date();                                                                           </span>
<span class="6487488966631950340" onmouseenter="enter('6487488966631950340');" onmouseout="out('6487488966631950340');" style=""> 690         if (to.after(now)) {                                                                             </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 691             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692         }                                                                                                </span>
<span class="-9201818232828316665" onmouseenter="enter('-9201818232828316665');" onmouseout="out('-9201818232828316665');" style=""> 693         setStartDate(from);                                                                              </span>
<span class="9222819538541566960" onmouseenter="enter('9222819538541566960');" onmouseout="out('9222819538541566960');" style=""> 694         setEndDate(to);                                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 695         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 696     }                                                                                                    </span>
<span  style=""> 697                                                                                                          </span>
<span class="3159484724367933437" onmouseenter="enter('3159484724367933437');" onmouseout="out('3159484724367933437');" style=""> 698     protected void updateDateInfo(Date from, Date to) {                                                  </span>
<span class="-6255879985318699594" onmouseenter="enter('-6255879985318699594');" onmouseout="out('-6255879985318699594');" style=""> 699         if (from.equals(to)) {                                                                           </span>
<span class="573039521209829270" onmouseenter="enter('573039521209829270');" onmouseout="out('573039521209829270');" style=""> 700             getChartsHost().setDateInfo(DateTimeUtils.formatDate(from));                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 701         } else {                                                                                         </span>
<span class="6154857771528724742" onmouseenter="enter('6154857771528724742');" onmouseout="out('6154857771528724742');" style=""> 702             getChartsHost().setDateInfo(DateTimeUtils.formatDateRange(from, to));                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 703         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704     }                                                                                                    </span>
<span  style=""> 705                                                                                                          </span>
<span class="-2205559255794313412" onmouseenter="enter('-2205559255794313412');" onmouseout="out('-2205559255794313412');" style=""> 706     protected List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device) {                 </span>
<span class="4967864623407424140" onmouseenter="enter('4967864623407424140');" onmouseout="out('4967864623407424140');" style=""> 707         int tsStart = getTSStart();                                                                      </span>
<span class="-7516136729766634070" onmouseenter="enter('-7516136729766634070');" onmouseout="out('-7516136729766634070');" style=""> 708         int tsEnd = getTSEnd();                                                                          </span>
<span class="7673509543804257849" onmouseenter="enter('7673509543804257849');" onmouseout="out('7673509543804257849');" style=""> 709         List&lt;ActivitySample&gt; samples = (List&lt;ActivitySample&gt;) getSamples(db, device, tsStart, tsEnd);    </span>
<span class="-5815796914087715329" onmouseenter="enter('-5815796914087715329');" onmouseout="out('-5815796914087715329');" style=""> 710         ensureStartAndEndSamples(samples, tsStart, tsEnd);                                               </span>
<span class="1818060248517305383" onmouseenter="enter('1818060248517305383');" onmouseout="out('1818060248517305383');" style=""> 711 //        List&lt;ActivitySample&gt; samples2 = new ArrayList&lt;&gt;();                                             </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 712 //        int min = Math.min(samples.size(), 10);                                                        </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 713 //        int min = Math.min(samples.size(), 10);                                                        </span>
<span class="-3297133522407861021" onmouseenter="enter('-3297133522407861021');" onmouseout="out('-3297133522407861021');" style=""> 714 //        for (int i = 0; i &lt; min; i++) {                                                                </span>
<span class="-5419954369064878282" onmouseenter="enter('-5419954369064878282');" onmouseout="out('-5419954369064878282');" style=""> 715 //            samples2.add(samples.get(i));                                                              </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 716 //        }                                                                                              </span>
<span class="-217733928506784495" onmouseenter="enter('-217733928506784495');" onmouseout="out('-217733928506784495');" style=""> 717 //        return samples2;                                                                               </span>
<span class="8329125895357939517" onmouseenter="enter('8329125895357939517');" onmouseout="out('8329125895357939517');" style=""> 718         return samples;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 719     }                                                                                                    </span>
<span  style=""> 720                                                                                                          </span>
<span class="-1106201085093865693" onmouseenter="enter('-1106201085093865693');" onmouseout="out('-1106201085093865693');" style=""> 721     protected void ensureStartAndEndSamples(List&lt;ActivitySample&gt; samples, int tsStart, int tsEnd) {      </span>
<span class="-7875576828687087964" onmouseenter="enter('-7875576828687087964');" onmouseout="out('-7875576828687087964');" style=""> 722         if (samples == null || samples.isEmpty()) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 723             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724         }                                                                                                </span>
<span class="6215771732045184164" onmouseenter="enter('6215771732045184164');" onmouseout="out('6215771732045184164');" style=""> 725         ActivitySample lastSample = samples.get(samples.size() - 1);                                     </span>
<span class="-5724051378546831092" onmouseenter="enter('-5724051378546831092');" onmouseout="out('-5724051378546831092');" style=""> 726         if (lastSample.getTimestamp() &lt; tsEnd) {                                                         </span>
<span class="-340307626157070265" onmouseenter="enter('-340307626157070265');" onmouseout="out('-340307626157070265');" style=""> 727             samples.add(createTrailingActivitySample(lastSample, tsEnd));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 728         }                                                                                                </span>
<span  style=""> 729                                                                                                          </span>
<span class="-7926496395118744001" onmouseenter="enter('-7926496395118744001');" onmouseout="out('-7926496395118744001');" style=""> 730         ActivitySample firstSample = samples.get(0);                                                     </span>
<span class="-7009339048909230945" onmouseenter="enter('-7009339048909230945');" onmouseout="out('-7009339048909230945');" style=""> 731         if (firstSample.getTimestamp() &gt; tsStart) {                                                      </span>
<span class="-5264575031409257517" onmouseenter="enter('-5264575031409257517');" onmouseout="out('-5264575031409257517');" style=""> 732             samples.add(createTrailingActivitySample(firstSample, tsStart));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 733         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 734     }                                                                                                    </span>
<span  style=""> 735                                                                                                          </span>
<span class="3833670724694452809" onmouseenter="enter('3833670724694452809');" onmouseout="out('3833670724694452809');" style=""> 736     private ActivitySample createTrailingActivitySample(ActivitySample referenceSample, int timestamp) { </span>
<span class="-2046593497045539776" onmouseenter="enter('-2046593497045539776');" onmouseout="out('-2046593497045539776');" style=""> 737         TrailingActivitySample sample = new TrailingActivitySample();                                    </span>
<span class="1247170989116197247" onmouseenter="enter('1247170989116197247');" onmouseout="out('1247170989116197247');" style=""> 738         if (referenceSample instanceof AbstractActivitySample) {                                         </span>
<span class="753416811428354981" onmouseenter="enter('753416811428354981');" onmouseout="out('753416811428354981');" style=""> 739             AbstractActivitySample reference = (AbstractActivitySample) referenceSample;                 </span>
<span class="179894899616756222" onmouseenter="enter('179894899616756222');" onmouseout="out('179894899616756222');" style=""> 740             sample.setUserId(reference.getUserId());                                                     </span>
<span class="-9074495792241680711" onmouseenter="enter('-9074495792241680711');" onmouseout="out('-9074495792241680711');" style=""> 741             sample.setDeviceId(reference.getDeviceId());                                                 </span>
<span class="-9156726696647878603" onmouseenter="enter('-9156726696647878603');" onmouseout="out('-9156726696647878603');" style=""> 742             sample.setProvider(reference.getProvider());                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743         }                                                                                                </span>
<span class="8993551488058005050" onmouseenter="enter('8993551488058005050');" onmouseout="out('8993551488058005050');" style=""> 744         sample.setTimestamp(timestamp);                                                                  </span>
<span class="1760114423996777276" onmouseenter="enter('1760114423996777276');" onmouseout="out('1760114423996777276');" style=""> 745         return sample;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 746     }                                                                                                    </span>
<span  style=""> 747                                                                                                          </span>
<span class="-1444262751819808388" onmouseenter="enter('-1444262751819808388');" onmouseout="out('-1444262751819808388');" style=""> 748     private int getTSEnd() {                                                                             </span>
<span class="8265537562094819633" onmouseenter="enter('8265537562094819633');" onmouseout="out('8265537562094819633');" style=""> 749         return toTimestamp(getEndDate());                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750     }                                                                                                    </span>
<span  style=""> 751                                                                                                          </span>
<span class="-8800656553144883662" onmouseenter="enter('-8800656553144883662');" onmouseout="out('-8800656553144883662');" style=""> 752     private int getTSStart() {                                                                           </span>
<span class="-6038622859463971662" onmouseenter="enter('-6038622859463971662');" onmouseout="out('-6038622859463971662');" style=""> 753         return toTimestamp(getStartDate());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754     }                                                                                                    </span>
<span  style=""> 755                                                                                                          </span>
<span class="-4614437324300305507" onmouseenter="enter('-4614437324300305507');" onmouseout="out('-4614437324300305507');" style=""> 756     private int toTimestamp(Date date) {                                                                 </span>
<span class="3504665279848614366" onmouseenter="enter('3504665279848614366');" onmouseout="out('3504665279848614366');" style=""> 757         return (int) ((date.getTime() / 1000));                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 758     }                                                                                                    </span>
<span  style=""> 759                                                                                                          </span>
<span class="-4297875969128159092" onmouseenter="enter('-4297875969128159092');" onmouseout="out('-4297875969128159092');" style=""> 760     public static class DefaultChartsData&lt;T extends ChartData&lt;?&gt;&gt; extends ChartsData {                   </span>
<span class="6426673791816913577" onmouseenter="enter('6426673791816913577');" onmouseout="out('6426673791816913577');" style=""> 761         private final T data;                                                                            </span>
<span class="-7952082456269420489" onmouseenter="enter('-7952082456269420489');" onmouseout="out('-7952082456269420489');" style=""> 762         private IAxisValueFormatter xValueFormatter;                                                     </span>
<span  style=""> 763                                                                                                          </span>
<span class="6541589990597847820" onmouseenter="enter('6541589990597847820');" onmouseout="out('6541589990597847820');" style=""> 764         public DefaultChartsData(T data, IAxisValueFormatter xValueFormatter) {                          </span>
<span class="5524270510531897998" onmouseenter="enter('5524270510531897998');" onmouseout="out('5524270510531897998');" style=""> 765             this.xValueFormatter = xValueFormatter;                                                      </span>
<span class="6755336779332792903" onmouseenter="enter('6755336779332792903');" onmouseout="out('6755336779332792903');" style=""> 766             this.data = data;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 767         }                                                                                                </span>
<span  style=""> 768                                                                                                          </span>
<span class="-2012372510684410029" onmouseenter="enter('-2012372510684410029');" onmouseout="out('-2012372510684410029');" style=""> 769         public IAxisValueFormatter getXValueFormatter() {                                                </span>
<span class="-7533476322813168520" onmouseenter="enter('-7533476322813168520');" onmouseout="out('-7533476322813168520');" style=""> 770             return xValueFormatter;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 771         }                                                                                                </span>
<span  style=""> 772                                                                                                          </span>
<span class="5384784438887663423" onmouseenter="enter('5384784438887663423');" onmouseout="out('5384784438887663423');" style=""> 773         public T getData() {                                                                             </span>
<span class="2885311051796901480" onmouseenter="enter('2885311051796901480');" onmouseout="out('2885311051796901480');" style=""> 774             return data;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 775         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 776     }                                                                                                    </span>
<span  style=""> 777                                                                                                          </span>
<span class="1326180124040264963" onmouseenter="enter('1326180124040264963');" onmouseout="out('1326180124040264963');" style=""> 778     protected static class SampleXLabelFormatter implements IAxisValueFormatter {                        </span>
<span class="5353010427567723059" onmouseenter="enter('5353010427567723059');" onmouseout="out('5353010427567723059');" style=""> 779         private final TimestampTranslation tsTranslation;                                                </span>
<span class="-3636759102507942125" onmouseenter="enter('-3636759102507942125');" onmouseout="out('-3636759102507942125');" style=""> 780         SimpleDateFormat annotationDateFormat = new SimpleDateFormat(&quot;HH:mm&quot;);                           </span>
<span class="1540142582082446680" onmouseenter="enter('1540142582082446680');" onmouseout="out('1540142582082446680');" style=""> 781 //        SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd.MM.yyyy HH:mm&quot;);                        </span>
<span class="4878211627103907492" onmouseenter="enter('4878211627103907492');" onmouseout="out('4878211627103907492');" style=""> 782         Calendar cal = GregorianCalendar.getInstance();                                                  </span>
<span  style=""> 783                                                                                                          </span>
<span class="5120004681237147878" onmouseenter="enter('5120004681237147878');" onmouseout="out('5120004681237147878');" style=""> 784         public SampleXLabelFormatter(TimestampTranslation tsTranslation) {                               </span>
<span class="332289991409172359" onmouseenter="enter('332289991409172359');" onmouseout="out('332289991409172359');" style=""> 785             this.tsTranslation = tsTranslation;                                                          </span>
<span  style=""> 786                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 787         }                                                                                                </span>
<span class="9166492997131092423" onmouseenter="enter('9166492997131092423');" onmouseout="out('9166492997131092423');" style=""> 788         // TODO: this does not work. Cannot use precomputed labels                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 789         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 790         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="7424853438265862645" onmouseenter="enter('7424853438265862645');" onmouseout="out('7424853438265862645');" style=""> 791             cal.clear();                                                                                 </span>
<span class="-8022679979208902148" onmouseenter="enter('-8022679979208902148');" onmouseout="out('-8022679979208902148');" style=""> 792             int ts = (int) value;                                                                        </span>
<span class="-2120013244284691976" onmouseenter="enter('-2120013244284691976');" onmouseout="out('-2120013244284691976');" style=""> 793             cal.setTimeInMillis(tsTranslation.toOriginalValue(ts) * 1000L);                              </span>
<span class="-5878359517855184171" onmouseenter="enter('-5878359517855184171');" onmouseout="out('-5878359517855184171');" style=""> 794             Date date = cal.getTime();                                                                   </span>
<span class="-2286280998074804817" onmouseenter="enter('-2286280998074804817');" onmouseout="out('-2286280998074804817');" style=""> 795             String dateString = annotationDateFormat.format(date);                                       </span>
<span class="-4331225868129427907" onmouseenter="enter('-4331225868129427907');" onmouseout="out('-4331225868129427907');" style=""> 796             return dateString;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 798     }                                                                                                    </span>
<span  style=""> 799                                                                                                          </span>
<span class="853591074258071334" onmouseenter="enter('853591074258071334');" onmouseout="out('853591074258071334');" style=""> 800     protected static class PreformattedXIndexLabelFormatter implements IAxisValueFormatter {             </span>
<span class="-5932642099782009782" onmouseenter="enter('-5932642099782009782');" onmouseout="out('-5932642099782009782');" style=""> 801         private ArrayList&lt;String&gt; xLabels;                                                               </span>
<span  style=""> 802                                                                                                          </span>
<span class="-3496008191511610310" onmouseenter="enter('-3496008191511610310');" onmouseout="out('-3496008191511610310');" style=""> 803         public PreformattedXIndexLabelFormatter(ArrayList&lt;String&gt; xLabels) {                             </span>
<span class="1925102162908705801" onmouseenter="enter('1925102162908705801');" onmouseout="out('1925102162908705801');" style=""> 804             this.xLabels = xLabels;                                                                      </span>
<span  style=""> 805                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806         }                                                                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 807         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 808         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="-6653294473874823013" onmouseenter="enter('-6653294473874823013');" onmouseout="out('-6653294473874823013');" style=""> 809             int index = (int) value;                                                                     </span>
<span class="-6571719897851150925" onmouseenter="enter('-6571719897851150925');" onmouseout="out('-6571719897851150925');" style=""> 810             if (xLabels == null || index &gt;= xLabels.size()) {                                            </span>
<span class="-889824612483989703" onmouseenter="enter('-889824612483989703');" onmouseout="out('-889824612483989703');" style=""> 811                 return String.valueOf(value);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812             }                                                                                            </span>
<span class="-5802960474501370558" onmouseenter="enter('-5802960474501370558');" onmouseout="out('-5802960474501370558');" style=""> 813             return xLabels.get(index);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 814         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 815     }                                                                                                    </span>
<span  style=""> 816                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 817     /**                                                                                                  </span>
<span class="6592799195109599568" onmouseenter="enter('6592799195109599568');" onmouseout="out('6592799195109599568');" style=""> 818      * Awkward class that helps in translating long timestamp                                            </span>
<span class="-2647406073998843607" onmouseenter="enter('-2647406073998843607');" onmouseout="out('-2647406073998843607');" style=""> 819      * values to float (sic!) values. It basically rebases all                                           </span>
<span class="-6950802996886985644" onmouseenter="enter('-6950802996886985644');" onmouseout="out('-6950802996886985644');" style=""> 820      * timestamps to a base (the very first) timestamp value.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 821      *                                                                                                   </span>
<span class="467771366063509856" onmouseenter="enter('467771366063509856');" onmouseout="out('467771366063509856');" style=""> 822      * It does this so that the large timestamp values can be used                                       </span>
<span class="-3960902832668220629" onmouseenter="enter('-3960902832668220629');" onmouseout="out('-3960902832668220629');" style=""> 823      * floating point values, where the mantissa is just 24 bits.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 824      */                                                                                                  </span>
<span class="3353052654588926596" onmouseenter="enter('3353052654588926596');" onmouseout="out('3353052654588926596');" style=""> 825     protected static class TimestampTranslation {                                                        </span>
<span class="-8324695427159884252" onmouseenter="enter('-8324695427159884252');" onmouseout="out('-8324695427159884252');" style=""> 826         private int tsOffset = -1;                                                                       </span>
<span  style=""> 827                                                                                                          </span>
<span class="-2038703014401681062" onmouseenter="enter('-2038703014401681062');" onmouseout="out('-2038703014401681062');" style=""> 828         public int shorten(int timestamp) {                                                              </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 829             if (tsOffset == -1) {                                                                        </span>
<span class="5713941682084663603" onmouseenter="enter('5713941682084663603');" onmouseout="out('5713941682084663603');" style=""> 830                 tsOffset = timestamp;                                                                    </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 831                 return 0;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832             }                                                                                            </span>
<span class="-455923503597890370" onmouseenter="enter('-455923503597890370');" onmouseout="out('-455923503597890370');" style=""> 833             return timestamp - tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834         }                                                                                                </span>
<span  style=""> 835                                                                                                          </span>
<span class="-7013677261634300092" onmouseenter="enter('-7013677261634300092');" onmouseout="out('-7013677261634300092');" style=""> 836         public int toOriginalValue(int timestamp) {                                                      </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 837             if (tsOffset == -1) {                                                                        </span>
<span class="-3020799636637211745" onmouseenter="enter('-3020799636637211745');" onmouseout="out('-3020799636637211745');" style=""> 838                 return timestamp;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839             }                                                                                            </span>
<span class="-7912123621537489577" onmouseenter="enter('-7912123621537489577');" onmouseout="out('-7912123621537489577');" style=""> 840             return timestamp + tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 841         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 843 }                                                                                                        </span></pre></td>
                            <td><pre><span class="8232473818974975943" onmouseenter="enter('8232473818974975943');" onmouseout="out('8232473818974975943');" style="">   1 /*  Copyright (C) 2015-2017 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                   </span>
<span class="2448951400902124304" onmouseenter="enter('2448951400902124304');" onmouseout="out('2448951400902124304');" style="">   2     Daniele Gobbetti, walkjivefly                                                                        </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="8669690300131154388" onmouseenter="enter('8669690300131154388');" onmouseout="out('8669690300131154388');" style="">  18 package nodomain.freeyourgadget.gadgetbridge.activities.charts;                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-489389385851058391" onmouseenter="enter('-489389385851058391');" onmouseout="out('-489389385851058391');" style="">  20 import android.content.BroadcastReceiver;                                                                </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  21 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  22 import android.content.Intent;                                                                           </span>
<span class="8697221465021235869" onmouseenter="enter('8697221465021235869');" onmouseout="out('8697221465021235869');" style="">  23 import android.content.IntentFilter;                                                                     </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  24 import android.os.AsyncTask;                                                                             </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  25 import android.os.Bundle;                                                                                </span>
<span class="4394652512097310678" onmouseenter="enter('4394652512097310678');" onmouseout="out('4394652512097310678');" style="">  26 import android.support.annotation.Nullable;                                                              </span>
<span class="5561867782528330628" onmouseenter="enter('5561867782528330628');" onmouseout="out('5561867782528330628');" style="">  27 import android.support.v4.app.FragmentActivity;                                                          </span>
<span class="-3586823955743508894" onmouseenter="enter('-3586823955743508894');" onmouseout="out('-3586823955743508894');" style="">  28 import android.support.v4.content.ContextCompat;                                                         </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  29 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  30 import android.util.TypedValue;                                                                          </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  31 import android.view.View;                                                                                </span>
<span  style="">  32                                                                                                          </span>
<span class="2052752975691556393" onmouseenter="enter('2052752975691556393');" onmouseout="out('2052752975691556393');" style="">  33 import com.github.mikephil.charting.charts.BarChart;                                                     </span>
<span class="-7530008699315861247" onmouseenter="enter('-7530008699315861247');" onmouseout="out('-7530008699315861247');" style="">  34 import com.github.mikephil.charting.charts.BarLineChartBase;                                             </span>
<span class="-2340851656771232402" onmouseenter="enter('-2340851656771232402');" onmouseout="out('-2340851656771232402');" style="">  35 import com.github.mikephil.charting.charts.Chart;                                                        </span>
<span class="1306294111757562979" onmouseenter="enter('1306294111757562979');" onmouseout="out('1306294111757562979');" style="">  36 import com.github.mikephil.charting.components.AxisBase;                                                 </span>
<span class="-968159151538268968" onmouseenter="enter('-968159151538268968');" onmouseout="out('-968159151538268968');" style="">  37 import com.github.mikephil.charting.components.YAxis;                                                    </span>
<span class="4145381455536678498" onmouseenter="enter('4145381455536678498');" onmouseout="out('4145381455536678498');" style="">  38 import com.github.mikephil.charting.data.ChartData;                                                      </span>
<span class="-6979157771929244358" onmouseenter="enter('-6979157771929244358');" onmouseout="out('-6979157771929244358');" style="">  39 import com.github.mikephil.charting.data.Entry;                                                          </span>
<span class="-1647496247863422182" onmouseenter="enter('-1647496247863422182');" onmouseout="out('-1647496247863422182');" style="">  40 import com.github.mikephil.charting.data.LineData;                                                       </span>
<span class="-2418175485781437143" onmouseenter="enter('-2418175485781437143');" onmouseout="out('-2418175485781437143');" style="">  41 import com.github.mikephil.charting.data.LineDataSet;                                                    </span>
<span class="5272555707203763230" onmouseenter="enter('5272555707203763230');" onmouseout="out('5272555707203763230');" style="">  42 import com.github.mikephil.charting.formatter.IAxisValueFormatter;                                       </span>
<span class="2256452517983808356" onmouseenter="enter('2256452517983808356');" onmouseout="out('2256452517983808356');" style="">  43 import com.github.mikephil.charting.interfaces.datasets.ILineDataSet;                                    </span>
<span  style="">  44                                                                                                          </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  45 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  46 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  47                                                                                                          </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  48 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  49 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  50 import java.util.Arrays;                                                                                 </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  51 import java.util.Calendar;                                                                               </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  52 import java.util.Date;                                                                                   </span>
<span class="-4685965902094386510" onmouseenter="enter('-4685965902094386510');" onmouseout="out('-4685965902094386510');" style="">  53 import java.util.GregorianCalendar;                                                                      </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  55 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  56 import java.util.Set;                                                                                    </span>
<span  style="">  57                                                                                                          </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                               </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="5401974517372835423" onmouseenter="enter('5401974517372835423');" onmouseout="out('5401974517372835423');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.activities.AbstractGBFragment;                               </span>
<span class="-7512545990884107322" onmouseenter="enter('-7512545990884107322');" onmouseout="out('-7512545990884107322');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;                                   </span>
<span class="-7899456532042317044" onmouseenter="enter('-7899456532042317044');" onmouseout="out('-7899456532042317044');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.database.DBAccess;                                           </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="6852267181356803593" onmouseenter="enter('6852267181356803593');" onmouseout="out('6852267181356803593');" style="">  64 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;                                   </span>
<span class="-4858662006453759829" onmouseenter="enter('-4858662006453759829');" onmouseout="out('-4858662006453759829');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.devices.SampleProvider;                                      </span>
<span class="6164643418103516215" onmouseenter="enter('6164643418103516215');" onmouseout="out('6164643418103516215');" style="">  66 import nodomain.freeyourgadget.gadgetbridge.entities.AbstractActivitySample;                             </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  67 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="5185434099904652174" onmouseenter="enter('5185434099904652174');" onmouseout="out('5185434099904652174');" style="">  68 import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind;                                          </span>
<span class="-4763610359710127205" onmouseenter="enter('-4763610359710127205');" onmouseout="out('-4763610359710127205');" style="">  69 import nodomain.freeyourgadget.gadgetbridge.model.ActivitySample;                                        </span>
<span class="-904534361809820117" onmouseenter="enter('-904534361809820117');" onmouseout="out('-904534361809820117');" style="">  70 import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils;                                          </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  71 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span  style="">  72                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73 /**                                                                                                      </span>
<span class="4382979016472627606" onmouseenter="enter('4382979016472627606');" onmouseout="out('4382979016472627606');" style="">  74  * A base class fragment to be used with ChartsActivity. The fragment can supply                         </span>
<span class="6198461617436424812" onmouseenter="enter('6198461617436424812');" onmouseout="out('6198461617436424812');" style="">  75  * a title to be displayed in the activity by returning non-null in #getTitle()                          </span>
<span class="-6728528830408447290" onmouseenter="enter('-6728528830408447290');" onmouseout="out('-6728528830408447290');" style="">  76  * Broadcast events can be received by overriding #onReceive(Context,Intent).                            </span>
<span class="-8995811574793439040" onmouseenter="enter('-8995811574793439040');" onmouseout="out('-8995811574793439040');" style="">  77  * The chart can be refreshed by calling #refresh()                                                      </span>
<span class="7522934711128650596" onmouseenter="enter('7522934711128650596');" onmouseout="out('7522934711128650596');" style="">  78  * Implement refreshInBackground(DBHandler, GBDevice) to fetch the samples from the DB,                  </span>
<span class="-6728676085228773380" onmouseenter="enter('-6728676085228773380');" onmouseout="out('-6728676085228773380');" style="">  79  * and add the samples to the chart. The actual rendering, which must be performed in the UI             </span>
<span class="-8407485021089725057" onmouseenter="enter('-8407485021089725057');" onmouseout="out('-8407485021089725057');" style="">  80  * thread, must be done in #renderCharts().                                                              </span>
<span class="-4722043031183050825" onmouseenter="enter('-4722043031183050825');" onmouseout="out('-4722043031183050825');" style="">  81  * Access functionality of the hosting activity with #getHost()                                          </span>
<span class="4294780129258405519" onmouseenter="enter('4294780129258405519');" onmouseout="out('4294780129258405519');" style="">  82  * &lt;p/&gt;                                                                                                  </span>
<span class="4386326732920470462" onmouseenter="enter('4386326732920470462');" onmouseout="out('4386326732920470462');" style="">  83  * The hosting ChartsHost activity provides a section for displaying a date or date range                </span>
<span class="6958843947366179987" onmouseenter="enter('6958843947366179987');" onmouseout="out('6958843947366179987');" style="">  84  * being the basis for the chart, as well as two buttons for moving backwards and forward                </span>
<span class="2417558347604794742" onmouseenter="enter('2417558347604794742');" onmouseout="out('2417558347604794742');" style="">  85  * in time. The date is held by the activity, so that it can be shared by multiple chart                 </span>
<span class="7607748487874207999" onmouseenter="enter('7607748487874207999');" onmouseout="out('7607748487874207999');" style="">  86  * fragments. It is still the responsibility of the (currently visible) chart fragment                   </span>
<span class="-3870094542515027002" onmouseenter="enter('-3870094542515027002');" onmouseout="out('-3870094542515027002');" style="">  87  * to set the desired date in the ChartsActivity via #setDateRange(Date,Date).                           </span>
<span class="3680713202748276357" onmouseenter="enter('3680713202748276357');" onmouseout="out('3680713202748276357');" style="">  88  * The default implementations #handleDatePrev(Date,Date) and #handleDateNext(Date,Date)                 </span>
<span class="-222466413472697410" onmouseenter="enter('-222466413472697410');" onmouseout="out('-222466413472697410');" style="">  89  * shift the date by one day.                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90  */                                                                                                      </span>
<span class="559507359319980575" onmouseenter="enter('559507359319980575');" onmouseout="out('559507359319980575');" style="">  91 public abstract class AbstractChartFragment extends AbstractGBFragment {                                 </span>
<span class="-5476773025248141464" onmouseenter="enter('-5476773025248141464');" onmouseout="out('-5476773025248141464');" style="">  92     protected final int ANIM_TIME = 250;                                                                 </span>
<span  style="">  93                                                                                                          </span>
<span class="2603683647820710396" onmouseenter="enter('2603683647820710396');" onmouseout="out('2603683647820710396');" style="">  94     private static final Logger LOG = LoggerFactory.getLogger(AbstractChartFragment.class);              </span>
<span  style="">  95                                                                                                          </span>
<span class="-7304707645666720924" onmouseenter="enter('-7304707645666720924');" onmouseout="out('-7304707645666720924');" style="">  96     private final Set&lt;String&gt; mIntentFilterActions;                                                      </span>
<span class="4625474178666977899" onmouseenter="enter('4625474178666977899');" onmouseout="out('4625474178666977899');" style="">  97     private final BroadcastReceiver mReceiver = new BroadcastReceiver() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  98         @Override                                                                                        </span>
<span class="-1520739091809898546" onmouseenter="enter('-1520739091809898546');" onmouseout="out('-1520739091809898546');" style="">  99         public void onReceive(Context context, Intent intent) {                                          </span>
<span class="1765483774466236680" onmouseenter="enter('1765483774466236680');" onmouseout="out('1765483774466236680');" style=""> 100             AbstractChartFragment.this.onReceive(context, intent);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 102     };                                                                                                   </span>
<span class="-5489121822050726001" onmouseenter="enter('-5489121822050726001');" onmouseout="out('-5489121822050726001');" style=""> 103     private boolean mChartDirty = true;                                                                  </span>
<span class="-5677382414532787847" onmouseenter="enter('-5677382414532787847');" onmouseout="out('-5677382414532787847');" style=""> 104     private AsyncTask refreshTask;                                                                       </span>
<span  style=""> 105                                                                                                          </span>
<span class="-4343134957952038703" onmouseenter="enter('-4343134957952038703');" onmouseout="out('-4343134957952038703');" style=""> 106     public boolean isChartDirty() {                                                                      </span>
<span class="-2572162510293790028" onmouseenter="enter('-2572162510293790028');" onmouseout="out('-2572162510293790028');" style=""> 107         return mChartDirty;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="-601773936482381085" onmouseenter="enter('-601773936482381085');" onmouseout="out('-601773936482381085');" style=""> 111     public abstract String getTitle();                                                                   </span>
<span  style=""> 112                                                                                                          </span>
<span class="-6644558066866151773" onmouseenter="enter('-6644558066866151773');" onmouseout="out('-6644558066866151773');" style=""> 113     public boolean supportsHeartrate(GBDevice device) {                                                  </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 114         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="-7840206560907481536" onmouseenter="enter('-7840206560907481536');" onmouseout="out('-7840206560907481536');" style=""> 115         return coordinator != null &amp;&amp; coordinator.supportsHeartRateMeasurement(device);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-8993184091203127788" onmouseenter="enter('-8993184091203127788');" onmouseout="out('-8993184091203127788');" style=""> 118     protected static final class ActivityConfig {                                                        </span>
<span class="-6704927139853267025" onmouseenter="enter('-6704927139853267025');" onmouseout="out('-6704927139853267025');" style=""> 119         public final int type;                                                                           </span>
<span class="8777140454183587055" onmouseenter="enter('8777140454183587055');" onmouseout="out('8777140454183587055');" style=""> 120         public final String label;                                                                       </span>
<span class="-5618013352645865591" onmouseenter="enter('-5618013352645865591');" onmouseout="out('-5618013352645865591');" style=""> 121         public final Integer color;                                                                      </span>
<span  style=""> 122                                                                                                          </span>
<span class="-5628392649151863187" onmouseenter="enter('-5628392649151863187');" onmouseout="out('-5628392649151863187');" style=""> 123         public ActivityConfig(int kind, String label, Integer color) {                                   </span>
<span class="-7354691670901086033" onmouseenter="enter('-7354691670901086033');" onmouseout="out('-7354691670901086033');" style=""> 124             this.type = kind;                                                                            </span>
<span class="-6752321514731327997" onmouseenter="enter('-6752321514731327997');" onmouseout="out('-6752321514731327997');" style=""> 125             this.label = label;                                                                          </span>
<span class="-589508620284177092" onmouseenter="enter('-589508620284177092');" onmouseout="out('-589508620284177092');" style=""> 126             this.color = color;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="-727072152722713884" onmouseenter="enter('-727072152722713884');" onmouseout="out('-727072152722713884');" style=""> 130     protected ActivityConfig akActivity;                                                                 </span>
<span class="1693165293269506698" onmouseenter="enter('1693165293269506698');" onmouseout="out('1693165293269506698');" style=""> 131     protected ActivityConfig akLightSleep;                                                               </span>
<span class="1060880569004609468" onmouseenter="enter('1060880569004609468');" onmouseout="out('1060880569004609468');" style=""> 132     protected ActivityConfig akDeepSleep;                                                                </span>
<span class="-4297327045522896814" onmouseenter="enter('-4297327045522896814');" onmouseout="out('-4297327045522896814');" style=""> 133     protected ActivityConfig akNotWorn;                                                                  </span>
<span  style=""> 134                                                                                                          </span>
<span  style=""> 135                                                                                                          </span>
<span class="-1563135362317192224" onmouseenter="enter('-1563135362317192224');" onmouseout="out('-1563135362317192224');" style=""> 136     protected int BACKGROUND_COLOR;                                                                      </span>
<span class="4601305514601887958" onmouseenter="enter('4601305514601887958');" onmouseout="out('4601305514601887958');" style=""> 137     protected int DESCRIPTION_COLOR;                                                                     </span>
<span class="-3468694148212670828" onmouseenter="enter('-3468694148212670828');" onmouseout="out('-3468694148212670828');" style=""> 138     protected int CHART_TEXT_COLOR;                                                                      </span>
<span class="655929690321793162" onmouseenter="enter('655929690321793162');" onmouseout="out('655929690321793162');" style=""> 139     protected int LEGEND_TEXT_COLOR;                                                                     </span>
<span class="-6693974409973768071" onmouseenter="enter('-6693974409973768071');" onmouseout="out('-6693974409973768071');" style=""> 140     protected int HEARTRATE_COLOR;                                                                       </span>
<span class="7021362809515932268" onmouseenter="enter('7021362809515932268');" onmouseout="out('7021362809515932268');" style=""> 141     protected int HEARTRATE_FILL_COLOR;                                                                  </span>
<span class="-4670234814499331326" onmouseenter="enter('-4670234814499331326');" onmouseout="out('-4670234814499331326');" style=""> 142     protected int AK_ACTIVITY_COLOR;                                                                     </span>
<span class="-5660897269888657930" onmouseenter="enter('-5660897269888657930');" onmouseout="out('-5660897269888657930');" style=""> 143     protected int AK_DEEP_SLEEP_COLOR;                                                                   </span>
<span class="-91394691221270038" onmouseenter="enter('-91394691221270038');" onmouseout="out('-91394691221270038');" style=""> 144     protected int AK_LIGHT_SLEEP_COLOR;                                                                  </span>
<span class="1634608154221638802" onmouseenter="enter('1634608154221638802');" onmouseout="out('1634608154221638802');" style=""> 145     protected int AK_NOT_WORN_COLOR;                                                                     </span>
<span  style=""> 146                                                                                                          </span>
<span class="-1398408580326282750" onmouseenter="enter('-1398408580326282750');" onmouseout="out('-1398408580326282750');" style=""> 147     protected String HEARTRATE_LABEL;                                                                    </span>
<span  style=""> 148                                                                                                          </span>
<span class="-2100943369183848946" onmouseenter="enter('-2100943369183848946');" onmouseout="out('-2100943369183848946');" style=""> 149     protected AbstractChartFragment(String... intentFilterActions) {                                     </span>
<span class="4300273923814153332" onmouseenter="enter('4300273923814153332');" onmouseout="out('4300273923814153332');" style=""> 150         mIntentFilterActions = new HashSet&lt;&gt;();                                                          </span>
<span class="1794017280726845715" onmouseenter="enter('1794017280726845715');" onmouseout="out('1794017280726845715');" style=""> 151         if (intentFilterActions != null) {                                                               </span>
<span class="-5245442559338563943" onmouseenter="enter('-5245442559338563943');" onmouseout="out('-5245442559338563943');" style=""> 152             mIntentFilterActions.addAll(Arrays.asList(intentFilterActions));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153         }                                                                                                </span>
<span class="-8699894582101860078" onmouseenter="enter('-8699894582101860078');" onmouseout="out('-8699894582101860078');" style=""> 154         mIntentFilterActions.add(ChartsHost.DATE_NEXT);                                                  </span>
<span class="6561361583014083383" onmouseenter="enter('6561361583014083383');" onmouseout="out('6561361583014083383');" style=""> 155         mIntentFilterActions.add(ChartsHost.DATE_PREV);                                                  </span>
<span class="775005401617860596" onmouseenter="enter('775005401617860596');" onmouseout="out('775005401617860596');" style=""> 156         mIntentFilterActions.add(ChartsHost.REFRESH);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 159     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 160     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 161         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 162                                                                                                          </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 163         init();                                                                                          </span>
<span  style=""> 164                                                                                                          </span>
<span class="1309295186849327913" onmouseenter="enter('1309295186849327913');" onmouseout="out('1309295186849327913');" style=""> 165         IntentFilter filter = new IntentFilter();                                                        </span>
<span class="6467646639596248655" onmouseenter="enter('6467646639596248655');" onmouseout="out('6467646639596248655');" style=""> 166         for (String action : mIntentFilterActions) {                                                     </span>
<span class="-2086107330814500487" onmouseenter="enter('-2086107330814500487');" onmouseout="out('-2086107330814500487');" style=""> 167             filter.addAction(action);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168         }                                                                                                </span>
<span class="3395895708962590803" onmouseenter="enter('3395895708962590803');" onmouseout="out('3395895708962590803');" style=""> 169         LocalBroadcastManager.getInstance(getActivity()).registerReceiver(mReceiver, filter);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="-2182533896997661648" onmouseenter="enter('-2182533896997661648');" onmouseout="out('-2182533896997661648');" style=""> 172     protected void init() {                                                                              </span>
<span class="-4278963507477628649" onmouseenter="enter('-4278963507477628649');" onmouseout="out('-4278963507477628649');" style=""> 173         TypedValue runningColor = new TypedValue();                                                      </span>
<span class="2364262805070128994" onmouseenter="enter('2364262805070128994');" onmouseout="out('2364262805070128994');" style=""> 174         BACKGROUND_COLOR = GBApplication.getBackgroundColor(getContext());                               </span>
<span class="4636662852620032981" onmouseenter="enter('4636662852620032981');" onmouseout="out('4636662852620032981');" style=""> 175         LEGEND_TEXT_COLOR = DESCRIPTION_COLOR = GBApplication.getTextColor(getContext());                </span>
<span class="7979803013168270964" onmouseenter="enter('7979803013168270964');" onmouseout="out('7979803013168270964');" style=""> 176         CHART_TEXT_COLOR = ContextCompat.getColor(getContext(), R.color.secondarytext);                  </span>
<span class="-5448842132740870532" onmouseenter="enter('-5448842132740870532');" onmouseout="out('-5448842132740870532');" style=""> 177         HEARTRATE_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate);                 </span>
<span class="3818219289719008809" onmouseenter="enter('3818219289719008809');" onmouseout="out('3818219289719008809');" style=""> 178         HEARTRATE_FILL_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate_fill);       </span>
<span class="-658032213271338857" onmouseenter="enter('-658032213271338857');" onmouseout="out('-658032213271338857');" style=""> 179         getContext().getTheme().resolveAttribute(R.attr.chart_activity, runningColor, true);             </span>
<span class="3784973835189342522" onmouseenter="enter('3784973835189342522');" onmouseout="out('3784973835189342522');" style=""> 180         AK_ACTIVITY_COLOR = runningColor.data;                                                           </span>
<span class="-7347375883805936743" onmouseenter="enter('-7347375883805936743');" onmouseout="out('-7347375883805936743');" style=""> 181         getContext().getTheme().resolveAttribute(R.attr.chart_deep_sleep, runningColor, true);           </span>
<span class="9138233377044964354" onmouseenter="enter('9138233377044964354');" onmouseout="out('9138233377044964354');" style=""> 182         AK_DEEP_SLEEP_COLOR = runningColor.data;                                                         </span>
<span class="-7879866390823759405" onmouseenter="enter('-7879866390823759405');" onmouseout="out('-7879866390823759405');" style=""> 183         getContext().getTheme().resolveAttribute(R.attr.chart_light_sleep, runningColor, true);          </span>
<span class="-7375963623584937470" onmouseenter="enter('-7375963623584937470');" onmouseout="out('-7375963623584937470');" style=""> 184         AK_LIGHT_SLEEP_COLOR = runningColor.data;                                                        </span>
<span class="-4015774126818841529" onmouseenter="enter('-4015774126818841529');" onmouseout="out('-4015774126818841529');" style=""> 185         getContext().getTheme().resolveAttribute(R.attr.chart_not_worn, runningColor, true);             </span>
<span class="-5596972182818856924" onmouseenter="enter('-5596972182818856924');" onmouseout="out('-5596972182818856924');" style=""> 186         AK_NOT_WORN_COLOR = runningColor.data;                                                           </span>
<span  style=""> 187                                                                                                          </span>
<span class="-8151372900676559714" onmouseenter="enter('-8151372900676559714');" onmouseout="out('-8151372900676559714');" style=""> 188         HEARTRATE_LABEL = getContext().getString(R.string.charts_legend_heartrate);                      </span>
<span  style=""> 189                                                                                                          </span>
<span class="7336078921795716816" onmouseenter="enter('7336078921795716816');" onmouseout="out('7336078921795716816');" style=""><abbr title=" 190         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kind_activity), AK_ACTIVITY_COLOR);"> 190         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fraðŸ”µ</abbr></span>
<span class="7421775491088103388" onmouseenter="enter('7421775491088103388');" onmouseout="out('7421775491088103388');" style=""><abbr title=" 191         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragment_kind_light_sleep), AK_LIGHT_SLEEP_COLOR);"> 191         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_charðŸ”µ</abbr></span>
<span class="-7577615369032967062" onmouseenter="enter('-7577615369032967062');" onmouseout="out('-7577615369032967062');" style=""><abbr title=" 192         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_kind_deep_sleep), AK_DEEP_SLEEP_COLOR);"> 192         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_ðŸ”µ</abbr></span>
<span class="4963911460392329978" onmouseenter="enter('4963911460392329978');" onmouseout="out('4963911460392329978');" style=""><abbr title=" 193         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kind_not_worn), AK_NOT_WORN_COLOR);"> 193         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="-495990486128602071" onmouseenter="enter('-495990486128602071');" onmouseout="out('-495990486128602071');" style=""> 196     private void setStartDate(Date date) {                                                               </span>
<span class="-1228970384434949212" onmouseenter="enter('-1228970384434949212');" onmouseout="out('-1228970384434949212');" style=""> 197         getChartsHost().setStartDate(date);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198     }                                                                                                    </span>
<span  style=""> 199                                                                                                          </span>
<span class="2390100272250745956" onmouseenter="enter('2390100272250745956');" onmouseout="out('2390100272250745956');" style=""> 200     @Nullable                                                                                            </span>
<span class="3611118571382248517" onmouseenter="enter('3611118571382248517');" onmouseout="out('3611118571382248517');" style=""> 201     protected ChartsHost getChartsHost() {                                                               </span>
<span class="2661597057438137706" onmouseenter="enter('2661597057438137706');" onmouseout="out('2661597057438137706');" style=""> 202         return (ChartsHost) getActivity();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203     }                                                                                                    </span>
<span  style=""> 204                                                                                                          </span>
<span class="-1308916602749590522" onmouseenter="enter('-1308916602749590522');" onmouseout="out('-1308916602749590522');" style=""> 205     private void setEndDate(Date date) {                                                                 </span>
<span class="-3659353165994754543" onmouseenter="enter('-3659353165994754543');" onmouseout="out('-3659353165994754543');" style=""> 206         getChartsHost().setEndDate(date);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-2894059945991900133" onmouseenter="enter('-2894059945991900133');" onmouseout="out('-2894059945991900133');" style=""> 209     public Date getStartDate() {                                                                         </span>
<span class="8926139361389921832" onmouseenter="enter('8926139361389921832');" onmouseout="out('8926139361389921832');" style=""> 210         return getChartsHost().getStartDate();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="2846153489913780034" onmouseenter="enter('2846153489913780034');" onmouseout="out('2846153489913780034');" style=""> 213     public Date getEndDate() {                                                                           </span>
<span class="7835534291730041186" onmouseenter="enter('7835534291730041186');" onmouseout="out('7835534291730041186');" style=""> 214         return getChartsHost().getEndDate();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215     }                                                                                                    </span>
<span  style=""> 216                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 217     /**                                                                                                  </span>
<span class="3608187799695399223" onmouseenter="enter('3608187799695399223');" onmouseout="out('3608187799695399223');" style=""> 218      * Called when this fragment has been fully scrolled into the activity.                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 219      *                                                                                                   </span>
<span class="-6064668654679903662" onmouseenter="enter('-6064668654679903662');" onmouseout="out('-6064668654679903662');" style=""> 220      * @see #isVisibleInActivity()                                                                       </span>
<span class="-4201783166293447700" onmouseenter="enter('-4201783166293447700');" onmouseout="out('-4201783166293447700');" style=""> 221      * @see #onMadeInvisibleInActivity()                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 222      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 223     @Override                                                                                            </span>
<span class="-7073731466333062745" onmouseenter="enter('-7073731466333062745');" onmouseout="out('-7073731466333062745');" style=""> 224     protected void onMadeVisibleInActivity() {                                                           </span>
<span class="-2940429388425730341" onmouseenter="enter('-2940429388425730341');" onmouseout="out('-2940429388425730341');" style=""> 225         super.onMadeVisibleInActivity();                                                                 </span>
<span class="4333568825348773807" onmouseenter="enter('4333568825348773807');" onmouseout="out('4333568825348773807');" style=""> 226         showDateBar(true);                                                                               </span>
<span class="371374127972335382" onmouseenter="enter('371374127972335382');" onmouseout="out('371374127972335382');" style=""> 227         if (isChartDirty()) {                                                                            </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 228             refresh();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230     }                                                                                                    </span>
<span  style=""> 231                                                                                                          </span>
<span class="-2587903292449818582" onmouseenter="enter('-2587903292449818582');" onmouseout="out('-2587903292449818582');" style=""> 232     protected void showDateBar(boolean show) {                                                           </span>
<span class="1102668729830068636" onmouseenter="enter('1102668729830068636');" onmouseout="out('1102668729830068636');" style=""> 233         getChartsHost().getDateBar().setVisibility(show ? View.VISIBLE : View.INVISIBLE);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236     @Override                                                                                            </span>
<span class="658855826062432633" onmouseenter="enter('658855826062432633');" onmouseout="out('658855826062432633');" style=""> 237     public void onDestroy() {                                                                            </span>
<span class="7275190530034972367" onmouseenter="enter('7275190530034972367');" onmouseout="out('7275190530034972367');" style=""> 238         super.onDestroy();                                                                               </span>
<span class="-1904828397138023848" onmouseenter="enter('-1904828397138023848');" onmouseout="out('-1904828397138023848');" style=""> 239         LocalBroadcastManager.getInstance(getActivity()).unregisterReceiver(mReceiver);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240     }                                                                                                    </span>
<span  style=""> 241                                                                                                          </span>
<span class="-6518874138984288541" onmouseenter="enter('-6518874138984288541');" onmouseout="out('-6518874138984288541');" style=""> 242     protected void onReceive(Context context, Intent intent) {                                           </span>
<span class="5344227773413700857" onmouseenter="enter('5344227773413700857');" onmouseout="out('5344227773413700857');" style=""> 243         String action = intent.getAction();                                                              </span>
<span class="-494993687329631312" onmouseenter="enter('-494993687329631312');" onmouseout="out('-494993687329631312');" style=""> 244         if (ChartsHost.REFRESH.equals(action)) {                                                         </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 245             refresh();                                                                                   </span>
<span class="8208351658473141292" onmouseenter="enter('8208351658473141292');" onmouseout="out('8208351658473141292');" style=""> 246         } else if (ChartsHost.DATE_NEXT.equals(action)) {                                                </span>
<span class="3429530462558527400" onmouseenter="enter('3429530462558527400');" onmouseout="out('3429530462558527400');" style=""> 247             handleDateNext(getStartDate(), getEndDate());                                                </span>
<span class="6275594107476882748" onmouseenter="enter('6275594107476882748');" onmouseout="out('6275594107476882748');" style=""> 248         } else if (ChartsHost.DATE_PREV.equals(action)) {                                                </span>
<span class="-3035508152708713619" onmouseenter="enter('-3035508152708713619');" onmouseout="out('-3035508152708713619');" style=""> 249             handleDatePrev(getStartDate(), getEndDate());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251     }                                                                                                    </span>
<span  style=""> 252                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 253     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 254      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 255      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 256      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 257      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 258      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259      */                                                                                                  </span>
<span class="-3047400271509647247" onmouseenter="enter('-3047400271509647247');" onmouseout="out('-3047400271509647247');" style=""> 260     protected void handleDatePrev(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 261         if (isVisibleInActivity()) {                                                                     </span>
<span class="-2651860554468779719" onmouseenter="enter('-2651860554468779719');" onmouseout="out('-2651860554468779719');" style=""> 262             if (!shiftDates(startDate, endDate, -1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 263                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 266         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267     }                                                                                                    </span>
<span  style=""> 268                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 270      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 271      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 272      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 273      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 274      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 275      */                                                                                                  </span>
<span class="6615897495863858801" onmouseenter="enter('6615897495863858801');" onmouseout="out('6615897495863858801');" style=""> 276     protected void handleDateNext(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 277         if (isVisibleInActivity()) {                                                                     </span>
<span class="-6485278970310858803" onmouseenter="enter('-6485278970310858803');" onmouseout="out('-6485278970310858803');" style=""> 278             if (!shiftDates(startDate, endDate, +1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 279                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 282         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="5798655654202275728" onmouseenter="enter('5798655654202275728');" onmouseout="out('5798655654202275728');" style=""> 285     protected void refreshIfVisible() {                                                                  </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 286         if (isVisibleInActivity()) {                                                                     </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 287             refresh();                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 288         } else {                                                                                         </span>
<span class="427958345432566734" onmouseenter="enter('427958345432566734');" onmouseout="out('427958345432566734');" style=""> 289             mChartDirty = true;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293     /**                                                                                                  </span>
<span class="-6717682359676050907" onmouseenter="enter('-6717682359676050907');" onmouseout="out('-6717682359676050907');" style=""> 294      * Shifts the given dates by offset days. offset may be positive or negative.                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 296      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 297      * @param endDate                                                                                    </span>
<span class="-3834083067366288846" onmouseenter="enter('-3834083067366288846');" onmouseout="out('-3834083067366288846');" style=""> 298      * @param offset    a positive or negative number of days to shift the dates                         </span>
<span class="-6460740145491493882" onmouseenter="enter('-6460740145491493882');" onmouseout="out('-6460740145491493882');" style=""> 299      * @return true if the shift was successful and false otherwise                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 300      */                                                                                                  </span>
<span class="-1942902413678210438" onmouseenter="enter('-1942902413678210438');" onmouseout="out('-1942902413678210438');" style=""> 301     protected boolean shiftDates(Date startDate, Date endDate, int offset) {                             </span>
<span class="-6336809523669087720" onmouseenter="enter('-6336809523669087720');" onmouseout="out('-6336809523669087720');" style=""> 302         Date newStart = DateTimeUtils.shiftByDays(startDate, offset);                                    </span>
<span class="-2733879703924959637" onmouseenter="enter('-2733879703924959637');" onmouseout="out('-2733879703924959637');" style=""> 303         Date newEnd = DateTimeUtils.shiftByDays(endDate, offset);                                        </span>
<span  style=""> 304                                                                                                          </span>
<span class="-2856611894499161319" onmouseenter="enter('-2856611894499161319');" onmouseout="out('-2856611894499161319');" style=""> 305         return setDateRange(newStart, newEnd);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="-5091098020443224535" onmouseenter="enter('-5091098020443224535');" onmouseout="out('-5091098020443224535');" style=""> 308     protected Integer getColorFor(int activityKind) {                                                    </span>
<span class="1068460219870485515" onmouseenter="enter('1068460219870485515');" onmouseout="out('1068460219870485515');" style=""> 309         switch (activityKind) {                                                                          </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 310             case ActivityKind.TYPE_DEEP_SLEEP:                                                           </span>
<span class="5022727203055802055" onmouseenter="enter('5022727203055802055');" onmouseout="out('5022727203055802055');" style=""> 311                 return akDeepSleep.color;                                                                </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 312             case ActivityKind.TYPE_LIGHT_SLEEP:                                                          </span>
<span class="9202598133274813026" onmouseenter="enter('9202598133274813026');" onmouseout="out('9202598133274813026');" style=""> 313                 return akLightSleep.color;                                                               </span>
<span class="-1944461592116084883" onmouseenter="enter('-1944461592116084883');" onmouseout="out('-1944461592116084883');" style=""> 314             case ActivityKind.TYPE_ACTIVITY:                                                             </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 315                 return akActivity.color;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316         }                                                                                                </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 317         return akActivity.color;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318     }                                                                                                    </span>
<span  style=""> 319                                                                                                          </span>
<span class="7124995295832055820" onmouseenter="enter('7124995295832055820');" onmouseout="out('7124995295832055820');" style=""><abbr title=" 320     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device) {"> 320     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device)ðŸ”µ</abbr></span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 321         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="5252113264335521833" onmouseenter="enter('5252113264335521833');" onmouseout="out('5252113264335521833');" style=""> 322         return coordinator.getSampleProvider(device, db.getDaoSession());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323     }                                                                                                    </span>
<span  style=""> 324                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 325     /**                                                                                                  </span>
<span class="3872148434859025386" onmouseenter="enter('3872148434859025386');" onmouseout="out('3872148434859025386');" style=""> 326      * Returns all kinds of samples for the given device.                                                </span>
<span class="886766698730034078" onmouseenter="enter('886766698730034078');" onmouseout="out('886766698730034078');" style=""> 327      * To be called from a background thread.                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 328      *                                                                                                   </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 329      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 330      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 331      * @param tsTo                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332      */                                                                                                  </span>
<span class="3140984125721729972" onmouseenter="enter('3140984125721729972');" onmouseout="out('3140984125721729972');" style=""><abbr title=" 333     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 333     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, intðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 334         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="3618633972640587810" onmouseenter="enter('3618633972640587810');" onmouseout="out('3618633972640587810');" style=""> 335         return provider.getAllActivitySamples(tsFrom, tsTo);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336     }                                                                                                    </span>
<span  style=""> 337                                                                                                          </span>
<span class="911814376404307930" onmouseenter="enter('911814376404307930');" onmouseout="out('911814376404307930');" style=""><abbr title=" 338     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 338     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, inðŸ”µ</abbr></span>
<span class="5136693054641003501" onmouseenter="enter('5136693054641003501');" onmouseout="out('5136693054641003501');" style=""> 339         SampleProvider&lt;? extends AbstractActivitySample&gt; provider = getProvider(db, device);             </span>
<span class="85967298499632314" onmouseenter="enter('85967298499632314');" onmouseout="out('85967298499632314');" style=""> 340         return provider.getActivitySamples(tsFrom, tsTo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341     }                                                                                                    </span>
<span  style=""> 342                                                                                                          </span>
<span  style=""> 343                                                                                                          </span>
<span class="-241747733905569263" onmouseenter="enter('-241747733905569263');" onmouseout="out('-241747733905569263');" style=""><abbr title=" 344     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 344     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, iðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 345         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="-5906481120950290774" onmouseenter="enter('-5906481120950290774');" onmouseout="out('-5906481120950290774');" style=""> 346         return provider.getSleepSamples(tsFrom, tsTo);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="5612092723136709042" onmouseenter="enter('5612092723136709042');" onmouseout="out('5612092723136709042');" style=""> 349     protected void configureChartDefaults(Chart&lt;?&gt; chart) {                                              </span>
<span class="-7606632580747532983" onmouseenter="enter('-7606632580747532983');" onmouseout="out('-7606632580747532983');" style=""> 350         chart.getXAxis().setValueFormatter(new TimestampValueFormatter());                               </span>
<span class="6778504947781910997" onmouseenter="enter('6778504947781910997');" onmouseout="out('6778504947781910997');" style=""> 351         chart.getDescription().setText(&quot;&quot;);                                                              </span>
<span  style=""> 352                                                                                                          </span>
<span class="24609561265320879" onmouseenter="enter('24609561265320879');" onmouseout="out('24609561265320879');" style=""> 353         // if enabled, the chart will always start at zero on the y-axis                                 </span>
<span class="6529846037374092564" onmouseenter="enter('6529846037374092564');" onmouseout="out('6529846037374092564');" style=""> 354         chart.setNoDataText(getString(R.string.chart_no_data_synchronize));                              </span>
<span  style=""> 355                                                                                                          </span>
<span class="2162327714476306626" onmouseenter="enter('2162327714476306626');" onmouseout="out('2162327714476306626');" style=""> 356         // disable value highlighting                                                                    </span>
<span class="-1590348432070259774" onmouseenter="enter('-1590348432070259774');" onmouseout="out('-1590348432070259774');" style=""> 357         chart.setHighlightPerTapEnabled(false);                                                          </span>
<span  style=""> 358                                                                                                          </span>
<span class="-348919351774733305" onmouseenter="enter('-348919351774733305');" onmouseout="out('-348919351774733305');" style=""> 359         // enable touch gestures                                                                         </span>
<span class="5289310484488287391" onmouseenter="enter('5289310484488287391');" onmouseout="out('5289310484488287391');" style=""> 360         chart.setTouchEnabled(true);                                                                     </span>
<span  style=""> 361                                                                                                          </span>
<span class="-6098879767425938051" onmouseenter="enter('-6098879767425938051');" onmouseout="out('-6098879767425938051');" style=""> 362 // commented out: this has weird bugs/sideeffects at least on WeekStepsCharts                            </span>
<span class="8784253570401363075" onmouseenter="enter('8784253570401363075');" onmouseout="out('8784253570401363075');" style=""> 363 // where only the first Day-label is drawn, because AxisRenderer.computeAxisValues(float,float)          </span>
<span class="-8770575613400395593" onmouseenter="enter('-8770575613400395593');" onmouseout="out('-8770575613400395593');" style=""> 364 // appears to have an overflow when calculating &#x27;n&#x27; (number of entries)                                  </span>
<span class="3888896009006521991" onmouseenter="enter('3888896009006521991');" onmouseout="out('3888896009006521991');" style=""> 365 //        chart.getXAxis().setGranularity(60*5);                                                         </span>
<span  style=""> 366                                                                                                          </span>
<span class="5634570376801469004" onmouseenter="enter('5634570376801469004');" onmouseout="out('5634570376801469004');" style=""> 367         setupLegend(chart);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368     }                                                                                                    </span>
<span  style=""> 369                                                                                                          </span>
<span class="-1924974321468626199" onmouseenter="enter('-1924974321468626199');" onmouseout="out('-1924974321468626199');" style=""> 370     protected void configureBarLineChartDefaults(BarLineChartBase&lt;?&gt; chart) {                            </span>
<span class="5467508404297658352" onmouseenter="enter('5467508404297658352');" onmouseout="out('5467508404297658352');" style=""> 371         configureChartDefaults(chart);                                                                   </span>
<span class="-8169200756215735113" onmouseenter="enter('-8169200756215735113');" onmouseout="out('-8169200756215735113');" style=""> 372         if (chart instanceof BarChart) {                                                                 </span>
<span class="2718779115389378256" onmouseenter="enter('2718779115389378256');" onmouseout="out('2718779115389378256');" style=""> 373             ((BarChart) chart).setFitBars(true);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374         }                                                                                                </span>
<span  style=""> 375                                                                                                          </span>
<span class="-1346367465809520237" onmouseenter="enter('-1346367465809520237');" onmouseout="out('-1346367465809520237');" style=""> 376         // enable scaling and dragging                                                                   </span>
<span class="165705574276177801" onmouseenter="enter('165705574276177801');" onmouseout="out('165705574276177801');" style=""> 377         chart.setDragEnabled(true);                                                                      </span>
<span class="6107382641746821998" onmouseenter="enter('6107382641746821998');" onmouseout="out('6107382641746821998');" style=""> 378         chart.setScaleEnabled(true);                                                                     </span>
<span  style=""> 379                                                                                                          </span>
<span class="6424277115851676497" onmouseenter="enter('6424277115851676497');" onmouseout="out('6424277115851676497');" style=""> 380         // if disabled, scaling can be done on x- and y-axis separately                                  </span>
<span class="6432377865510855871" onmouseenter="enter('6432377865510855871');" onmouseout="out('6432377865510855871');" style=""> 381 //        chart.setPinchZoom(true);                                                                      </span>
<span  style=""> 382                                                                                                          </span>
<span class="-3757744149975665581" onmouseenter="enter('-3757744149975665581');" onmouseout="out('-3757744149975665581');" style=""> 383         chart.setDrawGridBackground(false);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384     }                                                                                                    </span>
<span  style=""> 385                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 386     /**                                                                                                  </span>
<span class="5100165395414783914" onmouseenter="enter('5100165395414783914');" onmouseout="out('5100165395414783914');" style=""> 387      * This method will invoke a background task to read the data from the                               </span>
<span class="5027852704688867372" onmouseenter="enter('5027852704688867372');" onmouseout="out('5027852704688867372');" style=""> 388      * database, analyze it, prepare it for the charts and eventually call                               </span>
<span class="-3918098027409993360" onmouseenter="enter('-3918098027409993360');" onmouseout="out('-3918098027409993360');" style=""> 389      * #renderCharts                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 390      */                                                                                                  </span>
<span class="2809394791911169685" onmouseenter="enter('2809394791911169685');" onmouseout="out('2809394791911169685');" style=""> 391     protected void refresh() {                                                                           </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 392         ChartsHost chartsHost = getChartsHost();                                                         </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 393         if (chartsHost != null) {                                                                        </span>
<span class="-103873194966226890" onmouseenter="enter('-103873194966226890');" onmouseout="out('-103873194966226890');" style=""> 394             if (chartsHost.getDevice() != null) {                                                        </span>
<span class="-5198511171031023043" onmouseenter="enter('-5198511171031023043');" onmouseout="out('-5198511171031023043');" style=""> 395                 mChartDirty = false;                                                                     </span>
<span class="7622323496435283090" onmouseenter="enter('7622323496435283090');" onmouseout="out('7622323496435283090');" style=""> 396                 updateDateInfo(getStartDate(), getEndDate());                                            </span>
<span class="3165810198377965313" onmouseenter="enter('3165810198377965313');" onmouseout="out('3165810198377965313');" style=""> 397                 if (refreshTask != null &amp;&amp; refreshTask.getStatus() != AsyncTask.Status.FINISHED) {       </span>
<span class="-3108005745869946167" onmouseenter="enter('-3108005745869946167');" onmouseout="out('-3108005745869946167');" style=""> 398                     refreshTask.cancel(true);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399                 }                                                                                        </span>
<span class="3840488977465298517" onmouseenter="enter('3840488977465298517');" onmouseout="out('3840488977465298517');" style=""> 400                 refreshTask = createRefreshTask(&quot;Visualizing data&quot;, getActivity()).execute();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403     }                                                                                                    </span>
<span  style=""> 404                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 405     /**                                                                                                  </span>
<span class="4268529485699346115" onmouseenter="enter('4268529485699346115');" onmouseout="out('4268529485699346115');" style=""> 406      * This method reads the data from the database, analyzes and prepares it for                        </span>
<span class="-3790527174834636702" onmouseenter="enter('-3790527174834636702');" onmouseout="out('-3790527174834636702');" style=""> 407      * the charts. This will be called from a background task, so there must not be                      </span>
<span class="8892366747213531989" onmouseenter="enter('8892366747213531989');" onmouseout="out('8892366747213531989');" style=""><abbr title=" 408      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this method."> 408      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this mðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 409      */                                                                                                  </span>
<span class="-9167766646201984999" onmouseenter="enter('-9167766646201984999');" onmouseout="out('-9167766646201984999');" style=""><abbr title=" 410     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice device);"> 410     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice devicðŸ”µ</abbr></span>
<span  style=""> 411                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 412     /**                                                                                                  </span>
<span class="7668378754224811352" onmouseenter="enter('7668378754224811352');" onmouseout="out('7668378754224811352');" style=""> 413      * Triggers the actual (re-) rendering of the chart.                                                 </span>
<span class="1258740047847480611" onmouseenter="enter('1258740047847480611');" onmouseout="out('1258740047847480611');" style=""> 414      * Always called from the UI thread.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 415      */                                                                                                  </span>
<span class="4159836083754598607" onmouseenter="enter('4159836083754598607');" onmouseout="out('4159836083754598607');" style=""> 416     protected abstract void renderCharts();                                                              </span>
<span  style=""> 417                                                                                                          </span>
<span class="1142774420965375266" onmouseenter="enter('1142774420965375266');" onmouseout="out('1142774420965375266');" style=""><abbr title=" 418     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samples) {"> 418     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samplðŸ”µ</abbr></span>
<span class="2571942157260224234" onmouseenter="enter('2571942157260224234');" onmouseout="out('2571942157260224234');" style=""> 419 //        Calendar cal = GregorianCalendar.getInstance();                                                </span>
<span class="4401062856956877488" onmouseenter="enter('4401062856956877488');" onmouseout="out('4401062856956877488');" style=""> 420 //        cal.clear();                                                                                   </span>
<span class="6028849563211801820" onmouseenter="enter('6028849563211801820');" onmouseout="out('6028849563211801820');" style=""> 421         TimestampTranslation tsTranslation = new TimestampTranslation();                                 </span>
<span class="-53760276184898045" onmouseenter="enter('-53760276184898045');" onmouseout="out('-53760276184898045');" style=""> 422 //        Date date;                                                                                     </span>
<span class="-6156197187638932942" onmouseenter="enter('-6156197187638932942');" onmouseout="out('-6156197187638932942');" style=""> 423 //        String dateStringFrom = &quot;&quot;;                                                                    </span>
<span class="4183977243651978214" onmouseenter="enter('4183977243651978214');" onmouseout="out('4183977243651978214');" style=""> 424 //        String dateStringTo = &quot;&quot;;                                                                      </span>
<span class="147032316452628113" onmouseenter="enter('147032316452628113');" onmouseout="out('147032316452628113');" style=""> 425 //        ArrayList&lt;String&gt; xLabels = null;                                                              </span>
<span  style=""> 426                                                                                                          </span>
<span class="-8827232702598725695" onmouseenter="enter('-8827232702598725695');" onmouseout="out('-8827232702598725695');" style=""> 427         LOG.info(&quot;&quot; + getTitle() + &quot;: number of samples:&quot; + samples.size());                             </span>
<span class="3654763384087017314" onmouseenter="enter('3654763384087017314');" onmouseout="out('3654763384087017314');" style=""> 428         LineData lineData;                                                                               </span>
<span class="-9107937003987659062" onmouseenter="enter('-9107937003987659062');" onmouseout="out('-9107937003987659062');" style=""> 429         if (samples.size() &gt; 1) {                                                                        </span>
<span class="-8527306736668810111" onmouseenter="enter('-8527306736668810111');" onmouseout="out('-8527306736668810111');" style=""> 430             boolean annotate = true;                                                                     </span>
<span class="1395829712909105015" onmouseenter="enter('1395829712909105015');" onmouseout="out('1395829712909105015');" style=""> 431             boolean use_steps_as_movement;                                                               </span>
<span  style=""> 432                                                                                                          </span>
<span class="4142243867024174482" onmouseenter="enter('4142243867024174482');" onmouseout="out('4142243867024174482');" style=""> 433             int last_type = ActivityKind.TYPE_UNKNOWN;                                                   </span>
<span  style=""> 434                                                                                                          </span>
<span class="-2031252584474024476" onmouseenter="enter('-2031252584474024476');" onmouseout="out('-2031252584474024476');" style=""> 435             int numEntries = samples.size();                                                             </span>
<span class="-8870011066494287543" onmouseenter="enter('-8870011066494287543');" onmouseout="out('-8870011066494287543');" style=""> 436             List&lt;Entry&gt; activityEntries = new ArrayList&lt;&gt;(numEntries);                                   </span>
<span class="4899105382649046594" onmouseenter="enter('4899105382649046594');" onmouseout="out('4899105382649046594');" style=""> 437             List&lt;Entry&gt; deepSleepEntries = new ArrayList&lt;&gt;(numEntries);                                  </span>
<span class="7486237668847997910" onmouseenter="enter('7486237668847997910');" onmouseout="out('7486237668847997910');" style=""> 438             List&lt;Entry&gt; lightSleepEntries = new ArrayList&lt;&gt;(numEntries);                                 </span>
<span class="-1233994828972266903" onmouseenter="enter('-1233994828972266903');" onmouseout="out('-1233994828972266903');" style=""> 439             List&lt;Entry&gt; notWornEntries = new ArrayList&lt;&gt;(numEntries);                                    </span>
<span class="-7435551010854374427" onmouseenter="enter('-7435551010854374427');" onmouseout="out('-7435551010854374427');" style=""> 440             boolean hr = supportsHeartrate(gbDevice);                                                    </span>
<span class="-5348686395661515277" onmouseenter="enter('-5348686395661515277');" onmouseout="out('-5348686395661515277');" style=""> 441             List&lt;Entry&gt; heartrateEntries = hr ? new ArrayList&lt;Entry&gt;(numEntries) : null;                 </span>
<span class="8656271717087272693" onmouseenter="enter('8656271717087272693');" onmouseout="out('8656271717087272693');" style=""> 442             List&lt;Integer&gt; colors = new ArrayList&lt;&gt;(numEntries); // this is kinda inefficient...          </span>
<span class="7529735733952592718" onmouseenter="enter('7529735733952592718');" onmouseout="out('7529735733952592718');" style=""> 443             int lastHrSampleIndex = -1;                                                                  </span>
<span  style=""> 444                                                                                                          </span>
<span class="4476749361735409543" onmouseenter="enter('4476749361735409543');" onmouseout="out('4476749361735409543');" style=""> 445             for (int i = 0; i &lt; numEntries; i++) {                                                       </span>
<span class="3246332292526896189" onmouseenter="enter('3246332292526896189');" onmouseout="out('3246332292526896189');" style=""> 446                 ActivitySample sample = samples.get(i);                                                  </span>
<span class="6576081203602242327" onmouseenter="enter('6576081203602242327');" onmouseout="out('6576081203602242327');" style=""> 447                 int type = sample.getKind();                                                             </span>
<span class="-9213760672368715167" onmouseenter="enter('-9213760672368715167');" onmouseout="out('-9213760672368715167');" style=""> 448                 int ts = tsTranslation.shorten(sample.getTimestamp());                                   </span>
<span  style=""> 449                                                                                                          </span>
<span class="-6141709027769286674" onmouseenter="enter('-6141709027769286674');" onmouseout="out('-6141709027769286674');" style=""> 450 //                System.out.println(ts);                                                                </span>
<span class="1901381804146795461" onmouseenter="enter('1901381804146795461');" onmouseout="out('1901381804146795461');" style=""> 451 //                ts = i;                                                                                </span>
<span class="5764290091373211945" onmouseenter="enter('5764290091373211945');" onmouseout="out('5764290091373211945');" style=""> 452                 // determine start and end dates                                                         </span>
<span class="5717361089680993355" onmouseenter="enter('5717361089680993355');" onmouseout="out('5717361089680993355');" style=""> 453 //                if (i == 0) {                                                                          </span>
<span class="7046397249359147146" onmouseenter="enter('7046397249359147146');" onmouseout="out('7046397249359147146');" style=""> 454 //                    cal.setTimeInMillis(ts * 1000L); // make sure it&#x27;s converted to long               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 455 //                    date = cal.getTime();                                                              </span>
<span class="5571666638688830790" onmouseenter="enter('5571666638688830790');" onmouseout="out('5571666638688830790');" style=""> 456 //                    dateStringFrom = dateFormat.format(date);                                          </span>
<span class="-1516242143504559710" onmouseenter="enter('-1516242143504559710');" onmouseout="out('-1516242143504559710');" style=""> 457 //                } else if (i == samples.size() - 1) {                                                  </span>
<span class="241708909740168031" onmouseenter="enter('241708909740168031');" onmouseout="out('241708909740168031');" style=""> 458 //                    cal.setTimeInMillis(ts * 1000L); // same here                                      </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 459 //                    date = cal.getTime();                                                              </span>
<span class="993250294615949060" onmouseenter="enter('993250294615949060');" onmouseout="out('993250294615949060');" style=""> 460 //                    dateStringTo = dateFormat.format(date);                                            </span>
<span class="8884174724223176501" onmouseenter="enter('8884174724223176501');" onmouseout="out('8884174724223176501');" style=""> 461 //                }                                                                                      </span>
<span  style=""> 462                                                                                                          </span>
<span class="-8914675673971344704" onmouseenter="enter('-8914675673971344704');" onmouseout="out('-8914675673971344704');" style=""> 463                 float movement = sample.getIntensity();                                                  </span>
<span  style=""> 464                                                                                                          </span>
<span class="5917499164651721508" onmouseenter="enter('5917499164651721508');" onmouseout="out('5917499164651721508');" style=""> 465                 float value = movement;                                                                  </span>
<span class="3474584951622682325" onmouseenter="enter('3474584951622682325');" onmouseout="out('3474584951622682325');" style=""> 466                 switch (type) {                                                                          </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 467                     case ActivityKind.TYPE_DEEP_SLEEP:                                                   </span>
<span class="8800766899670031569" onmouseenter="enter('8800766899670031569');" onmouseout="out('8800766899670031569');" style=""><abbr title=" 468                         if (last_type != type) { //FIXME: this is ugly but it works (repeated in each case)"> 468                         if (last_type != type) { //FIXME: this is ugly but it works (repeated in each casðŸ”µ</abbr></span>
<span class="-1661959904957213102" onmouseenter="enter('-1661959904957213102');" onmouseout="out('-1661959904957213102');" style=""> 469                             deepSleepEntries.add(createLineEntry(0, ts - 1));                            </span>
<span  style=""> 470                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 471                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 472                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 473                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                         }                                                                                </span>
<span class="-6180311285798694701" onmouseenter="enter('-6180311285798694701');" onmouseout="out('-6180311285798694701');" style=""> 475                         deepSleepEntries.add(createLineEntry(value + SleepUtils.Y_VALUE_DEEP_SLEEP, ts));</span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 476                         break;                                                                           </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 477                     case ActivityKind.TYPE_LIGHT_SLEEP:                                                  </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 478                         if (last_type != type) {                                                         </span>
<span class="7147575638574677011" onmouseenter="enter('7147575638574677011');" onmouseout="out('7147575638574677011');" style=""> 479                             lightSleepEntries.add(createLineEntry(0, ts - 1));                           </span>
<span  style=""> 480                                                                                                          </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 481                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 482                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 483                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                         }                                                                                </span>
<span class="-5875750109358144719" onmouseenter="enter('-5875750109358144719');" onmouseout="out('-5875750109358144719');" style=""> 485                         lightSleepEntries.add(createLineEntry(value, ts));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 486                         break;                                                                           </span>
<span class="-9132572973740238507" onmouseenter="enter('-9132572973740238507');" onmouseout="out('-9132572973740238507');" style=""> 487                     case ActivityKind.TYPE_NOT_WORN:                                                     </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 488                         if (last_type != type) {                                                         </span>
<span class="4292609800559774054" onmouseenter="enter('4292609800559774054');" onmouseout="out('4292609800559774054');" style=""> 489                             notWornEntries.add(createLineEntry(0, ts - 1));                              </span>
<span  style=""> 490                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 491                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 492                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 493                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494                         }                                                                                </span>
<span class="5412917281309595074" onmouseenter="enter('5412917281309595074');" onmouseout="out('5412917281309595074');" style=""><abbr title=" 495                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, just to show something on the graphs"> 495                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a smallðŸ”µ</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 496                         break;                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 497                     default:                                                                             </span>
<span class="-4054780187002246392" onmouseenter="enter('-4054780187002246392');" onmouseout="out('-4054780187002246392');" style=""> 498 //                        short steps = sample.getSteps();                                               </span>
<span class="-1494320471491276911" onmouseenter="enter('-1494320471491276911');" onmouseout="out('-1494320471491276911');" style=""> 499 //                        if (use_steps_as_movement &amp;&amp; steps != 0) {                                     </span>
<span class="-3251198952450992064" onmouseenter="enter('-3251198952450992064');" onmouseout="out('-3251198952450992064');" style=""> 500 //                            // I&#x27;m not sure using steps for this is actually a good idea               </span>
<span class="-6376968801115210935" onmouseenter="enter('-6376968801115210935');" onmouseout="out('-6376968801115210935');" style=""> 501 //                            movement = steps;                                                          </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 502 //                        }                                                                              </span>
<span class="-941684175082606672" onmouseenter="enter('-941684175082606672');" onmouseout="out('-941684175082606672');" style=""> 503 //                        value = ((float) movement) / movement_divisor;                                 </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 504                         if (last_type != type) {                                                         </span>
<span class="-6771781995837807247" onmouseenter="enter('-6771781995837807247');" onmouseout="out('-6771781995837807247');" style=""> 505                             activityEntries.add(createLineEntry(0, ts - 1));                             </span>
<span  style=""> 506                                                                                                          </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 507                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 508                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 509                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510                         }                                                                                </span>
<span class="4080308283196262910" onmouseenter="enter('4080308283196262910');" onmouseout="out('4080308283196262910');" style=""> 511                         activityEntries.add(createLineEntry(value, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                 }                                                                                        </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 513 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="678415431212127122" onmouseenter="enter('678415431212127122');" onmouseout="out('678415431212127122');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 514                 if (hr &amp;&amp; HeartRateUtils.isValidHeartRateValue(sample.getHeartRate())) {                 </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 515 ||||||| BASE                                                                                             </span>
<span class="6502915003910560814" onmouseenter="enter('6502915003910560814');" onmouseout="out('6502915003910560814');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 516                 if (hr &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {                                </span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 517                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 517                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEAðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 518 =======                                                                                                  </span>
<span class="6904435308673061248" onmouseenter="enter('6904435308673061248');" onmouseout="out('6904435308673061248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 519                 if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {"> 519                 if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.ðŸ”µ</abbr></span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 520 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style=""><abbr title=" 521                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 521                     if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEAðŸ”µ</abbr></span>
<span class="7928119684647429254" onmouseenter="enter('7928119684647429254');" onmouseout="out('7928119684647429254');" style=""> 522                         heartrateEntries.add(createLineEntry(0, lastHrSampleIndex + 1));                 </span>
<span class="-5182503479458455454" onmouseenter="enter('-5182503479458455454');" onmouseout="out('-5182503479458455454');" style=""> 523                         heartrateEntries.add(createLineEntry(0, ts - 1));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524                     }                                                                                    </span>
<span  style=""> 525                                                                                                          </span>
<span class="-8554726460294545666" onmouseenter="enter('-8554726460294545666');" onmouseout="out('-8554726460294545666');" style=""> 526                     heartrateEntries.add(createLineEntry(sample.getHeartRate(), ts));                    </span>
<span class="1340167295380328410" onmouseenter="enter('1340167295380328410');" onmouseout="out('1340167295380328410');" style=""> 527                     lastHrSampleIndex = ts;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528                 }                                                                                        </span>
<span  style=""> 529                                                                                                          </span>
<span class="7730925444289024998" onmouseenter="enter('7730925444289024998');" onmouseout="out('7730925444289024998');" style=""> 530                 String xLabel = &quot;&quot;;                                                                      </span>
<span class="-5459254189226498661" onmouseenter="enter('-5459254189226498661');" onmouseout="out('-5459254189226498661');" style=""> 531                 if (annotate) {                                                                          </span>
<span class="-1465306111701045962" onmouseenter="enter('-1465306111701045962');" onmouseout="out('-1465306111701045962');" style=""> 532 //                    cal.setTimeInMillis((ts + tsOffset) * 1000L);                                      </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 533 //                    date = cal.getTime();                                                              </span>
<span class="-1086602658675179068" onmouseenter="enter('-1086602658675179068');" onmouseout="out('-1086602658675179068');" style=""> 534 //                    String dateString = annotationDateFormat.format(date);                             </span>
<span class="-2931946040942644368" onmouseenter="enter('-2931946040942644368');" onmouseout="out('-2931946040942644368');" style=""> 535 //                    xLabel = dateString;                                                               </span>
<span class="5566449710495547766" onmouseenter="enter('5566449710495547766');" onmouseout="out('5566449710495547766');" style=""> 536 //                    if (last_type != type) {                                                           </span>
<span class="7413255212379424149" onmouseenter="enter('7413255212379424149');" onmouseout="out('7413255212379424149');" style=""> 537 //                        if (isSleep(last_type) &amp;&amp; !isSleep(type)) {                                    </span>
<span class="-56714345320416604" onmouseenter="enter('-56714345320416604');" onmouseout="out('-56714345320416604');" style=""> 538 //                            // woken up                                                                </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 539 //                            LimitLine line = new LimitLine(i, dateString);                             </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 540 //                            line.enableDashedLine(8, 8, 0);                                            </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 541 //                            line.setTextColor(Color.WHITE);                                            </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 542 //                            line.setTextSize(15);                                                      </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 543 //                            chart.getXAxis().addLimitLine(line);                                       </span>
<span class="-5828290692175278159" onmouseenter="enter('-5828290692175278159');" onmouseout="out('-5828290692175278159');" style=""> 544 //                        } else if (!isSleep(last_type) &amp;&amp; isSleep(type)) {                             </span>
<span class="5244181556799794554" onmouseenter="enter('5244181556799794554');" onmouseout="out('5244181556799794554');" style=""> 545 //                            // fallen asleep                                                           </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 546 //                            LimitLine line = new LimitLine(i, dateString);                             </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 547 //                            line.enableDashedLine(8, 8, 0);                                            </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 548 //                            line.setTextSize(15);                                                      </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 549 //                            line.setTextColor(Color.WHITE);                                            </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 550 //                            chart.getXAxis().addLimitLine(line);                                       </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 551 //                        }                                                                              </span>
<span class="6051702211689751699" onmouseenter="enter('6051702211689751699');" onmouseout="out('6051702211689751699');" style=""> 552 //                    }                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 553                 }                                                                                        </span>
<span class="-1444147652675010833" onmouseenter="enter('-1444147652675010833');" onmouseout="out('-1444147652675010833');" style=""> 554                 last_type = type;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 555             }                                                                                            </span>
<span  style=""> 556                                                                                                          </span>
<span  style=""> 557                                                                                                          </span>
<span class="-1579194111559420554" onmouseenter="enter('-1579194111559420554');" onmouseout="out('-1579194111559420554');" style=""> 558             List&lt;ILineDataSet&gt; lineDataSets = new ArrayList&lt;&gt;();                                         </span>
<span class="-1359387837948108742" onmouseenter="enter('-1359387837948108742');" onmouseout="out('-1359387837948108742');" style=""> 559             LineDataSet activitySet = createDataSet(activityEntries, akActivity.color, &quot;Activity&quot;);      </span>
<span class="-3354127768405521554" onmouseenter="enter('-3354127768405521554');" onmouseout="out('-3354127768405521554');" style=""> 560             lineDataSets.add(activitySet);                                                               </span>
<span class="7026895411091818045" onmouseenter="enter('7026895411091818045');" onmouseout="out('7026895411091818045');" style=""> 561             LineDataSet deepSleepSet = createDataSet(deepSleepEntries, akDeepSleep.color, &quot;Deep Sleep&quot;); </span>
<span class="-3446958151566211125" onmouseenter="enter('-3446958151566211125');" onmouseout="out('-3446958151566211125');" style=""> 562             lineDataSets.add(deepSleepSet);                                                              </span>
<span class="4693393103163137779" onmouseenter="enter('4693393103163137779');" onmouseout="out('4693393103163137779');" style=""><abbr title=" 563             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light Sleep&quot;);"> 563             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light SleepðŸ”µ</abbr></span>
<span class="8003351674511898289" onmouseenter="enter('8003351674511898289');" onmouseout="out('8003351674511898289');" style=""> 564             lineDataSets.add(lightSleepSet);                                                             </span>
<span class="-7108338871992330028" onmouseenter="enter('-7108338871992330028');" onmouseout="out('-7108338871992330028');" style=""> 565             LineDataSet notWornSet = createDataSet(notWornEntries, akNotWorn.color, &quot;Not worn&quot;);         </span>
<span class="64462528287934820" onmouseenter="enter('64462528287934820');" onmouseout="out('64462528287934820');" style=""> 566             lineDataSets.add(notWornSet);                                                                </span>
<span  style=""> 567                                                                                                          </span>
<span class="-8621348893512609171" onmouseenter="enter('-8621348893512609171');" onmouseout="out('-8621348893512609171');" style=""> 568             if (hr &amp;&amp; heartrateEntries.size() &gt; 0) {                                                     </span>
<span class="-6373591549531816713" onmouseenter="enter('-6373591549531816713');" onmouseout="out('-6373591549531816713');" style=""> 569                 LineDataSet heartrateSet = createHeartrateSet(heartrateEntries, &quot;Heart Rate&quot;);           </span>
<span  style=""> 570                                                                                                          </span>
<span class="8944960460471270621" onmouseenter="enter('8944960460471270621');" onmouseout="out('8944960460471270621');" style=""> 571                 lineDataSets.add(heartrateSet);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572             }                                                                                            </span>
<span class="2703760882318229208" onmouseenter="enter('2703760882318229208');" onmouseout="out('2703760882318229208');" style=""> 573             lineData = new LineData(lineDataSets);                                                       </span>
<span  style=""> 574                                                                                                          </span>
<span class="-6499460759915470269" onmouseenter="enter('-6499460759915470269');" onmouseout="out('-6499460759915470269');" style=""><abbr title=" 575 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStringTo));"> 575 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStriðŸ”µ</abbr></span>
<span class="-3762887228500678217" onmouseenter="enter('-3762887228500678217');" onmouseout="out('-3762887228500678217');" style=""> 576 //            chart.setDescriptionPosition(?, ?);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 577         } else {                                                                                         </span>
<span class="-2761320896669897238" onmouseenter="enter('-2761320896669897238');" onmouseout="out('-2761320896669897238');" style=""> 578             lineData = new LineData();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 579         }                                                                                                </span>
<span  style=""> 580                                                                                                          </span>
<span class="-1609543182283032519" onmouseenter="enter('-1609543182283032519');" onmouseout="out('-1609543182283032519');" style=""> 581         IAxisValueFormatter xValueFormatter = new SampleXLabelFormatter(tsTranslation);                  </span>
<span class="-3441797761873957961" onmouseenter="enter('-3441797761873957961');" onmouseout="out('-3441797761873957961');" style=""> 582         return new DefaultChartsData(lineData, xValueFormatter);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583     }                                                                                                    </span>
<span  style=""> 584                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 585     /**                                                                                                  </span>
<span class="6334547652397213625" onmouseenter="enter('6334547652397213625');" onmouseout="out('6334547652397213625');" style=""> 586      * Implement this to supply the samples to be displayed.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 587      *                                                                                                   </span>
<span class="5464670662091686554" onmouseenter="enter('5464670662091686554');" onmouseout="out('5464670662091686554');" style=""> 588      * @param db                                                                                         </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 589      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 590      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 591      * @param tsTo                                                                                       </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 592      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 593      */                                                                                                  </span>
<span class="-4899824222168510613" onmouseenter="enter('-4899824222168510613');" onmouseout="out('-4899824222168510613');" style=""><abbr title=" 594     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo);"> 594     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFroðŸ”µ</abbr></span>
<span  style=""> 595                                                                                                          </span>
<span class="354769125648165857" onmouseenter="enter('354769125648165857');" onmouseout="out('354769125648165857');" style=""> 596     protected abstract void setupLegend(Chart chart);                                                    </span>
<span  style=""> 597                                                                                                          </span>
<span class="-188113346780130145" onmouseenter="enter('-188113346780130145');" onmouseout="out('-188113346780130145');" style=""> 598     protected Entry createLineEntry(float value, int xValue) {                                           </span>
<span class="5155334880625707837" onmouseenter="enter('5155334880625707837');" onmouseout="out('5155334880625707837');" style=""> 599         return new Entry(xValue, value);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600     }                                                                                                    </span>
<span  style=""> 601                                                                                                          </span>
<span class="5268984431672798069" onmouseenter="enter('5268984431672798069');" onmouseout="out('5268984431672798069');" style=""> 602     protected LineDataSet createDataSet(List&lt;Entry&gt; values, Integer color, String label) {               </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 603         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="820149155345415568" onmouseenter="enter('820149155345415568');" onmouseout="out('820149155345415568');" style=""> 604         set1.setColor(color);                                                                            </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 605 //        set1.setDrawCubic(true);                                                                       </span>
<span class="-7031616190320035410" onmouseenter="enter('-7031616190320035410');" onmouseout="out('-7031616190320035410');" style=""> 606 //        set1.setCubicIntensity(0.2f);                                                                  </span>
<span class="5358451272424367352" onmouseenter="enter('5358451272424367352');" onmouseout="out('5358451272424367352');" style=""> 607         set1.setDrawFilled(true);                                                                        </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 608         set1.setDrawCircles(false);                                                                      </span>
<span class="5314519233815368988" onmouseenter="enter('5314519233815368988');" onmouseout="out('5314519233815368988');" style=""> 609 //        set1.setLineWidth(2f);                                                                         </span>
<span class="4052186244749569041" onmouseenter="enter('4052186244749569041');" onmouseout="out('4052186244749569041');" style=""> 610 //        set1.setCircleSize(5f);                                                                        </span>
<span class="5178863964691876958" onmouseenter="enter('5178863964691876958');" onmouseout="out('5178863964691876958');" style=""> 611         set1.setFillColor(color);                                                                        </span>
<span class="-3615467214536174629" onmouseenter="enter('-3615467214536174629');" onmouseout="out('-3615467214536174629');" style=""> 612         set1.setFillAlpha(255);                                                                          </span>
<span class="-2764219564959910542" onmouseenter="enter('-2764219564959910542');" onmouseout="out('-2764219564959910542');" style=""> 613         set1.setDrawValues(false);                                                                       </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 614 //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 615 //        set1.setColor(Color.rgb(89, 178, 44));                                                         </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 616         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="-729266328453548997" onmouseenter="enter('-729266328453548997');" onmouseout="out('-729266328453548997');" style=""> 617         set1.setAxisDependency(YAxis.AxisDependency.LEFT);                                               </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 618         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619     }                                                                                                    </span>
<span  style=""> 620                                                                                                          </span>
<span class="812124301236032885" onmouseenter="enter('812124301236032885');" onmouseout="out('812124301236032885');" style=""> 621     protected LineDataSet createHeartrateSet(List&lt;Entry&gt; values, String label) {                         </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 622         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="5440468726562122008" onmouseenter="enter('5440468726562122008');" onmouseout="out('5440468726562122008');" style=""> 623         set1.setLineWidth(2.2f);                                                                         </span>
<span class="-6998111113207584878" onmouseenter="enter('-6998111113207584878');" onmouseout="out('-6998111113207584878');" style=""> 624         set1.setColor(HEARTRATE_COLOR);                                                                  </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 625 //        set1.setDrawCubic(true);                                                                       </span>
<span class="-5525611047697799836" onmouseenter="enter('-5525611047697799836');" onmouseout="out('-5525611047697799836');" style=""> 626         set1.setMode(LineDataSet.Mode.HORIZONTAL_BEZIER);                                                </span>
<span class="-6788168983082898765" onmouseenter="enter('-6788168983082898765');" onmouseout="out('-6788168983082898765');" style=""> 627         set1.setCubicIntensity(0.1f);                                                                    </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 628         set1.setDrawCircles(false);                                                                      </span>
<span class="8990366444861982417" onmouseenter="enter('8990366444861982417');" onmouseout="out('8990366444861982417');" style=""> 629 //        set1.setCircleRadius(2f);                                                                      </span>
<span class="7490911489692857332" onmouseenter="enter('7490911489692857332');" onmouseout="out('7490911489692857332');" style=""> 630 //        set1.setDrawFilled(true);                                                                      </span>
<span class="-2083836916768378283" onmouseenter="enter('-2083836916768378283');" onmouseout="out('-2083836916768378283');" style=""> 631 //        set1.setColor(getResources().getColor(android.R.color.background_light));                      </span>
<span class="5114874680539545534" onmouseenter="enter('5114874680539545534');" onmouseout="out('5114874680539545534');" style=""> 632 //        set1.setCircleColor(HEARTRATE_COLOR);                                                          </span>
<span class="2152854923555754112" onmouseenter="enter('2152854923555754112');" onmouseout="out('2152854923555754112');" style=""> 633 //        set1.setFillColor(ColorTemplate.getHoloBlue());                                                </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 634 //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 635 //        set1.setColor(Color.rgb(89, 178, 44));                                                         </span>
<span class="-6976214771678818552" onmouseenter="enter('-6976214771678818552');" onmouseout="out('-6976214771678818552');" style=""> 636         set1.setDrawValues(true);                                                                        </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 637         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="7444000937070277499" onmouseenter="enter('7444000937070277499');" onmouseout="out('7444000937070277499');" style=""> 638         set1.setAxisDependency(YAxis.AxisDependency.RIGHT);                                              </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 639         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640     }                                                                                                    </span>
<span  style=""> 641                                                                                                          </span>
<span class="-8033521169229713638" onmouseenter="enter('-8033521169229713638');" onmouseout="out('-8033521169229713638');" style=""> 642     protected RefreshTask createRefreshTask(String task, Context context) {                              </span>
<span class="4652327534384605753" onmouseenter="enter('4652327534384605753');" onmouseout="out('4652327534384605753');" style=""> 643         return new RefreshTask(task, context);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644     }                                                                                                    </span>
<span  style=""> 645                                                                                                          </span>
<span class="-546204840646058388" onmouseenter="enter('-546204840646058388');" onmouseout="out('-546204840646058388');" style=""> 646     public class RefreshTask extends DBAccess {                                                          </span>
<span class="3813756787288835606" onmouseenter="enter('3813756787288835606');" onmouseout="out('3813756787288835606');" style=""> 647         private ChartsData chartsData;                                                                   </span>
<span  style=""> 648                                                                                                          </span>
<span class="6265910281991326326" onmouseenter="enter('6265910281991326326');" onmouseout="out('6265910281991326326');" style=""> 649         public RefreshTask(String task, Context context) {                                               </span>
<span class="6170214191344158476" onmouseenter="enter('6170214191344158476');" onmouseout="out('6170214191344158476');" style=""> 650             super(task, context);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651         }                                                                                                </span>
<span  style=""> 652                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 653         @Override                                                                                        </span>
<span class="6769214505219419913" onmouseenter="enter('6769214505219419913');" onmouseout="out('6769214505219419913');" style=""> 654         protected void doInBackground(DBHandler db) {                                                    </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 655             ChartsHost chartsHost = getChartsHost();                                                     </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 656             if (chartsHost != null) {                                                                    </span>
<span class="-1872147130605113863" onmouseenter="enter('-1872147130605113863');" onmouseout="out('-1872147130605113863');" style=""> 657                 chartsData = refreshInBackground(chartsHost, db, chartsHost.getDevice());                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 658             } else {                                                                                     </span>
<span class="4351338677612212716" onmouseenter="enter('4351338677612212716');" onmouseout="out('4351338677612212716');" style=""> 659                 cancel(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 660             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661         }                                                                                                </span>
<span  style=""> 662                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 663         @Override                                                                                        </span>
<span class="7961646527709364830" onmouseenter="enter('7961646527709364830');" onmouseout="out('7961646527709364830');" style=""> 664         protected void onPostExecute(Object o) {                                                         </span>
<span class="1329337488051350495" onmouseenter="enter('1329337488051350495');" onmouseout="out('1329337488051350495');" style=""> 665             super.onPostExecute(o);                                                                      </span>
<span class="4343120289681205406" onmouseenter="enter('4343120289681205406');" onmouseout="out('4343120289681205406');" style=""> 666             FragmentActivity activity = getActivity();                                                   </span>
<span class="1646077047954275991" onmouseenter="enter('1646077047954275991');" onmouseout="out('1646077047954275991');" style=""> 667             if (activity != null &amp;&amp; !activity.isFinishing() &amp;&amp; !activity.isDestroyed()) {                </span>
<span class="-9005677599852802201" onmouseenter="enter('-9005677599852802201');" onmouseout="out('-9005677599852802201');" style=""> 668                 updateChartsnUIThread(chartsData);                                                       </span>
<span class="-4582773223831390369" onmouseenter="enter('-4582773223831390369');" onmouseout="out('-4582773223831390369');" style=""> 669                 renderCharts();                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 670             } else {                                                                                     </span>
<span class="-112827357653254579" onmouseenter="enter('-112827357653254579');" onmouseout="out('-112827357653254579');" style=""> 671                 LOG.info(&quot;Not rendering charts because activity is not available anymore&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 673         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 674     }                                                                                                    </span>
<span  style=""> 675                                                                                                          </span>
<span class="4496803111214409190" onmouseenter="enter('4496803111214409190');" onmouseout="out('4496803111214409190');" style=""> 676     protected abstract void updateChartsnUIThread(ChartsData chartsData);                                </span>
<span  style=""> 677                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 678     /**                                                                                                  </span>
<span class="-5037778349112302453" onmouseenter="enter('-5037778349112302453');" onmouseout="out('-5037778349112302453');" style=""> 679      * Returns true if the date was successfully shifted, and false if the shift                         </span>
<span class="-2032571983951913696" onmouseenter="enter('-2032571983951913696');" onmouseout="out('-2032571983951913696');" style=""> 680      * was ignored, e.g. when the to-value is in the future.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 681      *                                                                                                   </span>
<span class="3294571698788299338" onmouseenter="enter('3294571698788299338');" onmouseout="out('3294571698788299338');" style=""> 682      * @param from                                                                                       </span>
<span class="-8398071401251508968" onmouseenter="enter('-8398071401251508968');" onmouseout="out('-8398071401251508968');" style=""> 683      * @param to                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 684      */                                                                                                  </span>
<span class="2489721831712552479" onmouseenter="enter('2489721831712552479');" onmouseout="out('2489721831712552479');" style=""> 685     public boolean setDateRange(Date from, Date to) {                                                    </span>
<span class="4190819803131113323" onmouseenter="enter('4190819803131113323');" onmouseout="out('4190819803131113323');" style=""> 686         if (from.compareTo(to) &gt; 0) {                                                                    </span>
<span class="8028532381572922008" onmouseenter="enter('8028532381572922008');" onmouseout="out('8028532381572922008');" style=""> 687             throw new IllegalArgumentException(&quot;Bad date range: &quot; + from + &quot;..&quot; + to);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 688         }                                                                                                </span>
<span class="-968081081932492520" onmouseenter="enter('-968081081932492520');" onmouseout="out('-968081081932492520');" style=""> 689         Date now = new Date();                                                                           </span>
<span class="6487488966631950340" onmouseenter="enter('6487488966631950340');" onmouseout="out('6487488966631950340');" style=""> 690         if (to.after(now)) {                                                                             </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 691             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692         }                                                                                                </span>
<span class="-9201818232828316665" onmouseenter="enter('-9201818232828316665');" onmouseout="out('-9201818232828316665');" style=""> 693         setStartDate(from);                                                                              </span>
<span class="9222819538541566960" onmouseenter="enter('9222819538541566960');" onmouseout="out('9222819538541566960');" style=""> 694         setEndDate(to);                                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 695         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 696     }                                                                                                    </span>
<span  style=""> 697                                                                                                          </span>
<span class="3159484724367933437" onmouseenter="enter('3159484724367933437');" onmouseout="out('3159484724367933437');" style=""> 698     protected void updateDateInfo(Date from, Date to) {                                                  </span>
<span class="-6255879985318699594" onmouseenter="enter('-6255879985318699594');" onmouseout="out('-6255879985318699594');" style=""> 699         if (from.equals(to)) {                                                                           </span>
<span class="573039521209829270" onmouseenter="enter('573039521209829270');" onmouseout="out('573039521209829270');" style=""> 700             getChartsHost().setDateInfo(DateTimeUtils.formatDate(from));                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 701         } else {                                                                                         </span>
<span class="6154857771528724742" onmouseenter="enter('6154857771528724742');" onmouseout="out('6154857771528724742');" style=""> 702             getChartsHost().setDateInfo(DateTimeUtils.formatDateRange(from, to));                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 703         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 704     }                                                                                                    </span>
<span  style=""> 705                                                                                                          </span>
<span class="-2205559255794313412" onmouseenter="enter('-2205559255794313412');" onmouseout="out('-2205559255794313412');" style=""> 706     protected List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device) {                 </span>
<span class="4967864623407424140" onmouseenter="enter('4967864623407424140');" onmouseout="out('4967864623407424140');" style=""> 707         int tsStart = getTSStart();                                                                      </span>
<span class="-7516136729766634070" onmouseenter="enter('-7516136729766634070');" onmouseout="out('-7516136729766634070');" style=""> 708         int tsEnd = getTSEnd();                                                                          </span>
<span class="7673509543804257849" onmouseenter="enter('7673509543804257849');" onmouseout="out('7673509543804257849');" style=""> 709         List&lt;ActivitySample&gt; samples = (List&lt;ActivitySample&gt;) getSamples(db, device, tsStart, tsEnd);    </span>
<span class="-5815796914087715329" onmouseenter="enter('-5815796914087715329');" onmouseout="out('-5815796914087715329');" style=""> 710         ensureStartAndEndSamples(samples, tsStart, tsEnd);                                               </span>
<span class="1818060248517305383" onmouseenter="enter('1818060248517305383');" onmouseout="out('1818060248517305383');" style=""> 711 //        List&lt;ActivitySample&gt; samples2 = new ArrayList&lt;&gt;();                                             </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 712 //        int min = Math.min(samples.size(), 10);                                                        </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 713 //        int min = Math.min(samples.size(), 10);                                                        </span>
<span class="-3297133522407861021" onmouseenter="enter('-3297133522407861021');" onmouseout="out('-3297133522407861021');" style=""> 714 //        for (int i = 0; i &lt; min; i++) {                                                                </span>
<span class="-5419954369064878282" onmouseenter="enter('-5419954369064878282');" onmouseout="out('-5419954369064878282');" style=""> 715 //            samples2.add(samples.get(i));                                                              </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 716 //        }                                                                                              </span>
<span class="-217733928506784495" onmouseenter="enter('-217733928506784495');" onmouseout="out('-217733928506784495');" style=""> 717 //        return samples2;                                                                               </span>
<span class="8329125895357939517" onmouseenter="enter('8329125895357939517');" onmouseout="out('8329125895357939517');" style=""> 718         return samples;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 719     }                                                                                                    </span>
<span  style=""> 720                                                                                                          </span>
<span class="-1106201085093865693" onmouseenter="enter('-1106201085093865693');" onmouseout="out('-1106201085093865693');" style=""> 721     protected void ensureStartAndEndSamples(List&lt;ActivitySample&gt; samples, int tsStart, int tsEnd) {      </span>
<span class="-7875576828687087964" onmouseenter="enter('-7875576828687087964');" onmouseout="out('-7875576828687087964');" style=""> 722         if (samples == null || samples.isEmpty()) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 723             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 724         }                                                                                                </span>
<span class="6215771732045184164" onmouseenter="enter('6215771732045184164');" onmouseout="out('6215771732045184164');" style=""> 725         ActivitySample lastSample = samples.get(samples.size() - 1);                                     </span>
<span class="-5724051378546831092" onmouseenter="enter('-5724051378546831092');" onmouseout="out('-5724051378546831092');" style=""> 726         if (lastSample.getTimestamp() &lt; tsEnd) {                                                         </span>
<span class="-340307626157070265" onmouseenter="enter('-340307626157070265');" onmouseout="out('-340307626157070265');" style=""> 727             samples.add(createTrailingActivitySample(lastSample, tsEnd));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 728         }                                                                                                </span>
<span  style=""> 729                                                                                                          </span>
<span class="-7926496395118744001" onmouseenter="enter('-7926496395118744001');" onmouseout="out('-7926496395118744001');" style=""> 730         ActivitySample firstSample = samples.get(0);                                                     </span>
<span class="-7009339048909230945" onmouseenter="enter('-7009339048909230945');" onmouseout="out('-7009339048909230945');" style=""> 731         if (firstSample.getTimestamp() &gt; tsStart) {                                                      </span>
<span class="-5264575031409257517" onmouseenter="enter('-5264575031409257517');" onmouseout="out('-5264575031409257517');" style=""> 732             samples.add(createTrailingActivitySample(firstSample, tsStart));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 733         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 734     }                                                                                                    </span>
<span  style=""> 735                                                                                                          </span>
<span class="3833670724694452809" onmouseenter="enter('3833670724694452809');" onmouseout="out('3833670724694452809');" style=""> 736     private ActivitySample createTrailingActivitySample(ActivitySample referenceSample, int timestamp) { </span>
<span class="-2046593497045539776" onmouseenter="enter('-2046593497045539776');" onmouseout="out('-2046593497045539776');" style=""> 737         TrailingActivitySample sample = new TrailingActivitySample();                                    </span>
<span class="1247170989116197247" onmouseenter="enter('1247170989116197247');" onmouseout="out('1247170989116197247');" style=""> 738         if (referenceSample instanceof AbstractActivitySample) {                                         </span>
<span class="753416811428354981" onmouseenter="enter('753416811428354981');" onmouseout="out('753416811428354981');" style=""> 739             AbstractActivitySample reference = (AbstractActivitySample) referenceSample;                 </span>
<span class="179894899616756222" onmouseenter="enter('179894899616756222');" onmouseout="out('179894899616756222');" style=""> 740             sample.setUserId(reference.getUserId());                                                     </span>
<span class="-9074495792241680711" onmouseenter="enter('-9074495792241680711');" onmouseout="out('-9074495792241680711');" style=""> 741             sample.setDeviceId(reference.getDeviceId());                                                 </span>
<span class="-9156726696647878603" onmouseenter="enter('-9156726696647878603');" onmouseout="out('-9156726696647878603');" style=""> 742             sample.setProvider(reference.getProvider());                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743         }                                                                                                </span>
<span class="8993551488058005050" onmouseenter="enter('8993551488058005050');" onmouseout="out('8993551488058005050');" style=""> 744         sample.setTimestamp(timestamp);                                                                  </span>
<span class="1760114423996777276" onmouseenter="enter('1760114423996777276');" onmouseout="out('1760114423996777276');" style=""> 745         return sample;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 746     }                                                                                                    </span>
<span  style=""> 747                                                                                                          </span>
<span class="-1444262751819808388" onmouseenter="enter('-1444262751819808388');" onmouseout="out('-1444262751819808388');" style=""> 748     private int getTSEnd() {                                                                             </span>
<span class="8265537562094819633" onmouseenter="enter('8265537562094819633');" onmouseout="out('8265537562094819633');" style=""> 749         return toTimestamp(getEndDate());                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 750     }                                                                                                    </span>
<span  style=""> 751                                                                                                          </span>
<span class="-8800656553144883662" onmouseenter="enter('-8800656553144883662');" onmouseout="out('-8800656553144883662');" style=""> 752     private int getTSStart() {                                                                           </span>
<span class="-6038622859463971662" onmouseenter="enter('-6038622859463971662');" onmouseout="out('-6038622859463971662');" style=""> 753         return toTimestamp(getStartDate());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 754     }                                                                                                    </span>
<span  style=""> 755                                                                                                          </span>
<span class="-4614437324300305507" onmouseenter="enter('-4614437324300305507');" onmouseout="out('-4614437324300305507');" style=""> 756     private int toTimestamp(Date date) {                                                                 </span>
<span class="3504665279848614366" onmouseenter="enter('3504665279848614366');" onmouseout="out('3504665279848614366');" style=""> 757         return (int) ((date.getTime() / 1000));                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 758     }                                                                                                    </span>
<span  style=""> 759                                                                                                          </span>
<span class="-4297875969128159092" onmouseenter="enter('-4297875969128159092');" onmouseout="out('-4297875969128159092');" style=""> 760     public static class DefaultChartsData&lt;T extends ChartData&lt;?&gt;&gt; extends ChartsData {                   </span>
<span class="6426673791816913577" onmouseenter="enter('6426673791816913577');" onmouseout="out('6426673791816913577');" style=""> 761         private final T data;                                                                            </span>
<span class="-7952082456269420489" onmouseenter="enter('-7952082456269420489');" onmouseout="out('-7952082456269420489');" style=""> 762         private IAxisValueFormatter xValueFormatter;                                                     </span>
<span  style=""> 763                                                                                                          </span>
<span class="6541589990597847820" onmouseenter="enter('6541589990597847820');" onmouseout="out('6541589990597847820');" style=""> 764         public DefaultChartsData(T data, IAxisValueFormatter xValueFormatter) {                          </span>
<span class="5524270510531897998" onmouseenter="enter('5524270510531897998');" onmouseout="out('5524270510531897998');" style=""> 765             this.xValueFormatter = xValueFormatter;                                                      </span>
<span class="6755336779332792903" onmouseenter="enter('6755336779332792903');" onmouseout="out('6755336779332792903');" style=""> 766             this.data = data;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 767         }                                                                                                </span>
<span  style=""> 768                                                                                                          </span>
<span class="-2012372510684410029" onmouseenter="enter('-2012372510684410029');" onmouseout="out('-2012372510684410029');" style=""> 769         public IAxisValueFormatter getXValueFormatter() {                                                </span>
<span class="-7533476322813168520" onmouseenter="enter('-7533476322813168520');" onmouseout="out('-7533476322813168520');" style=""> 770             return xValueFormatter;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 771         }                                                                                                </span>
<span  style=""> 772                                                                                                          </span>
<span class="5384784438887663423" onmouseenter="enter('5384784438887663423');" onmouseout="out('5384784438887663423');" style=""> 773         public T getData() {                                                                             </span>
<span class="2885311051796901480" onmouseenter="enter('2885311051796901480');" onmouseout="out('2885311051796901480');" style=""> 774             return data;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 775         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 776     }                                                                                                    </span>
<span  style=""> 777                                                                                                          </span>
<span class="1326180124040264963" onmouseenter="enter('1326180124040264963');" onmouseout="out('1326180124040264963');" style=""> 778     protected static class SampleXLabelFormatter implements IAxisValueFormatter {                        </span>
<span class="5353010427567723059" onmouseenter="enter('5353010427567723059');" onmouseout="out('5353010427567723059');" style=""> 779         private final TimestampTranslation tsTranslation;                                                </span>
<span class="-3636759102507942125" onmouseenter="enter('-3636759102507942125');" onmouseout="out('-3636759102507942125');" style=""> 780         SimpleDateFormat annotationDateFormat = new SimpleDateFormat(&quot;HH:mm&quot;);                           </span>
<span class="1540142582082446680" onmouseenter="enter('1540142582082446680');" onmouseout="out('1540142582082446680');" style=""> 781 //        SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd.MM.yyyy HH:mm&quot;);                        </span>
<span class="4878211627103907492" onmouseenter="enter('4878211627103907492');" onmouseout="out('4878211627103907492');" style=""> 782         Calendar cal = GregorianCalendar.getInstance();                                                  </span>
<span  style=""> 783                                                                                                          </span>
<span class="5120004681237147878" onmouseenter="enter('5120004681237147878');" onmouseout="out('5120004681237147878');" style=""> 784         public SampleXLabelFormatter(TimestampTranslation tsTranslation) {                               </span>
<span class="332289991409172359" onmouseenter="enter('332289991409172359');" onmouseout="out('332289991409172359');" style=""> 785             this.tsTranslation = tsTranslation;                                                          </span>
<span  style=""> 786                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 787         }                                                                                                </span>
<span class="9166492997131092423" onmouseenter="enter('9166492997131092423');" onmouseout="out('9166492997131092423');" style=""> 788         // TODO: this does not work. Cannot use precomputed labels                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 789         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 790         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="7424853438265862645" onmouseenter="enter('7424853438265862645');" onmouseout="out('7424853438265862645');" style=""> 791             cal.clear();                                                                                 </span>
<span class="-8022679979208902148" onmouseenter="enter('-8022679979208902148');" onmouseout="out('-8022679979208902148');" style=""> 792             int ts = (int) value;                                                                        </span>
<span class="-2120013244284691976" onmouseenter="enter('-2120013244284691976');" onmouseout="out('-2120013244284691976');" style=""> 793             cal.setTimeInMillis(tsTranslation.toOriginalValue(ts) * 1000L);                              </span>
<span class="-5878359517855184171" onmouseenter="enter('-5878359517855184171');" onmouseout="out('-5878359517855184171');" style=""> 794             Date date = cal.getTime();                                                                   </span>
<span class="-2286280998074804817" onmouseenter="enter('-2286280998074804817');" onmouseout="out('-2286280998074804817');" style=""> 795             String dateString = annotationDateFormat.format(date);                                       </span>
<span class="-4331225868129427907" onmouseenter="enter('-4331225868129427907');" onmouseout="out('-4331225868129427907');" style=""> 796             return dateString;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 798     }                                                                                                    </span>
<span  style=""> 799                                                                                                          </span>
<span class="853591074258071334" onmouseenter="enter('853591074258071334');" onmouseout="out('853591074258071334');" style=""> 800     protected static class PreformattedXIndexLabelFormatter implements IAxisValueFormatter {             </span>
<span class="-5932642099782009782" onmouseenter="enter('-5932642099782009782');" onmouseout="out('-5932642099782009782');" style=""> 801         private ArrayList&lt;String&gt; xLabels;                                                               </span>
<span  style=""> 802                                                                                                          </span>
<span class="-3496008191511610310" onmouseenter="enter('-3496008191511610310');" onmouseout="out('-3496008191511610310');" style=""> 803         public PreformattedXIndexLabelFormatter(ArrayList&lt;String&gt; xLabels) {                             </span>
<span class="1925102162908705801" onmouseenter="enter('1925102162908705801');" onmouseout="out('1925102162908705801');" style=""> 804             this.xLabels = xLabels;                                                                      </span>
<span  style=""> 805                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806         }                                                                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 807         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 808         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="-6653294473874823013" onmouseenter="enter('-6653294473874823013');" onmouseout="out('-6653294473874823013');" style=""> 809             int index = (int) value;                                                                     </span>
<span class="-6571719897851150925" onmouseenter="enter('-6571719897851150925');" onmouseout="out('-6571719897851150925');" style=""> 810             if (xLabels == null || index &gt;= xLabels.size()) {                                            </span>
<span class="-889824612483989703" onmouseenter="enter('-889824612483989703');" onmouseout="out('-889824612483989703');" style=""> 811                 return String.valueOf(value);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812             }                                                                                            </span>
<span class="-5802960474501370558" onmouseenter="enter('-5802960474501370558');" onmouseout="out('-5802960474501370558');" style=""> 813             return xLabels.get(index);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 814         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 815     }                                                                                                    </span>
<span  style=""> 816                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 817     /**                                                                                                  </span>
<span class="6592799195109599568" onmouseenter="enter('6592799195109599568');" onmouseout="out('6592799195109599568');" style=""> 818      * Awkward class that helps in translating long timestamp                                            </span>
<span class="-2647406073998843607" onmouseenter="enter('-2647406073998843607');" onmouseout="out('-2647406073998843607');" style=""> 819      * values to float (sic!) values. It basically rebases all                                           </span>
<span class="-6950802996886985644" onmouseenter="enter('-6950802996886985644');" onmouseout="out('-6950802996886985644');" style=""> 820      * timestamps to a base (the very first) timestamp value.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 821      *                                                                                                   </span>
<span class="467771366063509856" onmouseenter="enter('467771366063509856');" onmouseout="out('467771366063509856');" style=""> 822      * It does this so that the large timestamp values can be used                                       </span>
<span class="-3960902832668220629" onmouseenter="enter('-3960902832668220629');" onmouseout="out('-3960902832668220629');" style=""> 823      * floating point values, where the mantissa is just 24 bits.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 824      */                                                                                                  </span>
<span class="3353052654588926596" onmouseenter="enter('3353052654588926596');" onmouseout="out('3353052654588926596');" style=""> 825     protected static class TimestampTranslation {                                                        </span>
<span class="-8324695427159884252" onmouseenter="enter('-8324695427159884252');" onmouseout="out('-8324695427159884252');" style=""> 826         private int tsOffset = -1;                                                                       </span>
<span  style=""> 827                                                                                                          </span>
<span class="-2038703014401681062" onmouseenter="enter('-2038703014401681062');" onmouseout="out('-2038703014401681062');" style=""> 828         public int shorten(int timestamp) {                                                              </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 829             if (tsOffset == -1) {                                                                        </span>
<span class="5713941682084663603" onmouseenter="enter('5713941682084663603');" onmouseout="out('5713941682084663603');" style=""> 830                 tsOffset = timestamp;                                                                    </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 831                 return 0;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832             }                                                                                            </span>
<span class="-455923503597890370" onmouseenter="enter('-455923503597890370');" onmouseout="out('-455923503597890370');" style=""> 833             return timestamp - tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834         }                                                                                                </span>
<span  style=""> 835                                                                                                          </span>
<span class="-7013677261634300092" onmouseenter="enter('-7013677261634300092');" onmouseout="out('-7013677261634300092');" style=""> 836         public int toOriginalValue(int timestamp) {                                                      </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 837             if (tsOffset == -1) {                                                                        </span>
<span class="-3020799636637211745" onmouseenter="enter('-3020799636637211745');" onmouseout="out('-3020799636637211745');" style=""> 838                 return timestamp;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839             }                                                                                            </span>
<span class="-7912123621537489577" onmouseenter="enter('-7912123621537489577');" onmouseout="out('-7912123621537489577');" style=""> 840             return timestamp + tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 841         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 842     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 843 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-5200878630337924680" onmouseenter="enter('-5200878630337924680');" onmouseout="out('-5200878630337924680');" style="">   1 /*  Copyright (C) 2015-2018 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                   </span>
<span class="2448951400902124304" onmouseenter="enter('2448951400902124304');" onmouseout="out('2448951400902124304');" style="">   2     Daniele Gobbetti, walkjivefly                                                                        </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="8669690300131154388" onmouseenter="enter('8669690300131154388');" onmouseout="out('8669690300131154388');" style="">  18 package nodomain.freeyourgadget.gadgetbridge.activities.charts;                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-489389385851058391" onmouseenter="enter('-489389385851058391');" onmouseout="out('-489389385851058391');" style="">  20 import android.content.BroadcastReceiver;                                                                </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  21 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  22 import android.content.Intent;                                                                           </span>
<span class="8697221465021235869" onmouseenter="enter('8697221465021235869');" onmouseout="out('8697221465021235869');" style="">  23 import android.content.IntentFilter;                                                                     </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  24 import android.os.AsyncTask;                                                                             </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  25 import android.os.Bundle;                                                                                </span>
<span class="4394652512097310678" onmouseenter="enter('4394652512097310678');" onmouseout="out('4394652512097310678');" style="">  26 import android.support.annotation.Nullable;                                                              </span>
<span class="5561867782528330628" onmouseenter="enter('5561867782528330628');" onmouseout="out('5561867782528330628');" style="">  27 import android.support.v4.app.FragmentActivity;                                                          </span>
<span class="-3586823955743508894" onmouseenter="enter('-3586823955743508894');" onmouseout="out('-3586823955743508894');" style="">  28 import android.support.v4.content.ContextCompat;                                                         </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  29 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  30 import android.util.TypedValue;                                                                          </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  31 import android.view.View;                                                                                </span>
<span class="2052752975691556393" onmouseenter="enter('2052752975691556393');" onmouseout="out('2052752975691556393');" style="">  32 import com.github.mikephil.charting.charts.BarChart;                                                     </span>
<span class="-7530008699315861247" onmouseenter="enter('-7530008699315861247');" onmouseout="out('-7530008699315861247');" style="">  33 import com.github.mikephil.charting.charts.BarLineChartBase;                                             </span>
<span class="-2340851656771232402" onmouseenter="enter('-2340851656771232402');" onmouseout="out('-2340851656771232402');" style="">  34 import com.github.mikephil.charting.charts.Chart;                                                        </span>
<span class="1306294111757562979" onmouseenter="enter('1306294111757562979');" onmouseout="out('1306294111757562979');" style="">  35 import com.github.mikephil.charting.components.AxisBase;                                                 </span>
<span class="-968159151538268968" onmouseenter="enter('-968159151538268968');" onmouseout="out('-968159151538268968');" style="">  36 import com.github.mikephil.charting.components.YAxis;                                                    </span>
<span class="4145381455536678498" onmouseenter="enter('4145381455536678498');" onmouseout="out('4145381455536678498');" style="">  37 import com.github.mikephil.charting.data.ChartData;                                                      </span>
<span class="-6979157771929244358" onmouseenter="enter('-6979157771929244358');" onmouseout="out('-6979157771929244358');" style="">  38 import com.github.mikephil.charting.data.Entry;                                                          </span>
<span class="-1647496247863422182" onmouseenter="enter('-1647496247863422182');" onmouseout="out('-1647496247863422182');" style="">  39 import com.github.mikephil.charting.data.LineData;                                                       </span>
<span class="-2418175485781437143" onmouseenter="enter('-2418175485781437143');" onmouseout="out('-2418175485781437143');" style="">  40 import com.github.mikephil.charting.data.LineDataSet;                                                    </span>
<span class="5272555707203763230" onmouseenter="enter('5272555707203763230');" onmouseout="out('5272555707203763230');" style="">  41 import com.github.mikephil.charting.formatter.IAxisValueFormatter;                                       </span>
<span class="2256452517983808356" onmouseenter="enter('2256452517983808356');" onmouseout="out('2256452517983808356');" style="">  42 import com.github.mikephil.charting.interfaces.datasets.ILineDataSet;                                    </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  43 import java.text.SimpleDateFormat;                                                                       </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  44 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  45 import java.util.Arrays;                                                                                 </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  46 import java.util.Calendar;                                                                               </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  47 import java.util.Date;                                                                                   </span>
<span class="-4685965902094386510" onmouseenter="enter('-4685965902094386510');" onmouseout="out('-4685965902094386510');" style="">  48 import java.util.GregorianCalendar;                                                                      </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  49 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  50 import java.util.List;                                                                                   </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  51 import java.util.Set;                                                                                    </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                               </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.R;                                                           </span>
<span class="5401974517372835423" onmouseenter="enter('5401974517372835423');" onmouseout="out('5401974517372835423');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.activities.AbstractGBFragment;                               </span>
<span class="-7512545990884107322" onmouseenter="enter('-7512545990884107322');" onmouseout="out('-7512545990884107322');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;                                   </span>
<span class="-7899456532042317044" onmouseenter="enter('-7899456532042317044');" onmouseout="out('-7899456532042317044');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.database.DBAccess;                                           </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="6852267181356803593" onmouseenter="enter('6852267181356803593');" onmouseout="out('6852267181356803593');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;                                   </span>
<span class="-4858662006453759829" onmouseenter="enter('-4858662006453759829');" onmouseout="out('-4858662006453759829');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.devices.SampleProvider;                                      </span>
<span class="6164643418103516215" onmouseenter="enter('6164643418103516215');" onmouseout="out('6164643418103516215');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.entities.AbstractActivitySample;                             </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="5185434099904652174" onmouseenter="enter('5185434099904652174');" onmouseout="out('5185434099904652174');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind;                                          </span>
<span class="-4763610359710127205" onmouseenter="enter('-4763610359710127205');" onmouseout="out('-4763610359710127205');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.model.ActivitySample;                                        </span>
<span class="-904534361809820117" onmouseenter="enter('-904534361809820117');" onmouseout="out('-904534361809820117');" style="">  64 import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils;                                          </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  66 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  67 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  68                                                                                                          </span>
<span  style="">  69                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70 /**                                                                                                      </span>
<span class="4382979016472627606" onmouseenter="enter('4382979016472627606');" onmouseout="out('4382979016472627606');" style="">  71  * A base class fragment to be used with ChartsActivity. The fragment can supply                         </span>
<span class="6198461617436424812" onmouseenter="enter('6198461617436424812');" onmouseout="out('6198461617436424812');" style="">  72  * a title to be displayed in the activity by returning non-null in #getTitle()                          </span>
<span class="-6728528830408447290" onmouseenter="enter('-6728528830408447290');" onmouseout="out('-6728528830408447290');" style="">  73  * Broadcast events can be received by overriding #onReceive(Context,Intent).                            </span>
<span class="-8995811574793439040" onmouseenter="enter('-8995811574793439040');" onmouseout="out('-8995811574793439040');" style="">  74  * The chart can be refreshed by calling #refresh()                                                      </span>
<span class="7522934711128650596" onmouseenter="enter('7522934711128650596');" onmouseout="out('7522934711128650596');" style="">  75  * Implement refreshInBackground(DBHandler, GBDevice) to fetch the samples from the DB,                  </span>
<span class="-6728676085228773380" onmouseenter="enter('-6728676085228773380');" onmouseout="out('-6728676085228773380');" style="">  76  * and add the samples to the chart. The actual rendering, which must be performed in the UI             </span>
<span class="-8407485021089725057" onmouseenter="enter('-8407485021089725057');" onmouseout="out('-8407485021089725057');" style="">  77  * thread, must be done in #renderCharts().                                                              </span>
<span class="-4722043031183050825" onmouseenter="enter('-4722043031183050825');" onmouseout="out('-4722043031183050825');" style="">  78  * Access functionality of the hosting activity with #getHost()                                          </span>
<span class="4294780129258405519" onmouseenter="enter('4294780129258405519');" onmouseout="out('4294780129258405519');" style="">  79  * &lt;p/&gt;                                                                                                  </span>
<span class="4386326732920470462" onmouseenter="enter('4386326732920470462');" onmouseout="out('4386326732920470462');" style="">  80  * The hosting ChartsHost activity provides a section for displaying a date or date range                </span>
<span class="6958843947366179987" onmouseenter="enter('6958843947366179987');" onmouseout="out('6958843947366179987');" style="">  81  * being the basis for the chart, as well as two buttons for moving backwards and forward                </span>
<span class="2417558347604794742" onmouseenter="enter('2417558347604794742');" onmouseout="out('2417558347604794742');" style="">  82  * in time. The date is held by the activity, so that it can be shared by multiple chart                 </span>
<span class="7607748487874207999" onmouseenter="enter('7607748487874207999');" onmouseout="out('7607748487874207999');" style="">  83  * fragments. It is still the responsibility of the (currently visible) chart fragment                   </span>
<span class="-3870094542515027002" onmouseenter="enter('-3870094542515027002');" onmouseout="out('-3870094542515027002');" style="">  84  * to set the desired date in the ChartsActivity via #setDateRange(Date,Date).                           </span>
<span class="3680713202748276357" onmouseenter="enter('3680713202748276357');" onmouseout="out('3680713202748276357');" style="">  85  * The default implementations #handleDatePrev(Date,Date) and #handleDateNext(Date,Date)                 </span>
<span class="-222466413472697410" onmouseenter="enter('-222466413472697410');" onmouseout="out('-222466413472697410');" style="">  86  * shift the date by one day.                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87  */                                                                                                      </span>
<span class="559507359319980575" onmouseenter="enter('559507359319980575');" onmouseout="out('559507359319980575');" style="">  88 public abstract class AbstractChartFragment extends AbstractGBFragment {                                 </span>
<span class="-5476773025248141464" onmouseenter="enter('-5476773025248141464');" onmouseout="out('-5476773025248141464');" style="">  89     protected final int ANIM_TIME = 250;                                                                 </span>
<span  style="">  90                                                                                                          </span>
<span class="2603683647820710396" onmouseenter="enter('2603683647820710396');" onmouseout="out('2603683647820710396');" style="">  91     private static final Logger LOG = LoggerFactory.getLogger(AbstractChartFragment.class);              </span>
<span  style="">  92                                                                                                          </span>
<span class="-7304707645666720924" onmouseenter="enter('-7304707645666720924');" onmouseout="out('-7304707645666720924');" style="">  93     private final Set&lt;String&gt; mIntentFilterActions;                                                      </span>
<span  style="">  94                                                                                                          </span>
<span class="4625474178666977899" onmouseenter="enter('4625474178666977899');" onmouseout="out('4625474178666977899');" style="">  95     private final BroadcastReceiver mReceiver = new BroadcastReceiver() {                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  96         @Override                                                                                        </span>
<span class="-1520739091809898546" onmouseenter="enter('-1520739091809898546');" onmouseout="out('-1520739091809898546');" style="">  97         public void onReceive(Context context, Intent intent) {                                          </span>
<span class="1765483774466236680" onmouseenter="enter('1765483774466236680');" onmouseout="out('1765483774466236680');" style="">  98             AbstractChartFragment.this.onReceive(context, intent);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 100     };                                                                                                   </span>
<span  style=""> 101                                                                                                          </span>
<span class="-5489121822050726001" onmouseenter="enter('-5489121822050726001');" onmouseout="out('-5489121822050726001');" style=""> 102     private boolean mChartDirty = true;                                                                  </span>
<span  style=""> 103                                                                                                          </span>
<span class="-5677382414532787847" onmouseenter="enter('-5677382414532787847');" onmouseout="out('-5677382414532787847');" style=""> 104     private AsyncTask refreshTask;                                                                       </span>
<span  style=""> 105                                                                                                          </span>
<span class="-4343134957952038703" onmouseenter="enter('-4343134957952038703');" onmouseout="out('-4343134957952038703');" style=""> 106     public boolean isChartDirty() {                                                                      </span>
<span class="-2572162510293790028" onmouseenter="enter('-2572162510293790028');" onmouseout="out('-2572162510293790028');" style=""> 107         return mChartDirty;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108     }                                                                                                    </span>
<span  style=""> 109                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110     @Override                                                                                            </span>
<span class="-601773936482381085" onmouseenter="enter('-601773936482381085');" onmouseout="out('-601773936482381085');" style=""> 111     public abstract String getTitle();                                                                   </span>
<span  style=""> 112                                                                                                          </span>
<span class="-6644558066866151773" onmouseenter="enter('-6644558066866151773');" onmouseout="out('-6644558066866151773');" style=""> 113     public boolean supportsHeartrate(GBDevice device) {                                                  </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 114         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="-7840206560907481536" onmouseenter="enter('-7840206560907481536');" onmouseout="out('-7840206560907481536');" style=""> 115         return coordinator != null &amp;&amp; coordinator.supportsHeartRateMeasurement(device);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="-8993184091203127788" onmouseenter="enter('-8993184091203127788');" onmouseout="out('-8993184091203127788');" style=""> 118     protected static final class ActivityConfig {                                                        </span>
<span class="-6704927139853267025" onmouseenter="enter('-6704927139853267025');" onmouseout="out('-6704927139853267025');" style=""> 119         public final int type;                                                                           </span>
<span  style=""> 120                                                                                                          </span>
<span class="8777140454183587055" onmouseenter="enter('8777140454183587055');" onmouseout="out('8777140454183587055');" style=""> 121         public final String label;                                                                       </span>
<span  style=""> 122                                                                                                          </span>
<span class="-5618013352645865591" onmouseenter="enter('-5618013352645865591');" onmouseout="out('-5618013352645865591');" style=""> 123         public final Integer color;                                                                      </span>
<span  style=""> 124                                                                                                          </span>
<span class="-5628392649151863187" onmouseenter="enter('-5628392649151863187');" onmouseout="out('-5628392649151863187');" style=""> 125         public ActivityConfig(int kind, String label, Integer color) {                                   </span>
<span class="-7354691670901086033" onmouseenter="enter('-7354691670901086033');" onmouseout="out('-7354691670901086033');" style=""> 126             this.type = kind;                                                                            </span>
<span class="-6752321514731327997" onmouseenter="enter('-6752321514731327997');" onmouseout="out('-6752321514731327997');" style=""> 127             this.label = label;                                                                          </span>
<span class="-589508620284177092" onmouseenter="enter('-589508620284177092');" onmouseout="out('-589508620284177092');" style=""> 128             this.color = color;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="-727072152722713884" onmouseenter="enter('-727072152722713884');" onmouseout="out('-727072152722713884');" style=""> 132     protected ActivityConfig akActivity;                                                                 </span>
<span  style=""> 133                                                                                                          </span>
<span class="1693165293269506698" onmouseenter="enter('1693165293269506698');" onmouseout="out('1693165293269506698');" style=""> 134     protected ActivityConfig akLightSleep;                                                               </span>
<span  style=""> 135                                                                                                          </span>
<span class="1060880569004609468" onmouseenter="enter('1060880569004609468');" onmouseout="out('1060880569004609468');" style=""> 136     protected ActivityConfig akDeepSleep;                                                                </span>
<span  style=""> 137                                                                                                          </span>
<span class="-4297327045522896814" onmouseenter="enter('-4297327045522896814');" onmouseout="out('-4297327045522896814');" style=""> 138     protected ActivityConfig akNotWorn;                                                                  </span>
<span  style=""> 139                                                                                                          </span>
<span class="-1563135362317192224" onmouseenter="enter('-1563135362317192224');" onmouseout="out('-1563135362317192224');" style=""> 140     protected int BACKGROUND_COLOR;                                                                      </span>
<span  style=""> 141                                                                                                          </span>
<span class="4601305514601887958" onmouseenter="enter('4601305514601887958');" onmouseout="out('4601305514601887958');" style=""> 142     protected int DESCRIPTION_COLOR;                                                                     </span>
<span  style=""> 143                                                                                                          </span>
<span class="-3468694148212670828" onmouseenter="enter('-3468694148212670828');" onmouseout="out('-3468694148212670828');" style=""> 144     protected int CHART_TEXT_COLOR;                                                                      </span>
<span  style=""> 145                                                                                                          </span>
<span class="655929690321793162" onmouseenter="enter('655929690321793162');" onmouseout="out('655929690321793162');" style=""> 146     protected int LEGEND_TEXT_COLOR;                                                                     </span>
<span  style=""> 147                                                                                                          </span>
<span class="-6693974409973768071" onmouseenter="enter('-6693974409973768071');" onmouseout="out('-6693974409973768071');" style=""> 148     protected int HEARTRATE_COLOR;                                                                       </span>
<span  style=""> 149                                                                                                          </span>
<span class="7021362809515932268" onmouseenter="enter('7021362809515932268');" onmouseout="out('7021362809515932268');" style=""> 150     protected int HEARTRATE_FILL_COLOR;                                                                  </span>
<span  style=""> 151                                                                                                          </span>
<span class="-4670234814499331326" onmouseenter="enter('-4670234814499331326');" onmouseout="out('-4670234814499331326');" style=""> 152     protected int AK_ACTIVITY_COLOR;                                                                     </span>
<span  style=""> 153                                                                                                          </span>
<span class="-5660897269888657930" onmouseenter="enter('-5660897269888657930');" onmouseout="out('-5660897269888657930');" style=""> 154     protected int AK_DEEP_SLEEP_COLOR;                                                                   </span>
<span  style=""> 155                                                                                                          </span>
<span class="-91394691221270038" onmouseenter="enter('-91394691221270038');" onmouseout="out('-91394691221270038');" style=""> 156     protected int AK_LIGHT_SLEEP_COLOR;                                                                  </span>
<span  style=""> 157                                                                                                          </span>
<span class="1634608154221638802" onmouseenter="enter('1634608154221638802');" onmouseout="out('1634608154221638802');" style=""> 158     protected int AK_NOT_WORN_COLOR;                                                                     </span>
<span  style=""> 159                                                                                                          </span>
<span class="-1398408580326282750" onmouseenter="enter('-1398408580326282750');" onmouseout="out('-1398408580326282750');" style=""> 160     protected String HEARTRATE_LABEL;                                                                    </span>
<span  style=""> 161                                                                                                          </span>
<span class="-2100943369183848946" onmouseenter="enter('-2100943369183848946');" onmouseout="out('-2100943369183848946');" style=""> 162     protected AbstractChartFragment(String... intentFilterActions) {                                     </span>
<span class="4300273923814153332" onmouseenter="enter('4300273923814153332');" onmouseout="out('4300273923814153332');" style=""> 163         mIntentFilterActions = new HashSet&lt;&gt;();                                                          </span>
<span class="1794017280726845715" onmouseenter="enter('1794017280726845715');" onmouseout="out('1794017280726845715');" style=""> 164         if (intentFilterActions != null) {                                                               </span>
<span class="-5245442559338563943" onmouseenter="enter('-5245442559338563943');" onmouseout="out('-5245442559338563943');" style=""> 165             mIntentFilterActions.addAll(Arrays.asList(intentFilterActions));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166         }                                                                                                </span>
<span class="-8699894582101860078" onmouseenter="enter('-8699894582101860078');" onmouseout="out('-8699894582101860078');" style=""> 167         mIntentFilterActions.add(ChartsHost.DATE_NEXT);                                                  </span>
<span class="6561361583014083383" onmouseenter="enter('6561361583014083383');" onmouseout="out('6561361583014083383');" style=""> 168         mIntentFilterActions.add(ChartsHost.DATE_PREV);                                                  </span>
<span class="775005401617860596" onmouseenter="enter('775005401617860596');" onmouseout="out('775005401617860596');" style=""> 169         mIntentFilterActions.add(ChartsHost.REFRESH);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170     }                                                                                                    </span>
<span  style=""> 171                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 172     @Override                                                                                            </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 173     public void onCreate(Bundle savedInstanceState) {                                                    </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 174         super.onCreate(savedInstanceState);                                                              </span>
<span  style=""> 175                                                                                                          </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 176         init();                                                                                          </span>
<span  style=""> 177                                                                                                          </span>
<span class="1309295186849327913" onmouseenter="enter('1309295186849327913');" onmouseout="out('1309295186849327913');" style=""> 178         IntentFilter filter = new IntentFilter();                                                        </span>
<span class="6467646639596248655" onmouseenter="enter('6467646639596248655');" onmouseout="out('6467646639596248655');" style=""> 179         for (String action : mIntentFilterActions) {                                                     </span>
<span class="-2086107330814500487" onmouseenter="enter('-2086107330814500487');" onmouseout="out('-2086107330814500487');" style=""> 180             filter.addAction(action);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181         }                                                                                                </span>
<span class="3395895708962590803" onmouseenter="enter('3395895708962590803');" onmouseout="out('3395895708962590803');" style=""> 182         LocalBroadcastManager.getInstance(getActivity()).registerReceiver(mReceiver, filter);            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="-2182533896997661648" onmouseenter="enter('-2182533896997661648');" onmouseout="out('-2182533896997661648');" style=""> 185     protected void init() {                                                                              </span>
<span class="-4278963507477628649" onmouseenter="enter('-4278963507477628649');" onmouseout="out('-4278963507477628649');" style=""> 186         TypedValue runningColor = new TypedValue();                                                      </span>
<span class="2364262805070128994" onmouseenter="enter('2364262805070128994');" onmouseout="out('2364262805070128994');" style=""> 187         BACKGROUND_COLOR = GBApplication.getBackgroundColor(getContext());                               </span>
<span class="4636662852620032981" onmouseenter="enter('4636662852620032981');" onmouseout="out('4636662852620032981');" style=""> 188         LEGEND_TEXT_COLOR = DESCRIPTION_COLOR = GBApplication.getTextColor(getContext());                </span>
<span class="7979803013168270964" onmouseenter="enter('7979803013168270964');" onmouseout="out('7979803013168270964');" style=""> 189         CHART_TEXT_COLOR = ContextCompat.getColor(getContext(), R.color.secondarytext);                  </span>
<span class="-5448842132740870532" onmouseenter="enter('-5448842132740870532');" onmouseout="out('-5448842132740870532');" style=""> 190         HEARTRATE_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate);                 </span>
<span class="3818219289719008809" onmouseenter="enter('3818219289719008809');" onmouseout="out('3818219289719008809');" style=""> 191         HEARTRATE_FILL_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate_fill);       </span>
<span class="-658032213271338857" onmouseenter="enter('-658032213271338857');" onmouseout="out('-658032213271338857');" style=""> 192         getContext().getTheme().resolveAttribute(R.attr.chart_activity, runningColor, true);             </span>
<span class="3784973835189342522" onmouseenter="enter('3784973835189342522');" onmouseout="out('3784973835189342522');" style=""> 193         AK_ACTIVITY_COLOR = runningColor.data;                                                           </span>
<span class="-7347375883805936743" onmouseenter="enter('-7347375883805936743');" onmouseout="out('-7347375883805936743');" style=""> 194         getContext().getTheme().resolveAttribute(R.attr.chart_deep_sleep, runningColor, true);           </span>
<span class="9138233377044964354" onmouseenter="enter('9138233377044964354');" onmouseout="out('9138233377044964354');" style=""> 195         AK_DEEP_SLEEP_COLOR = runningColor.data;                                                         </span>
<span class="-7879866390823759405" onmouseenter="enter('-7879866390823759405');" onmouseout="out('-7879866390823759405');" style=""> 196         getContext().getTheme().resolveAttribute(R.attr.chart_light_sleep, runningColor, true);          </span>
<span class="-7375963623584937470" onmouseenter="enter('-7375963623584937470');" onmouseout="out('-7375963623584937470');" style=""> 197         AK_LIGHT_SLEEP_COLOR = runningColor.data;                                                        </span>
<span class="-4015774126818841529" onmouseenter="enter('-4015774126818841529');" onmouseout="out('-4015774126818841529');" style=""> 198         getContext().getTheme().resolveAttribute(R.attr.chart_not_worn, runningColor, true);             </span>
<span class="-5596972182818856924" onmouseenter="enter('-5596972182818856924');" onmouseout="out('-5596972182818856924');" style=""> 199         AK_NOT_WORN_COLOR = runningColor.data;                                                           </span>
<span  style=""> 200                                                                                                          </span>
<span class="-8151372900676559714" onmouseenter="enter('-8151372900676559714');" onmouseout="out('-8151372900676559714');" style=""> 201         HEARTRATE_LABEL = getContext().getString(R.string.charts_legend_heartrate);                      </span>
<span  style=""> 202                                                                                                          </span>
<span class="7336078921795716816" onmouseenter="enter('7336078921795716816');" onmouseout="out('7336078921795716816');" style=""><abbr title=" 203         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kind_activity), AK_ACTIVITY_COLOR);"> 203         akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fraðŸ”µ</abbr></span>
<span class="7421775491088103388" onmouseenter="enter('7421775491088103388');" onmouseout="out('7421775491088103388');" style=""><abbr title=" 204         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragment_kind_light_sleep), AK_LIGHT_SLEEP_COLOR);"> 204         akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_charðŸ”µ</abbr></span>
<span class="-7577615369032967062" onmouseenter="enter('-7577615369032967062');" onmouseout="out('-7577615369032967062');" style=""><abbr title=" 205         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_kind_deep_sleep), AK_DEEP_SLEEP_COLOR);"> 205         akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_ðŸ”µ</abbr></span>
<span class="4963911460392329978" onmouseenter="enter('4963911460392329978');" onmouseout="out('4963911460392329978');" style=""><abbr title=" 206         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kind_not_worn), AK_NOT_WORN_COLOR);"> 206         akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-495990486128602071" onmouseenter="enter('-495990486128602071');" onmouseout="out('-495990486128602071');" style=""> 209     private void setStartDate(Date date) {                                                               </span>
<span class="-1228970384434949212" onmouseenter="enter('-1228970384434949212');" onmouseout="out('-1228970384434949212');" style=""> 210         getChartsHost().setStartDate(date);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="2390100272250745956" onmouseenter="enter('2390100272250745956');" onmouseout="out('2390100272250745956');" style=""> 213     @Nullable                                                                                            </span>
<span class="3611118571382248517" onmouseenter="enter('3611118571382248517');" onmouseout="out('3611118571382248517');" style=""> 214     protected ChartsHost getChartsHost() {                                                               </span>
<span class="2661597057438137706" onmouseenter="enter('2661597057438137706');" onmouseout="out('2661597057438137706');" style=""> 215         return (ChartsHost) getActivity();                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216     }                                                                                                    </span>
<span  style=""> 217                                                                                                          </span>
<span class="-1308916602749590522" onmouseenter="enter('-1308916602749590522');" onmouseout="out('-1308916602749590522');" style=""> 218     private void setEndDate(Date date) {                                                                 </span>
<span class="-3659353165994754543" onmouseenter="enter('-3659353165994754543');" onmouseout="out('-3659353165994754543');" style=""> 219         getChartsHost().setEndDate(date);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220     }                                                                                                    </span>
<span  style=""> 221                                                                                                          </span>
<span class="-2894059945991900133" onmouseenter="enter('-2894059945991900133');" onmouseout="out('-2894059945991900133');" style=""> 222     public Date getStartDate() {                                                                         </span>
<span class="8926139361389921832" onmouseenter="enter('8926139361389921832');" onmouseout="out('8926139361389921832');" style=""> 223         return getChartsHost().getStartDate();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="2846153489913780034" onmouseenter="enter('2846153489913780034');" onmouseout="out('2846153489913780034');" style=""> 226     public Date getEndDate() {                                                                           </span>
<span class="7835534291730041186" onmouseenter="enter('7835534291730041186');" onmouseout="out('7835534291730041186');" style=""> 227         return getChartsHost().getEndDate();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228     }                                                                                                    </span>
<span  style=""> 229                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 230     /**                                                                                                  </span>
<span class="3608187799695399223" onmouseenter="enter('3608187799695399223');" onmouseout="out('3608187799695399223');" style=""> 231      * Called when this fragment has been fully scrolled into the activity.                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 232      *                                                                                                   </span>
<span class="-6064668654679903662" onmouseenter="enter('-6064668654679903662');" onmouseout="out('-6064668654679903662');" style=""> 233      * @see #isVisibleInActivity()                                                                       </span>
<span class="-4201783166293447700" onmouseenter="enter('-4201783166293447700');" onmouseout="out('-4201783166293447700');" style=""> 234      * @see #onMadeInvisibleInActivity()                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 235      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236     @Override                                                                                            </span>
<span class="-7073731466333062745" onmouseenter="enter('-7073731466333062745');" onmouseout="out('-7073731466333062745');" style=""> 237     protected void onMadeVisibleInActivity() {                                                           </span>
<span class="-2940429388425730341" onmouseenter="enter('-2940429388425730341');" onmouseout="out('-2940429388425730341');" style=""> 238         super.onMadeVisibleInActivity();                                                                 </span>
<span class="4333568825348773807" onmouseenter="enter('4333568825348773807');" onmouseout="out('4333568825348773807');" style=""> 239         showDateBar(true);                                                                               </span>
<span class="371374127972335382" onmouseenter="enter('371374127972335382');" onmouseout="out('371374127972335382');" style=""> 240         if (isChartDirty()) {                                                                            </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 241             refresh();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243     }                                                                                                    </span>
<span  style=""> 244                                                                                                          </span>
<span class="-2587903292449818582" onmouseenter="enter('-2587903292449818582');" onmouseout="out('-2587903292449818582');" style=""> 245     protected void showDateBar(boolean show) {                                                           </span>
<span class="1102668729830068636" onmouseenter="enter('1102668729830068636');" onmouseout="out('1102668729830068636');" style=""> 246         getChartsHost().getDateBar().setVisibility(show ? View.VISIBLE : View.INVISIBLE);                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247     }                                                                                                    </span>
<span  style=""> 248                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 249     @Override                                                                                            </span>
<span class="658855826062432633" onmouseenter="enter('658855826062432633');" onmouseout="out('658855826062432633');" style=""> 250     public void onDestroy() {                                                                            </span>
<span class="7275190530034972367" onmouseenter="enter('7275190530034972367');" onmouseout="out('7275190530034972367');" style=""> 251         super.onDestroy();                                                                               </span>
<span class="-1904828397138023848" onmouseenter="enter('-1904828397138023848');" onmouseout="out('-1904828397138023848');" style=""> 252         LocalBroadcastManager.getInstance(getActivity()).unregisterReceiver(mReceiver);                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253     }                                                                                                    </span>
<span  style=""> 254                                                                                                          </span>
<span class="-6518874138984288541" onmouseenter="enter('-6518874138984288541');" onmouseout="out('-6518874138984288541');" style=""> 255     protected void onReceive(Context context, Intent intent) {                                           </span>
<span class="5344227773413700857" onmouseenter="enter('5344227773413700857');" onmouseout="out('5344227773413700857');" style=""> 256         String action = intent.getAction();                                                              </span>
<span class="-494993687329631312" onmouseenter="enter('-494993687329631312');" onmouseout="out('-494993687329631312');" style=""> 257         if (ChartsHost.REFRESH.equals(action)) {                                                         </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 258             refresh();                                                                                   </span>
<span class="8208351658473141292" onmouseenter="enter('8208351658473141292');" onmouseout="out('8208351658473141292');" style=""> 259         } else if (ChartsHost.DATE_NEXT.equals(action)) {                                                </span>
<span class="3429530462558527400" onmouseenter="enter('3429530462558527400');" onmouseout="out('3429530462558527400');" style=""> 260             handleDateNext(getStartDate(), getEndDate());                                                </span>
<span class="6275594107476882748" onmouseenter="enter('6275594107476882748');" onmouseout="out('6275594107476882748');" style=""> 261         } else if (ChartsHost.DATE_PREV.equals(action)) {                                                </span>
<span class="-3035508152708713619" onmouseenter="enter('-3035508152708713619');" onmouseout="out('-3035508152708713619');" style=""> 262             handleDatePrev(getStartDate(), getEndDate());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264     }                                                                                                    </span>
<span  style=""> 265                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 266     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 267      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 268      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 269      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 270      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 271      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 272      */                                                                                                  </span>
<span class="-3047400271509647247" onmouseenter="enter('-3047400271509647247');" onmouseout="out('-3047400271509647247');" style=""> 273     protected void handleDatePrev(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 274         if (isVisibleInActivity()) {                                                                     </span>
<span class="-2651860554468779719" onmouseenter="enter('-2651860554468779719');" onmouseout="out('-2651860554468779719');" style=""> 275             if (!shiftDates(startDate, endDate, -1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 276                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 279         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280     }                                                                                                    </span>
<span  style=""> 281                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 282     /**                                                                                                  </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 283      * Default implementation shifts the dates by one day, if visible                                    </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 284      * and calls #refreshIfVisible().                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 285      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 286      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 287      * @param endDate                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 288      */                                                                                                  </span>
<span class="6615897495863858801" onmouseenter="enter('6615897495863858801');" onmouseout="out('6615897495863858801');" style=""> 289     protected void handleDateNext(Date startDate, Date endDate) {                                        </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 290         if (isVisibleInActivity()) {                                                                     </span>
<span class="-6485278970310858803" onmouseenter="enter('-6485278970310858803');" onmouseout="out('-6485278970310858803');" style=""> 291             if (!shiftDates(startDate, endDate, +1)) {                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 292                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294         }                                                                                                </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 295         refreshIfVisible();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296     }                                                                                                    </span>
<span  style=""> 297                                                                                                          </span>
<span class="5798655654202275728" onmouseenter="enter('5798655654202275728');" onmouseout="out('5798655654202275728');" style=""> 298     protected void refreshIfVisible() {                                                                  </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 299         if (isVisibleInActivity()) {                                                                     </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 300             refresh();                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 301         } else {                                                                                         </span>
<span class="427958345432566734" onmouseenter="enter('427958345432566734');" onmouseout="out('427958345432566734');" style=""> 302             mChartDirty = true;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304     }                                                                                                    </span>
<span  style=""> 305                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 306     /**                                                                                                  </span>
<span class="-6717682359676050907" onmouseenter="enter('-6717682359676050907');" onmouseout="out('-6717682359676050907');" style=""> 307      * Shifts the given dates by offset days. offset may be positive or negative.                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 308      *                                                                                                   </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 309      * @param startDate                                                                                  </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 310      * @param endDate                                                                                    </span>
<span class="-3834083067366288846" onmouseenter="enter('-3834083067366288846');" onmouseout="out('-3834083067366288846');" style=""> 311      * @param offset    a positive or negative number of days to shift the dates                         </span>
<span class="-6460740145491493882" onmouseenter="enter('-6460740145491493882');" onmouseout="out('-6460740145491493882');" style=""> 312      * @return true if the shift was successful and false otherwise                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 313      */                                                                                                  </span>
<span class="-1942902413678210438" onmouseenter="enter('-1942902413678210438');" onmouseout="out('-1942902413678210438');" style=""> 314     protected boolean shiftDates(Date startDate, Date endDate, int offset) {                             </span>
<span class="-6336809523669087720" onmouseenter="enter('-6336809523669087720');" onmouseout="out('-6336809523669087720');" style=""> 315         Date newStart = DateTimeUtils.shiftByDays(startDate, offset);                                    </span>
<span class="-2733879703924959637" onmouseenter="enter('-2733879703924959637');" onmouseout="out('-2733879703924959637');" style=""> 316         Date newEnd = DateTimeUtils.shiftByDays(endDate, offset);                                        </span>
<span  style=""> 317                                                                                                          </span>
<span class="-2856611894499161319" onmouseenter="enter('-2856611894499161319');" onmouseout="out('-2856611894499161319');" style=""> 318         return setDateRange(newStart, newEnd);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319     }                                                                                                    </span>
<span  style=""> 320                                                                                                          </span>
<span class="-5091098020443224535" onmouseenter="enter('-5091098020443224535');" onmouseout="out('-5091098020443224535');" style=""> 321     protected Integer getColorFor(int activityKind) {                                                    </span>
<span class="1068460219870485515" onmouseenter="enter('1068460219870485515');" onmouseout="out('1068460219870485515');" style=""> 322         switch (activityKind) {                                                                          </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 323             case ActivityKind.TYPE_DEEP_SLEEP:                                                           </span>
<span class="5022727203055802055" onmouseenter="enter('5022727203055802055');" onmouseout="out('5022727203055802055');" style=""> 324                 return akDeepSleep.color;                                                                </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 325             case ActivityKind.TYPE_LIGHT_SLEEP:                                                          </span>
<span class="9202598133274813026" onmouseenter="enter('9202598133274813026');" onmouseout="out('9202598133274813026');" style=""> 326                 return akLightSleep.color;                                                               </span>
<span class="-1944461592116084883" onmouseenter="enter('-1944461592116084883');" onmouseout="out('-1944461592116084883');" style=""> 327             case ActivityKind.TYPE_ACTIVITY:                                                             </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 328                 return akActivity.color;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329         }                                                                                                </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 330         return akActivity.color;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331     }                                                                                                    </span>
<span  style=""> 332                                                                                                          </span>
<span class="7124995295832055820" onmouseenter="enter('7124995295832055820');" onmouseout="out('7124995295832055820');" style=""><abbr title=" 333     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device) {"> 333     protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device)ðŸ”µ</abbr></span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 334         DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);               </span>
<span class="5252113264335521833" onmouseenter="enter('5252113264335521833');" onmouseout="out('5252113264335521833');" style=""> 335         return coordinator.getSampleProvider(device, db.getDaoSession());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336     }                                                                                                    </span>
<span  style=""> 337                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 338     /**                                                                                                  </span>
<span class="3872148434859025386" onmouseenter="enter('3872148434859025386');" onmouseout="out('3872148434859025386');" style=""> 339      * Returns all kinds of samples for the given device.                                                </span>
<span class="886766698730034078" onmouseenter="enter('886766698730034078');" onmouseout="out('886766698730034078');" style=""> 340      * To be called from a background thread.                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 341      *                                                                                                   </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 342      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 343      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 344      * @param tsTo                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 345      */                                                                                                  </span>
<span class="3140984125721729972" onmouseenter="enter('3140984125721729972');" onmouseout="out('3140984125721729972');" style=""><abbr title=" 346     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 346     protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, intðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 347         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="3618633972640587810" onmouseenter="enter('3618633972640587810');" onmouseout="out('3618633972640587810');" style=""> 348         return provider.getAllActivitySamples(tsFrom, tsTo);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349     }                                                                                                    </span>
<span  style=""> 350                                                                                                          </span>
<span class="911814376404307930" onmouseenter="enter('911814376404307930');" onmouseout="out('911814376404307930');" style=""><abbr title=" 351     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 351     protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, inðŸ”µ</abbr></span>
<span class="5136693054641003501" onmouseenter="enter('5136693054641003501');" onmouseout="out('5136693054641003501');" style=""> 352         SampleProvider&lt;? extends AbstractActivitySample&gt; provider = getProvider(db, device);             </span>
<span class="85967298499632314" onmouseenter="enter('85967298499632314');" onmouseout="out('85967298499632314');" style=""> 353         return provider.getActivitySamples(tsFrom, tsTo);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354     }                                                                                                    </span>
<span  style=""> 355                                                                                                          </span>
<span class="-241747733905569263" onmouseenter="enter('-241747733905569263');" onmouseout="out('-241747733905569263');" style=""><abbr title=" 356     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 356     protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, iðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 357         SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                     </span>
<span class="-5906481120950290774" onmouseenter="enter('-5906481120950290774');" onmouseout="out('-5906481120950290774');" style=""> 358         return provider.getSleepSamples(tsFrom, tsTo);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359     }                                                                                                    </span>
<span  style=""> 360                                                                                                          </span>
<span class="5612092723136709042" onmouseenter="enter('5612092723136709042');" onmouseout="out('5612092723136709042');" style=""> 361     protected void configureChartDefaults(Chart&lt;?&gt; chart) {                                              </span>
<span class="-7606632580747532983" onmouseenter="enter('-7606632580747532983');" onmouseout="out('-7606632580747532983');" style=""> 362         chart.getXAxis().setValueFormatter(new TimestampValueFormatter());                               </span>
<span class="6778504947781910997" onmouseenter="enter('6778504947781910997');" onmouseout="out('6778504947781910997');" style=""> 363         chart.getDescription().setText(&quot;&quot;);                                                              </span>
<span  style=""> 364                                                                                                          </span>
<span class="24609561265320879" onmouseenter="enter('24609561265320879');" onmouseout="out('24609561265320879');" style=""> 365         // if enabled, the chart will always start at zero on the y-axis                                 </span>
<span class="6529846037374092564" onmouseenter="enter('6529846037374092564');" onmouseout="out('6529846037374092564');" style=""> 366         chart.setNoDataText(getString(R.string.chart_no_data_synchronize));                              </span>
<span  style=""> 367                                                                                                          </span>
<span class="2162327714476306626" onmouseenter="enter('2162327714476306626');" onmouseout="out('2162327714476306626');" style=""> 368         // disable value highlighting                                                                    </span>
<span class="-1590348432070259774" onmouseenter="enter('-1590348432070259774');" onmouseout="out('-1590348432070259774');" style=""> 369         chart.setHighlightPerTapEnabled(false);                                                          </span>
<span  style=""> 370                                                                                                          </span>
<span class="-348919351774733305" onmouseenter="enter('-348919351774733305');" onmouseout="out('-348919351774733305');" style=""> 371         // enable touch gestures                                                                         </span>
<span class="5289310484488287391" onmouseenter="enter('5289310484488287391');" onmouseout="out('5289310484488287391');" style=""> 372         chart.setTouchEnabled(true);                                                                     </span>
<span  style=""> 373                                                                                                          </span>
<span class="-6098879767425938051" onmouseenter="enter('-6098879767425938051');" onmouseout="out('-6098879767425938051');" style=""> 374     // commented out: this has weird bugs/sideeffects at least on WeekStepsCharts                        </span>
<span class="8784253570401363075" onmouseenter="enter('8784253570401363075');" onmouseout="out('8784253570401363075');" style=""> 375     // where only the first Day-label is drawn, because AxisRenderer.computeAxisValues(float,float)      </span>
<span class="-8770575613400395593" onmouseenter="enter('-8770575613400395593');" onmouseout="out('-8770575613400395593');" style=""> 376     // appears to have an overflow when calculating &#x27;n&#x27; (number of entries)                              </span>
<span class="3888896009006521991" onmouseenter="enter('3888896009006521991');" onmouseout="out('3888896009006521991');" style=""> 377     //        chart.getXAxis().setGranularity(60*5);                                                     </span>
<span  style=""> 378                                                                                                          </span>
<span class="5634570376801469004" onmouseenter="enter('5634570376801469004');" onmouseout="out('5634570376801469004');" style=""> 379         setupLegend(chart);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380     }                                                                                                    </span>
<span  style=""> 381                                                                                                          </span>
<span class="-1924974321468626199" onmouseenter="enter('-1924974321468626199');" onmouseout="out('-1924974321468626199');" style=""> 382     protected void configureBarLineChartDefaults(BarLineChartBase&lt;?&gt; chart) {                            </span>
<span class="5467508404297658352" onmouseenter="enter('5467508404297658352');" onmouseout="out('5467508404297658352');" style=""> 383         configureChartDefaults(chart);                                                                   </span>
<span class="-8169200756215735113" onmouseenter="enter('-8169200756215735113');" onmouseout="out('-8169200756215735113');" style=""> 384         if (chart instanceof BarChart) {                                                                 </span>
<span class="2718779115389378256" onmouseenter="enter('2718779115389378256');" onmouseout="out('2718779115389378256');" style=""> 385             ((BarChart) chart).setFitBars(true);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386         }                                                                                                </span>
<span  style=""> 387                                                                                                          </span>
<span class="-1346367465809520237" onmouseenter="enter('-1346367465809520237');" onmouseout="out('-1346367465809520237');" style=""> 388         // enable scaling and dragging                                                                   </span>
<span class="165705574276177801" onmouseenter="enter('165705574276177801');" onmouseout="out('165705574276177801');" style=""> 389         chart.setDragEnabled(true);                                                                      </span>
<span class="6107382641746821998" onmouseenter="enter('6107382641746821998');" onmouseout="out('6107382641746821998');" style=""> 390         chart.setScaleEnabled(true);                                                                     </span>
<span  style=""> 391                                                                                                          </span>
<span class="6424277115851676497" onmouseenter="enter('6424277115851676497');" onmouseout="out('6424277115851676497');" style=""> 392         // if disabled, scaling can be done on x- and y-axis separately                                  </span>
<span class="6432377865510855871" onmouseenter="enter('6432377865510855871');" onmouseout="out('6432377865510855871');" style=""> 393     //        chart.setPinchZoom(true);                                                                  </span>
<span  style=""> 394                                                                                                          </span>
<span class="-3757744149975665581" onmouseenter="enter('-3757744149975665581');" onmouseout="out('-3757744149975665581');" style=""> 395         chart.setDrawGridBackground(false);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 396     }                                                                                                    </span>
<span  style=""> 397                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 398     /**                                                                                                  </span>
<span class="5100165395414783914" onmouseenter="enter('5100165395414783914');" onmouseout="out('5100165395414783914');" style=""> 399      * This method will invoke a background task to read the data from the                               </span>
<span class="5027852704688867372" onmouseenter="enter('5027852704688867372');" onmouseout="out('5027852704688867372');" style=""> 400      * database, analyze it, prepare it for the charts and eventually call                               </span>
<span class="-3918098027409993360" onmouseenter="enter('-3918098027409993360');" onmouseout="out('-3918098027409993360');" style=""> 401      * #renderCharts                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 402      */                                                                                                  </span>
<span class="2809394791911169685" onmouseenter="enter('2809394791911169685');" onmouseout="out('2809394791911169685');" style=""> 403     protected void refresh() {                                                                           </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 404         ChartsHost chartsHost = getChartsHost();                                                         </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 405         if (chartsHost != null) {                                                                        </span>
<span class="-103873194966226890" onmouseenter="enter('-103873194966226890');" onmouseout="out('-103873194966226890');" style=""> 406             if (chartsHost.getDevice() != null) {                                                        </span>
<span class="-5198511171031023043" onmouseenter="enter('-5198511171031023043');" onmouseout="out('-5198511171031023043');" style=""> 407                 mChartDirty = false;                                                                     </span>
<span class="7622323496435283090" onmouseenter="enter('7622323496435283090');" onmouseout="out('7622323496435283090');" style=""> 408                 updateDateInfo(getStartDate(), getEndDate());                                            </span>
<span class="3165810198377965313" onmouseenter="enter('3165810198377965313');" onmouseout="out('3165810198377965313');" style=""> 409                 if (refreshTask != null &amp;&amp; refreshTask.getStatus() != AsyncTask.Status.FINISHED) {       </span>
<span class="-3108005745869946167" onmouseenter="enter('-3108005745869946167');" onmouseout="out('-3108005745869946167');" style=""> 410                     refreshTask.cancel(true);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411                 }                                                                                        </span>
<span class="3840488977465298517" onmouseenter="enter('3840488977465298517');" onmouseout="out('3840488977465298517');" style=""> 412                 refreshTask = createRefreshTask(&quot;Visualizing data&quot;, getActivity()).execute();            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415     }                                                                                                    </span>
<span  style=""> 416                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 417     /**                                                                                                  </span>
<span class="4268529485699346115" onmouseenter="enter('4268529485699346115');" onmouseout="out('4268529485699346115');" style=""> 418      * This method reads the data from the database, analyzes and prepares it for                        </span>
<span class="-3790527174834636702" onmouseenter="enter('-3790527174834636702');" onmouseout="out('-3790527174834636702');" style=""> 419      * the charts. This will be called from a background task, so there must not be                      </span>
<span class="8892366747213531989" onmouseenter="enter('8892366747213531989');" onmouseout="out('8892366747213531989');" style=""><abbr title=" 420      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this method."> 420      * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this mðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 421      */                                                                                                  </span>
<span class="-9167766646201984999" onmouseenter="enter('-9167766646201984999');" onmouseout="out('-9167766646201984999');" style=""><abbr title=" 422     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice device);"> 422     protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice devicðŸ”µ</abbr></span>
<span  style=""> 423                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 424     /**                                                                                                  </span>
<span class="7668378754224811352" onmouseenter="enter('7668378754224811352');" onmouseout="out('7668378754224811352');" style=""> 425      * Triggers the actual (re-) rendering of the chart.                                                 </span>
<span class="1258740047847480611" onmouseenter="enter('1258740047847480611');" onmouseout="out('1258740047847480611');" style=""> 426      * Always called from the UI thread.                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 427      */                                                                                                  </span>
<span class="4159836083754598607" onmouseenter="enter('4159836083754598607');" onmouseout="out('4159836083754598607');" style=""> 428     protected abstract void renderCharts();                                                              </span>
<span  style=""> 429                                                                                                          </span>
<span class="1142774420965375266" onmouseenter="enter('1142774420965375266');" onmouseout="out('1142774420965375266');" style=""><abbr title=" 430     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samples) {"> 430     protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samplðŸ”µ</abbr></span>
<span class="-8538198379588667792" onmouseenter="enter('-8538198379588667792');" onmouseout="out('-8538198379588667792');" style=""> 431         // Calendar cal = GregorianCalendar.getInstance();                                               </span>
<span class="-5394694026731238076" onmouseenter="enter('-5394694026731238076');" onmouseout="out('-5394694026731238076');" style=""> 432         // cal.clear();                                                                                  </span>
<span class="6028849563211801820" onmouseenter="enter('6028849563211801820');" onmouseout="out('6028849563211801820');" style=""> 433         TimestampTranslation tsTranslation = new TimestampTranslation();                                 </span>
<span class="2920645720523643424" onmouseenter="enter('2920645720523643424');" onmouseout="out('2920645720523643424');" style=""> 434         // Date date;                                                                                    </span>
<span class="-8724388312994957561" onmouseenter="enter('-8724388312994957561');" onmouseout="out('-8724388312994957561');" style=""> 435         // String dateStringFrom = &quot;&quot;;                                                                   </span>
<span class="-700326394043089853" onmouseenter="enter('-700326394043089853');" onmouseout="out('-700326394043089853');" style=""> 436         // String dateStringTo = &quot;&quot;;                                                                     </span>
<span class="3388404629234174074" onmouseenter="enter('3388404629234174074');" onmouseout="out('3388404629234174074');" style=""> 437         // ArrayList&lt;String&gt; xLabels = null;                                                             </span>
<span class="-5859434202898851786" onmouseenter="enter('-5859434202898851786');" onmouseout="out('-5859434202898851786');" style=""> 438         LOG.info(((&quot;&quot; + getTitle()) + &quot;: number of samples:&quot;) + samples.size());                         </span>
<span class="3654763384087017314" onmouseenter="enter('3654763384087017314');" onmouseout="out('3654763384087017314');" style=""> 439         LineData lineData;                                                                               </span>
<span class="-9107937003987659062" onmouseenter="enter('-9107937003987659062');" onmouseout="out('-9107937003987659062');" style=""> 440         if (samples.size() &gt; 1) {                                                                        </span>
<span class="-8527306736668810111" onmouseenter="enter('-8527306736668810111');" onmouseout="out('-8527306736668810111');" style=""> 441             boolean annotate = true;                                                                     </span>
<span class="1395829712909105015" onmouseenter="enter('1395829712909105015');" onmouseout="out('1395829712909105015');" style=""> 442             boolean use_steps_as_movement;                                                               </span>
<span class="4142243867024174482" onmouseenter="enter('4142243867024174482');" onmouseout="out('4142243867024174482');" style=""> 443             int last_type = ActivityKind.TYPE_UNKNOWN;                                                   </span>
<span class="-2031252584474024476" onmouseenter="enter('-2031252584474024476');" onmouseout="out('-2031252584474024476');" style=""> 444             int numEntries = samples.size();                                                             </span>
<span class="-8870011066494287543" onmouseenter="enter('-8870011066494287543');" onmouseout="out('-8870011066494287543');" style=""> 445             List&lt;Entry&gt; activityEntries = new ArrayList&lt;&gt;(numEntries);                                   </span>
<span class="4899105382649046594" onmouseenter="enter('4899105382649046594');" onmouseout="out('4899105382649046594');" style=""> 446             List&lt;Entry&gt; deepSleepEntries = new ArrayList&lt;&gt;(numEntries);                                  </span>
<span class="7486237668847997910" onmouseenter="enter('7486237668847997910');" onmouseout="out('7486237668847997910');" style=""> 447             List&lt;Entry&gt; lightSleepEntries = new ArrayList&lt;&gt;(numEntries);                                 </span>
<span class="-1233994828972266903" onmouseenter="enter('-1233994828972266903');" onmouseout="out('-1233994828972266903');" style=""> 448             List&lt;Entry&gt; notWornEntries = new ArrayList&lt;&gt;(numEntries);                                    </span>
<span class="-7435551010854374427" onmouseenter="enter('-7435551010854374427');" onmouseout="out('-7435551010854374427');" style=""> 449             boolean hr = supportsHeartrate(gbDevice);                                                    </span>
<span class="-7878568619394741601" onmouseenter="enter('-7878568619394741601');" onmouseout="out('-7878568619394741601');" style=""> 450             List&lt;Entry&gt; heartrateEntries = (hr) ? new ArrayList&lt;Entry&gt;(numEntries) : null;               </span>
<span class="1020726993542045589" onmouseenter="enter('1020726993542045589');" onmouseout="out('1020726993542045589');" style=""> 451             List&lt;Integer&gt; colors = new ArrayList&lt;&gt;(numEntries);// this is kinda inefficient...           </span>
<span  style=""> 452                                                                                                          </span>
<span class="7529735733952592718" onmouseenter="enter('7529735733952592718');" onmouseout="out('7529735733952592718');" style=""> 453             int lastHrSampleIndex = -1;                                                                  </span>
<span class="4476749361735409543" onmouseenter="enter('4476749361735409543');" onmouseout="out('4476749361735409543');" style=""> 454             for (int i = 0; i &lt; numEntries; i++) {                                                       </span>
<span class="3246332292526896189" onmouseenter="enter('3246332292526896189');" onmouseout="out('3246332292526896189');" style=""> 455                 ActivitySample sample = samples.get(i);                                                  </span>
<span class="6576081203602242327" onmouseenter="enter('6576081203602242327');" onmouseout="out('6576081203602242327');" style=""> 456                 int type = sample.getKind();                                                             </span>
<span class="-9213760672368715167" onmouseenter="enter('-9213760672368715167');" onmouseout="out('-9213760672368715167');" style=""> 457                 int ts = tsTranslation.shorten(sample.getTimestamp());                                   </span>
<span class="-5317861493758349952" onmouseenter="enter('-5317861493758349952');" onmouseout="out('-5317861493758349952');" style=""> 458                 // System.out.println(ts);                                                               </span>
<span class="2518287658947459390" onmouseenter="enter('2518287658947459390');" onmouseout="out('2518287658947459390');" style=""> 459                 // ts = i;                                                                               </span>
<span class="5764290091373211945" onmouseenter="enter('5764290091373211945');" onmouseout="out('5764290091373211945');" style=""> 460                 // determine start and end dates                                                         </span>
<span class="1533692341421800285" onmouseenter="enter('1533692341421800285');" onmouseout="out('1533692341421800285');" style=""> 461                 // if (i == 0) {                                                                         </span>
<span class="-159640816847405075" onmouseenter="enter('-159640816847405075');" onmouseout="out('-159640816847405075');" style=""> 462                 // cal.setTimeInMillis(ts * 1000L); // make sure it&#x27;s converted to long                  </span>
<span class="846780979169026042" onmouseenter="enter('846780979169026042');" onmouseout="out('846780979169026042');" style=""> 463                 // date = cal.getTime();                                                                 </span>
<span class="2129757933637235330" onmouseenter="enter('2129757933637235330');" onmouseout="out('2129757933637235330');" style=""> 464                 // dateStringFrom = dateFormat.format(date);                                             </span>
<span class="4880429977614649583" onmouseenter="enter('4880429977614649583');" onmouseout="out('4880429977614649583');" style=""> 465                 // } else if (i == samples.size() - 1) {                                                 </span>
<span class="-82038704796100868" onmouseenter="enter('-82038704796100868');" onmouseout="out('-82038704796100868');" style=""> 466                 // cal.setTimeInMillis(ts * 1000L); // same here                                         </span>
<span class="846780979169026042" onmouseenter="enter('846780979169026042');" onmouseout="out('846780979169026042');" style=""> 467                 // date = cal.getTime();                                                                 </span>
<span class="8419509515114525052" onmouseenter="enter('8419509515114525052');" onmouseout="out('8419509515114525052');" style=""> 468                 // dateStringTo = dateFormat.format(date);                                               </span>
<span class="6190421505795807923" onmouseenter="enter('6190421505795807923');" onmouseout="out('6190421505795807923');" style=""> 469                 // }                                                                                     </span>
<span class="-8914675673971344704" onmouseenter="enter('-8914675673971344704');" onmouseout="out('-8914675673971344704');" style=""> 470                 float movement = sample.getIntensity();                                                  </span>
<span class="5917499164651721508" onmouseenter="enter('5917499164651721508');" onmouseout="out('5917499164651721508');" style=""> 471                 float value = movement;                                                                  </span>
<span class="3474584951622682325" onmouseenter="enter('3474584951622682325');" onmouseout="out('3474584951622682325');" style=""> 472                 switch (type) {                                                                          </span>
<span class="-7846573682215081429" onmouseenter="enter('-7846573682215081429');" onmouseout="out('-7846573682215081429');" style=""> 473                     case ActivityKind.TYPE_DEEP_SLEEP :                                                  </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 474                         if (last_type != type) {                                                         </span>
<span class="2973653921120868011" onmouseenter="enter('2973653921120868011');" onmouseout="out('2973653921120868011');" style=""> 475                             // FIXME: this is ugly but it works (repeated in each case)                  </span>
<span class="-1661959904957213102" onmouseenter="enter('-1661959904957213102');" onmouseout="out('-1661959904957213102');" style=""> 476                             deepSleepEntries.add(createLineEntry(0, ts - 1));                            </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 477                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 478                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 479                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480                         }                                                                                </span>
<span class="-6180311285798694701" onmouseenter="enter('-6180311285798694701');" onmouseout="out('-6180311285798694701');" style=""> 481                         deepSleepEntries.add(createLineEntry(value + SleepUtils.Y_VALUE_DEEP_SLEEP, ts));</span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 482                         break;                                                                           </span>
<span class="-4959939314639328598" onmouseenter="enter('-4959939314639328598');" onmouseout="out('-4959939314639328598');" style=""> 483                     case ActivityKind.TYPE_LIGHT_SLEEP :                                                 </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 484                         if (last_type != type) {                                                         </span>
<span class="7147575638574677011" onmouseenter="enter('7147575638574677011');" onmouseout="out('7147575638574677011');" style=""> 485                             lightSleepEntries.add(createLineEntry(0, ts - 1));                           </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 486                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 487                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 488                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489                         }                                                                                </span>
<span class="-5875750109358144719" onmouseenter="enter('-5875750109358144719');" onmouseout="out('-5875750109358144719');" style=""> 490                         lightSleepEntries.add(createLineEntry(value, ts));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 491                         break;                                                                           </span>
<span class="-1708896629433740283" onmouseenter="enter('-1708896629433740283');" onmouseout="out('-1708896629433740283');" style=""> 492                     case ActivityKind.TYPE_NOT_WORN :                                                    </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 493                         if (last_type != type) {                                                         </span>
<span class="4292609800559774054" onmouseenter="enter('4292609800559774054');" onmouseout="out('4292609800559774054');" style=""> 494                             notWornEntries.add(createLineEntry(0, ts - 1));                              </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 495                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 496                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 497                             activityEntries.add(createLineEntry(0, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498                         }                                                                                </span>
<span class="-3390238108980776317" onmouseenter="enter('-3390238108980776317');" onmouseout="out('-3390238108980776317');" style=""><abbr title=" 499                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts));// a small value, just to show something on the graphs"> 499                         notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts));// a smallðŸ”µ</abbr></span>
<span  style=""> 500                                                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 501                         break;                                                                           </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 502                     default :                                                                            </span>
<span class="-4985930555120214721" onmouseenter="enter('-4985930555120214721');" onmouseout="out('-4985930555120214721');" style=""> 503                         // short steps = sample.getSteps();                                              </span>
<span class="5491447534060622272" onmouseenter="enter('5491447534060622272');" onmouseout="out('5491447534060622272');" style=""> 504                         // if (use_steps_as_movement &amp;&amp; steps != 0) {                                    </span>
<span class="3120211051286409174" onmouseenter="enter('3120211051286409174');" onmouseout="out('3120211051286409174');" style=""> 505                         // I&#x27;m not sure using steps for this is actually a good idea                     </span>
<span class="2471077848181228308" onmouseenter="enter('2471077848181228308');" onmouseout="out('2471077848181228308');" style=""> 506                         // movement = steps;                                                             </span>
<span class="6190421505795807923" onmouseenter="enter('6190421505795807923');" onmouseout="out('6190421505795807923');" style=""> 507                         // }                                                                             </span>
<span class="8952378684855168793" onmouseenter="enter('8952378684855168793');" onmouseout="out('8952378684855168793');" style=""> 508                         // value = ((float) movement) / movement_divisor;                                </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 509                         if (last_type != type) {                                                         </span>
<span class="-6771781995837807247" onmouseenter="enter('-6771781995837807247');" onmouseout="out('-6771781995837807247');" style=""> 510                             activityEntries.add(createLineEntry(0, ts - 1));                             </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 511                             lightSleepEntries.add(createLineEntry(0, ts));                               </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 512                             notWornEntries.add(createLineEntry(0, ts));                                  </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 513                             deepSleepEntries.add(createLineEntry(0, ts));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 514                         }                                                                                </span>
<span class="4080308283196262910" onmouseenter="enter('4080308283196262910');" onmouseout="out('4080308283196262910');" style=""> 515                         activityEntries.add(createLineEntry(value, ts));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516                 }                                                                                        </span>
<span class="4785156711825893317" onmouseenter="enter('4785156711825893317');" onmouseout="out('4785156711825893317');" style=""><abbr title=" 517                 if ((hr &amp;&amp; (sample.getKind() != ActivityKind.TYPE_NOT_WORN)) &amp;&amp; HeartRateUtils.isValidHeartRateValue(sample.getHeartRate())) {"> 517                 if ((hr &amp;&amp; (sample.getKind() != ActivityKind.TYPE_NOT_WORN)) &amp;&amp; HeartRateUtils.isValidHeaðŸ”µ</abbr></span>
<span class="-2395087071899866355" onmouseenter="enter('-2395087071899866355');" onmouseout="out('-2395087071899866355');" style=""><abbr title=" 518                     if ((lastHrSampleIndex &gt; (-1)) &amp;&amp; ((ts - lastHrSampleIndex) &gt; (1800 * HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES))) {"> 518                     if ((lastHrSampleIndex &gt; (-1)) &amp;&amp; ((ts - lastHrSampleIndex) &gt; (1800 * HeartRateUtils.ðŸ”µ</abbr></span>
<span class="7928119684647429254" onmouseenter="enter('7928119684647429254');" onmouseout="out('7928119684647429254');" style=""> 519                         heartrateEntries.add(createLineEntry(0, lastHrSampleIndex + 1));                 </span>
<span class="-5182503479458455454" onmouseenter="enter('-5182503479458455454');" onmouseout="out('-5182503479458455454');" style=""> 520                         heartrateEntries.add(createLineEntry(0, ts - 1));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521                     }                                                                                    </span>
<span class="-8554726460294545666" onmouseenter="enter('-8554726460294545666');" onmouseout="out('-8554726460294545666');" style=""> 522                     heartrateEntries.add(createLineEntry(sample.getHeartRate(), ts));                    </span>
<span class="1340167295380328410" onmouseenter="enter('1340167295380328410');" onmouseout="out('1340167295380328410');" style=""> 523                     lastHrSampleIndex = ts;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524                 }                                                                                        </span>
<span class="7730925444289024998" onmouseenter="enter('7730925444289024998');" onmouseout="out('7730925444289024998');" style=""> 525                 String xLabel = &quot;&quot;;                                                                      </span>
<span class="-5459254189226498661" onmouseenter="enter('-5459254189226498661');" onmouseout="out('-5459254189226498661');" style=""> 526                 if (annotate) {                                                                          </span>
<span class="-8419024364380841063" onmouseenter="enter('-8419024364380841063');" onmouseout="out('-8419024364380841063');" style=""> 527                     // cal.setTimeInMillis((ts + tsOffset) * 1000L);                                     </span>
<span class="846780979169026042" onmouseenter="enter('846780979169026042');" onmouseout="out('846780979169026042');" style=""> 528                     // date = cal.getTime();                                                             </span>
<span class="1820737530533036826" onmouseenter="enter('1820737530533036826');" onmouseout="out('1820737530533036826');" style=""> 529                     // String dateString = annotationDateFormat.format(date);                            </span>
<span class="4218700143879968677" onmouseenter="enter('4218700143879968677');" onmouseout="out('4218700143879968677');" style=""> 530                     // xLabel = dateString;                                                              </span>
<span class="4235562531944548200" onmouseenter="enter('4235562531944548200');" onmouseout="out('4235562531944548200');" style=""> 531                     // if (last_type != type) {                                                          </span>
<span class="4318604609882254185" onmouseenter="enter('4318604609882254185');" onmouseout="out('4318604609882254185');" style=""> 532                     // if (isSleep(last_type) &amp;&amp; !isSleep(type)) {                                       </span>
<span class="7176187173993546670" onmouseenter="enter('7176187173993546670');" onmouseout="out('7176187173993546670');" style=""> 533                     // woken up                                                                          </span>
<span class="6293632008234498158" onmouseenter="enter('6293632008234498158');" onmouseout="out('6293632008234498158');" style=""> 534                     // LimitLine line = new LimitLine(i, dateString);                                    </span>
<span class="3406434424828120128" onmouseenter="enter('3406434424828120128');" onmouseout="out('3406434424828120128');" style=""> 535                     // line.enableDashedLine(8, 8, 0);                                                   </span>
<span class="-103073280547405104" onmouseenter="enter('-103073280547405104');" onmouseout="out('-103073280547405104');" style=""> 536                     // line.setTextColor(Color.WHITE);                                                   </span>
<span class="7986647978327647824" onmouseenter="enter('7986647978327647824');" onmouseout="out('7986647978327647824');" style=""> 537                     // line.setTextSize(15);                                                             </span>
<span class="-4153915894506586108" onmouseenter="enter('-4153915894506586108');" onmouseout="out('-4153915894506586108');" style=""> 538                     // chart.getXAxis().addLimitLine(line);                                              </span>
<span class="-1122834932903415753" onmouseenter="enter('-1122834932903415753');" onmouseout="out('-1122834932903415753');" style=""> 539                     // } else if (!isSleep(last_type) &amp;&amp; isSleep(type)) {                                </span>
<span class="-1532620357294991766" onmouseenter="enter('-1532620357294991766');" onmouseout="out('-1532620357294991766');" style=""> 540                     // fallen asleep                                                                     </span>
<span class="6293632008234498158" onmouseenter="enter('6293632008234498158');" onmouseout="out('6293632008234498158');" style=""> 541                     // LimitLine line = new LimitLine(i, dateString);                                    </span>
<span class="3406434424828120128" onmouseenter="enter('3406434424828120128');" onmouseout="out('3406434424828120128');" style=""> 542                     // line.enableDashedLine(8, 8, 0);                                                   </span>
<span class="7986647978327647824" onmouseenter="enter('7986647978327647824');" onmouseout="out('7986647978327647824');" style=""> 543                     // line.setTextSize(15);                                                             </span>
<span class="-103073280547405104" onmouseenter="enter('-103073280547405104');" onmouseout="out('-103073280547405104');" style=""> 544                     // line.setTextColor(Color.WHITE);                                                   </span>
<span class="-4153915894506586108" onmouseenter="enter('-4153915894506586108');" onmouseout="out('-4153915894506586108');" style=""> 545                     // chart.getXAxis().addLimitLine(line);                                              </span>
<span class="6190421505795807923" onmouseenter="enter('6190421505795807923');" onmouseout="out('6190421505795807923');" style=""> 546                     // }                                                                                 </span>
<span class="6190421505795807923" onmouseenter="enter('6190421505795807923');" onmouseout="out('6190421505795807923');" style=""> 547                     // }                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 548                 }                                                                                        </span>
<span class="-1444147652675010833" onmouseenter="enter('-1444147652675010833');" onmouseout="out('-1444147652675010833');" style=""> 549                 last_type = type;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 550             }                                                                                            </span>
<span class="-1579194111559420554" onmouseenter="enter('-1579194111559420554');" onmouseout="out('-1579194111559420554');" style=""> 551             List&lt;ILineDataSet&gt; lineDataSets = new ArrayList&lt;&gt;();                                         </span>
<span class="-1359387837948108742" onmouseenter="enter('-1359387837948108742');" onmouseout="out('-1359387837948108742');" style=""> 552             LineDataSet activitySet = createDataSet(activityEntries, akActivity.color, &quot;Activity&quot;);      </span>
<span class="-3354127768405521554" onmouseenter="enter('-3354127768405521554');" onmouseout="out('-3354127768405521554');" style=""> 553             lineDataSets.add(activitySet);                                                               </span>
<span class="7026895411091818045" onmouseenter="enter('7026895411091818045');" onmouseout="out('7026895411091818045');" style=""> 554             LineDataSet deepSleepSet = createDataSet(deepSleepEntries, akDeepSleep.color, &quot;Deep Sleep&quot;); </span>
<span class="-3446958151566211125" onmouseenter="enter('-3446958151566211125');" onmouseout="out('-3446958151566211125');" style=""> 555             lineDataSets.add(deepSleepSet);                                                              </span>
<span class="4693393103163137779" onmouseenter="enter('4693393103163137779');" onmouseout="out('4693393103163137779');" style=""><abbr title=" 556             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light Sleep&quot;);"> 556             LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light SleepðŸ”µ</abbr></span>
<span class="8003351674511898289" onmouseenter="enter('8003351674511898289');" onmouseout="out('8003351674511898289');" style=""> 557             lineDataSets.add(lightSleepSet);                                                             </span>
<span class="-7108338871992330028" onmouseenter="enter('-7108338871992330028');" onmouseout="out('-7108338871992330028');" style=""> 558             LineDataSet notWornSet = createDataSet(notWornEntries, akNotWorn.color, &quot;Not worn&quot;);         </span>
<span class="64462528287934820" onmouseenter="enter('64462528287934820');" onmouseout="out('64462528287934820');" style=""> 559             lineDataSets.add(notWornSet);                                                                </span>
<span class="5448185601305021565" onmouseenter="enter('5448185601305021565');" onmouseout="out('5448185601305021565');" style=""> 560             if (hr &amp;&amp; (heartrateEntries.size() &gt; 0)) {                                                   </span>
<span class="-6373591549531816713" onmouseenter="enter('-6373591549531816713');" onmouseout="out('-6373591549531816713');" style=""> 561                 LineDataSet heartrateSet = createHeartrateSet(heartrateEntries, &quot;Heart Rate&quot;);           </span>
<span class="8944960460471270621" onmouseenter="enter('8944960460471270621');" onmouseout="out('8944960460471270621');" style=""> 562                 lineDataSets.add(heartrateSet);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563             }                                                                                            </span>
<span class="2703760882318229208" onmouseenter="enter('2703760882318229208');" onmouseout="out('2703760882318229208');" style=""> 564             lineData = new LineData(lineDataSets);                                                       </span>
<span class="-6499460759915470269" onmouseenter="enter('-6499460759915470269');" onmouseout="out('-6499460759915470269');" style=""><abbr title=" 565 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStringTo));"> 565 //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStriðŸ”µ</abbr></span>
<span class="-3762887228500678217" onmouseenter="enter('-3762887228500678217');" onmouseout="out('-3762887228500678217');" style=""> 566 //            chart.setDescriptionPosition(?, ?);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 567         } else {                                                                                         </span>
<span class="-2761320896669897238" onmouseenter="enter('-2761320896669897238');" onmouseout="out('-2761320896669897238');" style=""> 568             lineData = new LineData();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 569         }                                                                                                </span>
<span class="-1609543182283032519" onmouseenter="enter('-1609543182283032519');" onmouseout="out('-1609543182283032519');" style=""> 570         IAxisValueFormatter xValueFormatter = new SampleXLabelFormatter(tsTranslation);                  </span>
<span class="-3441797761873957961" onmouseenter="enter('-3441797761873957961');" onmouseout="out('-3441797761873957961');" style=""> 571         return new DefaultChartsData(lineData, xValueFormatter);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 572     }                                                                                                    </span>
<span  style=""> 573                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 574     /**                                                                                                  </span>
<span class="6334547652397213625" onmouseenter="enter('6334547652397213625');" onmouseout="out('6334547652397213625');" style=""> 575      * Implement this to supply the samples to be displayed.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 576      *                                                                                                   </span>
<span class="5464670662091686554" onmouseenter="enter('5464670662091686554');" onmouseout="out('5464670662091686554');" style=""> 577      * @param db                                                                                         </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 578      * @param device                                                                                     </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 579      * @param tsFrom                                                                                     </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 580      * @param tsTo                                                                                       </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 581      * @return                                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 582      */                                                                                                  </span>
<span class="-4899824222168510613" onmouseenter="enter('-4899824222168510613');" onmouseout="out('-4899824222168510613');" style=""><abbr title=" 583     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo);"> 583     protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFroðŸ”µ</abbr></span>
<span  style=""> 584                                                                                                          </span>
<span class="354769125648165857" onmouseenter="enter('354769125648165857');" onmouseout="out('354769125648165857');" style=""> 585     protected abstract void setupLegend(Chart chart);                                                    </span>
<span  style=""> 586                                                                                                          </span>
<span class="-188113346780130145" onmouseenter="enter('-188113346780130145');" onmouseout="out('-188113346780130145');" style=""> 587     protected Entry createLineEntry(float value, int xValue) {                                           </span>
<span class="5155334880625707837" onmouseenter="enter('5155334880625707837');" onmouseout="out('5155334880625707837');" style=""> 588         return new Entry(xValue, value);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589     }                                                                                                    </span>
<span  style=""> 590                                                                                                          </span>
<span class="5268984431672798069" onmouseenter="enter('5268984431672798069');" onmouseout="out('5268984431672798069');" style=""> 591     protected LineDataSet createDataSet(List&lt;Entry&gt; values, Integer color, String label) {               </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 592         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="820149155345415568" onmouseenter="enter('820149155345415568');" onmouseout="out('820149155345415568');" style=""> 593         set1.setColor(color);                                                                            </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 594     //        set1.setDrawCubic(true);                                                                   </span>
<span class="-7031616190320035410" onmouseenter="enter('-7031616190320035410');" onmouseout="out('-7031616190320035410');" style=""> 595     //        set1.setCubicIntensity(0.2f);                                                              </span>
<span class="5358451272424367352" onmouseenter="enter('5358451272424367352');" onmouseout="out('5358451272424367352');" style=""> 596         set1.setDrawFilled(true);                                                                        </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 597         set1.setDrawCircles(false);                                                                      </span>
<span class="5314519233815368988" onmouseenter="enter('5314519233815368988');" onmouseout="out('5314519233815368988');" style=""> 598     //        set1.setLineWidth(2f);                                                                     </span>
<span class="4052186244749569041" onmouseenter="enter('4052186244749569041');" onmouseout="out('4052186244749569041');" style=""> 599     //        set1.setCircleSize(5f);                                                                    </span>
<span class="5178863964691876958" onmouseenter="enter('5178863964691876958');" onmouseout="out('5178863964691876958');" style=""> 600         set1.setFillColor(color);                                                                        </span>
<span class="-3615467214536174629" onmouseenter="enter('-3615467214536174629');" onmouseout="out('-3615467214536174629');" style=""> 601         set1.setFillAlpha(255);                                                                          </span>
<span class="-2764219564959910542" onmouseenter="enter('-2764219564959910542');" onmouseout="out('-2764219564959910542');" style=""> 602         set1.setDrawValues(false);                                                                       </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 603     //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                            </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 604     //        set1.setColor(Color.rgb(89, 178, 44));                                                     </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 605         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="-729266328453548997" onmouseenter="enter('-729266328453548997');" onmouseout="out('-729266328453548997');" style=""> 606         set1.setAxisDependency(YAxis.AxisDependency.LEFT);                                               </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 607         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 608     }                                                                                                    </span>
<span  style=""> 609                                                                                                          </span>
<span class="812124301236032885" onmouseenter="enter('812124301236032885');" onmouseout="out('812124301236032885');" style=""> 610     protected LineDataSet createHeartrateSet(List&lt;Entry&gt; values, String label) {                         </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 611         LineDataSet set1 = new LineDataSet(values, label);                                               </span>
<span class="5440468726562122008" onmouseenter="enter('5440468726562122008');" onmouseout="out('5440468726562122008');" style=""> 612         set1.setLineWidth(2.2f);                                                                         </span>
<span class="-6998111113207584878" onmouseenter="enter('-6998111113207584878');" onmouseout="out('-6998111113207584878');" style=""> 613         set1.setColor(HEARTRATE_COLOR);                                                                  </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 614     //        set1.setDrawCubic(true);                                                                   </span>
<span class="-5525611047697799836" onmouseenter="enter('-5525611047697799836');" onmouseout="out('-5525611047697799836');" style=""> 615         set1.setMode(LineDataSet.Mode.HORIZONTAL_BEZIER);                                                </span>
<span class="-6788168983082898765" onmouseenter="enter('-6788168983082898765');" onmouseout="out('-6788168983082898765');" style=""> 616         set1.setCubicIntensity(0.1f);                                                                    </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 617         set1.setDrawCircles(false);                                                                      </span>
<span class="8990366444861982417" onmouseenter="enter('8990366444861982417');" onmouseout="out('8990366444861982417');" style=""> 618     //        set1.setCircleRadius(2f);                                                                  </span>
<span class="7490911489692857332" onmouseenter="enter('7490911489692857332');" onmouseout="out('7490911489692857332');" style=""> 619     //        set1.setDrawFilled(true);                                                                  </span>
<span class="-2083836916768378283" onmouseenter="enter('-2083836916768378283');" onmouseout="out('-2083836916768378283');" style=""> 620     //        set1.setColor(getResources().getColor(android.R.color.background_light));                  </span>
<span class="5114874680539545534" onmouseenter="enter('5114874680539545534');" onmouseout="out('5114874680539545534');" style=""> 621     //        set1.setCircleColor(HEARTRATE_COLOR);                                                      </span>
<span class="2152854923555754112" onmouseenter="enter('2152854923555754112');" onmouseout="out('2152854923555754112');" style=""> 622     //        set1.setFillColor(ColorTemplate.getHoloBlue());                                            </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 623     //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                            </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 624     //        set1.setColor(Color.rgb(89, 178, 44));                                                     </span>
<span class="-6976214771678818552" onmouseenter="enter('-6976214771678818552');" onmouseout="out('-6976214771678818552');" style=""> 625         set1.setDrawValues(true);                                                                        </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 626         set1.setValueTextColor(CHART_TEXT_COLOR);                                                        </span>
<span class="7444000937070277499" onmouseenter="enter('7444000937070277499');" onmouseout="out('7444000937070277499');" style=""> 627         set1.setAxisDependency(YAxis.AxisDependency.RIGHT);                                              </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 628         return set1;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 629     }                                                                                                    </span>
<span  style=""> 630                                                                                                          </span>
<span class="-8033521169229713638" onmouseenter="enter('-8033521169229713638');" onmouseout="out('-8033521169229713638');" style=""> 631     protected RefreshTask createRefreshTask(String task, Context context) {                              </span>
<span class="4652327534384605753" onmouseenter="enter('4652327534384605753');" onmouseout="out('4652327534384605753');" style=""> 632         return new RefreshTask(task, context);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 633     }                                                                                                    </span>
<span  style=""> 634                                                                                                          </span>
<span class="-546204840646058388" onmouseenter="enter('-546204840646058388');" onmouseout="out('-546204840646058388');" style=""> 635     public class RefreshTask extends DBAccess {                                                          </span>
<span class="3813756787288835606" onmouseenter="enter('3813756787288835606');" onmouseout="out('3813756787288835606');" style=""> 636         private ChartsData chartsData;                                                                   </span>
<span  style=""> 637                                                                                                          </span>
<span class="6265910281991326326" onmouseenter="enter('6265910281991326326');" onmouseout="out('6265910281991326326');" style=""> 638         public RefreshTask(String task, Context context) {                                               </span>
<span class="6170214191344158476" onmouseenter="enter('6170214191344158476');" onmouseout="out('6170214191344158476');" style=""> 639             super(task, context);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640         }                                                                                                </span>
<span  style=""> 641                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 642         @Override                                                                                        </span>
<span class="6769214505219419913" onmouseenter="enter('6769214505219419913');" onmouseout="out('6769214505219419913');" style=""> 643         protected void doInBackground(DBHandler db) {                                                    </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 644             ChartsHost chartsHost = getChartsHost();                                                     </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 645             if (chartsHost != null) {                                                                    </span>
<span class="-1872147130605113863" onmouseenter="enter('-1872147130605113863');" onmouseout="out('-1872147130605113863');" style=""> 646                 chartsData = refreshInBackground(chartsHost, db, chartsHost.getDevice());                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 647             } else {                                                                                     </span>
<span class="4351338677612212716" onmouseenter="enter('4351338677612212716');" onmouseout="out('4351338677612212716');" style=""> 648                 cancel(true);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 650         }                                                                                                </span>
<span  style=""> 651                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 652         @Override                                                                                        </span>
<span class="7961646527709364830" onmouseenter="enter('7961646527709364830');" onmouseout="out('7961646527709364830');" style=""> 653         protected void onPostExecute(Object o) {                                                         </span>
<span class="1329337488051350495" onmouseenter="enter('1329337488051350495');" onmouseout="out('1329337488051350495');" style=""> 654             super.onPostExecute(o);                                                                      </span>
<span class="4343120289681205406" onmouseenter="enter('4343120289681205406');" onmouseout="out('4343120289681205406');" style=""> 655             FragmentActivity activity = getActivity();                                                   </span>
<span class="-9107871123587426323" onmouseenter="enter('-9107871123587426323');" onmouseout="out('-9107871123587426323');" style=""> 656             if (((activity != null) &amp;&amp; (!activity.isFinishing())) &amp;&amp; (!activity.isDestroyed())) {        </span>
<span class="-9005677599852802201" onmouseenter="enter('-9005677599852802201');" onmouseout="out('-9005677599852802201');" style=""> 657                 updateChartsnUIThread(chartsData);                                                       </span>
<span class="-4582773223831390369" onmouseenter="enter('-4582773223831390369');" onmouseout="out('-4582773223831390369');" style=""> 658                 renderCharts();                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 659             } else {                                                                                     </span>
<span class="-112827357653254579" onmouseenter="enter('-112827357653254579');" onmouseout="out('-112827357653254579');" style=""> 660                 LOG.info(&quot;Not rendering charts because activity is not available anymore&quot;);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 661             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 662         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663     }                                                                                                    </span>
<span  style=""> 664                                                                                                          </span>
<span class="4496803111214409190" onmouseenter="enter('4496803111214409190');" onmouseout="out('4496803111214409190');" style=""> 665     protected abstract void updateChartsnUIThread(ChartsData chartsData);                                </span>
<span  style=""> 666                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 667     /**                                                                                                  </span>
<span class="-5037778349112302453" onmouseenter="enter('-5037778349112302453');" onmouseout="out('-5037778349112302453');" style=""> 668      * Returns true if the date was successfully shifted, and false if the shift                         </span>
<span class="-2032571983951913696" onmouseenter="enter('-2032571983951913696');" onmouseout="out('-2032571983951913696');" style=""> 669      * was ignored, e.g. when the to-value is in the future.                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 670      *                                                                                                   </span>
<span class="3294571698788299338" onmouseenter="enter('3294571698788299338');" onmouseout="out('3294571698788299338');" style=""> 671      * @param from                                                                                       </span>
<span class="-8398071401251508968" onmouseenter="enter('-8398071401251508968');" onmouseout="out('-8398071401251508968');" style=""> 672      * @param to                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 673      */                                                                                                  </span>
<span class="2489721831712552479" onmouseenter="enter('2489721831712552479');" onmouseout="out('2489721831712552479');" style=""> 674     public boolean setDateRange(Date from, Date to) {                                                    </span>
<span class="4190819803131113323" onmouseenter="enter('4190819803131113323');" onmouseout="out('4190819803131113323');" style=""> 675         if (from.compareTo(to) &gt; 0) {                                                                    </span>
<span class="8028532381572922008" onmouseenter="enter('8028532381572922008');" onmouseout="out('8028532381572922008');" style=""> 676             throw new IllegalArgumentException(&quot;Bad date range: &quot; + from + &quot;..&quot; + to);                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 677         }                                                                                                </span>
<span class="-968081081932492520" onmouseenter="enter('-968081081932492520');" onmouseout="out('-968081081932492520');" style=""> 678         Date now = new Date();                                                                           </span>
<span class="6487488966631950340" onmouseenter="enter('6487488966631950340');" onmouseout="out('6487488966631950340');" style=""> 679         if (to.after(now)) {                                                                             </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 680             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 681         }                                                                                                </span>
<span class="-9201818232828316665" onmouseenter="enter('-9201818232828316665');" onmouseout="out('-9201818232828316665');" style=""> 682         setStartDate(from);                                                                              </span>
<span class="9222819538541566960" onmouseenter="enter('9222819538541566960');" onmouseout="out('9222819538541566960');" style=""> 683         setEndDate(to);                                                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 684         return true;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685     }                                                                                                    </span>
<span  style=""> 686                                                                                                          </span>
<span class="3159484724367933437" onmouseenter="enter('3159484724367933437');" onmouseout="out('3159484724367933437');" style=""> 687     protected void updateDateInfo(Date from, Date to) {                                                  </span>
<span class="-6255879985318699594" onmouseenter="enter('-6255879985318699594');" onmouseout="out('-6255879985318699594');" style=""> 688         if (from.equals(to)) {                                                                           </span>
<span class="573039521209829270" onmouseenter="enter('573039521209829270');" onmouseout="out('573039521209829270');" style=""> 689             getChartsHost().setDateInfo(DateTimeUtils.formatDate(from));                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 690         } else {                                                                                         </span>
<span class="6154857771528724742" onmouseenter="enter('6154857771528724742');" onmouseout="out('6154857771528724742');" style=""> 691             getChartsHost().setDateInfo(DateTimeUtils.formatDateRange(from, to));                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 692         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 693     }                                                                                                    </span>
<span  style=""> 694                                                                                                          </span>
<span class="-2205559255794313412" onmouseenter="enter('-2205559255794313412');" onmouseout="out('-2205559255794313412');" style=""> 695     protected List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device) {                 </span>
<span class="4967864623407424140" onmouseenter="enter('4967864623407424140');" onmouseout="out('4967864623407424140');" style=""> 696         int tsStart = getTSStart();                                                                      </span>
<span class="-7516136729766634070" onmouseenter="enter('-7516136729766634070');" onmouseout="out('-7516136729766634070');" style=""> 697         int tsEnd = getTSEnd();                                                                          </span>
<span class="7673509543804257849" onmouseenter="enter('7673509543804257849');" onmouseout="out('7673509543804257849');" style=""> 698         List&lt;ActivitySample&gt; samples = (List&lt;ActivitySample&gt;) getSamples(db, device, tsStart, tsEnd);    </span>
<span class="-5815796914087715329" onmouseenter="enter('-5815796914087715329');" onmouseout="out('-5815796914087715329');" style=""> 699         ensureStartAndEndSamples(samples, tsStart, tsEnd);                                               </span>
<span class="1818060248517305383" onmouseenter="enter('1818060248517305383');" onmouseout="out('1818060248517305383');" style=""> 700     //        List&lt;ActivitySample&gt; samples2 = new ArrayList&lt;&gt;();                                         </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 701     //        int min = Math.min(samples.size(), 10);                                                    </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 702     //        int min = Math.min(samples.size(), 10);                                                    </span>
<span class="-3297133522407861021" onmouseenter="enter('-3297133522407861021');" onmouseout="out('-3297133522407861021');" style=""> 703     //        for (int i = 0; i &lt; min; i++) {                                                            </span>
<span class="-5419954369064878282" onmouseenter="enter('-5419954369064878282');" onmouseout="out('-5419954369064878282');" style=""> 704     //            samples2.add(samples.get(i));                                                          </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 705     //        }                                                                                          </span>
<span class="-217733928506784495" onmouseenter="enter('-217733928506784495');" onmouseout="out('-217733928506784495');" style=""> 706     //        return samples2;                                                                           </span>
<span class="8329125895357939517" onmouseenter="enter('8329125895357939517');" onmouseout="out('8329125895357939517');" style=""> 707         return samples;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 708     }                                                                                                    </span>
<span  style=""> 709                                                                                                          </span>
<span class="-1106201085093865693" onmouseenter="enter('-1106201085093865693');" onmouseout="out('-1106201085093865693');" style=""> 710     protected void ensureStartAndEndSamples(List&lt;ActivitySample&gt; samples, int tsStart, int tsEnd) {      </span>
<span class="-7875576828687087964" onmouseenter="enter('-7875576828687087964');" onmouseout="out('-7875576828687087964');" style=""> 711         if (samples == null || samples.isEmpty()) {                                                      </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 712             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 713         }                                                                                                </span>
<span class="6215771732045184164" onmouseenter="enter('6215771732045184164');" onmouseout="out('6215771732045184164');" style=""> 714         ActivitySample lastSample = samples.get(samples.size() - 1);                                     </span>
<span class="-5724051378546831092" onmouseenter="enter('-5724051378546831092');" onmouseout="out('-5724051378546831092');" style=""> 715         if (lastSample.getTimestamp() &lt; tsEnd) {                                                         </span>
<span class="-340307626157070265" onmouseenter="enter('-340307626157070265');" onmouseout="out('-340307626157070265');" style=""> 716             samples.add(createTrailingActivitySample(lastSample, tsEnd));                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 717         }                                                                                                </span>
<span  style=""> 718                                                                                                          </span>
<span class="-7926496395118744001" onmouseenter="enter('-7926496395118744001');" onmouseout="out('-7926496395118744001');" style=""> 719         ActivitySample firstSample = samples.get(0);                                                     </span>
<span class="-7009339048909230945" onmouseenter="enter('-7009339048909230945');" onmouseout="out('-7009339048909230945');" style=""> 720         if (firstSample.getTimestamp() &gt; tsStart) {                                                      </span>
<span class="-5264575031409257517" onmouseenter="enter('-5264575031409257517');" onmouseout="out('-5264575031409257517');" style=""> 721             samples.add(createTrailingActivitySample(firstSample, tsStart));                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 723     }                                                                                                    </span>
<span  style=""> 724                                                                                                          </span>
<span class="3833670724694452809" onmouseenter="enter('3833670724694452809');" onmouseout="out('3833670724694452809');" style=""> 725     private ActivitySample createTrailingActivitySample(ActivitySample referenceSample, int timestamp) { </span>
<span class="-2046593497045539776" onmouseenter="enter('-2046593497045539776');" onmouseout="out('-2046593497045539776');" style=""> 726         TrailingActivitySample sample = new TrailingActivitySample();                                    </span>
<span class="1247170989116197247" onmouseenter="enter('1247170989116197247');" onmouseout="out('1247170989116197247');" style=""> 727         if (referenceSample instanceof AbstractActivitySample) {                                         </span>
<span class="753416811428354981" onmouseenter="enter('753416811428354981');" onmouseout="out('753416811428354981');" style=""> 728             AbstractActivitySample reference = (AbstractActivitySample) referenceSample;                 </span>
<span class="179894899616756222" onmouseenter="enter('179894899616756222');" onmouseout="out('179894899616756222');" style=""> 729             sample.setUserId(reference.getUserId());                                                     </span>
<span class="-9074495792241680711" onmouseenter="enter('-9074495792241680711');" onmouseout="out('-9074495792241680711');" style=""> 730             sample.setDeviceId(reference.getDeviceId());                                                 </span>
<span class="-9156726696647878603" onmouseenter="enter('-9156726696647878603');" onmouseout="out('-9156726696647878603');" style=""> 731             sample.setProvider(reference.getProvider());                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 732         }                                                                                                </span>
<span class="8993551488058005050" onmouseenter="enter('8993551488058005050');" onmouseout="out('8993551488058005050');" style=""> 733         sample.setTimestamp(timestamp);                                                                  </span>
<span class="1760114423996777276" onmouseenter="enter('1760114423996777276');" onmouseout="out('1760114423996777276');" style=""> 734         return sample;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 735     }                                                                                                    </span>
<span  style=""> 736                                                                                                          </span>
<span class="-1444262751819808388" onmouseenter="enter('-1444262751819808388');" onmouseout="out('-1444262751819808388');" style=""> 737     private int getTSEnd() {                                                                             </span>
<span class="8265537562094819633" onmouseenter="enter('8265537562094819633');" onmouseout="out('8265537562094819633');" style=""> 738         return toTimestamp(getEndDate());                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 739     }                                                                                                    </span>
<span  style=""> 740                                                                                                          </span>
<span class="-8800656553144883662" onmouseenter="enter('-8800656553144883662');" onmouseout="out('-8800656553144883662');" style=""> 741     private int getTSStart() {                                                                           </span>
<span class="-6038622859463971662" onmouseenter="enter('-6038622859463971662');" onmouseout="out('-6038622859463971662');" style=""> 742         return toTimestamp(getStartDate());                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 743     }                                                                                                    </span>
<span  style=""> 744                                                                                                          </span>
<span class="-4614437324300305507" onmouseenter="enter('-4614437324300305507');" onmouseout="out('-4614437324300305507');" style=""> 745     private int toTimestamp(Date date) {                                                                 </span>
<span class="3504665279848614366" onmouseenter="enter('3504665279848614366');" onmouseout="out('3504665279848614366');" style=""> 746         return (int) ((date.getTime() / 1000));                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 747     }                                                                                                    </span>
<span  style=""> 748                                                                                                          </span>
<span class="-4297875969128159092" onmouseenter="enter('-4297875969128159092');" onmouseout="out('-4297875969128159092');" style=""> 749     public static class DefaultChartsData&lt;T extends ChartData&lt;?&gt;&gt; extends ChartsData {                   </span>
<span class="6426673791816913577" onmouseenter="enter('6426673791816913577');" onmouseout="out('6426673791816913577');" style=""> 750         private final T data;                                                                            </span>
<span  style=""> 751                                                                                                          </span>
<span class="-7952082456269420489" onmouseenter="enter('-7952082456269420489');" onmouseout="out('-7952082456269420489');" style=""> 752         private IAxisValueFormatter xValueFormatter;                                                     </span>
<span  style=""> 753                                                                                                          </span>
<span class="6541589990597847820" onmouseenter="enter('6541589990597847820');" onmouseout="out('6541589990597847820');" style=""> 754         public DefaultChartsData(T data, IAxisValueFormatter xValueFormatter) {                          </span>
<span class="5524270510531897998" onmouseenter="enter('5524270510531897998');" onmouseout="out('5524270510531897998');" style=""> 755             this.xValueFormatter = xValueFormatter;                                                      </span>
<span class="6755336779332792903" onmouseenter="enter('6755336779332792903');" onmouseout="out('6755336779332792903');" style=""> 756             this.data = data;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 757         }                                                                                                </span>
<span  style=""> 758                                                                                                          </span>
<span class="-2012372510684410029" onmouseenter="enter('-2012372510684410029');" onmouseout="out('-2012372510684410029');" style=""> 759         public IAxisValueFormatter getXValueFormatter() {                                                </span>
<span class="-7533476322813168520" onmouseenter="enter('-7533476322813168520');" onmouseout="out('-7533476322813168520');" style=""> 760             return xValueFormatter;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 761         }                                                                                                </span>
<span  style=""> 762                                                                                                          </span>
<span class="5384784438887663423" onmouseenter="enter('5384784438887663423');" onmouseout="out('5384784438887663423');" style=""> 763         public T getData() {                                                                             </span>
<span class="2885311051796901480" onmouseenter="enter('2885311051796901480');" onmouseout="out('2885311051796901480');" style=""> 764             return data;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 765         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 766     }                                                                                                    </span>
<span  style=""> 767                                                                                                          </span>
<span class="1326180124040264963" onmouseenter="enter('1326180124040264963');" onmouseout="out('1326180124040264963');" style=""> 768     protected static class SampleXLabelFormatter implements IAxisValueFormatter {                        </span>
<span class="5353010427567723059" onmouseenter="enter('5353010427567723059');" onmouseout="out('5353010427567723059');" style=""> 769         private final TimestampTranslation tsTranslation;                                                </span>
<span  style=""> 770                                                                                                          </span>
<span class="-3636759102507942125" onmouseenter="enter('-3636759102507942125');" onmouseout="out('-3636759102507942125');" style=""> 771         SimpleDateFormat annotationDateFormat = new SimpleDateFormat(&quot;HH:mm&quot;);                           </span>
<span  style=""> 772                                                                                                          </span>
<span class="-216001982063807608" onmouseenter="enter('-216001982063807608');" onmouseout="out('-216001982063807608');" style=""> 773         // SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd.MM.yyyy HH:mm&quot;);                       </span>
<span class="4878211627103907492" onmouseenter="enter('4878211627103907492');" onmouseout="out('4878211627103907492');" style=""> 774         Calendar cal = GregorianCalendar.getInstance();                                                  </span>
<span  style=""> 775                                                                                                          </span>
<span class="5120004681237147878" onmouseenter="enter('5120004681237147878');" onmouseout="out('5120004681237147878');" style=""> 776         public SampleXLabelFormatter(TimestampTranslation tsTranslation) {                               </span>
<span class="332289991409172359" onmouseenter="enter('332289991409172359');" onmouseout="out('332289991409172359');" style=""> 777             this.tsTranslation = tsTranslation;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 778         }                                                                                                </span>
<span  style=""> 779                                                                                                          </span>
<span class="9166492997131092423" onmouseenter="enter('9166492997131092423');" onmouseout="out('9166492997131092423');" style=""> 780         // TODO: this does not work. Cannot use precomputed labels                                       </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 781         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 782         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="7424853438265862645" onmouseenter="enter('7424853438265862645');" onmouseout="out('7424853438265862645');" style=""> 783             cal.clear();                                                                                 </span>
<span class="-8512964187988968344" onmouseenter="enter('-8512964187988968344');" onmouseout="out('-8512964187988968344');" style=""> 784             int ts = ((int) (value));                                                                    </span>
<span class="-2120013244284691976" onmouseenter="enter('-2120013244284691976');" onmouseout="out('-2120013244284691976');" style=""> 785             cal.setTimeInMillis(tsTranslation.toOriginalValue(ts) * 1000L);                              </span>
<span class="-5878359517855184171" onmouseenter="enter('-5878359517855184171');" onmouseout="out('-5878359517855184171');" style=""> 786             Date date = cal.getTime();                                                                   </span>
<span class="-2286280998074804817" onmouseenter="enter('-2286280998074804817');" onmouseout="out('-2286280998074804817');" style=""> 787             String dateString = annotationDateFormat.format(date);                                       </span>
<span class="-4331225868129427907" onmouseenter="enter('-4331225868129427907');" onmouseout="out('-4331225868129427907');" style=""> 788             return dateString;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 789         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 790     }                                                                                                    </span>
<span  style=""> 791                                                                                                          </span>
<span class="853591074258071334" onmouseenter="enter('853591074258071334');" onmouseout="out('853591074258071334');" style=""> 792     protected static class PreformattedXIndexLabelFormatter implements IAxisValueFormatter {             </span>
<span class="-5932642099782009782" onmouseenter="enter('-5932642099782009782');" onmouseout="out('-5932642099782009782');" style=""> 793         private ArrayList&lt;String&gt; xLabels;                                                               </span>
<span  style=""> 794                                                                                                          </span>
<span class="-3496008191511610310" onmouseenter="enter('-3496008191511610310');" onmouseout="out('-3496008191511610310');" style=""> 795         public PreformattedXIndexLabelFormatter(ArrayList&lt;String&gt; xLabels) {                             </span>
<span class="1925102162908705801" onmouseenter="enter('1925102162908705801');" onmouseout="out('1925102162908705801');" style=""> 796             this.xLabels = xLabels;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 797         }                                                                                                </span>
<span  style=""> 798                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 799         @Override                                                                                        </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 800         public String getFormattedValue(float value, AxisBase axis) {                                    </span>
<span class="7790720350407836859" onmouseenter="enter('7790720350407836859');" onmouseout="out('7790720350407836859');" style=""> 801             int index = ((int) (value));                                                                 </span>
<span class="8128729922219691041" onmouseenter="enter('8128729922219691041');" onmouseout="out('8128729922219691041');" style=""> 802             if ((xLabels == null) || (index &gt;= xLabels.size())) {                                        </span>
<span class="-889824612483989703" onmouseenter="enter('-889824612483989703');" onmouseout="out('-889824612483989703');" style=""> 803                 return String.valueOf(value);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804             }                                                                                            </span>
<span class="-5802960474501370558" onmouseenter="enter('-5802960474501370558');" onmouseout="out('-5802960474501370558');" style=""> 805             return xLabels.get(index);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 806         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 807     }                                                                                                    </span>
<span  style=""> 808                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 809     /**                                                                                                  </span>
<span class="6592799195109599568" onmouseenter="enter('6592799195109599568');" onmouseout="out('6592799195109599568');" style=""> 810      * Awkward class that helps in translating long timestamp                                            </span>
<span class="-2647406073998843607" onmouseenter="enter('-2647406073998843607');" onmouseout="out('-2647406073998843607');" style=""> 811      * values to float (sic!) values. It basically rebases all                                           </span>
<span class="-6950802996886985644" onmouseenter="enter('-6950802996886985644');" onmouseout="out('-6950802996886985644');" style=""> 812      * timestamps to a base (the very first) timestamp value.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 813      *                                                                                                   </span>
<span class="467771366063509856" onmouseenter="enter('467771366063509856');" onmouseout="out('467771366063509856');" style=""> 814      * It does this so that the large timestamp values can be used                                       </span>
<span class="-3960902832668220629" onmouseenter="enter('-3960902832668220629');" onmouseout="out('-3960902832668220629');" style=""> 815      * floating point values, where the mantissa is just 24 bits.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 816      */                                                                                                  </span>
<span class="3353052654588926596" onmouseenter="enter('3353052654588926596');" onmouseout="out('3353052654588926596');" style=""> 817     protected static class TimestampTranslation {                                                        </span>
<span class="-8324695427159884252" onmouseenter="enter('-8324695427159884252');" onmouseout="out('-8324695427159884252');" style=""> 818         private int tsOffset = -1;                                                                       </span>
<span  style=""> 819                                                                                                          </span>
<span class="-2038703014401681062" onmouseenter="enter('-2038703014401681062');" onmouseout="out('-2038703014401681062');" style=""> 820         public int shorten(int timestamp) {                                                              </span>
<span class="-913901670341057281" onmouseenter="enter('-913901670341057281');" onmouseout="out('-913901670341057281');" style=""> 821             if (tsOffset == (-1)) {                                                                      </span>
<span class="5713941682084663603" onmouseenter="enter('5713941682084663603');" onmouseout="out('5713941682084663603');" style=""> 822                 tsOffset = timestamp;                                                                    </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 823                 return 0;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 824             }                                                                                            </span>
<span class="-455923503597890370" onmouseenter="enter('-455923503597890370');" onmouseout="out('-455923503597890370');" style=""> 825             return timestamp - tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 826         }                                                                                                </span>
<span  style=""> 827                                                                                                          </span>
<span class="-7013677261634300092" onmouseenter="enter('-7013677261634300092');" onmouseout="out('-7013677261634300092');" style=""> 828         public int toOriginalValue(int timestamp) {                                                      </span>
<span class="-913901670341057281" onmouseenter="enter('-913901670341057281');" onmouseout="out('-913901670341057281');" style=""> 829             if (tsOffset == (-1)) {                                                                      </span>
<span class="-3020799636637211745" onmouseenter="enter('-3020799636637211745');" onmouseout="out('-3020799636637211745');" style=""> 830                 return timestamp;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 831             }                                                                                            </span>
<span class="-7912123621537489577" onmouseenter="enter('-7912123621537489577');" onmouseout="out('-7912123621537489577');" style=""> 832             return timestamp + tsOffset;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 833         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 834     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 835 }                                                                                                        </span>






</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="8232473818974975943" onmouseenter="enter('8232473818974975943');" onmouseout="out('8232473818974975943');" style="">   1  /*  Copyright (C) 2015-2017 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                            </span>

<span class="2448951400902124304" onmouseenter="enter('2448951400902124304');" onmouseout="out('2448951400902124304');" style="">   2      Daniele Gobbetti, walkjivefly                                                                                 </span>
<span  style="">   3                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   5                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9      (at your option) any later version.                                                                           </span>
<span  style="">  10                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  15                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="8669690300131154388" onmouseenter="enter('8669690300131154388');" onmouseout="out('8669690300131154388');" style="">  18  package nodomain.freeyourgadget.gadgetbridge.activities.charts;                                                   </span>
<span  style="">  19                                                                                                                    </span>
<span class="-489389385851058391" onmouseenter="enter('-489389385851058391');" onmouseout="out('-489389385851058391');" style="">  20  import android.content.BroadcastReceiver;                                                                         </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  21  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  22  import android.content.Intent;                                                                                    </span>
<span class="8697221465021235869" onmouseenter="enter('8697221465021235869');" onmouseout="out('8697221465021235869');" style="">  23  import android.content.IntentFilter;                                                                              </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  24  import android.os.AsyncTask;                                                                                      </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  25  import android.os.Bundle;                                                                                         </span>
<span class="4394652512097310678" onmouseenter="enter('4394652512097310678');" onmouseout="out('4394652512097310678');" style="">  26  import android.support.annotation.Nullable;                                                                       </span>
<span class="5561867782528330628" onmouseenter="enter('5561867782528330628');" onmouseout="out('5561867782528330628');" style="">  27  import android.support.v4.app.FragmentActivity;                                                                   </span>
<span class="-3586823955743508894" onmouseenter="enter('-3586823955743508894');" onmouseout="out('-3586823955743508894');" style="">  28  import android.support.v4.content.ContextCompat;                                                                  </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  29  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  30  import android.util.TypedValue;                                                                                   </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  31  import android.view.View;                                                                                         </span>
<span  style="">  32                                                                                                                    </span>
<span class="2052752975691556393" onmouseenter="enter('2052752975691556393');" onmouseout="out('2052752975691556393');" style="">  33  import com.github.mikephil.charting.charts.BarChart;                                                              </span>
<span class="-7530008699315861247" onmouseenter="enter('-7530008699315861247');" onmouseout="out('-7530008699315861247');" style="">  34  import com.github.mikephil.charting.charts.BarLineChartBase;                                                      </span>
<span class="-2340851656771232402" onmouseenter="enter('-2340851656771232402');" onmouseout="out('-2340851656771232402');" style="">  35  import com.github.mikephil.charting.charts.Chart;                                                                 </span>
<span class="1306294111757562979" onmouseenter="enter('1306294111757562979');" onmouseout="out('1306294111757562979');" style="">  36  import com.github.mikephil.charting.components.AxisBase;                                                          </span>
<span class="-968159151538268968" onmouseenter="enter('-968159151538268968');" onmouseout="out('-968159151538268968');" style="">  37  import com.github.mikephil.charting.components.YAxis;                                                             </span>
<span class="4145381455536678498" onmouseenter="enter('4145381455536678498');" onmouseout="out('4145381455536678498');" style="">  38  import com.github.mikephil.charting.data.ChartData;                                                               </span>
<span class="-6979157771929244358" onmouseenter="enter('-6979157771929244358');" onmouseout="out('-6979157771929244358');" style="">  39  import com.github.mikephil.charting.data.Entry;                                                                   </span>
<span class="-1647496247863422182" onmouseenter="enter('-1647496247863422182');" onmouseout="out('-1647496247863422182');" style="">  40  import com.github.mikephil.charting.data.LineData;                                                                </span>
<span class="-2418175485781437143" onmouseenter="enter('-2418175485781437143');" onmouseout="out('-2418175485781437143');" style="">  41  import com.github.mikephil.charting.data.LineDataSet;                                                             </span>
<span class="5272555707203763230" onmouseenter="enter('5272555707203763230');" onmouseout="out('5272555707203763230');" style="">  42  import com.github.mikephil.charting.formatter.IAxisValueFormatter;                                                </span>
<span class="2256452517983808356" onmouseenter="enter('2256452517983808356');" onmouseout="out('2256452517983808356');" style="">  43  import com.github.mikephil.charting.interfaces.datasets.ILineDataSet;                                             </span>
<span  style="">  44                                                                                                                    </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  45  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  46  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  47                                                                                                                    </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  48  import java.text.SimpleDateFormat;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  49  import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  50  import java.util.Arrays;                                                                                          </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  51  import java.util.Calendar;                                                                                        </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  52  import java.util.Date;                                                                                            </span>
<span class="-4685965902094386510" onmouseenter="enter('-4685965902094386510');" onmouseout="out('-4685965902094386510');" style="">  53  import java.util.GregorianCalendar;                                                                               </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  54  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  55  import java.util.List;                                                                                            </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  56  import java.util.Set;                                                                                             </span>
<span  style="">  57                                                                                                                    </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  58  import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                                        </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.R;                                                                    </span>
<span class="5401974517372835423" onmouseenter="enter('5401974517372835423');" onmouseout="out('5401974517372835423');" style="">  60  import nodomain.freeyourgadget.gadgetbridge.activities.AbstractGBFragment;                                        </span>
<span class="-7512545990884107322" onmouseenter="enter('-7512545990884107322');" onmouseout="out('-7512545990884107322');" style="">  61  import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;                                            </span>
<span class="-7899456532042317044" onmouseenter="enter('-7899456532042317044');" onmouseout="out('-7899456532042317044');" style="">  62  import nodomain.freeyourgadget.gadgetbridge.database.DBAccess;                                                    </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  63  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="6852267181356803593" onmouseenter="enter('6852267181356803593');" onmouseout="out('6852267181356803593');" style="">  64  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;                                            </span>
<span class="-4858662006453759829" onmouseenter="enter('-4858662006453759829');" onmouseout="out('-4858662006453759829');" style="">  65  import nodomain.freeyourgadget.gadgetbridge.devices.SampleProvider;                                               </span>
<span class="6164643418103516215" onmouseenter="enter('6164643418103516215');" onmouseout="out('6164643418103516215');" style="">  66  import nodomain.freeyourgadget.gadgetbridge.entities.AbstractActivitySample;                                      </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  67  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="5185434099904652174" onmouseenter="enter('5185434099904652174');" onmouseout="out('5185434099904652174');" style="">  68  import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind;                                                   </span>
<span class="-4763610359710127205" onmouseenter="enter('-4763610359710127205');" onmouseout="out('-4763610359710127205');" style="">  69  import nodomain.freeyourgadget.gadgetbridge.model.ActivitySample;                                                 </span>
<span class="-904534361809820117" onmouseenter="enter('-904534361809820117');" onmouseout="out('-904534361809820117');" style="">  70  import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils;                                                   </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  71  import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                                    </span>
<span  style="">  72                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  73  /**                                                                                                               </span>
<span class="4382979016472627606" onmouseenter="enter('4382979016472627606');" onmouseout="out('4382979016472627606');" style="">  74   * A base class fragment to be used with ChartsActivity. The fragment can supply                                  </span>
<span class="6198461617436424812" onmouseenter="enter('6198461617436424812');" onmouseout="out('6198461617436424812');" style="">  75   * a title to be displayed in the activity by returning non-null in #getTitle()                                   </span>
<span class="-6728528830408447290" onmouseenter="enter('-6728528830408447290');" onmouseout="out('-6728528830408447290');" style="">  76   * Broadcast events can be received by overriding #onReceive(Context,Intent).                                     </span>
<span class="-8995811574793439040" onmouseenter="enter('-8995811574793439040');" onmouseout="out('-8995811574793439040');" style="">  77   * The chart can be refreshed by calling #refresh()                                                               </span>
<span class="7522934711128650596" onmouseenter="enter('7522934711128650596');" onmouseout="out('7522934711128650596');" style="">  78   * Implement refreshInBackground(DBHandler, GBDevice) to fetch the samples from the DB,                           </span>
<span class="-6728676085228773380" onmouseenter="enter('-6728676085228773380');" onmouseout="out('-6728676085228773380');" style="">  79   * and add the samples to the chart. The actual rendering, which must be performed in the UI                      </span>
<span class="-8407485021089725057" onmouseenter="enter('-8407485021089725057');" onmouseout="out('-8407485021089725057');" style="">  80   * thread, must be done in #renderCharts().                                                                       </span>
<span class="-4722043031183050825" onmouseenter="enter('-4722043031183050825');" onmouseout="out('-4722043031183050825');" style="">  81   * Access functionality of the hosting activity with #getHost()                                                   </span>
<span class="4294780129258405519" onmouseenter="enter('4294780129258405519');" onmouseout="out('4294780129258405519');" style="">  82   * &lt;p/&gt;                                                                                                           </span>
<span class="4386326732920470462" onmouseenter="enter('4386326732920470462');" onmouseout="out('4386326732920470462');" style="">  83   * The hosting ChartsHost activity provides a section for displaying a date or date range                         </span>
<span class="6958843947366179987" onmouseenter="enter('6958843947366179987');" onmouseout="out('6958843947366179987');" style="">  84   * being the basis for the chart, as well as two buttons for moving backwards and forward                         </span>
<span class="2417558347604794742" onmouseenter="enter('2417558347604794742');" onmouseout="out('2417558347604794742');" style="">  85   * in time. The date is held by the activity, so that it can be shared by multiple chart                          </span>
<span class="7607748487874207999" onmouseenter="enter('7607748487874207999');" onmouseout="out('7607748487874207999');" style="">  86   * fragments. It is still the responsibility of the (currently visible) chart fragment                            </span>
<span class="-3870094542515027002" onmouseenter="enter('-3870094542515027002');" onmouseout="out('-3870094542515027002');" style="">  87   * to set the desired date in the ChartsActivity via #setDateRange(Date,Date).                                    </span>
<span class="3680713202748276357" onmouseenter="enter('3680713202748276357');" onmouseout="out('3680713202748276357');" style="">  88   * The default implementations #handleDatePrev(Date,Date) and #handleDateNext(Date,Date)                          </span>
<span class="-222466413472697410" onmouseenter="enter('-222466413472697410');" onmouseout="out('-222466413472697410');" style="">  89   * shift the date by one day.                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90   */                                                                                                               </span>
<span class="559507359319980575" onmouseenter="enter('559507359319980575');" onmouseout="out('559507359319980575');" style="">  91  public abstract class AbstractChartFragment extends AbstractGBFragment {                                          </span>
<span class="-5476773025248141464" onmouseenter="enter('-5476773025248141464');" onmouseout="out('-5476773025248141464');" style="">  92      protected final int ANIM_TIME = 250;                                                                          </span>
<span  style="">  93                                                                                                                    </span>
<span class="2603683647820710396" onmouseenter="enter('2603683647820710396');" onmouseout="out('2603683647820710396');" style="">  94      private static final Logger LOG = LoggerFactory.getLogger(AbstractChartFragment.class);                       </span>
<span  style="">  95                                                                                                                    </span>
<span class="-7304707645666720924" onmouseenter="enter('-7304707645666720924');" onmouseout="out('-7304707645666720924');" style="">  96      private final Set&lt;String&gt; mIntentFilterActions;                                                               </span>
<span class="4625474178666977899" onmouseenter="enter('4625474178666977899');" onmouseout="out('4625474178666977899');" style="">  97      private final BroadcastReceiver mReceiver = new BroadcastReceiver() {                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  98          @Override                                                                                                 </span>
<span class="-1520739091809898546" onmouseenter="enter('-1520739091809898546');" onmouseout="out('-1520739091809898546');" style="">  99          public void onReceive(Context context, Intent intent) {                                                   </span>
<span class="1765483774466236680" onmouseenter="enter('1765483774466236680');" onmouseout="out('1765483774466236680');" style=""> 100              AbstractChartFragment.this.onReceive(context, intent);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 102      };                                                                                                            </span>
<span class="-5489121822050726001" onmouseenter="enter('-5489121822050726001');" onmouseout="out('-5489121822050726001');" style=""> 103      private boolean mChartDirty = true;                                                                           </span>
<span class="-5677382414532787847" onmouseenter="enter('-5677382414532787847');" onmouseout="out('-5677382414532787847');" style=""> 104      private AsyncTask refreshTask;                                                                                </span>
<span  style=""> 105                                                                                                                    </span>
<span class="-4343134957952038703" onmouseenter="enter('-4343134957952038703');" onmouseout="out('-4343134957952038703');" style=""> 106      public boolean isChartDirty() {                                                                               </span>
<span class="-2572162510293790028" onmouseenter="enter('-2572162510293790028');" onmouseout="out('-2572162510293790028');" style=""> 107          return mChartDirty;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108      }                                                                                                             </span>
<span  style=""> 109                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110      @Override                                                                                                     </span>
<span class="-601773936482381085" onmouseenter="enter('-601773936482381085');" onmouseout="out('-601773936482381085');" style=""> 111      public abstract String getTitle();                                                                            </span>
<span  style=""> 112                                                                                                                    </span>
<span class="-6644558066866151773" onmouseenter="enter('-6644558066866151773');" onmouseout="out('-6644558066866151773');" style=""> 113      public boolean supportsHeartrate(GBDevice device) {                                                           </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 114          DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);                        </span>
<span class="-7840206560907481536" onmouseenter="enter('-7840206560907481536');" onmouseout="out('-7840206560907481536');" style=""> 115          return coordinator != null &amp;&amp; coordinator.supportsHeartRateMeasurement(device);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116      }                                                                                                             </span>
<span  style=""> 117                                                                                                                    </span>
<span class="-8993184091203127788" onmouseenter="enter('-8993184091203127788');" onmouseout="out('-8993184091203127788');" style=""> 118      protected static final class ActivityConfig {                                                                 </span>
<span class="-6704927139853267025" onmouseenter="enter('-6704927139853267025');" onmouseout="out('-6704927139853267025');" style=""> 119          public final int type;                                                                                    </span>
<span class="8777140454183587055" onmouseenter="enter('8777140454183587055');" onmouseout="out('8777140454183587055');" style=""> 120          public final String label;                                                                                </span>
<span class="-5618013352645865591" onmouseenter="enter('-5618013352645865591');" onmouseout="out('-5618013352645865591');" style=""> 121          public final Integer color;                                                                               </span>
<span  style=""> 122                                                                                                                    </span>
<span class="-5628392649151863187" onmouseenter="enter('-5628392649151863187');" onmouseout="out('-5628392649151863187');" style=""> 123          public ActivityConfig(int kind, String label, Integer color) {                                            </span>
<span class="-7354691670901086033" onmouseenter="enter('-7354691670901086033');" onmouseout="out('-7354691670901086033');" style=""> 124              this.type = kind;                                                                                     </span>
<span class="-6752321514731327997" onmouseenter="enter('-6752321514731327997');" onmouseout="out('-6752321514731327997');" style=""> 125              this.label = label;                                                                                   </span>
<span class="-589508620284177092" onmouseenter="enter('-589508620284177092');" onmouseout="out('-589508620284177092');" style=""> 126              this.color = color;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128      }                                                                                                             </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-727072152722713884" onmouseenter="enter('-727072152722713884');" onmouseout="out('-727072152722713884');" style=""> 130      protected ActivityConfig akActivity;                                                                          </span>
<span class="1693165293269506698" onmouseenter="enter('1693165293269506698');" onmouseout="out('1693165293269506698');" style=""> 131      protected ActivityConfig akLightSleep;                                                                        </span>
<span class="1060880569004609468" onmouseenter="enter('1060880569004609468');" onmouseout="out('1060880569004609468');" style=""> 132      protected ActivityConfig akDeepSleep;                                                                         </span>
<span class="-4297327045522896814" onmouseenter="enter('-4297327045522896814');" onmouseout="out('-4297327045522896814');" style=""> 133      protected ActivityConfig akNotWorn;                                                                           </span>
<span  style=""> 134                                                                                                                    </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-1563135362317192224" onmouseenter="enter('-1563135362317192224');" onmouseout="out('-1563135362317192224');" style=""> 136      protected int BACKGROUND_COLOR;                                                                               </span>
<span class="4601305514601887958" onmouseenter="enter('4601305514601887958');" onmouseout="out('4601305514601887958');" style=""> 137      protected int DESCRIPTION_COLOR;                                                                              </span>
<span class="-3468694148212670828" onmouseenter="enter('-3468694148212670828');" onmouseout="out('-3468694148212670828');" style=""> 138      protected int CHART_TEXT_COLOR;                                                                               </span>
<span class="655929690321793162" onmouseenter="enter('655929690321793162');" onmouseout="out('655929690321793162');" style=""> 139      protected int LEGEND_TEXT_COLOR;                                                                              </span>
<span class="-6693974409973768071" onmouseenter="enter('-6693974409973768071');" onmouseout="out('-6693974409973768071');" style=""> 140      protected int HEARTRATE_COLOR;                                                                                </span>
<span class="7021362809515932268" onmouseenter="enter('7021362809515932268');" onmouseout="out('7021362809515932268');" style=""> 141      protected int HEARTRATE_FILL_COLOR;                                                                           </span>
<span class="-4670234814499331326" onmouseenter="enter('-4670234814499331326');" onmouseout="out('-4670234814499331326');" style=""> 142      protected int AK_ACTIVITY_COLOR;                                                                              </span>
<span class="-5660897269888657930" onmouseenter="enter('-5660897269888657930');" onmouseout="out('-5660897269888657930');" style=""> 143      protected int AK_DEEP_SLEEP_COLOR;                                                                            </span>
<span class="-91394691221270038" onmouseenter="enter('-91394691221270038');" onmouseout="out('-91394691221270038');" style=""> 144      protected int AK_LIGHT_SLEEP_COLOR;                                                                           </span>
<span class="1634608154221638802" onmouseenter="enter('1634608154221638802');" onmouseout="out('1634608154221638802');" style=""> 145      protected int AK_NOT_WORN_COLOR;                                                                              </span>
<span  style=""> 146                                                                                                                    </span>
<span class="-1398408580326282750" onmouseenter="enter('-1398408580326282750');" onmouseout="out('-1398408580326282750');" style=""> 147      protected String HEARTRATE_LABEL;                                                                             </span>
<span  style=""> 148                                                                                                                    </span>
<span class="-2100943369183848946" onmouseenter="enter('-2100943369183848946');" onmouseout="out('-2100943369183848946');" style=""> 149      protected AbstractChartFragment(String... intentFilterActions) {                                              </span>
<span class="4300273923814153332" onmouseenter="enter('4300273923814153332');" onmouseout="out('4300273923814153332');" style=""> 150          mIntentFilterActions = new HashSet&lt;&gt;();                                                                   </span>
<span class="1794017280726845715" onmouseenter="enter('1794017280726845715');" onmouseout="out('1794017280726845715');" style=""> 151          if (intentFilterActions != null) {                                                                        </span>
<span class="-5245442559338563943" onmouseenter="enter('-5245442559338563943');" onmouseout="out('-5245442559338563943');" style=""> 152              mIntentFilterActions.addAll(Arrays.asList(intentFilterActions));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153          }                                                                                                         </span>
<span class="-8699894582101860078" onmouseenter="enter('-8699894582101860078');" onmouseout="out('-8699894582101860078');" style=""> 154          mIntentFilterActions.add(ChartsHost.DATE_NEXT);                                                           </span>
<span class="6561361583014083383" onmouseenter="enter('6561361583014083383');" onmouseout="out('6561361583014083383');" style=""> 155          mIntentFilterActions.add(ChartsHost.DATE_PREV);                                                           </span>
<span class="775005401617860596" onmouseenter="enter('775005401617860596');" onmouseout="out('775005401617860596');" style=""> 156          mIntentFilterActions.add(ChartsHost.REFRESH);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157      }                                                                                                             </span>
<span  style=""> 158                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 159      @Override                                                                                                     </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 160      public void onCreate(Bundle savedInstanceState) {                                                             </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 161          super.onCreate(savedInstanceState);                                                                       </span>
<span  style=""> 162                                                                                                                    </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 163          init();                                                                                                   </span>
<span  style=""> 164                                                                                                                    </span>
<span class="1309295186849327913" onmouseenter="enter('1309295186849327913');" onmouseout="out('1309295186849327913');" style=""> 165          IntentFilter filter = new IntentFilter();                                                                 </span>
<span class="6467646639596248655" onmouseenter="enter('6467646639596248655');" onmouseout="out('6467646639596248655');" style=""> 166          for (String action : mIntentFilterActions) {                                                              </span>
<span class="-2086107330814500487" onmouseenter="enter('-2086107330814500487');" onmouseout="out('-2086107330814500487');" style=""> 167              filter.addAction(action);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 168          }                                                                                                         </span>
<span class="3395895708962590803" onmouseenter="enter('3395895708962590803');" onmouseout="out('3395895708962590803');" style=""> 169          LocalBroadcastManager.getInstance(getActivity()).registerReceiver(mReceiver, filter);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170      }                                                                                                             </span>
<span  style=""> 171                                                                                                                    </span>
<span class="-2182533896997661648" onmouseenter="enter('-2182533896997661648');" onmouseout="out('-2182533896997661648');" style=""> 172      protected void init() {                                                                                       </span>
<span class="-4278963507477628649" onmouseenter="enter('-4278963507477628649');" onmouseout="out('-4278963507477628649');" style=""> 173          TypedValue runningColor = new TypedValue();                                                               </span>
<span class="2364262805070128994" onmouseenter="enter('2364262805070128994');" onmouseout="out('2364262805070128994');" style=""> 174          BACKGROUND_COLOR = GBApplication.getBackgroundColor(getContext());                                        </span>
<span class="4636662852620032981" onmouseenter="enter('4636662852620032981');" onmouseout="out('4636662852620032981');" style=""> 175          LEGEND_TEXT_COLOR = DESCRIPTION_COLOR = GBApplication.getTextColor(getContext());                         </span>
<span class="7979803013168270964" onmouseenter="enter('7979803013168270964');" onmouseout="out('7979803013168270964');" style=""> 176          CHART_TEXT_COLOR = ContextCompat.getColor(getContext(), R.color.secondarytext);                           </span>
<span class="-5448842132740870532" onmouseenter="enter('-5448842132740870532');" onmouseout="out('-5448842132740870532');" style=""> 177          HEARTRATE_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate);                          </span>
<span class="3818219289719008809" onmouseenter="enter('3818219289719008809');" onmouseout="out('3818219289719008809');" style=""> 178          HEARTRATE_FILL_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate_fill);                </span>
<span class="-658032213271338857" onmouseenter="enter('-658032213271338857');" onmouseout="out('-658032213271338857');" style=""> 179          getContext().getTheme().resolveAttribute(R.attr.chart_activity, runningColor, true);                      </span>
<span class="3784973835189342522" onmouseenter="enter('3784973835189342522');" onmouseout="out('3784973835189342522');" style=""> 180          AK_ACTIVITY_COLOR = runningColor.data;                                                                    </span>
<span class="-7347375883805936743" onmouseenter="enter('-7347375883805936743');" onmouseout="out('-7347375883805936743');" style=""> 181          getContext().getTheme().resolveAttribute(R.attr.chart_deep_sleep, runningColor, true);                    </span>
<span class="9138233377044964354" onmouseenter="enter('9138233377044964354');" onmouseout="out('9138233377044964354');" style=""> 182          AK_DEEP_SLEEP_COLOR = runningColor.data;                                                                  </span>
<span class="-7879866390823759405" onmouseenter="enter('-7879866390823759405');" onmouseout="out('-7879866390823759405');" style=""> 183          getContext().getTheme().resolveAttribute(R.attr.chart_light_sleep, runningColor, true);                   </span>
<span class="-7375963623584937470" onmouseenter="enter('-7375963623584937470');" onmouseout="out('-7375963623584937470');" style=""> 184          AK_LIGHT_SLEEP_COLOR = runningColor.data;                                                                 </span>
<span class="-4015774126818841529" onmouseenter="enter('-4015774126818841529');" onmouseout="out('-4015774126818841529');" style=""> 185          getContext().getTheme().resolveAttribute(R.attr.chart_not_worn, runningColor, true);                      </span>
<span class="-5596972182818856924" onmouseenter="enter('-5596972182818856924');" onmouseout="out('-5596972182818856924');" style=""> 186          AK_NOT_WORN_COLOR = runningColor.data;                                                                    </span>
<span  style=""> 187                                                                                                                    </span>
<span class="-8151372900676559714" onmouseenter="enter('-8151372900676559714');" onmouseout="out('-8151372900676559714');" style=""> 188          HEARTRATE_LABEL = getContext().getString(R.string.charts_legend_heartrate);                               </span>
<span  style=""> 189                                                                                                                    </span>
<span class="7336078921795716816" onmouseenter="enter('7336078921795716816');" onmouseout="out('7336078921795716816');" style=""><abbr title=" 190          akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kind_activity), AK_ACTIVITY_COLOR);"> 190          akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kinðŸ”µ</abbr></span>
<span class="7421775491088103388" onmouseenter="enter('7421775491088103388');" onmouseout="out('7421775491088103388');" style=""><abbr title=" 191          akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragment_kind_light_sleep), AK_LIGHT_SLEEP_COLOR);"> 191          akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragmenðŸ”µ</abbr></span>
<span class="-7577615369032967062" onmouseenter="enter('-7577615369032967062');" onmouseout="out('-7577615369032967062');" style=""><abbr title=" 192          akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_kind_deep_sleep), AK_DEEP_SLEEP_COLOR);"> 192          akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_ðŸ”µ</abbr></span>
<span class="4963911460392329978" onmouseenter="enter('4963911460392329978');" onmouseout="out('4963911460392329978');" style=""><abbr title=" 193          akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kind_not_worn), AK_NOT_WORN_COLOR);"> 193          akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kindðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194      }                                                                                                             </span>
<span  style=""> 195                                                                                                                    </span>
<span class="-495990486128602071" onmouseenter="enter('-495990486128602071');" onmouseout="out('-495990486128602071');" style=""> 196      private void setStartDate(Date date) {                                                                        </span>
<span class="-1228970384434949212" onmouseenter="enter('-1228970384434949212');" onmouseout="out('-1228970384434949212');" style=""> 197          getChartsHost().setStartDate(date);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198      }                                                                                                             </span>
<span  style=""> 199                                                                                                                    </span>
<span class="2390100272250745956" onmouseenter="enter('2390100272250745956');" onmouseout="out('2390100272250745956');" style=""> 200      @Nullable                                                                                                     </span>
<span class="3611118571382248517" onmouseenter="enter('3611118571382248517');" onmouseout="out('3611118571382248517');" style=""> 201      protected ChartsHost getChartsHost() {                                                                        </span>
<span class="2661597057438137706" onmouseenter="enter('2661597057438137706');" onmouseout="out('2661597057438137706');" style=""> 202          return (ChartsHost) getActivity();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203      }                                                                                                             </span>
<span  style=""> 204                                                                                                                    </span>
<span class="-1308916602749590522" onmouseenter="enter('-1308916602749590522');" onmouseout="out('-1308916602749590522');" style=""> 205      private void setEndDate(Date date) {                                                                          </span>
<span class="-3659353165994754543" onmouseenter="enter('-3659353165994754543');" onmouseout="out('-3659353165994754543');" style=""> 206          getChartsHost().setEndDate(date);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207      }                                                                                                             </span>
<span  style=""> 208                                                                                                                    </span>
<span class="-2894059945991900133" onmouseenter="enter('-2894059945991900133');" onmouseout="out('-2894059945991900133');" style=""> 209      public Date getStartDate() {                                                                                  </span>
<span class="8926139361389921832" onmouseenter="enter('8926139361389921832');" onmouseout="out('8926139361389921832');" style=""> 210          return getChartsHost().getStartDate();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211      }                                                                                                             </span>
<span  style=""> 212                                                                                                                    </span>
<span class="2846153489913780034" onmouseenter="enter('2846153489913780034');" onmouseout="out('2846153489913780034');" style=""> 213      public Date getEndDate() {                                                                                    </span>
<span class="7835534291730041186" onmouseenter="enter('7835534291730041186');" onmouseout="out('7835534291730041186');" style=""> 214          return getChartsHost().getEndDate();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215      }                                                                                                             </span>
<span  style=""> 216                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 217      /**                                                                                                           </span>
<span class="3608187799695399223" onmouseenter="enter('3608187799695399223');" onmouseout="out('3608187799695399223');" style=""> 218       * Called when this fragment has been fully scrolled into the activity.                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 219       *                                                                                                            </span>
<span class="-6064668654679903662" onmouseenter="enter('-6064668654679903662');" onmouseout="out('-6064668654679903662');" style=""> 220       * @see #isVisibleInActivity()                                                                                </span>
<span class="-4201783166293447700" onmouseenter="enter('-4201783166293447700');" onmouseout="out('-4201783166293447700');" style=""> 221       * @see #onMadeInvisibleInActivity()                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 222       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 223      @Override                                                                                                     </span>
<span class="-7073731466333062745" onmouseenter="enter('-7073731466333062745');" onmouseout="out('-7073731466333062745');" style=""> 224      protected void onMadeVisibleInActivity() {                                                                    </span>
<span class="-2940429388425730341" onmouseenter="enter('-2940429388425730341');" onmouseout="out('-2940429388425730341');" style=""> 225          super.onMadeVisibleInActivity();                                                                          </span>
<span class="4333568825348773807" onmouseenter="enter('4333568825348773807');" onmouseout="out('4333568825348773807');" style=""> 226          showDateBar(true);                                                                                        </span>
<span class="371374127972335382" onmouseenter="enter('371374127972335382');" onmouseout="out('371374127972335382');" style=""> 227          if (isChartDirty()) {                                                                                     </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 228              refresh();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="-2587903292449818582" onmouseenter="enter('-2587903292449818582');" onmouseout="out('-2587903292449818582');" style=""> 232      protected void showDateBar(boolean show) {                                                                    </span>
<span class="1102668729830068636" onmouseenter="enter('1102668729830068636');" onmouseout="out('1102668729830068636');" style=""> 233          getChartsHost().getDateBar().setVisibility(show ? View.VISIBLE : View.INVISIBLE);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234      }                                                                                                             </span>
<span  style=""> 235                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 236      @Override                                                                                                     </span>
<span class="658855826062432633" onmouseenter="enter('658855826062432633');" onmouseout="out('658855826062432633');" style=""> 237      public void onDestroy() {                                                                                     </span>
<span class="7275190530034972367" onmouseenter="enter('7275190530034972367');" onmouseout="out('7275190530034972367');" style=""> 238          super.onDestroy();                                                                                        </span>
<span class="-1904828397138023848" onmouseenter="enter('-1904828397138023848');" onmouseout="out('-1904828397138023848');" style=""> 239          LocalBroadcastManager.getInstance(getActivity()).unregisterReceiver(mReceiver);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240      }                                                                                                             </span>
<span  style=""> 241                                                                                                                    </span>
<span class="-6518874138984288541" onmouseenter="enter('-6518874138984288541');" onmouseout="out('-6518874138984288541');" style=""> 242      protected void onReceive(Context context, Intent intent) {                                                    </span>
<span class="5344227773413700857" onmouseenter="enter('5344227773413700857');" onmouseout="out('5344227773413700857');" style=""> 243          String action = intent.getAction();                                                                       </span>
<span class="-494993687329631312" onmouseenter="enter('-494993687329631312');" onmouseout="out('-494993687329631312');" style=""> 244          if (ChartsHost.REFRESH.equals(action)) {                                                                  </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 245              refresh();                                                                                            </span>
<span class="8208351658473141292" onmouseenter="enter('8208351658473141292');" onmouseout="out('8208351658473141292');" style=""> 246          } else if (ChartsHost.DATE_NEXT.equals(action)) {                                                         </span>
<span class="3429530462558527400" onmouseenter="enter('3429530462558527400');" onmouseout="out('3429530462558527400');" style=""> 247              handleDateNext(getStartDate(), getEndDate());                                                         </span>
<span class="6275594107476882748" onmouseenter="enter('6275594107476882748');" onmouseout="out('6275594107476882748');" style=""> 248          } else if (ChartsHost.DATE_PREV.equals(action)) {                                                         </span>
<span class="-3035508152708713619" onmouseenter="enter('-3035508152708713619');" onmouseout="out('-3035508152708713619');" style=""> 249              handleDatePrev(getStartDate(), getEndDate());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251      }                                                                                                             </span>
<span  style=""> 252                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 253      /**                                                                                                           </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 254       * Default implementation shifts the dates by one day, if visible                                             </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 255       * and calls #refreshIfVisible().                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 256       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 257       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 258       * @param endDate                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259       */                                                                                                           </span>
<span class="-3047400271509647247" onmouseenter="enter('-3047400271509647247');" onmouseout="out('-3047400271509647247');" style=""> 260      protected void handleDatePrev(Date startDate, Date endDate) {                                                 </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 261          if (isVisibleInActivity()) {                                                                              </span>
<span class="-2651860554468779719" onmouseenter="enter('-2651860554468779719');" onmouseout="out('-2651860554468779719');" style=""> 262              if (!shiftDates(startDate, endDate, -1)) {                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 263                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265          }                                                                                                         </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 266          refreshIfVisible();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267      }                                                                                                             </span>
<span  style=""> 268                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 269      /**                                                                                                           </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 270       * Default implementation shifts the dates by one day, if visible                                             </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 271       * and calls #refreshIfVisible().                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 272       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 273       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 274       * @param endDate                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 275       */                                                                                                           </span>
<span class="6615897495863858801" onmouseenter="enter('6615897495863858801');" onmouseout="out('6615897495863858801');" style=""> 276      protected void handleDateNext(Date startDate, Date endDate) {                                                 </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 277          if (isVisibleInActivity()) {                                                                              </span>
<span class="-6485278970310858803" onmouseenter="enter('-6485278970310858803');" onmouseout="out('-6485278970310858803');" style=""> 278              if (!shiftDates(startDate, endDate, +1)) {                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 279                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281          }                                                                                                         </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 282          refreshIfVisible();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5798655654202275728" onmouseenter="enter('5798655654202275728');" onmouseout="out('5798655654202275728');" style=""> 285      protected void refreshIfVisible() {                                                                           </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 286          if (isVisibleInActivity()) {                                                                              </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 287              refresh();                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 288          } else {                                                                                                  </span>
<span class="427958345432566734" onmouseenter="enter('427958345432566734');" onmouseout="out('427958345432566734');" style=""> 289              mChartDirty = true;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291      }                                                                                                             </span>
<span  style=""> 292                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293      /**                                                                                                           </span>
<span class="-6717682359676050907" onmouseenter="enter('-6717682359676050907');" onmouseout="out('-6717682359676050907');" style=""> 294       * Shifts the given dates by offset days. offset may be positive or negative.                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 296       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 297       * @param endDate                                                                                             </span>
<span class="-3834083067366288846" onmouseenter="enter('-3834083067366288846');" onmouseout="out('-3834083067366288846');" style=""> 298       * @param offset    a positive or negative number of days to shift the dates                                  </span>
<span class="-6460740145491493882" onmouseenter="enter('-6460740145491493882');" onmouseout="out('-6460740145491493882');" style=""> 299       * @return true if the shift was successful and false otherwise                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 300       */                                                                                                           </span>
<span class="-1942902413678210438" onmouseenter="enter('-1942902413678210438');" onmouseout="out('-1942902413678210438');" style=""> 301      protected boolean shiftDates(Date startDate, Date endDate, int offset) {                                      </span>
<span class="-6336809523669087720" onmouseenter="enter('-6336809523669087720');" onmouseout="out('-6336809523669087720');" style=""> 302          Date newStart = DateTimeUtils.shiftByDays(startDate, offset);                                             </span>
<span class="-2733879703924959637" onmouseenter="enter('-2733879703924959637');" onmouseout="out('-2733879703924959637');" style=""> 303          Date newEnd = DateTimeUtils.shiftByDays(endDate, offset);                                                 </span>
<span  style=""> 304                                                                                                                    </span>
<span class="-2856611894499161319" onmouseenter="enter('-2856611894499161319');" onmouseout="out('-2856611894499161319');" style=""> 305          return setDateRange(newStart, newEnd);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306      }                                                                                                             </span>
<span  style=""> 307                                                                                                                    </span>
<span class="-5091098020443224535" onmouseenter="enter('-5091098020443224535');" onmouseout="out('-5091098020443224535');" style=""> 308      protected Integer getColorFor(int activityKind) {                                                             </span>
<span class="1068460219870485515" onmouseenter="enter('1068460219870485515');" onmouseout="out('1068460219870485515');" style=""> 309          switch (activityKind) {                                                                                   </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 310              case ActivityKind.TYPE_DEEP_SLEEP:                                                                    </span>
<span class="5022727203055802055" onmouseenter="enter('5022727203055802055');" onmouseout="out('5022727203055802055');" style=""> 311                  return akDeepSleep.color;                                                                         </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 312              case ActivityKind.TYPE_LIGHT_SLEEP:                                                                   </span>
<span class="9202598133274813026" onmouseenter="enter('9202598133274813026');" onmouseout="out('9202598133274813026');" style=""> 313                  return akLightSleep.color;                                                                        </span>
<span class="-1944461592116084883" onmouseenter="enter('-1944461592116084883');" onmouseout="out('-1944461592116084883');" style=""> 314              case ActivityKind.TYPE_ACTIVITY:                                                                      </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 315                  return akActivity.color;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316          }                                                                                                         </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 317          return akActivity.color;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318      }                                                                                                             </span>
<span  style=""> 319                                                                                                                    </span>
<span class="7124995295832055820" onmouseenter="enter('7124995295832055820');" onmouseout="out('7124995295832055820');" style=""> 320      protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device) {       </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 321          DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);                        </span>
<span class="5252113264335521833" onmouseenter="enter('5252113264335521833');" onmouseout="out('5252113264335521833');" style=""> 322          return coordinator.getSampleProvider(device, db.getDaoSession());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323      }                                                                                                             </span>
<span  style=""> 324                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 325      /**                                                                                                           </span>
<span class="3872148434859025386" onmouseenter="enter('3872148434859025386');" onmouseout="out('3872148434859025386');" style=""> 326       * Returns all kinds of samples for the given device.                                                         </span>
<span class="886766698730034078" onmouseenter="enter('886766698730034078');" onmouseout="out('886766698730034078');" style=""> 327       * To be called from a background thread.                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 328       *                                                                                                            </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 329       * @param device                                                                                              </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 330       * @param tsFrom                                                                                              </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 331       * @param tsTo                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332       */                                                                                                           </span>
<span class="3140984125721729972" onmouseenter="enter('3140984125721729972');" onmouseout="out('3140984125721729972');" style=""> 333      protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) { </span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 334          SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                              </span>
<span class="3618633972640587810" onmouseenter="enter('3618633972640587810');" onmouseout="out('3618633972640587810');" style=""> 335          return provider.getAllActivitySamples(tsFrom, tsTo);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336      }                                                                                                             </span>
<span  style=""> 337                                                                                                                    </span>
<span class="911814376404307930" onmouseenter="enter('911814376404307930');" onmouseout="out('911814376404307930');" style=""><abbr title=" 338      protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 338      protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom,ðŸ”µ</abbr></span>
<span class="5136693054641003501" onmouseenter="enter('5136693054641003501');" onmouseout="out('5136693054641003501');" style=""> 339          SampleProvider&lt;? extends AbstractActivitySample&gt; provider = getProvider(db, device);                      </span>
<span class="85967298499632314" onmouseenter="enter('85967298499632314');" onmouseout="out('85967298499632314');" style=""> 340          return provider.getActivitySamples(tsFrom, tsTo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341      }                                                                                                             </span>
<span  style=""> 342                                                                                                                    </span>
<span  style=""> 343                                                                                                                    </span>
<span class="-241747733905569263" onmouseenter="enter('-241747733905569263');" onmouseout="out('-241747733905569263');" style=""><abbr title=" 344      protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 344      protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) ðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 345          SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                              </span>
<span class="-5906481120950290774" onmouseenter="enter('-5906481120950290774');" onmouseout="out('-5906481120950290774');" style=""> 346          return provider.getSleepSamples(tsFrom, tsTo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347      }                                                                                                             </span>
<span  style=""> 348                                                                                                                    </span>
<span class="5612092723136709042" onmouseenter="enter('5612092723136709042');" onmouseout="out('5612092723136709042');" style=""> 349      protected void configureChartDefaults(Chart&lt;?&gt; chart) {                                                       </span>
<span class="-7606632580747532983" onmouseenter="enter('-7606632580747532983');" onmouseout="out('-7606632580747532983');" style=""> 350          chart.getXAxis().setValueFormatter(new TimestampValueFormatter());                                        </span>
<span class="6778504947781910997" onmouseenter="enter('6778504947781910997');" onmouseout="out('6778504947781910997');" style=""> 351          chart.getDescription().setText(&quot;&quot;);                                                                       </span>
<span  style=""> 352                                                                                                                    </span>
<span class="24609561265320879" onmouseenter="enter('24609561265320879');" onmouseout="out('24609561265320879');" style=""> 353          // if enabled, the chart will always start at zero on the y-axis                                          </span>
<span class="6529846037374092564" onmouseenter="enter('6529846037374092564');" onmouseout="out('6529846037374092564');" style=""> 354          chart.setNoDataText(getString(R.string.chart_no_data_synchronize));                                       </span>
<span  style=""> 355                                                                                                                    </span>
<span class="2162327714476306626" onmouseenter="enter('2162327714476306626');" onmouseout="out('2162327714476306626');" style=""> 356          // disable value highlighting                                                                             </span>
<span class="-1590348432070259774" onmouseenter="enter('-1590348432070259774');" onmouseout="out('-1590348432070259774');" style=""> 357          chart.setHighlightPerTapEnabled(false);                                                                   </span>
<span  style=""> 358                                                                                                                    </span>
<span class="-348919351774733305" onmouseenter="enter('-348919351774733305');" onmouseout="out('-348919351774733305');" style=""> 359          // enable touch gestures                                                                                  </span>
<span class="5289310484488287391" onmouseenter="enter('5289310484488287391');" onmouseout="out('5289310484488287391');" style=""> 360          chart.setTouchEnabled(true);                                                                              </span>
<span  style=""> 361                                                                                                                    </span>
<span class="-6098879767425938051" onmouseenter="enter('-6098879767425938051');" onmouseout="out('-6098879767425938051');" style=""> 362  // commented out: this has weird bugs/sideeffects at least on WeekStepsCharts                                     </span>
<span class="8784253570401363075" onmouseenter="enter('8784253570401363075');" onmouseout="out('8784253570401363075');" style=""> 363  // where only the first Day-label is drawn, because AxisRenderer.computeAxisValues(float,float)                   </span>
<span class="-8770575613400395593" onmouseenter="enter('-8770575613400395593');" onmouseout="out('-8770575613400395593');" style=""> 364  // appears to have an overflow when calculating &#x27;n&#x27; (number of entries)                                           </span>
<span class="3888896009006521991" onmouseenter="enter('3888896009006521991');" onmouseout="out('3888896009006521991');" style=""> 365  //        chart.getXAxis().setGranularity(60*5);                                                                  </span>
<span  style=""> 366                                                                                                                    </span>
<span class="5634570376801469004" onmouseenter="enter('5634570376801469004');" onmouseout="out('5634570376801469004');" style=""> 367          setupLegend(chart);                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368      }                                                                                                             </span>
<span  style=""> 369                                                                                                                    </span>
<span class="-1924974321468626199" onmouseenter="enter('-1924974321468626199');" onmouseout="out('-1924974321468626199');" style=""> 370      protected void configureBarLineChartDefaults(BarLineChartBase&lt;?&gt; chart) {                                     </span>
<span class="5467508404297658352" onmouseenter="enter('5467508404297658352');" onmouseout="out('5467508404297658352');" style=""> 371          configureChartDefaults(chart);                                                                            </span>
<span class="-8169200756215735113" onmouseenter="enter('-8169200756215735113');" onmouseout="out('-8169200756215735113');" style=""> 372          if (chart instanceof BarChart) {                                                                          </span>
<span class="2718779115389378256" onmouseenter="enter('2718779115389378256');" onmouseout="out('2718779115389378256');" style=""> 373              ((BarChart) chart).setFitBars(true);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374          }                                                                                                         </span>
<span  style=""> 375                                                                                                                    </span>
<span class="-1346367465809520237" onmouseenter="enter('-1346367465809520237');" onmouseout="out('-1346367465809520237');" style=""> 376          // enable scaling and dragging                                                                            </span>
<span class="165705574276177801" onmouseenter="enter('165705574276177801');" onmouseout="out('165705574276177801');" style=""> 377          chart.setDragEnabled(true);                                                                               </span>
<span class="6107382641746821998" onmouseenter="enter('6107382641746821998');" onmouseout="out('6107382641746821998');" style=""> 378          chart.setScaleEnabled(true);                                                                              </span>
<span  style=""> 379                                                                                                                    </span>
<span class="6424277115851676497" onmouseenter="enter('6424277115851676497');" onmouseout="out('6424277115851676497');" style=""> 380          // if disabled, scaling can be done on x- and y-axis separately                                           </span>
<span class="6432377865510855871" onmouseenter="enter('6432377865510855871');" onmouseout="out('6432377865510855871');" style=""> 381  //        chart.setPinchZoom(true);                                                                               </span>
<span  style=""> 382                                                                                                                    </span>
<span class="-3757744149975665581" onmouseenter="enter('-3757744149975665581');" onmouseout="out('-3757744149975665581');" style=""> 383          chart.setDrawGridBackground(false);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384      }                                                                                                             </span>
<span  style=""> 385                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 386      /**                                                                                                           </span>
<span class="5100165395414783914" onmouseenter="enter('5100165395414783914');" onmouseout="out('5100165395414783914');" style=""> 387       * This method will invoke a background task to read the data from the                                        </span>
<span class="5027852704688867372" onmouseenter="enter('5027852704688867372');" onmouseout="out('5027852704688867372');" style=""> 388       * database, analyze it, prepare it for the charts and eventually call                                        </span>
<span class="-3918098027409993360" onmouseenter="enter('-3918098027409993360');" onmouseout="out('-3918098027409993360');" style=""> 389       * #renderCharts                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 390       */                                                                                                           </span>
<span class="2809394791911169685" onmouseenter="enter('2809394791911169685');" onmouseout="out('2809394791911169685');" style=""> 391      protected void refresh() {                                                                                    </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 392          ChartsHost chartsHost = getChartsHost();                                                                  </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 393          if (chartsHost != null) {                                                                                 </span>
<span class="-103873194966226890" onmouseenter="enter('-103873194966226890');" onmouseout="out('-103873194966226890');" style=""> 394              if (chartsHost.getDevice() != null) {                                                                 </span>
<span class="-5198511171031023043" onmouseenter="enter('-5198511171031023043');" onmouseout="out('-5198511171031023043');" style=""> 395                  mChartDirty = false;                                                                              </span>
<span class="7622323496435283090" onmouseenter="enter('7622323496435283090');" onmouseout="out('7622323496435283090');" style=""> 396                  updateDateInfo(getStartDate(), getEndDate());                                                     </span>
<span class="3165810198377965313" onmouseenter="enter('3165810198377965313');" onmouseout="out('3165810198377965313');" style=""> 397                  if (refreshTask != null &amp;&amp; refreshTask.getStatus() != AsyncTask.Status.FINISHED) {                </span>
<span class="-3108005745869946167" onmouseenter="enter('-3108005745869946167');" onmouseout="out('-3108005745869946167');" style=""> 398                      refreshTask.cancel(true);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399                  }                                                                                                 </span>
<span class="3840488977465298517" onmouseenter="enter('3840488977465298517');" onmouseout="out('3840488977465298517');" style=""> 400                  refreshTask = createRefreshTask(&quot;Visualizing data&quot;, getActivity()).execute();                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403      }                                                                                                             </span>
<span  style=""> 404                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 405      /**                                                                                                           </span>
<span class="4268529485699346115" onmouseenter="enter('4268529485699346115');" onmouseout="out('4268529485699346115');" style=""> 406       * This method reads the data from the database, analyzes and prepares it for                                 </span>
<span class="-3790527174834636702" onmouseenter="enter('-3790527174834636702');" onmouseout="out('-3790527174834636702');" style=""> 407       * the charts. This will be called from a background task, so there must not be                               </span>
<span class="8892366747213531989" onmouseenter="enter('8892366747213531989');" onmouseout="out('8892366747213531989');" style=""> 408       * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this method.   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 409       */                                                                                                           </span>
<span class="-9167766646201984999" onmouseenter="enter('-9167766646201984999');" onmouseout="out('-9167766646201984999');" style=""> 410      protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice device);      </span>
<span  style=""> 411                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 412      /**                                                                                                           </span>
<span class="7668378754224811352" onmouseenter="enter('7668378754224811352');" onmouseout="out('7668378754224811352');" style=""> 413       * Triggers the actual (re-) rendering of the chart.                                                          </span>
<span class="1258740047847480611" onmouseenter="enter('1258740047847480611');" onmouseout="out('1258740047847480611');" style=""> 414       * Always called from the UI thread.                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 415       */                                                                                                           </span>
<span class="4159836083754598607" onmouseenter="enter('4159836083754598607');" onmouseout="out('4159836083754598607');" style=""> 416      protected abstract void renderCharts();                                                                       </span>
<span  style=""> 417                                                                                                                    </span>
<span class="1142774420965375266" onmouseenter="enter('1142774420965375266');" onmouseout="out('1142774420965375266');" style=""> 418      protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samples) {    </span>
<span class="2571942157260224234" onmouseenter="enter('2571942157260224234');" onmouseout="out('2571942157260224234');" style=""> 419  //        Calendar cal = GregorianCalendar.getInstance();                                                         </span>
<span class="4401062856956877488" onmouseenter="enter('4401062856956877488');" onmouseout="out('4401062856956877488');" style=""> 420  //        cal.clear();                                                                                            </span>
<span class="6028849563211801820" onmouseenter="enter('6028849563211801820');" onmouseout="out('6028849563211801820');" style=""> 421          TimestampTranslation tsTranslation = new TimestampTranslation();                                          </span>
<span class="-53760276184898045" onmouseenter="enter('-53760276184898045');" onmouseout="out('-53760276184898045');" style=""> 422  //        Date date;                                                                                              </span>
<span class="-6156197187638932942" onmouseenter="enter('-6156197187638932942');" onmouseout="out('-6156197187638932942');" style=""> 423  //        String dateStringFrom = &quot;&quot;;                                                                             </span>
<span class="4183977243651978214" onmouseenter="enter('4183977243651978214');" onmouseout="out('4183977243651978214');" style=""> 424  //        String dateStringTo = &quot;&quot;;                                                                               </span>
<span class="147032316452628113" onmouseenter="enter('147032316452628113');" onmouseout="out('147032316452628113');" style=""> 425  //        ArrayList&lt;String&gt; xLabels = null;                                                                       </span>
<span  style=""> 426                                                                                                                    </span>
<span class="-8827232702598725695" onmouseenter="enter('-8827232702598725695');" onmouseout="out('-8827232702598725695');" style=""> 427          LOG.info(&quot;&quot; + getTitle() + &quot;: number of samples:&quot; + samples.size());                                      </span>
<span class="3654763384087017314" onmouseenter="enter('3654763384087017314');" onmouseout="out('3654763384087017314');" style=""> 428          LineData lineData;                                                                                        </span>
<span class="-9107937003987659062" onmouseenter="enter('-9107937003987659062');" onmouseout="out('-9107937003987659062');" style=""> 429          if (samples.size() &gt; 1) {                                                                                 </span>
<span class="-8527306736668810111" onmouseenter="enter('-8527306736668810111');" onmouseout="out('-8527306736668810111');" style=""> 430              boolean annotate = true;                                                                              </span>
<span class="1395829712909105015" onmouseenter="enter('1395829712909105015');" onmouseout="out('1395829712909105015');" style=""> 431              boolean use_steps_as_movement;                                                                        </span>
<span  style=""> 432                                                                                                                    </span>
<span class="4142243867024174482" onmouseenter="enter('4142243867024174482');" onmouseout="out('4142243867024174482');" style=""> 433              int last_type = ActivityKind.TYPE_UNKNOWN;                                                            </span>
<span  style=""> 434                                                                                                                    </span>
<span class="-2031252584474024476" onmouseenter="enter('-2031252584474024476');" onmouseout="out('-2031252584474024476');" style=""> 435              int numEntries = samples.size();                                                                      </span>
<span class="-8870011066494287543" onmouseenter="enter('-8870011066494287543');" onmouseout="out('-8870011066494287543');" style=""> 436              List&lt;Entry&gt; activityEntries = new ArrayList&lt;&gt;(numEntries);                                            </span>
<span class="4899105382649046594" onmouseenter="enter('4899105382649046594');" onmouseout="out('4899105382649046594');" style=""> 437              List&lt;Entry&gt; deepSleepEntries = new ArrayList&lt;&gt;(numEntries);                                           </span>
<span class="7486237668847997910" onmouseenter="enter('7486237668847997910');" onmouseout="out('7486237668847997910');" style=""> 438              List&lt;Entry&gt; lightSleepEntries = new ArrayList&lt;&gt;(numEntries);                                          </span>
<span class="-1233994828972266903" onmouseenter="enter('-1233994828972266903');" onmouseout="out('-1233994828972266903');" style=""> 439              List&lt;Entry&gt; notWornEntries = new ArrayList&lt;&gt;(numEntries);                                             </span>
<span class="-7435551010854374427" onmouseenter="enter('-7435551010854374427');" onmouseout="out('-7435551010854374427');" style=""> 440              boolean hr = supportsHeartrate(gbDevice);                                                             </span>
<span class="-5348686395661515277" onmouseenter="enter('-5348686395661515277');" onmouseout="out('-5348686395661515277');" style=""> 441              List&lt;Entry&gt; heartrateEntries = hr ? new ArrayList&lt;Entry&gt;(numEntries) : null;                          </span>
<span class="8656271717087272693" onmouseenter="enter('8656271717087272693');" onmouseout="out('8656271717087272693');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 442 +            List&lt;Integer&gt; colors = new ArrayList&lt;&gt;(numEntries); // this is kinda inefficient...                   </span>
<span class="7529735733952592718" onmouseenter="enter('7529735733952592718');" onmouseout="out('7529735733952592718');" style=""> 443              int lastHrSampleIndex = -1;                                                                           </span>
<span  style=""> 444                                                                                                                    </span>
<span class="4476749361735409543" onmouseenter="enter('4476749361735409543');" onmouseout="out('4476749361735409543');" style=""> 445              for (int i = 0; i &lt; numEntries; i++) {                                                                </span>
<span class="3246332292526896189" onmouseenter="enter('3246332292526896189');" onmouseout="out('3246332292526896189');" style=""> 446                  ActivitySample sample = samples.get(i);                                                           </span>
<span class="6576081203602242327" onmouseenter="enter('6576081203602242327');" onmouseout="out('6576081203602242327');" style=""> 447                  int type = sample.getKind();                                                                      </span>
<span class="-9213760672368715167" onmouseenter="enter('-9213760672368715167');" onmouseout="out('-9213760672368715167');" style=""> 448                  int ts = tsTranslation.shorten(sample.getTimestamp());                                            </span>
<span  style=""> 449                                                                                                                    </span>
<span class="-6141709027769286674" onmouseenter="enter('-6141709027769286674');" onmouseout="out('-6141709027769286674');" style=""> 450  //                System.out.println(ts);                                                                         </span>
<span class="1901381804146795461" onmouseenter="enter('1901381804146795461');" onmouseout="out('1901381804146795461');" style=""> 451  //                ts = i;                                                                                         </span>
<span class="5764290091373211945" onmouseenter="enter('5764290091373211945');" onmouseout="out('5764290091373211945');" style=""> 452                  // determine start and end dates                                                                  </span>
<span class="5717361089680993355" onmouseenter="enter('5717361089680993355');" onmouseout="out('5717361089680993355');" style=""> 453  //                if (i == 0) {                                                                                   </span>
<span class="7046397249359147146" onmouseenter="enter('7046397249359147146');" onmouseout="out('7046397249359147146');" style=""> 454  //                    cal.setTimeInMillis(ts * 1000L); // make sure it&#x27;s converted to long                        </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 455  //                    date = cal.getTime();                                                                       </span>
<span class="5571666638688830790" onmouseenter="enter('5571666638688830790');" onmouseout="out('5571666638688830790');" style=""> 456  //                    dateStringFrom = dateFormat.format(date);                                                   </span>
<span class="-1516242143504559710" onmouseenter="enter('-1516242143504559710');" onmouseout="out('-1516242143504559710');" style=""> 457  //                } else if (i == samples.size() - 1) {                                                           </span>
<span class="241708909740168031" onmouseenter="enter('241708909740168031');" onmouseout="out('241708909740168031');" style=""> 458  //                    cal.setTimeInMillis(ts * 1000L); // same here                                               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 459  //                    date = cal.getTime();                                                                       </span>
<span class="993250294615949060" onmouseenter="enter('993250294615949060');" onmouseout="out('993250294615949060');" style=""> 460  //                    dateStringTo = dateFormat.format(date);                                                     </span>
<span class="8884174724223176501" onmouseenter="enter('8884174724223176501');" onmouseout="out('8884174724223176501');" style=""> 461  //                }                                                                                               </span>
<span  style=""> 462                                                                                                                    </span>
<span class="-8914675673971344704" onmouseenter="enter('-8914675673971344704');" onmouseout="out('-8914675673971344704');" style=""> 463                  float movement = sample.getIntensity();                                                           </span>
<span  style=""> 464                                                                                                                    </span>
<span class="5917499164651721508" onmouseenter="enter('5917499164651721508');" onmouseout="out('5917499164651721508');" style=""> 465                  float value = movement;                                                                           </span>
<span class="3474584951622682325" onmouseenter="enter('3474584951622682325');" onmouseout="out('3474584951622682325');" style=""> 466                  switch (type) {                                                                                   </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 467                      case ActivityKind.TYPE_DEEP_SLEEP:                                                            </span>
<span class="8800766899670031569" onmouseenter="enter('8800766899670031569');" onmouseout="out('8800766899670031569');" style=""> 468                          if (last_type != type) { //FIXME: this is ugly but it works (repeated in each case)       </span>
<span class="-1661959904957213102" onmouseenter="enter('-1661959904957213102');" onmouseout="out('-1661959904957213102');" style=""> 469                              deepSleepEntries.add(createLineEntry(0, ts - 1));                                     </span>
<span  style=""> 470                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 471                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 472                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 473                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                          }                                                                                         </span>
<span class="-6180311285798694701" onmouseenter="enter('-6180311285798694701');" onmouseout="out('-6180311285798694701');" style=""> 475                          deepSleepEntries.add(createLineEntry(value + SleepUtils.Y_VALUE_DEEP_SLEEP, ts));         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 476                          break;                                                                                    </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 477                      case ActivityKind.TYPE_LIGHT_SLEEP:                                                           </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 478                          if (last_type != type) {                                                                  </span>
<span class="7147575638574677011" onmouseenter="enter('7147575638574677011');" onmouseout="out('7147575638574677011');" style=""> 479                              lightSleepEntries.add(createLineEntry(0, ts - 1));                                    </span>
<span  style=""> 480                                                                                                                    </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 481                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 482                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 483                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                          }                                                                                         </span>
<span class="-5875750109358144719" onmouseenter="enter('-5875750109358144719');" onmouseout="out('-5875750109358144719');" style=""> 485                          lightSleepEntries.add(createLineEntry(value, ts));                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 486                          break;                                                                                    </span>
<span class="-9132572973740238507" onmouseenter="enter('-9132572973740238507');" onmouseout="out('-9132572973740238507');" style=""> 487                      case ActivityKind.TYPE_NOT_WORN:                                                              </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 488                          if (last_type != type) {                                                                  </span>
<span class="4292609800559774054" onmouseenter="enter('4292609800559774054');" onmouseout="out('4292609800559774054');" style=""> 489                              notWornEntries.add(createLineEntry(0, ts - 1));                                       </span>
<span  style=""> 490                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 491                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 492                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 493                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494                          }                                                                                         </span>
<span class="5412917281309595074" onmouseenter="enter('5412917281309595074');" onmouseout="out('5412917281309595074');" style=""><abbr title=" 495                          notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, just to show something on the graphs"> 495                          notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, jðŸ”µ</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 496                          break;                                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 497                      default:                                                                                      </span>
<span class="-4054780187002246392" onmouseenter="enter('-4054780187002246392');" onmouseout="out('-4054780187002246392');" style=""> 498  //                        short steps = sample.getSteps();                                                        </span>
<span class="-1494320471491276911" onmouseenter="enter('-1494320471491276911');" onmouseout="out('-1494320471491276911');" style=""> 499  //                        if (use_steps_as_movement &amp;&amp; steps != 0) {                                              </span>
<span class="-3251198952450992064" onmouseenter="enter('-3251198952450992064');" onmouseout="out('-3251198952450992064');" style=""> 500  //                            // I&#x27;m not sure using steps for this is actually a good idea                        </span>
<span class="-6376968801115210935" onmouseenter="enter('-6376968801115210935');" onmouseout="out('-6376968801115210935');" style=""> 501  //                            movement = steps;                                                                   </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 502  //                        }                                                                                       </span>
<span class="-941684175082606672" onmouseenter="enter('-941684175082606672');" onmouseout="out('-941684175082606672');" style=""> 503  //                        value = ((float) movement) / movement_divisor;                                          </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 504                          if (last_type != type) {                                                                  </span>
<span class="-6771781995837807247" onmouseenter="enter('-6771781995837807247');" onmouseout="out('-6771781995837807247');" style=""> 505                              activityEntries.add(createLineEntry(0, ts - 1));                                      </span>
<span  style=""> 506                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 507                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 508                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 509                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510                          }                                                                                         </span>
<span class="4080308283196262910" onmouseenter="enter('4080308283196262910');" onmouseout="out('4080308283196262910');" style=""> 511                          activityEntries.add(createLineEntry(value, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                  }                                                                                                 </span>
<span class="6502915003910560814" onmouseenter="enter('6502915003910560814');" onmouseout="out('6502915003910560814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 513 -                if (hr &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {                                         </span>
<span class="678415431212127122" onmouseenter="enter('678415431212127122');" onmouseout="out('678415431212127122');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 514 +                if (hr &amp;&amp; HeartRateUtils.isValidHeartRateValue(sample.getHeartRate())) {                          </span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style=""><abbr title=" 515                      if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 515                      if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTSðŸ”µ</abbr></span>
<span class="7928119684647429254" onmouseenter="enter('7928119684647429254');" onmouseout="out('7928119684647429254');" style=""> 516                          heartrateEntries.add(createLineEntry(0, lastHrSampleIndex + 1));                          </span>
<span class="-5182503479458455454" onmouseenter="enter('-5182503479458455454');" onmouseout="out('-5182503479458455454');" style=""> 517                          heartrateEntries.add(createLineEntry(0, ts - 1));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518                      }                                                                                             </span>
<span  style=""> 519                                                                                                                    </span>
<span class="-8554726460294545666" onmouseenter="enter('-8554726460294545666');" onmouseout="out('-8554726460294545666');" style=""> 520                      heartrateEntries.add(createLineEntry(sample.getHeartRate(), ts));                             </span>
<span class="1340167295380328410" onmouseenter="enter('1340167295380328410');" onmouseout="out('1340167295380328410');" style=""> 521                      lastHrSampleIndex = ts;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522                  }                                                                                                 </span>
<span  style=""> 523                                                                                                                    </span>
<span class="7730925444289024998" onmouseenter="enter('7730925444289024998');" onmouseout="out('7730925444289024998');" style=""> 524                  String xLabel = &quot;&quot;;                                                                               </span>
<span class="-5459254189226498661" onmouseenter="enter('-5459254189226498661');" onmouseout="out('-5459254189226498661');" style=""> 525                  if (annotate) {                                                                                   </span>
<span class="-1465306111701045962" onmouseenter="enter('-1465306111701045962');" onmouseout="out('-1465306111701045962');" style=""> 526  //                    cal.setTimeInMillis((ts + tsOffset) * 1000L);                                               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 527  //                    date = cal.getTime();                                                                       </span>
<span class="-1086602658675179068" onmouseenter="enter('-1086602658675179068');" onmouseout="out('-1086602658675179068');" style=""> 528  //                    String dateString = annotationDateFormat.format(date);                                      </span>
<span class="-2931946040942644368" onmouseenter="enter('-2931946040942644368');" onmouseout="out('-2931946040942644368');" style=""> 529  //                    xLabel = dateString;                                                                        </span>
<span class="5566449710495547766" onmouseenter="enter('5566449710495547766');" onmouseout="out('5566449710495547766');" style=""> 530  //                    if (last_type != type) {                                                                    </span>
<span class="7413255212379424149" onmouseenter="enter('7413255212379424149');" onmouseout="out('7413255212379424149');" style=""> 531  //                        if (isSleep(last_type) &amp;&amp; !isSleep(type)) {                                             </span>
<span class="-56714345320416604" onmouseenter="enter('-56714345320416604');" onmouseout="out('-56714345320416604');" style=""> 532  //                            // woken up                                                                         </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 533  //                            LimitLine line = new LimitLine(i, dateString);                                      </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 534  //                            line.enableDashedLine(8, 8, 0);                                                     </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 535  //                            line.setTextColor(Color.WHITE);                                                     </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 536  //                            line.setTextSize(15);                                                               </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 537  //                            chart.getXAxis().addLimitLine(line);                                                </span>
<span class="-5828290692175278159" onmouseenter="enter('-5828290692175278159');" onmouseout="out('-5828290692175278159');" style=""> 538  //                        } else if (!isSleep(last_type) &amp;&amp; isSleep(type)) {                                      </span>
<span class="5244181556799794554" onmouseenter="enter('5244181556799794554');" onmouseout="out('5244181556799794554');" style=""> 539  //                            // fallen asleep                                                                    </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 540  //                            LimitLine line = new LimitLine(i, dateString);                                      </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 541  //                            line.enableDashedLine(8, 8, 0);                                                     </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 542  //                            line.setTextSize(15);                                                               </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 543  //                            line.setTextColor(Color.WHITE);                                                     </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 544  //                            chart.getXAxis().addLimitLine(line);                                                </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 545  //                        }                                                                                       </span>
<span class="6051702211689751699" onmouseenter="enter('6051702211689751699');" onmouseout="out('6051702211689751699');" style=""> 546  //                    }                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547                  }                                                                                                 </span>
<span class="-1444147652675010833" onmouseenter="enter('-1444147652675010833');" onmouseout="out('-1444147652675010833');" style=""> 548                  last_type = type;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549              }                                                                                                     </span>
<span  style=""> 550                                                                                                                    </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-1579194111559420554" onmouseenter="enter('-1579194111559420554');" onmouseout="out('-1579194111559420554');" style=""> 552              List&lt;ILineDataSet&gt; lineDataSets = new ArrayList&lt;&gt;();                                                  </span>
<span class="-1359387837948108742" onmouseenter="enter('-1359387837948108742');" onmouseout="out('-1359387837948108742');" style=""> 553              LineDataSet activitySet = createDataSet(activityEntries, akActivity.color, &quot;Activity&quot;);               </span>
<span class="-3354127768405521554" onmouseenter="enter('-3354127768405521554');" onmouseout="out('-3354127768405521554');" style=""> 554              lineDataSets.add(activitySet);                                                                        </span>
<span class="7026895411091818045" onmouseenter="enter('7026895411091818045');" onmouseout="out('7026895411091818045');" style=""> 555              LineDataSet deepSleepSet = createDataSet(deepSleepEntries, akDeepSleep.color, &quot;Deep Sleep&quot;);          </span>
<span class="-3446958151566211125" onmouseenter="enter('-3446958151566211125');" onmouseout="out('-3446958151566211125');" style=""> 556              lineDataSets.add(deepSleepSet);                                                                       </span>
<span class="4693393103163137779" onmouseenter="enter('4693393103163137779');" onmouseout="out('4693393103163137779');" style=""> 557              LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light Sleep&quot;);      </span>
<span class="8003351674511898289" onmouseenter="enter('8003351674511898289');" onmouseout="out('8003351674511898289');" style=""> 558              lineDataSets.add(lightSleepSet);                                                                      </span>
<span class="-7108338871992330028" onmouseenter="enter('-7108338871992330028');" onmouseout="out('-7108338871992330028');" style=""> 559              LineDataSet notWornSet = createDataSet(notWornEntries, akNotWorn.color, &quot;Not worn&quot;);                  </span>
<span class="64462528287934820" onmouseenter="enter('64462528287934820');" onmouseout="out('64462528287934820');" style=""> 560              lineDataSets.add(notWornSet);                                                                         </span>
<span  style=""> 561                                                                                                                    </span>
<span class="-8621348893512609171" onmouseenter="enter('-8621348893512609171');" onmouseout="out('-8621348893512609171');" style=""> 562              if (hr &amp;&amp; heartrateEntries.size() &gt; 0) {                                                              </span>
<span class="-6373591549531816713" onmouseenter="enter('-6373591549531816713');" onmouseout="out('-6373591549531816713');" style=""> 563                  LineDataSet heartrateSet = createHeartrateSet(heartrateEntries, &quot;Heart Rate&quot;);                    </span>
<span  style=""> 564                                                                                                                    </span>
<span class="8944960460471270621" onmouseenter="enter('8944960460471270621');" onmouseout="out('8944960460471270621');" style=""> 565                  lineDataSets.add(heartrateSet);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566              }                                                                                                     </span>
<span class="2703760882318229208" onmouseenter="enter('2703760882318229208');" onmouseout="out('2703760882318229208');" style=""> 567              lineData = new LineData(lineDataSets);                                                                </span>
<span  style=""> 568                                                                                                                    </span>
<span class="-6499460759915470269" onmouseenter="enter('-6499460759915470269');" onmouseout="out('-6499460759915470269');" style=""> 569  //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStringTo));  </span>
<span class="-3762887228500678217" onmouseenter="enter('-3762887228500678217');" onmouseout="out('-3762887228500678217');" style=""> 570  //            chart.setDescriptionPosition(?, ?);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 571          } else {                                                                                                  </span>
<span class="-2761320896669897238" onmouseenter="enter('-2761320896669897238');" onmouseout="out('-2761320896669897238');" style=""> 572              lineData = new LineData();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573          }                                                                                                         </span>
<span  style=""> 574                                                                                                                    </span>
<span class="-1609543182283032519" onmouseenter="enter('-1609543182283032519');" onmouseout="out('-1609543182283032519');" style=""> 575          IAxisValueFormatter xValueFormatter = new SampleXLabelFormatter(tsTranslation);                           </span>
<span class="-3441797761873957961" onmouseenter="enter('-3441797761873957961');" onmouseout="out('-3441797761873957961');" style=""> 576          return new DefaultChartsData(lineData, xValueFormatter);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577      }                                                                                                             </span>
<span  style=""> 578                                                                                                                    </span>
<span class="1581801212602353291" onmouseenter="enter('1581801212602353291');" onmouseout="out('1581801212602353291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 579 -    protected boolean isValidHeartRateValue(int value) {                                                          </span>
<span class="-5341883142074348876" onmouseenter="enter('-5341883142074348876');" onmouseout="out('-5341883142074348876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 580 -        return value &gt; HeartRateUtils.MIN_HEART_RATE_VALUE &amp;&amp; value &lt; HeartRateUtils.MAX_HEART_RATE_VALUE;        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 581 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 582 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 583      /**                                                                                                           </span>
<span class="6334547652397213625" onmouseenter="enter('6334547652397213625');" onmouseout="out('6334547652397213625');" style=""> 584       * Implement this to supply the samples to be displayed.                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 585       *                                                                                                            </span>
<span class="5464670662091686554" onmouseenter="enter('5464670662091686554');" onmouseout="out('5464670662091686554');" style=""> 586       * @param db                                                                                                  </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 587       * @param device                                                                                              </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 588       * @param tsFrom                                                                                              </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 589       * @param tsTo                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 590       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 591       */                                                                                                           </span>
<span class="-4899824222168510613" onmouseenter="enter('-4899824222168510613');" onmouseout="out('-4899824222168510613');" style=""><abbr title=" 592      protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo);"> 592      protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsðŸ”µ</abbr></span>
<span  style=""> 593                                                                                                                    </span>
<span class="354769125648165857" onmouseenter="enter('354769125648165857');" onmouseout="out('354769125648165857');" style=""> 594      protected abstract void setupLegend(Chart chart);                                                             </span>
<span  style=""> 595                                                                                                                    </span>
<span class="-188113346780130145" onmouseenter="enter('-188113346780130145');" onmouseout="out('-188113346780130145');" style=""> 596      protected Entry createLineEntry(float value, int xValue) {                                                    </span>
<span class="5155334880625707837" onmouseenter="enter('5155334880625707837');" onmouseout="out('5155334880625707837');" style=""> 597          return new Entry(xValue, value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598      }                                                                                                             </span>
<span  style=""> 599                                                                                                                    </span>
<span class="5268984431672798069" onmouseenter="enter('5268984431672798069');" onmouseout="out('5268984431672798069');" style=""> 600      protected LineDataSet createDataSet(List&lt;Entry&gt; values, Integer color, String label) {                        </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 601          LineDataSet set1 = new LineDataSet(values, label);                                                        </span>
<span class="820149155345415568" onmouseenter="enter('820149155345415568');" onmouseout="out('820149155345415568');" style=""> 602          set1.setColor(color);                                                                                     </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 603  //        set1.setDrawCubic(true);                                                                                </span>
<span class="-7031616190320035410" onmouseenter="enter('-7031616190320035410');" onmouseout="out('-7031616190320035410');" style=""> 604  //        set1.setCubicIntensity(0.2f);                                                                           </span>
<span class="5358451272424367352" onmouseenter="enter('5358451272424367352');" onmouseout="out('5358451272424367352');" style=""> 605          set1.setDrawFilled(true);                                                                                 </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 606          set1.setDrawCircles(false);                                                                               </span>
<span class="5314519233815368988" onmouseenter="enter('5314519233815368988');" onmouseout="out('5314519233815368988');" style=""> 607  //        set1.setLineWidth(2f);                                                                                  </span>
<span class="4052186244749569041" onmouseenter="enter('4052186244749569041');" onmouseout="out('4052186244749569041');" style=""> 608  //        set1.setCircleSize(5f);                                                                                 </span>
<span class="5178863964691876958" onmouseenter="enter('5178863964691876958');" onmouseout="out('5178863964691876958');" style=""> 609          set1.setFillColor(color);                                                                                 </span>
<span class="-3615467214536174629" onmouseenter="enter('-3615467214536174629');" onmouseout="out('-3615467214536174629');" style=""> 610          set1.setFillAlpha(255);                                                                                   </span>
<span class="-2764219564959910542" onmouseenter="enter('-2764219564959910542');" onmouseout="out('-2764219564959910542');" style=""> 611          set1.setDrawValues(false);                                                                                </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 612  //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                         </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 613  //        set1.setColor(Color.rgb(89, 178, 44));                                                                  </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 614          set1.setValueTextColor(CHART_TEXT_COLOR);                                                                 </span>
<span class="-729266328453548997" onmouseenter="enter('-729266328453548997');" onmouseout="out('-729266328453548997');" style=""> 615          set1.setAxisDependency(YAxis.AxisDependency.LEFT);                                                        </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 616          return set1;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 617      }                                                                                                             </span>
<span  style=""> 618                                                                                                                    </span>
<span class="812124301236032885" onmouseenter="enter('812124301236032885');" onmouseout="out('812124301236032885');" style=""> 619      protected LineDataSet createHeartrateSet(List&lt;Entry&gt; values, String label) {                                  </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 620          LineDataSet set1 = new LineDataSet(values, label);                                                        </span>
<span class="5440468726562122008" onmouseenter="enter('5440468726562122008');" onmouseout="out('5440468726562122008');" style=""> 621          set1.setLineWidth(2.2f);                                                                                  </span>
<span class="-6998111113207584878" onmouseenter="enter('-6998111113207584878');" onmouseout="out('-6998111113207584878');" style=""> 622          set1.setColor(HEARTRATE_COLOR);                                                                           </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 623  //        set1.setDrawCubic(true);                                                                                </span>
<span class="-5525611047697799836" onmouseenter="enter('-5525611047697799836');" onmouseout="out('-5525611047697799836');" style=""> 624          set1.setMode(LineDataSet.Mode.HORIZONTAL_BEZIER);                                                         </span>
<span class="-6788168983082898765" onmouseenter="enter('-6788168983082898765');" onmouseout="out('-6788168983082898765');" style=""> 625          set1.setCubicIntensity(0.1f);                                                                             </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 626          set1.setDrawCircles(false);                                                                               </span>
<span class="8990366444861982417" onmouseenter="enter('8990366444861982417');" onmouseout="out('8990366444861982417');" style=""> 627  //        set1.setCircleRadius(2f);                                                                               </span>
<span class="7490911489692857332" onmouseenter="enter('7490911489692857332');" onmouseout="out('7490911489692857332');" style=""> 628  //        set1.setDrawFilled(true);                                                                               </span>
<span class="-2083836916768378283" onmouseenter="enter('-2083836916768378283');" onmouseout="out('-2083836916768378283');" style=""> 629  //        set1.setColor(getResources().getColor(android.R.color.background_light));                               </span>
<span class="5114874680539545534" onmouseenter="enter('5114874680539545534');" onmouseout="out('5114874680539545534');" style=""> 630  //        set1.setCircleColor(HEARTRATE_COLOR);                                                                   </span>
<span class="2152854923555754112" onmouseenter="enter('2152854923555754112');" onmouseout="out('2152854923555754112');" style=""> 631  //        set1.setFillColor(ColorTemplate.getHoloBlue());                                                         </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 632  //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                         </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 633  //        set1.setColor(Color.rgb(89, 178, 44));                                                                  </span>
<span class="-6976214771678818552" onmouseenter="enter('-6976214771678818552');" onmouseout="out('-6976214771678818552');" style=""> 634          set1.setDrawValues(true);                                                                                 </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 635          set1.setValueTextColor(CHART_TEXT_COLOR);                                                                 </span>
<span class="7444000937070277499" onmouseenter="enter('7444000937070277499');" onmouseout="out('7444000937070277499');" style=""> 636          set1.setAxisDependency(YAxis.AxisDependency.RIGHT);                                                       </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 637          return set1;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 638      }                                                                                                             </span>
<span  style=""> 639                                                                                                                    </span>
<span class="-8033521169229713638" onmouseenter="enter('-8033521169229713638');" onmouseout="out('-8033521169229713638');" style=""> 640      protected RefreshTask createRefreshTask(String task, Context context) {                                       </span>
<span class="4652327534384605753" onmouseenter="enter('4652327534384605753');" onmouseout="out('4652327534384605753');" style=""> 641          return new RefreshTask(task, context);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642      }                                                                                                             </span>
<span  style=""> 643                                                                                                                    </span>
<span class="-546204840646058388" onmouseenter="enter('-546204840646058388');" onmouseout="out('-546204840646058388');" style=""> 644      public class RefreshTask extends DBAccess {                                                                   </span>
<span class="3813756787288835606" onmouseenter="enter('3813756787288835606');" onmouseout="out('3813756787288835606');" style=""> 645          private ChartsData chartsData;                                                                            </span>
<span  style=""> 646                                                                                                                    </span>
<span class="6265910281991326326" onmouseenter="enter('6265910281991326326');" onmouseout="out('6265910281991326326');" style=""> 647          public RefreshTask(String task, Context context) {                                                        </span>
<span class="6170214191344158476" onmouseenter="enter('6170214191344158476');" onmouseout="out('6170214191344158476');" style=""> 648              super(task, context);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649          }                                                                                                         </span>
<span  style=""> 650                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 651          @Override                                                                                                 </span>
<span class="6769214505219419913" onmouseenter="enter('6769214505219419913');" onmouseout="out('6769214505219419913');" style=""> 652          protected void doInBackground(DBHandler db) {                                                             </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 653              ChartsHost chartsHost = getChartsHost();                                                              </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 654              if (chartsHost != null) {                                                                             </span>
<span class="-1872147130605113863" onmouseenter="enter('-1872147130605113863');" onmouseout="out('-1872147130605113863');" style=""> 655                  chartsData = refreshInBackground(chartsHost, db, chartsHost.getDevice());                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 656              } else {                                                                                              </span>
<span class="4351338677612212716" onmouseenter="enter('4351338677612212716');" onmouseout="out('4351338677612212716');" style=""> 657                  cancel(true);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 658              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659          }                                                                                                         </span>
<span  style=""> 660                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 661          @Override                                                                                                 </span>
<span class="7961646527709364830" onmouseenter="enter('7961646527709364830');" onmouseout="out('7961646527709364830');" style=""> 662          protected void onPostExecute(Object o) {                                                                  </span>
<span class="1329337488051350495" onmouseenter="enter('1329337488051350495');" onmouseout="out('1329337488051350495');" style=""> 663              super.onPostExecute(o);                                                                               </span>
<span class="4343120289681205406" onmouseenter="enter('4343120289681205406');" onmouseout="out('4343120289681205406');" style=""> 664              FragmentActivity activity = getActivity();                                                            </span>
<span class="1646077047954275991" onmouseenter="enter('1646077047954275991');" onmouseout="out('1646077047954275991');" style=""> 665              if (activity != null &amp;&amp; !activity.isFinishing() &amp;&amp; !activity.isDestroyed()) {                         </span>
<span class="-9005677599852802201" onmouseenter="enter('-9005677599852802201');" onmouseout="out('-9005677599852802201');" style=""> 666                  updateChartsnUIThread(chartsData);                                                                </span>
<span class="-4582773223831390369" onmouseenter="enter('-4582773223831390369');" onmouseout="out('-4582773223831390369');" style=""> 667                  renderCharts();                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 668              } else {                                                                                              </span>
<span class="-112827357653254579" onmouseenter="enter('-112827357653254579');" onmouseout="out('-112827357653254579');" style=""> 669                  LOG.info(&quot;Not rendering charts because activity is not available anymore&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 670              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672      }                                                                                                             </span>
<span  style=""> 673                                                                                                                    </span>
<span class="4496803111214409190" onmouseenter="enter('4496803111214409190');" onmouseout="out('4496803111214409190');" style=""> 674      protected abstract void updateChartsnUIThread(ChartsData chartsData);                                         </span>
<span  style=""> 675                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 676      /**                                                                                                           </span>
<span class="-5037778349112302453" onmouseenter="enter('-5037778349112302453');" onmouseout="out('-5037778349112302453');" style=""> 677       * Returns true if the date was successfully shifted, and false if the shift                                  </span>
<span class="-2032571983951913696" onmouseenter="enter('-2032571983951913696');" onmouseout="out('-2032571983951913696');" style=""> 678       * was ignored, e.g. when the to-value is in the future.                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 679       *                                                                                                            </span>
<span class="3294571698788299338" onmouseenter="enter('3294571698788299338');" onmouseout="out('3294571698788299338');" style=""> 680       * @param from                                                                                                </span>
<span class="-8398071401251508968" onmouseenter="enter('-8398071401251508968');" onmouseout="out('-8398071401251508968');" style=""> 681       * @param to                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 682       */                                                                                                           </span>
<span class="2489721831712552479" onmouseenter="enter('2489721831712552479');" onmouseout="out('2489721831712552479');" style=""> 683      public boolean setDateRange(Date from, Date to) {                                                             </span>
<span class="4190819803131113323" onmouseenter="enter('4190819803131113323');" onmouseout="out('4190819803131113323');" style=""> 684          if (from.compareTo(to) &gt; 0) {                                                                             </span>
<span class="8028532381572922008" onmouseenter="enter('8028532381572922008');" onmouseout="out('8028532381572922008');" style=""> 685              throw new IllegalArgumentException(&quot;Bad date range: &quot; + from + &quot;..&quot; + to);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686          }                                                                                                         </span>
<span class="-968081081932492520" onmouseenter="enter('-968081081932492520');" onmouseout="out('-968081081932492520');" style=""> 687          Date now = new Date();                                                                                    </span>
<span class="6487488966631950340" onmouseenter="enter('6487488966631950340');" onmouseout="out('6487488966631950340');" style=""> 688          if (to.after(now)) {                                                                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 689              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690          }                                                                                                         </span>
<span class="-9201818232828316665" onmouseenter="enter('-9201818232828316665');" onmouseout="out('-9201818232828316665');" style=""> 691          setStartDate(from);                                                                                       </span>
<span class="9222819538541566960" onmouseenter="enter('9222819538541566960');" onmouseout="out('9222819538541566960');" style=""> 692          setEndDate(to);                                                                                           </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 693          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694      }                                                                                                             </span>
<span  style=""> 695                                                                                                                    </span>
<span class="3159484724367933437" onmouseenter="enter('3159484724367933437');" onmouseout="out('3159484724367933437');" style=""> 696      protected void updateDateInfo(Date from, Date to) {                                                           </span>
<span class="-6255879985318699594" onmouseenter="enter('-6255879985318699594');" onmouseout="out('-6255879985318699594');" style=""> 697          if (from.equals(to)) {                                                                                    </span>
<span class="573039521209829270" onmouseenter="enter('573039521209829270');" onmouseout="out('573039521209829270');" style=""> 698              getChartsHost().setDateInfo(DateTimeUtils.formatDate(from));                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 699          } else {                                                                                                  </span>
<span class="6154857771528724742" onmouseenter="enter('6154857771528724742');" onmouseout="out('6154857771528724742');" style=""> 700              getChartsHost().setDateInfo(DateTimeUtils.formatDateRange(from, to));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 701          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702      }                                                                                                             </span>
<span  style=""> 703                                                                                                                    </span>
<span class="-2205559255794313412" onmouseenter="enter('-2205559255794313412');" onmouseout="out('-2205559255794313412');" style=""> 704      protected List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device) {                          </span>
<span class="4967864623407424140" onmouseenter="enter('4967864623407424140');" onmouseout="out('4967864623407424140');" style=""> 705          int tsStart = getTSStart();                                                                               </span>
<span class="-7516136729766634070" onmouseenter="enter('-7516136729766634070');" onmouseout="out('-7516136729766634070');" style=""> 706          int tsEnd = getTSEnd();                                                                                   </span>
<span class="7673509543804257849" onmouseenter="enter('7673509543804257849');" onmouseout="out('7673509543804257849');" style=""> 707          List&lt;ActivitySample&gt; samples = (List&lt;ActivitySample&gt;) getSamples(db, device, tsStart, tsEnd);             </span>
<span class="-5815796914087715329" onmouseenter="enter('-5815796914087715329');" onmouseout="out('-5815796914087715329');" style=""> 708          ensureStartAndEndSamples(samples, tsStart, tsEnd);                                                        </span>
<span class="1818060248517305383" onmouseenter="enter('1818060248517305383');" onmouseout="out('1818060248517305383');" style=""> 709  //        List&lt;ActivitySample&gt; samples2 = new ArrayList&lt;&gt;();                                                      </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 710  //        int min = Math.min(samples.size(), 10);                                                                 </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 711  //        int min = Math.min(samples.size(), 10);                                                                 </span>
<span class="-3297133522407861021" onmouseenter="enter('-3297133522407861021');" onmouseout="out('-3297133522407861021');" style=""> 712  //        for (int i = 0; i &lt; min; i++) {                                                                         </span>
<span class="-5419954369064878282" onmouseenter="enter('-5419954369064878282');" onmouseout="out('-5419954369064878282');" style=""> 713  //            samples2.add(samples.get(i));                                                                       </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 714  //        }                                                                                                       </span>
<span class="-217733928506784495" onmouseenter="enter('-217733928506784495');" onmouseout="out('-217733928506784495');" style=""> 715  //        return samples2;                                                                                        </span>
<span class="8329125895357939517" onmouseenter="enter('8329125895357939517');" onmouseout="out('8329125895357939517');" style=""> 716          return samples;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 717      }                                                                                                             </span>
<span  style=""> 718                                                                                                                    </span>
<span class="-1106201085093865693" onmouseenter="enter('-1106201085093865693');" onmouseout="out('-1106201085093865693');" style=""> 719      protected void ensureStartAndEndSamples(List&lt;ActivitySample&gt; samples, int tsStart, int tsEnd) {               </span>
<span class="-7875576828687087964" onmouseenter="enter('-7875576828687087964');" onmouseout="out('-7875576828687087964');" style=""> 720          if (samples == null || samples.isEmpty()) {                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 721              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722          }                                                                                                         </span>
<span class="6215771732045184164" onmouseenter="enter('6215771732045184164');" onmouseout="out('6215771732045184164');" style=""> 723          ActivitySample lastSample = samples.get(samples.size() - 1);                                              </span>
<span class="-5724051378546831092" onmouseenter="enter('-5724051378546831092');" onmouseout="out('-5724051378546831092');" style=""> 724          if (lastSample.getTimestamp() &lt; tsEnd) {                                                                  </span>
<span class="-340307626157070265" onmouseenter="enter('-340307626157070265');" onmouseout="out('-340307626157070265');" style=""> 725              samples.add(createTrailingActivitySample(lastSample, tsEnd));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 726          }                                                                                                         </span>
<span  style=""> 727                                                                                                                    </span>
<span class="-7926496395118744001" onmouseenter="enter('-7926496395118744001');" onmouseout="out('-7926496395118744001');" style=""> 728          ActivitySample firstSample = samples.get(0);                                                              </span>
<span class="-7009339048909230945" onmouseenter="enter('-7009339048909230945');" onmouseout="out('-7009339048909230945');" style=""> 729          if (firstSample.getTimestamp() &gt; tsStart) {                                                               </span>
<span class="-5264575031409257517" onmouseenter="enter('-5264575031409257517');" onmouseout="out('-5264575031409257517');" style=""> 730              samples.add(createTrailingActivitySample(firstSample, tsStart));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 731          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 732      }                                                                                                             </span>
<span  style=""> 733                                                                                                                    </span>
<span class="3833670724694452809" onmouseenter="enter('3833670724694452809');" onmouseout="out('3833670724694452809');" style=""> 734      private ActivitySample createTrailingActivitySample(ActivitySample referenceSample, int timestamp) {          </span>
<span class="-2046593497045539776" onmouseenter="enter('-2046593497045539776');" onmouseout="out('-2046593497045539776');" style=""> 735          TrailingActivitySample sample = new TrailingActivitySample();                                             </span>
<span class="1247170989116197247" onmouseenter="enter('1247170989116197247');" onmouseout="out('1247170989116197247');" style=""> 736          if (referenceSample instanceof AbstractActivitySample) {                                                  </span>
<span class="753416811428354981" onmouseenter="enter('753416811428354981');" onmouseout="out('753416811428354981');" style=""> 737              AbstractActivitySample reference = (AbstractActivitySample) referenceSample;                          </span>
<span class="179894899616756222" onmouseenter="enter('179894899616756222');" onmouseout="out('179894899616756222');" style=""> 738              sample.setUserId(reference.getUserId());                                                              </span>
<span class="-9074495792241680711" onmouseenter="enter('-9074495792241680711');" onmouseout="out('-9074495792241680711');" style=""> 739              sample.setDeviceId(reference.getDeviceId());                                                          </span>
<span class="-9156726696647878603" onmouseenter="enter('-9156726696647878603');" onmouseout="out('-9156726696647878603');" style=""> 740              sample.setProvider(reference.getProvider());                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 741          }                                                                                                         </span>
<span class="8993551488058005050" onmouseenter="enter('8993551488058005050');" onmouseout="out('8993551488058005050');" style=""> 742          sample.setTimestamp(timestamp);                                                                           </span>
<span class="1760114423996777276" onmouseenter="enter('1760114423996777276');" onmouseout="out('1760114423996777276');" style=""> 743          return sample;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 744      }                                                                                                             </span>
<span  style=""> 745                                                                                                                    </span>
<span class="-1444262751819808388" onmouseenter="enter('-1444262751819808388');" onmouseout="out('-1444262751819808388');" style=""> 746      private int getTSEnd() {                                                                                      </span>
<span class="8265537562094819633" onmouseenter="enter('8265537562094819633');" onmouseout="out('8265537562094819633');" style=""> 747          return toTimestamp(getEndDate());                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 748      }                                                                                                             </span>
<span  style=""> 749                                                                                                                    </span>
<span class="-8800656553144883662" onmouseenter="enter('-8800656553144883662');" onmouseout="out('-8800656553144883662');" style=""> 750      private int getTSStart() {                                                                                    </span>
<span class="-6038622859463971662" onmouseenter="enter('-6038622859463971662');" onmouseout="out('-6038622859463971662');" style=""> 751          return toTimestamp(getStartDate());                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 752      }                                                                                                             </span>
<span  style=""> 753                                                                                                                    </span>
<span class="-4614437324300305507" onmouseenter="enter('-4614437324300305507');" onmouseout="out('-4614437324300305507');" style=""> 754      private int toTimestamp(Date date) {                                                                          </span>
<span class="3504665279848614366" onmouseenter="enter('3504665279848614366');" onmouseout="out('3504665279848614366');" style=""> 755          return (int) ((date.getTime() / 1000));                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 756      }                                                                                                             </span>
<span  style=""> 757                                                                                                                    </span>
<span class="-4297875969128159092" onmouseenter="enter('-4297875969128159092');" onmouseout="out('-4297875969128159092');" style=""> 758      public static class DefaultChartsData&lt;T extends ChartData&lt;?&gt;&gt; extends ChartsData {                            </span>
<span class="6426673791816913577" onmouseenter="enter('6426673791816913577');" onmouseout="out('6426673791816913577');" style=""> 759          private final T data;                                                                                     </span>
<span class="-7952082456269420489" onmouseenter="enter('-7952082456269420489');" onmouseout="out('-7952082456269420489');" style=""> 760          private IAxisValueFormatter xValueFormatter;                                                              </span>
<span  style=""> 761                                                                                                                    </span>
<span class="6541589990597847820" onmouseenter="enter('6541589990597847820');" onmouseout="out('6541589990597847820');" style=""> 762          public DefaultChartsData(T data, IAxisValueFormatter xValueFormatter) {                                   </span>
<span class="5524270510531897998" onmouseenter="enter('5524270510531897998');" onmouseout="out('5524270510531897998');" style=""> 763              this.xValueFormatter = xValueFormatter;                                                               </span>
<span class="6755336779332792903" onmouseenter="enter('6755336779332792903');" onmouseout="out('6755336779332792903');" style=""> 764              this.data = data;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 765          }                                                                                                         </span>
<span  style=""> 766                                                                                                                    </span>
<span class="-2012372510684410029" onmouseenter="enter('-2012372510684410029');" onmouseout="out('-2012372510684410029');" style=""> 767          public IAxisValueFormatter getXValueFormatter() {                                                         </span>
<span class="-7533476322813168520" onmouseenter="enter('-7533476322813168520');" onmouseout="out('-7533476322813168520');" style=""> 768              return xValueFormatter;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 769          }                                                                                                         </span>
<span  style=""> 770                                                                                                                    </span>
<span class="5384784438887663423" onmouseenter="enter('5384784438887663423');" onmouseout="out('5384784438887663423');" style=""> 771          public T getData() {                                                                                      </span>
<span class="2885311051796901480" onmouseenter="enter('2885311051796901480');" onmouseout="out('2885311051796901480');" style=""> 772              return data;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 773          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 774      }                                                                                                             </span>
<span  style=""> 775                                                                                                                    </span>
<span class="1326180124040264963" onmouseenter="enter('1326180124040264963');" onmouseout="out('1326180124040264963');" style=""> 776      protected static class SampleXLabelFormatter implements IAxisValueFormatter {                                 </span>
<span class="5353010427567723059" onmouseenter="enter('5353010427567723059');" onmouseout="out('5353010427567723059');" style=""> 777          private final TimestampTranslation tsTranslation;                                                         </span>
<span class="-3636759102507942125" onmouseenter="enter('-3636759102507942125');" onmouseout="out('-3636759102507942125');" style=""> 778          SimpleDateFormat annotationDateFormat = new SimpleDateFormat(&quot;HH:mm&quot;);                                    </span>
<span class="1540142582082446680" onmouseenter="enter('1540142582082446680');" onmouseout="out('1540142582082446680');" style=""> 779  //        SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd.MM.yyyy HH:mm&quot;);                                 </span>
<span class="4878211627103907492" onmouseenter="enter('4878211627103907492');" onmouseout="out('4878211627103907492');" style=""> 780          Calendar cal = GregorianCalendar.getInstance();                                                           </span>
<span  style=""> 781                                                                                                                    </span>
<span class="5120004681237147878" onmouseenter="enter('5120004681237147878');" onmouseout="out('5120004681237147878');" style=""> 782          public SampleXLabelFormatter(TimestampTranslation tsTranslation) {                                        </span>
<span class="332289991409172359" onmouseenter="enter('332289991409172359');" onmouseout="out('332289991409172359');" style=""> 783              this.tsTranslation = tsTranslation;                                                                   </span>
<span  style=""> 784                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 785          }                                                                                                         </span>
<span class="9166492997131092423" onmouseenter="enter('9166492997131092423');" onmouseout="out('9166492997131092423');" style=""> 786          // TODO: this does not work. Cannot use precomputed labels                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 787          @Override                                                                                                 </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 788          public String getFormattedValue(float value, AxisBase axis) {                                             </span>
<span class="7424853438265862645" onmouseenter="enter('7424853438265862645');" onmouseout="out('7424853438265862645');" style=""> 789              cal.clear();                                                                                          </span>
<span class="-8022679979208902148" onmouseenter="enter('-8022679979208902148');" onmouseout="out('-8022679979208902148');" style=""> 790              int ts = (int) value;                                                                                 </span>
<span class="-2120013244284691976" onmouseenter="enter('-2120013244284691976');" onmouseout="out('-2120013244284691976');" style=""> 791              cal.setTimeInMillis(tsTranslation.toOriginalValue(ts) * 1000L);                                       </span>
<span class="-5878359517855184171" onmouseenter="enter('-5878359517855184171');" onmouseout="out('-5878359517855184171');" style=""> 792              Date date = cal.getTime();                                                                            </span>
<span class="-2286280998074804817" onmouseenter="enter('-2286280998074804817');" onmouseout="out('-2286280998074804817');" style=""> 793              String dateString = annotationDateFormat.format(date);                                                </span>
<span class="-4331225868129427907" onmouseenter="enter('-4331225868129427907');" onmouseout="out('-4331225868129427907');" style=""> 794              return dateString;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 795          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 796      }                                                                                                             </span>
<span  style=""> 797                                                                                                                    </span>
<span class="853591074258071334" onmouseenter="enter('853591074258071334');" onmouseout="out('853591074258071334');" style=""> 798      protected static class PreformattedXIndexLabelFormatter implements IAxisValueFormatter {                      </span>
<span class="-5932642099782009782" onmouseenter="enter('-5932642099782009782');" onmouseout="out('-5932642099782009782');" style=""> 799          private ArrayList&lt;String&gt; xLabels;                                                                        </span>
<span  style=""> 800                                                                                                                    </span>
<span class="-3496008191511610310" onmouseenter="enter('-3496008191511610310');" onmouseout="out('-3496008191511610310');" style=""> 801          public PreformattedXIndexLabelFormatter(ArrayList&lt;String&gt; xLabels) {                                      </span>
<span class="1925102162908705801" onmouseenter="enter('1925102162908705801');" onmouseout="out('1925102162908705801');" style=""> 802              this.xLabels = xLabels;                                                                               </span>
<span  style=""> 803                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804          }                                                                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 805          @Override                                                                                                 </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 806          public String getFormattedValue(float value, AxisBase axis) {                                             </span>
<span class="-6653294473874823013" onmouseenter="enter('-6653294473874823013');" onmouseout="out('-6653294473874823013');" style=""> 807              int index = (int) value;                                                                              </span>
<span class="-6571719897851150925" onmouseenter="enter('-6571719897851150925');" onmouseout="out('-6571719897851150925');" style=""> 808              if (xLabels == null || index &gt;= xLabels.size()) {                                                     </span>
<span class="-889824612483989703" onmouseenter="enter('-889824612483989703');" onmouseout="out('-889824612483989703');" style=""> 809                  return String.valueOf(value);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 810              }                                                                                                     </span>
<span class="-5802960474501370558" onmouseenter="enter('-5802960474501370558');" onmouseout="out('-5802960474501370558');" style=""> 811              return xLabels.get(index);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 813      }                                                                                                             </span>
<span  style=""> 814                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 815      /**                                                                                                           </span>
<span class="6592799195109599568" onmouseenter="enter('6592799195109599568');" onmouseout="out('6592799195109599568');" style=""> 816       * Awkward class that helps in translating long timestamp                                                     </span>
<span class="-2647406073998843607" onmouseenter="enter('-2647406073998843607');" onmouseout="out('-2647406073998843607');" style=""> 817       * values to float (sic!) values. It basically rebases all                                                    </span>
<span class="-6950802996886985644" onmouseenter="enter('-6950802996886985644');" onmouseout="out('-6950802996886985644');" style=""> 818       * timestamps to a base (the very first) timestamp value.                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 819       *                                                                                                            </span>
<span class="467771366063509856" onmouseenter="enter('467771366063509856');" onmouseout="out('467771366063509856');" style=""> 820       * It does this so that the large timestamp values can be used                                                </span>
<span class="-3960902832668220629" onmouseenter="enter('-3960902832668220629');" onmouseout="out('-3960902832668220629');" style=""> 821       * floating point values, where the mantissa is just 24 bits.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 822       */                                                                                                           </span>
<span class="3353052654588926596" onmouseenter="enter('3353052654588926596');" onmouseout="out('3353052654588926596');" style=""> 823      protected static class TimestampTranslation {                                                                 </span>
<span class="-8324695427159884252" onmouseenter="enter('-8324695427159884252');" onmouseout="out('-8324695427159884252');" style=""> 824          private int tsOffset = -1;                                                                                </span>
<span  style=""> 825                                                                                                                    </span>
<span class="-2038703014401681062" onmouseenter="enter('-2038703014401681062');" onmouseout="out('-2038703014401681062');" style=""> 826          public int shorten(int timestamp) {                                                                       </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 827              if (tsOffset == -1) {                                                                                 </span>
<span class="5713941682084663603" onmouseenter="enter('5713941682084663603');" onmouseout="out('5713941682084663603');" style=""> 828                  tsOffset = timestamp;                                                                             </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 829                  return 0;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 830              }                                                                                                     </span>
<span class="-455923503597890370" onmouseenter="enter('-455923503597890370');" onmouseout="out('-455923503597890370');" style=""> 831              return timestamp - tsOffset;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832          }                                                                                                         </span>
<span  style=""> 833                                                                                                                    </span>
<span class="-7013677261634300092" onmouseenter="enter('-7013677261634300092');" onmouseout="out('-7013677261634300092');" style=""> 834          public int toOriginalValue(int timestamp) {                                                               </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 835              if (tsOffset == -1) {                                                                                 </span>
<span class="-3020799636637211745" onmouseenter="enter('-3020799636637211745');" onmouseout="out('-3020799636637211745');" style=""> 836                  return timestamp;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 837              }                                                                                                     </span>
<span class="-7912123621537489577" onmouseenter="enter('-7912123621537489577');" onmouseout="out('-7912123621537489577');" style=""> 838              return timestamp + tsOffset;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 840      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 841  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="8232473818974975943" onmouseenter="enter('8232473818974975943');" onmouseout="out('8232473818974975943');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   1 -/*  Copyright (C) 2015-2017 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                            </span>
<span class="-5200878630337924680" onmouseenter="enter('-5200878630337924680');" onmouseout="out('-5200878630337924680');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   2 +/*  Copyright (C) 2015-2018 0nse, Andreas Shimokawa, Carsten Pfeiffer,                                            </span>
<span class="2448951400902124304" onmouseenter="enter('2448951400902124304');" onmouseout="out('2448951400902124304');" style="">   3      Daniele Gobbetti, walkjivefly                                                                                 </span>
<span  style="">   4                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   5      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   6                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   7      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   8      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   9      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">  10      (at your option) any later version.                                                                           </span>
<span  style="">  11                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  12      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  13      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  14      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  15      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  16                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  17      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  18      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="8669690300131154388" onmouseenter="enter('8669690300131154388');" onmouseout="out('8669690300131154388');" style="">  19  package nodomain.freeyourgadget.gadgetbridge.activities.charts;                                                   </span>
<span  style="">  20                                                                                                                    </span>
<span class="-489389385851058391" onmouseenter="enter('-489389385851058391');" onmouseout="out('-489389385851058391');" style="">  21  import android.content.BroadcastReceiver;                                                                         </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  22  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  23  import android.content.Intent;                                                                                    </span>
<span class="8697221465021235869" onmouseenter="enter('8697221465021235869');" onmouseout="out('8697221465021235869');" style="">  24  import android.content.IntentFilter;                                                                              </span>
<span class="955674827050616793" onmouseenter="enter('955674827050616793');" onmouseout="out('955674827050616793');" style="">  25  import android.os.AsyncTask;                                                                                      </span>
<span class="8096531590004379472" onmouseenter="enter('8096531590004379472');" onmouseout="out('8096531590004379472');" style="">  26  import android.os.Bundle;                                                                                         </span>
<span class="4394652512097310678" onmouseenter="enter('4394652512097310678');" onmouseout="out('4394652512097310678');" style="">  27  import android.support.annotation.Nullable;                                                                       </span>
<span class="5561867782528330628" onmouseenter="enter('5561867782528330628');" onmouseout="out('5561867782528330628');" style="">  28  import android.support.v4.app.FragmentActivity;                                                                   </span>
<span class="-3586823955743508894" onmouseenter="enter('-3586823955743508894');" onmouseout="out('-3586823955743508894');" style="">  29  import android.support.v4.content.ContextCompat;                                                                  </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  30  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  31  import android.util.TypedValue;                                                                                   </span>
<span class="-8980485571216513882" onmouseenter="enter('-8980485571216513882');" onmouseout="out('-8980485571216513882');" style="">  32  import android.view.View;                                                                                         </span>
<span  style="">  33                                                                                                                    </span>
<span class="2052752975691556393" onmouseenter="enter('2052752975691556393');" onmouseout="out('2052752975691556393');" style="">  34  import com.github.mikephil.charting.charts.BarChart;                                                              </span>
<span class="-7530008699315861247" onmouseenter="enter('-7530008699315861247');" onmouseout="out('-7530008699315861247');" style="">  35  import com.github.mikephil.charting.charts.BarLineChartBase;                                                      </span>
<span class="-2340851656771232402" onmouseenter="enter('-2340851656771232402');" onmouseout="out('-2340851656771232402');" style="">  36  import com.github.mikephil.charting.charts.Chart;                                                                 </span>
<span class="1306294111757562979" onmouseenter="enter('1306294111757562979');" onmouseout="out('1306294111757562979');" style="">  37  import com.github.mikephil.charting.components.AxisBase;                                                          </span>
<span class="-968159151538268968" onmouseenter="enter('-968159151538268968');" onmouseout="out('-968159151538268968');" style="">  38  import com.github.mikephil.charting.components.YAxis;                                                             </span>
<span class="4145381455536678498" onmouseenter="enter('4145381455536678498');" onmouseout="out('4145381455536678498');" style="">  39  import com.github.mikephil.charting.data.ChartData;                                                               </span>
<span class="-6979157771929244358" onmouseenter="enter('-6979157771929244358');" onmouseout="out('-6979157771929244358');" style="">  40  import com.github.mikephil.charting.data.Entry;                                                                   </span>
<span class="-1647496247863422182" onmouseenter="enter('-1647496247863422182');" onmouseout="out('-1647496247863422182');" style="">  41  import com.github.mikephil.charting.data.LineData;                                                                </span>
<span class="-2418175485781437143" onmouseenter="enter('-2418175485781437143');" onmouseout="out('-2418175485781437143');" style="">  42  import com.github.mikephil.charting.data.LineDataSet;                                                             </span>
<span class="5272555707203763230" onmouseenter="enter('5272555707203763230');" onmouseout="out('5272555707203763230');" style="">  43  import com.github.mikephil.charting.formatter.IAxisValueFormatter;                                                </span>
<span class="2256452517983808356" onmouseenter="enter('2256452517983808356');" onmouseout="out('2256452517983808356');" style="">  44  import com.github.mikephil.charting.interfaces.datasets.ILineDataSet;                                             </span>
<span  style="">  45                                                                                                                    </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  46  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  47  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  48                                                                                                                    </span>
<span class="54331962280914690" onmouseenter="enter('54331962280914690');" onmouseout="out('54331962280914690');" style="">  49  import java.text.SimpleDateFormat;                                                                                </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  50  import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  51  import java.util.Arrays;                                                                                          </span>
<span class="1562735530241225598" onmouseenter="enter('1562735530241225598');" onmouseout="out('1562735530241225598');" style="">  52  import java.util.Calendar;                                                                                        </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  53  import java.util.Date;                                                                                            </span>
<span class="-4685965902094386510" onmouseenter="enter('-4685965902094386510');" onmouseout="out('-4685965902094386510');" style="">  54  import java.util.GregorianCalendar;                                                                               </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  55  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  56  import java.util.List;                                                                                            </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="">  57  import java.util.Set;                                                                                             </span>
<span  style="">  58                                                                                                                    </span>
<span class="-8113221927992302576" onmouseenter="enter('-8113221927992302576');" onmouseout="out('-8113221927992302576');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.GBApplication;                                                        </span>
<span class="-7198279398549834921" onmouseenter="enter('-7198279398549834921');" onmouseout="out('-7198279398549834921');" style="">  60  import nodomain.freeyourgadget.gadgetbridge.R;                                                                    </span>
<span class="5401974517372835423" onmouseenter="enter('5401974517372835423');" onmouseout="out('5401974517372835423');" style="">  61  import nodomain.freeyourgadget.gadgetbridge.activities.AbstractGBFragment;                                        </span>
<span class="-7512545990884107322" onmouseenter="enter('-7512545990884107322');" onmouseout="out('-7512545990884107322');" style="">  62  import nodomain.freeyourgadget.gadgetbridge.activities.HeartRateUtils;                                            </span>
<span class="-7899456532042317044" onmouseenter="enter('-7899456532042317044');" onmouseout="out('-7899456532042317044');" style="">  63  import nodomain.freeyourgadget.gadgetbridge.database.DBAccess;                                                    </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  64  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="6852267181356803593" onmouseenter="enter('6852267181356803593');" onmouseout="out('6852267181356803593');" style="">  65  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceCoordinator;                                            </span>
<span class="-4858662006453759829" onmouseenter="enter('-4858662006453759829');" onmouseout="out('-4858662006453759829');" style="">  66  import nodomain.freeyourgadget.gadgetbridge.devices.SampleProvider;                                               </span>
<span class="6164643418103516215" onmouseenter="enter('6164643418103516215');" onmouseout="out('6164643418103516215');" style="">  67  import nodomain.freeyourgadget.gadgetbridge.entities.AbstractActivitySample;                                      </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  68  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="5185434099904652174" onmouseenter="enter('5185434099904652174');" onmouseout="out('5185434099904652174');" style="">  69  import nodomain.freeyourgadget.gadgetbridge.model.ActivityKind;                                                   </span>
<span class="-4763610359710127205" onmouseenter="enter('-4763610359710127205');" onmouseout="out('-4763610359710127205');" style="">  70  import nodomain.freeyourgadget.gadgetbridge.model.ActivitySample;                                                 </span>
<span class="-904534361809820117" onmouseenter="enter('-904534361809820117');" onmouseout="out('-904534361809820117');" style="">  71  import nodomain.freeyourgadget.gadgetbridge.util.DateTimeUtils;                                                   </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  72  import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                                    </span>
<span  style="">  73                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  74  /**                                                                                                               </span>
<span class="4382979016472627606" onmouseenter="enter('4382979016472627606');" onmouseout="out('4382979016472627606');" style="">  75   * A base class fragment to be used with ChartsActivity. The fragment can supply                                  </span>
<span class="6198461617436424812" onmouseenter="enter('6198461617436424812');" onmouseout="out('6198461617436424812');" style="">  76   * a title to be displayed in the activity by returning non-null in #getTitle()                                   </span>
<span class="-6728528830408447290" onmouseenter="enter('-6728528830408447290');" onmouseout="out('-6728528830408447290');" style="">  77   * Broadcast events can be received by overriding #onReceive(Context,Intent).                                     </span>
<span class="-8995811574793439040" onmouseenter="enter('-8995811574793439040');" onmouseout="out('-8995811574793439040');" style="">  78   * The chart can be refreshed by calling #refresh()                                                               </span>
<span class="7522934711128650596" onmouseenter="enter('7522934711128650596');" onmouseout="out('7522934711128650596');" style="">  79   * Implement refreshInBackground(DBHandler, GBDevice) to fetch the samples from the DB,                           </span>
<span class="-6728676085228773380" onmouseenter="enter('-6728676085228773380');" onmouseout="out('-6728676085228773380');" style="">  80   * and add the samples to the chart. The actual rendering, which must be performed in the UI                      </span>
<span class="-8407485021089725057" onmouseenter="enter('-8407485021089725057');" onmouseout="out('-8407485021089725057');" style="">  81   * thread, must be done in #renderCharts().                                                                       </span>
<span class="-4722043031183050825" onmouseenter="enter('-4722043031183050825');" onmouseout="out('-4722043031183050825');" style="">  82   * Access functionality of the hosting activity with #getHost()                                                   </span>
<span class="4294780129258405519" onmouseenter="enter('4294780129258405519');" onmouseout="out('4294780129258405519');" style="">  83   * &lt;p/&gt;                                                                                                           </span>
<span class="4386326732920470462" onmouseenter="enter('4386326732920470462');" onmouseout="out('4386326732920470462');" style="">  84   * The hosting ChartsHost activity provides a section for displaying a date or date range                         </span>
<span class="6958843947366179987" onmouseenter="enter('6958843947366179987');" onmouseout="out('6958843947366179987');" style="">  85   * being the basis for the chart, as well as two buttons for moving backwards and forward                         </span>
<span class="2417558347604794742" onmouseenter="enter('2417558347604794742');" onmouseout="out('2417558347604794742');" style="">  86   * in time. The date is held by the activity, so that it can be shared by multiple chart                          </span>
<span class="7607748487874207999" onmouseenter="enter('7607748487874207999');" onmouseout="out('7607748487874207999');" style="">  87   * fragments. It is still the responsibility of the (currently visible) chart fragment                            </span>
<span class="-3870094542515027002" onmouseenter="enter('-3870094542515027002');" onmouseout="out('-3870094542515027002');" style="">  88   * to set the desired date in the ChartsActivity via #setDateRange(Date,Date).                                    </span>
<span class="3680713202748276357" onmouseenter="enter('3680713202748276357');" onmouseout="out('3680713202748276357');" style="">  89   * The default implementations #handleDatePrev(Date,Date) and #handleDateNext(Date,Date)                          </span>
<span class="-222466413472697410" onmouseenter="enter('-222466413472697410');" onmouseout="out('-222466413472697410');" style="">  90   * shift the date by one day.                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  91   */                                                                                                               </span>
<span class="559507359319980575" onmouseenter="enter('559507359319980575');" onmouseout="out('559507359319980575');" style="">  92  public abstract class AbstractChartFragment extends AbstractGBFragment {                                          </span>
<span class="-5476773025248141464" onmouseenter="enter('-5476773025248141464');" onmouseout="out('-5476773025248141464');" style="">  93      protected final int ANIM_TIME = 250;                                                                          </span>
<span  style="">  94                                                                                                                    </span>
<span class="2603683647820710396" onmouseenter="enter('2603683647820710396');" onmouseout="out('2603683647820710396');" style="">  95      private static final Logger LOG = LoggerFactory.getLogger(AbstractChartFragment.class);                       </span>
<span  style="">  96                                                                                                                    </span>
<span class="-7304707645666720924" onmouseenter="enter('-7304707645666720924');" onmouseout="out('-7304707645666720924');" style="">  97      private final Set&lt;String&gt; mIntentFilterActions;                                                               </span>
<span class="4625474178666977899" onmouseenter="enter('4625474178666977899');" onmouseout="out('4625474178666977899');" style="">  98      private final BroadcastReceiver mReceiver = new BroadcastReceiver() {                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  99          @Override                                                                                                 </span>
<span class="-1520739091809898546" onmouseenter="enter('-1520739091809898546');" onmouseout="out('-1520739091809898546');" style=""> 100          public void onReceive(Context context, Intent intent) {                                                   </span>
<span class="1765483774466236680" onmouseenter="enter('1765483774466236680');" onmouseout="out('1765483774466236680');" style=""> 101              AbstractChartFragment.this.onReceive(context, intent);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 103      };                                                                                                            </span>
<span class="-5489121822050726001" onmouseenter="enter('-5489121822050726001');" onmouseout="out('-5489121822050726001');" style=""> 104      private boolean mChartDirty = true;                                                                           </span>
<span class="-5677382414532787847" onmouseenter="enter('-5677382414532787847');" onmouseout="out('-5677382414532787847');" style=""> 105      private AsyncTask refreshTask;                                                                                </span>
<span  style=""> 106                                                                                                                    </span>
<span class="-4343134957952038703" onmouseenter="enter('-4343134957952038703');" onmouseout="out('-4343134957952038703');" style=""> 107      public boolean isChartDirty() {                                                                               </span>
<span class="-2572162510293790028" onmouseenter="enter('-2572162510293790028');" onmouseout="out('-2572162510293790028');" style=""> 108          return mChartDirty;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109      }                                                                                                             </span>
<span  style=""> 110                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 111      @Override                                                                                                     </span>
<span class="-601773936482381085" onmouseenter="enter('-601773936482381085');" onmouseout="out('-601773936482381085');" style=""> 112      public abstract String getTitle();                                                                            </span>
<span  style=""> 113                                                                                                                    </span>
<span class="-6644558066866151773" onmouseenter="enter('-6644558066866151773');" onmouseout="out('-6644558066866151773');" style=""> 114      public boolean supportsHeartrate(GBDevice device) {                                                           </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 115          DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);                        </span>
<span class="-7840206560907481536" onmouseenter="enter('-7840206560907481536');" onmouseout="out('-7840206560907481536');" style=""> 116          return coordinator != null &amp;&amp; coordinator.supportsHeartRateMeasurement(device);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117      }                                                                                                             </span>
<span  style=""> 118                                                                                                                    </span>
<span class="-8993184091203127788" onmouseenter="enter('-8993184091203127788');" onmouseout="out('-8993184091203127788');" style=""> 119      protected static final class ActivityConfig {                                                                 </span>
<span class="-6704927139853267025" onmouseenter="enter('-6704927139853267025');" onmouseout="out('-6704927139853267025');" style=""> 120          public final int type;                                                                                    </span>
<span class="8777140454183587055" onmouseenter="enter('8777140454183587055');" onmouseout="out('8777140454183587055');" style=""> 121          public final String label;                                                                                </span>
<span class="-5618013352645865591" onmouseenter="enter('-5618013352645865591');" onmouseout="out('-5618013352645865591');" style=""> 122          public final Integer color;                                                                               </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-5628392649151863187" onmouseenter="enter('-5628392649151863187');" onmouseout="out('-5628392649151863187');" style=""> 124          public ActivityConfig(int kind, String label, Integer color) {                                            </span>
<span class="-7354691670901086033" onmouseenter="enter('-7354691670901086033');" onmouseout="out('-7354691670901086033');" style=""> 125              this.type = kind;                                                                                     </span>
<span class="-6752321514731327997" onmouseenter="enter('-6752321514731327997');" onmouseout="out('-6752321514731327997');" style=""> 126              this.label = label;                                                                                   </span>
<span class="-589508620284177092" onmouseenter="enter('-589508620284177092');" onmouseout="out('-589508620284177092');" style=""> 127              this.color = color;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="-727072152722713884" onmouseenter="enter('-727072152722713884');" onmouseout="out('-727072152722713884');" style=""> 131      protected ActivityConfig akActivity;                                                                          </span>
<span class="1693165293269506698" onmouseenter="enter('1693165293269506698');" onmouseout="out('1693165293269506698');" style=""> 132      protected ActivityConfig akLightSleep;                                                                        </span>
<span class="1060880569004609468" onmouseenter="enter('1060880569004609468');" onmouseout="out('1060880569004609468');" style=""> 133      protected ActivityConfig akDeepSleep;                                                                         </span>
<span class="-4297327045522896814" onmouseenter="enter('-4297327045522896814');" onmouseout="out('-4297327045522896814');" style=""> 134      protected ActivityConfig akNotWorn;                                                                           </span>
<span  style=""> 135                                                                                                                    </span>
<span  style=""> 136                                                                                                                    </span>
<span class="-1563135362317192224" onmouseenter="enter('-1563135362317192224');" onmouseout="out('-1563135362317192224');" style=""> 137      protected int BACKGROUND_COLOR;                                                                               </span>
<span class="4601305514601887958" onmouseenter="enter('4601305514601887958');" onmouseout="out('4601305514601887958');" style=""> 138      protected int DESCRIPTION_COLOR;                                                                              </span>
<span class="-3468694148212670828" onmouseenter="enter('-3468694148212670828');" onmouseout="out('-3468694148212670828');" style=""> 139      protected int CHART_TEXT_COLOR;                                                                               </span>
<span class="655929690321793162" onmouseenter="enter('655929690321793162');" onmouseout="out('655929690321793162');" style=""> 140      protected int LEGEND_TEXT_COLOR;                                                                              </span>
<span class="-6693974409973768071" onmouseenter="enter('-6693974409973768071');" onmouseout="out('-6693974409973768071');" style=""> 141      protected int HEARTRATE_COLOR;                                                                                </span>
<span class="7021362809515932268" onmouseenter="enter('7021362809515932268');" onmouseout="out('7021362809515932268');" style=""> 142      protected int HEARTRATE_FILL_COLOR;                                                                           </span>
<span class="-4670234814499331326" onmouseenter="enter('-4670234814499331326');" onmouseout="out('-4670234814499331326');" style=""> 143      protected int AK_ACTIVITY_COLOR;                                                                              </span>
<span class="-5660897269888657930" onmouseenter="enter('-5660897269888657930');" onmouseout="out('-5660897269888657930');" style=""> 144      protected int AK_DEEP_SLEEP_COLOR;                                                                            </span>
<span class="-91394691221270038" onmouseenter="enter('-91394691221270038');" onmouseout="out('-91394691221270038');" style=""> 145      protected int AK_LIGHT_SLEEP_COLOR;                                                                           </span>
<span class="1634608154221638802" onmouseenter="enter('1634608154221638802');" onmouseout="out('1634608154221638802');" style=""> 146      protected int AK_NOT_WORN_COLOR;                                                                              </span>
<span  style=""> 147                                                                                                                    </span>
<span class="-1398408580326282750" onmouseenter="enter('-1398408580326282750');" onmouseout="out('-1398408580326282750');" style=""> 148      protected String HEARTRATE_LABEL;                                                                             </span>
<span  style=""> 149                                                                                                                    </span>
<span class="-2100943369183848946" onmouseenter="enter('-2100943369183848946');" onmouseout="out('-2100943369183848946');" style=""> 150      protected AbstractChartFragment(String... intentFilterActions) {                                              </span>
<span class="4300273923814153332" onmouseenter="enter('4300273923814153332');" onmouseout="out('4300273923814153332');" style=""> 151          mIntentFilterActions = new HashSet&lt;&gt;();                                                                   </span>
<span class="1794017280726845715" onmouseenter="enter('1794017280726845715');" onmouseout="out('1794017280726845715');" style=""> 152          if (intentFilterActions != null) {                                                                        </span>
<span class="-5245442559338563943" onmouseenter="enter('-5245442559338563943');" onmouseout="out('-5245442559338563943');" style=""> 153              mIntentFilterActions.addAll(Arrays.asList(intentFilterActions));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154          }                                                                                                         </span>
<span class="-8699894582101860078" onmouseenter="enter('-8699894582101860078');" onmouseout="out('-8699894582101860078');" style=""> 155          mIntentFilterActions.add(ChartsHost.DATE_NEXT);                                                           </span>
<span class="6561361583014083383" onmouseenter="enter('6561361583014083383');" onmouseout="out('6561361583014083383');" style=""> 156          mIntentFilterActions.add(ChartsHost.DATE_PREV);                                                           </span>
<span class="775005401617860596" onmouseenter="enter('775005401617860596');" onmouseout="out('775005401617860596');" style=""> 157          mIntentFilterActions.add(ChartsHost.REFRESH);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158      }                                                                                                             </span>
<span  style=""> 159                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 160      @Override                                                                                                     </span>
<span class="2351026872416697132" onmouseenter="enter('2351026872416697132');" onmouseout="out('2351026872416697132');" style=""> 161      public void onCreate(Bundle savedInstanceState) {                                                             </span>
<span class="8760898167212384157" onmouseenter="enter('8760898167212384157');" onmouseout="out('8760898167212384157');" style=""> 162          super.onCreate(savedInstanceState);                                                                       </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-1498726564668589193" onmouseenter="enter('-1498726564668589193');" onmouseout="out('-1498726564668589193');" style=""> 164          init();                                                                                                   </span>
<span  style=""> 165                                                                                                                    </span>
<span class="1309295186849327913" onmouseenter="enter('1309295186849327913');" onmouseout="out('1309295186849327913');" style=""> 166          IntentFilter filter = new IntentFilter();                                                                 </span>
<span class="6467646639596248655" onmouseenter="enter('6467646639596248655');" onmouseout="out('6467646639596248655');" style=""> 167          for (String action : mIntentFilterActions) {                                                              </span>
<span class="-2086107330814500487" onmouseenter="enter('-2086107330814500487');" onmouseout="out('-2086107330814500487');" style=""> 168              filter.addAction(action);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169          }                                                                                                         </span>
<span class="3395895708962590803" onmouseenter="enter('3395895708962590803');" onmouseout="out('3395895708962590803');" style=""> 170          LocalBroadcastManager.getInstance(getActivity()).registerReceiver(mReceiver, filter);                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171      }                                                                                                             </span>
<span  style=""> 172                                                                                                                    </span>
<span class="-2182533896997661648" onmouseenter="enter('-2182533896997661648');" onmouseout="out('-2182533896997661648');" style=""> 173      protected void init() {                                                                                       </span>
<span class="-4278963507477628649" onmouseenter="enter('-4278963507477628649');" onmouseout="out('-4278963507477628649');" style=""> 174          TypedValue runningColor = new TypedValue();                                                               </span>
<span class="2364262805070128994" onmouseenter="enter('2364262805070128994');" onmouseout="out('2364262805070128994');" style=""> 175          BACKGROUND_COLOR = GBApplication.getBackgroundColor(getContext());                                        </span>
<span class="4636662852620032981" onmouseenter="enter('4636662852620032981');" onmouseout="out('4636662852620032981');" style=""> 176          LEGEND_TEXT_COLOR = DESCRIPTION_COLOR = GBApplication.getTextColor(getContext());                         </span>
<span class="7979803013168270964" onmouseenter="enter('7979803013168270964');" onmouseout="out('7979803013168270964');" style=""> 177          CHART_TEXT_COLOR = ContextCompat.getColor(getContext(), R.color.secondarytext);                           </span>
<span class="-5448842132740870532" onmouseenter="enter('-5448842132740870532');" onmouseout="out('-5448842132740870532');" style=""> 178          HEARTRATE_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate);                          </span>
<span class="3818219289719008809" onmouseenter="enter('3818219289719008809');" onmouseout="out('3818219289719008809');" style=""> 179          HEARTRATE_FILL_COLOR = ContextCompat.getColor(getContext(), R.color.chart_heartrate_fill);                </span>
<span class="-658032213271338857" onmouseenter="enter('-658032213271338857');" onmouseout="out('-658032213271338857');" style=""> 180          getContext().getTheme().resolveAttribute(R.attr.chart_activity, runningColor, true);                      </span>
<span class="3784973835189342522" onmouseenter="enter('3784973835189342522');" onmouseout="out('3784973835189342522');" style=""> 181          AK_ACTIVITY_COLOR = runningColor.data;                                                                    </span>
<span class="-7347375883805936743" onmouseenter="enter('-7347375883805936743');" onmouseout="out('-7347375883805936743');" style=""> 182          getContext().getTheme().resolveAttribute(R.attr.chart_deep_sleep, runningColor, true);                    </span>
<span class="9138233377044964354" onmouseenter="enter('9138233377044964354');" onmouseout="out('9138233377044964354');" style=""> 183          AK_DEEP_SLEEP_COLOR = runningColor.data;                                                                  </span>
<span class="-7879866390823759405" onmouseenter="enter('-7879866390823759405');" onmouseout="out('-7879866390823759405');" style=""> 184          getContext().getTheme().resolveAttribute(R.attr.chart_light_sleep, runningColor, true);                   </span>
<span class="-7375963623584937470" onmouseenter="enter('-7375963623584937470');" onmouseout="out('-7375963623584937470');" style=""> 185          AK_LIGHT_SLEEP_COLOR = runningColor.data;                                                                 </span>
<span class="-4015774126818841529" onmouseenter="enter('-4015774126818841529');" onmouseout="out('-4015774126818841529');" style=""> 186          getContext().getTheme().resolveAttribute(R.attr.chart_not_worn, runningColor, true);                      </span>
<span class="-5596972182818856924" onmouseenter="enter('-5596972182818856924');" onmouseout="out('-5596972182818856924');" style=""> 187          AK_NOT_WORN_COLOR = runningColor.data;                                                                    </span>
<span  style=""> 188                                                                                                                    </span>
<span class="-8151372900676559714" onmouseenter="enter('-8151372900676559714');" onmouseout="out('-8151372900676559714');" style=""> 189          HEARTRATE_LABEL = getContext().getString(R.string.charts_legend_heartrate);                               </span>
<span  style=""> 190                                                                                                                    </span>
<span class="7336078921795716816" onmouseenter="enter('7336078921795716816');" onmouseout="out('7336078921795716816');" style=""><abbr title=" 191          akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kind_activity), AK_ACTIVITY_COLOR);"> 191          akActivity = new ActivityConfig(ActivityKind.TYPE_ACTIVITY, getString(R.string.abstract_chart_fragment_kinðŸ”µ</abbr></span>
<span class="7421775491088103388" onmouseenter="enter('7421775491088103388');" onmouseout="out('7421775491088103388');" style=""><abbr title=" 192          akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragment_kind_light_sleep), AK_LIGHT_SLEEP_COLOR);"> 192          akLightSleep = new ActivityConfig(ActivityKind.TYPE_LIGHT_SLEEP, getString(R.string.abstract_chart_fragmenðŸ”µ</abbr></span>
<span class="-7577615369032967062" onmouseenter="enter('-7577615369032967062');" onmouseout="out('-7577615369032967062');" style=""><abbr title=" 193          akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_kind_deep_sleep), AK_DEEP_SLEEP_COLOR);"> 193          akDeepSleep = new ActivityConfig(ActivityKind.TYPE_DEEP_SLEEP, getString(R.string.abstract_chart_fragment_ðŸ”µ</abbr></span>
<span class="4963911460392329978" onmouseenter="enter('4963911460392329978');" onmouseout="out('4963911460392329978');" style=""><abbr title=" 194          akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kind_not_worn), AK_NOT_WORN_COLOR);"> 194          akNotWorn = new ActivityConfig(ActivityKind.TYPE_NOT_WORN, getString(R.string.abstract_chart_fragment_kindðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-495990486128602071" onmouseenter="enter('-495990486128602071');" onmouseout="out('-495990486128602071');" style=""> 197      private void setStartDate(Date date) {                                                                        </span>
<span class="-1228970384434949212" onmouseenter="enter('-1228970384434949212');" onmouseout="out('-1228970384434949212');" style=""> 198          getChartsHost().setStartDate(date);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199      }                                                                                                             </span>
<span  style=""> 200                                                                                                                    </span>
<span class="2390100272250745956" onmouseenter="enter('2390100272250745956');" onmouseout="out('2390100272250745956');" style=""> 201      @Nullable                                                                                                     </span>
<span class="3611118571382248517" onmouseenter="enter('3611118571382248517');" onmouseout="out('3611118571382248517');" style=""> 202      protected ChartsHost getChartsHost() {                                                                        </span>
<span class="2661597057438137706" onmouseenter="enter('2661597057438137706');" onmouseout="out('2661597057438137706');" style=""> 203          return (ChartsHost) getActivity();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="-1308916602749590522" onmouseenter="enter('-1308916602749590522');" onmouseout="out('-1308916602749590522');" style=""> 206      private void setEndDate(Date date) {                                                                          </span>
<span class="-3659353165994754543" onmouseenter="enter('-3659353165994754543');" onmouseout="out('-3659353165994754543');" style=""> 207          getChartsHost().setEndDate(date);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208      }                                                                                                             </span>
<span  style=""> 209                                                                                                                    </span>
<span class="-2894059945991900133" onmouseenter="enter('-2894059945991900133');" onmouseout="out('-2894059945991900133');" style=""> 210      public Date getStartDate() {                                                                                  </span>
<span class="8926139361389921832" onmouseenter="enter('8926139361389921832');" onmouseout="out('8926139361389921832');" style=""> 211          return getChartsHost().getStartDate();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212      }                                                                                                             </span>
<span  style=""> 213                                                                                                                    </span>
<span class="2846153489913780034" onmouseenter="enter('2846153489913780034');" onmouseout="out('2846153489913780034');" style=""> 214      public Date getEndDate() {                                                                                    </span>
<span class="7835534291730041186" onmouseenter="enter('7835534291730041186');" onmouseout="out('7835534291730041186');" style=""> 215          return getChartsHost().getEndDate();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216      }                                                                                                             </span>
<span  style=""> 217                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 218      /**                                                                                                           </span>
<span class="3608187799695399223" onmouseenter="enter('3608187799695399223');" onmouseout="out('3608187799695399223');" style=""> 219       * Called when this fragment has been fully scrolled into the activity.                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 220       *                                                                                                            </span>
<span class="-6064668654679903662" onmouseenter="enter('-6064668654679903662');" onmouseout="out('-6064668654679903662');" style=""> 221       * @see #isVisibleInActivity()                                                                                </span>
<span class="-4201783166293447700" onmouseenter="enter('-4201783166293447700');" onmouseout="out('-4201783166293447700');" style=""> 222       * @see #onMadeInvisibleInActivity()                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 223       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224      @Override                                                                                                     </span>
<span class="-7073731466333062745" onmouseenter="enter('-7073731466333062745');" onmouseout="out('-7073731466333062745');" style=""> 225      protected void onMadeVisibleInActivity() {                                                                    </span>
<span class="-2940429388425730341" onmouseenter="enter('-2940429388425730341');" onmouseout="out('-2940429388425730341');" style=""> 226          super.onMadeVisibleInActivity();                                                                          </span>
<span class="4333568825348773807" onmouseenter="enter('4333568825348773807');" onmouseout="out('4333568825348773807');" style=""> 227          showDateBar(true);                                                                                        </span>
<span class="371374127972335382" onmouseenter="enter('371374127972335382');" onmouseout="out('371374127972335382');" style=""> 228          if (isChartDirty()) {                                                                                     </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 229              refresh();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231      }                                                                                                             </span>
<span  style=""> 232                                                                                                                    </span>
<span class="-2587903292449818582" onmouseenter="enter('-2587903292449818582');" onmouseout="out('-2587903292449818582');" style=""> 233      protected void showDateBar(boolean show) {                                                                    </span>
<span class="1102668729830068636" onmouseenter="enter('1102668729830068636');" onmouseout="out('1102668729830068636');" style=""> 234          getChartsHost().getDateBar().setVisibility(show ? View.VISIBLE : View.INVISIBLE);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235      }                                                                                                             </span>
<span  style=""> 236                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 237      @Override                                                                                                     </span>
<span class="658855826062432633" onmouseenter="enter('658855826062432633');" onmouseout="out('658855826062432633');" style=""> 238      public void onDestroy() {                                                                                     </span>
<span class="7275190530034972367" onmouseenter="enter('7275190530034972367');" onmouseout="out('7275190530034972367');" style=""> 239          super.onDestroy();                                                                                        </span>
<span class="-1904828397138023848" onmouseenter="enter('-1904828397138023848');" onmouseout="out('-1904828397138023848');" style=""> 240          LocalBroadcastManager.getInstance(getActivity()).unregisterReceiver(mReceiver);                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241      }                                                                                                             </span>
<span  style=""> 242                                                                                                                    </span>
<span class="-6518874138984288541" onmouseenter="enter('-6518874138984288541');" onmouseout="out('-6518874138984288541');" style=""> 243      protected void onReceive(Context context, Intent intent) {                                                    </span>
<span class="5344227773413700857" onmouseenter="enter('5344227773413700857');" onmouseout="out('5344227773413700857');" style=""> 244          String action = intent.getAction();                                                                       </span>
<span class="-494993687329631312" onmouseenter="enter('-494993687329631312');" onmouseout="out('-494993687329631312');" style=""> 245          if (ChartsHost.REFRESH.equals(action)) {                                                                  </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 246              refresh();                                                                                            </span>
<span class="8208351658473141292" onmouseenter="enter('8208351658473141292');" onmouseout="out('8208351658473141292');" style=""> 247          } else if (ChartsHost.DATE_NEXT.equals(action)) {                                                         </span>
<span class="3429530462558527400" onmouseenter="enter('3429530462558527400');" onmouseout="out('3429530462558527400');" style=""> 248              handleDateNext(getStartDate(), getEndDate());                                                         </span>
<span class="6275594107476882748" onmouseenter="enter('6275594107476882748');" onmouseout="out('6275594107476882748');" style=""> 249          } else if (ChartsHost.DATE_PREV.equals(action)) {                                                         </span>
<span class="-3035508152708713619" onmouseenter="enter('-3035508152708713619');" onmouseout="out('-3035508152708713619');" style=""> 250              handleDatePrev(getStartDate(), getEndDate());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252      }                                                                                                             </span>
<span  style=""> 253                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 254      /**                                                                                                           </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 255       * Default implementation shifts the dates by one day, if visible                                             </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 256       * and calls #refreshIfVisible().                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 257       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 258       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 259       * @param endDate                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 260       */                                                                                                           </span>
<span class="-3047400271509647247" onmouseenter="enter('-3047400271509647247');" onmouseout="out('-3047400271509647247');" style=""> 261      protected void handleDatePrev(Date startDate, Date endDate) {                                                 </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 262          if (isVisibleInActivity()) {                                                                              </span>
<span class="-2651860554468779719" onmouseenter="enter('-2651860554468779719');" onmouseout="out('-2651860554468779719');" style=""> 263              if (!shiftDates(startDate, endDate, -1)) {                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 264                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266          }                                                                                                         </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 267          refreshIfVisible();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268      }                                                                                                             </span>
<span  style=""> 269                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 270      /**                                                                                                           </span>
<span class="964783620449149954" onmouseenter="enter('964783620449149954');" onmouseout="out('964783620449149954');" style=""> 271       * Default implementation shifts the dates by one day, if visible                                             </span>
<span class="11105567992846224" onmouseenter="enter('11105567992846224');" onmouseout="out('11105567992846224');" style=""> 272       * and calls #refreshIfVisible().                                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 273       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 274       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 275       * @param endDate                                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 276       */                                                                                                           </span>
<span class="6615897495863858801" onmouseenter="enter('6615897495863858801');" onmouseout="out('6615897495863858801');" style=""> 277      protected void handleDateNext(Date startDate, Date endDate) {                                                 </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 278          if (isVisibleInActivity()) {                                                                              </span>
<span class="-6485278970310858803" onmouseenter="enter('-6485278970310858803');" onmouseout="out('-6485278970310858803');" style=""> 279              if (!shiftDates(startDate, endDate, +1)) {                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 280                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282          }                                                                                                         </span>
<span class="3376398024497585024" onmouseenter="enter('3376398024497585024');" onmouseout="out('3376398024497585024');" style=""> 283          refreshIfVisible();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284      }                                                                                                             </span>
<span  style=""> 285                                                                                                                    </span>
<span class="5798655654202275728" onmouseenter="enter('5798655654202275728');" onmouseout="out('5798655654202275728');" style=""> 286      protected void refreshIfVisible() {                                                                           </span>
<span class="-3563920884156369764" onmouseenter="enter('-3563920884156369764');" onmouseout="out('-3563920884156369764');" style=""> 287          if (isVisibleInActivity()) {                                                                              </span>
<span class="-7636321265515534483" onmouseenter="enter('-7636321265515534483');" onmouseout="out('-7636321265515534483');" style=""> 288              refresh();                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 289          } else {                                                                                                  </span>
<span class="427958345432566734" onmouseenter="enter('427958345432566734');" onmouseout="out('427958345432566734');" style=""> 290              mChartDirty = true;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292      }                                                                                                             </span>
<span  style=""> 293                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 294      /**                                                                                                           </span>
<span class="-6717682359676050907" onmouseenter="enter('-6717682359676050907');" onmouseout="out('-6717682359676050907');" style=""> 295       * Shifts the given dates by offset days. offset may be positive or negative.                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 296       *                                                                                                            </span>
<span class="4106132815111166701" onmouseenter="enter('4106132815111166701');" onmouseout="out('4106132815111166701');" style=""> 297       * @param startDate                                                                                           </span>
<span class="4812998251509583136" onmouseenter="enter('4812998251509583136');" onmouseout="out('4812998251509583136');" style=""> 298       * @param endDate                                                                                             </span>
<span class="-3834083067366288846" onmouseenter="enter('-3834083067366288846');" onmouseout="out('-3834083067366288846');" style=""> 299       * @param offset    a positive or negative number of days to shift the dates                                  </span>
<span class="-6460740145491493882" onmouseenter="enter('-6460740145491493882');" onmouseout="out('-6460740145491493882');" style=""> 300       * @return true if the shift was successful and false otherwise                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 301       */                                                                                                           </span>
<span class="-1942902413678210438" onmouseenter="enter('-1942902413678210438');" onmouseout="out('-1942902413678210438');" style=""> 302      protected boolean shiftDates(Date startDate, Date endDate, int offset) {                                      </span>
<span class="-6336809523669087720" onmouseenter="enter('-6336809523669087720');" onmouseout="out('-6336809523669087720');" style=""> 303          Date newStart = DateTimeUtils.shiftByDays(startDate, offset);                                             </span>
<span class="-2733879703924959637" onmouseenter="enter('-2733879703924959637');" onmouseout="out('-2733879703924959637');" style=""> 304          Date newEnd = DateTimeUtils.shiftByDays(endDate, offset);                                                 </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-2856611894499161319" onmouseenter="enter('-2856611894499161319');" onmouseout="out('-2856611894499161319');" style=""> 306          return setDateRange(newStart, newEnd);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307      }                                                                                                             </span>
<span  style=""> 308                                                                                                                    </span>
<span class="-5091098020443224535" onmouseenter="enter('-5091098020443224535');" onmouseout="out('-5091098020443224535');" style=""> 309      protected Integer getColorFor(int activityKind) {                                                             </span>
<span class="1068460219870485515" onmouseenter="enter('1068460219870485515');" onmouseout="out('1068460219870485515');" style=""> 310          switch (activityKind) {                                                                                   </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 311              case ActivityKind.TYPE_DEEP_SLEEP:                                                                    </span>
<span class="5022727203055802055" onmouseenter="enter('5022727203055802055');" onmouseout="out('5022727203055802055');" style=""> 312                  return akDeepSleep.color;                                                                         </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 313              case ActivityKind.TYPE_LIGHT_SLEEP:                                                                   </span>
<span class="9202598133274813026" onmouseenter="enter('9202598133274813026');" onmouseout="out('9202598133274813026');" style=""> 314                  return akLightSleep.color;                                                                        </span>
<span class="-1944461592116084883" onmouseenter="enter('-1944461592116084883');" onmouseout="out('-1944461592116084883');" style=""> 315              case ActivityKind.TYPE_ACTIVITY:                                                                      </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 316                  return akActivity.color;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317          }                                                                                                         </span>
<span class="-6659890079363028681" onmouseenter="enter('-6659890079363028681');" onmouseout="out('-6659890079363028681');" style=""> 318          return akActivity.color;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319      }                                                                                                             </span>
<span  style=""> 320                                                                                                                    </span>
<span class="7124995295832055820" onmouseenter="enter('7124995295832055820');" onmouseout="out('7124995295832055820');" style=""> 321      protected SampleProvider&lt;? extends AbstractActivitySample&gt; getProvider(DBHandler db, GBDevice device) {       </span>
<span class="4895531017525357771" onmouseenter="enter('4895531017525357771');" onmouseout="out('4895531017525357771');" style=""> 322          DeviceCoordinator coordinator = DeviceHelper.getInstance().getCoordinator(device);                        </span>
<span class="5252113264335521833" onmouseenter="enter('5252113264335521833');" onmouseout="out('5252113264335521833');" style=""> 323          return coordinator.getSampleProvider(device, db.getDaoSession());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324      }                                                                                                             </span>
<span  style=""> 325                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 326      /**                                                                                                           </span>
<span class="3872148434859025386" onmouseenter="enter('3872148434859025386');" onmouseout="out('3872148434859025386');" style=""> 327       * Returns all kinds of samples for the given device.                                                         </span>
<span class="886766698730034078" onmouseenter="enter('886766698730034078');" onmouseout="out('886766698730034078');" style=""> 328       * To be called from a background thread.                                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 329       *                                                                                                            </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 330       * @param device                                                                                              </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 331       * @param tsFrom                                                                                              </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 332       * @param tsTo                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 333       */                                                                                                           </span>
<span class="3140984125721729972" onmouseenter="enter('3140984125721729972');" onmouseout="out('3140984125721729972');" style=""> 334      protected List&lt;? extends ActivitySample&gt; getAllSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) { </span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 335          SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                              </span>
<span class="3618633972640587810" onmouseenter="enter('3618633972640587810');" onmouseout="out('3618633972640587810');" style=""> 336          return provider.getAllActivitySamples(tsFrom, tsTo);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337      }                                                                                                             </span>
<span  style=""> 338                                                                                                                    </span>
<span class="911814376404307930" onmouseenter="enter('911814376404307930');" onmouseout="out('911814376404307930');" style=""><abbr title=" 339      protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 339      protected List&lt;? extends AbstractActivitySample&gt; getActivitySamples(DBHandler db, GBDevice device, int tsFrom,ðŸ”µ</abbr></span>
<span class="5136693054641003501" onmouseenter="enter('5136693054641003501');" onmouseout="out('5136693054641003501');" style=""> 340          SampleProvider&lt;? extends AbstractActivitySample&gt; provider = getProvider(db, device);                      </span>
<span class="85967298499632314" onmouseenter="enter('85967298499632314');" onmouseout="out('85967298499632314');" style=""> 341          return provider.getActivitySamples(tsFrom, tsTo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342      }                                                                                                             </span>
<span  style=""> 343                                                                                                                    </span>
<span  style=""> 344                                                                                                                    </span>
<span class="-241747733905569263" onmouseenter="enter('-241747733905569263');" onmouseout="out('-241747733905569263');" style=""><abbr title=" 345      protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) {"> 345      protected List&lt;? extends ActivitySample&gt; getSleepSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo) ðŸ”µ</abbr></span>
<span class="-3381259384033025734" onmouseenter="enter('-3381259384033025734');" onmouseout="out('-3381259384033025734');" style=""> 346          SampleProvider&lt;? extends ActivitySample&gt; provider = getProvider(db, device);                              </span>
<span class="-5906481120950290774" onmouseenter="enter('-5906481120950290774');" onmouseout="out('-5906481120950290774');" style=""> 347          return provider.getSleepSamples(tsFrom, tsTo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348      }                                                                                                             </span>
<span  style=""> 349                                                                                                                    </span>
<span class="5612092723136709042" onmouseenter="enter('5612092723136709042');" onmouseout="out('5612092723136709042');" style=""> 350      protected void configureChartDefaults(Chart&lt;?&gt; chart) {                                                       </span>
<span class="-7606632580747532983" onmouseenter="enter('-7606632580747532983');" onmouseout="out('-7606632580747532983');" style=""> 351          chart.getXAxis().setValueFormatter(new TimestampValueFormatter());                                        </span>
<span class="6778504947781910997" onmouseenter="enter('6778504947781910997');" onmouseout="out('6778504947781910997');" style=""> 352          chart.getDescription().setText(&quot;&quot;);                                                                       </span>
<span  style=""> 353                                                                                                                    </span>
<span class="24609561265320879" onmouseenter="enter('24609561265320879');" onmouseout="out('24609561265320879');" style=""> 354          // if enabled, the chart will always start at zero on the y-axis                                          </span>
<span class="6529846037374092564" onmouseenter="enter('6529846037374092564');" onmouseout="out('6529846037374092564');" style=""> 355          chart.setNoDataText(getString(R.string.chart_no_data_synchronize));                                       </span>
<span  style=""> 356                                                                                                                    </span>
<span class="2162327714476306626" onmouseenter="enter('2162327714476306626');" onmouseout="out('2162327714476306626');" style=""> 357          // disable value highlighting                                                                             </span>
<span class="-1590348432070259774" onmouseenter="enter('-1590348432070259774');" onmouseout="out('-1590348432070259774');" style=""> 358          chart.setHighlightPerTapEnabled(false);                                                                   </span>
<span  style=""> 359                                                                                                                    </span>
<span class="-348919351774733305" onmouseenter="enter('-348919351774733305');" onmouseout="out('-348919351774733305');" style=""> 360          // enable touch gestures                                                                                  </span>
<span class="5289310484488287391" onmouseenter="enter('5289310484488287391');" onmouseout="out('5289310484488287391');" style=""> 361          chart.setTouchEnabled(true);                                                                              </span>
<span  style=""> 362                                                                                                                    </span>
<span class="-6098879767425938051" onmouseenter="enter('-6098879767425938051');" onmouseout="out('-6098879767425938051');" style=""> 363  // commented out: this has weird bugs/sideeffects at least on WeekStepsCharts                                     </span>
<span class="8784253570401363075" onmouseenter="enter('8784253570401363075');" onmouseout="out('8784253570401363075');" style=""> 364  // where only the first Day-label is drawn, because AxisRenderer.computeAxisValues(float,float)                   </span>
<span class="-8770575613400395593" onmouseenter="enter('-8770575613400395593');" onmouseout="out('-8770575613400395593');" style=""> 365  // appears to have an overflow when calculating &#x27;n&#x27; (number of entries)                                           </span>
<span class="3888896009006521991" onmouseenter="enter('3888896009006521991');" onmouseout="out('3888896009006521991');" style=""> 366  //        chart.getXAxis().setGranularity(60*5);                                                                  </span>
<span  style=""> 367                                                                                                                    </span>
<span class="5634570376801469004" onmouseenter="enter('5634570376801469004');" onmouseout="out('5634570376801469004');" style=""> 368          setupLegend(chart);                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369      }                                                                                                             </span>
<span  style=""> 370                                                                                                                    </span>
<span class="-1924974321468626199" onmouseenter="enter('-1924974321468626199');" onmouseout="out('-1924974321468626199');" style=""> 371      protected void configureBarLineChartDefaults(BarLineChartBase&lt;?&gt; chart) {                                     </span>
<span class="5467508404297658352" onmouseenter="enter('5467508404297658352');" onmouseout="out('5467508404297658352');" style=""> 372          configureChartDefaults(chart);                                                                            </span>
<span class="-8169200756215735113" onmouseenter="enter('-8169200756215735113');" onmouseout="out('-8169200756215735113');" style=""> 373          if (chart instanceof BarChart) {                                                                          </span>
<span class="2718779115389378256" onmouseenter="enter('2718779115389378256');" onmouseout="out('2718779115389378256');" style=""> 374              ((BarChart) chart).setFitBars(true);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 375          }                                                                                                         </span>
<span  style=""> 376                                                                                                                    </span>
<span class="-1346367465809520237" onmouseenter="enter('-1346367465809520237');" onmouseout="out('-1346367465809520237');" style=""> 377          // enable scaling and dragging                                                                            </span>
<span class="165705574276177801" onmouseenter="enter('165705574276177801');" onmouseout="out('165705574276177801');" style=""> 378          chart.setDragEnabled(true);                                                                               </span>
<span class="6107382641746821998" onmouseenter="enter('6107382641746821998');" onmouseout="out('6107382641746821998');" style=""> 379          chart.setScaleEnabled(true);                                                                              </span>
<span  style=""> 380                                                                                                                    </span>
<span class="6424277115851676497" onmouseenter="enter('6424277115851676497');" onmouseout="out('6424277115851676497');" style=""> 381          // if disabled, scaling can be done on x- and y-axis separately                                           </span>
<span class="6432377865510855871" onmouseenter="enter('6432377865510855871');" onmouseout="out('6432377865510855871');" style=""> 382  //        chart.setPinchZoom(true);                                                                               </span>
<span  style=""> 383                                                                                                                    </span>
<span class="-3757744149975665581" onmouseenter="enter('-3757744149975665581');" onmouseout="out('-3757744149975665581');" style=""> 384          chart.setDrawGridBackground(false);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385      }                                                                                                             </span>
<span  style=""> 386                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 387      /**                                                                                                           </span>
<span class="5100165395414783914" onmouseenter="enter('5100165395414783914');" onmouseout="out('5100165395414783914');" style=""> 388       * This method will invoke a background task to read the data from the                                        </span>
<span class="5027852704688867372" onmouseenter="enter('5027852704688867372');" onmouseout="out('5027852704688867372');" style=""> 389       * database, analyze it, prepare it for the charts and eventually call                                        </span>
<span class="-3918098027409993360" onmouseenter="enter('-3918098027409993360');" onmouseout="out('-3918098027409993360');" style=""> 390       * #renderCharts                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 391       */                                                                                                           </span>
<span class="2809394791911169685" onmouseenter="enter('2809394791911169685');" onmouseout="out('2809394791911169685');" style=""> 392      protected void refresh() {                                                                                    </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 393          ChartsHost chartsHost = getChartsHost();                                                                  </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 394          if (chartsHost != null) {                                                                                 </span>
<span class="-103873194966226890" onmouseenter="enter('-103873194966226890');" onmouseout="out('-103873194966226890');" style=""> 395              if (chartsHost.getDevice() != null) {                                                                 </span>
<span class="-5198511171031023043" onmouseenter="enter('-5198511171031023043');" onmouseout="out('-5198511171031023043');" style=""> 396                  mChartDirty = false;                                                                              </span>
<span class="7622323496435283090" onmouseenter="enter('7622323496435283090');" onmouseout="out('7622323496435283090');" style=""> 397                  updateDateInfo(getStartDate(), getEndDate());                                                     </span>
<span class="3165810198377965313" onmouseenter="enter('3165810198377965313');" onmouseout="out('3165810198377965313');" style=""> 398                  if (refreshTask != null &amp;&amp; refreshTask.getStatus() != AsyncTask.Status.FINISHED) {                </span>
<span class="-3108005745869946167" onmouseenter="enter('-3108005745869946167');" onmouseout="out('-3108005745869946167');" style=""> 399                      refreshTask.cancel(true);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400                  }                                                                                                 </span>
<span class="3840488977465298517" onmouseenter="enter('3840488977465298517');" onmouseout="out('3840488977465298517');" style=""> 401                  refreshTask = createRefreshTask(&quot;Visualizing data&quot;, getActivity()).execute();                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404      }                                                                                                             </span>
<span  style=""> 405                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 406      /**                                                                                                           </span>
<span class="4268529485699346115" onmouseenter="enter('4268529485699346115');" onmouseout="out('4268529485699346115');" style=""> 407       * This method reads the data from the database, analyzes and prepares it for                                 </span>
<span class="-3790527174834636702" onmouseenter="enter('-3790527174834636702');" onmouseout="out('-3790527174834636702');" style=""> 408       * the charts. This will be called from a background task, so there must not be                               </span>
<span class="8892366747213531989" onmouseenter="enter('8892366747213531989');" onmouseout="out('8892366747213531989');" style=""> 409       * any UI access. #updateChartsInUIThread and #renderCharts will be automatically called after this method.   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 410       */                                                                                                           </span>
<span class="-9167766646201984999" onmouseenter="enter('-9167766646201984999');" onmouseout="out('-9167766646201984999');" style=""> 411      protected abstract ChartsData refreshInBackground(ChartsHost chartsHost, DBHandler db, GBDevice device);      </span>
<span  style=""> 412                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 413      /**                                                                                                           </span>
<span class="7668378754224811352" onmouseenter="enter('7668378754224811352');" onmouseout="out('7668378754224811352');" style=""> 414       * Triggers the actual (re-) rendering of the chart.                                                          </span>
<span class="1258740047847480611" onmouseenter="enter('1258740047847480611');" onmouseout="out('1258740047847480611');" style=""> 415       * Always called from the UI thread.                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 416       */                                                                                                           </span>
<span class="4159836083754598607" onmouseenter="enter('4159836083754598607');" onmouseout="out('4159836083754598607');" style=""> 417      protected abstract void renderCharts();                                                                       </span>
<span  style=""> 418                                                                                                                    </span>
<span class="1142774420965375266" onmouseenter="enter('1142774420965375266');" onmouseout="out('1142774420965375266');" style=""> 419      protected DefaultChartsData&lt;LineData&gt; refresh(GBDevice gbDevice, List&lt;? extends ActivitySample&gt; samples) {    </span>
<span class="2571942157260224234" onmouseenter="enter('2571942157260224234');" onmouseout="out('2571942157260224234');" style=""> 420  //        Calendar cal = GregorianCalendar.getInstance();                                                         </span>
<span class="4401062856956877488" onmouseenter="enter('4401062856956877488');" onmouseout="out('4401062856956877488');" style=""> 421  //        cal.clear();                                                                                            </span>
<span class="6028849563211801820" onmouseenter="enter('6028849563211801820');" onmouseout="out('6028849563211801820');" style=""> 422          TimestampTranslation tsTranslation = new TimestampTranslation();                                          </span>
<span class="-53760276184898045" onmouseenter="enter('-53760276184898045');" onmouseout="out('-53760276184898045');" style=""> 423  //        Date date;                                                                                              </span>
<span class="-6156197187638932942" onmouseenter="enter('-6156197187638932942');" onmouseout="out('-6156197187638932942');" style=""> 424  //        String dateStringFrom = &quot;&quot;;                                                                             </span>
<span class="4183977243651978214" onmouseenter="enter('4183977243651978214');" onmouseout="out('4183977243651978214');" style=""> 425  //        String dateStringTo = &quot;&quot;;                                                                               </span>
<span class="147032316452628113" onmouseenter="enter('147032316452628113');" onmouseout="out('147032316452628113');" style=""> 426  //        ArrayList&lt;String&gt; xLabels = null;                                                                       </span>
<span  style=""> 427                                                                                                                    </span>
<span class="-8827232702598725695" onmouseenter="enter('-8827232702598725695');" onmouseout="out('-8827232702598725695');" style=""> 428          LOG.info(&quot;&quot; + getTitle() + &quot;: number of samples:&quot; + samples.size());                                      </span>
<span class="3654763384087017314" onmouseenter="enter('3654763384087017314');" onmouseout="out('3654763384087017314');" style=""> 429          LineData lineData;                                                                                        </span>
<span class="-9107937003987659062" onmouseenter="enter('-9107937003987659062');" onmouseout="out('-9107937003987659062');" style=""> 430          if (samples.size() &gt; 1) {                                                                                 </span>
<span class="-8527306736668810111" onmouseenter="enter('-8527306736668810111');" onmouseout="out('-8527306736668810111');" style=""> 431              boolean annotate = true;                                                                              </span>
<span class="1395829712909105015" onmouseenter="enter('1395829712909105015');" onmouseout="out('1395829712909105015');" style=""> 432              boolean use_steps_as_movement;                                                                        </span>
<span  style=""> 433                                                                                                                    </span>
<span class="4142243867024174482" onmouseenter="enter('4142243867024174482');" onmouseout="out('4142243867024174482');" style=""> 434              int last_type = ActivityKind.TYPE_UNKNOWN;                                                            </span>
<span  style=""> 435                                                                                                                    </span>
<span class="-2031252584474024476" onmouseenter="enter('-2031252584474024476');" onmouseout="out('-2031252584474024476');" style=""> 436              int numEntries = samples.size();                                                                      </span>
<span class="-8870011066494287543" onmouseenter="enter('-8870011066494287543');" onmouseout="out('-8870011066494287543');" style=""> 437              List&lt;Entry&gt; activityEntries = new ArrayList&lt;&gt;(numEntries);                                            </span>
<span class="4899105382649046594" onmouseenter="enter('4899105382649046594');" onmouseout="out('4899105382649046594');" style=""> 438              List&lt;Entry&gt; deepSleepEntries = new ArrayList&lt;&gt;(numEntries);                                           </span>
<span class="7486237668847997910" onmouseenter="enter('7486237668847997910');" onmouseout="out('7486237668847997910');" style=""> 439              List&lt;Entry&gt; lightSleepEntries = new ArrayList&lt;&gt;(numEntries);                                          </span>
<span class="-1233994828972266903" onmouseenter="enter('-1233994828972266903');" onmouseout="out('-1233994828972266903');" style=""> 440              List&lt;Entry&gt; notWornEntries = new ArrayList&lt;&gt;(numEntries);                                             </span>
<span class="-7435551010854374427" onmouseenter="enter('-7435551010854374427');" onmouseout="out('-7435551010854374427');" style=""> 441              boolean hr = supportsHeartrate(gbDevice);                                                             </span>
<span class="-5348686395661515277" onmouseenter="enter('-5348686395661515277');" onmouseout="out('-5348686395661515277');" style=""> 442              List&lt;Entry&gt; heartrateEntries = hr ? new ArrayList&lt;Entry&gt;(numEntries) : null;                          </span>

<span class="7529735733952592718" onmouseenter="enter('7529735733952592718');" onmouseout="out('7529735733952592718');" style=""> 443              int lastHrSampleIndex = -1;                                                                           </span>
<span  style=""> 444                                                                                                                    </span>
<span class="4476749361735409543" onmouseenter="enter('4476749361735409543');" onmouseout="out('4476749361735409543');" style=""> 445              for (int i = 0; i &lt; numEntries; i++) {                                                                </span>
<span class="3246332292526896189" onmouseenter="enter('3246332292526896189');" onmouseout="out('3246332292526896189');" style=""> 446                  ActivitySample sample = samples.get(i);                                                           </span>
<span class="6576081203602242327" onmouseenter="enter('6576081203602242327');" onmouseout="out('6576081203602242327');" style=""> 447                  int type = sample.getKind();                                                                      </span>
<span class="-9213760672368715167" onmouseenter="enter('-9213760672368715167');" onmouseout="out('-9213760672368715167');" style=""> 448                  int ts = tsTranslation.shorten(sample.getTimestamp());                                            </span>
<span  style=""> 449                                                                                                                    </span>
<span class="-6141709027769286674" onmouseenter="enter('-6141709027769286674');" onmouseout="out('-6141709027769286674');" style=""> 450  //                System.out.println(ts);                                                                         </span>
<span class="1901381804146795461" onmouseenter="enter('1901381804146795461');" onmouseout="out('1901381804146795461');" style=""> 451  //                ts = i;                                                                                         </span>
<span class="5764290091373211945" onmouseenter="enter('5764290091373211945');" onmouseout="out('5764290091373211945');" style=""> 452                  // determine start and end dates                                                                  </span>
<span class="5717361089680993355" onmouseenter="enter('5717361089680993355');" onmouseout="out('5717361089680993355');" style=""> 453  //                if (i == 0) {                                                                                   </span>
<span class="7046397249359147146" onmouseenter="enter('7046397249359147146');" onmouseout="out('7046397249359147146');" style=""> 454  //                    cal.setTimeInMillis(ts * 1000L); // make sure it&#x27;s converted to long                        </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 455  //                    date = cal.getTime();                                                                       </span>
<span class="5571666638688830790" onmouseenter="enter('5571666638688830790');" onmouseout="out('5571666638688830790');" style=""> 456  //                    dateStringFrom = dateFormat.format(date);                                                   </span>
<span class="-1516242143504559710" onmouseenter="enter('-1516242143504559710');" onmouseout="out('-1516242143504559710');" style=""> 457  //                } else if (i == samples.size() - 1) {                                                           </span>
<span class="241708909740168031" onmouseenter="enter('241708909740168031');" onmouseout="out('241708909740168031');" style=""> 458  //                    cal.setTimeInMillis(ts * 1000L); // same here                                               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 459  //                    date = cal.getTime();                                                                       </span>
<span class="993250294615949060" onmouseenter="enter('993250294615949060');" onmouseout="out('993250294615949060');" style=""> 460  //                    dateStringTo = dateFormat.format(date);                                                     </span>
<span class="8884174724223176501" onmouseenter="enter('8884174724223176501');" onmouseout="out('8884174724223176501');" style=""> 461  //                }                                                                                               </span>
<span  style=""> 462                                                                                                                    </span>
<span class="-8914675673971344704" onmouseenter="enter('-8914675673971344704');" onmouseout="out('-8914675673971344704');" style=""> 463                  float movement = sample.getIntensity();                                                           </span>
<span  style=""> 464                                                                                                                    </span>
<span class="5917499164651721508" onmouseenter="enter('5917499164651721508');" onmouseout="out('5917499164651721508');" style=""> 465                  float value = movement;                                                                           </span>
<span class="3474584951622682325" onmouseenter="enter('3474584951622682325');" onmouseout="out('3474584951622682325');" style=""> 466                  switch (type) {                                                                                   </span>
<span class="-2837414113876355124" onmouseenter="enter('-2837414113876355124');" onmouseout="out('-2837414113876355124');" style=""> 467                      case ActivityKind.TYPE_DEEP_SLEEP:                                                            </span>
<span class="8800766899670031569" onmouseenter="enter('8800766899670031569');" onmouseout="out('8800766899670031569');" style=""> 468                          if (last_type != type) { //FIXME: this is ugly but it works (repeated in each case)       </span>
<span class="-1661959904957213102" onmouseenter="enter('-1661959904957213102');" onmouseout="out('-1661959904957213102');" style=""> 469                              deepSleepEntries.add(createLineEntry(0, ts - 1));                                     </span>
<span  style=""> 470                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 471                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 472                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 473                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474                          }                                                                                         </span>
<span class="-6180311285798694701" onmouseenter="enter('-6180311285798694701');" onmouseout="out('-6180311285798694701');" style=""> 475                          deepSleepEntries.add(createLineEntry(value + SleepUtils.Y_VALUE_DEEP_SLEEP, ts));         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 476                          break;                                                                                    </span>
<span class="-4995724208299683832" onmouseenter="enter('-4995724208299683832');" onmouseout="out('-4995724208299683832');" style=""> 477                      case ActivityKind.TYPE_LIGHT_SLEEP:                                                           </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 478                          if (last_type != type) {                                                                  </span>
<span class="7147575638574677011" onmouseenter="enter('7147575638574677011');" onmouseout="out('7147575638574677011');" style=""> 479                              lightSleepEntries.add(createLineEntry(0, ts - 1));                                    </span>
<span  style=""> 480                                                                                                                    </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 481                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 482                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 483                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484                          }                                                                                         </span>
<span class="-5875750109358144719" onmouseenter="enter('-5875750109358144719');" onmouseout="out('-5875750109358144719');" style=""> 485                          lightSleepEntries.add(createLineEntry(value, ts));                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 486                          break;                                                                                    </span>
<span class="-9132572973740238507" onmouseenter="enter('-9132572973740238507');" onmouseout="out('-9132572973740238507');" style=""> 487                      case ActivityKind.TYPE_NOT_WORN:                                                              </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 488                          if (last_type != type) {                                                                  </span>
<span class="4292609800559774054" onmouseenter="enter('4292609800559774054');" onmouseout="out('4292609800559774054');" style=""> 489                              notWornEntries.add(createLineEntry(0, ts - 1));                                       </span>
<span  style=""> 490                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 491                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 492                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="756263843256763957" onmouseenter="enter('756263843256763957');" onmouseout="out('756263843256763957');" style=""> 493                              activityEntries.add(createLineEntry(0, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494                          }                                                                                         </span>
<span class="5412917281309595074" onmouseenter="enter('5412917281309595074');" onmouseout="out('5412917281309595074');" style=""><abbr title=" 495                          notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, just to show something on the graphs"> 495                          notWornEntries.add(createLineEntry(SleepUtils.Y_VALUE_DEEP_SLEEP, ts)); //a small value, jðŸ”µ</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 496                          break;                                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 497                      default:                                                                                      </span>
<span class="-4054780187002246392" onmouseenter="enter('-4054780187002246392');" onmouseout="out('-4054780187002246392');" style=""> 498  //                        short steps = sample.getSteps();                                                        </span>
<span class="-1494320471491276911" onmouseenter="enter('-1494320471491276911');" onmouseout="out('-1494320471491276911');" style=""> 499  //                        if (use_steps_as_movement &amp;&amp; steps != 0) {                                              </span>
<span class="-3251198952450992064" onmouseenter="enter('-3251198952450992064');" onmouseout="out('-3251198952450992064');" style=""> 500  //                            // I&#x27;m not sure using steps for this is actually a good idea                        </span>
<span class="-6376968801115210935" onmouseenter="enter('-6376968801115210935');" onmouseout="out('-6376968801115210935');" style=""> 501  //                            movement = steps;                                                                   </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 502  //                        }                                                                                       </span>
<span class="-941684175082606672" onmouseenter="enter('-941684175082606672');" onmouseout="out('-941684175082606672');" style=""> 503  //                        value = ((float) movement) / movement_divisor;                                          </span>
<span class="2946940040439338921" onmouseenter="enter('2946940040439338921');" onmouseout="out('2946940040439338921');" style=""> 504                          if (last_type != type) {                                                                  </span>
<span class="-6771781995837807247" onmouseenter="enter('-6771781995837807247');" onmouseout="out('-6771781995837807247');" style=""> 505                              activityEntries.add(createLineEntry(0, ts - 1));                                      </span>
<span  style=""> 506                                                                                                                    </span>
<span class="3460571164432703971" onmouseenter="enter('3460571164432703971');" onmouseout="out('3460571164432703971');" style=""> 507                              lightSleepEntries.add(createLineEntry(0, ts));                                        </span>
<span class="5889577849387874444" onmouseenter="enter('5889577849387874444');" onmouseout="out('5889577849387874444');" style=""> 508                              notWornEntries.add(createLineEntry(0, ts));                                           </span>
<span class="6247099108301149936" onmouseenter="enter('6247099108301149936');" onmouseout="out('6247099108301149936');" style=""> 509                              deepSleepEntries.add(createLineEntry(0, ts));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 510                          }                                                                                         </span>
<span class="4080308283196262910" onmouseenter="enter('4080308283196262910');" onmouseout="out('4080308283196262910');" style=""> 511                          activityEntries.add(createLineEntry(value, ts));                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512                  }                                                                                                 </span>
<span class="6502915003910560814" onmouseenter="enter('6502915003910560814');" onmouseout="out('6502915003910560814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 513 -                if (hr &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {                                         </span>
<span class="6904435308673061248" onmouseenter="enter('6904435308673061248');" onmouseout="out('6904435308673061248');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 514 +                if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.getHeartRate())) {"> 514 +                if (hr &amp;&amp; sample.getKind() != ActivityKind.TYPE_NOT_WORN &amp;&amp; isValidHeartRateValue(sample.getHeartRðŸ”µ</abbr></span>
<span class="-5841181323088898939" onmouseenter="enter('-5841181323088898939');" onmouseout="out('-5841181323088898939');" style=""><abbr title=" 515                      if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTS_GAP_MINUTES) {"> 515                      if (lastHrSampleIndex &gt; -1 &amp;&amp; ts - lastHrSampleIndex &gt; 1800*HeartRateUtils.MAX_HR_MEASUREMENTSðŸ”µ</abbr></span>
<span class="7928119684647429254" onmouseenter="enter('7928119684647429254');" onmouseout="out('7928119684647429254');" style=""> 516                          heartrateEntries.add(createLineEntry(0, lastHrSampleIndex + 1));                          </span>
<span class="-5182503479458455454" onmouseenter="enter('-5182503479458455454');" onmouseout="out('-5182503479458455454');" style=""> 517                          heartrateEntries.add(createLineEntry(0, ts - 1));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 518                      }                                                                                             </span>
<span  style=""> 519                                                                                                                    </span>
<span class="-8554726460294545666" onmouseenter="enter('-8554726460294545666');" onmouseout="out('-8554726460294545666');" style=""> 520                      heartrateEntries.add(createLineEntry(sample.getHeartRate(), ts));                             </span>
<span class="1340167295380328410" onmouseenter="enter('1340167295380328410');" onmouseout="out('1340167295380328410');" style=""> 521                      lastHrSampleIndex = ts;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 522                  }                                                                                                 </span>
<span  style=""> 523                                                                                                                    </span>
<span class="7730925444289024998" onmouseenter="enter('7730925444289024998');" onmouseout="out('7730925444289024998');" style=""> 524                  String xLabel = &quot;&quot;;                                                                               </span>
<span class="-5459254189226498661" onmouseenter="enter('-5459254189226498661');" onmouseout="out('-5459254189226498661');" style=""> 525                  if (annotate) {                                                                                   </span>
<span class="-1465306111701045962" onmouseenter="enter('-1465306111701045962');" onmouseout="out('-1465306111701045962');" style=""> 526  //                    cal.setTimeInMillis((ts + tsOffset) * 1000L);                                               </span>
<span class="-4947863853920809069" onmouseenter="enter('-4947863853920809069');" onmouseout="out('-4947863853920809069');" style=""> 527  //                    date = cal.getTime();                                                                       </span>
<span class="-1086602658675179068" onmouseenter="enter('-1086602658675179068');" onmouseout="out('-1086602658675179068');" style=""> 528  //                    String dateString = annotationDateFormat.format(date);                                      </span>
<span class="-2931946040942644368" onmouseenter="enter('-2931946040942644368');" onmouseout="out('-2931946040942644368');" style=""> 529  //                    xLabel = dateString;                                                                        </span>
<span class="5566449710495547766" onmouseenter="enter('5566449710495547766');" onmouseout="out('5566449710495547766');" style=""> 530  //                    if (last_type != type) {                                                                    </span>
<span class="7413255212379424149" onmouseenter="enter('7413255212379424149');" onmouseout="out('7413255212379424149');" style=""> 531  //                        if (isSleep(last_type) &amp;&amp; !isSleep(type)) {                                             </span>
<span class="-56714345320416604" onmouseenter="enter('-56714345320416604');" onmouseout="out('-56714345320416604');" style=""> 532  //                            // woken up                                                                         </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 533  //                            LimitLine line = new LimitLine(i, dateString);                                      </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 534  //                            line.enableDashedLine(8, 8, 0);                                                     </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 535  //                            line.setTextColor(Color.WHITE);                                                     </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 536  //                            line.setTextSize(15);                                                               </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 537  //                            chart.getXAxis().addLimitLine(line);                                                </span>
<span class="-5828290692175278159" onmouseenter="enter('-5828290692175278159');" onmouseout="out('-5828290692175278159');" style=""> 538  //                        } else if (!isSleep(last_type) &amp;&amp; isSleep(type)) {                                      </span>
<span class="5244181556799794554" onmouseenter="enter('5244181556799794554');" onmouseout="out('5244181556799794554');" style=""> 539  //                            // fallen asleep                                                                    </span>
<span class="4261875875713477108" onmouseenter="enter('4261875875713477108');" onmouseout="out('4261875875713477108');" style=""> 540  //                            LimitLine line = new LimitLine(i, dateString);                                      </span>
<span class="6707999478604658942" onmouseenter="enter('6707999478604658942');" onmouseout="out('6707999478604658942');" style=""> 541  //                            line.enableDashedLine(8, 8, 0);                                                     </span>
<span class="6261771742475836344" onmouseenter="enter('6261771742475836344');" onmouseout="out('6261771742475836344');" style=""> 542  //                            line.setTextSize(15);                                                               </span>
<span class="6415578092711049134" onmouseenter="enter('6415578092711049134');" onmouseout="out('6415578092711049134');" style=""> 543  //                            line.setTextColor(Color.WHITE);                                                     </span>
<span class="-6350911352842038030" onmouseenter="enter('-6350911352842038030');" onmouseout="out('-6350911352842038030');" style=""> 544  //                            chart.getXAxis().addLimitLine(line);                                                </span>
<span class="647013157818160180" onmouseenter="enter('647013157818160180');" onmouseout="out('647013157818160180');" style=""> 545  //                        }                                                                                       </span>
<span class="6051702211689751699" onmouseenter="enter('6051702211689751699');" onmouseout="out('6051702211689751699');" style=""> 546  //                    }                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 547                  }                                                                                                 </span>
<span class="-1444147652675010833" onmouseenter="enter('-1444147652675010833');" onmouseout="out('-1444147652675010833');" style=""> 548                  last_type = type;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549              }                                                                                                     </span>
<span  style=""> 550                                                                                                                    </span>
<span  style=""> 551                                                                                                                    </span>
<span class="-1579194111559420554" onmouseenter="enter('-1579194111559420554');" onmouseout="out('-1579194111559420554');" style=""> 552              List&lt;ILineDataSet&gt; lineDataSets = new ArrayList&lt;&gt;();                                                  </span>
<span class="-1359387837948108742" onmouseenter="enter('-1359387837948108742');" onmouseout="out('-1359387837948108742');" style=""> 553              LineDataSet activitySet = createDataSet(activityEntries, akActivity.color, &quot;Activity&quot;);               </span>
<span class="-3354127768405521554" onmouseenter="enter('-3354127768405521554');" onmouseout="out('-3354127768405521554');" style=""> 554              lineDataSets.add(activitySet);                                                                        </span>
<span class="7026895411091818045" onmouseenter="enter('7026895411091818045');" onmouseout="out('7026895411091818045');" style=""> 555              LineDataSet deepSleepSet = createDataSet(deepSleepEntries, akDeepSleep.color, &quot;Deep Sleep&quot;);          </span>
<span class="-3446958151566211125" onmouseenter="enter('-3446958151566211125');" onmouseout="out('-3446958151566211125');" style=""> 556              lineDataSets.add(deepSleepSet);                                                                       </span>
<span class="4693393103163137779" onmouseenter="enter('4693393103163137779');" onmouseout="out('4693393103163137779');" style=""> 557              LineDataSet lightSleepSet = createDataSet(lightSleepEntries, akLightSleep.color, &quot;Light Sleep&quot;);      </span>
<span class="8003351674511898289" onmouseenter="enter('8003351674511898289');" onmouseout="out('8003351674511898289');" style=""> 558              lineDataSets.add(lightSleepSet);                                                                      </span>
<span class="-7108338871992330028" onmouseenter="enter('-7108338871992330028');" onmouseout="out('-7108338871992330028');" style=""> 559              LineDataSet notWornSet = createDataSet(notWornEntries, akNotWorn.color, &quot;Not worn&quot;);                  </span>
<span class="64462528287934820" onmouseenter="enter('64462528287934820');" onmouseout="out('64462528287934820');" style=""> 560              lineDataSets.add(notWornSet);                                                                         </span>
<span  style=""> 561                                                                                                                    </span>
<span class="-8621348893512609171" onmouseenter="enter('-8621348893512609171');" onmouseout="out('-8621348893512609171');" style=""> 562              if (hr &amp;&amp; heartrateEntries.size() &gt; 0) {                                                              </span>
<span class="-6373591549531816713" onmouseenter="enter('-6373591549531816713');" onmouseout="out('-6373591549531816713');" style=""> 563                  LineDataSet heartrateSet = createHeartrateSet(heartrateEntries, &quot;Heart Rate&quot;);                    </span>
<span  style=""> 564                                                                                                                    </span>
<span class="8944960460471270621" onmouseenter="enter('8944960460471270621');" onmouseout="out('8944960460471270621');" style=""> 565                  lineDataSets.add(heartrateSet);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566              }                                                                                                     </span>
<span class="2703760882318229208" onmouseenter="enter('2703760882318229208');" onmouseout="out('2703760882318229208');" style=""> 567              lineData = new LineData(lineDataSets);                                                                </span>
<span  style=""> 568                                                                                                                    </span>
<span class="-6499460759915470269" onmouseenter="enter('-6499460759915470269');" onmouseout="out('-6499460759915470269');" style=""> 569  //            chart.setDescription(getString(R.string.sleep_activity_date_range, dateStringFrom, dateStringTo));  </span>
<span class="-3762887228500678217" onmouseenter="enter('-3762887228500678217');" onmouseout="out('-3762887228500678217');" style=""> 570  //            chart.setDescriptionPosition(?, ?);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 571          } else {                                                                                                  </span>
<span class="-2761320896669897238" onmouseenter="enter('-2761320896669897238');" onmouseout="out('-2761320896669897238');" style=""> 572              lineData = new LineData();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 573          }                                                                                                         </span>
<span  style=""> 574                                                                                                                    </span>
<span class="-1609543182283032519" onmouseenter="enter('-1609543182283032519');" onmouseout="out('-1609543182283032519');" style=""> 575          IAxisValueFormatter xValueFormatter = new SampleXLabelFormatter(tsTranslation);                           </span>
<span class="-3441797761873957961" onmouseenter="enter('-3441797761873957961');" onmouseout="out('-3441797761873957961');" style=""> 576          return new DefaultChartsData(lineData, xValueFormatter);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577      }                                                                                                             </span>
<span  style=""> 578                                                                                                                    </span>
<span class="1581801212602353291" onmouseenter="enter('1581801212602353291');" onmouseout="out('1581801212602353291');" style=""> 579      protected boolean isValidHeartRateValue(int value) {                                                          </span>
<span class="-5341883142074348876" onmouseenter="enter('-5341883142074348876');" onmouseout="out('-5341883142074348876');" style=""> 580          return value &gt; HeartRateUtils.MIN_HEART_RATE_VALUE &amp;&amp; value &lt; HeartRateUtils.MAX_HEART_RATE_VALUE;        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 581      }                                                                                                             </span>
<span  style=""> 582                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 583      /**                                                                                                           </span>
<span class="6334547652397213625" onmouseenter="enter('6334547652397213625');" onmouseout="out('6334547652397213625');" style=""> 584       * Implement this to supply the samples to be displayed.                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 585       *                                                                                                            </span>
<span class="5464670662091686554" onmouseenter="enter('5464670662091686554');" onmouseout="out('5464670662091686554');" style=""> 586       * @param db                                                                                                  </span>
<span class="1113685536488546558" onmouseenter="enter('1113685536488546558');" onmouseout="out('1113685536488546558');" style=""> 587       * @param device                                                                                              </span>
<span class="5706926982832997078" onmouseenter="enter('5706926982832997078');" onmouseout="out('5706926982832997078');" style=""> 588       * @param tsFrom                                                                                              </span>
<span class="-5524453765579627215" onmouseenter="enter('-5524453765579627215');" onmouseout="out('-5524453765579627215');" style=""> 589       * @param tsTo                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 590       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 591       */                                                                                                           </span>
<span class="-4899824222168510613" onmouseenter="enter('-4899824222168510613');" onmouseout="out('-4899824222168510613');" style=""><abbr title=" 592      protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsTo);"> 592      protected abstract List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device, int tsFrom, int tsðŸ”µ</abbr></span>
<span  style=""> 593                                                                                                                    </span>
<span class="354769125648165857" onmouseenter="enter('354769125648165857');" onmouseout="out('354769125648165857');" style=""> 594      protected abstract void setupLegend(Chart chart);                                                             </span>
<span  style=""> 595                                                                                                                    </span>
<span class="-188113346780130145" onmouseenter="enter('-188113346780130145');" onmouseout="out('-188113346780130145');" style=""> 596      protected Entry createLineEntry(float value, int xValue) {                                                    </span>
<span class="5155334880625707837" onmouseenter="enter('5155334880625707837');" onmouseout="out('5155334880625707837');" style=""> 597          return new Entry(xValue, value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 598      }                                                                                                             </span>
<span  style=""> 599                                                                                                                    </span>
<span class="5268984431672798069" onmouseenter="enter('5268984431672798069');" onmouseout="out('5268984431672798069');" style=""> 600      protected LineDataSet createDataSet(List&lt;Entry&gt; values, Integer color, String label) {                        </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 601          LineDataSet set1 = new LineDataSet(values, label);                                                        </span>
<span class="820149155345415568" onmouseenter="enter('820149155345415568');" onmouseout="out('820149155345415568');" style=""> 602          set1.setColor(color);                                                                                     </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 603  //        set1.setDrawCubic(true);                                                                                </span>
<span class="-7031616190320035410" onmouseenter="enter('-7031616190320035410');" onmouseout="out('-7031616190320035410');" style=""> 604  //        set1.setCubicIntensity(0.2f);                                                                           </span>
<span class="5358451272424367352" onmouseenter="enter('5358451272424367352');" onmouseout="out('5358451272424367352');" style=""> 605          set1.setDrawFilled(true);                                                                                 </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 606          set1.setDrawCircles(false);                                                                               </span>
<span class="5314519233815368988" onmouseenter="enter('5314519233815368988');" onmouseout="out('5314519233815368988');" style=""> 607  //        set1.setLineWidth(2f);                                                                                  </span>
<span class="4052186244749569041" onmouseenter="enter('4052186244749569041');" onmouseout="out('4052186244749569041');" style=""> 608  //        set1.setCircleSize(5f);                                                                                 </span>
<span class="5178863964691876958" onmouseenter="enter('5178863964691876958');" onmouseout="out('5178863964691876958');" style=""> 609          set1.setFillColor(color);                                                                                 </span>
<span class="-3615467214536174629" onmouseenter="enter('-3615467214536174629');" onmouseout="out('-3615467214536174629');" style=""> 610          set1.setFillAlpha(255);                                                                                   </span>
<span class="-2764219564959910542" onmouseenter="enter('-2764219564959910542');" onmouseout="out('-2764219564959910542');" style=""> 611          set1.setDrawValues(false);                                                                                </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 612  //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                         </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 613  //        set1.setColor(Color.rgb(89, 178, 44));                                                                  </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 614          set1.setValueTextColor(CHART_TEXT_COLOR);                                                                 </span>
<span class="-729266328453548997" onmouseenter="enter('-729266328453548997');" onmouseout="out('-729266328453548997');" style=""> 615          set1.setAxisDependency(YAxis.AxisDependency.LEFT);                                                        </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 616          return set1;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 617      }                                                                                                             </span>
<span  style=""> 618                                                                                                                    </span>
<span class="812124301236032885" onmouseenter="enter('812124301236032885');" onmouseout="out('812124301236032885');" style=""> 619      protected LineDataSet createHeartrateSet(List&lt;Entry&gt; values, String label) {                                  </span>
<span class="-4136310660708315412" onmouseenter="enter('-4136310660708315412');" onmouseout="out('-4136310660708315412');" style=""> 620          LineDataSet set1 = new LineDataSet(values, label);                                                        </span>
<span class="5440468726562122008" onmouseenter="enter('5440468726562122008');" onmouseout="out('5440468726562122008');" style=""> 621          set1.setLineWidth(2.2f);                                                                                  </span>
<span class="-6998111113207584878" onmouseenter="enter('-6998111113207584878');" onmouseout="out('-6998111113207584878');" style=""> 622          set1.setColor(HEARTRATE_COLOR);                                                                           </span>
<span class="-2006007545975104421" onmouseenter="enter('-2006007545975104421');" onmouseout="out('-2006007545975104421');" style=""> 623  //        set1.setDrawCubic(true);                                                                                </span>
<span class="-5525611047697799836" onmouseenter="enter('-5525611047697799836');" onmouseout="out('-5525611047697799836');" style=""> 624          set1.setMode(LineDataSet.Mode.HORIZONTAL_BEZIER);                                                         </span>
<span class="-6788168983082898765" onmouseenter="enter('-6788168983082898765');" onmouseout="out('-6788168983082898765');" style=""> 625          set1.setCubicIntensity(0.1f);                                                                             </span>
<span class="-2371118698446016765" onmouseenter="enter('-2371118698446016765');" onmouseout="out('-2371118698446016765');" style=""> 626          set1.setDrawCircles(false);                                                                               </span>
<span class="8990366444861982417" onmouseenter="enter('8990366444861982417');" onmouseout="out('8990366444861982417');" style=""> 627  //        set1.setCircleRadius(2f);                                                                               </span>
<span class="7490911489692857332" onmouseenter="enter('7490911489692857332');" onmouseout="out('7490911489692857332');" style=""> 628  //        set1.setDrawFilled(true);                                                                               </span>
<span class="-2083836916768378283" onmouseenter="enter('-2083836916768378283');" onmouseout="out('-2083836916768378283');" style=""> 629  //        set1.setColor(getResources().getColor(android.R.color.background_light));                               </span>
<span class="5114874680539545534" onmouseenter="enter('5114874680539545534');" onmouseout="out('5114874680539545534');" style=""> 630  //        set1.setCircleColor(HEARTRATE_COLOR);                                                                   </span>
<span class="2152854923555754112" onmouseenter="enter('2152854923555754112');" onmouseout="out('2152854923555754112');" style=""> 631  //        set1.setFillColor(ColorTemplate.getHoloBlue());                                                         </span>
<span class="-6925279964003298556" onmouseenter="enter('-6925279964003298556');" onmouseout="out('-6925279964003298556');" style=""> 632  //        set1.setHighLightColor(Color.rgb(128, 0, 255));                                                         </span>
<span class="-6993271593810279216" onmouseenter="enter('-6993271593810279216');" onmouseout="out('-6993271593810279216');" style=""> 633  //        set1.setColor(Color.rgb(89, 178, 44));                                                                  </span>
<span class="-6976214771678818552" onmouseenter="enter('-6976214771678818552');" onmouseout="out('-6976214771678818552');" style=""> 634          set1.setDrawValues(true);                                                                                 </span>
<span class="-1544035992562981281" onmouseenter="enter('-1544035992562981281');" onmouseout="out('-1544035992562981281');" style=""> 635          set1.setValueTextColor(CHART_TEXT_COLOR);                                                                 </span>
<span class="7444000937070277499" onmouseenter="enter('7444000937070277499');" onmouseout="out('7444000937070277499');" style=""> 636          set1.setAxisDependency(YAxis.AxisDependency.RIGHT);                                                       </span>
<span class="-350982794024617438" onmouseenter="enter('-350982794024617438');" onmouseout="out('-350982794024617438');" style=""> 637          return set1;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 638      }                                                                                                             </span>
<span  style=""> 639                                                                                                                    </span>
<span class="-8033521169229713638" onmouseenter="enter('-8033521169229713638');" onmouseout="out('-8033521169229713638');" style=""> 640      protected RefreshTask createRefreshTask(String task, Context context) {                                       </span>
<span class="4652327534384605753" onmouseenter="enter('4652327534384605753');" onmouseout="out('4652327534384605753');" style=""> 641          return new RefreshTask(task, context);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 642      }                                                                                                             </span>
<span  style=""> 643                                                                                                                    </span>
<span class="-546204840646058388" onmouseenter="enter('-546204840646058388');" onmouseout="out('-546204840646058388');" style=""> 644      public class RefreshTask extends DBAccess {                                                                   </span>
<span class="3813756787288835606" onmouseenter="enter('3813756787288835606');" onmouseout="out('3813756787288835606');" style=""> 645          private ChartsData chartsData;                                                                            </span>
<span  style=""> 646                                                                                                                    </span>
<span class="6265910281991326326" onmouseenter="enter('6265910281991326326');" onmouseout="out('6265910281991326326');" style=""> 647          public RefreshTask(String task, Context context) {                                                        </span>
<span class="6170214191344158476" onmouseenter="enter('6170214191344158476');" onmouseout="out('6170214191344158476');" style=""> 648              super(task, context);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 649          }                                                                                                         </span>
<span  style=""> 650                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 651          @Override                                                                                                 </span>
<span class="6769214505219419913" onmouseenter="enter('6769214505219419913');" onmouseout="out('6769214505219419913');" style=""> 652          protected void doInBackground(DBHandler db) {                                                             </span>
<span class="-6937837508708639787" onmouseenter="enter('-6937837508708639787');" onmouseout="out('-6937837508708639787');" style=""> 653              ChartsHost chartsHost = getChartsHost();                                                              </span>
<span class="-6496109326060089067" onmouseenter="enter('-6496109326060089067');" onmouseout="out('-6496109326060089067');" style=""> 654              if (chartsHost != null) {                                                                             </span>
<span class="-1872147130605113863" onmouseenter="enter('-1872147130605113863');" onmouseout="out('-1872147130605113863');" style=""> 655                  chartsData = refreshInBackground(chartsHost, db, chartsHost.getDevice());                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 656              } else {                                                                                              </span>
<span class="4351338677612212716" onmouseenter="enter('4351338677612212716');" onmouseout="out('4351338677612212716');" style=""> 657                  cancel(true);                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 658              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659          }                                                                                                         </span>
<span  style=""> 660                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 661          @Override                                                                                                 </span>
<span class="7961646527709364830" onmouseenter="enter('7961646527709364830');" onmouseout="out('7961646527709364830');" style=""> 662          protected void onPostExecute(Object o) {                                                                  </span>
<span class="1329337488051350495" onmouseenter="enter('1329337488051350495');" onmouseout="out('1329337488051350495');" style=""> 663              super.onPostExecute(o);                                                                               </span>
<span class="4343120289681205406" onmouseenter="enter('4343120289681205406');" onmouseout="out('4343120289681205406');" style=""> 664              FragmentActivity activity = getActivity();                                                            </span>
<span class="1646077047954275991" onmouseenter="enter('1646077047954275991');" onmouseout="out('1646077047954275991');" style=""> 665              if (activity != null &amp;&amp; !activity.isFinishing() &amp;&amp; !activity.isDestroyed()) {                         </span>
<span class="-9005677599852802201" onmouseenter="enter('-9005677599852802201');" onmouseout="out('-9005677599852802201');" style=""> 666                  updateChartsnUIThread(chartsData);                                                                </span>
<span class="-4582773223831390369" onmouseenter="enter('-4582773223831390369');" onmouseout="out('-4582773223831390369');" style=""> 667                  renderCharts();                                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 668              } else {                                                                                              </span>
<span class="-112827357653254579" onmouseenter="enter('-112827357653254579');" onmouseout="out('-112827357653254579');" style=""> 669                  LOG.info(&quot;Not rendering charts because activity is not available anymore&quot;);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 670              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 671          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 672      }                                                                                                             </span>
<span  style=""> 673                                                                                                                    </span>
<span class="4496803111214409190" onmouseenter="enter('4496803111214409190');" onmouseout="out('4496803111214409190');" style=""> 674      protected abstract void updateChartsnUIThread(ChartsData chartsData);                                         </span>
<span  style=""> 675                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 676      /**                                                                                                           </span>
<span class="-5037778349112302453" onmouseenter="enter('-5037778349112302453');" onmouseout="out('-5037778349112302453');" style=""> 677       * Returns true if the date was successfully shifted, and false if the shift                                  </span>
<span class="-2032571983951913696" onmouseenter="enter('-2032571983951913696');" onmouseout="out('-2032571983951913696');" style=""> 678       * was ignored, e.g. when the to-value is in the future.                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 679       *                                                                                                            </span>
<span class="3294571698788299338" onmouseenter="enter('3294571698788299338');" onmouseout="out('3294571698788299338');" style=""> 680       * @param from                                                                                                </span>
<span class="-8398071401251508968" onmouseenter="enter('-8398071401251508968');" onmouseout="out('-8398071401251508968');" style=""> 681       * @param to                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 682       */                                                                                                           </span>
<span class="2489721831712552479" onmouseenter="enter('2489721831712552479');" onmouseout="out('2489721831712552479');" style=""> 683      public boolean setDateRange(Date from, Date to) {                                                             </span>
<span class="4190819803131113323" onmouseenter="enter('4190819803131113323');" onmouseout="out('4190819803131113323');" style=""> 684          if (from.compareTo(to) &gt; 0) {                                                                             </span>
<span class="8028532381572922008" onmouseenter="enter('8028532381572922008');" onmouseout="out('8028532381572922008');" style=""> 685              throw new IllegalArgumentException(&quot;Bad date range: &quot; + from + &quot;..&quot; + to);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686          }                                                                                                         </span>
<span class="-968081081932492520" onmouseenter="enter('-968081081932492520');" onmouseout="out('-968081081932492520');" style=""> 687          Date now = new Date();                                                                                    </span>
<span class="6487488966631950340" onmouseenter="enter('6487488966631950340');" onmouseout="out('6487488966631950340');" style=""> 688          if (to.after(now)) {                                                                                      </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 689              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 690          }                                                                                                         </span>
<span class="-9201818232828316665" onmouseenter="enter('-9201818232828316665');" onmouseout="out('-9201818232828316665');" style=""> 691          setStartDate(from);                                                                                       </span>
<span class="9222819538541566960" onmouseenter="enter('9222819538541566960');" onmouseout="out('9222819538541566960');" style=""> 692          setEndDate(to);                                                                                           </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 693          return true;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 694      }                                                                                                             </span>
<span  style=""> 695                                                                                                                    </span>
<span class="3159484724367933437" onmouseenter="enter('3159484724367933437');" onmouseout="out('3159484724367933437');" style=""> 696      protected void updateDateInfo(Date from, Date to) {                                                           </span>
<span class="-6255879985318699594" onmouseenter="enter('-6255879985318699594');" onmouseout="out('-6255879985318699594');" style=""> 697          if (from.equals(to)) {                                                                                    </span>
<span class="573039521209829270" onmouseenter="enter('573039521209829270');" onmouseout="out('573039521209829270');" style=""> 698              getChartsHost().setDateInfo(DateTimeUtils.formatDate(from));                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 699          } else {                                                                                                  </span>
<span class="6154857771528724742" onmouseenter="enter('6154857771528724742');" onmouseout="out('6154857771528724742');" style=""> 700              getChartsHost().setDateInfo(DateTimeUtils.formatDateRange(from, to));                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 701          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 702      }                                                                                                             </span>
<span  style=""> 703                                                                                                                    </span>
<span class="-2205559255794313412" onmouseenter="enter('-2205559255794313412');" onmouseout="out('-2205559255794313412');" style=""> 704      protected List&lt;? extends ActivitySample&gt; getSamples(DBHandler db, GBDevice device) {                          </span>
<span class="4967864623407424140" onmouseenter="enter('4967864623407424140');" onmouseout="out('4967864623407424140');" style=""> 705          int tsStart = getTSStart();                                                                               </span>
<span class="-7516136729766634070" onmouseenter="enter('-7516136729766634070');" onmouseout="out('-7516136729766634070');" style=""> 706          int tsEnd = getTSEnd();                                                                                   </span>
<span class="7673509543804257849" onmouseenter="enter('7673509543804257849');" onmouseout="out('7673509543804257849');" style=""> 707          List&lt;ActivitySample&gt; samples = (List&lt;ActivitySample&gt;) getSamples(db, device, tsStart, tsEnd);             </span>
<span class="-5815796914087715329" onmouseenter="enter('-5815796914087715329');" onmouseout="out('-5815796914087715329');" style=""> 708          ensureStartAndEndSamples(samples, tsStart, tsEnd);                                                        </span>
<span class="1818060248517305383" onmouseenter="enter('1818060248517305383');" onmouseout="out('1818060248517305383');" style=""> 709  //        List&lt;ActivitySample&gt; samples2 = new ArrayList&lt;&gt;();                                                      </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 710  //        int min = Math.min(samples.size(), 10);                                                                 </span>
<span class="8601721457749856480" onmouseenter="enter('8601721457749856480');" onmouseout="out('8601721457749856480');" style=""> 711  //        int min = Math.min(samples.size(), 10);                                                                 </span>
<span class="-3297133522407861021" onmouseenter="enter('-3297133522407861021');" onmouseout="out('-3297133522407861021');" style=""> 712  //        for (int i = 0; i &lt; min; i++) {                                                                         </span>
<span class="-5419954369064878282" onmouseenter="enter('-5419954369064878282');" onmouseout="out('-5419954369064878282');" style=""> 713  //            samples2.add(samples.get(i));                                                                       </span>
<span class="-7859020312693891120" onmouseenter="enter('-7859020312693891120');" onmouseout="out('-7859020312693891120');" style=""> 714  //        }                                                                                                       </span>
<span class="-217733928506784495" onmouseenter="enter('-217733928506784495');" onmouseout="out('-217733928506784495');" style=""> 715  //        return samples2;                                                                                        </span>
<span class="8329125895357939517" onmouseenter="enter('8329125895357939517');" onmouseout="out('8329125895357939517');" style=""> 716          return samples;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 717      }                                                                                                             </span>
<span  style=""> 718                                                                                                                    </span>
<span class="-1106201085093865693" onmouseenter="enter('-1106201085093865693');" onmouseout="out('-1106201085093865693');" style=""> 719      protected void ensureStartAndEndSamples(List&lt;ActivitySample&gt; samples, int tsStart, int tsEnd) {               </span>
<span class="-7875576828687087964" onmouseenter="enter('-7875576828687087964');" onmouseout="out('-7875576828687087964');" style=""> 720          if (samples == null || samples.isEmpty()) {                                                               </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 721              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 722          }                                                                                                         </span>
<span class="6215771732045184164" onmouseenter="enter('6215771732045184164');" onmouseout="out('6215771732045184164');" style=""> 723          ActivitySample lastSample = samples.get(samples.size() - 1);                                              </span>
<span class="-5724051378546831092" onmouseenter="enter('-5724051378546831092');" onmouseout="out('-5724051378546831092');" style=""> 724          if (lastSample.getTimestamp() &lt; tsEnd) {                                                                  </span>
<span class="-340307626157070265" onmouseenter="enter('-340307626157070265');" onmouseout="out('-340307626157070265');" style=""> 725              samples.add(createTrailingActivitySample(lastSample, tsEnd));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 726          }                                                                                                         </span>
<span  style=""> 727                                                                                                                    </span>
<span class="-7926496395118744001" onmouseenter="enter('-7926496395118744001');" onmouseout="out('-7926496395118744001');" style=""> 728          ActivitySample firstSample = samples.get(0);                                                              </span>
<span class="-7009339048909230945" onmouseenter="enter('-7009339048909230945');" onmouseout="out('-7009339048909230945');" style=""> 729          if (firstSample.getTimestamp() &gt; tsStart) {                                                               </span>
<span class="-5264575031409257517" onmouseenter="enter('-5264575031409257517');" onmouseout="out('-5264575031409257517');" style=""> 730              samples.add(createTrailingActivitySample(firstSample, tsStart));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 731          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 732      }                                                                                                             </span>
<span  style=""> 733                                                                                                                    </span>
<span class="3833670724694452809" onmouseenter="enter('3833670724694452809');" onmouseout="out('3833670724694452809');" style=""> 734      private ActivitySample createTrailingActivitySample(ActivitySample referenceSample, int timestamp) {          </span>
<span class="-2046593497045539776" onmouseenter="enter('-2046593497045539776');" onmouseout="out('-2046593497045539776');" style=""> 735          TrailingActivitySample sample = new TrailingActivitySample();                                             </span>
<span class="1247170989116197247" onmouseenter="enter('1247170989116197247');" onmouseout="out('1247170989116197247');" style=""> 736          if (referenceSample instanceof AbstractActivitySample) {                                                  </span>
<span class="753416811428354981" onmouseenter="enter('753416811428354981');" onmouseout="out('753416811428354981');" style=""> 737              AbstractActivitySample reference = (AbstractActivitySample) referenceSample;                          </span>
<span class="179894899616756222" onmouseenter="enter('179894899616756222');" onmouseout="out('179894899616756222');" style=""> 738              sample.setUserId(reference.getUserId());                                                              </span>
<span class="-9074495792241680711" onmouseenter="enter('-9074495792241680711');" onmouseout="out('-9074495792241680711');" style=""> 739              sample.setDeviceId(reference.getDeviceId());                                                          </span>
<span class="-9156726696647878603" onmouseenter="enter('-9156726696647878603');" onmouseout="out('-9156726696647878603');" style=""> 740              sample.setProvider(reference.getProvider());                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 741          }                                                                                                         </span>
<span class="8993551488058005050" onmouseenter="enter('8993551488058005050');" onmouseout="out('8993551488058005050');" style=""> 742          sample.setTimestamp(timestamp);                                                                           </span>
<span class="1760114423996777276" onmouseenter="enter('1760114423996777276');" onmouseout="out('1760114423996777276');" style=""> 743          return sample;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 744      }                                                                                                             </span>
<span  style=""> 745                                                                                                                    </span>
<span class="-1444262751819808388" onmouseenter="enter('-1444262751819808388');" onmouseout="out('-1444262751819808388');" style=""> 746      private int getTSEnd() {                                                                                      </span>
<span class="8265537562094819633" onmouseenter="enter('8265537562094819633');" onmouseout="out('8265537562094819633');" style=""> 747          return toTimestamp(getEndDate());                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 748      }                                                                                                             </span>
<span  style=""> 749                                                                                                                    </span>
<span class="-8800656553144883662" onmouseenter="enter('-8800656553144883662');" onmouseout="out('-8800656553144883662');" style=""> 750      private int getTSStart() {                                                                                    </span>
<span class="-6038622859463971662" onmouseenter="enter('-6038622859463971662');" onmouseout="out('-6038622859463971662');" style=""> 751          return toTimestamp(getStartDate());                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 752      }                                                                                                             </span>
<span  style=""> 753                                                                                                                    </span>
<span class="-4614437324300305507" onmouseenter="enter('-4614437324300305507');" onmouseout="out('-4614437324300305507');" style=""> 754      private int toTimestamp(Date date) {                                                                          </span>
<span class="3504665279848614366" onmouseenter="enter('3504665279848614366');" onmouseout="out('3504665279848614366');" style=""> 755          return (int) ((date.getTime() / 1000));                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 756      }                                                                                                             </span>
<span  style=""> 757                                                                                                                    </span>
<span class="-4297875969128159092" onmouseenter="enter('-4297875969128159092');" onmouseout="out('-4297875969128159092');" style=""> 758      public static class DefaultChartsData&lt;T extends ChartData&lt;?&gt;&gt; extends ChartsData {                            </span>
<span class="6426673791816913577" onmouseenter="enter('6426673791816913577');" onmouseout="out('6426673791816913577');" style=""> 759          private final T data;                                                                                     </span>
<span class="-7952082456269420489" onmouseenter="enter('-7952082456269420489');" onmouseout="out('-7952082456269420489');" style=""> 760          private IAxisValueFormatter xValueFormatter;                                                              </span>
<span  style=""> 761                                                                                                                    </span>
<span class="6541589990597847820" onmouseenter="enter('6541589990597847820');" onmouseout="out('6541589990597847820');" style=""> 762          public DefaultChartsData(T data, IAxisValueFormatter xValueFormatter) {                                   </span>
<span class="5524270510531897998" onmouseenter="enter('5524270510531897998');" onmouseout="out('5524270510531897998');" style=""> 763              this.xValueFormatter = xValueFormatter;                                                               </span>
<span class="6755336779332792903" onmouseenter="enter('6755336779332792903');" onmouseout="out('6755336779332792903');" style=""> 764              this.data = data;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 765          }                                                                                                         </span>
<span  style=""> 766                                                                                                                    </span>
<span class="-2012372510684410029" onmouseenter="enter('-2012372510684410029');" onmouseout="out('-2012372510684410029');" style=""> 767          public IAxisValueFormatter getXValueFormatter() {                                                         </span>
<span class="-7533476322813168520" onmouseenter="enter('-7533476322813168520');" onmouseout="out('-7533476322813168520');" style=""> 768              return xValueFormatter;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 769          }                                                                                                         </span>
<span  style=""> 770                                                                                                                    </span>
<span class="5384784438887663423" onmouseenter="enter('5384784438887663423');" onmouseout="out('5384784438887663423');" style=""> 771          public T getData() {                                                                                      </span>
<span class="2885311051796901480" onmouseenter="enter('2885311051796901480');" onmouseout="out('2885311051796901480');" style=""> 772              return data;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 773          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 774      }                                                                                                             </span>
<span  style=""> 775                                                                                                                    </span>
<span class="1326180124040264963" onmouseenter="enter('1326180124040264963');" onmouseout="out('1326180124040264963');" style=""> 776      protected static class SampleXLabelFormatter implements IAxisValueFormatter {                                 </span>
<span class="5353010427567723059" onmouseenter="enter('5353010427567723059');" onmouseout="out('5353010427567723059');" style=""> 777          private final TimestampTranslation tsTranslation;                                                         </span>
<span class="-3636759102507942125" onmouseenter="enter('-3636759102507942125');" onmouseout="out('-3636759102507942125');" style=""> 778          SimpleDateFormat annotationDateFormat = new SimpleDateFormat(&quot;HH:mm&quot;);                                    </span>
<span class="1540142582082446680" onmouseenter="enter('1540142582082446680');" onmouseout="out('1540142582082446680');" style=""> 779  //        SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;dd.MM.yyyy HH:mm&quot;);                                 </span>
<span class="4878211627103907492" onmouseenter="enter('4878211627103907492');" onmouseout="out('4878211627103907492');" style=""> 780          Calendar cal = GregorianCalendar.getInstance();                                                           </span>
<span  style=""> 781                                                                                                                    </span>
<span class="5120004681237147878" onmouseenter="enter('5120004681237147878');" onmouseout="out('5120004681237147878');" style=""> 782          public SampleXLabelFormatter(TimestampTranslation tsTranslation) {                                        </span>
<span class="332289991409172359" onmouseenter="enter('332289991409172359');" onmouseout="out('332289991409172359');" style=""> 783              this.tsTranslation = tsTranslation;                                                                   </span>
<span  style=""> 784                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 785          }                                                                                                         </span>
<span class="9166492997131092423" onmouseenter="enter('9166492997131092423');" onmouseout="out('9166492997131092423');" style=""> 786          // TODO: this does not work. Cannot use precomputed labels                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 787          @Override                                                                                                 </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 788          public String getFormattedValue(float value, AxisBase axis) {                                             </span>
<span class="7424853438265862645" onmouseenter="enter('7424853438265862645');" onmouseout="out('7424853438265862645');" style=""> 789              cal.clear();                                                                                          </span>
<span class="-8022679979208902148" onmouseenter="enter('-8022679979208902148');" onmouseout="out('-8022679979208902148');" style=""> 790              int ts = (int) value;                                                                                 </span>
<span class="-2120013244284691976" onmouseenter="enter('-2120013244284691976');" onmouseout="out('-2120013244284691976');" style=""> 791              cal.setTimeInMillis(tsTranslation.toOriginalValue(ts) * 1000L);                                       </span>
<span class="-5878359517855184171" onmouseenter="enter('-5878359517855184171');" onmouseout="out('-5878359517855184171');" style=""> 792              Date date = cal.getTime();                                                                            </span>
<span class="-2286280998074804817" onmouseenter="enter('-2286280998074804817');" onmouseout="out('-2286280998074804817');" style=""> 793              String dateString = annotationDateFormat.format(date);                                                </span>
<span class="-4331225868129427907" onmouseenter="enter('-4331225868129427907');" onmouseout="out('-4331225868129427907');" style=""> 794              return dateString;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 795          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 796      }                                                                                                             </span>
<span  style=""> 797                                                                                                                    </span>
<span class="853591074258071334" onmouseenter="enter('853591074258071334');" onmouseout="out('853591074258071334');" style=""> 798      protected static class PreformattedXIndexLabelFormatter implements IAxisValueFormatter {                      </span>
<span class="-5932642099782009782" onmouseenter="enter('-5932642099782009782');" onmouseout="out('-5932642099782009782');" style=""> 799          private ArrayList&lt;String&gt; xLabels;                                                                        </span>
<span  style=""> 800                                                                                                                    </span>
<span class="-3496008191511610310" onmouseenter="enter('-3496008191511610310');" onmouseout="out('-3496008191511610310');" style=""> 801          public PreformattedXIndexLabelFormatter(ArrayList&lt;String&gt; xLabels) {                                      </span>
<span class="1925102162908705801" onmouseenter="enter('1925102162908705801');" onmouseout="out('1925102162908705801');" style=""> 802              this.xLabels = xLabels;                                                                               </span>
<span  style=""> 803                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 804          }                                                                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 805          @Override                                                                                                 </span>
<span class="-5944278503754971995" onmouseenter="enter('-5944278503754971995');" onmouseout="out('-5944278503754971995');" style=""> 806          public String getFormattedValue(float value, AxisBase axis) {                                             </span>
<span class="-6653294473874823013" onmouseenter="enter('-6653294473874823013');" onmouseout="out('-6653294473874823013');" style=""> 807              int index = (int) value;                                                                              </span>
<span class="-6571719897851150925" onmouseenter="enter('-6571719897851150925');" onmouseout="out('-6571719897851150925');" style=""> 808              if (xLabels == null || index &gt;= xLabels.size()) {                                                     </span>
<span class="-889824612483989703" onmouseenter="enter('-889824612483989703');" onmouseout="out('-889824612483989703');" style=""> 809                  return String.valueOf(value);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 810              }                                                                                                     </span>
<span class="-5802960474501370558" onmouseenter="enter('-5802960474501370558');" onmouseout="out('-5802960474501370558');" style=""> 811              return xLabels.get(index);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 812          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 813      }                                                                                                             </span>
<span  style=""> 814                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 815      /**                                                                                                           </span>
<span class="6592799195109599568" onmouseenter="enter('6592799195109599568');" onmouseout="out('6592799195109599568');" style=""> 816       * Awkward class that helps in translating long timestamp                                                     </span>
<span class="-2647406073998843607" onmouseenter="enter('-2647406073998843607');" onmouseout="out('-2647406073998843607');" style=""> 817       * values to float (sic!) values. It basically rebases all                                                    </span>
<span class="-6950802996886985644" onmouseenter="enter('-6950802996886985644');" onmouseout="out('-6950802996886985644');" style=""> 818       * timestamps to a base (the very first) timestamp value.                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 819       *                                                                                                            </span>
<span class="467771366063509856" onmouseenter="enter('467771366063509856');" onmouseout="out('467771366063509856');" style=""> 820       * It does this so that the large timestamp values can be used                                                </span>
<span class="-3960902832668220629" onmouseenter="enter('-3960902832668220629');" onmouseout="out('-3960902832668220629');" style=""> 821       * floating point values, where the mantissa is just 24 bits.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 822       */                                                                                                           </span>
<span class="3353052654588926596" onmouseenter="enter('3353052654588926596');" onmouseout="out('3353052654588926596');" style=""> 823      protected static class TimestampTranslation {                                                                 </span>
<span class="-8324695427159884252" onmouseenter="enter('-8324695427159884252');" onmouseout="out('-8324695427159884252');" style=""> 824          private int tsOffset = -1;                                                                                </span>
<span  style=""> 825                                                                                                                    </span>
<span class="-2038703014401681062" onmouseenter="enter('-2038703014401681062');" onmouseout="out('-2038703014401681062');" style=""> 826          public int shorten(int timestamp) {                                                                       </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 827              if (tsOffset == -1) {                                                                                 </span>
<span class="5713941682084663603" onmouseenter="enter('5713941682084663603');" onmouseout="out('5713941682084663603');" style=""> 828                  tsOffset = timestamp;                                                                             </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 829                  return 0;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 830              }                                                                                                     </span>
<span class="-455923503597890370" onmouseenter="enter('-455923503597890370');" onmouseout="out('-455923503597890370');" style=""> 831              return timestamp - tsOffset;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 832          }                                                                                                         </span>
<span  style=""> 833                                                                                                                    </span>
<span class="-7013677261634300092" onmouseenter="enter('-7013677261634300092');" onmouseout="out('-7013677261634300092');" style=""> 834          public int toOriginalValue(int timestamp) {                                                               </span>
<span class="5146918814720139993" onmouseenter="enter('5146918814720139993');" onmouseout="out('5146918814720139993');" style=""> 835              if (tsOffset == -1) {                                                                                 </span>
<span class="-3020799636637211745" onmouseenter="enter('-3020799636637211745');" onmouseout="out('-3020799636637211745');" style=""> 836                  return timestamp;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 837              }                                                                                                     </span>
<span class="-7912123621537489577" onmouseenter="enter('-7912123621537489577');" onmouseout="out('-7912123621537489577');" style=""> 838              return timestamp + tsOffset;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 839          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 840      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 841  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            