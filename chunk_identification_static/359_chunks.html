<!DOCTYPE html>
<html lang="en">
          <head>
            <meta charset="utf-8">
            <title>359 chunks</title>
                <style>
                    #top {
                        height: 48vh;
                        overflow-y: auto;
                    }
                    #bottom {
                        height: 48vh;
                        overflow-y: auto;
                    }
                </style>
          </head>
          <body>
            <pre>[[{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.Arrays;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.sql.Statement;\n&#x27;
                           &#x27;import java.text.SimpleDateFormat;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Collections;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.Arrays;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;import java.sql.Statement;\n&#x27;
                           &#x27;import java.text.SimpleDateFormat;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Collections;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.concurrent.atomic.AtomicInteger;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.util.stream.Collectors;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.concurrent.atomic.AtomicInteger;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\nimport java.util.stream.Collectors;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private final String SQL = &quot;INSERT INTO ? (?, ?, &#x27;
                         &#x27;?, ?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;private final String SQL = &quot;INSERT INTO ? (?, ?, ?, &#x27;
                         &#x27;?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private final String SQL = &quot;INSERT INTO ? (?, ?, &#x27;
                         &#x27;?, ?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private String tableName;\n&#x27;
                         &#x27;    private final String defaultTable = &quot;dirtyData_&quot; &#x27;
                         &#x27;+ System.currentTimeMillis();\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;    private Long batchSize;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private String tableName;\n&#x27;
                         &#x27;    private final String defaultTable = &quot;dirtyData_&quot; &#x27;
                         &#x27;+ System.currentTimeMillis();\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n    private Long batchSize;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;    private void beforeConsume(String url,\n&#x27;
                           &#x27;                               String userName,\n&#x27;
                           &#x27;                               String password,\n&#x27;
                           &#x27;                               String tableName,\n&#x27;
                           &#x27;                               boolean &#x27;
                           &#x27;isCreatedTable) throws ClassNotFoundException, &#x27;
                           &#x27;SQLException {\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;    private void beforeConsume(String url,\n&#x27;
                           &#x27;                               String userName,\n&#x27;
                           &#x27;                               String password,\n&#x27;
                           &#x27;                               String tableName,\n&#x27;
                           &#x27;                               boolean &#x27;
                           &#x27;isCreatedTable) throws ClassNotFoundException, &#x27;
                           &#x27;SQLException {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            // create table for dirty data\n&#x27;
                           &#x27;            if (!isCreatedTable) {\n&#x27;
                           &#x27;                createTable(tableName);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String insertField = &#x27;
                           &#x27;Arrays.stream(tableField)\n&#x27;
                           &#x27;                    .map(this::quoteIdentifier)\n&#x27;
                           &#x27;                    .collect(Collectors.joining(&quot;, &#x27;
                           &#x27;&quot;));\n&#x27;
                           &#x27;            String insertSql = &quot;INSERT INTO &quot; + &#x27;
                           &#x27;quoteIdentifier(tableName)\n&#x27;
                           &#x27;                    + &quot;(&quot; + insertField + &quot;) &#x27;
                           &#x27;VALUES (?, ?, ?, ?, ?)&quot;;\n&#x27;
                           &#x27;            statement = &#x27;
                           &#x27;connection.prepareStatement(insertSql);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // create table for dirty data\n&#x27;
                           &#x27;            if (!isCreatedTable) {\n&#x27;
                           &#x27;                createTable(tableName);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String insertField = &#x27;
                           &#x27;Arrays.stream(tableField)\n&#x27;
                           &#x27;                    .map(this::quoteIdentifier)\n&#x27;
                           &#x27;                    .collect(Collectors.joining(&quot;, &#x27;
                           &#x27;&quot;));\n&#x27;
                           &#x27;            String insertSql = &quot;INSERT INTO &quot; + &#x27;
                           &#x27;quoteIdentifier(tableName)\n&#x27;
                           &#x27;                    + &quot;(&quot; + insertField + &quot;) &#x27;
                           &#x27;VALUES (?, ?, ?, ?, ?)&quot;;\n&#x27;
                           &#x27;            statement = &#x27;
                           &#x27;connection.prepareStatement(insertSql);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;     * @throws SQLException SQL异常\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;     * @throws SQLException SQL异常\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n     * @throws SQLException SQL异常\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;
                         &#x27;        synchronized (LOCK_STR) {\n&#x27;
                         &#x27;            Class.forName(DRIVER_NAME);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            connection = &#x27;
                         &#x27;DriverManager.getConnection(url, userName, &#x27;
                         &#x27;password);\n&#x27;
                         &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;    }\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}}],
 [{&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.Arrays;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.sql.Statement;\n&#x27;
                           &#x27;import java.text.SimpleDateFormat;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Collections;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.Arrays;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;import java.sql.Statement;\n&#x27;
                           &#x27;import java.text.SimpleDateFormat;\n&#x27;
                           &#x27;import java.util.ArrayList;\n&#x27;
                           &#x27;import java.util.Arrays;\n&#x27;
                           &#x27;import java.util.Collections;\n&#x27;
                           &#x27;import java.util.List;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.concurrent.atomic.AtomicInteger;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;import java.util.stream.Collectors;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;import java.util.concurrent.atomic.AtomicInteger;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\nimport java.util.stream.Collectors;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private final String SQL = &quot;INSERT INTO ? (?, ?, &#x27;
                         &#x27;?, ?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;private final String SQL = &quot;INSERT INTO ? (?, ?, ?, &#x27;
                         &#x27;?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private final String SQL = &quot;INSERT INTO ? (?, ?, &#x27;
                         &#x27;?, ?) VALUES (?, ?, ?, ?) &quot;;\n&#x27;
                         &#x27;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private String tableName;\n&#x27;
                         &#x27;    private final String defaultTable = &quot;dirtyData_&quot; &#x27;
                         &#x27;+ System.currentTimeMillis();\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;    private Long batchSize;\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private String tableName;\n&#x27;
                         &#x27;    private final String defaultTable = &quot;dirtyData_&quot; &#x27;
                         &#x27;+ System.currentTimeMillis();\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n    private Long batchSize;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;    private void beforeConsume(String url,\n&#x27;
                           &#x27;                               String userName,\n&#x27;
                           &#x27;                               String password,\n&#x27;
                           &#x27;                               String tableName,\n&#x27;
                           &#x27;                               boolean &#x27;
                           &#x27;isCreatedTable) throws ClassNotFoundException, &#x27;
                           &#x27;SQLException {\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;    private void beforeConsume(String url,\n&#x27;
                           &#x27;                               String userName,\n&#x27;
                           &#x27;                               String password,\n&#x27;
                           &#x27;                               String tableName,\n&#x27;
                           &#x27;                               boolean &#x27;
                           &#x27;isCreatedTable) throws ClassNotFoundException, &#x27;
                           &#x27;SQLException {\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;            // create table for dirty data\n&#x27;
                           &#x27;            if (!isCreatedTable) {\n&#x27;
                           &#x27;                createTable(tableName);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String insertField = &#x27;
                           &#x27;Arrays.stream(tableField)\n&#x27;
                           &#x27;                    .map(this::quoteIdentifier)\n&#x27;
                           &#x27;                    .collect(Collectors.joining(&quot;, &#x27;
                           &#x27;&quot;));\n&#x27;
                           &#x27;            String insertSql = &quot;INSERT INTO &quot; + &#x27;
                           &#x27;quoteIdentifier(tableName)\n&#x27;
                           &#x27;                    + &quot;(&quot; + insertField + &quot;) &#x27;
                           &#x27;VALUES (?, ?, ?, ?, ?)&quot;;\n&#x27;
                           &#x27;            statement = &#x27;
                           &#x27;connection.prepareStatement(insertSql);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            // create table for dirty data\n&#x27;
                           &#x27;            if (!isCreatedTable) {\n&#x27;
                           &#x27;                createTable(tableName);\n&#x27;
                           &#x27;            }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;            String insertField = &#x27;
                           &#x27;Arrays.stream(tableField)\n&#x27;
                           &#x27;                    .map(this::quoteIdentifier)\n&#x27;
                           &#x27;                    .collect(Collectors.joining(&quot;, &#x27;
                           &#x27;&quot;));\n&#x27;
                           &#x27;            String insertSql = &quot;INSERT INTO &quot; + &#x27;
                           &#x27;quoteIdentifier(tableName)\n&#x27;
                           &#x27;                    + &quot;(&quot; + insertField + &quot;) &#x27;
                           &#x27;VALUES (?, ?, ?, ?, ?)&quot;;\n&#x27;
                           &#x27;            statement = &#x27;
                           &#x27;connection.prepareStatement(insertSql);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;     * @throws SQLException SQL异常\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;     * @throws SQLException SQL异常\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;     * @return 是否创建成功\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n     * @throws SQLException SQL异常\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        DirtyDataEntity dataEntity = queue.take();\n&#x27;
                         &#x27;        count++;\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        DirtyDataEntity entity = queue.take();\n&#x27;
                           &#x27;        count.incrementAndGet();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        List&lt;String&gt; data = new ArrayList&lt;&gt;();\n&#x27;
                           &#x27;        data.add(String.valueOf(count.get()));\n&#x27;
                           &#x27;        Collections.addAll(data, entity.get());\n&#x27;
                           &#x27;        for (int i = 0; i &lt; FIELD_NUMBER; i++) {\n&#x27;
                           &#x27;            statement.setString(i + 1, &#x27;
                           &#x27;data.get(i));\n&#x27;
                           &#x27;        }\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        statement.addBatch();\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        if (count.get() % batchSize == 0) {\n&#x27;
                           &#x27;            statement.executeBatch();\n&#x27;
                           &#x27;        }\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;        tableName = properties.get(&quot;tableName&quot;) == &#x27;
                         &#x27;null ? defaultTable : properties.get(&quot;tableName&quot;);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        SimpleDateFormat timeFormat = new &#x27;
                           &#x27;SimpleDateFormat(&quot;yyyy_MM_dd_HH_mm_ss&quot;);\n&#x27;
                           &#x27;        String tableName = &#x27;
                           &#x27;properties.getOrDefault(&quot;tableName&quot;,\n&#x27;
                           &#x27;                &quot;DirtyDataFromMysql_&quot; + &#x27;
                           &#x27;timeFormat.format(System.currentTimeMillis()));\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;},
          {&#x27;CHUNK_OURS&#x27;: &#x27;\n&#x27;
                         &#x27;        boolean isCreatedTable = &#x27;
                         &#x27;Boolean.parseBoolean(properties.get(&quot;isCreatedTable&quot;));\n&#x27;
                         &#x27;        if (!isCreatedTable) {\n&#x27;
                         &#x27;            if (!createTable(tableName)) {\n&#x27;
                         &#x27;                throw new RuntimeException(&quot;create &#x27;
                         &#x27;table for dirty Data error, please check privilege &#x27;
                         &#x27;for database&quot;);\n&#x27;
                         &#x27;            }\n&#x27;
                         &#x27;            LOG.info(&quot;create &quot; + tableName + &quot; &#x27;
                         &#x27;succeed!&quot;);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;        setStatement(url, userName, password, &#x27;
                         &#x27;tableName);\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;
                           &#x27;        batchSize = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;batchSize&quot;, &#x27;
                           &#x27;&quot;10000&quot;));\n&#x27;
                           &#x27;        errorLimit = &#x27;
                           &#x27;Long.parseLong(properties.getOrDefault(&quot;errorLimit&quot;, &#x27;
                           &#x27;&quot;1000&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        boolean isCreatedTable = &#x27;
                           &#x27;Boolean.parseBoolean(\n&#x27;
                           &#x27;                &#x27;
                           &#x27;properties.getOrDefault(&quot;isCreatedTable&quot;, &#x27;
                           &#x27;&quot;false&quot;));\n&#x27;
                           &#x27;\n&#x27;
                           &#x27;        beforeConsume(url, userName, password, &#x27;
                           &#x27;tableName, isCreatedTable);\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;baseline&#x27;, &#x27;spork&#x27;, &#x27;jfstmerge&#x27;}},
  {&#x27;eq&#x27;: [{&#x27;CHUNK_OURS&#x27;: &#x27;    private void setStatement(String url,\n&#x27;
                         &#x27;                              String userName,\n&#x27;
                         &#x27;                              String password,\n&#x27;
                         &#x27;                              String tableName) &#x27;
                         &#x27;throws ClassNotFoundException, SQLException {\n&#x27;
                         &#x27;        synchronized (LOCK_STR) {\n&#x27;
                         &#x27;            Class.forName(DRIVER_NAME);\n&#x27;
                         &#x27;\n&#x27;
                         &#x27;            connection = &#x27;
                         &#x27;DriverManager.getConnection(url, userName, &#x27;
                         &#x27;password);\n&#x27;
                         &#x27;            statement = &#x27;
                         &#x27;connection.prepareStatement(SQL);\n&#x27;
                         &#x27;            statement.setString(1, tableName);\n&#x27;
                         &#x27;        }\n&#x27;
                         &#x27;    }\n&#x27;,
           &#x27;CHUNK_THEIRS&#x27;: &#x27;\n&#x27;}],
   &#x27;mergers&#x27;: {&#x27;jfstmerge&#x27;}}]]</pre>
          </body>
        </html>
        