<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>268</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    268
                    <a href="267.html">prev</a>
                    <a href="269.html">next</a>
                    <a href="268_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DSAppTeam/PanelSwitchHelper_469944db02866cc7be5f915a2902dc16ca0e286a_app/src/main/java/com/example/demo/ChatSampleActivity.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DSAppTeam\PanelSwitchHelper show &quot;469944db02866cc7be5f915a2902dc16ca0e286a:app/src/main/java/com/example/demo/ChatSampleActivity.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DSAppTeam\PanelSwitchHelper show &quot;469944db02866cc7be5f915a2902dc16ca0e286a^1:app/src/main/java/com/example/demo/ChatSampleActivity.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DSAppTeam\PanelSwitchHelper show &quot;469944db02866cc7be5f915a2902dc16ca0e286a^2:app/src/main/java/com/example/demo/ChatSampleActivity.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DSAppTeam\PanelSwitchHelper show &quot;f87cc697985ef0b742f97818ebe322c40da2710f:app/src/main/java/com/example/demo/ChatSampleActivity.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[sbj]], subset: [[sbj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   2 package com.example.demo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   3 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   4 import android.databinding.DataBindingUtil;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   5 import android.support.v7.app.AppCompatActivity;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   6 import android.os.Bundle;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   7 import android.support.v7.widget.LinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   8 import android.support.v7.widget.SimpleItemAnimator;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   9 import android.text.TextUtils;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  10 import android.util.Log;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  11 import android.view.View;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  12 import android.widget.Button;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  13 import android.widget.Toast;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  14 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  15 import com.effective.R;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  16 import com.effective.android.panel.PanelSwitchHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  17 import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  18 import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  19 import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  20 import com.effective.android.panel.interfaces.listener.OnViewClickListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import com.effective.android.panel.view.PanelView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import com.effective.databinding.ActivityChatLayoutBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import com.example.demo.chat.ChatAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import com.example.demo.chat.ChatInfo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  25 import com.example.demo.emotion.EmotionPagerView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import com.example.demo.emotion.Emotions;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import com.rd.PageIndicatorView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  29 import java.util.ArrayList;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  30 import java.util.List;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  31 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  32 /**</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  33  * Created by yummyLau on 18-7-11</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  34  * Email: yummyl.lau@gmail.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  35  * blog: yummylau.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  36  */</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37 public class ChatSampleActivity extends AppCompatActivity {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  38     private ActivityChatLayoutBinding mBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  39     private PanelSwitchHelper mHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40     private ChatAdapter mAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41     private LinearLayoutManager mLinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42     private Runnable mScrollToBottomRunnable;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  43     private static final String TAG = &quot;ChatSampleActivity&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  44 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  45     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  46     protected void onCreate(Bundle savedInstanceState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  47         super.onCreate(savedInstanceState);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  48         mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  49         int type = getIntent().getIntExtra(Constants.KEY_PAGE_TYPE, PageType.DEFAULT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50         //这里只是demo提前隐藏标题栏，如果应用自己实现了标题栏或者通过自定义view开发标题栏，根据业务隐藏或者设置透明色就可以了，随便扩展</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51         if(type == PageType.TRANSPARENT_STATUS_BAR){</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52             supportRequestWindowFeature(Window.FEATURE_NO_TITLE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  53         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  54 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  55         mBinding = DataBindingUtil.setContentView(this, R.layout.common_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57         switch (type) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58             case PageType.COLOR_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary));">  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60                 //可以在代码设置，也可以在xml设置</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  63                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  64             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65             case PageType.TRANSPARENT_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66                 StatusbarHelper.setStatusBarColor(this, Color.TRANSPARENT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  68                 mBinding.getRoot().setBackgroundResource(R.drawable.bg_gradient);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_pa🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  70                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  71             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  72             default: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  74             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  75         }</span>
  76 &gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes:app/src/main/java/com/example/demo/ChatActivity.java
  77         initView();
  78     }
  79 
  80     private void initView() {
  81         mLinearLayoutManager = new LinearLayoutManager(this);
  82         mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
<abbr title="  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);">  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false)🔵</abbr>
  84         List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
  85         for(int i = 0; i &lt; 50; i++){
  86             chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
  87         }
  88         mAdapter = new ChatAdapter(this,chatInfos);
  89         mBinding.recyclerView.setAdapter(mAdapter);
  90         mBinding.send.setOnClickListener(new View.OnClickListener() {
  91             @Override
  92             public void onClick(View v) {
  93                 String content = mBinding.editText.getText().toString();
  94                 if (TextUtils.isEmpty(content)) {
  95                     Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
  96                     return;
  97                 }
  98                 mAdapter.insertInfo(ChatInfo.CREATE(content));
  99                 mBinding.editText.setText(null);
 100                 scrollToBottom();
 101             }
 102         });
 103         mScrollToBottomRunnable = new Runnable() {
 104             @Override
 105             public void run() {
 106                 if (mAdapter.getItemCount() &gt; 0) {
 107                     mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 108                 }
 109             }
 110         };
 111     }
 112 
 113     private void scrollToBottom() {
 114         mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 0);
 115     }
 116 
 117     @Override
 118     protected void onStart() {
 119         super.onStart();
 120         if (mHelper == null) {
 121             mHelper = new PanelSwitchHelper.Builder(this)
 122                     .bindPanelSwitchLayout(R.id.panel_switch_layout)
 123                     .bindPanelContainerId(R.id.panel_container)
 124                     .bindContentContainerId(R.id.content_view)
 125                     //可选
 126                     .addKeyboardStateListener(new OnKeyboardStateListener() {
 127                         @Override
 128                         public void onKeyboardChange(boolean visible) {
 129                             if(visible){
 130                                 scrollToBottom();
 131                             }
 132                             Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 133 
 134                         }
 135                     })
 136                     //可选
 137                     .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 138                         @Override
 139                         public void onFocusChange(View view, boolean hasFocus) {
 140                             Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 141                         }
 142                     })
 143                     //可选
 144                     .addViewClickListener(new OnViewClickListener() {
 145                         @Override
 146                         public void onViewClick(View view) {
 147                             if(view.getId() != R.id.empty_view){
 148                                 scrollToBottom();
 149                             }
 150                             Log.d(TAG, &quot;点击了View : &quot; + view);
 151                         }
 152                     })
 153                     //可选
 154                     .addPanelChangeListener(new OnPanelChangeListener() {
 155 
 156                         @Override
 157                         public void onKeyboard() {
 158                             Log.d(TAG, &quot;唤起系统输入法&quot;);
 159                             mBinding.emotionBtn.setSelected(false);
 160                         }
 161 
 162                         @Override
 163                         public void onNone() {
 164                             Log.d(TAG, &quot;隐藏所有面板&quot;);
 165                             mBinding.emotionBtn.setSelected(false);
 166                         }
 167 
 168                         @Override
 169                         public void onPanel(PanelView view) {
 170                             Log.d(TAG, &quot;唤起面板 : &quot; + view);
<abbr title=" 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);"> 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : f🔵</abbr>
 172                         }
 173 
 174                         @Override
<abbr title=" 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth🔵</abbr>
 176                             switch (panelView.getId()) {
 177                                 case R.id.panel_emotion: {
<abbr title=" 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);"> 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.vie🔵</abbr>
<abbr title=" 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);"> 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30🔵</abbr>
 180                                     pagerView.buildEmotionViews(
<abbr title=" 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.page🔵</abbr>
 182                                             mBinding.editText,
 183                                             Emotions.getEmotions(), width, viewPagerSize);
 184                                     break;
 185                                 }
 186                                 case R.id.panel_addition: {
 187                                     //auto center,nothing to do
 188                                     break;
 189                                 }
 190                             }
 191                         }
 192                     })
 193                     .logTrack(true)             //output log
 194                     .build();
 195         }
 196     }
 197 
 198     @Override
 199     public void onBackPressed() {
 200         if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 201             return;
 202         }
 203         super.onBackPressed();
 204     }
 205 
 206     @Override
 207 
 208     protected void onDestroy() {
 209         super.onDestroy();
 210         if (mHelper != null) {
 211             mHelper.onDestroy();
 212         }
 213 //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 214     }
 215 }
 216 ||||||| GitAnalyzerPlus_base
 217 package com.example.demo;
 218 
 219 import android.databinding.DataBindingUtil;
 220 import android.support.v7.app.AppCompatActivity;
 221 import android.os.Bundle;
 222 import android.support.v7.widget.LinearLayoutManager;
 223 import android.support.v7.widget.SimpleItemAnimator;
 224 import android.text.TextUtils;
 225 import android.util.Log;
 226 import android.view.View;
 227 import android.widget.Button;
 228 import android.widget.Toast;
 229 
 230 import com.effective.R;
 231 import com.effective.android.panel.PanelSwitchHelper;
 232 import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;
 233 import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;
 234 import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;
 235 import com.effective.android.panel.interfaces.listener.OnViewClickListener;
 236 import com.effective.android.panel.view.PanelView;
 237 import com.effective.databinding.ActivityChatLayoutBinding;
 238 import com.example.demo.chat.ChatAdapter;
 239 import com.example.demo.chat.ChatInfo;
 240 import com.example.demo.emotion.EmotionPagerView;
 241 import com.example.demo.emotion.Emotions;
 242 import com.rd.PageIndicatorView;
 243 
 244 import java.util.ArrayList;
 245 import java.util.List;
 246 
 247 /**
 248  * Created by yummyLau on 18-7-11
 249  * Email: yummyl.lau@gmail.com
 250  * blog: yummylau.com
 251  */
 252 public class ChatSampleActivity extends AppCompatActivity {
 253     private ActivityChatLayoutBinding mBinding;
 254     private PanelSwitchHelper mHelper;
 255     private ChatAdapter mAdapter;
 256     private LinearLayoutManager mLinearLayoutManager;
 257     private Runnable mScrollToBottomRunnable;
 258     private static final String TAG = &quot;ChatSampleActivity&quot;;
 259 
 260     @Override
 261     protected void onCreate(Bundle savedInstanceState) {
 262         super.onCreate(savedInstanceState);
 263         mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);
 264         initView();
 265     }
 266 
 267     private void initView() {
 268         mLinearLayoutManager = new LinearLayoutManager(this);
 269         mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
<abbr title=" 270         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);"> 270         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false)🔵</abbr>
 271         List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
 272         for(int i = 0; i &lt; 50; i++){
 273             chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
 274         }
 275         mAdapter = new ChatAdapter(this,chatInfos);
 276         mBinding.recyclerView.setAdapter(mAdapter);
 277         mBinding.send.setOnClickListener(new View.OnClickListener() {
 278             @Override
 279             public void onClick(View v) {
 280                 String content = mBinding.editText.getText().toString();
 281                 if (TextUtils.isEmpty(content)) {
 282                     Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
 283                     return;
 284                 }
 285                 mAdapter.insertInfo(ChatInfo.CREATE(content));
 286                 mBinding.editText.setText(null);
 287                 scrollToBottom();
 288             }
 289         });
 290         mScrollToBottomRunnable = new Runnable() {
 291             @Override
 292             public void run() {
 293                 if (mAdapter.getItemCount() &gt; 0) {
 294                     mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 295                 }
 296             }
 297         };
 298     }
 299 
 300     private void scrollToBottom() {
 301         mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 300);
 302     }
 303 
 304     @Override
 305     protected void onStart() {
 306         super.onStart();
 307         if (mHelper == null) {
 308             mHelper = new PanelSwitchHelper.Builder(this)
 309                     .bindPanelSwitchLayout(R.id.panel_switch_layout)
 310                     .bindPanelContainerId(R.id.panel_container)
 311                     .bindContentContainerId(R.id.content_view)
 312                     //可选
 313                     .addKeyboardStateListener(new OnKeyboardStateListener() {
 314                         @Override
 315                         public void onKeyboardChange(boolean visible) {
 316                             Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 317 
 318                         }
 319                     })
 320                     //可选
 321                     .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 322                         @Override
 323                         public void onFocusChange(View view, boolean hasFocus) {
 324                             Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 325                         }
 326                     })
 327                     //可选
 328                     .addViewClickListener(new OnViewClickListener() {
 329                         @Override
 330                         public void onViewClick(View view) {
 331                             Log.d(TAG, &quot;点击了View : &quot; + view);
 332                         }
 333                     })
 334                     //可选
 335                     .addPanelChangeListener(new OnPanelChangeListener() {
 336 
 337                         @Override
 338                         public void onKeyboard() {
 339                             Log.d(TAG, &quot;唤起系统输入法&quot;);
 340                             scrollToBottom();
 341                             mBinding.emotionBtn.setSelected(false);
 342                         }
 343 
 344                         @Override
 345                         public void onNone() {
 346                             Log.d(TAG, &quot;隐藏所有面板&quot;);
 347                             mBinding.emotionBtn.setSelected(false);
 348                         }
 349 
 350                         @Override
 351                         public void onPanel(PanelView view) {
 352                             Log.d(TAG, &quot;唤起面板 : &quot; + view);
 353                             scrollToBottom();
<abbr title=" 354                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);"> 354                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : f🔵</abbr>
 355                         }
 356 
 357                         @Override
<abbr title=" 358                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 358                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth🔵</abbr>
 359                             switch (panelView.getId()) {
 360                                 case R.id.panel_emotion: {
<abbr title=" 361                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);"> 361                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.vie🔵</abbr>
<abbr title=" 362                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);"> 362                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30🔵</abbr>
 363                                     pagerView.buildEmotionViews(
<abbr title=" 364                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 364                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.page🔵</abbr>
 365                                             mBinding.editText,
 366                                             Emotions.getEmotions(), width, viewPagerSize);
 367                                     break;
 368                                 }
 369                                 case R.id.panel_addition: {
 370                                     //auto center,nothing to do
 371                                     break;
 372                                 }
 373                             }
 374                         }
 375                     })
 376                     .logTrack(true)             //output log
 377                     .build();
 378         }
 379     }
 380 
 381     @Override
 382     public void onBackPressed() {
 383         if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 384             return;
 385         }
 386         super.onBackPressed();
 387     }
 388 
 389     @Override
 390 
 391     protected void onDestroy() {
 392         super.onDestroy();
 393         if (mHelper != null) {
 394             mHelper.onDestroy();
 395         }
 396 //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 397     }
 398 }
 399 =======
 400 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs</pre></td>
                            <td><pre>   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   2 package com.example.demo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   3 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   4 import android.databinding.DataBindingUtil;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   5 import android.support.v7.app.AppCompatActivity;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   6 import android.os.Bundle;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   7 import android.support.v7.widget.LinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   8 import android.support.v7.widget.SimpleItemAnimator;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   9 import android.text.TextUtils;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  10 import android.util.Log;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  11 import android.view.View;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  12 import android.widget.Button;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  13 import android.widget.Toast;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  14 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  15 import com.effective.R;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  16 import com.effective.android.panel.PanelSwitchHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  17 import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  18 import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  19 import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  20 import com.effective.android.panel.interfaces.listener.OnViewClickListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import com.effective.android.panel.view.PanelView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import com.effective.databinding.ActivityChatLayoutBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import com.example.demo.chat.ChatAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import com.example.demo.chat.ChatInfo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  25 import com.example.demo.emotion.EmotionPagerView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import com.example.demo.emotion.Emotions;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import com.rd.PageIndicatorView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  29 import java.util.ArrayList;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  30 import java.util.List;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  31 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  32 /**</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  33  * Created by yummyLau on 18-7-11</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  34  * Email: yummyl.lau@gmail.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  35  * blog: yummylau.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  36  */</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37 public class ChatSampleActivity extends AppCompatActivity {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  38     private ActivityChatLayoutBinding mBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  39     private PanelSwitchHelper mHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40     private ChatAdapter mAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41     private LinearLayoutManager mLinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42     private Runnable mScrollToBottomRunnable;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  43     private static final String TAG = &quot;ChatSampleActivity&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  44 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  45     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  46     protected void onCreate(Bundle savedInstanceState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  47         super.onCreate(savedInstanceState);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  48         mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  49         int type = getIntent().getIntExtra(Constants.KEY_PAGE_TYPE, PageType.DEFAULT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50         //这里只是demo提前隐藏标题栏，如果应用自己实现了标题栏或者通过自定义view开发标题栏，根据业务隐藏或者设置透明色就可以了，随便扩展</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51         if(type == PageType.TRANSPARENT_STATUS_BAR){</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52             supportRequestWindowFeature(Window.FEATURE_NO_TITLE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  53         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  54 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  55         mBinding = DataBindingUtil.setContentView(this, R.layout.common_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57         switch (type) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58             case PageType.COLOR_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary));">  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60                 //可以在代码设置，也可以在xml设置</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  63                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  64             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65             case PageType.TRANSPARENT_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66                 StatusbarHelper.setStatusBarColor(this, Color.TRANSPARENT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  68                 mBinding.getRoot().setBackgroundResource(R.drawable.bg_gradient);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_pa🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  70                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  71             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  72             default: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  74             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  75         }</span>
  76 &gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes:app/src/main/java/com/example/demo/ChatActivity.java
  77         initView();
  78     }
  79 
  80     private void initView() {
  81         mLinearLayoutManager = new LinearLayoutManager(this);
  82         mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
<abbr title="  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);">  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false)🔵</abbr>
  84         List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
  85         for(int i = 0; i &lt; 50; i++){
  86             chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
  87         }
  88         mAdapter = new ChatAdapter(this,chatInfos);
  89         mBinding.recyclerView.setAdapter(mAdapter);
  90         mBinding.send.setOnClickListener(new View.OnClickListener() {
  91             @Override
  92             public void onClick(View v) {
  93                 String content = mBinding.editText.getText().toString();
  94                 if (TextUtils.isEmpty(content)) {
  95                     Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
  96                     return;
  97                 }
  98                 mAdapter.insertInfo(ChatInfo.CREATE(content));
  99                 mBinding.editText.setText(null);
 100                 scrollToBottom();
 101             }
 102         });
 103         mScrollToBottomRunnable = new Runnable() {
 104             @Override
 105             public void run() {
 106                 if (mAdapter.getItemCount() &gt; 0) {
 107                     mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 108                 }
 109             }
 110         };
 111     }
 112 
 113     private void scrollToBottom() {
 114         mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 0);
 115     }
 116 
 117     @Override
 118     protected void onStart() {
 119         super.onStart();
 120         if (mHelper == null) {
 121             mHelper = new PanelSwitchHelper.Builder(this)
 122                     .bindPanelSwitchLayout(R.id.panel_switch_layout)
 123                     .bindPanelContainerId(R.id.panel_container)
 124                     .bindContentContainerId(R.id.content_view)
 125                     //可选
 126                     .addKeyboardStateListener(new OnKeyboardStateListener() {
 127                         @Override
 128                         public void onKeyboardChange(boolean visible) {
 129                             if(visible){
 130                                 scrollToBottom();
 131                             }
 132                             Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 133 
 134                         }
 135                     })
 136                     //可选
 137                     .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 138                         @Override
 139                         public void onFocusChange(View view, boolean hasFocus) {
 140                             Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 141                         }
 142                     })
 143                     //可选
 144                     .addViewClickListener(new OnViewClickListener() {
 145                         @Override
 146                         public void onViewClick(View view) {
 147                             if(view.getId() != R.id.empty_view){
 148                                 scrollToBottom();
 149                             }
 150                             Log.d(TAG, &quot;点击了View : &quot; + view);
 151                         }
 152                     })
 153                     //可选
 154                     .addPanelChangeListener(new OnPanelChangeListener() {
 155 
 156                         @Override
 157                         public void onKeyboard() {
 158                             Log.d(TAG, &quot;唤起系统输入法&quot;);
 159                             mBinding.emotionBtn.setSelected(false);
 160                         }
 161 
 162                         @Override
 163                         public void onNone() {
 164                             Log.d(TAG, &quot;隐藏所有面板&quot;);
 165                             mBinding.emotionBtn.setSelected(false);
 166                         }
 167 
 168                         @Override
 169                         public void onPanel(PanelView view) {
 170                             Log.d(TAG, &quot;唤起面板 : &quot; + view);
<abbr title=" 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);"> 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : f🔵</abbr>
 172                         }
 173 
 174                         @Override
<abbr title=" 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth🔵</abbr>
 176                             switch (panelView.getId()) {
 177                                 case R.id.panel_emotion: {
<abbr title=" 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);"> 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.vie🔵</abbr>
<abbr title=" 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);"> 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30🔵</abbr>
 180                                     pagerView.buildEmotionViews(
<abbr title=" 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.page🔵</abbr>
 182                                             mBinding.editText,
 183                                             Emotions.getEmotions(), width, viewPagerSize);
 184                                     break;
 185                                 }
 186                                 case R.id.panel_addition: {
 187                                     //auto center,nothing to do
 188                                     break;
 189                                 }
 190                             }
 191                         }
 192                     })
 193                     .logTrack(true)             //output log
 194                     .build();
 195         }
 196     }
 197 
 198     @Override
 199     public void onBackPressed() {
 200         if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 201             return;
 202         }
 203         super.onBackPressed();
 204     }
 205 
 206     @Override
 207 
 208     protected void onDestroy() {
 209         super.onDestroy();
 210         if (mHelper != null) {
 211             mHelper.onDestroy();
 212         }
 213 //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 214     }
 215 }
 216 ||||||| BASE
 217 package com.example.demo;
 218 
 219 import android.databinding.DataBindingUtil;
 220 import android.support.v7.app.AppCompatActivity;
 221 import android.os.Bundle;
 222 import android.support.v7.widget.LinearLayoutManager;
 223 import android.support.v7.widget.SimpleItemAnimator;
 224 import android.text.TextUtils;
 225 import android.util.Log;
 226 import android.view.View;
 227 import android.widget.Button;
 228 import android.widget.Toast;
 229 
 230 import com.effective.R;
 231 import com.effective.android.panel.PanelSwitchHelper;
 232 import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;
 233 import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;
 234 import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;
 235 import com.effective.android.panel.interfaces.listener.OnViewClickListener;
 236 import com.effective.android.panel.view.PanelView;
 237 import com.effective.databinding.ActivityChatLayoutBinding;
 238 import com.example.demo.chat.ChatAdapter;
 239 import com.example.demo.chat.ChatInfo;
 240 import com.example.demo.emotion.EmotionPagerView;
 241 import com.example.demo.emotion.Emotions;
 242 import com.rd.PageIndicatorView;
 243 
 244 import java.util.ArrayList;
 245 import java.util.List;
 246 
 247 /**
 248  * Created by yummyLau on 18-7-11
 249  * Email: yummyl.lau@gmail.com
 250  * blog: yummylau.com
 251  */
 252 public class ChatSampleActivity extends AppCompatActivity {
 253     private ActivityChatLayoutBinding mBinding;
 254     private PanelSwitchHelper mHelper;
 255     private ChatAdapter mAdapter;
 256     private LinearLayoutManager mLinearLayoutManager;
 257     private Runnable mScrollToBottomRunnable;
 258     private static final String TAG = &quot;ChatSampleActivity&quot;;
 259 
 260     @Override
 261     protected void onCreate(Bundle savedInstanceState) {
 262         super.onCreate(savedInstanceState);
 263         mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);
 264         initView();
 265     }
 266 
 267     private void initView() {
 268         mLinearLayoutManager = new LinearLayoutManager(this);
 269         mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
<abbr title=" 270         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);"> 270         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false)🔵</abbr>
 271         List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
 272         for(int i = 0; i &lt; 50; i++){
 273             chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
 274         }
 275         mAdapter = new ChatAdapter(this,chatInfos);
 276         mBinding.recyclerView.setAdapter(mAdapter);
 277         mBinding.send.setOnClickListener(new View.OnClickListener() {
 278             @Override
 279             public void onClick(View v) {
 280                 String content = mBinding.editText.getText().toString();
 281                 if (TextUtils.isEmpty(content)) {
 282                     Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
 283                     return;
 284                 }
 285                 mAdapter.insertInfo(ChatInfo.CREATE(content));
 286                 mBinding.editText.setText(null);
 287                 scrollToBottom();
 288             }
 289         });
 290         mScrollToBottomRunnable = new Runnable() {
 291             @Override
 292             public void run() {
 293                 if (mAdapter.getItemCount() &gt; 0) {
 294                     mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 295                 }
 296             }
 297         };
 298     }
 299 
 300     private void scrollToBottom() {
 301         mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 300);
 302     }
 303 
 304     @Override
 305     protected void onStart() {
 306         super.onStart();
 307         if (mHelper == null) {
 308             mHelper = new PanelSwitchHelper.Builder(this)
 309                     .bindPanelSwitchLayout(R.id.panel_switch_layout)
 310                     .bindPanelContainerId(R.id.panel_container)
 311                     .bindContentContainerId(R.id.content_view)
 312                     //可选
 313                     .addKeyboardStateListener(new OnKeyboardStateListener() {
 314                         @Override
 315                         public void onKeyboardChange(boolean visible) {
 316                             Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 317 
 318                         }
 319                     })
 320                     //可选
 321                     .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 322                         @Override
 323                         public void onFocusChange(View view, boolean hasFocus) {
 324                             Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 325                         }
 326                     })
 327                     //可选
 328                     .addViewClickListener(new OnViewClickListener() {
 329                         @Override
 330                         public void onViewClick(View view) {
 331                             Log.d(TAG, &quot;点击了View : &quot; + view);
 332                         }
 333                     })
 334                     //可选
 335                     .addPanelChangeListener(new OnPanelChangeListener() {
 336 
 337                         @Override
 338                         public void onKeyboard() {
 339                             Log.d(TAG, &quot;唤起系统输入法&quot;);
 340                             scrollToBottom();
 341                             mBinding.emotionBtn.setSelected(false);
 342                         }
 343 
 344                         @Override
 345                         public void onNone() {
 346                             Log.d(TAG, &quot;隐藏所有面板&quot;);
 347                             mBinding.emotionBtn.setSelected(false);
 348                         }
 349 
 350                         @Override
 351                         public void onPanel(PanelView view) {
 352                             Log.d(TAG, &quot;唤起面板 : &quot; + view);
 353                             scrollToBottom();
<abbr title=" 354                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);"> 354                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : f🔵</abbr>
 355                         }
 356 
 357                         @Override
<abbr title=" 358                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 358                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth🔵</abbr>
 359                             switch (panelView.getId()) {
 360                                 case R.id.panel_emotion: {
<abbr title=" 361                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);"> 361                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.vie🔵</abbr>
<abbr title=" 362                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);"> 362                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30🔵</abbr>
 363                                     pagerView.buildEmotionViews(
<abbr title=" 364                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 364                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.page🔵</abbr>
 365                                             mBinding.editText,
 366                                             Emotions.getEmotions(), width, viewPagerSize);
 367                                     break;
 368                                 }
 369                                 case R.id.panel_addition: {
 370                                     //auto center,nothing to do
 371                                     break;
 372                                 }
 373                             }
 374                         }
 375                     })
 376                     .logTrack(true)             //output log
 377                     .build();
 378         }
 379     }
 380 
 381     @Override
 382     public void onBackPressed() {
 383         if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 384             return;
 385         }
 386         super.onBackPressed();
 387     }
 388 
 389     @Override
 390 
 391     protected void onDestroy() {
 392         super.onDestroy();
 393         if (mHelper != null) {
 394             mHelper.onDestroy();
 395         }
 396 //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 397     }
 398 }
 399 =======
 400 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS</pre></td>
                            <td><pre>   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   2 package com.example.demo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   3 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   4 import android.databinding.DataBindingUtil;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   5 import android.support.v7.app.AppCompatActivity;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   6 import android.os.Bundle;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   7 import android.support.v7.widget.LinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   8 import android.support.v7.widget.SimpleItemAnimator;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">   9 import android.text.TextUtils;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  10 import android.util.Log;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  11 import android.view.View;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  12 import android.widget.Button;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  13 import android.widget.Toast;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  14 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  15 import com.effective.R;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  16 import com.effective.android.panel.PanelSwitchHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  17 import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  18 import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  19 import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  20 import com.effective.android.panel.interfaces.listener.OnViewClickListener;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import com.effective.android.panel.view.PanelView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import com.effective.databinding.ActivityChatLayoutBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import com.example.demo.chat.ChatAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import com.example.demo.chat.ChatInfo;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  25 import com.example.demo.emotion.EmotionPagerView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import com.example.demo.emotion.Emotions;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import com.rd.PageIndicatorView;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  29 import java.util.ArrayList;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  30 import java.util.List;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  31 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  32 /**</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  33  * Created by yummyLau on 18-7-11</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  34  * Email: yummyl.lau@gmail.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  35  * blog: yummylau.com</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  36  */</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37 public class ChatSampleActivity extends AppCompatActivity {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  38     private ActivityChatLayoutBinding mBinding;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  39     private PanelSwitchHelper mHelper;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  40     private ChatAdapter mAdapter;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  41     private LinearLayoutManager mLinearLayoutManager;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  42     private Runnable mScrollToBottomRunnable;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  43     private static final String TAG = &quot;ChatSampleActivity&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  44 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  45     @Override</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  46     protected void onCreate(Bundle savedInstanceState) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  47         super.onCreate(savedInstanceState);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  48         mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  49         int type = getIntent().getIntExtra(Constants.KEY_PAGE_TYPE, PageType.DEFAULT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  50         //这里只是demo提前隐藏标题栏，如果应用自己实现了标题栏或者通过自定义view开发标题栏，根据业务隐藏或者设置透明色就可以了，随便扩展</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  51         if(type == PageType.TRANSPARENT_STATUS_BAR){</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52             supportRequestWindowFeature(Window.FEATURE_NO_TITLE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  53         }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  54 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  55         mBinding = DataBindingUtil.setContentView(this, R.layout.common_chat_layout);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57         switch (type) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58             case PageType.COLOR_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary));">  59                 StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60                 //可以在代码设置，也可以在xml设置</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  62                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  63                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  64             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  65             case PageType.TRANSPARENT_STATUS_BAR: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  66                 StatusbarHelper.setStatusBarColor(this, Color.TRANSPARENT);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  67                 mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  68                 mBinding.getRoot().setBackgroundResource(R.drawable.bg_gradient);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  69                 mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_pa🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  70                 break;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  71             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  72             default: {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  73                 mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg🔵</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  74             }</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  75         }</span>
  76 &gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes:app/src/main/java/com/example/demo/ChatActivity.java
  77         initView();
  78     }
  79 
  80     private void initView() {
  81         mLinearLayoutManager = new LinearLayoutManager(this);
  82         mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
<abbr title="  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);">  83         ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false)🔵</abbr>
  84         List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
  85         for(int i = 0; i &lt; 50; i++){
  86             chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
  87         }
  88         mAdapter = new ChatAdapter(this,chatInfos);
  89         mBinding.recyclerView.setAdapter(mAdapter);
  90         mBinding.send.setOnClickListener(new View.OnClickListener() {
  91             @Override
  92             public void onClick(View v) {
  93                 String content = mBinding.editText.getText().toString();
  94                 if (TextUtils.isEmpty(content)) {
  95                     Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
  96                     return;
  97                 }
  98                 mAdapter.insertInfo(ChatInfo.CREATE(content));
  99                 mBinding.editText.setText(null);
 100                 scrollToBottom();
 101             }
 102         });
 103         mScrollToBottomRunnable = new Runnable() {
 104             @Override
 105             public void run() {
 106                 if (mAdapter.getItemCount() &gt; 0) {
 107                     mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 108                 }
 109             }
 110         };
 111     }
 112 
 113     private void scrollToBottom() {
 114         mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 0);
 115     }
 116 
 117     @Override
 118     protected void onStart() {
 119         super.onStart();
 120         if (mHelper == null) {
 121             mHelper = new PanelSwitchHelper.Builder(this)
 122                     .bindPanelSwitchLayout(R.id.panel_switch_layout)
 123                     .bindPanelContainerId(R.id.panel_container)
 124                     .bindContentContainerId(R.id.content_view)
 125                     //可选
 126                     .addKeyboardStateListener(new OnKeyboardStateListener() {
 127                         @Override
 128                         public void onKeyboardChange(boolean visible) {
 129                             if(visible){
 130                                 scrollToBottom();
 131                             }
 132                             Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 133 
 134                         }
 135                     })
 136                     //可选
 137                     .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 138                         @Override
 139                         public void onFocusChange(View view, boolean hasFocus) {
 140                             Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 141                         }
 142                     })
 143                     //可选
 144                     .addViewClickListener(new OnViewClickListener() {
 145                         @Override
 146                         public void onViewClick(View view) {
 147                             if(view.getId() != R.id.empty_view){
 148                                 scrollToBottom();
 149                             }
 150                             Log.d(TAG, &quot;点击了View : &quot; + view);
 151                         }
 152                     })
 153                     //可选
 154                     .addPanelChangeListener(new OnPanelChangeListener() {
 155 
 156                         @Override
 157                         public void onKeyboard() {
 158                             Log.d(TAG, &quot;唤起系统输入法&quot;);
 159                             mBinding.emotionBtn.setSelected(false);
 160                         }
 161 
 162                         @Override
 163                         public void onNone() {
 164                             Log.d(TAG, &quot;隐藏所有面板&quot;);
 165                             mBinding.emotionBtn.setSelected(false);
 166                         }
 167 
 168                         @Override
 169                         public void onPanel(PanelView view) {
 170                             Log.d(TAG, &quot;唤起面板 : &quot; + view);
<abbr title=" 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);"> 171                             mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : f🔵</abbr>
 172                         }
 173 
 174                         @Override
<abbr title=" 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 175                         public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth🔵</abbr>
 176                             switch (panelView.getId()) {
 177                                 case R.id.panel_emotion: {
<abbr title=" 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);"> 178                                     EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.vie🔵</abbr>
<abbr title=" 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);"> 179                                     int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30🔵</abbr>
 180                                     pagerView.buildEmotionViews(
<abbr title=" 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 181                                             (PageIndicatorView) mBinding.getRoot().findViewById(R.id.page🔵</abbr>
 182                                             mBinding.editText,
 183                                             Emotions.getEmotions(), width, viewPagerSize);
 184                                     break;
 185                                 }
 186                                 case R.id.panel_addition: {
 187                                     //auto center,nothing to do
 188                                     break;
 189                                 }
 190                             }
 191                         }
 192                     })
 193                     .logTrack(true)             //output log
 194                     .build();
 195         }
 196     }
 197 
 198     @Override
 199     public void onBackPressed() {
 200         if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 201             return;
 202         }
 203         super.onBackPressed();
 204     }
 205 
 206     @Override
 207 
 208     protected void onDestroy() {
 209         super.onDestroy();
 210         if (mHelper != null) {
 211             mHelper.onDestroy();
 212         }
 213 //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 214     }
 215 }
 216 ||||||| BASE
<abbr title=" 217 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 217 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr>
 218 =======
 219 
 220 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  package com.example.demo;
   2  
   3  import android.databinding.DataBindingUtil;
   4  import android.support.v7.app.AppCompatActivity;
   5  import android.os.Bundle;
   6  import android.support.v7.widget.LinearLayoutManager;
   7  import android.support.v7.widget.SimpleItemAnimator;
   8  import android.text.TextUtils;
   9  import android.util.Log;
  10  import android.view.View;
  11  import android.widget.Button;
  12  import android.widget.Toast;
  13  
  14  import com.effective.R;
  15  import com.effective.android.panel.PanelSwitchHelper;
  16  import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;
  17  import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;
  18  import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;
  19  import com.effective.android.panel.interfaces.listener.OnViewClickListener;
  20  import com.effective.android.panel.view.PanelView;
  21  import com.effective.databinding.ActivityChatLayoutBinding;
  22  import com.example.demo.chat.ChatAdapter;
  23  import com.example.demo.chat.ChatInfo;
  24  import com.example.demo.emotion.EmotionPagerView;
  25  import com.example.demo.emotion.Emotions;
  26  import com.rd.PageIndicatorView;
  27  
  28  import java.util.ArrayList;
  29  import java.util.List;
  30  
  31  /**
  32   * Created by yummyLau on 18-7-11
  33   * Email: yummyl.lau@gmail.com
  34   * blog: yummylau.com
  35   */
  36  public class ChatSampleActivity extends AppCompatActivity {
  37      private ActivityChatLayoutBinding mBinding;
  38      private PanelSwitchHelper mHelper;
  39      private ChatAdapter mAdapter;
  40      private LinearLayoutManager mLinearLayoutManager;
  41      private Runnable mScrollToBottomRunnable;
  42      private static final String TAG = &quot;ChatSampleActivity&quot;;
  43  
  44      @Override
  45      protected void onCreate(Bundle savedInstanceState) {
  46          super.onCreate(savedInstanceState);
  47          mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +        int type = getIntent().getIntExtra(Constants.KEY_PAGE_TYPE, PageType.DEFAULT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +        //这里只是demo提前隐藏标题栏，如果应用自己实现了标题栏或者通过自定义view开发标题栏，根据业务隐藏或者设置透明色就可以了，随便扩展</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +        if(type == PageType.TRANSPARENT_STATUS_BAR){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +            supportRequestWindowFeature(Window.FEATURE_NO_TITLE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +        mBinding = DataBindingUtil.setContentView(this, R.layout.common_chat_layout);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +        switch (type) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +            case PageType.COLOR_STATUS_BAR: {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +                StatusbarHelper.setStatusBarColor(this, ContextCompat.getColor(this, R.color.colorPrimary));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                //可以在代码设置，也可以在xml设置</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +                mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +                mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +                break;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +            }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +            case PageType.TRANSPARENT_STATUS_BAR: {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +                StatusbarHelper.setStatusBarColor(this, Color.TRANSPARENT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +                mBinding.getRoot().setFitsSystemWindows(true);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                mBinding.getRoot().setBackgroundResource(R.drawable.bg_gradient);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  68 +                mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));">  68 +                mBinding.panelContainer.setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_col🔵</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +                break;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +            }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +            default: {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +                mBinding.getRoot().setBackgroundColor(ContextCompat.getColor(this, R.color.common_page_bg_color));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +            }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +&gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes:app/src/main/java/com/example/demo/ChatActivity.java</span>
  76          initView();
  77      }
  78  
  79      private void initView() {
  80          mLinearLayoutManager = new LinearLayoutManager(this);
  81          mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);
  82          ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);
  83          List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();
  84          for(int i = 0; i &lt; 50; i++){
  85              chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));
  86          }
  87          mAdapter = new ChatAdapter(this,chatInfos);
  88          mBinding.recyclerView.setAdapter(mAdapter);
  89          mBinding.send.setOnClickListener(new View.OnClickListener() {
  90              @Override
  91              public void onClick(View v) {
  92                  String content = mBinding.editText.getText().toString();
  93                  if (TextUtils.isEmpty(content)) {
  94                      Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();
  95                      return;
  96                  }
  97                  mAdapter.insertInfo(ChatInfo.CREATE(content));
  98                  mBinding.editText.setText(null);
  99                  scrollToBottom();
 100              }
 101          });
 102          mScrollToBottomRunnable = new Runnable() {
 103              @Override
 104              public void run() {
 105                  if (mAdapter.getItemCount() &gt; 0) {
 106                      mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);
 107                  }
 108              }
 109          };
 110      }
 111  
 112      private void scrollToBottom() {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 113 -        mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 300);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +        mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 0);</span>
 115      }
 116  
 117      @Override
 118      protected void onStart() {
 119          super.onStart();
 120          if (mHelper == null) {
 121              mHelper = new PanelSwitchHelper.Builder(this)
 122                      .bindPanelSwitchLayout(R.id.panel_switch_layout)
 123                      .bindPanelContainerId(R.id.panel_container)
 124                      .bindContentContainerId(R.id.content_view)
 125                      //可选
 126                      .addKeyboardStateListener(new OnKeyboardStateListener() {
 127                          @Override
 128                          public void onKeyboardChange(boolean visible) {
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +                            if(visible){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +                                scrollToBottom();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +                            }</span>
 132                              Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);
 133  
 134                          }
 135                      })
 136                      //可选
 137                      .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {
 138                          @Override
 139                          public void onFocusChange(View view, boolean hasFocus) {
 140                              Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);
 141                          }
 142                      })
 143                      //可选
 144                      .addViewClickListener(new OnViewClickListener() {
 145                          @Override
 146                          public void onViewClick(View view) {
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +                            if(view.getId() != R.id.empty_view){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +                                scrollToBottom();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +                            }</span>
 150                              Log.d(TAG, &quot;点击了View : &quot; + view);
 151                          }
 152                      })
 153                      //可选
 154                      .addPanelChangeListener(new OnPanelChangeListener() {
 155  
 156                          @Override
 157                          public void onKeyboard() {
 158                              Log.d(TAG, &quot;唤起系统输入法&quot;);
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 159 -                            scrollToBottom();</span>
 160                              mBinding.emotionBtn.setSelected(false);
 161                          }
 162  
 163                          @Override
 164                          public void onNone() {
 165                              Log.d(TAG, &quot;隐藏所有面板&quot;);
 166                              mBinding.emotionBtn.setSelected(false);
 167                          }
 168  
 169                          @Override
 170                          public void onPanel(PanelView view) {
 171                              Log.d(TAG, &quot;唤起面板 : &quot; + view);
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 172 -                            scrollToBottom();</span>
 173                              mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);
 174                          }
 175  
 176                          @Override
<abbr title=" 177                          public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 177                          public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int old🔵</abbr>
 178                              switch (panelView.getId()) {
 179                                  case R.id.panel_emotion: {
 180                                      EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);
 181                                      int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);
 182                                      pagerView.buildEmotionViews(
<abbr title=" 183                                              (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 183                                              (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicator🔵</abbr>
 184                                              mBinding.editText,
 185                                              Emotions.getEmotions(), width, viewPagerSize);
 186                                      break;
 187                                  }
 188                                  case R.id.panel_addition: {
 189                                      //auto center,nothing to do
 190                                      break;
 191                                  }
 192                              }
 193                          }
 194                      })
 195                      .logTrack(true)             //output log
 196                      .build();
 197          }
 198      }
 199  
 200      @Override
 201      public void onBackPressed() {
 202          if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {
 203              return;
 204          }
 205          super.onBackPressed();
 206      }
 207  
 208      @Override
 209  
 210      protected void onDestroy() {
 211          super.onDestroy();
 212          if (mHelper != null) {
 213              mHelper.onDestroy();
 214          }
 215  //        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);
 216      }
 217  }</pre></td>
                            <td><pre><span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   1 -package com.example.demo;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   2 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   3 -import android.databinding.DataBindingUtil;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   4 -import android.support.v7.app.AppCompatActivity;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   5 -import android.os.Bundle;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   6 -import android.support.v7.widget.LinearLayoutManager;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   7 -import android.support.v7.widget.SimpleItemAnimator;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   8 -import android.text.TextUtils;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">   9 -import android.util.Log;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  10 -import android.view.View;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  11 -import android.widget.Button;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  12 -import android.widget.Toast;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  13 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  14 -import com.effective.R;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  15 -import com.effective.android.panel.PanelSwitchHelper;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  16 -import com.effective.android.panel.interfaces.listener.OnEditFocusChangeListener;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  17 -import com.effective.android.panel.interfaces.listener.OnKeyboardStateListener;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  18 -import com.effective.android.panel.interfaces.listener.OnPanelChangeListener;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  19 -import com.effective.android.panel.interfaces.listener.OnViewClickListener;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  20 -import com.effective.android.panel.view.PanelView;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  21 -import com.effective.databinding.ActivityChatLayoutBinding;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  22 -import com.example.demo.chat.ChatAdapter;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  23 -import com.example.demo.chat.ChatInfo;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  24 -import com.example.demo.emotion.EmotionPagerView;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  25 -import com.example.demo.emotion.Emotions;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  26 -import com.rd.PageIndicatorView;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  27 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  28 -import java.util.ArrayList;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  29 -import java.util.List;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  30 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  31 -/**</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  32 - * Created by yummyLau on 18-7-11</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  33 - * Email: yummyl.lau@gmail.com</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  34 - * blog: yummylau.com</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  35 - */</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  36 -public class ChatSampleActivity extends AppCompatActivity {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  37 -    private ActivityChatLayoutBinding mBinding;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  38 -    private PanelSwitchHelper mHelper;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  39 -    private ChatAdapter mAdapter;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  40 -    private LinearLayoutManager mLinearLayoutManager;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  41 -    private Runnable mScrollToBottomRunnable;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  42 -    private static final String TAG = &quot;ChatSampleActivity&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  43 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  44 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  45 -    protected void onCreate(Bundle savedInstanceState) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  46 -        super.onCreate(savedInstanceState);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  47 -        mBinding = DataBindingUtil.setContentView(this, R.layout.activity_chat_layout);</span>




























<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  48 -        initView();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  49 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  50 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  51 -    private void initView() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  52 -        mLinearLayoutManager = new LinearLayoutManager(this);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  53 -        mBinding.recyclerView.setLayoutManager(mLinearLayoutManager);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  54 -        ((SimpleItemAnimator) mBinding.recyclerView.getItemAnimator()).setSupportsChangeAnimations(false);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  55 -        List&lt;ChatInfo&gt; chatInfos = new ArrayList&lt;&gt;();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  56 -        for(int i = 0; i &lt; 50; i++){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  57 -            chatInfos.add(ChatInfo.CREATE(&quot;模拟数据第&quot; + (i+1) + &quot;条&quot;));</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  58 -        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  59 -        mAdapter = new ChatAdapter(this,chatInfos);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  60 -        mBinding.recyclerView.setAdapter(mAdapter);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  61 -        mBinding.send.setOnClickListener(new View.OnClickListener() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  62 -            @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  63 -            public void onClick(View v) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  64 -                String content = mBinding.editText.getText().toString();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  65 -                if (TextUtils.isEmpty(content)) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  66 -                    Toast.makeText(ChatSampleActivity.this, &quot;当前没有输入&quot;, Toast.LENGTH_SHORT).show();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  67 -                    return;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  68 -                }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  69 -                mAdapter.insertInfo(ChatInfo.CREATE(content));</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  70 -                mBinding.editText.setText(null);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  71 -                scrollToBottom();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  72 -            }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  73 -        });</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  74 -        mScrollToBottomRunnable = new Runnable() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  75 -            @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  76 -            public void run() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  77 -                if (mAdapter.getItemCount() &gt; 0) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  78 -                    mLinearLayoutManager.scrollToPosition(mAdapter.getItemCount() - 1);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  79 -                }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  80 -            }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  81 -        };</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  82 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  83 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  84 -    private void scrollToBottom() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  85 -        mBinding.recyclerView.postDelayed(mScrollToBottomRunnable, 300);</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  86 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  87 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  88 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  89 -    protected void onStart() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  90 -        super.onStart();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  91 -        if (mHelper == null) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  92 -            mHelper = new PanelSwitchHelper.Builder(this)</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  93 -                    .bindPanelSwitchLayout(R.id.panel_switch_layout)</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  94 -                    .bindPanelContainerId(R.id.panel_container)</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  95 -                    .bindContentContainerId(R.id.content_view)</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  96 -                    //可选</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  97 -                    .addKeyboardStateListener(new OnKeyboardStateListener() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  98 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  99 -                        public void onKeyboardChange(boolean visible) {</span>



<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 100 -                            Log.d(TAG, &quot;系统键盘是否可见 : &quot; + visible);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 101 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 102 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 103 -                    })</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 104 -                    //可选</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 105 -                    .addEdittextFocesChangeListener(new OnEditFocusChangeListener() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 106 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 107 -                        public void onFocusChange(View view, boolean hasFocus) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 108 -                            Log.d(TAG, &quot;输入框是否获得焦点 : &quot; + hasFocus);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 109 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 110 -                    })</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 111 -                    //可选</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 112 -                    .addViewClickListener(new OnViewClickListener() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 113 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 114 -                        public void onViewClick(View view) {</span>



<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 115 -                            Log.d(TAG, &quot;点击了View : &quot; + view);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 116 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 117 -                    })</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 118 -                    //可选</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 119 -                    .addPanelChangeListener(new OnPanelChangeListener() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 120 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 121 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 122 -                        public void onKeyboard() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 123 -                            Log.d(TAG, &quot;唤起系统输入法&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 124 -                            scrollToBottom();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 125 -                            mBinding.emotionBtn.setSelected(false);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 126 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 127 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 128 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 129 -                        public void onNone() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 130 -                            Log.d(TAG, &quot;隐藏所有面板&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 131 -                            mBinding.emotionBtn.setSelected(false);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 132 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 133 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 134 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 135 -                        public void onPanel(PanelView view) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 136 -                            Log.d(TAG, &quot;唤起面板 : &quot; + view);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 137 -                            scrollToBottom();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 138 -                            mBinding.emotionBtn.setSelected(view.getId() == R.id.panel_emotion ? true : false);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 139 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 140 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 141 -                        @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 142 -                        public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int oldHeight, int width, int height) {"> 142 -                        public void onPanelSizeChange(PanelView panelView, boolean portrait, int oldWidth, int old🔵</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 143 -                            switch (panelView.getId()) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 144 -                                case R.id.panel_emotion: {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 145 -                                    EmotionPagerView pagerView = mBinding.getRoot().findViewById(R.id.view_pager);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 146 -                                    int viewPagerSize = height - Utils.dip2px(ChatSampleActivity.this, 30f);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 147 -                                    pagerView.buildEmotionViews(</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 148 -                                            (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicatorView),"> 148 -                                            (PageIndicatorView) mBinding.getRoot().findViewById(R.id.pageIndicator🔵</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 149 -                                            mBinding.editText,</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 150 -                                            Emotions.getEmotions(), width, viewPagerSize);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 151 -                                    break;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 152 -                                }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 153 -                                case R.id.panel_addition: {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 154 -                                    //auto center,nothing to do</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 155 -                                    break;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 156 -                                }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 157 -                            }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 158 -                        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 159 -                    })</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 160 -                    .logTrack(true)             //output log</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 161 -                    .build();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 162 -        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 163 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 164 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 165 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 166 -    public void onBackPressed() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 167 -        if (mHelper != null &amp;&amp; mHelper.hookSystemBackForHindPanel()) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 168 -            return;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 169 -        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 170 -        super.onBackPressed();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 171 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 172 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 173 -    @Override</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 174 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 175 -    protected void onDestroy() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 176 -        super.onDestroy();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 177 -        if (mHelper != null) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 178 -            mHelper.onDestroy();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 179 -        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 180 -//        mBinding.recyclerView.removeCallbacks(mScrollToBottomRunnable);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 181 -    }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 182 -}</span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            