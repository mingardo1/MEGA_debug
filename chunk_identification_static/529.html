<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>529</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    529
                    <a href="528.html">prev</a>
                    <a href="530.html">next</a>
                    <a href="529_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b44a86dc90b7fbefeec65e6c5a467a259b41ec59_core/src/main/java/com/dtstack/flink/sql/Main.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b44a86dc90b7fbefeec65e6c5a467a259b41ec59:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b44a86dc90b7fbefeec65e6c5a467a259b41ec59^1:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b44a86dc90b7fbefeec65e6c5a467a259b41ec59^2:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;1a973cf785a926fcd45c51fa474acc2ae880f8cb:core/src/main/java/com/dtstack/flink/sql/Main.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [j]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20 package com.dtstack.flink.sql;                                                                           </span>
<span  style="">  21                                                                                                          </span>
<span  style="">  22                                                                                                          </span>
<span  style="">  23                                                                                                          </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  24 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span  style="">  25                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="">  26 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="">  27 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  28 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  29 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  30                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  31 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  32 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-677897231887457024" onmouseenter="enter('-677897231887457024');" onmouseout="out('-677897231887457024');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import ch.qos.logback.classic.Level;                                                                     </span>
<span class="8893118690380910808" onmouseenter="enter('8893118690380910808');" onmouseout="out('8893118690380910808');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import ch.qos.logback.classic.LoggerContext;                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  35 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36                                                                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  37 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  38 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  39  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  40  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  41  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  42  */                                                                                                      </span>
<span  style="">  43                                                                                                          </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  44 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  45     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="">  46                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  47     public static void main(String[] args) throws Exception {                                            </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="">  48         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="2618130950050649008" onmouseenter="enter('2618130950050649008');" onmouseout="out('2618130950050649008');" style="">  49         ExecuteProcessHelper.setLogLevel(paramsInfo);                                                    </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="">  50         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="">  51         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="">  52         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  54 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20 package com.dtstack.flink.sql;                                                                           </span>
<span  style="">  21                                                                                                          </span>
<span  style="">  22                                                                                                          </span>
<span  style="">  23                                                                                                          </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  24 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span  style="">  25                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="">  26 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="">  27 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  28 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  29 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  30                                                                                                          </span>
<span  style="">  31                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  32 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  33  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  34  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  35  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  36  */                                                                                                      </span>
<span  style="">  37                                                                                                          </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  38 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  39     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="">  40                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  41     public static void main(String[] args) throws Exception {                                            </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="">  42         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  43 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="2618130950050649008" onmouseenter="enter('2618130950050649008');" onmouseout="out('2618130950050649008');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  44         ExecuteProcessHelper.setLogLevel(paramsInfo);                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  45 ||||||| BASE                                                                                             </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46         OptionParser optionParser = new OptionParser(args);                                              </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  47 =======                                                                                                  </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  48 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="">  49         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="">  50         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="">  51         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  52     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  18 package com.dtstack.flink.sql;                                                                           </span>
<span  style="">  19                                                                                                          </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="">  20 import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                  </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="">  21 import com.dtstack.flink.sql.exec.ParamsInfo;                                                            </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  22 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                            </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  23 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  24 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  25                                                                                                          </span>
<span  style="">  26                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  27 /**                                                                                                      </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  28  * Date: 2018/6/26                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  29  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  30  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  31  */                                                                                                      </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  32 public class Main {                                                                                      </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  33     private static final Logger LOG = LoggerFactory.getLogger(Main.class);                               </span>
<span  style="">  34                                                                                                          </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style="">  35     public static void main(String[] args) throws Exception {                                            </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="">  36         ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                  </span>
<span class="2618130950050649008" onmouseenter="enter('2618130950050649008');" onmouseout="out('2618130950050649008');" style="">  37         ExecuteProcessHelper.setLogLevel(paramsInfo);                                                    </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="">  38         StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);            </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="">  39         env.execute(paramsInfo.getName());                                                               </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="">  40         LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  41     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  42 }                                                                                                        </span>










</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20  package com.dtstack.flink.sql;                                                                                    </span>
<span  style="">  21                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                                      </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.dtstack.flink.sql.enums.ClusterMode;                                                                   </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                                </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                                  </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import com.dtstack.flink.sql.option.OptionParser;                                                                 </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import com.dtstack.flink.sql.parser.CreateFuncParser;                                                             </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import com.dtstack.flink.sql.parser.InsertSqlParser;                                                              </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import com.dtstack.flink.sql.parser.SqlParser;                                                                    </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import com.dtstack.flink.sql.parser.SqlTree;                                                                      </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import com.dtstack.flink.sql.side.SideSqlExec;                                                                    </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import com.dtstack.flink.sql.side.SideTableInfo;                                                                  </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import com.dtstack.flink.sql.table.SourceTableInfo;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import com.dtstack.flink.sql.table.TargetTableInfo;                                                               </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                              </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import com.dtstack.flink.sql.source.StreamSourceFactory;                                                          </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                                     </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -import com.dtstack.flink.sql.function.FunctionManager;                                                            </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import com.google.common.base.Strings;                                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import com.google.common.collect.Sets;                                                                            </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                           </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +import com.dtstack.flink.sql.exec.ParamsInfo;                                                                     </span>
<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  62  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -import org.apache.flink.table.api.TableEnvironment;                                                               </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -import org.apache.flink.table.sinks.TableSink;                                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -import org.apache.flink.types.Row;                                                                                </span>



<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  69  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  70  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -                                                                                                                  </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -import java.io.File;                                                                                              </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -import java.net.URL;                                                                                              </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -import java.net.URLClassLoader;                                                                                   </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -import java.net.URLDecoder;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -import java.util.Map;                                                                                             </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -import java.util.Properties;                                                                                      </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -import java.util.Set;                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -                                                                                                                  </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span  style="">  84                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  85  /**                                                                                                               </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  86   * Date: 2018/6/26                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  87   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  88   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  89   */                                                                                                               </span>
<span  style="">  90                                                                                                                    </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  91  public class Main {                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -                                                                                                                  </span>
<span class="4013471696637392789" onmouseenter="enter('4013471696637392789');" onmouseout="out('4013471696637392789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -    private static final String CLASS_FILE_NAME_FMT = &quot;class_path_%d&quot;;                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -                                                                                                                  </span>
<span class="-6402274289576443243" onmouseenter="enter('-6402274289576443243');" onmouseout="out('-6402274289576443243');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -    private static final ObjectMapper objMapper = new ObjectMapper();                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -                                                                                                                  </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  97      private static final Logger LOG = LoggerFactory.getLogger(Main.class);                                        </span>
<span  style="">  98                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -                                                                                                                  </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style=""> 100      public static void main(String[] args) throws Exception {                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -                                                                                                                  </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -        OptionParser optionParser = new OptionParser(args);                                                       </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        Options options = optionParser.getOptions();                                                              </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -        String sql = options.getSql();                                                                            </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -        String name = options.getName();                                                                          </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -        String addJarListStr = options.getAddjar();                                                               </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -        String localSqlPluginPath = options.getLocalSqlPluginPath();                                              </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -        String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                            </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -        String pluginLoadMode = options.getPluginLoadMode();                                                      </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -        String deployMode = options.getMode();                                                                    </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -        String confProp = options.getConfProp();                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                                                                                                                  </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -        sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                                      </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -        SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -                                                                                                                  </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -        List&lt;String&gt; addJarFileList = Lists.newArrayList();                                                       </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -        if (!Strings.isNullOrEmpty(addJarListStr)) {                                                              </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -            addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                              </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -            addJarFileList = objMapper.readValue(addJarListStr, List.class);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -                                                                                                                  </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -        confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -        StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                             </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -        StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);                       </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 126 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 126 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -                                                                                                                  </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -        List&lt;URL&gt; jarURList = Lists.newArrayList();                                                               </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -        SqlTree sqlTree = SqlParser.parseSql(sql);                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -                                                                                                                  </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -        //Get External jar to load                                                                                </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -        for (String addJarPath : addJarFileList) {                                                                </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -            File tmpFile = new File(addJarPath);                                                                  </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -            jarURList.add(tmpFile.toURI().toURL());                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -                                                                                                                  </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -        Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                              </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -        Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -                                                                                                                  </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -        //register udf                                                                                            </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                                </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        //register table schema                                                                                   </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 143 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 143 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pl🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -        // cache classPathSets                                                                                    </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        registerPluginUrlToCachedFile(env, classPathSets);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -                                                                                                                  </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 147 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 147 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig)🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                                                                                                                  </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -        if (env instanceof MyLocalStreamEnvironment) {                                                            </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -            ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -                                                                                                                  </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -        env.execute(name);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -                                                                                                                  </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 156 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 156 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,🔵</abbr></span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -        SideSqlExec sideSqlExec = new SideSqlExec();                                                              </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -        sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                                    </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -        for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                             </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 160 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 160 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -                                                                                                                  </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -        for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                                  </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -            if (LOG.isInfoEnabled()) {                                                                            </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -                LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -            }                                                                                                     </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -            boolean isSide = false;                                                                               </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -            for (String tableName : result.getTargetTableList()) {                                                </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -                if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                            </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                    CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);           </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -                    String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -                                                                                                                  </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 173 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 173 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_🔵</abbr></span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -                    String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                                 </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                    tmp.setExecSql(tmpSql);                                                                       </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 176 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 176 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tm🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -                } else {                                                                                          </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -                    for (String sourceTable : result.getSourceTableList()) {                                      </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -                        if (sideTableMap.containsKey(sourceTable)) {                                              </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                            isSide = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                            break;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                    }                                                                                             </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -                    if (isSide) {                                                                                 </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                        //sql-dimensional table contains the dimension table of execution                         </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 186 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 186 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryCon🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -                    }else{                                                                                        </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                        System.out.println(&quot;----------exec sql without dimension join-----------&quot; );              </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                        System.out.println(&quot;----------real sql exec is--------------------------&quot;);               </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                        System.out.println(result.getExecSql());                                                  </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                        FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);                       </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                        if(LOG.isInfoEnabled()){                                                                  </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                            System.out.println();                                                                 </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                            LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                                                                                                                  </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 205 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 205 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEn🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -            throws IllegalAccessException, InvocationTargetException {                                            </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -        // udf和tableEnv须由同一个类加载器加载                                                                                </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                                      </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        URLClassLoader classLoader = null;                                                                        </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -        List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                              </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -        for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                              </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -            //classloader                                                                                         </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            if (classLoader == null) {                                                                            </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -                classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -            }                                                                                                     </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 216 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 216 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv,🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -    /**                                                                                                           </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -     *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                             </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -     * @param sqlTree                                                                                             </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -     * @param env                                                                                                 </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -     * @param tableEnv                                                                                            </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -     * @param localSqlPluginPath                                                                                  </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -     * @param remoteSqlPluginPath                                                                                 </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -     * @param pluginLoadMode   插件加载模式 classpath or shipfile                                                       </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -     * @param sideTableMap                                                                                        </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -     * @param registerTableCache                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -     * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -     * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -     */                                                                                                           </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 233 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 233 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment 🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 234 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 234 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTable🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -        Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                                        </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                                      </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -        for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -                                                                                                                  </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -            if (tableInfo instanceof SourceTableInfo) {                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -                                                                                                                  </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -                SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                                    </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 242 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 242 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPa🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                                    </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 244 -                //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 244 -                //Note --- parameter conversion function can not be used inside a function of the type of polymeri🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -                //Create table in which the function is arranged only need adaptation sql                         </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                String adaptSql = sourceTableInfo.getAdaptSelectSql();                                            </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                                                                                                                  </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 249 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 249 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().g🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -                DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                           </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                        .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                               </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                        .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                                  </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                        .returns(typeInfo);                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                                                                                                                  </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                                                                                                                  </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                            </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                    adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);  </span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                    fields += &quot;,ROWTIME.ROWTIME&quot;;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                } else {                                                                                          </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                    fields += &quot;,PROCTIME.PROCTIME&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                                                                                                                  </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                Table regTable = tableEnv.fromDataStream(adaptStream, fields);                                    </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                tableEnv.registerTable(tableInfo.getName(), regTable);                                            </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                if (LOG.isInfoEnabled()) {                                                                        </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                    LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                }                                                                                                 </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                registerTableCache.put(tableInfo.getName(), regTable);                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                                                                                                                  </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 271 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 271 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTa🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -                pluginClassPatshSets.add(sourceTablePathUrl);                                                     </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -            } else if (tableInfo instanceof TargetTableInfo) {                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -                                                                                                                  </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 275 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 275 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPa🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -                TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());       </span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -                                                                                                                  </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 279 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 279 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTabl🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -                pluginClassPatshSets.add(sinkTablePathUrl);                                                       </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -            } else if (tableInfo instanceof SideTableInfo) {                                                      </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 282 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 282 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -                sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -                                                                                                                  </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 285 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 285 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideT🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -                pluginClassPatshSets.add(sideTablePathUrl);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -            } else {                                                                                              </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -                throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -        }                                                                                                         </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -        return pluginClassPatshSets;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -    /**                                                                                                           </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -     *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -     * @param env                                                                                                 </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -     * @param classPathSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -     */                                                                                                           </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -    private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -        int i = 0;                                                                                                </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -        for (URL url : classPathSet) {                                                                            </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -            String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                         </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -            env.registerCachedFile(url.getPath(), classFileName, true);                                           </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -            i++;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -                                                                                                                  </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 308 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 308 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 309 -        StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                           </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -                StreamExecutionEnvironment.getExecutionEnvironment() :                                            </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -                new MyLocalStreamEnvironment();                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -                                                                                                                  </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -        StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                             </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -        return env;                                                                                               </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +        ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                           </span>
<span class="2618130950050649008" onmouseenter="enter('2618130950050649008');" onmouseout="out('2618130950050649008');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +        ExecuteProcessHelper.setLogLevel(paramsInfo);                                                             </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +        StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);                     </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 318 +        env.execute(paramsInfo.getName());                                                                        </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +        LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="7759363024681379789" onmouseenter="enter('7759363024681379789');" onmouseout="out('7759363024681379789');" style="">  20  package com.dtstack.flink.sql;                                                                                    </span>
<span  style="">  21                                                                                                                    </span>
<span class="8446286977962994340" onmouseenter="enter('8446286977962994340');" onmouseout="out('8446286977962994340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.config.CalciteConfig;                                                                </span>
<span class="1128057574573805325" onmouseenter="enter('1128057574573805325');" onmouseout="out('1128057574573805325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import com.dtstack.flink.sql.classloader.ClassLoaderManager;                                                      </span>
<span class="4163183244871785745" onmouseenter="enter('4163183244871785745');" onmouseout="out('4163183244871785745');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import com.dtstack.flink.sql.enums.ClusterMode;                                                                   </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="1438060255500812936" onmouseenter="enter('1438060255500812936');" onmouseout="out('1438060255500812936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.dtstack.flink.sql.environment.MyLocalStreamEnvironment;                                                </span>
<span class="-3902160274831399645" onmouseenter="enter('-3902160274831399645');" onmouseout="out('-3902160274831399645');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.dtstack.flink.sql.environment.StreamEnvConfigManager;                                                  </span>
<span class="1760694872476698727" onmouseenter="enter('1760694872476698727');" onmouseout="out('1760694872476698727');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import com.dtstack.flink.sql.exec.FlinkSQLExec;                                                                   </span>
<span class="-5473850942909067315" onmouseenter="enter('-5473850942909067315');" onmouseout="out('-5473850942909067315');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import com.dtstack.flink.sql.option.OptionParser;                                                                 </span>
<span class="-8309589525137273991" onmouseenter="enter('-8309589525137273991');" onmouseout="out('-8309589525137273991');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import com.dtstack.flink.sql.parser.CreateFuncParser;                                                             </span>
<span class="2626775214998945029" onmouseenter="enter('2626775214998945029');" onmouseout="out('2626775214998945029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import com.dtstack.flink.sql.parser.CreateTmpTableParser;                                                         </span>
<span class="2951385827734987540" onmouseenter="enter('2951385827734987540');" onmouseout="out('2951385827734987540');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import com.dtstack.flink.sql.parser.InsertSqlParser;                                                              </span>
<span class="8647873327214903670" onmouseenter="enter('8647873327214903670');" onmouseout="out('8647873327214903670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import com.dtstack.flink.sql.parser.SqlParser;                                                                    </span>
<span class="-3945267747459470703" onmouseenter="enter('-3945267747459470703');" onmouseout="out('-3945267747459470703');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import com.dtstack.flink.sql.parser.SqlTree;                                                                      </span>
<span class="8240833495671695410" onmouseenter="enter('8240833495671695410');" onmouseout="out('8240833495671695410');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import com.dtstack.flink.sql.side.SideSqlExec;                                                                    </span>
<span class="-2209322898801219134" onmouseenter="enter('-2209322898801219134');" onmouseout="out('-2209322898801219134');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import com.dtstack.flink.sql.side.SideTableInfo;                                                                  </span>
<span class="-7495505695482075024" onmouseenter="enter('-7495505695482075024');" onmouseout="out('-7495505695482075024');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import com.dtstack.flink.sql.table.SourceTableInfo;                                                               </span>
<span class="3143679087399949060" onmouseenter="enter('3143679087399949060');" onmouseout="out('3143679087399949060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import com.dtstack.flink.sql.table.TableInfo;                                                                     </span>
<span class="804891499865800204" onmouseenter="enter('804891499865800204');" onmouseout="out('804891499865800204');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import com.dtstack.flink.sql.table.TargetTableInfo;                                                               </span>
<span class="-1587888422694040114" onmouseenter="enter('-1587888422694040114');" onmouseout="out('-1587888422694040114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import com.dtstack.flink.sql.sink.StreamSinkFactory;                                                              </span>
<span class="-1499575125936543551" onmouseenter="enter('-1499575125936543551');" onmouseout="out('-1499575125936543551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import com.dtstack.flink.sql.source.StreamSourceFactory;                                                          </span>
<span class="-898041479655512830" onmouseenter="enter('-898041479655512830');" onmouseout="out('-898041479655512830');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -import com.dtstack.flink.sql.util.DtStringUtil;                                                                   </span>
<span class="6664092504470635899" onmouseenter="enter('6664092504470635899');" onmouseout="out('6664092504470635899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import com.dtstack.flink.sql.watermarker.WaterMarkerAssigner;                                                     </span>
<span class="-233221942183158733" onmouseenter="enter('-233221942183158733');" onmouseout="out('-233221942183158733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -import com.dtstack.flink.sql.function.FunctionManager;                                                            </span>
<span class="-3389130316234486348" onmouseenter="enter('-3389130316234486348');" onmouseout="out('-3389130316234486348');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import com.dtstack.flink.sql.util.PluginUtil;                                                                     </span>
<span class="8181544981280840437" onmouseenter="enter('8181544981280840437');" onmouseout="out('8181544981280840437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import org.apache.calcite.sql.SqlInsert;                                                                          </span>
<span class="-3220645246316502826" onmouseenter="enter('-3220645246316502826');" onmouseout="out('-3220645246316502826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.apache.calcite.sql.SqlNode;                                                                            </span>
<span class="-8922236357512993475" onmouseenter="enter('-8922236357512993475');" onmouseout="out('-8922236357512993475');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.commons.io.Charsets;                                                                            </span>
<span class="-4869246525166490693" onmouseenter="enter('-4869246525166490693');" onmouseout="out('-4869246525166490693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.apache.flink.api.common.typeinfo.TypeInformation;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="3771627087048804240" onmouseenter="enter('3771627087048804240');" onmouseout="out('3771627087048804240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import com.google.common.base.Strings;                                                                            </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import com.google.common.collect.Maps;                                                                            </span>
<span class="6390139568718476113" onmouseenter="enter('6390139568718476113');" onmouseout="out('6390139568718476113');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import com.google.common.collect.Sets;                                                                            </span>
<span class="3949390651369204057" onmouseenter="enter('3949390651369204057');" onmouseout="out('3949390651369204057');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import com.fasterxml.jackson.databind.ObjectMapper;                                                               </span>
<span class="329774846923224587" onmouseenter="enter('329774846923224587');" onmouseout="out('329774846923224587');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -import org.apache.flink.streaming.api.datastream.DataStream;                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>


<span class="-4319578285254651574" onmouseenter="enter('-4319578285254651574');" onmouseout="out('-4319578285254651574');" style="">  60  import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;                                     </span>
<span class="2542322018203740202" onmouseenter="enter('2542322018203740202');" onmouseout="out('2542322018203740202');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -import org.apache.flink.table.api.StreamQueryConfig;                                                              </span>
<span class="5165777186879784670" onmouseenter="enter('5165777186879784670');" onmouseout="out('5165777186879784670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -import org.apache.flink.table.api.Table;                                                                          </span>
<span class="-407377575764211897" onmouseenter="enter('-407377575764211897');" onmouseout="out('-407377575764211897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -import org.apache.flink.table.api.TableEnvironment;                                                               </span>
<span class="776922417053783834" onmouseenter="enter('776922417053783834');" onmouseout="out('776922417053783834');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -import org.apache.flink.table.api.java.StreamTableEnvironment;                                                    </span>
<span class="7995014572968631933" onmouseenter="enter('7995014572968631933');" onmouseout="out('7995014572968631933');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -import org.apache.flink.table.sinks.TableSink;                                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -import org.apache.flink.types.Row;                                                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                                                                                                                  </span>
<span class="-8305761961303377434" onmouseenter="enter('-8305761961303377434');" onmouseout="out('-8305761961303377434');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +import com.dtstack.flink.sql.exec.ExecuteProcessHelper;                                                           </span>
<span class="2027575266733140430" onmouseenter="enter('2027575266733140430');" onmouseout="out('2027575266733140430');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +import com.dtstack.flink.sql.exec.ParamsInfo;                                                                     </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  70  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  71  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  72                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -import java.io.File;                                                                                              </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="-5598187278321027129" onmouseenter="enter('-5598187278321027129');" onmouseout="out('-5598187278321027129');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -import java.net.URL;                                                                                              </span>
<span class="-6112012094564139136" onmouseenter="enter('-6112012094564139136');" onmouseout="out('-6112012094564139136');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -import java.net.URLClassLoader;                                                                                   </span>
<span class="600097467176667378" onmouseenter="enter('600097467176667378');" onmouseout="out('600097467176667378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -import java.net.URLDecoder;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -import java.util.Map;                                                                                             </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -import java.util.Optional;                                                                                        </span>
<span class="1689171550873420012" onmouseenter="enter('1689171550873420012');" onmouseout="out('1689171550873420012');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -import java.util.Properties;                                                                                      </span>
<span class="3384353015976675773" onmouseenter="enter('3384353015976675773');" onmouseout="out('3384353015976675773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -import java.util.Set;                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -                                                                                                                  </span>
<span class="6579778626253321963" onmouseenter="enter('6579778626253321963');" onmouseout="out('6579778626253321963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -import com.dtstack.flink.sql.option.Options;                                                                      </span>
<span  style="">  85                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  86  /**                                                                                                               </span>
<span class="7455087124226002233" onmouseenter="enter('7455087124226002233');" onmouseout="out('7455087124226002233');" style="">  87   * Date: 2018/6/26                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  88   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  89   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  90   */                                                                                                               </span>
<span  style="">  91                                                                                                                    </span>
<span class="4158500374387660771" onmouseenter="enter('4158500374387660771');" onmouseout="out('4158500374387660771');" style="">  92  public class Main {                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -                                                                                                                  </span>
<span class="4013471696637392789" onmouseenter="enter('4013471696637392789');" onmouseout="out('4013471696637392789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -    private static final String CLASS_FILE_NAME_FMT = &quot;class_path_%d&quot;;                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -                                                                                                                  </span>
<span class="-6402274289576443243" onmouseenter="enter('-6402274289576443243');" onmouseout="out('-6402274289576443243');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -    private static final ObjectMapper objMapper = new ObjectMapper();                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -                                                                                                                  </span>
<span class="-2467580611644542408" onmouseenter="enter('-2467580611644542408');" onmouseout="out('-2467580611644542408');" style="">  98      private static final Logger LOG = LoggerFactory.getLogger(Main.class);                                        </span>
<span  style="">  99                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -                                                                                                                  </span>
<span class="-6635823284124413023" onmouseenter="enter('-6635823284124413023');" onmouseout="out('-6635823284124413023');" style=""> 101      public static void main(String[] args) throws Exception {                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -                                                                                                                  </span>
<span class="-4583907916056449781" onmouseenter="enter('-4583907916056449781');" onmouseout="out('-4583907916056449781');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -        OptionParser optionParser = new OptionParser(args);                                                       </span>
<span class="4734062317282943757" onmouseenter="enter('4734062317282943757');" onmouseout="out('4734062317282943757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -        Options options = optionParser.getOptions();                                                              </span>
<span class="3834595659137807361" onmouseenter="enter('3834595659137807361');" onmouseout="out('3834595659137807361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -        String sql = options.getSql();                                                                            </span>
<span class="3447782210993319010" onmouseenter="enter('3447782210993319010');" onmouseout="out('3447782210993319010');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -        String name = options.getName();                                                                          </span>
<span class="-8831537203919482565" onmouseenter="enter('-8831537203919482565');" onmouseout="out('-8831537203919482565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -        String addJarListStr = options.getAddjar();                                                               </span>
<span class="-1800067863548230531" onmouseenter="enter('-1800067863548230531');" onmouseout="out('-1800067863548230531');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -        String localSqlPluginPath = options.getLocalSqlPluginPath();                                              </span>
<span class="-6993882357843514233" onmouseenter="enter('-6993882357843514233');" onmouseout="out('-6993882357843514233');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -        String remoteSqlPluginPath = options.getRemoteSqlPluginPath();                                            </span>
<span class="-6003393921520410412" onmouseenter="enter('-6003393921520410412');" onmouseout="out('-6003393921520410412');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -        String pluginLoadMode = options.getPluginLoadMode();                                                      </span>
<span class="90681868113996668" onmouseenter="enter('90681868113996668');" onmouseout="out('90681868113996668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -        String deployMode = options.getMode();                                                                    </span>
<span class="-7630355764004790242" onmouseenter="enter('-7630355764004790242');" onmouseout="out('-7630355764004790242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -        String confProp = options.getConfProp();                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                                                                                                                  </span>
<span class="8768543046549051841" onmouseenter="enter('8768543046549051841');" onmouseout="out('8768543046549051841');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -        sql = URLDecoder.decode(sql, Charsets.UTF_8.name());                                                      </span>
<span class="8767767586763974793" onmouseenter="enter('8767767586763974793');" onmouseout="out('8767767586763974793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -        SqlParser.setLocalSqlPluginRoot(localSqlPluginPath);                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                                                                                                                  </span>
<span class="-8536279461651950156" onmouseenter="enter('-8536279461651950156');" onmouseout="out('-8536279461651950156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -        List&lt;String&gt; addJarFileList = Lists.newArrayList();                                                       </span>
<span class="-923423934246270931" onmouseenter="enter('-923423934246270931');" onmouseout="out('-923423934246270931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -        if (!Strings.isNullOrEmpty(addJarListStr)) {                                                              </span>
<span class="5424816432284810226" onmouseenter="enter('5424816432284810226');" onmouseout="out('5424816432284810226');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -            addJarListStr = URLDecoder.decode(addJarListStr, Charsets.UTF_8.name());                              </span>
<span class="3906992543551848074" onmouseenter="enter('3906992543551848074');" onmouseout="out('3906992543551848074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -            addJarFileList = objMapper.readValue(addJarListStr, List.class);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                                                                                                                  </span>
<span class="1840415327199112617" onmouseenter="enter('1840415327199112617');" onmouseout="out('1840415327199112617');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        confProp = URLDecoder.decode(confProp, Charsets.UTF_8.toString());                                        </span>
<span class="1987492669588880466" onmouseenter="enter('1987492669588880466');" onmouseout="out('1987492669588880466');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -        Properties confProperties = PluginUtil.jsonStrToObject(confProp, Properties.class);                       </span>
<span class="-6285842145903012002" onmouseenter="enter('-6285842145903012002');" onmouseout="out('-6285842145903012002');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -        StreamExecutionEnvironment env = getStreamExeEnv(confProperties, deployMode);                             </span>
<span class="8225060224522769561" onmouseenter="enter('8225060224522769561');" onmouseout="out('8225060224522769561');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -        StreamTableEnvironment tableEnv =  StreamTableEnvironment.getTableEnvironment(env);                       </span>
<span class="7297741648260625758" onmouseenter="enter('7297741648260625758');" onmouseout="out('7297741648260625758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 127 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties);"> 127 -        StreamQueryConfig streamQueryConfig = StreamEnvConfigManager.getStreamQueryConfig(tableEnv, confProperties🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -                                                                                                                  </span>
<span class="-2693692839153497103" onmouseenter="enter('-2693692839153497103');" onmouseout="out('-2693692839153497103');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -        List&lt;URL&gt; jarURList = Lists.newArrayList();                                                               </span>
<span class="-7813427990429367813" onmouseenter="enter('-7813427990429367813');" onmouseout="out('-7813427990429367813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -        SqlTree sqlTree = SqlParser.parseSql(sql);                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span class="8874499013240861988" onmouseenter="enter('8874499013240861988');" onmouseout="out('8874499013240861988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -        //Get External jar to load                                                                                </span>
<span class="4042749496623994357" onmouseenter="enter('4042749496623994357');" onmouseout="out('4042749496623994357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -        for (String addJarPath : addJarFileList) {                                                                </span>
<span class="-4531519554172964398" onmouseenter="enter('-4531519554172964398');" onmouseout="out('-4531519554172964398');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -            File tmpFile = new File(addJarPath);                                                                  </span>
<span class="5228651187688047903" onmouseenter="enter('5228651187688047903');" onmouseout="out('5228651187688047903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -            jarURList.add(tmpFile.toURI().toURL());                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -                                                                                                                  </span>
<span class="-522088873421236242" onmouseenter="enter('-522088873421236242');" onmouseout="out('-522088873421236242');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -        Map&lt;String, SideTableInfo&gt; sideTableMap = Maps.newHashMap();                                              </span>
<span class="2924797397357570074" onmouseenter="enter('2924797397357570074');" onmouseout="out('2924797397357570074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -        Map&lt;String, Table&gt; registerTableCache = Maps.newHashMap();                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -                                                                                                                  </span>
<span class="-1839946490595052018" onmouseenter="enter('-1839946490595052018');" onmouseout="out('-1839946490595052018');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        //register udf                                                                                            </span>
<span class="-3089851965546090329" onmouseenter="enter('-3089851965546090329');" onmouseout="out('-3089851965546090329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        registerUserDefinedFunction(sqlTree, jarURList, tableEnv);                                                </span>
<span class="-6695018540673627550" onmouseenter="enter('-6695018540673627550');" onmouseout="out('-6695018540673627550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -        //register table schema                                                                                   </span>
<span class="7344639651377231681" onmouseenter="enter('7344639651377231681');" onmouseout="out('7344639651377231681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 144 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode, sideTableMap, registerTableCache);"> 144 -        Set&lt;URL&gt; classPathSets = registerTable(sqlTree, env, tableEnv, localSqlPluginPath, remoteSqlPluginPath, pl🔵</abbr></span>
<span class="-3012532250450661615" onmouseenter="enter('-3012532250450661615');" onmouseout="out('-3012532250450661615');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -        // cache classPathSets                                                                                    </span>
<span class="7284494580965265816" onmouseenter="enter('7284494580965265816');" onmouseout="out('7284494580965265816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -        registerPluginUrlToCachedFile(env, classPathSets);                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                                                                                                                  </span>
<span class="-2271481837519934192" onmouseenter="enter('-2271481837519934192');" onmouseout="out('-2271481837519934192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 148 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig);"> 148 -        sqlTranslation(localSqlPluginPath, tableEnv, sqlTree, sideTableMap, registerTableCache, streamQueryConfig)🔵</abbr></span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                                                                                                                  </span>
<span class="-4657849708380078805" onmouseenter="enter('-4657849708380078805');" onmouseout="out('-4657849708380078805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -        if (env instanceof MyLocalStreamEnvironment) {                                                            </span>
<span class="7562977222232370608" onmouseenter="enter('7562977222232370608');" onmouseout="out('7562977222232370608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -            ((MyLocalStreamEnvironment) env).setClasspaths(ClassLoaderManager.getClassPath());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -                                                                                                                  </span>
<span class="-9210927412463388031" onmouseenter="enter('-9210927412463388031');" onmouseout="out('-9210927412463388031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -        env.execute(name);                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -                                                                                                                  </span>
<span class="4181823391822155364" onmouseenter="enter('4181823391822155364');" onmouseout="out('4181823391822155364');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 157 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,Map&lt;String, SideTableInfo&gt; sideTableMap,Map&lt;String, Table&gt; registerTableCache, StreamQueryConfig queryConfig) throws Exception {"> 157 -    private static void sqlTranslation(String localSqlPluginPath, StreamTableEnvironment tableEnv,SqlTree sqlTree,🔵</abbr></span>
<span class="-493181818183802121" onmouseenter="enter('-493181818183802121');" onmouseout="out('-493181818183802121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -        SideSqlExec sideSqlExec = new SideSqlExec();                                                              </span>
<span class="-1161313222226855821" onmouseenter="enter('-1161313222226855821');" onmouseout="out('-1161313222226855821');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -        sideSqlExec.setLocalSqlPluginPath(localSqlPluginPath);                                                    </span>
<span class="5401592595431358047" onmouseenter="enter('5401592595431358047');" onmouseout="out('5401592595431358047');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -        for (CreateTmpTableParser.SqlParserResult result : sqlTree.getTmpSqlList()) {                             </span>
<span class="8942292220656234549" onmouseenter="enter('8942292220656234549');" onmouseout="out('8942292220656234549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 161 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result);"> 161 -            sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, result)🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -                                                                                                                  </span>
<span class="-6169236231683373429" onmouseenter="enter('-6169236231683373429');" onmouseout="out('-6169236231683373429');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -        for (InsertSqlParser.SqlParseResult result : sqlTree.getExecSqlList()) {                                  </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -            if (LOG.isInfoEnabled()) {                                                                            </span>
<span class="7241590960443234013" onmouseenter="enter('7241590960443234013');" onmouseout="out('7241590960443234013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -                LOG.info(&quot;exe-sql:\n&quot; + result.getExecSql());                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -            }                                                                                                     </span>
<span class="3226790498300399028" onmouseenter="enter('3226790498300399028');" onmouseout="out('3226790498300399028');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -            boolean isSide = false;                                                                               </span>
<span class="4657675195764395730" onmouseenter="enter('4657675195764395730');" onmouseout="out('4657675195764395730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -            for (String tableName : result.getTargetTableList()) {                                                </span>
<span class="7646056053635250390" onmouseenter="enter('7646056053635250390');" onmouseout="out('7646056053635250390');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                if (sqlTree.getTmpTableMap().containsKey(tableName)) {                                            </span>
<span class="-5171141608467193381" onmouseenter="enter('-5171141608467193381');" onmouseout="out('-5171141608467193381');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -                    CreateTmpTableParser.SqlParserResult tmp = sqlTree.getTmpTableMap().get(tableName);           </span>
<span class="-7420739020114168608" onmouseenter="enter('-7420739020114168608');" onmouseout="out('-7420739020114168608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -                    String realSql = DtStringUtil.replaceIgnoreQuota(result.getExecSql(), &quot;`&quot;, &quot;&quot;);               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -                                                                                                                  </span>
<span class="-4805015649665423870" onmouseenter="enter('-4805015649665423870');" onmouseout="out('-4805015649665423870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 174 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_LEX_CONFIG).parseStmt();"> 174 -                    SqlNode sqlNode = org.apache.calcite.sql.parser.SqlParser.create(realSql, CalciteConfig.MYSQL_🔵</abbr></span>
<span class="-8615664221266627523" onmouseenter="enter('-8615664221266627523');" onmouseout="out('-8615664221266627523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                    String tmpSql = ((SqlInsert) sqlNode).getSource().toString();                                 </span>
<span class="-6187211553672607517" onmouseenter="enter('-6187211553672607517');" onmouseout="out('-6187211553672607517');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                    tmp.setExecSql(tmpSql);                                                                       </span>
<span class="-19674124105840883" onmouseenter="enter('-19674124105840883');" onmouseout="out('-19674124105840883');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 177 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tmp);"> 177 -                    sideSqlExec.exec(tmp.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, tm🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -                } else {                                                                                          </span>
<span class="-6005419028870483738" onmouseenter="enter('-6005419028870483738');" onmouseout="out('-6005419028870483738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -                    for (String sourceTable : result.getSourceTableList()) {                                      </span>
<span class="-6154045262843628357" onmouseenter="enter('-6154045262843628357');" onmouseout="out('-6154045262843628357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                        if (sideTableMap.containsKey(sourceTable)) {                                              </span>
<span class="4337283437684062020" onmouseenter="enter('4337283437684062020');" onmouseout="out('4337283437684062020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                            isSide = true;                                                                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                            break;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -                    }                                                                                             </span>
<span class="8307396983010946014" onmouseenter="enter('8307396983010946014');" onmouseout="out('8307396983010946014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                    if (isSide) {                                                                                 </span>
<span class="-7925039559974986499" onmouseenter="enter('-7925039559974986499');" onmouseout="out('-7925039559974986499');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -                        //sql-dimensional table contains the dimension table of execution                         </span>
<span class="7257649570557913899" onmouseenter="enter('7257649570557913899');" onmouseout="out('7257649570557913899');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 187 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryConfig, null);"> 187 -                        sideSqlExec.exec(result.getExecSql(), sideTableMap, tableEnv, registerTableCache, queryCon🔵</abbr></span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                    }else{                                                                                        </span>
<span class="-1557895700891754813" onmouseenter="enter('-1557895700891754813');" onmouseout="out('-1557895700891754813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                        System.out.println(&quot;----------exec sql without dimension join-----------&quot; );              </span>
<span class="8332808483394117174" onmouseenter="enter('8332808483394117174');" onmouseout="out('8332808483394117174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                        System.out.println(&quot;----------real sql exec is--------------------------&quot;);               </span>
<span class="-1116229068168768282" onmouseenter="enter('-1116229068168768282');" onmouseout="out('-1116229068168768282');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                        System.out.println(result.getExecSql());                                                  </span>
<span class="-5438250681035438197" onmouseenter="enter('-5438250681035438197');" onmouseout="out('-5438250681035438197');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                        FlinkSQLExec.sqlUpdate(tableEnv, result.getExecSql(), queryConfig);                       </span>
<span class="3766255850891299565" onmouseenter="enter('3766255850891299565');" onmouseout="out('3766255850891299565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                        if(LOG.isInfoEnabled()){                                                                  </span>
<span class="1260742139592118074" onmouseenter="enter('1260742139592118074');" onmouseout="out('1260742139592118074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                            System.out.println();                                                                 </span>
<span class="-6471072911421960558" onmouseenter="enter('-6471072911421960558');" onmouseout="out('-6471072911421960558');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                            LOG.info(&quot;exec sql: &quot; + result.getExecSql());                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -                        }                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                                                                                                                  </span>
<span class="-472965840790801911" onmouseenter="enter('-472965840790801911');" onmouseout="out('-472965840790801911');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 206 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEnv)"> 206 -    private static void registerUserDefinedFunction(SqlTree sqlTree, List&lt;URL&gt; jarURList, TableEnvironment tableEn🔵</abbr></span>
<span class="-3092192583729041183" onmouseenter="enter('-3092192583729041183');" onmouseout="out('-3092192583729041183');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -            throws IllegalAccessException, InvocationTargetException {                                            </span>
<span class="749373158852705462" onmouseenter="enter('749373158852705462');" onmouseout="out('749373158852705462');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        // udf和tableEnv须由同一个类加载器加载                                                                                </span>
<span class="-7873999373730232104" onmouseenter="enter('-7873999373730232104');" onmouseout="out('-7873999373730232104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        ClassLoader levelClassLoader = tableEnv.getClass().getClassLoader();                                      </span>
<span class="-4511148211438155967" onmouseenter="enter('-4511148211438155967');" onmouseout="out('-4511148211438155967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -        URLClassLoader classLoader = null;                                                                        </span>
<span class="-6582280860739568116" onmouseenter="enter('-6582280860739568116');" onmouseout="out('-6582280860739568116');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -        List&lt;CreateFuncParser.SqlParserResult&gt; funcList = sqlTree.getFunctionList();                              </span>
<span class="-878759903863318704" onmouseenter="enter('-878759903863318704');" onmouseout="out('-878759903863318704');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -        for (CreateFuncParser.SqlParserResult funcInfo : funcList) {                                              </span>
<span class="-2750226098965214297" onmouseenter="enter('-2750226098965214297');" onmouseout="out('-2750226098965214297');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            //classloader                                                                                         </span>
<span class="4515580182308243325" onmouseenter="enter('4515580182308243325');" onmouseout="out('4515580182308243325');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -            if (classLoader == null) {                                                                            </span>
<span class="-5560983435894982595" onmouseenter="enter('-5560983435894982595');" onmouseout="out('-5560983435894982595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -                classLoader = ClassLoaderManager.loadExtraJar(jarURList, (URLClassLoader) levelClassLoader);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -            }                                                                                                     </span>
<span class="959907224803763702" onmouseenter="enter('959907224803763702');" onmouseout="out('959907224803763702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 217 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv, classLoader);"> 217 -            FunctionManager.registerUDF(funcInfo.getType(), funcInfo.getClassName(), funcInfo.getName(), tableEnv,🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -    /**                                                                                                           </span>
<span class="-3960084685841095206" onmouseenter="enter('-3960084685841095206');" onmouseout="out('-3960084685841095206');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -     *    向Flink注册源表和结果表，返回执行时插件包的全路径                                                                             </span>
<span class="-8671526162415345681" onmouseenter="enter('-8671526162415345681');" onmouseout="out('-8671526162415345681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -     * @param sqlTree                                                                                             </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -     * @param env                                                                                                 </span>
<span class="2261397128482660029" onmouseenter="enter('2261397128482660029');" onmouseout="out('2261397128482660029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -     * @param tableEnv                                                                                            </span>
<span class="-5874855186200887945" onmouseenter="enter('-5874855186200887945');" onmouseout="out('-5874855186200887945');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -     * @param localSqlPluginPath                                                                                  </span>
<span class="-6162544468780805373" onmouseenter="enter('-6162544468780805373');" onmouseout="out('-6162544468780805373');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -     * @param remoteSqlPluginPath                                                                                 </span>
<span class="-7363187077207283209" onmouseenter="enter('-7363187077207283209');" onmouseout="out('-7363187077207283209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -     * @param pluginLoadMode   插件加载模式 classpath or shipfile                                                       </span>
<span class="6140023291075516614" onmouseenter="enter('6140023291075516614');" onmouseout="out('6140023291075516614');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -     * @param sideTableMap                                                                                        </span>
<span class="-2298662540589975209" onmouseenter="enter('-2298662540589975209');" onmouseout="out('-2298662540589975209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -     * @param registerTableCache                                                                                  </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -     * @return                                                                                                    </span>
<span class="3682579759887248937" onmouseenter="enter('3682579759887248937');" onmouseout="out('3682579759887248937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -     * @throws Exception                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -     */                                                                                                           </span>
<span class="3029553402459805114" onmouseenter="enter('3029553402459805114');" onmouseout="out('3029553402459805114');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 234 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment tableEnv, String localSqlPluginPath,"> 234 -    private static Set&lt;URL&gt; registerTable(SqlTree sqlTree, StreamExecutionEnvironment env, StreamTableEnvironment 🔵</abbr></span>
<span class="7807687711323233425" onmouseenter="enter('7807687711323233425');" onmouseout="out('7807687711323233425');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 235 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTableInfo&gt; sideTableMap, Map&lt;String, Table&gt; registerTableCache) throws Exception {"> 235 -                                          String remoteSqlPluginPath, String pluginLoadMode, Map&lt;String, SideTable🔵</abbr></span>
<span class="5557928295934727054" onmouseenter="enter('5557928295934727054');" onmouseout="out('5557928295934727054');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        Set&lt;URL&gt; pluginClassPatshSets = Sets.newHashSet();                                                        </span>
<span class="3273624565969479174" onmouseenter="enter('3273624565969479174');" onmouseout="out('3273624565969479174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -        WaterMarkerAssigner waterMarkerAssigner = new WaterMarkerAssigner();                                      </span>
<span class="2687785203032847628" onmouseenter="enter('2687785203032847628');" onmouseout="out('2687785203032847628');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -        for (TableInfo tableInfo : sqlTree.getTableInfoMap().values()) {                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -                                                                                                                  </span>
<span class="-1523239613858308229" onmouseenter="enter('-1523239613858308229');" onmouseout="out('-1523239613858308229');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -            if (tableInfo instanceof SourceTableInfo) {                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -                                                                                                                  </span>
<span class="3917331973310194630" onmouseenter="enter('3917331973310194630');" onmouseout="out('3917331973310194630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -                SourceTableInfo sourceTableInfo = (SourceTableInfo) tableInfo;                                    </span>
<span class="9062891254070220151" onmouseenter="enter('9062891254070220151');" onmouseout="out('9062891254070220151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 243 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPath);"> 243 -                Table table = StreamSourceFactory.getStreamSource(sourceTableInfo, env, tableEnv, localSqlPluginPa🔵</abbr></span>
<span class="2742632354413993138" onmouseenter="enter('2742632354413993138');" onmouseout="out('2742632354413993138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -                tableEnv.registerTable(sourceTableInfo.getAdaptName(), table);                                    </span>
<span class="5836085710612144658" onmouseenter="enter('5836085710612144658');" onmouseout="out('5836085710612144658');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 245 -                //Note --- parameter conversion function can not be used inside a function of the type of polymerization"> 245 -                //Note --- parameter conversion function can not be used inside a function of the type of polymeri🔵</abbr></span>
<span class="7857937664799454058" onmouseenter="enter('7857937664799454058');" onmouseout="out('7857937664799454058');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                //Create table in which the function is arranged only need adaptation sql                         </span>
<span class="-9103490002171600443" onmouseenter="enter('-9103490002171600443');" onmouseout="out('-9103490002171600443');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                String adaptSql = sourceTableInfo.getAdaptSelectSql();                                            </span>
<span class="5588260795210533927" onmouseenter="enter('5588260795210533927');" onmouseout="out('5588260795210533927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                Table adaptTable = adaptSql == null ? table : tableEnv.sqlQuery(adaptSql);                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -                                                                                                                  </span>
<span class="8476150652683782221" onmouseenter="enter('8476150652683782221');" onmouseout="out('8476150652683782221');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 250 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().getColumnNames());"> 250 -                RowTypeInfo typeInfo = new RowTypeInfo(adaptTable.getSchema().getTypes(), adaptTable.getSchema().g🔵</abbr></span>
<span class="-5494252918916011329" onmouseenter="enter('-5494252918916011329');" onmouseout="out('-5494252918916011329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                DataStream adaptStream = tableEnv.toRetractStream(adaptTable, typeInfo)                           </span>
<span class="2316883523846454565" onmouseenter="enter('2316883523846454565');" onmouseout="out('2316883523846454565');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                        .filter((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f0)                                               </span>
<span class="-563920179310488747" onmouseenter="enter('-563920179310488747');" onmouseout="out('-563920179310488747');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                        .map((Tuple2&lt;Boolean, Row&gt; f0) -&gt; f0.f1)                                                  </span>
<span class="3304120945797123738" onmouseenter="enter('3304120945797123738');" onmouseout="out('3304120945797123738');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                        .returns(typeInfo);                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                                                                                                                  </span>
<span class="-9110245998048784135" onmouseenter="enter('-9110245998048784135');" onmouseout="out('-9110245998048784135');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                String fields = String.join(&quot;,&quot;, typeInfo.getFieldNames());                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                                                                                                                  </span>
<span class="824143089692886283" onmouseenter="enter('824143089692886283');" onmouseout="out('824143089692886283');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                if (waterMarkerAssigner.checkNeedAssignWaterMarker(sourceTableInfo)) {                            </span>
<span class="-6957908163973658426" onmouseenter="enter('-6957908163973658426');" onmouseout="out('-6957908163973658426');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                    adaptStream = waterMarkerAssigner.assignWaterMarker(adaptStream, typeInfo, sourceTableInfo);  </span>
<span class="8885358670253134776" onmouseenter="enter('8885358670253134776');" onmouseout="out('8885358670253134776');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                    fields += &quot;,ROWTIME.ROWTIME&quot;;                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                } else {                                                                                          </span>
<span class="-5047078117098742378" onmouseenter="enter('-5047078117098742378');" onmouseout="out('-5047078117098742378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                    fields += &quot;,PROCTIME.PROCTIME&quot;;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                }                                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                                                                                                                  </span>
<span class="-9060550943328563238" onmouseenter="enter('-9060550943328563238');" onmouseout="out('-9060550943328563238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                Table regTable = tableEnv.fromDataStream(adaptStream, fields);                                    </span>
<span class="-8061964277421812188" onmouseenter="enter('-8061964277421812188');" onmouseout="out('-8061964277421812188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                tableEnv.registerTable(tableInfo.getName(), regTable);                                            </span>
<span class="-4873093459421651994" onmouseenter="enter('-4873093459421651994');" onmouseout="out('-4873093459421651994');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                if (LOG.isInfoEnabled()) {                                                                        </span>
<span class="409563971760741758" onmouseenter="enter('409563971760741758');" onmouseout="out('409563971760741758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                    LOG.info(&quot;registe table {} success.&quot;, tableInfo.getName());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                }                                                                                                 </span>
<span class="6421012289875834266" onmouseenter="enter('6421012289875834266');" onmouseout="out('6421012289875834266');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                registerTableCache.put(tableInfo.getName(), regTable);                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                                                                                                                  </span>
<span class="6759077726569076437" onmouseenter="enter('6759077726569076437');" onmouseout="out('6759077726569076437');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 272 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTableInfo.SOURCE_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 272 -                URL sourceTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), SourceTa🔵</abbr></span>
<span class="-3462602891167887866" onmouseenter="enter('-3462602891167887866');" onmouseout="out('-3462602891167887866');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                pluginClassPatshSets.add(sourceTablePathUrl);                                                     </span>
<span class="5667398974163599096" onmouseenter="enter('5667398974163599096');" onmouseout="out('5667398974163599096');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -            } else if (tableInfo instanceof TargetTableInfo) {                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -                                                                                                                  </span>
<span class="5613280970387480850" onmouseenter="enter('5613280970387480850');" onmouseout="out('5613280970387480850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 276 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPath);"> 276 -                TableSink tableSink = StreamSinkFactory.getTableSink((TargetTableInfo) tableInfo, localSqlPluginPa🔵</abbr></span>
<span class="-2768793488765230192" onmouseenter="enter('-2768793488765230192');" onmouseout="out('-2768793488765230192');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                TypeInformation[] flinkTypes = FunctionManager.transformTypes(tableInfo.getFieldClasses());       </span>
<span class="-545405053132727041" onmouseenter="enter('-545405053132727041');" onmouseout="out('-545405053132727041');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -                tableEnv.registerTableSink(tableInfo.getName(), tableInfo.getFields(), flinkTypes, tableSink);    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                                                                                                                  </span>
<span class="7857811188326413020" onmouseenter="enter('7857811188326413020');" onmouseout="out('7857811188326413020');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 280 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 280 -                URL sinkTablePathUrl = PluginUtil.buildSourceAndSinkPathByLoadMode(tableInfo.getType(), TargetTabl🔵</abbr></span>
<span class="4327446521637519032" onmouseenter="enter('4327446521637519032');" onmouseout="out('4327446521637519032');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -                pluginClassPatshSets.add(sinkTablePathUrl);                                                       </span>
<span class="-3843880020425893891" onmouseenter="enter('-3843880020425893891');" onmouseout="out('-3843880020425893891');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -            } else if (tableInfo instanceof SideTableInfo) {                                                      </span>
<span class="-2985738932129427689" onmouseenter="enter('-2985738932129427689');" onmouseout="out('-2985738932129427689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 283 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;all&quot; : &quot;async&quot;;"> 283 -                String sideOperator = ECacheType.ALL.name().equals(((SideTableInfo) tableInfo).getCacheType()) ? &quot;🔵</abbr></span>
<span class="5165508678119910334" onmouseenter="enter('5165508678119910334');" onmouseout="out('5165508678119910334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -                sideTableMap.put(tableInfo.getName(), (SideTableInfo) tableInfo);                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -                                                                                                                  </span>
<span class="-4259116026134380810" onmouseenter="enter('-4259116026134380810');" onmouseout="out('-4259116026134380810');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 286 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideTableInfo.TARGET_SUFFIX, localSqlPluginPath, remoteSqlPluginPath, pluginLoadMode);"> 286 -                URL sideTablePathUrl = PluginUtil.buildSidePathByLoadMode(tableInfo.getType(), sideOperator, SideT🔵</abbr></span>
<span class="8478994045251823670" onmouseenter="enter('8478994045251823670');" onmouseout="out('8478994045251823670');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -                pluginClassPatshSets.add(sideTablePathUrl);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -            } else {                                                                                              </span>
<span class="8243783913901445758" onmouseenter="enter('8243783913901445758');" onmouseout="out('8243783913901445758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -                throw new RuntimeException(&quot;not support table type:&quot; + tableInfo.getType());                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -        }                                                                                                         </span>
<span class="-6962850163542435916" onmouseenter="enter('-6962850163542435916');" onmouseout="out('-6962850163542435916');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -        return pluginClassPatshSets;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -    /**                                                                                                           </span>
<span class="4479230139530713533" onmouseenter="enter('4479230139530713533');" onmouseout="out('4479230139530713533');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -     *   perjob模式将job依赖的插件包路径存储到cacheFile，在外围将插件包路径传递给jobgraph                                                    </span>
<span class="7838228677949094601" onmouseenter="enter('7838228677949094601');" onmouseout="out('7838228677949094601');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -     * @param env                                                                                                 </span>
<span class="3041764420047400026" onmouseenter="enter('3041764420047400026');" onmouseout="out('3041764420047400026');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -     * @param classPathSet                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -     */                                                                                                           </span>
<span class="-990799121352910331" onmouseenter="enter('-990799121352910331');" onmouseout="out('-990799121352910331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -    private static void registerPluginUrlToCachedFile(StreamExecutionEnvironment env, Set&lt;URL&gt; classPathSet) {    </span>
<span class="-8629982182851448523" onmouseenter="enter('-8629982182851448523');" onmouseout="out('-8629982182851448523');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -        int i = 0;                                                                                                </span>
<span class="-3363421767965388278" onmouseenter="enter('-3363421767965388278');" onmouseout="out('-3363421767965388278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -        for (URL url : classPathSet) {                                                                            </span>
<span class="-4194005569117889993" onmouseenter="enter('-4194005569117889993');" onmouseout="out('-4194005569117889993');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -            String classFileName = String.format(CLASS_FILE_NAME_FMT, i);                                         </span>
<span class="25433699341695856" onmouseenter="enter('25433699341695856');" onmouseout="out('25433699341695856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -            env.registerCachedFile(url.getPath(), classFileName, true);                                           </span>
<span class="-4968746635634186778" onmouseenter="enter('-4968746635634186778');" onmouseout="out('-4968746635634186778');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -            i++;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                                                                                                                  </span>
<span class="6037448275203290983" onmouseenter="enter('6037448275203290983');" onmouseout="out('6037448275203290983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 309 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws Exception {"> 309 -    private static StreamExecutionEnvironment getStreamExeEnv(Properties confProperties, String deployMode) throws🔵</abbr></span>
<span class="1857551629048424160" onmouseenter="enter('1857551629048424160');" onmouseout="out('1857551629048424160');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -        StreamExecutionEnvironment env = !ClusterMode.local.name().equals(deployMode) ?                           </span>
<span class="-6511809336681102820" onmouseenter="enter('-6511809336681102820');" onmouseout="out('-6511809336681102820');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -                StreamExecutionEnvironment.getExecutionEnvironment() :                                            </span>
<span class="-8621235421173372299" onmouseenter="enter('-8621235421173372299');" onmouseout="out('-8621235421173372299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -                new MyLocalStreamEnvironment();                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -                                                                                                                  </span>
<span class="617011633675985660" onmouseenter="enter('617011633675985660');" onmouseout="out('617011633675985660');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -        StreamEnvConfigManager.streamExecutionEnvironmentConfig(env, confProperties);                             </span>
<span class="-6019519812778517209" onmouseenter="enter('-6019519812778517209');" onmouseout="out('-6019519812778517209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -        return env;                                                                                               </span>
<span class="3977078119492132713" onmouseenter="enter('3977078119492132713');" onmouseout="out('3977078119492132713');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +        ParamsInfo paramsInfo = ExecuteProcessHelper.parseParams(args);                                           </span>
<span class="-3772127640901444527" onmouseenter="enter('-3772127640901444527');" onmouseout="out('-3772127640901444527');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +        StreamExecutionEnvironment env = ExecuteProcessHelper.getStreamExecution(paramsInfo);                     </span>
<span class="1863648847627853221" onmouseenter="enter('1863648847627853221');" onmouseout="out('1863648847627853221');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 318 +        env.execute(paramsInfo.getName());                                                                        </span>
<span class="5148912022424864149" onmouseenter="enter('5148912022424864149');" onmouseout="out('5148912022424864149');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +        LOG.info(&quot;program {} execution success&quot;, paramsInfo.getName());                                           </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            