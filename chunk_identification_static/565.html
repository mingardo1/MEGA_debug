<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>565</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    565
                    <a href="564.html">prev</a>
                    <a href="566.html">next</a>
                    <a href="565_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_e83f8c3a3cbab21ecd8ceab223b0f3539be4b5fd_kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/serialization/AvroCRowSerializationSchema.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e83f8c3a3cbab21ecd8ceab223b0f3539be4b5fd:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/serialization/AvroCRowSerializationSchema.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e83f8c3a3cbab21ecd8ceab223b0f3539be4b5fd^1:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/serialization/AvroCRowSerializationSchema.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e83f8c3a3cbab21ecd8ceab223b0f3539be4b5fd^2:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/serialization/AvroCRowSerializationSchema.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;55715c184d537500eff25ccea853833950100929:kafka-base/kafka-base-sink/src/main/java/com/dtstack/flink/sql/sink/kafka/serialization/AvroCRowSerializationSchema.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bsj]], subset: [[bsj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">   2 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.sink.kafka.serialization;                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import com.dtstack.flink.sql.enums.EUpdateMode;                                                          </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import org.apache.avro.LogicalType;                                                                      </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.avro.LogicalTypes;                                                                     </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.avro.Schema;                                                                           </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.avro.SchemaParseException;                                                             </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import org.apache.avro.generic.GenericData;                                                              </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import org.apache.avro.generic.GenericDatumWriter;                                                       </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import org.apache.avro.generic.GenericRecord;                                                            </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.apache.avro.generic.IndexedRecord;                                                            </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.apache.avro.io.DatumWriter;                                                                   </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import org.apache.avro.io.Encoder;                                                                       </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import org.apache.avro.io.EncoderFactory;                                                                </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import org.apache.avro.specific.SpecificData;                                                            </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import org.apache.avro.specific.SpecificDatumWriter;                                                     </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import org.apache.avro.specific.SpecificRecord;                                                          </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import org.apache.avro.util.Utf8;                                                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import org.apache.flink.util.Preconditions;                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import java.io.ByteArrayOutputStream;                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import java.io.IOException;                                                                              </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 import java.io.ObjectInputStream;                                                                        </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import java.io.ObjectOutputStream;                                                                       </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import java.math.BigDecimal;                                                                             </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import java.nio.ByteBuffer;                                                                              </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import java.sql.Date;                                                                                    </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 import java.sql.Time;                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 import java.sql.Timestamp;                                                                               </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 import java.util.Objects;                                                                                </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 import java.util.Optional;                                                                               </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 import java.util.TimeZone;                                                                               </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 import java.util.stream.Collectors;                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62 /**                                                                                                      </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63  * Serialization schema that serializes CROW into Avro bytes.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64  *                                                                                                       </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65  * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that              </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66  * are compatible with Flink&#x27;s Table &amp; SQL API.                                                          </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67  **                                                                                                      </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68  * @author  maqi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69  */                                                                                                      </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70 public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72 	/**                                                                                                     </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73 	 * Used for time conversions from SQL types.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74 	 */                                                                                                     </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75 	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77 	/**                                                                                                     </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78 	 * Avro record class for serialization. Might be null if record class is not available.                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79 	 */                                                                                                     </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80 	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82 	/**                                                                                                     </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83 	 * Schema string for deserialization.                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84 	 */                                                                                                     </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85 	private String schemaString;                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87 	/**                                                                                                     </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88 	 * Avro serialization schema.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89 	 */                                                                                                     </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90 	private transient Schema schema;                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92 	/**                                                                                                     </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93 	 * Writer to serialize Avro record into a byte array.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94 	 */                                                                                                     </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95 	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97 	/**                                                                                                     </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98 	 * Output stream to serialize records into byte array.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99 	 */                                                                                                     </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100 	private transient ByteArrayOutputStream arrayOutputStream;                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102 	/**                                                                                                     </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103 	 * Low-level class for serialization of Avro values.                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104 	 */                                                                                                     </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105 	private transient Encoder encoder;                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106                                                                                                          </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107 	private String updateMode;                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108                                                                                                          </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109 	private String retractKey = &quot;retract&quot;;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111 	/**                                                                                                     </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112 	 * Creates an Avro serialization schema for the given specific record class.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113 	 *                                                                                                      </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114 	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115 	 */                                                                                                     </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116 	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {    </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117 		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                        </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118 		this.recordClazz = recordClazz;                                                                        </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119 		this.schema = SpecificData.get().getSchema(recordClazz);                                               </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120 		this.schemaString = schema.toString();                                                                 </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121 		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                  </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127 	/**                                                                                                     </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128 	 * Creates an Avro serialization schema for the given Avro schema string.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129 	 *                                                                                                      </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130 	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131 	 */                                                                                                     </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132 	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                         </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133 		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                         </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134 		this.recordClazz = null;                                                                               </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135 		this.schemaString = avroSchemaString;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136 		try {                                                                                                  </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137 			this.schema = new Schema.Parser().parse(avroSchemaString);                                            </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138 		} catch (SchemaParseException e) {                                                                     </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139 			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140 		}                                                                                                      </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141 		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                   </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147 	@Override                                                                                               </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148 	public byte[] serialize(CRow crow) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149 		try {                                                                                                  </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150 			Row row = crow.row();                                                                                 </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151 			boolean change = crow.change();                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152                                                                                                          </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153 			// convert to record                                                                                  </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154 			final GenericRecord record = convertRowToAvroRecord(schema, row);                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155                                                                                                          </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156 			dealRetractField(change, record);                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157                                                                                                          </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158 			arrayOutputStream.reset();                                                                            </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159 			datumWriter.write(record, encoder);                                                                   </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160 			encoder.flush();                                                                                      </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161 			return arrayOutputStream.toByteArray();                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162 		} catch (Exception e) {                                                                                </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163 			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167 	protected void dealRetractField(boolean change, GenericRecord record) {                                 </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168 		schema.getFields()                                                                                     </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169 				.stream()                                                                                            </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170 				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                             </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171 				.findFirst()                                                                                         </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172 				.ifPresent(field -&gt; {                                                                                </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173 					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                          </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174 						record.put(retractKey, convertFlinkType(field.schema(), change));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175 					}                                                                                                   </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176 				});                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179 	@Override                                                                                               </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180 	public boolean equals(Object o) {                                                                       </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181 		if (this == o) {                                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182 			return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183 		}                                                                                                      </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184 		if (o == null || getClass() != o.getClass()) {                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185 			return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186 		}                                                                                                      </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187 		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                              </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 188 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);"> 188 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString)</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191 	@Override                                                                                               </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192 	public int hashCode() {                                                                                 </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193 		return Objects.hash(recordClazz, schemaString);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                                                                                                          </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196 	// --------------------------------------------------------------------------------------------         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                                                                                                          </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198 	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                                                                                                          </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200 		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                   </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201 				.stream()                                                                                            </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202 				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                            </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203 				.collect(Collectors.toList());                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                                                                                                          </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205 		final int length = fields.size();                                                                      </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206 		final GenericRecord record = new GenericData.Record(schema);                                           </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207 		for (int i = 0; i &lt; length; i++) {                                                                     </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208 			final Schema.Field field = fields.get(i);                                                             </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209 			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210 		}                                                                                                      </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211 		return record;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                                                                                                          </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214 	private Object convertFlinkType(Schema schema, Object object) {                                         </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215 		if (object == null) {                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216 			return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217 		}                                                                                                      </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218 		switch (schema.getType()) {                                                                            </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219 			case RECORD:                                                                                          </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220 				if (object instanceof Row) {                                                                         </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221 					return convertRowToAvroRecord(schema, (Row) object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222 				}                                                                                                    </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223 				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                       </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224 			case ENUM:                                                                                            </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225 				return new GenericData.EnumSymbol(schema, object.toString());                                        </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226 			case ARRAY:                                                                                           </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227 				final Schema elementSchema = schema.getElementType();                                                </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228 				final Object[] array = (Object[]) object;                                                            </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229 				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);      </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230 				for (Object element : array) {                                                                       </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231 					convertedArray.add(convertFlinkType(elementSchema, element));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232 				}                                                                                                    </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233 				return convertedArray;                                                                               </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234 			case MAP:                                                                                             </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235 				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                            </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236 				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                              </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237 				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                       </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238 					convertedMap.put(                                                                                   </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239 						new Utf8(entry.getKey().toString()),                                                               </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240 						convertFlinkType(schema.getValueType(), entry.getValue()));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241 				}                                                                                                    </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242 				return convertedMap;                                                                                 </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243 			case UNION:                                                                                           </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244 				final List&lt;Schema&gt; types = schema.getTypes();                                                        </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245 				final int size = types.size();                                                                       </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246 				final Schema actualSchema;                                                                           </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247 				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                       </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248 					actualSchema = types.get(1);                                                                        </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249 				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250 					actualSchema = types.get(0);                                                                        </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251 				} else if (size == 1) {                                                                              </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252 					actualSchema = types.get(0);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253 				} else {                                                                                             </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254 					// generic type                                                                                     </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255 					return object;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256 				}                                                                                                    </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257 				return convertFlinkType(actualSchema, object);                                                       </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258 			case FIXED:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261 					return new GenericData.Fixed(                                                                       </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262 						schema,                                                                                            </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263 						convertFromDecimal(schema, (BigDecimal) object));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264 				}                                                                                                    </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265 				return new GenericData.Fixed(schema, (byte[]) object);                                               </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266 			case STRING:                                                                                          </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267 				return new Utf8(object.toString());                                                                  </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268 			case BYTES:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271 					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272 				}                                                                                                    </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273 				return ByteBuffer.wrap((byte[]) object);                                                             </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274 			case INT:                                                                                             </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275 				// check for logical types                                                                           </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276 				if (object instanceof Date) {                                                                        </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277 					return convertFromDate(schema, (Date) object);                                                      </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278 				} else if (object instanceof Time) {                                                                 </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279 					return convertFromTime(schema, (Time) object);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281 				return object;                                                                                       </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282 			case LONG:                                                                                            </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283 				// check for logical type                                                                            </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284 				if (object instanceof Timestamp) {                                                                   </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285 					return convertFromTimestamp(schema, (Timestamp) object);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287 				return object;                                                                                       </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288 			case FLOAT:                                                                                           </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289 			case DOUBLE:                                                                                          </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290 			case BOOLEAN:                                                                                         </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291 				return object;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292 		}                                                                                                      </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293 		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                                                                                                          </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296 	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                  </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298 		if (logicalType instanceof LogicalTypes.Decimal) {                                                     </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299 			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                          </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300 			// rescale to target type                                                                             </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301 			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);   </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302 			// byte array must contain the two&#x27;s-complement representation of the                                 </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303 			// unscaled integer value in big-endian byte order                                                    </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304 			return decimal.unscaledValue().toByteArray();                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305 		} else {                                                                                               </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306 			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                                                                                                          </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310 	private int convertFromDate(Schema schema, Date date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312 		if (logicalType == LogicalTypes.date()) {                                                              </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316 			return (int) (converted / 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317 		} else {                                                                                               </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318 			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321                                                                                                          </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322 	private int convertFromTime(Schema schema, Time date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324 		if (logicalType == LogicalTypes.timeMillis()) {                                                        </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328 			return (int) (converted % 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329 		} else {                                                                                               </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330 			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333                                                                                                          </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334 	private long convertFromTimestamp(Schema schema, Timestamp date) {                                      </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336 		if (logicalType == LogicalTypes.timestampMillis()) {                                                   </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338 			final long time = date.getTime();                                                                     </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339 			return time + (long) LOCAL_TZ.getOffset(time);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340 		} else {                                                                                               </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341 			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344                                                                                                          </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345 	private void writeObject(ObjectOutputStream outputStream) throws IOException {                          </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346 		outputStream.writeObject(recordClazz);                                                                 </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347 		outputStream.writeObject(schemaString); // support for null                                            </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348 		outputStream.writeObject(retractKey);                                                                  </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349 		outputStream.writeObject(updateMode);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351                                                                                                          </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352 	@SuppressWarnings(&quot;unchecked&quot;)                                                                          </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353 	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {     </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354 		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                              </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355 		schemaString = (String) inputStream.readObject();                                                      </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356 		if (recordClazz != null) {                                                                             </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357 			schema = SpecificData.get().getSchema(recordClazz);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358 		} else {                                                                                               </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359 			schema = new Schema.Parser().parse(schemaString);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360 		}                                                                                                      </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361 		retractKey = (String) inputStream.readObject();                                                        </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362 		updateMode = (String) inputStream.readObject();                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363                                                                                                          </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364 		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                       </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365 		arrayOutputStream = new ByteArrayOutputStream();                                                       </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366 		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367 	}                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 369 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387                                                                                                          </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388 package com.dtstack.flink.sql.sink.kafka.serialization;                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                                                                                                          </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390 import com.dtstack.flink.sql.enums.EUpdateMode;                                                          </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391 import org.apache.avro.LogicalType;                                                                      </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392 import org.apache.avro.LogicalTypes;                                                                     </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393 import org.apache.avro.Schema;                                                                           </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394 import org.apache.avro.SchemaParseException;                                                             </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395 import org.apache.avro.generic.GenericData;                                                              </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396 import org.apache.avro.generic.GenericDatumWriter;                                                       </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397 import org.apache.avro.generic.GenericRecord;                                                            </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398 import org.apache.avro.generic.IndexedRecord;                                                            </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399 import org.apache.avro.io.DatumWriter;                                                                   </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400 import org.apache.avro.io.Encoder;                                                                       </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401 import org.apache.avro.io.EncoderFactory;                                                                </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402 import org.apache.avro.specific.SpecificData;                                                            </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403 import org.apache.avro.specific.SpecificDatumWriter;                                                     </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404 import org.apache.avro.specific.SpecificRecord;                                                          </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405 import org.apache.avro.util.Utf8;                                                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410 import org.apache.flink.util.Preconditions;                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 411                                                                                                          </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412 import java.io.ByteArrayOutputStream;                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413 import java.io.IOException;                                                                              </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414 import java.io.ObjectInputStream;                                                                        </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415 import java.io.ObjectOutputStream;                                                                       </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416 import java.math.BigDecimal;                                                                             </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417 import java.nio.ByteBuffer;                                                                              </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418 import java.sql.Date;                                                                                    </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419 import java.sql.Time;                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420 import java.sql.Timestamp;                                                                               </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424 import java.util.Objects;                                                                                </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425 import java.util.TimeZone;                                                                               </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426 import java.util.stream.Collectors;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428 /**                                                                                                      </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429  * Serialization schema that serializes CROW into Avro bytes.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430  *                                                                                                       </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431  * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that              </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432  * are compatible with Flink&#x27;s Table &amp; SQL API.                                                          </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433  **                                                                                                      </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434  * @author  maqi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 435  */                                                                                                      </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436 public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438 	/**                                                                                                     </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439 	 * Used for time conversions from SQL types.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440 	 */                                                                                                     </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441 	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443 	/**                                                                                                     </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444 	 * Avro record class for serialization. Might be null if record class is not available.                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445 	 */                                                                                                     </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446 	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448 	/**                                                                                                     </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449 	 * Schema string for deserialization.                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450 	 */                                                                                                     </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451 	private String schemaString;                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453 	/**                                                                                                     </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454 	 * Avro serialization schema.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455 	 */                                                                                                     </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456 	private transient Schema schema;                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458 	/**                                                                                                     </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459 	 * Writer to serialize Avro record into a byte array.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460 	 */                                                                                                     </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461 	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463 	/**                                                                                                     </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464 	 * Output stream to serialize records into byte array.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 465 	 */                                                                                                     </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 466 	private transient ByteArrayOutputStream arrayOutputStream;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 467                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 468 	/**                                                                                                     </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 469 	 * Low-level class for serialization of Avro values.                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 470 	 */                                                                                                     </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 471 	private transient Encoder encoder;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 472                                                                                                          </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 473 	private String updateMode;                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 474                                                                                                          </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 475 	private String retractKey = &quot;retract&quot;;                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 476                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 477 	/**                                                                                                     </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 478 	 * Creates an Avro serialization schema for the given specific record class.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 479 	 *                                                                                                      </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 480 	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 481 	 */                                                                                                     </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 482 	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {    </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 483 		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                        </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 484 		this.recordClazz = recordClazz;                                                                        </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 485 		this.schema = SpecificData.get().getSchema(recordClazz);                                               </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 486 		this.schemaString = schema.toString();                                                                 </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 487 		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                  </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 488 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 489 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 490 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 491 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 492                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 493 	/**                                                                                                     </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 494 	 * Creates an Avro serialization schema for the given Avro schema string.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 495 	 *                                                                                                      </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 496 	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 497 	 */                                                                                                     </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 498 	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                         </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 499 		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                         </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 500 		this.recordClazz = null;                                                                               </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 501 		this.schemaString = avroSchemaString;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 502 		try {                                                                                                  </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 503 			this.schema = new Schema.Parser().parse(avroSchemaString);                                            </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 504 		} catch (SchemaParseException e) {                                                                     </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 505 			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506 		}                                                                                                      </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507 		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                   </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513 	@Override                                                                                               </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514 	public byte[] serialize(CRow crow) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515 		try {                                                                                                  </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516 			Row row = crow.row();                                                                                 </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517 			boolean change = crow.change();                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518                                                                                                          </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519 			// convert to record                                                                                  </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520 			final GenericRecord record = convertRowToAvroRecord(schema, row);                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521                                                                                                          </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522 			dealRetractField(change, record);                                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523                                                                                                          </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524 			arrayOutputStream.reset();                                                                            </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525 			datumWriter.write(record, encoder);                                                                   </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526 			encoder.flush();                                                                                      </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527 			return arrayOutputStream.toByteArray();                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528 		} catch (Exception e) {                                                                                </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529 			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532                                                                                                          </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533 	protected void dealRetractField(boolean change, GenericRecord record) {                                 </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534 		schema.getFields()                                                                                     </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535 				.stream()                                                                                            </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536 				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                             </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537 				.findFirst()                                                                                         </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538 				.ifPresent(field -&gt; {                                                                                </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539 					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                          </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540 						record.put(retractKey, convertFlinkType(field.schema(), change));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541 					}                                                                                                   </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542 				});                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545 	@Override                                                                                               </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546 	public boolean equals(Object o) {                                                                       </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547 		if (this == o) {                                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548 			return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549 		}                                                                                                      </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550 		if (o == null || getClass() != o.getClass()) {                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551 			return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552 		}                                                                                                      </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553 		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                              </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 554 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);"> 554 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString)</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557 	@Override                                                                                               </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558 	public int hashCode() {                                                                                 </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559 		return Objects.hash(recordClazz, schemaString);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561                                                                                                          </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562 	// --------------------------------------------------------------------------------------------         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563                                                                                                          </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564 	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565                                                                                                          </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566 		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                   </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567 				.stream()                                                                                            </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568 				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                            </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569 				.collect(Collectors.toList());                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570                                                                                                          </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571 		final int length = fields.size();                                                                      </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572 		final GenericRecord record = new GenericData.Record(schema);                                           </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573 		for (int i = 0; i &lt; length; i++) {                                                                     </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574 			final Schema.Field field = fields.get(i);                                                             </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575 			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576 		}                                                                                                      </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577 		return record;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579                                                                                                          </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580 	private Object convertFlinkType(Schema schema, Object object) {                                         </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581 		if (object == null) {                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582 			return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583 		}                                                                                                      </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584 		switch (schema.getType()) {                                                                            </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585 			case RECORD:                                                                                          </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586 				if (object instanceof Row) {                                                                         </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587 					return convertRowToAvroRecord(schema, (Row) object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588 				}                                                                                                    </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589 				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                       </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590 			case ENUM:                                                                                            </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591 				return new GenericData.EnumSymbol(schema, object.toString());                                        </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592 			case ARRAY:                                                                                           </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593 				final Schema elementSchema = schema.getElementType();                                                </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594 				final Object[] array = (Object[]) object;                                                            </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595 				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);      </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596 				for (Object element : array) {                                                                       </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597 					convertedArray.add(convertFlinkType(elementSchema, element));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598 				}                                                                                                    </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599 				return convertedArray;                                                                               </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600 			case MAP:                                                                                             </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601 				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                            </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602 				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                              </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603 				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                       </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604 					convertedMap.put(                                                                                   </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605 						new Utf8(entry.getKey().toString()),                                                               </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 606 						convertFlinkType(schema.getValueType(), entry.getValue()));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607 				}                                                                                                    </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608 				return convertedMap;                                                                                 </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609 			case UNION:                                                                                           </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610 				final List&lt;Schema&gt; types = schema.getTypes();                                                        </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611 				final int size = types.size();                                                                       </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612 				final Schema actualSchema;                                                                           </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613 				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                       </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614 					actualSchema = types.get(1);                                                                        </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615 				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616 					actualSchema = types.get(0);                                                                        </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617 				} else if (size == 1) {                                                                              </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618 					actualSchema = types.get(0);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619 				} else {                                                                                             </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620 					// generic type                                                                                     </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621 					return object;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622 				}                                                                                                    </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623 				return convertFlinkType(actualSchema, object);                                                       </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624 			case FIXED:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627 					return new GenericData.Fixed(                                                                       </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628 						schema,                                                                                            </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629 						convertFromDecimal(schema, (BigDecimal) object));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630 				}                                                                                                    </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631 				return new GenericData.Fixed(schema, (byte[]) object);                                               </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632 			case STRING:                                                                                          </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633 				return new Utf8(object.toString());                                                                  </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634 			case BYTES:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637 					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638 				}                                                                                                    </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639 				return ByteBuffer.wrap((byte[]) object);                                                             </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640 			case INT:                                                                                             </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641 				// check for logical types                                                                           </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642 				if (object instanceof Date) {                                                                        </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643 					return convertFromDate(schema, (Date) object);                                                      </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644 				} else if (object instanceof Time) {                                                                 </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645 					return convertFromTime(schema, (Time) object);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647 				return object;                                                                                       </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648 			case LONG:                                                                                            </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649 				// check for logical type                                                                            </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650 				if (object instanceof Timestamp) {                                                                   </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651 					return convertFromTimestamp(schema, (Timestamp) object);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653 				return object;                                                                                       </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654 			case FLOAT:                                                                                           </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655 			case DOUBLE:                                                                                          </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656 			case BOOLEAN:                                                                                         </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657 				return object;                                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658 			default:                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659 		}                                                                                                      </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660 		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662                                                                                                          </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663 	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                  </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665 		if (logicalType instanceof LogicalTypes.Decimal) {                                                     </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666 			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                          </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667 			// rescale to target type                                                                             </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668 			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);   </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669 			// byte array must contain the two&#x27;s-complement representation of the                                 </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670 			// unscaled integer value in big-endian byte order                                                    </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671 			return decimal.unscaledValue().toByteArray();                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672 		} else {                                                                                               </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673 			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                                                                                                          </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677 	private int convertFromDate(Schema schema, Date date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679 		if (logicalType == LogicalTypes.date()) {                                                              </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683 			return (int) (converted / 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684 		} else {                                                                                               </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685 			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688                                                                                                          </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689 	private int convertFromTime(Schema schema, Time date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691 		if (logicalType == LogicalTypes.timeMillis()) {                                                        </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695 			return (int) (converted % 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696 		} else {                                                                                               </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697 			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                                                                                                          </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701 	private long convertFromTimestamp(Schema schema, Timestamp date) {                                      </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703 		if (logicalType == LogicalTypes.timestampMillis()) {                                                   </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705 			final long time = date.getTime();                                                                     </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706 			return time + (long) LOCAL_TZ.getOffset(time);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707 		} else {                                                                                               </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708 			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711                                                                                                          </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712 	private void writeObject(ObjectOutputStream outputStream) throws IOException {                          </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713 		outputStream.writeObject(recordClazz);                                                                 </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714 		outputStream.writeObject(schemaString); // support for null                                            </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715 		outputStream.writeObject(retractKey);                                                                  </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716 		outputStream.writeObject(updateMode);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718                                                                                                          </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719 	@SuppressWarnings(&quot;unchecked&quot;)                                                                          </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720 	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {     </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721 		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                              </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722 		schemaString = (String) inputStream.readObject();                                                      </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723 		if (recordClazz != null) {                                                                             </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724 			schema = SpecificData.get().getSchema(recordClazz);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725 		} else {                                                                                               </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726 			schema = new Schema.Parser().parse(schemaString);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727 		}                                                                                                      </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728 		retractKey = (String) inputStream.readObject();                                                        </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729 		updateMode = (String) inputStream.readObject();                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                                                                                                          </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731 		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                       </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732 		arrayOutputStream = new ByteArrayOutputStream();                                                       </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733 		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734 	}                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735 }                                                                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 736 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span></pre></td>
                            <td><pre><span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.sink.kafka.serialization;                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import com.dtstack.flink.sql.enums.EUpdateMode;                                                          </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import org.apache.avro.LogicalType;                                                                      </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.avro.LogicalTypes;                                                                     </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.avro.Schema;                                                                           </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.avro.SchemaParseException;                                                             </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import org.apache.avro.generic.GenericData;                                                              </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import org.apache.avro.generic.GenericDatumWriter;                                                       </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import org.apache.avro.generic.GenericRecord;                                                            </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.apache.avro.generic.IndexedRecord;                                                            </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.apache.avro.io.DatumWriter;                                                                   </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import org.apache.avro.io.Encoder;                                                                       </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import org.apache.avro.io.EncoderFactory;                                                                </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import org.apache.avro.specific.SpecificData;                                                            </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import org.apache.avro.specific.SpecificDatumWriter;                                                     </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import org.apache.avro.specific.SpecificRecord;                                                          </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import org.apache.avro.util.Utf8;                                                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import org.apache.flink.util.Preconditions;                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import java.io.ByteArrayOutputStream;                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46 import java.io.IOException;                                                                              </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 import java.io.ObjectInputStream;                                                                        </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import java.io.ObjectOutputStream;                                                                       </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import java.math.BigDecimal;                                                                             </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import java.nio.ByteBuffer;                                                                              </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import java.sql.Date;                                                                                    </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 import java.sql.Time;                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 import java.sql.Timestamp;                                                                               </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 import java.util.Objects;                                                                                </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 import java.util.Optional;                                                                               </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 import java.util.TimeZone;                                                                               </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 import java.util.stream.Collectors;                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62 /**                                                                                                      </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63  * Serialization schema that serializes CROW into Avro bytes.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64  *                                                                                                       </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65  * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that              </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66  * are compatible with Flink&#x27;s Table &amp; SQL API.                                                          </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67  **                                                                                                      </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68  * @author  maqi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69  */                                                                                                      </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70 public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72 	/**                                                                                                     </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73 	 * Used for time conversions from SQL types.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74 	 */                                                                                                     </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75 	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77 	/**                                                                                                     </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78 	 * Avro record class for serialization. Might be null if record class is not available.                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79 	 */                                                                                                     </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80 	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82 	/**                                                                                                     </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83 	 * Schema string for deserialization.                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84 	 */                                                                                                     </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85 	private String schemaString;                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87 	/**                                                                                                     </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88 	 * Avro serialization schema.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89 	 */                                                                                                     </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90 	private transient Schema schema;                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92 	/**                                                                                                     </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93 	 * Writer to serialize Avro record into a byte array.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94 	 */                                                                                                     </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95 	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97 	/**                                                                                                     </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98 	 * Output stream to serialize records into byte array.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99 	 */                                                                                                     </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100 	private transient ByteArrayOutputStream arrayOutputStream;                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102 	/**                                                                                                     </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103 	 * Low-level class for serialization of Avro values.                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104 	 */                                                                                                     </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105 	private transient Encoder encoder;                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106                                                                                                          </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107 	private String updateMode;                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108                                                                                                          </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109 	private String retractKey = &quot;retract&quot;;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111 	/**                                                                                                     </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112 	 * Creates an Avro serialization schema for the given specific record class.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113 	 *                                                                                                      </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114 	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115 	 */                                                                                                     </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116 	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {    </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117 		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                        </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118 		this.recordClazz = recordClazz;                                                                        </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119 		this.schema = SpecificData.get().getSchema(recordClazz);                                               </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120 		this.schemaString = schema.toString();                                                                 </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121 		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                  </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127 	/**                                                                                                     </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128 	 * Creates an Avro serialization schema for the given Avro schema string.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129 	 *                                                                                                      </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130 	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131 	 */                                                                                                     </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132 	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                         </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133 		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                         </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134 		this.recordClazz = null;                                                                               </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135 		this.schemaString = avroSchemaString;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136 		try {                                                                                                  </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137 			this.schema = new Schema.Parser().parse(avroSchemaString);                                            </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138 		} catch (SchemaParseException e) {                                                                     </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139 			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140 		}                                                                                                      </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141 		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                   </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147 	@Override                                                                                               </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148 	public byte[] serialize(CRow crow) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149 		try {                                                                                                  </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150 			Row row = crow.row();                                                                                 </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151 			boolean change = crow.change();                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152                                                                                                          </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153 			// convert to record                                                                                  </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154 			final GenericRecord record = convertRowToAvroRecord(schema, row);                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155                                                                                                          </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156 			dealRetractField(change, record);                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157                                                                                                          </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158 			arrayOutputStream.reset();                                                                            </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159 			datumWriter.write(record, encoder);                                                                   </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160 			encoder.flush();                                                                                      </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161 			return arrayOutputStream.toByteArray();                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162 		} catch (Exception e) {                                                                                </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163 			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167 	protected void dealRetractField(boolean change, GenericRecord record) {                                 </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168 		schema.getFields()                                                                                     </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169 				.stream()                                                                                            </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170 				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                             </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171 				.findFirst()                                                                                         </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172 				.ifPresent(field -&gt; {                                                                                </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173 					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                          </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174 						record.put(retractKey, convertFlinkType(field.schema(), change));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175 					}                                                                                                   </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176 				});                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179 	@Override                                                                                               </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180 	public boolean equals(Object o) {                                                                       </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181 		if (this == o) {                                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182 			return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183 		}                                                                                                      </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184 		if (o == null || getClass() != o.getClass()) {                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185 			return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186 		}                                                                                                      </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187 		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                              </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 188 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);"> 188 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString)</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191 	@Override                                                                                               </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192 	public int hashCode() {                                                                                 </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193 		return Objects.hash(recordClazz, schemaString);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                                                                                                          </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196 	// --------------------------------------------------------------------------------------------         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                                                                                                          </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198 	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                                                                                                          </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200 		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                   </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201 				.stream()                                                                                            </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202 				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                            </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203 				.collect(Collectors.toList());                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                                                                                                          </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205 		final int length = fields.size();                                                                      </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206 		final GenericRecord record = new GenericData.Record(schema);                                           </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207 		for (int i = 0; i &lt; length; i++) {                                                                     </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208 			final Schema.Field field = fields.get(i);                                                             </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209 			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210 		}                                                                                                      </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211 		return record;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                                                                                                          </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214 	private Object convertFlinkType(Schema schema, Object object) {                                         </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215 		if (object == null) {                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216 			return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217 		}                                                                                                      </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218 		switch (schema.getType()) {                                                                            </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219 			case RECORD:                                                                                          </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220 				if (object instanceof Row) {                                                                         </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221 					return convertRowToAvroRecord(schema, (Row) object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222 				}                                                                                                    </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223 				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                       </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224 			case ENUM:                                                                                            </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225 				return new GenericData.EnumSymbol(schema, object.toString());                                        </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226 			case ARRAY:                                                                                           </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227 				final Schema elementSchema = schema.getElementType();                                                </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228 				final Object[] array = (Object[]) object;                                                            </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229 				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);      </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230 				for (Object element : array) {                                                                       </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231 					convertedArray.add(convertFlinkType(elementSchema, element));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232 				}                                                                                                    </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233 				return convertedArray;                                                                               </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234 			case MAP:                                                                                             </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235 				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                            </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236 				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                              </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237 				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                       </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238 					convertedMap.put(                                                                                   </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239 						new Utf8(entry.getKey().toString()),                                                               </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240 						convertFlinkType(schema.getValueType(), entry.getValue()));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241 				}                                                                                                    </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242 				return convertedMap;                                                                                 </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243 			case UNION:                                                                                           </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244 				final List&lt;Schema&gt; types = schema.getTypes();                                                        </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245 				final int size = types.size();                                                                       </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246 				final Schema actualSchema;                                                                           </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247 				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                       </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248 					actualSchema = types.get(1);                                                                        </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249 				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250 					actualSchema = types.get(0);                                                                        </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251 				} else if (size == 1) {                                                                              </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252 					actualSchema = types.get(0);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253 				} else {                                                                                             </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254 					// generic type                                                                                     </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255 					return object;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256 				}                                                                                                    </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257 				return convertFlinkType(actualSchema, object);                                                       </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258 			case FIXED:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261 					return new GenericData.Fixed(                                                                       </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262 						schema,                                                                                            </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263 						convertFromDecimal(schema, (BigDecimal) object));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264 				}                                                                                                    </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265 				return new GenericData.Fixed(schema, (byte[]) object);                                               </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266 			case STRING:                                                                                          </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267 				return new Utf8(object.toString());                                                                  </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268 			case BYTES:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271 					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272 				}                                                                                                    </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273 				return ByteBuffer.wrap((byte[]) object);                                                             </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274 			case INT:                                                                                             </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275 				// check for logical types                                                                           </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276 				if (object instanceof Date) {                                                                        </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277 					return convertFromDate(schema, (Date) object);                                                      </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278 				} else if (object instanceof Time) {                                                                 </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279 					return convertFromTime(schema, (Time) object);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281 				return object;                                                                                       </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282 			case LONG:                                                                                            </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283 				// check for logical type                                                                            </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284 				if (object instanceof Timestamp) {                                                                   </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285 					return convertFromTimestamp(schema, (Timestamp) object);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287 				return object;                                                                                       </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288 			case FLOAT:                                                                                           </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289 			case DOUBLE:                                                                                          </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290 			case BOOLEAN:                                                                                         </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291 				return object;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292 		}                                                                                                      </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293 		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                                                                                                          </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296 	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                  </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298 		if (logicalType instanceof LogicalTypes.Decimal) {                                                     </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299 			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                          </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300 			// rescale to target type                                                                             </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301 			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);   </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302 			// byte array must contain the two&#x27;s-complement representation of the                                 </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303 			// unscaled integer value in big-endian byte order                                                    </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304 			return decimal.unscaledValue().toByteArray();                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305 		} else {                                                                                               </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306 			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                                                                                                          </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310 	private int convertFromDate(Schema schema, Date date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312 		if (logicalType == LogicalTypes.date()) {                                                              </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316 			return (int) (converted / 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317 		} else {                                                                                               </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318 			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321                                                                                                          </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322 	private int convertFromTime(Schema schema, Time date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324 		if (logicalType == LogicalTypes.timeMillis()) {                                                        </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328 			return (int) (converted % 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329 		} else {                                                                                               </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330 			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333                                                                                                          </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334 	private long convertFromTimestamp(Schema schema, Timestamp date) {                                      </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336 		if (logicalType == LogicalTypes.timestampMillis()) {                                                   </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338 			final long time = date.getTime();                                                                     </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339 			return time + (long) LOCAL_TZ.getOffset(time);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340 		} else {                                                                                               </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341 			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344                                                                                                          </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345 	private void writeObject(ObjectOutputStream outputStream) throws IOException {                          </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346 		outputStream.writeObject(recordClazz);                                                                 </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347 		outputStream.writeObject(schemaString); // support for null                                            </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348 		outputStream.writeObject(retractKey);                                                                  </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349 		outputStream.writeObject(updateMode);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351                                                                                                          </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352 	@SuppressWarnings(&quot;unchecked&quot;)                                                                          </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353 	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {     </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354 		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                              </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355 		schemaString = (String) inputStream.readObject();                                                      </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356 		if (recordClazz != null) {                                                                             </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357 			schema = SpecificData.get().getSchema(recordClazz);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358 		} else {                                                                                               </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359 			schema = new Schema.Parser().parse(schemaString);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360 		}                                                                                                      </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361 		retractKey = (String) inputStream.readObject();                                                        </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362 		updateMode = (String) inputStream.readObject();                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363                                                                                                          </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364 		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                       </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365 		arrayOutputStream = new ByteArrayOutputStream();                                                       </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366 		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367 	}                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 369 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387                                                                                                          </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388 package com.dtstack.flink.sql.sink.kafka.serialization;                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                                                                                                          </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390 import com.dtstack.flink.sql.enums.EUpdateMode;                                                          </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391 import org.apache.avro.LogicalType;                                                                      </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392 import org.apache.avro.LogicalTypes;                                                                     </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393 import org.apache.avro.Schema;                                                                           </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394 import org.apache.avro.SchemaParseException;                                                             </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395 import org.apache.avro.generic.GenericData;                                                              </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396 import org.apache.avro.generic.GenericDatumWriter;                                                       </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397 import org.apache.avro.generic.GenericRecord;                                                            </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398 import org.apache.avro.generic.IndexedRecord;                                                            </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399 import org.apache.avro.io.DatumWriter;                                                                   </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400 import org.apache.avro.io.Encoder;                                                                       </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401 import org.apache.avro.io.EncoderFactory;                                                                </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402 import org.apache.avro.specific.SpecificData;                                                            </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403 import org.apache.avro.specific.SpecificDatumWriter;                                                     </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404 import org.apache.avro.specific.SpecificRecord;                                                          </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405 import org.apache.avro.util.Utf8;                                                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410 import org.apache.flink.util.Preconditions;                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 411                                                                                                          </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412 import java.io.ByteArrayOutputStream;                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413 import java.io.IOException;                                                                              </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414 import java.io.ObjectInputStream;                                                                        </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415 import java.io.ObjectOutputStream;                                                                       </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416 import java.math.BigDecimal;                                                                             </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417 import java.nio.ByteBuffer;                                                                              </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418 import java.sql.Date;                                                                                    </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419 import java.sql.Time;                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420 import java.sql.Timestamp;                                                                               </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424 import java.util.Objects;                                                                                </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425 import java.util.TimeZone;                                                                               </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426 import java.util.stream.Collectors;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428 /**                                                                                                      </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429  * Serialization schema that serializes CROW into Avro bytes.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430  *                                                                                                       </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431  * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that              </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432  * are compatible with Flink&#x27;s Table &amp; SQL API.                                                          </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433  **                                                                                                      </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434  * @author  maqi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 435  */                                                                                                      </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436 public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438 	/**                                                                                                     </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439 	 * Used for time conversions from SQL types.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440 	 */                                                                                                     </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441 	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443 	/**                                                                                                     </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444 	 * Avro record class for serialization. Might be null if record class is not available.                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445 	 */                                                                                                     </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446 	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448 	/**                                                                                                     </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449 	 * Schema string for deserialization.                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450 	 */                                                                                                     </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451 	private String schemaString;                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453 	/**                                                                                                     </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454 	 * Avro serialization schema.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455 	 */                                                                                                     </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456 	private transient Schema schema;                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458 	/**                                                                                                     </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459 	 * Writer to serialize Avro record into a byte array.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460 	 */                                                                                                     </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461 	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463 	/**                                                                                                     </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464 	 * Output stream to serialize records into byte array.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 465 	 */                                                                                                     </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 466 	private transient ByteArrayOutputStream arrayOutputStream;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 467                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 468 	/**                                                                                                     </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 469 	 * Low-level class for serialization of Avro values.                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 470 	 */                                                                                                     </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 471 	private transient Encoder encoder;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 472                                                                                                          </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 473 	private String updateMode;                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 474                                                                                                          </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 475 	private String retractKey = &quot;retract&quot;;                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 476                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 477 	/**                                                                                                     </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 478 	 * Creates an Avro serialization schema for the given specific record class.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 479 	 *                                                                                                      </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 480 	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 481 	 */                                                                                                     </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 482 	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {    </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 483 		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                        </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 484 		this.recordClazz = recordClazz;                                                                        </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 485 		this.schema = SpecificData.get().getSchema(recordClazz);                                               </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 486 		this.schemaString = schema.toString();                                                                 </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 487 		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                  </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 488 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 489 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 490 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 491 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 492                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 493 	/**                                                                                                     </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 494 	 * Creates an Avro serialization schema for the given Avro schema string.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 495 	 *                                                                                                      </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 496 	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 497 	 */                                                                                                     </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 498 	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                         </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 499 		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                         </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 500 		this.recordClazz = null;                                                                               </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 501 		this.schemaString = avroSchemaString;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 502 		try {                                                                                                  </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 503 			this.schema = new Schema.Parser().parse(avroSchemaString);                                            </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 504 		} catch (SchemaParseException e) {                                                                     </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 505 			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506 		}                                                                                                      </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507 		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                   </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513 	@Override                                                                                               </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514 	public byte[] serialize(CRow crow) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515 		try {                                                                                                  </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516 			Row row = crow.row();                                                                                 </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517 			boolean change = crow.change();                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518                                                                                                          </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519 			// convert to record                                                                                  </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520 			final GenericRecord record = convertRowToAvroRecord(schema, row);                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521                                                                                                          </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522 			dealRetractField(change, record);                                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523                                                                                                          </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524 			arrayOutputStream.reset();                                                                            </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525 			datumWriter.write(record, encoder);                                                                   </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526 			encoder.flush();                                                                                      </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527 			return arrayOutputStream.toByteArray();                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528 		} catch (Exception e) {                                                                                </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529 			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532                                                                                                          </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533 	protected void dealRetractField(boolean change, GenericRecord record) {                                 </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534 		schema.getFields()                                                                                     </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535 				.stream()                                                                                            </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536 				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                             </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537 				.findFirst()                                                                                         </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538 				.ifPresent(field -&gt; {                                                                                </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539 					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                          </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540 						record.put(retractKey, convertFlinkType(field.schema(), change));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541 					}                                                                                                   </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542 				});                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545 	@Override                                                                                               </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546 	public boolean equals(Object o) {                                                                       </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547 		if (this == o) {                                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548 			return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549 		}                                                                                                      </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550 		if (o == null || getClass() != o.getClass()) {                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551 			return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552 		}                                                                                                      </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553 		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                              </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 554 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);"> 554 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString)</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557 	@Override                                                                                               </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558 	public int hashCode() {                                                                                 </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559 		return Objects.hash(recordClazz, schemaString);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561                                                                                                          </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562 	// --------------------------------------------------------------------------------------------         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563                                                                                                          </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564 	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565                                                                                                          </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566 		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                   </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567 				.stream()                                                                                            </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568 				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                            </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569 				.collect(Collectors.toList());                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570                                                                                                          </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571 		final int length = fields.size();                                                                      </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572 		final GenericRecord record = new GenericData.Record(schema);                                           </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573 		for (int i = 0; i &lt; length; i++) {                                                                     </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574 			final Schema.Field field = fields.get(i);                                                             </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575 			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576 		}                                                                                                      </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577 		return record;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579                                                                                                          </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580 	private Object convertFlinkType(Schema schema, Object object) {                                         </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581 		if (object == null) {                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582 			return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583 		}                                                                                                      </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584 		switch (schema.getType()) {                                                                            </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585 			case RECORD:                                                                                          </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586 				if (object instanceof Row) {                                                                         </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587 					return convertRowToAvroRecord(schema, (Row) object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588 				}                                                                                                    </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589 				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                       </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590 			case ENUM:                                                                                            </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591 				return new GenericData.EnumSymbol(schema, object.toString());                                        </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592 			case ARRAY:                                                                                           </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593 				final Schema elementSchema = schema.getElementType();                                                </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594 				final Object[] array = (Object[]) object;                                                            </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595 				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);      </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596 				for (Object element : array) {                                                                       </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597 					convertedArray.add(convertFlinkType(elementSchema, element));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598 				}                                                                                                    </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599 				return convertedArray;                                                                               </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600 			case MAP:                                                                                             </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601 				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                            </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602 				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                              </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603 				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                       </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604 					convertedMap.put(                                                                                   </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605 						new Utf8(entry.getKey().toString()),                                                               </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 606 						convertFlinkType(schema.getValueType(), entry.getValue()));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607 				}                                                                                                    </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608 				return convertedMap;                                                                                 </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609 			case UNION:                                                                                           </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610 				final List&lt;Schema&gt; types = schema.getTypes();                                                        </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611 				final int size = types.size();                                                                       </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612 				final Schema actualSchema;                                                                           </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613 				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                       </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 614 					actualSchema = types.get(1);                                                                        </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615 				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616 					actualSchema = types.get(0);                                                                        </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617 				} else if (size == 1) {                                                                              </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618 					actualSchema = types.get(0);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619 				} else {                                                                                             </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620 					// generic type                                                                                     </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621 					return object;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622 				}                                                                                                    </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623 				return convertFlinkType(actualSchema, object);                                                       </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624 			case FIXED:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627 					return new GenericData.Fixed(                                                                       </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628 						schema,                                                                                            </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629 						convertFromDecimal(schema, (BigDecimal) object));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630 				}                                                                                                    </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631 				return new GenericData.Fixed(schema, (byte[]) object);                                               </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632 			case STRING:                                                                                          </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633 				return new Utf8(object.toString());                                                                  </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634 			case BYTES:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637 					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638 				}                                                                                                    </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639 				return ByteBuffer.wrap((byte[]) object);                                                             </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640 			case INT:                                                                                             </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641 				// check for logical types                                                                           </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642 				if (object instanceof Date) {                                                                        </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643 					return convertFromDate(schema, (Date) object);                                                      </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644 				} else if (object instanceof Time) {                                                                 </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645 					return convertFromTime(schema, (Time) object);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647 				return object;                                                                                       </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648 			case LONG:                                                                                            </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649 				// check for logical type                                                                            </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650 				if (object instanceof Timestamp) {                                                                   </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651 					return convertFromTimestamp(schema, (Timestamp) object);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653 				return object;                                                                                       </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654 			case FLOAT:                                                                                           </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655 			case DOUBLE:                                                                                          </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656 			case BOOLEAN:                                                                                         </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657 				return object;                                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658 			default:                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 659 		}                                                                                                      </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 660 		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662                                                                                                          </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663 	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                  </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665 		if (logicalType instanceof LogicalTypes.Decimal) {                                                     </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666 			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                          </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667 			// rescale to target type                                                                             </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668 			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);   </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669 			// byte array must contain the two&#x27;s-complement representation of the                                 </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670 			// unscaled integer value in big-endian byte order                                                    </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671 			return decimal.unscaledValue().toByteArray();                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672 		} else {                                                                                               </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673 			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 674 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                                                                                                          </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677 	private int convertFromDate(Schema schema, Date date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679 		if (logicalType == LogicalTypes.date()) {                                                              </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683 			return (int) (converted / 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684 		} else {                                                                                               </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685 			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688                                                                                                          </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689 	private int convertFromTime(Schema schema, Time date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691 		if (logicalType == LogicalTypes.timeMillis()) {                                                        </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695 			return (int) (converted % 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696 		} else {                                                                                               </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697 			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                                                                                                          </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701 	private long convertFromTimestamp(Schema schema, Timestamp date) {                                      </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703 		if (logicalType == LogicalTypes.timestampMillis()) {                                                   </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705 			final long time = date.getTime();                                                                     </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 706 			return time + (long) LOCAL_TZ.getOffset(time);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707 		} else {                                                                                               </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708 			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711                                                                                                          </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712 	private void writeObject(ObjectOutputStream outputStream) throws IOException {                          </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713 		outputStream.writeObject(recordClazz);                                                                 </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714 		outputStream.writeObject(schemaString); // support for null                                            </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715 		outputStream.writeObject(retractKey);                                                                  </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716 		outputStream.writeObject(updateMode);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718                                                                                                          </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719 	@SuppressWarnings(&quot;unchecked&quot;)                                                                          </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720 	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {     </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721 		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                              </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722 		schemaString = (String) inputStream.readObject();                                                      </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 723 		if (recordClazz != null) {                                                                             </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724 			schema = SpecificData.get().getSchema(recordClazz);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725 		} else {                                                                                               </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726 			schema = new Schema.Parser().parse(schemaString);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727 		}                                                                                                      </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728 		retractKey = (String) inputStream.readObject();                                                        </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729 		updateMode = (String) inputStream.readObject();                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                                                                                                          </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731 		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                       </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732 		arrayOutputStream = new ByteArrayOutputStream();                                                       </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733 		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734 	}                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 735 }                                                                                                        </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 736 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span></pre></td>
                            <td><pre><span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">   4 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   5                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   6 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   7  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   8  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   9  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  10  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  11  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  12  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  13  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  14  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  15  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  16  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  17  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  18  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  19  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  20  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  21  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  22  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  23                                                                                                          </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  24 package com.dtstack.flink.sql.sink.kafka.serialization;                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  25                                                                                                          </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  26 import com.dtstack.flink.sql.enums.EUpdateMode;                                                          </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  27 import org.apache.avro.LogicalType;                                                                      </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  28 import org.apache.avro.LogicalTypes;                                                                     </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  29 import org.apache.avro.Schema;                                                                           </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  30 import org.apache.avro.SchemaParseException;                                                             </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  31 import org.apache.avro.generic.GenericData;                                                              </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32 import org.apache.avro.generic.GenericDatumWriter;                                                       </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import org.apache.avro.generic.GenericRecord;                                                            </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34 import org.apache.avro.generic.IndexedRecord;                                                            </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import org.apache.avro.io.DatumWriter;                                                                   </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36 import org.apache.avro.io.Encoder;                                                                       </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import org.apache.avro.io.EncoderFactory;                                                                </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import org.apache.avro.specific.SpecificData;                                                            </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  39 import org.apache.avro.specific.SpecificDatumWriter;                                                     </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  40 import org.apache.avro.specific.SpecificRecord;                                                          </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  41 import org.apache.avro.util.Utf8;                                                                        </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  43 import org.apache.flink.api.common.serialization.SerializationSchema;                                    </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  44 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  45 import org.apache.flink.types.Row;                                                                       </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  46 import org.apache.flink.util.Preconditions;                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  47                                                                                                          </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  48 import java.io.ByteArrayOutputStream;                                                                    </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  49 import java.io.IOException;                                                                              </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  50 import java.io.ObjectInputStream;                                                                        </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51 import java.io.ObjectOutputStream;                                                                       </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52 import java.math.BigDecimal;                                                                             </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  53 import java.nio.ByteBuffer;                                                                              </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  54 import java.sql.Date;                                                                                    </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55 import java.sql.Time;                                                                                    </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56 import java.sql.Timestamp;                                                                               </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  57 import java.util.HashMap;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59 import java.util.Map;                                                                                    </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  60 import java.util.Objects;                                                                                </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61 import java.util.TimeZone;                                                                               </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62 import java.util.stream.Collectors;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64 /**                                                                                                      </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65  * Serialization schema that serializes CROW into Avro bytes.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66  *                                                                                                       </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67  * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that              </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  68  * are compatible with Flink&#x27;s Table &amp; SQL API.                                                          </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69  **                                                                                                      </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  70  * @author  maqi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  71  */                                                                                                      </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72 public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  73                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  74 	/**                                                                                                     </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  75 	 * Used for time conversions from SQL types.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  76 	 */                                                                                                     </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  77 	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  78                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  79 	/**                                                                                                     </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  80 	 * Avro record class for serialization. Might be null if record class is not available.                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81 	 */                                                                                                     </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  82 	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  84 	/**                                                                                                     </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  85 	 * Schema string for deserialization.                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  86 	 */                                                                                                     </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  87 	private String schemaString;                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89 	/**                                                                                                     </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  90 	 * Avro serialization schema.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91 	 */                                                                                                     </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  92 	private transient Schema schema;                                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94 	/**                                                                                                     </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95 	 * Writer to serialize Avro record into a byte array.                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  96 	 */                                                                                                     </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  97 	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  98                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  99 	/**                                                                                                     </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 100 	 * Output stream to serialize records into byte array.                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 101 	 */                                                                                                     </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102 	private transient ByteArrayOutputStream arrayOutputStream;                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 103                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 104 	/**                                                                                                     </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105 	 * Low-level class for serialization of Avro values.                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106 	 */                                                                                                     </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107 	private transient Encoder encoder;                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108                                                                                                          </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109 	private String updateMode;                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110                                                                                                          </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111 	private String retractKey = &quot;retract&quot;;                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113 	/**                                                                                                     </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114 	 * Creates an Avro serialization schema for the given specific record class.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115 	 *                                                                                                      </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116 	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117 	 */                                                                                                     </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118 	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {    </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119 		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                        </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120 		this.recordClazz = recordClazz;                                                                        </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121 		this.schema = SpecificData.get().getSchema(recordClazz);                                               </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122 		this.schemaString = schema.toString();                                                                 </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123 		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                  </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129 	/**                                                                                                     </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130 	 * Creates an Avro serialization schema for the given Avro schema string.                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131 	 *                                                                                                      </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132 	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133 	 */                                                                                                     </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134 	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                         </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135 		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                         </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136 		this.recordClazz = null;                                                                               </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137 		this.schemaString = avroSchemaString;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138 		try {                                                                                                  </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139 			this.schema = new Schema.Parser().parse(avroSchemaString);                                            </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140 		} catch (SchemaParseException e) {                                                                     </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141 			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142 		}                                                                                                      </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143 		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                   </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144 		this.arrayOutputStream = new ByteArrayOutputStream();                                                  </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145 		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                            </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146 		this.updateMode = updateMode;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149 	@Override                                                                                               </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150 	public byte[] serialize(CRow crow) {                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151 		try {                                                                                                  </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152 			Row row = crow.row();                                                                                 </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153 			boolean change = crow.change();                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                                                                                                          </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155 			// convert to record                                                                                  </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156 			final GenericRecord record = convertRowToAvroRecord(schema, row);                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157                                                                                                          </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158 			dealRetractField(change, record);                                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159                                                                                                          </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160 			arrayOutputStream.reset();                                                                            </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161 			datumWriter.write(record, encoder);                                                                   </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162 			encoder.flush();                                                                                      </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163 			return arrayOutputStream.toByteArray();                                                               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164 		} catch (Exception e) {                                                                                </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165 			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168                                                                                                          </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169 	protected void dealRetractField(boolean change, GenericRecord record) {                                 </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170 		schema.getFields()                                                                                     </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171 				.stream()                                                                                            </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172 				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                             </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173 				.findFirst()                                                                                         </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174 				.ifPresent(field -&gt; {                                                                                </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175 					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                          </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176 						record.put(retractKey, convertFlinkType(field.schema(), change));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177 					}                                                                                                   </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178 				});                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181 	@Override                                                                                               </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182 	public boolean equals(Object o) {                                                                       </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183 		if (this == o) {                                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184 			return true;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185 		}                                                                                                      </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186 		if (o == null || getClass() != o.getClass()) {                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187 			return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 188 		}                                                                                                      </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189 		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                              </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 190 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);"> 190 		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString)</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 192                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193 	@Override                                                                                               </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194 	public int hashCode() {                                                                                 </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195 		return Objects.hash(recordClazz, schemaString);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197                                                                                                          </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198 	// --------------------------------------------------------------------------------------------         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199                                                                                                          </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200 	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201                                                                                                          </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202 		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                   </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203 				.stream()                                                                                            </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204 				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                            </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 205 				.collect(Collectors.toList());                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 206                                                                                                          </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 207 		final int length = fields.size();                                                                      </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208 		final GenericRecord record = new GenericData.Record(schema);                                           </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209 		for (int i = 0; i &lt; length; i++) {                                                                     </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210 			final Schema.Field field = fields.get(i);                                                             </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211 			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212 		}                                                                                                      </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213 		return record;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215                                                                                                          </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216 	private Object convertFlinkType(Schema schema, Object object) {                                         </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217 		if (object == null) {                                                                                  </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218 			return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219 		}                                                                                                      </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220 		switch (schema.getType()) {                                                                            </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221 			case RECORD:                                                                                          </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222 				if (object instanceof Row) {                                                                         </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223 					return convertRowToAvroRecord(schema, (Row) object);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224 				}                                                                                                    </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225 				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                       </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226 			case ENUM:                                                                                            </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227 				return new GenericData.EnumSymbol(schema, object.toString());                                        </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228 			case ARRAY:                                                                                           </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229 				final Schema elementSchema = schema.getElementType();                                                </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230 				final Object[] array = (Object[]) object;                                                            </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231 				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);      </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232 				for (Object element : array) {                                                                       </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233 					convertedArray.add(convertFlinkType(elementSchema, element));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234 				}                                                                                                    </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235 				return convertedArray;                                                                               </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236 			case MAP:                                                                                             </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237 				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                            </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238 				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                              </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239 				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                       </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240 					convertedMap.put(                                                                                   </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241 						new Utf8(entry.getKey().toString()),                                                               </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242 						convertFlinkType(schema.getValueType(), entry.getValue()));                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243 				}                                                                                                    </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244 				return convertedMap;                                                                                 </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245 			case UNION:                                                                                           </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246 				final List&lt;Schema&gt; types = schema.getTypes();                                                        </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247 				final int size = types.size();                                                                       </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248 				final Schema actualSchema;                                                                           </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249 				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                       </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250 					actualSchema = types.get(1);                                                                        </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251 				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252 					actualSchema = types.get(0);                                                                        </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253 				} else if (size == 1) {                                                                              </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254 					actualSchema = types.get(0);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255 				} else {                                                                                             </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256 					// generic type                                                                                     </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257 					return object;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258 				}                                                                                                    </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259 				return convertFlinkType(actualSchema, object);                                                       </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260 			case FIXED:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263 					return new GenericData.Fixed(                                                                       </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264 						schema,                                                                                            </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265 						convertFromDecimal(schema, (BigDecimal) object));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266 				}                                                                                                    </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267 				return new GenericData.Fixed(schema, (byte[]) object);                                               </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268 			case STRING:                                                                                          </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269 				return new Utf8(object.toString());                                                                  </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 270 			case BYTES:                                                                                           </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 271 				// check for logical type                                                                            </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 272 				if (object instanceof BigDecimal) {                                                                  </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 273 					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 274 				}                                                                                                    </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 275 				return ByteBuffer.wrap((byte[]) object);                                                             </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276 			case INT:                                                                                             </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277 				// check for logical types                                                                           </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278 				if (object instanceof Date) {                                                                        </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279 					return convertFromDate(schema, (Date) object);                                                      </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280 				} else if (object instanceof Time) {                                                                 </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281 					return convertFromTime(schema, (Time) object);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283 				return object;                                                                                       </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284 			case LONG:                                                                                            </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285 				// check for logical type                                                                            </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286 				if (object instanceof Timestamp) {                                                                   </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287 					return convertFromTimestamp(schema, (Timestamp) object);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288 				}                                                                                                    </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289 				return object;                                                                                       </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290 			case FLOAT:                                                                                           </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291 			case DOUBLE:                                                                                          </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292 			case BOOLEAN:                                                                                         </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293 				return object;                                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294 			default:                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295 		}                                                                                                      </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296 		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298                                                                                                          </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 299 	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                  </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301 		if (logicalType instanceof LogicalTypes.Decimal) {                                                     </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302 			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                          </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303 			// rescale to target type                                                                             </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304 			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);   </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305 			// byte array must contain the two&#x27;s-complement representation of the                                 </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306 			// unscaled integer value in big-endian byte order                                                    </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307 			return decimal.unscaledValue().toByteArray();                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308 		} else {                                                                                               </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309 			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 311 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312                                                                                                          </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313 	private int convertFromDate(Schema schema, Date date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315 		if (logicalType == LogicalTypes.date()) {                                                              </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319 			return (int) (converted / 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320 		} else {                                                                                               </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321 			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324                                                                                                          </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325 	private int convertFromTime(Schema schema, Time date) {                                                 </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327 		if (logicalType == LogicalTypes.timeMillis()) {                                                        </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329 			final long time = date.getTime();                                                                     </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330 			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                        </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331 			return (int) (converted % 86400000L);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332 		} else {                                                                                               </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333 			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336                                                                                                          </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337 	private long convertFromTimestamp(Schema schema, Timestamp date) {                                      </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338 		final LogicalType logicalType = schema.getLogicalType();                                               </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339 		if (logicalType == LogicalTypes.timestampMillis()) {                                                   </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340 			// adopted from Apache Calcite                                                                        </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341 			final long time = date.getTime();                                                                     </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342 			return time + (long) LOCAL_TZ.getOffset(time);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343 		} else {                                                                                               </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 344 			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 345 		}                                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 346 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 347                                                                                                          </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 348 	private void writeObject(ObjectOutputStream outputStream) throws IOException {                          </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 349 		outputStream.writeObject(recordClazz);                                                                 </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 350 		outputStream.writeObject(schemaString); // support for null                                            </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 351 		outputStream.writeObject(retractKey);                                                                  </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 352 		outputStream.writeObject(updateMode);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 353 	}                                                                                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 354                                                                                                          </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 355 	@SuppressWarnings(&quot;unchecked&quot;)                                                                          </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356 	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {     </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357 		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                              </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358 		schemaString = (String) inputStream.readObject();                                                      </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359 		if (recordClazz != null) {                                                                             </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360 			schema = SpecificData.get().getSchema(recordClazz);                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361 		} else {                                                                                               </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 362 			schema = new Schema.Parser().parse(schemaString);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 363 		}                                                                                                      </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364 		retractKey = (String) inputStream.readObject();                                                        </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365 		updateMode = (String) inputStream.readObject();                                                        </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366                                                                                                          </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 367 		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                       </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368 		arrayOutputStream = new ByteArrayOutputStream();                                                       </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369 		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370 	}                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371 }                                                                                                        </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 372 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>










































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   1 -/*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   2 - * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   3 - * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   4 - * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   5 - * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   6 - * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   7 - * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   8 - * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   9 - *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  10 - *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  11 - *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  12 - * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  13 - * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  14 - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  15 - * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  16 - * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  17 - */                                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  18 -                                                                                                                  </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -package com.dtstack.flink.sql.sink.kafka.serialization;                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -                                                                                                                  </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import com.dtstack.flink.sql.enums.EUpdateMode;                                                                   </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import org.apache.avro.LogicalType;                                                                               </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import org.apache.avro.LogicalTypes;                                                                              </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import org.apache.avro.Schema;                                                                                    </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import org.apache.avro.SchemaParseException;                                                                      </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import org.apache.avro.generic.GenericData;                                                                       </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import org.apache.avro.generic.GenericDatumWriter;                                                                </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import org.apache.avro.generic.GenericRecord;                                                                     </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import org.apache.avro.generic.IndexedRecord;                                                                     </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import org.apache.avro.io.DatumWriter;                                                                            </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import org.apache.avro.io.Encoder;                                                                                </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import org.apache.avro.io.EncoderFactory;                                                                         </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import org.apache.avro.specific.SpecificData;                                                                     </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import org.apache.avro.specific.SpecificDatumWriter;                                                              </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import org.apache.avro.specific.SpecificRecord;                                                                   </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import org.apache.avro.util.Utf8;                                                                                 </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import org.apache.flink.api.common.serialization.SerializationSchema;                                             </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import org.apache.flink.types.Row;                                                                                </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import org.apache.flink.util.Preconditions;                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -                                                                                                                  </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import java.io.ByteArrayOutputStream;                                                                             </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -import java.io.IOException;                                                                                       </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import java.io.ObjectInputStream;                                                                                 </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 -import java.io.ObjectOutputStream;                                                                                </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import java.math.BigDecimal;                                                                                      </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import java.nio.ByteBuffer;                                                                                       </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import java.sql.Date;                                                                                             </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import java.sql.Time;                                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -import java.sql.Timestamp;                                                                                        </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import java.util.Map;                                                                                             </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -import java.util.Objects;                                                                                         </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import java.util.Optional;                                                                                        </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -import java.util.TimeZone;                                                                                        </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -import java.util.stream.Collectors;                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -/**                                                                                                               </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 - * Serialization schema that serializes CROW into Avro bytes.                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 - *                                                                                                                </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 - * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that                       </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 - * are compatible with Flink&#x27;s Table &amp; SQL API.                                                                   </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 - **                                                                                                               </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 - * @author  maqi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 - */                                                                                                               </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -	/**                                                                                                              </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -	 * Used for time conversions from SQL types.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -	 */                                                                                                              </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -	/**                                                                                                              </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -	 * Avro record class for serialization. Might be null if record class is not available.                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -	 */                                                                                                              </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -	/**                                                                                                              </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -	 * Schema string for deserialization.                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -	 */                                                                                                              </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -	private String schemaString;                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -	/**                                                                                                              </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -	 * Avro serialization schema.                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -	 */                                                                                                              </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -	private transient Schema schema;                                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -	/**                                                                                                              </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -	 * Writer to serialize Avro record into a byte array.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -	 */                                                                                                              </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -	/**                                                                                                              </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -	 * Output stream to serialize records into byte array.                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -	 */                                                                                                              </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -	private transient ByteArrayOutputStream arrayOutputStream;                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -	/**                                                                                                              </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -	 * Low-level class for serialization of Avro values.                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -	 */                                                                                                              </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -	private transient Encoder encoder;                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                                                                                                                  </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -	private String updateMode;                                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -                                                                                                                  </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -	private String retractKey = &quot;retract&quot;;                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -	/**                                                                                                              </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -	 * Creates an Avro serialization schema for the given specific record class.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -	 *                                                                                                               </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -	 */                                                                                                              </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {             </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                                 </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -		this.recordClazz = recordClazz;                                                                                 </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -		this.schema = SpecificData.get().getSchema(recordClazz);                                                        </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -		this.schemaString = schema.toString();                                                                          </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                           </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -		this.arrayOutputStream = new ByteArrayOutputStream();                                                           </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                     </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -		this.updateMode = updateMode;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -	/**                                                                                                              </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -	 * Creates an Avro serialization schema for the given Avro schema string.                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -	 *                                                                                                               </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -	 */                                                                                                              </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                                  </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                                  </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -		this.recordClazz = null;                                                                                        </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -		this.schemaString = avroSchemaString;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -		try {                                                                                                           </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -			this.schema = new Schema.Parser().parse(avroSchemaString);                                                     </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -		} catch (SchemaParseException e) {                                                                              </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -		}                                                                                                               </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                            </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -		this.arrayOutputStream = new ByteArrayOutputStream();                                                           </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                     </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -		this.updateMode = updateMode;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -	@Override                                                                                                        </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -	public byte[] serialize(CRow crow) {                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -		try {                                                                                                           </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -			Row row = crow.row();                                                                                          </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -			boolean change = crow.change();                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -                                                                                                                  </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -			// convert to record                                                                                           </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -			final GenericRecord record = convertRowToAvroRecord(schema, row);                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -                                                                                                                  </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -			dealRetractField(change, record);                                                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -                                                                                                                  </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -			arrayOutputStream.reset();                                                                                     </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -			datumWriter.write(record, encoder);                                                                            </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -			encoder.flush();                                                                                               </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -			return arrayOutputStream.toByteArray();                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -		} catch (Exception e) {                                                                                         </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -                                                                                                                  </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -	protected void dealRetractField(boolean change, GenericRecord record) {                                          </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -		schema.getFields()                                                                                              </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -				.stream()                                                                                                     </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                                      </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -				.findFirst()                                                                                                  </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -				.ifPresent(field -&gt; {                                                                                         </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                                   </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -						record.put(retractKey, convertFlinkType(field.schema(), change));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -					}                                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -				});                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -	@Override                                                                                                        </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -	public boolean equals(Object o) {                                                                                </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -		if (this == o) {                                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -			return true;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -		}                                                                                                               </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -		if (o == null || getClass() != o.getClass()) {                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -			return false;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -		}                                                                                                               </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                                       </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -	@Override                                                                                                        </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -	public int hashCode() {                                                                                          </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -		return Objects.hash(recordClazz, schemaString);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                                                                                                                  </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -	// --------------------------------------------------------------------------------------------                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                                                                                                                  </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                                                                                                                  </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                            </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -				.stream()                                                                                                     </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                                     </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -				.collect(Collectors.toList());                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                                                                                                                  </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -		final int length = fields.size();                                                                               </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -		final GenericRecord record = new GenericData.Record(schema);                                                    </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -		for (int i = 0; i &lt; length; i++) {                                                                              </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -			final Schema.Field field = fields.get(i);                                                                      </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -		}                                                                                                               </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -		return record;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                                                                                                                  </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -	private Object convertFlinkType(Schema schema, Object object) {                                                  </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -		if (object == null) {                                                                                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -			return null;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -		}                                                                                                               </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -		switch (schema.getType()) {                                                                                     </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -			case RECORD:                                                                                                   </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -				if (object instanceof Row) {                                                                                  </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -					return convertRowToAvroRecord(schema, (Row) object);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -				}                                                                                                             </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                                </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -			case ENUM:                                                                                                     </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -				return new GenericData.EnumSymbol(schema, object.toString());                                                 </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -			case ARRAY:                                                                                                    </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -				final Schema elementSchema = schema.getElementType();                                                         </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -				final Object[] array = (Object[]) object;                                                                     </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);               </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -				for (Object element : array) {                                                                                </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -					convertedArray.add(convertFlinkType(elementSchema, element));                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -				}                                                                                                             </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -				return convertedArray;                                                                                        </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -			case MAP:                                                                                                      </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                                     </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                                       </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                                </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -					convertedMap.put(                                                                                            </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -						new Utf8(entry.getKey().toString()),                                                                        </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -						convertFlinkType(schema.getValueType(), entry.getValue()));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -				}                                                                                                             </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -				return convertedMap;                                                                                          </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -			case UNION:                                                                                                    </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -				final List&lt;Schema&gt; types = schema.getTypes();                                                                 </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -				final int size = types.size();                                                                                </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -				final Schema actualSchema;                                                                                    </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                                </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -					actualSchema = types.get(1);                                                                                 </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                         </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -					actualSchema = types.get(0);                                                                                 </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -				} else if (size == 1) {                                                                                       </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -					actualSchema = types.get(0);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -				} else {                                                                                                      </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -					// generic type                                                                                              </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -					return object;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -				}                                                                                                             </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -				return convertFlinkType(actualSchema, object);                                                                </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -			case FIXED:                                                                                                    </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -				// check for logical type                                                                                     </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -				if (object instanceof BigDecimal) {                                                                           </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -					return new GenericData.Fixed(                                                                                </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -						schema,                                                                                                     </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -						convertFromDecimal(schema, (BigDecimal) object));                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -				}                                                                                                             </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -				return new GenericData.Fixed(schema, (byte[]) object);                                                        </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -			case STRING:                                                                                                   </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -				return new Utf8(object.toString());                                                                           </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -			case BYTES:                                                                                                    </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -				// check for logical type                                                                                     </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -				if (object instanceof BigDecimal) {                                                                           </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -				}                                                                                                             </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -				return ByteBuffer.wrap((byte[]) object);                                                                      </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -			case INT:                                                                                                      </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -				// check for logical types                                                                                    </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -				if (object instanceof Date) {                                                                                 </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -					return convertFromDate(schema, (Date) object);                                                               </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -				} else if (object instanceof Time) {                                                                          </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -					return convertFromTime(schema, (Time) object);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -				}                                                                                                             </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -				return object;                                                                                                </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -			case LONG:                                                                                                     </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -				// check for logical type                                                                                     </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -				if (object instanceof Timestamp) {                                                                            </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -					return convertFromTimestamp(schema, (Timestamp) object);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -				}                                                                                                             </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -				return object;                                                                                                </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -			case FLOAT:                                                                                                    </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -			case DOUBLE:                                                                                                   </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -			case BOOLEAN:                                                                                                  </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -				return object;                                                                                                </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -		}                                                                                                               </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -                                                                                                                  </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                           </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -		if (logicalType instanceof LogicalTypes.Decimal) {                                                              </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                                   </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -			// rescale to target type                                                                                      </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);            </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -			// byte array must contain the two&#x27;s-complement representation of the                                          </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -			// unscaled integer value in big-endian byte order                                                             </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -			return decimal.unscaledValue().toByteArray();                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -		} else {                                                                                                        </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -                                                                                                                  </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -	private int convertFromDate(Schema schema, Date date) {                                                          </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 309 -		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -		if (logicalType == LogicalTypes.date()) {                                                                       </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -			final long time = date.getTime();                                                                              </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                                 </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -			return (int) (converted / 86400000L);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -		} else {                                                                                                        </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 316 -			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 317 -		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 319 -                                                                                                                  </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 320 -	private int convertFromTime(Schema schema, Time date) {                                                          </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 321 -		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 322 -		if (logicalType == LogicalTypes.timeMillis()) {                                                                 </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 323 -			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 324 -			final long time = date.getTime();                                                                              </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 325 -			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                                 </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 326 -			return (int) (converted % 86400000L);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 327 -		} else {                                                                                                        </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 328 -			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 329 -		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 330 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 331 -                                                                                                                  </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 332 -	private long convertFromTimestamp(Schema schema, Timestamp date) {                                               </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 333 -		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 334 -		if (logicalType == LogicalTypes.timestampMillis()) {                                                            </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 335 -			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -			final long time = date.getTime();                                                                              </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 337 -			return time + (long) LOCAL_TZ.getOffset(time);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 338 -		} else {                                                                                                        </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 339 -			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 340 -		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 342 -                                                                                                                  </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 343 -	private void writeObject(ObjectOutputStream outputStream) throws IOException {                                   </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 344 -		outputStream.writeObject(recordClazz);                                                                          </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 345 -		outputStream.writeObject(schemaString); // support for null                                                     </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 346 -		outputStream.writeObject(retractKey);                                                                           </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 347 -		outputStream.writeObject(updateMode);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 348 -	}                                                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 349 -                                                                                                                  </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 350 -	@SuppressWarnings(&quot;unchecked&quot;)                                                                                   </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 351 -	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {              </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 352 -		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                                       </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 353 -		schemaString = (String) inputStream.readObject();                                                               </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 354 -		if (recordClazz != null) {                                                                                      </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 355 -			schema = SpecificData.get().getSchema(recordClazz);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 356 -		} else {                                                                                                        </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 357 -			schema = new Schema.Parser().parse(schemaString);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 358 -		}                                                                                                               </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 359 -		retractKey = (String) inputStream.readObject();                                                                 </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 360 -		updateMode = (String) inputStream.readObject();                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 361 -                                                                                                                  </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 362 -		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                                </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 363 -		arrayOutputStream = new ByteArrayOutputStream();                                                                </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 364 -		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 365 -	}                                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 366 -}                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-3498024646272898801" onmouseenter="enter('-3498024646272898801');" onmouseout="out('-3498024646272898801');" style="">  19  package com.dtstack.flink.sql.sink.kafka.serialization;                                                           </span>
<span  style="">  20                                                                                                                    </span>
<span class="-4800595592392942650" onmouseenter="enter('-4800595592392942650');" onmouseout="out('-4800595592392942650');" style="">  21  import com.dtstack.flink.sql.enums.EUpdateMode;                                                                   </span>
<span class="2202751034403953295" onmouseenter="enter('2202751034403953295');" onmouseout="out('2202751034403953295');" style="">  22  import org.apache.avro.LogicalType;                                                                               </span>
<span class="6782062480642133926" onmouseenter="enter('6782062480642133926');" onmouseout="out('6782062480642133926');" style="">  23  import org.apache.avro.LogicalTypes;                                                                              </span>
<span class="-8399162993278240435" onmouseenter="enter('-8399162993278240435');" onmouseout="out('-8399162993278240435');" style="">  24  import org.apache.avro.Schema;                                                                                    </span>
<span class="1021043647714657525" onmouseenter="enter('1021043647714657525');" onmouseout="out('1021043647714657525');" style="">  25  import org.apache.avro.SchemaParseException;                                                                      </span>
<span class="-7125740831912708201" onmouseenter="enter('-7125740831912708201');" onmouseout="out('-7125740831912708201');" style="">  26  import org.apache.avro.generic.GenericData;                                                                       </span>
<span class="2547277094572294920" onmouseenter="enter('2547277094572294920');" onmouseout="out('2547277094572294920');" style="">  27  import org.apache.avro.generic.GenericDatumWriter;                                                                </span>
<span class="-3021922753422237996" onmouseenter="enter('-3021922753422237996');" onmouseout="out('-3021922753422237996');" style="">  28  import org.apache.avro.generic.GenericRecord;                                                                     </span>
<span class="5606235901179046496" onmouseenter="enter('5606235901179046496');" onmouseout="out('5606235901179046496');" style="">  29  import org.apache.avro.generic.IndexedRecord;                                                                     </span>
<span class="-3785734254767455822" onmouseenter="enter('-3785734254767455822');" onmouseout="out('-3785734254767455822');" style="">  30  import org.apache.avro.io.DatumWriter;                                                                            </span>
<span class="6713670363802323528" onmouseenter="enter('6713670363802323528');" onmouseout="out('6713670363802323528');" style="">  31  import org.apache.avro.io.Encoder;                                                                                </span>
<span class="-2702360690377967551" onmouseenter="enter('-2702360690377967551');" onmouseout="out('-2702360690377967551');" style="">  32  import org.apache.avro.io.EncoderFactory;                                                                         </span>
<span class="-854996312722270248" onmouseenter="enter('-854996312722270248');" onmouseout="out('-854996312722270248');" style="">  33  import org.apache.avro.specific.SpecificData;                                                                     </span>
<span class="-3242439332286924468" onmouseenter="enter('-3242439332286924468');" onmouseout="out('-3242439332286924468');" style="">  34  import org.apache.avro.specific.SpecificDatumWriter;                                                              </span>
<span class="5249758895792355586" onmouseenter="enter('5249758895792355586');" onmouseout="out('5249758895792355586');" style="">  35  import org.apache.avro.specific.SpecificRecord;                                                                   </span>
<span class="-923494589831643534" onmouseenter="enter('-923494589831643534');" onmouseout="out('-923494589831643534');" style="">  36  import org.apache.avro.util.Utf8;                                                                                 </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  37  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="1477528948785100292" onmouseenter="enter('1477528948785100292');" onmouseout="out('1477528948785100292');" style="">  38  import org.apache.flink.api.common.serialization.SerializationSchema;                                             </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  39  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  40  import org.apache.flink.types.Row;                                                                                </span>
<span class="-6095686798359729307" onmouseenter="enter('-6095686798359729307');" onmouseout="out('-6095686798359729307');" style="">  41  import org.apache.flink.util.Preconditions;                                                                       </span>
<span  style="">  42                                                                                                                    </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="">  43  import java.io.ByteArrayOutputStream;                                                                             </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  44  import java.io.IOException;                                                                                       </span>
<span class="904483402704815380" onmouseenter="enter('904483402704815380');" onmouseout="out('904483402704815380');" style="">  45  import java.io.ObjectInputStream;                                                                                 </span>
<span class="4860998856400570471" onmouseenter="enter('4860998856400570471');" onmouseout="out('4860998856400570471');" style="">  46  import java.io.ObjectOutputStream;                                                                                </span>
<span class="2075466404860203191" onmouseenter="enter('2075466404860203191');" onmouseout="out('2075466404860203191');" style="">  47  import java.math.BigDecimal;                                                                                      </span>
<span class="-6886346622632588502" onmouseenter="enter('-6886346622632588502');" onmouseout="out('-6886346622632588502');" style="">  48  import java.nio.ByteBuffer;                                                                                       </span>
<span class="1087779258768580972" onmouseenter="enter('1087779258768580972');" onmouseout="out('1087779258768580972');" style="">  49  import java.sql.Date;                                                                                             </span>
<span class="4170508639436593031" onmouseenter="enter('4170508639436593031');" onmouseout="out('4170508639436593031');" style="">  50  import java.sql.Time;                                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  51  import java.sql.Timestamp;                                                                                        </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  52  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  53  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  54  import java.util.Map;                                                                                             </span>
<span class="6306724220981822255" onmouseenter="enter('6306724220981822255');" onmouseout="out('6306724220981822255');" style="">  55  import java.util.Objects;                                                                                         </span>
<span class="-4914279600566636630" onmouseenter="enter('-4914279600566636630');" onmouseout="out('-4914279600566636630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -import java.util.Optional;                                                                                        </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  57  import java.util.TimeZone;                                                                                        </span>
<span class="-6051894930872477589" onmouseenter="enter('-6051894930872477589');" onmouseout="out('-6051894930872477589');" style="">  58  import java.util.stream.Collectors;                                                                               </span>
<span  style="">  59                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  60  /**                                                                                                               </span>
<span class="8049489790672809464" onmouseenter="enter('8049489790672809464');" onmouseout="out('8049489790672809464');" style="">  61   * Serialization schema that serializes CROW into Avro bytes.                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  62   *                                                                                                                </span>
<span class="-5539101477732733795" onmouseenter="enter('-5539101477732733795');" onmouseout="out('-5539101477732733795');" style="">  63   * &lt;p&gt;Serializes objects that are represented in (nested) Flink rows. It support types that                       </span>
<span class="4826080038688804776" onmouseenter="enter('4826080038688804776');" onmouseout="out('4826080038688804776');" style="">  64   * are compatible with Flink&#x27;s Table &amp; SQL API.                                                                   </span>
<span class="4039159361941272656" onmouseenter="enter('4039159361941272656');" onmouseout="out('4039159361941272656');" style="">  65   **                                                                                                               </span>
<span class="326082977873797166" onmouseenter="enter('326082977873797166');" onmouseout="out('326082977873797166');" style="">  66   * @author  maqi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  67   */                                                                                                               </span>
<span class="-2369039919703816347" onmouseenter="enter('-2369039919703816347');" onmouseout="out('-2369039919703816347');" style="">  68  public class AvroCRowSerializationSchema implements SerializationSchema&lt;CRow&gt; {                                   </span>
<span  style="">  69                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  70  	/**                                                                                                              </span>
<span class="5917933991080233200" onmouseenter="enter('5917933991080233200');" onmouseout="out('5917933991080233200');" style="">  71  	 * Used for time conversions from SQL types.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  72  	 */                                                                                                              </span>
<span class="2989253342565506687" onmouseenter="enter('2989253342565506687');" onmouseout="out('2989253342565506687');" style="">  73  	private static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                                  </span>
<span  style="">  74                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  75  	/**                                                                                                              </span>
<span class="-9077284269577618620" onmouseenter="enter('-9077284269577618620');" onmouseout="out('-9077284269577618620');" style="">  76  	 * Avro record class for serialization. Might be null if record class is not available.                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  77  	 */                                                                                                              </span>
<span class="-3727536991637995886" onmouseenter="enter('-3727536991637995886');" onmouseout="out('-3727536991637995886');" style="">  78  	private Class&lt;? extends SpecificRecord&gt; recordClazz;                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  80  	/**                                                                                                              </span>
<span class="2062211722606634761" onmouseenter="enter('2062211722606634761');" onmouseout="out('2062211722606634761');" style="">  81  	 * Schema string for deserialization.                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  82  	 */                                                                                                              </span>
<span class="-6050108517842366000" onmouseenter="enter('-6050108517842366000');" onmouseout="out('-6050108517842366000');" style="">  83  	private String schemaString;                                                                                     </span>
<span  style="">  84                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  85  	/**                                                                                                              </span>
<span class="-6839177935166428630" onmouseenter="enter('-6839177935166428630');" onmouseout="out('-6839177935166428630');" style="">  86  	 * Avro serialization schema.                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87  	 */                                                                                                              </span>
<span class="-343226635153594576" onmouseenter="enter('-343226635153594576');" onmouseout="out('-343226635153594576');" style="">  88  	private transient Schema schema;                                                                                 </span>
<span  style="">  89                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  90  	/**                                                                                                              </span>
<span class="5060932546537229658" onmouseenter="enter('5060932546537229658');" onmouseout="out('5060932546537229658');" style="">  91  	 * Writer to serialize Avro record into a byte array.                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  92  	 */                                                                                                              </span>
<span class="-5589314620047996869" onmouseenter="enter('-5589314620047996869');" onmouseout="out('-5589314620047996869');" style="">  93  	private transient DatumWriter&lt;IndexedRecord&gt; datumWriter;                                                        </span>
<span  style="">  94                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95  	/**                                                                                                              </span>
<span class="8545633289178888410" onmouseenter="enter('8545633289178888410');" onmouseout="out('8545633289178888410');" style="">  96  	 * Output stream to serialize records into byte array.                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97  	 */                                                                                                              </span>
<span class="-7038553115786963040" onmouseenter="enter('-7038553115786963040');" onmouseout="out('-7038553115786963040');" style="">  98  	private transient ByteArrayOutputStream arrayOutputStream;                                                       </span>
<span  style="">  99                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 100  	/**                                                                                                              </span>
<span class="2484267689487972833" onmouseenter="enter('2484267689487972833');" onmouseout="out('2484267689487972833');" style=""> 101  	 * Low-level class for serialization of Avro values.                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 102  	 */                                                                                                              </span>
<span class="-7772644439975092828" onmouseenter="enter('-7772644439975092828');" onmouseout="out('-7772644439975092828');" style=""> 103  	private transient Encoder encoder;                                                                               </span>
<span  style=""> 104                                                                                                                    </span>
<span class="870437353868335199" onmouseenter="enter('870437353868335199');" onmouseout="out('870437353868335199');" style=""> 105  	private String updateMode;                                                                                       </span>
<span  style=""> 106                                                                                                                    </span>
<span class="3631356630106170612" onmouseenter="enter('3631356630106170612');" onmouseout="out('3631356630106170612');" style=""> 107  	private String retractKey = &quot;retract&quot;;                                                                           </span>
<span  style=""> 108                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 109  	/**                                                                                                              </span>
<span class="-2281413945331837779" onmouseenter="enter('-2281413945331837779');" onmouseout="out('-2281413945331837779');" style=""> 110  	 * Creates an Avro serialization schema for the given specific record class.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 111  	 *                                                                                                               </span>
<span class="-7879450516357498518" onmouseenter="enter('-7879450516357498518');" onmouseout="out('-7879450516357498518');" style=""> 112  	 * @param recordClazz Avro record class used to serialize Flink&#x27;s row to Avro&#x27;s record                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 113  	 */                                                                                                              </span>
<span class="-1228589410227438323" onmouseenter="enter('-1228589410227438323');" onmouseout="out('-1228589410227438323');" style=""> 114  	public AvroCRowSerializationSchema(Class&lt;? extends SpecificRecord&gt; recordClazz, String updateMode) {             </span>
<span class="3650966603322164207" onmouseenter="enter('3650966603322164207');" onmouseout="out('3650966603322164207');" style=""> 115  		Preconditions.checkNotNull(recordClazz, &quot;Avro record class must not be null.&quot;);                                 </span>
<span class="-8350622561232485354" onmouseenter="enter('-8350622561232485354');" onmouseout="out('-8350622561232485354');" style=""> 116  		this.recordClazz = recordClazz;                                                                                 </span>
<span class="-1096252960457347060" onmouseenter="enter('-1096252960457347060');" onmouseout="out('-1096252960457347060');" style=""> 117  		this.schema = SpecificData.get().getSchema(recordClazz);                                                        </span>
<span class="-2625732914557958394" onmouseenter="enter('-2625732914557958394');" onmouseout="out('-2625732914557958394');" style=""> 118  		this.schemaString = schema.toString();                                                                          </span>
<span class="-3622882874412601413" onmouseenter="enter('-3622882874412601413');" onmouseout="out('-3622882874412601413');" style=""> 119  		this.datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                           </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style=""> 120  		this.arrayOutputStream = new ByteArrayOutputStream();                                                           </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style=""> 121  		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                     </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style=""> 122  		this.updateMode = updateMode;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123  	}                                                                                                                </span>
<span  style=""> 124                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 125  	/**                                                                                                              </span>
<span class="-467390524325559292" onmouseenter="enter('-467390524325559292');" onmouseout="out('-467390524325559292');" style=""> 126  	 * Creates an Avro serialization schema for the given Avro schema string.                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 127  	 *                                                                                                               </span>
<span class="-2300599789592224177" onmouseenter="enter('-2300599789592224177');" onmouseout="out('-2300599789592224177');" style=""> 128  	 * @param avroSchemaString Avro schema string used to serialize Flink&#x27;s row to Avro&#x27;s record                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 129  	 */                                                                                                              </span>
<span class="-1526433733416811887" onmouseenter="enter('-1526433733416811887');" onmouseout="out('-1526433733416811887');" style=""> 130  	public AvroCRowSerializationSchema(String avroSchemaString,String updateMode) {                                  </span>
<span class="2826280929962382850" onmouseenter="enter('2826280929962382850');" onmouseout="out('2826280929962382850');" style=""> 131  		Preconditions.checkNotNull(avroSchemaString, &quot;Avro schema must not be null.&quot;);                                  </span>
<span class="-3463441605234026468" onmouseenter="enter('-3463441605234026468');" onmouseout="out('-3463441605234026468');" style=""> 132  		this.recordClazz = null;                                                                                        </span>
<span class="3324994020403602855" onmouseenter="enter('3324994020403602855');" onmouseout="out('3324994020403602855');" style=""> 133  		this.schemaString = avroSchemaString;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 134  		try {                                                                                                           </span>
<span class="-3831342042395479217" onmouseenter="enter('-3831342042395479217');" onmouseout="out('-3831342042395479217');" style=""> 135  			this.schema = new Schema.Parser().parse(avroSchemaString);                                                     </span>
<span class="-2265278939103354743" onmouseenter="enter('-2265278939103354743');" onmouseout="out('-2265278939103354743');" style=""> 136  		} catch (SchemaParseException e) {                                                                              </span>
<span class="-6598347335193682836" onmouseenter="enter('-6598347335193682836');" onmouseout="out('-6598347335193682836');" style=""> 137  			throw new IllegalArgumentException(&quot;Could not parse Avro schema string.&quot;, e);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138  		}                                                                                                               </span>
<span class="-3343030031898467644" onmouseenter="enter('-3343030031898467644');" onmouseout="out('-3343030031898467644');" style=""> 139  		this.datumWriter = new GenericDatumWriter&lt;&gt;(schema);                                                            </span>
<span class="-5624538139196779330" onmouseenter="enter('-5624538139196779330');" onmouseout="out('-5624538139196779330');" style=""> 140  		this.arrayOutputStream = new ByteArrayOutputStream();                                                           </span>
<span class="-9132743629716930631" onmouseenter="enter('-9132743629716930631');" onmouseout="out('-9132743629716930631');" style=""> 141  		this.encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                     </span>
<span class="8966356556296304754" onmouseenter="enter('8966356556296304754');" onmouseout="out('8966356556296304754');" style=""> 142  		this.updateMode = updateMode;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143  	}                                                                                                                </span>
<span  style=""> 144                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 145  	@Override                                                                                                        </span>
<span class="5568608459150122006" onmouseenter="enter('5568608459150122006');" onmouseout="out('5568608459150122006');" style=""> 146  	public byte[] serialize(CRow crow) {                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 147  		try {                                                                                                           </span>
<span class="-3373138779146894116" onmouseenter="enter('-3373138779146894116');" onmouseout="out('-3373138779146894116');" style=""> 148  			Row row = crow.row();                                                                                          </span>
<span class="-6159172825016698815" onmouseenter="enter('-6159172825016698815');" onmouseout="out('-6159172825016698815');" style=""> 149  			boolean change = crow.change();                                                                                </span>
<span  style=""> 150                                                                                                                    </span>
<span class="2659895488103747634" onmouseenter="enter('2659895488103747634');" onmouseout="out('2659895488103747634');" style=""> 151  			// convert to record                                                                                           </span>
<span class="-7548498198003067126" onmouseenter="enter('-7548498198003067126');" onmouseout="out('-7548498198003067126');" style=""> 152  			final GenericRecord record = convertRowToAvroRecord(schema, row);                                              </span>
<span  style=""> 153                                                                                                                    </span>
<span class="5881383631169002576" onmouseenter="enter('5881383631169002576');" onmouseout="out('5881383631169002576');" style=""> 154  			dealRetractField(change, record);                                                                              </span>
<span  style=""> 155                                                                                                                    </span>
<span class="2872685700896677902" onmouseenter="enter('2872685700896677902');" onmouseout="out('2872685700896677902');" style=""> 156  			arrayOutputStream.reset();                                                                                     </span>
<span class="-9000246319512894277" onmouseenter="enter('-9000246319512894277');" onmouseout="out('-9000246319512894277');" style=""> 157  			datumWriter.write(record, encoder);                                                                            </span>
<span class="-6555348808799489299" onmouseenter="enter('-6555348808799489299');" onmouseout="out('-6555348808799489299');" style=""> 158  			encoder.flush();                                                                                               </span>
<span class="-5963961095458339979" onmouseenter="enter('-5963961095458339979');" onmouseout="out('-5963961095458339979');" style=""> 159  			return arrayOutputStream.toByteArray();                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 160  		} catch (Exception e) {                                                                                         </span>
<span class="-8872519278167765909" onmouseenter="enter('-8872519278167765909');" onmouseout="out('-8872519278167765909');" style=""> 161  			throw new RuntimeException(&quot;Failed to serialize row.&quot;, e);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162  		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163  	}                                                                                                                </span>
<span  style=""> 164                                                                                                                    </span>
<span class="-9083274063054958773" onmouseenter="enter('-9083274063054958773');" onmouseout="out('-9083274063054958773');" style=""> 165  	protected void dealRetractField(boolean change, GenericRecord record) {                                          </span>
<span class="210094652700165703" onmouseenter="enter('210094652700165703');" onmouseout="out('210094652700165703');" style=""> 166  		schema.getFields()                                                                                              </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style=""> 167  				.stream()                                                                                                     </span>
<span class="5098706554295065000" onmouseenter="enter('5098706554295065000');" onmouseout="out('5098706554295065000');" style=""> 168  				.filter(field -&gt; StringUtils.equalsIgnoreCase(field.name(), retractKey))                                      </span>
<span class="5584759166487868172" onmouseenter="enter('5584759166487868172');" onmouseout="out('5584759166487868172');" style=""> 169  				.findFirst()                                                                                                  </span>
<span class="-5118525218844359679" onmouseenter="enter('-5118525218844359679');" onmouseout="out('-5118525218844359679');" style=""> 170  				.ifPresent(field -&gt; {                                                                                         </span>
<span class="8015285424988710463" onmouseenter="enter('8015285424988710463');" onmouseout="out('8015285424988710463');" style=""> 171  					if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {                                   </span>
<span class="-5139684198462480805" onmouseenter="enter('-5139684198462480805');" onmouseout="out('-5139684198462480805');" style=""> 172  						record.put(retractKey, convertFlinkType(field.schema(), change));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173  					}                                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 174  				});                                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175  	}                                                                                                                </span>
<span  style=""> 176                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 177  	@Override                                                                                                        </span>
<span class="6330040989576354347" onmouseenter="enter('6330040989576354347');" onmouseout="out('6330040989576354347');" style=""> 178  	public boolean equals(Object o) {                                                                                </span>
<span class="-3701683348888137093" onmouseenter="enter('-3701683348888137093');" onmouseout="out('-3701683348888137093');" style=""> 179  		if (this == o) {                                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 180  			return true;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181  		}                                                                                                               </span>
<span class="1158461466408770655" onmouseenter="enter('1158461466408770655');" onmouseout="out('1158461466408770655');" style=""> 182  		if (o == null || getClass() != o.getClass()) {                                                                  </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 183  			return false;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184  		}                                                                                                               </span>
<span class="-9162870405423779829" onmouseenter="enter('-9162870405423779829');" onmouseout="out('-9162870405423779829');" style=""> 185  		final AvroCRowSerializationSchema that = (AvroCRowSerializationSchema) o;                                       </span>
<span class="-151737951472144037" onmouseenter="enter('-151737951472144037');" onmouseout="out('-151737951472144037');" style=""> 186  		return Objects.equals(recordClazz, that.recordClazz) &amp;&amp; Objects.equals(schemaString, that.schemaString);        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187  	}                                                                                                                </span>
<span  style=""> 188                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 189  	@Override                                                                                                        </span>
<span class="5226885376728374571" onmouseenter="enter('5226885376728374571');" onmouseout="out('5226885376728374571');" style=""> 190  	public int hashCode() {                                                                                          </span>
<span class="2914975272798075837" onmouseenter="enter('2914975272798075837');" onmouseout="out('2914975272798075837');" style=""> 191  		return Objects.hash(recordClazz, schemaString);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192  	}                                                                                                                </span>
<span  style=""> 193                                                                                                                    </span>
<span class="6540115206553576757" onmouseenter="enter('6540115206553576757');" onmouseout="out('6540115206553576757');" style=""> 194  	// --------------------------------------------------------------------------------------------                  </span>
<span  style=""> 195                                                                                                                    </span>
<span class="-1209207100116124074" onmouseenter="enter('-1209207100116124074');" onmouseout="out('-1209207100116124074');" style=""> 196  	private GenericRecord convertRowToAvroRecord(Schema schema, Row row) {                                           </span>
<span  style=""> 197                                                                                                                    </span>
<span class="2796974551710068905" onmouseenter="enter('2796974551710068905');" onmouseout="out('2796974551710068905');" style=""> 198  		final List&lt;Schema.Field&gt; fields = schema.getFields()                                                            </span>
<span class="-1425279913529544512" onmouseenter="enter('-1425279913529544512');" onmouseout="out('-1425279913529544512');" style=""> 199  				.stream()                                                                                                     </span>
<span class="-6733093324080381102" onmouseenter="enter('-6733093324080381102');" onmouseout="out('-6733093324080381102');" style=""> 200  				.filter(field -&gt; !StringUtils.equalsIgnoreCase(field.name(), retractKey))                                     </span>
<span class="-2203221096853182255" onmouseenter="enter('-2203221096853182255');" onmouseout="out('-2203221096853182255');" style=""> 201  				.collect(Collectors.toList());                                                                                </span>
<span  style=""> 202                                                                                                                    </span>
<span class="-8358607057019969673" onmouseenter="enter('-8358607057019969673');" onmouseout="out('-8358607057019969673');" style=""> 203  		final int length = fields.size();                                                                               </span>
<span class="-6519850205107797367" onmouseenter="enter('-6519850205107797367');" onmouseout="out('-6519850205107797367');" style=""> 204  		final GenericRecord record = new GenericData.Record(schema);                                                    </span>
<span class="6908715651536326362" onmouseenter="enter('6908715651536326362');" onmouseout="out('6908715651536326362');" style=""> 205  		for (int i = 0; i &lt; length; i++) {                                                                              </span>
<span class="-308541912743956885" onmouseenter="enter('-308541912743956885');" onmouseout="out('-308541912743956885');" style=""> 206  			final Schema.Field field = fields.get(i);                                                                      </span>
<span class="-8906281943291721214" onmouseenter="enter('-8906281943291721214');" onmouseout="out('-8906281943291721214');" style=""> 207  			record.put(i, convertFlinkType(field.schema(), row.getField(i)));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208  		}                                                                                                               </span>
<span class="-1720360979497857847" onmouseenter="enter('-1720360979497857847');" onmouseout="out('-1720360979497857847');" style=""> 209  		return record;                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210  	}                                                                                                                </span>
<span  style=""> 211                                                                                                                    </span>
<span class="7090212362794164160" onmouseenter="enter('7090212362794164160');" onmouseout="out('7090212362794164160');" style=""> 212  	private Object convertFlinkType(Schema schema, Object object) {                                                  </span>
<span class="-28693417403810395" onmouseenter="enter('-28693417403810395');" onmouseout="out('-28693417403810395');" style=""> 213  		if (object == null) {                                                                                           </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 214  			return null;                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215  		}                                                                                                               </span>
<span class="4402763053584406991" onmouseenter="enter('4402763053584406991');" onmouseout="out('4402763053584406991');" style=""> 216  		switch (schema.getType()) {                                                                                     </span>
<span class="-1389030423746493771" onmouseenter="enter('-1389030423746493771');" onmouseout="out('-1389030423746493771');" style=""> 217  			case RECORD:                                                                                                   </span>
<span class="7856130746526215019" onmouseenter="enter('7856130746526215019');" onmouseout="out('7856130746526215019');" style=""> 218  				if (object instanceof Row) {                                                                                  </span>
<span class="-6003945991028657154" onmouseenter="enter('-6003945991028657154');" onmouseout="out('-6003945991028657154');" style=""> 219  					return convertRowToAvroRecord(schema, (Row) object);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220  				}                                                                                                             </span>
<span class="7586431837248347271" onmouseenter="enter('7586431837248347271');" onmouseout="out('7586431837248347271');" style=""> 221  				throw new IllegalStateException(&quot;Row expected but was: &quot; + object.getClass());                                </span>
<span class="4110003738898339868" onmouseenter="enter('4110003738898339868');" onmouseout="out('4110003738898339868');" style=""> 222  			case ENUM:                                                                                                     </span>
<span class="-8290415359836606726" onmouseenter="enter('-8290415359836606726');" onmouseout="out('-8290415359836606726');" style=""> 223  				return new GenericData.EnumSymbol(schema, object.toString());                                                 </span>
<span class="5459386958509250334" onmouseenter="enter('5459386958509250334');" onmouseout="out('5459386958509250334');" style=""> 224  			case ARRAY:                                                                                                    </span>
<span class="1254021645293943797" onmouseenter="enter('1254021645293943797');" onmouseout="out('1254021645293943797');" style=""> 225  				final Schema elementSchema = schema.getElementType();                                                         </span>
<span class="-734617252945856686" onmouseenter="enter('-734617252945856686');" onmouseout="out('-734617252945856686');" style=""> 226  				final Object[] array = (Object[]) object;                                                                     </span>
<span class="5499106907919226256" onmouseenter="enter('5499106907919226256');" onmouseout="out('5499106907919226256');" style=""> 227  				final GenericData.Array&lt;Object&gt; convertedArray = new GenericData.Array&lt;&gt;(array.length, schema);               </span>
<span class="4476039669652076319" onmouseenter="enter('4476039669652076319');" onmouseout="out('4476039669652076319');" style=""> 228  				for (Object element : array) {                                                                                </span>
<span class="7803277485251498257" onmouseenter="enter('7803277485251498257');" onmouseout="out('7803277485251498257');" style=""> 229  					convertedArray.add(convertFlinkType(elementSchema, element));                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230  				}                                                                                                             </span>
<span class="4988466111275958734" onmouseenter="enter('4988466111275958734');" onmouseout="out('4988466111275958734');" style=""> 231  				return convertedArray;                                                                                        </span>
<span class="-686292748754549927" onmouseenter="enter('-686292748754549927');" onmouseout="out('-686292748754549927');" style=""> 232  			case MAP:                                                                                                      </span>
<span class="-1479208159975107927" onmouseenter="enter('-1479208159975107927');" onmouseout="out('-1479208159975107927');" style=""> 233  				final Map&lt;?, ?&gt; map = (Map&lt;?, ?&gt;) object;                                                                     </span>
<span class="-3467464451669109134" onmouseenter="enter('-3467464451669109134');" onmouseout="out('-3467464451669109134');" style=""> 234  				final Map&lt;Utf8, Object&gt; convertedMap = new HashMap&lt;&gt;();                                                       </span>
<span class="739222350430074405" onmouseenter="enter('739222350430074405');" onmouseout="out('739222350430074405');" style=""> 235  				for (Map.Entry&lt;?, ?&gt; entry : map.entrySet()) {                                                                </span>
<span class="1558325269890454762" onmouseenter="enter('1558325269890454762');" onmouseout="out('1558325269890454762');" style=""> 236  					convertedMap.put(                                                                                            </span>
<span class="7224242544890570632" onmouseenter="enter('7224242544890570632');" onmouseout="out('7224242544890570632');" style=""> 237  						new Utf8(entry.getKey().toString()),                                                                        </span>
<span class="-6036800715978910148" onmouseenter="enter('-6036800715978910148');" onmouseout="out('-6036800715978910148');" style=""> 238  						convertFlinkType(schema.getValueType(), entry.getValue()));                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239  				}                                                                                                             </span>
<span class="-5982336352894290503" onmouseenter="enter('-5982336352894290503');" onmouseout="out('-5982336352894290503');" style=""> 240  				return convertedMap;                                                                                          </span>
<span class="294695447128891592" onmouseenter="enter('294695447128891592');" onmouseout="out('294695447128891592');" style=""> 241  			case UNION:                                                                                                    </span>
<span class="3844272576825420600" onmouseenter="enter('3844272576825420600');" onmouseout="out('3844272576825420600');" style=""> 242  				final List&lt;Schema&gt; types = schema.getTypes();                                                                 </span>
<span class="3925607017456038203" onmouseenter="enter('3925607017456038203');" onmouseout="out('3925607017456038203');" style=""> 243  				final int size = types.size();                                                                                </span>
<span class="-8618787059577633217" onmouseenter="enter('-8618787059577633217');" onmouseout="out('-8618787059577633217');" style=""> 244  				final Schema actualSchema;                                                                                    </span>
<span class="1389423169923037570" onmouseenter="enter('1389423169923037570');" onmouseout="out('1389423169923037570');" style=""> 245  				if (size == 2 &amp;&amp; types.get(0).getType() == Schema.Type.NULL) {                                                </span>
<span class="1503871293102169262" onmouseenter="enter('1503871293102169262');" onmouseout="out('1503871293102169262');" style=""> 246  					actualSchema = types.get(1);                                                                                 </span>
<span class="8935328853404182160" onmouseenter="enter('8935328853404182160');" onmouseout="out('8935328853404182160');" style=""> 247  				} else if (size == 2 &amp;&amp; types.get(1).getType() == Schema.Type.NULL) {                                         </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style=""> 248  					actualSchema = types.get(0);                                                                                 </span>
<span class="600132271482033996" onmouseenter="enter('600132271482033996');" onmouseout="out('600132271482033996');" style=""> 249  				} else if (size == 1) {                                                                                       </span>
<span class="-1561397515388023759" onmouseenter="enter('-1561397515388023759');" onmouseout="out('-1561397515388023759');" style=""> 250  					actualSchema = types.get(0);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 251  				} else {                                                                                                      </span>
<span class="-3213987048981771959" onmouseenter="enter('-3213987048981771959');" onmouseout="out('-3213987048981771959');" style=""> 252  					// generic type                                                                                              </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style=""> 253  					return object;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254  				}                                                                                                             </span>
<span class="-4926687157465229849" onmouseenter="enter('-4926687157465229849');" onmouseout="out('-4926687157465229849');" style=""> 255  				return convertFlinkType(actualSchema, object);                                                                </span>
<span class="1455542119975272952" onmouseenter="enter('1455542119975272952');" onmouseout="out('1455542119975272952');" style=""> 256  			case FIXED:                                                                                                    </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style=""> 257  				// check for logical type                                                                                     </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style=""> 258  				if (object instanceof BigDecimal) {                                                                           </span>
<span class="4962844792140678907" onmouseenter="enter('4962844792140678907');" onmouseout="out('4962844792140678907');" style=""> 259  					return new GenericData.Fixed(                                                                                </span>
<span class="5582129011297069726" onmouseenter="enter('5582129011297069726');" onmouseout="out('5582129011297069726');" style=""> 260  						schema,                                                                                                     </span>
<span class="-6863044067380575552" onmouseenter="enter('-6863044067380575552');" onmouseout="out('-6863044067380575552');" style=""> 261  						convertFromDecimal(schema, (BigDecimal) object));                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262  				}                                                                                                             </span>
<span class="-3247162005467079181" onmouseenter="enter('-3247162005467079181');" onmouseout="out('-3247162005467079181');" style=""> 263  				return new GenericData.Fixed(schema, (byte[]) object);                                                        </span>
<span class="6509618406235281730" onmouseenter="enter('6509618406235281730');" onmouseout="out('6509618406235281730');" style=""> 264  			case STRING:                                                                                                   </span>
<span class="6819922601075194641" onmouseenter="enter('6819922601075194641');" onmouseout="out('6819922601075194641');" style=""> 265  				return new Utf8(object.toString());                                                                           </span>
<span class="-7715207746407016209" onmouseenter="enter('-7715207746407016209');" onmouseout="out('-7715207746407016209');" style=""> 266  			case BYTES:                                                                                                    </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style=""> 267  				// check for logical type                                                                                     </span>
<span class="4034649101407187629" onmouseenter="enter('4034649101407187629');" onmouseout="out('4034649101407187629');" style=""> 268  				if (object instanceof BigDecimal) {                                                                           </span>
<span class="-8780820315836788249" onmouseenter="enter('-8780820315836788249');" onmouseout="out('-8780820315836788249');" style=""> 269  					return ByteBuffer.wrap(convertFromDecimal(schema, (BigDecimal) object));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270  				}                                                                                                             </span>
<span class="3936312710901173564" onmouseenter="enter('3936312710901173564');" onmouseout="out('3936312710901173564');" style=""> 271  				return ByteBuffer.wrap((byte[]) object);                                                                      </span>
<span class="-8492755770452814354" onmouseenter="enter('-8492755770452814354');" onmouseout="out('-8492755770452814354');" style=""> 272  			case INT:                                                                                                      </span>
<span class="924374662754530188" onmouseenter="enter('924374662754530188');" onmouseout="out('924374662754530188');" style=""> 273  				// check for logical types                                                                                    </span>
<span class="2686619476163660564" onmouseenter="enter('2686619476163660564');" onmouseout="out('2686619476163660564');" style=""> 274  				if (object instanceof Date) {                                                                                 </span>
<span class="-5851866935861925888" onmouseenter="enter('-5851866935861925888');" onmouseout="out('-5851866935861925888');" style=""> 275  					return convertFromDate(schema, (Date) object);                                                               </span>
<span class="2547747581119407699" onmouseenter="enter('2547747581119407699');" onmouseout="out('2547747581119407699');" style=""> 276  				} else if (object instanceof Time) {                                                                          </span>
<span class="243070565260643717" onmouseenter="enter('243070565260643717');" onmouseout="out('243070565260643717');" style=""> 277  					return convertFromTime(schema, (Time) object);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278  				}                                                                                                             </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style=""> 279  				return object;                                                                                                </span>
<span class="6747446563701730862" onmouseenter="enter('6747446563701730862');" onmouseout="out('6747446563701730862');" style=""> 280  			case LONG:                                                                                                     </span>
<span class="-1916537640189621806" onmouseenter="enter('-1916537640189621806');" onmouseout="out('-1916537640189621806');" style=""> 281  				// check for logical type                                                                                     </span>
<span class="-2961553809169639363" onmouseenter="enter('-2961553809169639363');" onmouseout="out('-2961553809169639363');" style=""> 282  				if (object instanceof Timestamp) {                                                                            </span>
<span class="-8754045970573784240" onmouseenter="enter('-8754045970573784240');" onmouseout="out('-8754045970573784240');" style=""> 283  					return convertFromTimestamp(schema, (Timestamp) object);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284  				}                                                                                                             </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style=""> 285  				return object;                                                                                                </span>
<span class="-3615172370136303705" onmouseenter="enter('-3615172370136303705');" onmouseout="out('-3615172370136303705');" style=""> 286  			case FLOAT:                                                                                                    </span>
<span class="-7970458252755999428" onmouseenter="enter('-7970458252755999428');" onmouseout="out('-7970458252755999428');" style=""> 287  			case DOUBLE:                                                                                                   </span>
<span class="-7896257890077828333" onmouseenter="enter('-7896257890077828333');" onmouseout="out('-7896257890077828333');" style=""> 288  			case BOOLEAN:                                                                                                  </span>
<span class="-6934035635888556027" onmouseenter="enter('-6934035635888556027');" onmouseout="out('-6934035635888556027');" style=""> 289  				return object;                                                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 290 +			default:                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291  		}                                                                                                               </span>
<span class="-5040324103744381321" onmouseenter="enter('-5040324103744381321');" onmouseout="out('-5040324103744381321');" style=""> 292  		throw new RuntimeException(&quot;Unsupported Avro type:&quot; + schema);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293  	}                                                                                                                </span>
<span  style=""> 294                                                                                                                    </span>
<span class="-230393574807041577" onmouseenter="enter('-230393574807041577');" onmouseout="out('-230393574807041577');" style=""> 295  	private byte[] convertFromDecimal(Schema schema, BigDecimal decimal) {                                           </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style=""> 296  		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="-5916553778609221096" onmouseenter="enter('-5916553778609221096');" onmouseout="out('-5916553778609221096');" style=""> 297  		if (logicalType instanceof LogicalTypes.Decimal) {                                                              </span>
<span class="-4790394342296900743" onmouseenter="enter('-4790394342296900743');" onmouseout="out('-4790394342296900743');" style=""> 298  			final LogicalTypes.Decimal decimalType = (LogicalTypes.Decimal) logicalType;                                   </span>
<span class="-6247992916673979385" onmouseenter="enter('-6247992916673979385');" onmouseout="out('-6247992916673979385');" style=""> 299  			// rescale to target type                                                                                      </span>
<span class="7846722822400868919" onmouseenter="enter('7846722822400868919');" onmouseout="out('7846722822400868919');" style=""> 300  			final BigDecimal rescaled = decimal.setScale(decimalType.getScale(), BigDecimal.ROUND_UNNECESSARY);            </span>
<span class="-5702751385468343783" onmouseenter="enter('-5702751385468343783');" onmouseout="out('-5702751385468343783');" style=""> 301  			// byte array must contain the two&#x27;s-complement representation of the                                          </span>
<span class="2601636377151022802" onmouseenter="enter('2601636377151022802');" onmouseout="out('2601636377151022802');" style=""> 302  			// unscaled integer value in big-endian byte order                                                             </span>
<span class="7816034069562726798" onmouseenter="enter('7816034069562726798');" onmouseout="out('7816034069562726798');" style=""> 303  			return decimal.unscaledValue().toByteArray();                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 304  		} else {                                                                                                        </span>
<span class="5195288048166648093" onmouseenter="enter('5195288048166648093');" onmouseout="out('5195288048166648093');" style=""> 305  			throw new RuntimeException(&quot;Unsupported decimal type.&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306  		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307  	}                                                                                                                </span>
<span  style=""> 308                                                                                                                    </span>
<span class="-8570368970471703101" onmouseenter="enter('-8570368970471703101');" onmouseout="out('-8570368970471703101');" style=""> 309  	private int convertFromDate(Schema schema, Date date) {                                                          </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style=""> 310  		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="-7927547235093904023" onmouseenter="enter('-7927547235093904023');" onmouseout="out('-7927547235093904023');" style=""> 311  		if (logicalType == LogicalTypes.date()) {                                                                       </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style=""> 312  			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style=""> 313  			final long time = date.getTime();                                                                              </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style=""> 314  			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                                 </span>
<span class="-3831294850984366939" onmouseenter="enter('-3831294850984366939');" onmouseout="out('-3831294850984366939');" style=""> 315  			return (int) (converted / 86400000L);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 316  		} else {                                                                                                        </span>
<span class="-5590814698093823676" onmouseenter="enter('-5590814698093823676');" onmouseout="out('-5590814698093823676');" style=""> 317  			throw new RuntimeException(&quot;Unsupported date type.&quot;);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318  		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319  	}                                                                                                                </span>
<span  style=""> 320                                                                                                                    </span>
<span class="6966610824187207203" onmouseenter="enter('6966610824187207203');" onmouseout="out('6966610824187207203');" style=""> 321  	private int convertFromTime(Schema schema, Time date) {                                                          </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style=""> 322  		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="6418860148398228243" onmouseenter="enter('6418860148398228243');" onmouseout="out('6418860148398228243');" style=""> 323  		if (logicalType == LogicalTypes.timeMillis()) {                                                                 </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style=""> 324  			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style=""> 325  			final long time = date.getTime();                                                                              </span>
<span class="2420844149446021449" onmouseenter="enter('2420844149446021449');" onmouseout="out('2420844149446021449');" style=""> 326  			final long converted = time + (long) LOCAL_TZ.getOffset(time);                                                 </span>
<span class="1322123468019918915" onmouseenter="enter('1322123468019918915');" onmouseout="out('1322123468019918915');" style=""> 327  			return (int) (converted % 86400000L);                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 328  		} else {                                                                                                        </span>
<span class="3159791053365383896" onmouseenter="enter('3159791053365383896');" onmouseout="out('3159791053365383896');" style=""> 329  			throw new RuntimeException(&quot;Unsupported time type.&quot;);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330  		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331  	}                                                                                                                </span>
<span  style=""> 332                                                                                                                    </span>
<span class="-4424920559390130943" onmouseenter="enter('-4424920559390130943');" onmouseout="out('-4424920559390130943');" style=""> 333  	private long convertFromTimestamp(Schema schema, Timestamp date) {                                               </span>
<span class="-3044250873557471800" onmouseenter="enter('-3044250873557471800');" onmouseout="out('-3044250873557471800');" style=""> 334  		final LogicalType logicalType = schema.getLogicalType();                                                        </span>
<span class="7550443984163478141" onmouseenter="enter('7550443984163478141');" onmouseout="out('7550443984163478141');" style=""> 335  		if (logicalType == LogicalTypes.timestampMillis()) {                                                            </span>
<span class="8567515369637728765" onmouseenter="enter('8567515369637728765');" onmouseout="out('8567515369637728765');" style=""> 336  			// adopted from Apache Calcite                                                                                 </span>
<span class="7344703071828757689" onmouseenter="enter('7344703071828757689');" onmouseout="out('7344703071828757689');" style=""> 337  			final long time = date.getTime();                                                                              </span>
<span class="-7117788179706972009" onmouseenter="enter('-7117788179706972009');" onmouseout="out('-7117788179706972009');" style=""> 338  			return time + (long) LOCAL_TZ.getOffset(time);                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 339  		} else {                                                                                                        </span>
<span class="-7747341483299857897" onmouseenter="enter('-7747341483299857897');" onmouseout="out('-7747341483299857897');" style=""> 340  			throw new RuntimeException(&quot;Unsupported timestamp type.&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341  		}                                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342  	}                                                                                                                </span>
<span  style=""> 343                                                                                                                    </span>
<span class="-4002069512480098089" onmouseenter="enter('-4002069512480098089');" onmouseout="out('-4002069512480098089');" style=""> 344  	private void writeObject(ObjectOutputStream outputStream) throws IOException {                                   </span>
<span class="-2112920724248525741" onmouseenter="enter('-2112920724248525741');" onmouseout="out('-2112920724248525741');" style=""> 345  		outputStream.writeObject(recordClazz);                                                                          </span>
<span class="-7544337652531095109" onmouseenter="enter('-7544337652531095109');" onmouseout="out('-7544337652531095109');" style=""> 346  		outputStream.writeObject(schemaString); // support for null                                                     </span>
<span class="7609146498049294030" onmouseenter="enter('7609146498049294030');" onmouseout="out('7609146498049294030');" style=""> 347  		outputStream.writeObject(retractKey);                                                                           </span>
<span class="-2899964837982404827" onmouseenter="enter('-2899964837982404827');" onmouseout="out('-2899964837982404827');" style=""> 348  		outputStream.writeObject(updateMode);                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349  	}                                                                                                                </span>
<span  style=""> 350                                                                                                                    </span>
<span class="7948482626287429940" onmouseenter="enter('7948482626287429940');" onmouseout="out('7948482626287429940');" style=""> 351  	@SuppressWarnings(&quot;unchecked&quot;)                                                                                   </span>
<span class="-9112061105852865088" onmouseenter="enter('-9112061105852865088');" onmouseout="out('-9112061105852865088');" style=""> 352  	private void readObject(ObjectInputStream inputStream) throws ClassNotFoundException, IOException {              </span>
<span class="-6174536729238883940" onmouseenter="enter('-6174536729238883940');" onmouseout="out('-6174536729238883940');" style=""> 353  		recordClazz = (Class&lt;? extends SpecificRecord&gt;) inputStream.readObject();                                       </span>
<span class="-5402722039120651146" onmouseenter="enter('-5402722039120651146');" onmouseout="out('-5402722039120651146');" style=""> 354  		schemaString = (String) inputStream.readObject();                                                               </span>
<span class="5351299494495243299" onmouseenter="enter('5351299494495243299');" onmouseout="out('5351299494495243299');" style=""> 355  		if (recordClazz != null) {                                                                                      </span>
<span class="4968630032727480408" onmouseenter="enter('4968630032727480408');" onmouseout="out('4968630032727480408');" style=""> 356  			schema = SpecificData.get().getSchema(recordClazz);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 357  		} else {                                                                                                        </span>
<span class="179978737536790984" onmouseenter="enter('179978737536790984');" onmouseout="out('179978737536790984');" style=""> 358  			schema = new Schema.Parser().parse(schemaString);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359  		}                                                                                                               </span>
<span class="-6836533628917872849" onmouseenter="enter('-6836533628917872849');" onmouseout="out('-6836533628917872849');" style=""> 360  		retractKey = (String) inputStream.readObject();                                                                 </span>
<span class="-1114096030940867329" onmouseenter="enter('-1114096030940867329');" onmouseout="out('-1114096030940867329');" style=""> 361  		updateMode = (String) inputStream.readObject();                                                                 </span>
<span  style=""> 362                                                                                                                    </span>
<span class="6668105459751304172" onmouseenter="enter('6668105459751304172');" onmouseout="out('6668105459751304172');" style=""> 363  		datumWriter = new SpecificDatumWriter&lt;&gt;(schema);                                                                </span>
<span class="-7181817771359730708" onmouseenter="enter('-7181817771359730708');" onmouseout="out('-7181817771359730708');" style=""> 364  		arrayOutputStream = new ByteArrayOutputStream();                                                                </span>
<span class="3967175408214023416" onmouseenter="enter('3967175408214023416');" onmouseout="out('3967175408214023416');" style=""> 365  		encoder = EncoderFactory.get().binaryEncoder(arrayOutputStream, null);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366  	}                                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            