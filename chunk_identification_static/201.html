<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>201</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    201
                    <a href="200.html">prev</a>
                    <a href="202.html">next</a>
                    <a href="201_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_6bb99c2e165c1531f99c2c66b0212e1f0df50635_core/broadleaf-framework-web/src/main/java/org/broadleafcommerce/core/web/security/XssRequestWrapper.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;6bb99c2e165c1531f99c2c66b0212e1f0df50635:core/broadleaf-framework-web/src/main/java/org/broadleafcommerce/core/web/security/XssRequestWrapper.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;6bb99c2e165c1531f99c2c66b0212e1f0df50635^1:core/broadleaf-framework-web/src/main/java/org/broadleafcommerce/core/web/security/XssRequestWrapper.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;6bb99c2e165c1531f99c2c66b0212e1f0df50635^2:core/broadleaf-framework-web/src/main/java/org/broadleafcommerce/core/web/security/XssRequestWrapper.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;df478ca5d04870811a3cd35fc095ce4923365ab4:core/broadleaf-framework-web/src/main/java/org/broadleafcommerce/core/web/security/XssRequestWrapper.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="6211491254187717485" onmouseenter="enter('6211491254187717485');" onmouseout="out('6211491254187717485');" style="">   3  * BroadleafCommerce Framework Web                                                                       </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="6368461695275167603" onmouseenter="enter('6368461695275167603');" onmouseout="out('6368461695275167603');" style="">   5  * Copyright (C) 2009 - 2020 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-8735476477837920118" onmouseenter="enter('-8735476477837920118');" onmouseout="out('-8735476477837920118');" style="">  18 package org.broadleafcommerce.core.web.security;                                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  20 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import org.owasp.esapi.ESAPI;                                                                            </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import org.owasp.esapi.errors.ValidationException;                                                       </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import org.springframework.core.env.Environment;                                                         </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  25                                                                                                          </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import javax.servlet.http.HttpServletRequestWrapper;                                                     </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 import java.util.regex.Pattern;                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  29 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  30 =======                                                                                                  </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  31 import org.owasp.esapi.ESAPI;                                                                            </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32 import org.owasp.esapi.errors.ValidationException;                                                       </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import org.springframework.core.env.Environment;                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34                                                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import java.util.regex.Pattern;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36                                                                                                          </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import javax.servlet.http.HttpServletRequestWrapper;                                                     </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  39 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  40                                                                                                          </span>
<span class="7240506517697615930" onmouseenter="enter('7240506517697615930');" onmouseout="out('7240506517697615930');" style="">  41 public class XssRequestWrapper extends HttpServletRequestWrapper {                                       </span>
<span  style="">  42                                                                                                          </span>
<span class="-5301339098521171602" onmouseenter="enter('-5301339098521171602');" onmouseout="out('-5301339098521171602');" style="">  43     protected final Environment environment;                                                             </span>
<span class="2945116331415148530" onmouseenter="enter('2945116331415148530');" onmouseout="out('2945116331415148530');" style="">  44     private String[] whiteListParamNames;                                                                </span>
<span  style="">  45                                                                                                          </span>
<span class="7469358884798831464" onmouseenter="enter('7469358884798831464');" onmouseout="out('7469358884798831464');" style=""><abbr title="  46     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNames) {">  46     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteLiðŸ”µ</abbr></span>
<span class="-2476574974832826807" onmouseenter="enter('-2476574974832826807');" onmouseout="out('-2476574974832826807');" style="">  47         super(servletRequest);                                                                           </span>
<span class="6037771345906590421" onmouseenter="enter('6037771345906590421');" onmouseout="out('6037771345906590421');" style="">  48         this.environment = environment;                                                                  </span>
<span class="1602335029228011967" onmouseenter="enter('1602335029228011967');" onmouseout="out('1602335029228011967');" style="">  49         this.whiteListParamNames = whiteListParamNames;                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50     }                                                                                                    </span>
<span  style="">  51                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  52     @Override                                                                                            </span>
<span class="-730054160571091135" onmouseenter="enter('-730054160571091135');" onmouseout="out('-730054160571091135');" style="">  53     public String[] getParameterValues(String parameter) {                                               </span>
<span  style="">  54                                                                                                          </span>
<span class="-7263309478327302000" onmouseenter="enter('-7263309478327302000');" onmouseout="out('-7263309478327302000');" style="">  55         String[] values = super.getParameterValues(parameter);                                           </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="">  56         if(checkWhitelist(parameter)){                                                                   </span>
<span class="-1403866763234897512" onmouseenter="enter('-1403866763234897512');" onmouseout="out('-1403866763234897512');" style="">  57             return values;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58         }                                                                                                </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style="">  59         if (values == null) {                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="">  60             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61         }                                                                                                </span>
<span  style="">  62                                                                                                          </span>
<span class="-4319277101857929872" onmouseenter="enter('-4319277101857929872');" onmouseout="out('-4319277101857929872');" style="">  63         int count = values.length;                                                                       </span>
<span class="-338720533136963362" onmouseenter="enter('-338720533136963362');" onmouseout="out('-338720533136963362');" style="">  64         String[] encodedValues = new String[count];                                                      </span>
<span class="678980937581768133" onmouseenter="enter('678980937581768133');" onmouseout="out('678980937581768133');" style="">  65         for (int i = 0; i &lt; count; i++) {                                                                </span>
<span class="3908211113095353722" onmouseenter="enter('3908211113095353722');" onmouseout="out('3908211113095353722');" style="">  66             encodedValues[i] = stripXSS(values[i]);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67         }                                                                                                </span>
<span  style="">  68                                                                                                          </span>
<span class="7706221160690087958" onmouseenter="enter('7706221160690087958');" onmouseout="out('7706221160690087958');" style="">  69         return encodedValues;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="936209222493849998" onmouseenter="enter('936209222493849998');" onmouseout="out('936209222493849998');" style="">  72     private boolean checkWhitelist(String parameter) {                                                   </span>
<span class="2171030091002445245" onmouseenter="enter('2171030091002445245');" onmouseout="out('2171030091002445245');" style="">  73         for (String whiteListParamName : whiteListParamNames) {                                          </span>
<span class="725602149507868612" onmouseenter="enter('725602149507868612');" onmouseout="out('725602149507868612');" style="">  74             if(whiteListParamName.equals(parameter)){                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  75                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  78         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-5314707390951704733" onmouseenter="enter('-5314707390951704733');" onmouseout="out('-5314707390951704733');" style="">  82     public String getParameter(String parameter) {                                                       </span>
<span class="-5517476204448767810" onmouseenter="enter('-5517476204448767810');" onmouseout="out('-5517476204448767810');" style="">  83         String value = super.getParameter(parameter);                                                    </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="">  84         if(checkWhitelist(parameter)){                                                                   </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="">  85             return value;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86         }                                                                                                </span>
<span class="8682929678615015504" onmouseenter="enter('8682929678615015504');" onmouseout="out('8682929678615015504');" style="">  87         return stripXSS(value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88     }                                                                                                    </span>
<span  style="">  89                                                                                                          </span>
<span class="7608347127962844256" onmouseenter="enter('7608347127962844256');" onmouseout="out('7608347127962844256');" style="">  90     private String stripXSS(String value) {                                                              </span>
<span class="3197362083799660545" onmouseenter="enter('3197362083799660545');" onmouseout="out('3197362083799660545');" style="">  91         if (value != null) {                                                                             </span>
<span class="-4972037796604402806" onmouseenter="enter('-4972037796604402806');" onmouseout="out('-4972037796604402806');" style=""><abbr title="  92             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;false&quot;));">  92             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;faðŸ”µ</abbr></span>
<span class="6814945305258007572" onmouseenter="enter('6814945305258007572');" onmouseout="out('6814945305258007572');" style="">  93             if (customStripXss) {                                                                        </span>
<span class="-9220533892966069497" onmouseenter="enter('-9220533892966069497');" onmouseout="out('-9220533892966069497');" style="">  94                 value = customStripXss(value);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  95             } else {                                                                                     </span>
<span class="-2591248796215307470" onmouseenter="enter('-2591248796215307470');" onmouseout="out('-2591248796215307470');" style="">  96                 String newValue;                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  97                 try {                                                                                    </span>
<span class="-6946294996353376925" onmouseenter="enter('-6946294996353376925');" onmouseout="out('-6946294996353376925');" style="">  98                     newValue = ESAPI.validator().getValidSafeHTML(&quot;context&quot;, value, 99999, true);        </span>
<span class="-2758815083603308802" onmouseenter="enter('-2758815083603308802');" onmouseout="out('-2758815083603308802');" style="">  99                 } catch (ValidationException e) {                                                        </span>
<span class="7974887226905815406" onmouseenter="enter('7974887226905815406');" onmouseout="out('7974887226905815406');" style=""> 100                     newValue = ESAPI.encoder().encodeForHTML(value);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101                 }                                                                                        </span>
<span class="-4146372292624448848" onmouseenter="enter('-4146372292624448848');" onmouseout="out('-4146372292624448848');" style=""> 102                 value = newValue;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104         }                                                                                                </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style=""> 105         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="-2035135679607582655" onmouseenter="enter('-2035135679607582655');" onmouseout="out('-2035135679607582655');" style=""> 108     private String customStripXss(String value) {                                                        </span>
<span class="-5986641454980488547" onmouseenter="enter('-5986641454980488547');" onmouseout="out('-5986641454980488547');" style=""> 109         // Avoid null characters                                                                         </span>
<span class="4941938962724982196" onmouseenter="enter('4941938962724982196');" onmouseout="out('4941938962724982196');" style=""> 110         value = value.replaceAll(&quot;&quot;, &quot;&quot;);                                                                </span>
<span  style=""> 111                                                                                                          </span>
<span class="-2587752387172220147" onmouseenter="enter('-2587752387172220147');" onmouseout="out('-2587752387172220147');" style=""> 112         // Avoid anything between script tags                                                            </span>
<span class="4803216797968678849" onmouseenter="enter('4803216797968678849');" onmouseout="out('4803216797968678849');" style=""> 113         Pattern scriptPattern = Pattern.compile(&quot;&lt;script&gt;(.*?)&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);     </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 114         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 115                                                                                                          </span>
<span class="-2548960611975407605" onmouseenter="enter('-2548960611975407605');" onmouseout="out('-2548960611975407605');" style=""> 116         // Avoid anything in a src=&#x27;...&#x27; type of expression                                              </span>
<span class="-2484342397782265345" onmouseenter="enter('-2484342397782265345');" onmouseout="out('-2484342397782265345');" style=""><abbr title=" 117         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 117         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | PatðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 118         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 119                                                                                                          </span>
<span class="-3002262870837328736" onmouseenter="enter('-3002262870837328736');" onmouseout="out('-3002262870837328736');" style=""><abbr title=" 120         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 120         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | PatðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 121         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 122                                                                                                          </span>
<span class="4601472072351380063" onmouseenter="enter('4601472072351380063');" onmouseout="out('4601472072351380063');" style=""> 123         // Remove any lonesome &lt;/script&gt; tag                                                             </span>
<span class="-9099449904459528773" onmouseenter="enter('-9099449904459528773');" onmouseout="out('-9099449904459528773');" style=""> 124         scriptPattern = Pattern.compile(&quot;&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 125         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 126                                                                                                          </span>
<span class="4194220385061148196" onmouseenter="enter('4194220385061148196');" onmouseout="out('4194220385061148196');" style=""> 127         // Remove any lonesome &lt;script ...&gt; tag                                                          </span>
<span class="-6621438538505291629" onmouseenter="enter('-6621438538505291629');" onmouseout="out('-6621438538505291629');" style=""><abbr title=" 128         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 128         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 129         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 130                                                                                                          </span>
<span class="-5854135753203141422" onmouseenter="enter('-5854135753203141422');" onmouseout="out('-5854135753203141422');" style=""> 131         // Avoid eval(...) expressions                                                                   </span>
<span class="5623118522740761305" onmouseenter="enter('5623118522740761305');" onmouseout="out('5623118522740761305');" style=""><abbr title=" 132         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 132         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE |ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 133         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 134                                                                                                          </span>
<span class="1550969277018045985" onmouseenter="enter('1550969277018045985');" onmouseout="out('1550969277018045985');" style=""> 135         // Avoid expression(...) expressions                                                             </span>
<span class="1420764100785512570" onmouseenter="enter('1420764100785512570');" onmouseout="out('1420764100785512570');" style=""><abbr title=" 136         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 136         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTIðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 137         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 138                                                                                                          </span>
<span class="-4595954144030537160" onmouseenter="enter('-4595954144030537160');" onmouseout="out('-4595954144030537160');" style=""> 139         // Avoid javascript:... expressions                                                              </span>
<span class="6373996626499193281" onmouseenter="enter('6373996626499193281');" onmouseout="out('6373996626499193281');" style=""> 140         scriptPattern = Pattern.compile(&quot;javascript:&quot;, Pattern.CASE_INSENSITIVE);                        </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 141         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 142                                                                                                          </span>
<span class="-6512395678660236515" onmouseenter="enter('-6512395678660236515');" onmouseout="out('-6512395678660236515');" style=""> 143         // Avoid vbscript:... expressions                                                                </span>
<span class="1832057038020562894" onmouseenter="enter('1832057038020562894');" onmouseout="out('1832057038020562894');" style=""> 144         scriptPattern = Pattern.compile(&quot;vbscript:&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 145         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 146                                                                                                          </span>
<span class="174807639881656761" onmouseenter="enter('174807639881656761');" onmouseout="out('174807639881656761');" style=""> 147         // Avoid onload= expressions                                                                     </span>
<span class="-8062647608714535778" onmouseenter="enter('-8062647608714535778');" onmouseout="out('-8062647608714535778');" style=""><abbr title=" 148         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 148         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 149         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style=""> 150         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="6211491254187717485" onmouseenter="enter('6211491254187717485');" onmouseout="out('6211491254187717485');" style="">   3  * BroadleafCommerce Framework Web                                                                       </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="6368461695275167603" onmouseenter="enter('6368461695275167603');" onmouseout="out('6368461695275167603');" style="">   5  * Copyright (C) 2009 - 2020 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-8735476477837920118" onmouseenter="enter('-8735476477837920118');" onmouseout="out('-8735476477837920118');" style="">  18 package org.broadleafcommerce.core.web.security;                                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  20 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import org.owasp.esapi.ESAPI;                                                                            </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  23 import org.owasp.esapi.errors.ValidationException;                                                       </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  24 import org.springframework.core.env.Environment;                                                         </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  25                                                                                                          </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  26 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  27 import javax.servlet.http.HttpServletRequestWrapper;                                                     </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  28 import java.util.regex.Pattern;                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  29 ||||||| BASE                                                                                             </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  30 =======                                                                                                  </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  31 import org.owasp.esapi.ESAPI;                                                                            </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32 import org.owasp.esapi.errors.ValidationException;                                                       </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import org.springframework.core.env.Environment;                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34                                                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import java.util.regex.Pattern;                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36                                                                                                          </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import javax.servlet.http.HttpServletRequestWrapper;                                                     </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  39 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">  40                                                                                                          </span>
<span class="7240506517697615930" onmouseenter="enter('7240506517697615930');" onmouseout="out('7240506517697615930');" style="">  41 public class XssRequestWrapper extends HttpServletRequestWrapper {                                       </span>
<span  style="">  42                                                                                                          </span>
<span class="-5301339098521171602" onmouseenter="enter('-5301339098521171602');" onmouseout="out('-5301339098521171602');" style="">  43     protected final Environment environment;                                                             </span>
<span class="2945116331415148530" onmouseenter="enter('2945116331415148530');" onmouseout="out('2945116331415148530');" style="">  44     private String[] whiteListParamNames;                                                                </span>
<span  style="">  45                                                                                                          </span>
<span class="7469358884798831464" onmouseenter="enter('7469358884798831464');" onmouseout="out('7469358884798831464');" style=""><abbr title="  46     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNames) {">  46     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteLiðŸ”µ</abbr></span>
<span class="-2476574974832826807" onmouseenter="enter('-2476574974832826807');" onmouseout="out('-2476574974832826807');" style="">  47         super(servletRequest);                                                                           </span>
<span class="6037771345906590421" onmouseenter="enter('6037771345906590421');" onmouseout="out('6037771345906590421');" style="">  48         this.environment = environment;                                                                  </span>
<span class="1602335029228011967" onmouseenter="enter('1602335029228011967');" onmouseout="out('1602335029228011967');" style="">  49         this.whiteListParamNames = whiteListParamNames;                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  50     }                                                                                                    </span>
<span  style="">  51                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  52     @Override                                                                                            </span>
<span class="-730054160571091135" onmouseenter="enter('-730054160571091135');" onmouseout="out('-730054160571091135');" style="">  53     public String[] getParameterValues(String parameter) {                                               </span>
<span  style="">  54                                                                                                          </span>
<span class="-7263309478327302000" onmouseenter="enter('-7263309478327302000');" onmouseout="out('-7263309478327302000');" style="">  55         String[] values = super.getParameterValues(parameter);                                           </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="">  56         if(checkWhitelist(parameter)){                                                                   </span>
<span class="-1403866763234897512" onmouseenter="enter('-1403866763234897512');" onmouseout="out('-1403866763234897512');" style="">  57             return values;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  58         }                                                                                                </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style="">  59         if (values == null) {                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="">  60             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61         }                                                                                                </span>
<span  style="">  62                                                                                                          </span>
<span class="-4319277101857929872" onmouseenter="enter('-4319277101857929872');" onmouseout="out('-4319277101857929872');" style="">  63         int count = values.length;                                                                       </span>
<span class="-338720533136963362" onmouseenter="enter('-338720533136963362');" onmouseout="out('-338720533136963362');" style="">  64         String[] encodedValues = new String[count];                                                      </span>
<span class="678980937581768133" onmouseenter="enter('678980937581768133');" onmouseout="out('678980937581768133');" style="">  65         for (int i = 0; i &lt; count; i++) {                                                                </span>
<span class="3908211113095353722" onmouseenter="enter('3908211113095353722');" onmouseout="out('3908211113095353722');" style="">  66             encodedValues[i] = stripXSS(values[i]);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67         }                                                                                                </span>
<span  style="">  68                                                                                                          </span>
<span class="7706221160690087958" onmouseenter="enter('7706221160690087958');" onmouseout="out('7706221160690087958');" style="">  69         return encodedValues;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  70     }                                                                                                    </span>
<span  style="">  71                                                                                                          </span>
<span class="936209222493849998" onmouseenter="enter('936209222493849998');" onmouseout="out('936209222493849998');" style="">  72     private boolean checkWhitelist(String parameter) {                                                   </span>
<span class="2171030091002445245" onmouseenter="enter('2171030091002445245');" onmouseout="out('2171030091002445245');" style="">  73         for (String whiteListParamName : whiteListParamNames) {                                          </span>
<span class="725602149507868612" onmouseenter="enter('725602149507868612');" onmouseout="out('725602149507868612');" style="">  74             if(whiteListParamName.equals(parameter)){                                                    </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  75                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  78         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-5314707390951704733" onmouseenter="enter('-5314707390951704733');" onmouseout="out('-5314707390951704733');" style="">  82     public String getParameter(String parameter) {                                                       </span>
<span class="-5517476204448767810" onmouseenter="enter('-5517476204448767810');" onmouseout="out('-5517476204448767810');" style="">  83         String value = super.getParameter(parameter);                                                    </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="">  84         if(checkWhitelist(parameter)){                                                                   </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="">  85             return value;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86         }                                                                                                </span>
<span class="8682929678615015504" onmouseenter="enter('8682929678615015504');" onmouseout="out('8682929678615015504');" style="">  87         return stripXSS(value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88     }                                                                                                    </span>
<span  style="">  89                                                                                                          </span>
<span class="7608347127962844256" onmouseenter="enter('7608347127962844256');" onmouseout="out('7608347127962844256');" style="">  90     private String stripXSS(String value) {                                                              </span>
<span class="3197362083799660545" onmouseenter="enter('3197362083799660545');" onmouseout="out('3197362083799660545');" style="">  91         if (value != null) {                                                                             </span>
<span class="-4972037796604402806" onmouseenter="enter('-4972037796604402806');" onmouseout="out('-4972037796604402806');" style=""><abbr title="  92             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;false&quot;));">  92             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;faðŸ”µ</abbr></span>
<span class="6814945305258007572" onmouseenter="enter('6814945305258007572');" onmouseout="out('6814945305258007572');" style="">  93             if (customStripXss) {                                                                        </span>
<span class="-9220533892966069497" onmouseenter="enter('-9220533892966069497');" onmouseout="out('-9220533892966069497');" style="">  94                 value = customStripXss(value);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  95             } else {                                                                                     </span>
<span class="-2591248796215307470" onmouseenter="enter('-2591248796215307470');" onmouseout="out('-2591248796215307470');" style="">  96                 String newValue;                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  97                 try {                                                                                    </span>
<span class="-6946294996353376925" onmouseenter="enter('-6946294996353376925');" onmouseout="out('-6946294996353376925');" style="">  98                     newValue = ESAPI.validator().getValidSafeHTML(&quot;context&quot;, value, 99999, true);        </span>
<span class="-2758815083603308802" onmouseenter="enter('-2758815083603308802');" onmouseout="out('-2758815083603308802');" style="">  99                 } catch (ValidationException e) {                                                        </span>
<span class="7974887226905815406" onmouseenter="enter('7974887226905815406');" onmouseout="out('7974887226905815406');" style=""> 100                     newValue = ESAPI.encoder().encodeForHTML(value);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101                 }                                                                                        </span>
<span class="-4146372292624448848" onmouseenter="enter('-4146372292624448848');" onmouseout="out('-4146372292624448848');" style=""> 102                 value = newValue;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104         }                                                                                                </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style=""> 105         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="-2035135679607582655" onmouseenter="enter('-2035135679607582655');" onmouseout="out('-2035135679607582655');" style=""> 108     private String customStripXss(String value) {                                                        </span>
<span class="-5986641454980488547" onmouseenter="enter('-5986641454980488547');" onmouseout="out('-5986641454980488547');" style=""> 109         // Avoid null characters                                                                         </span>
<span class="4941938962724982196" onmouseenter="enter('4941938962724982196');" onmouseout="out('4941938962724982196');" style=""> 110         value = value.replaceAll(&quot;&quot;, &quot;&quot;);                                                                </span>
<span  style=""> 111                                                                                                          </span>
<span class="-2587752387172220147" onmouseenter="enter('-2587752387172220147');" onmouseout="out('-2587752387172220147');" style=""> 112         // Avoid anything between script tags                                                            </span>
<span class="4803216797968678849" onmouseenter="enter('4803216797968678849');" onmouseout="out('4803216797968678849');" style=""> 113         Pattern scriptPattern = Pattern.compile(&quot;&lt;script&gt;(.*?)&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);     </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 114         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 115                                                                                                          </span>
<span class="-2548960611975407605" onmouseenter="enter('-2548960611975407605');" onmouseout="out('-2548960611975407605');" style=""> 116         // Avoid anything in a src=&#x27;...&#x27; type of expression                                              </span>
<span class="-2484342397782265345" onmouseenter="enter('-2484342397782265345');" onmouseout="out('-2484342397782265345');" style=""><abbr title=" 117         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 117         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | PatðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 118         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 119                                                                                                          </span>
<span class="-3002262870837328736" onmouseenter="enter('-3002262870837328736');" onmouseout="out('-3002262870837328736');" style=""><abbr title=" 120         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 120         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | PatðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 121         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 122                                                                                                          </span>
<span class="4601472072351380063" onmouseenter="enter('4601472072351380063');" onmouseout="out('4601472072351380063');" style=""> 123         // Remove any lonesome &lt;/script&gt; tag                                                             </span>
<span class="-9099449904459528773" onmouseenter="enter('-9099449904459528773');" onmouseout="out('-9099449904459528773');" style=""> 124         scriptPattern = Pattern.compile(&quot;&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 125         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 126                                                                                                          </span>
<span class="4194220385061148196" onmouseenter="enter('4194220385061148196');" onmouseout="out('4194220385061148196');" style=""> 127         // Remove any lonesome &lt;script ...&gt; tag                                                          </span>
<span class="-6621438538505291629" onmouseenter="enter('-6621438538505291629');" onmouseout="out('-6621438538505291629');" style=""><abbr title=" 128         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 128         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 129         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 130                                                                                                          </span>
<span class="-5854135753203141422" onmouseenter="enter('-5854135753203141422');" onmouseout="out('-5854135753203141422');" style=""> 131         // Avoid eval(...) expressions                                                                   </span>
<span class="5623118522740761305" onmouseenter="enter('5623118522740761305');" onmouseout="out('5623118522740761305');" style=""><abbr title=" 132         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 132         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE |ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 133         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 134                                                                                                          </span>
<span class="1550969277018045985" onmouseenter="enter('1550969277018045985');" onmouseout="out('1550969277018045985');" style=""> 135         // Avoid expression(...) expressions                                                             </span>
<span class="1420764100785512570" onmouseenter="enter('1420764100785512570');" onmouseout="out('1420764100785512570');" style=""><abbr title=" 136         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 136         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTIðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 137         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 138                                                                                                          </span>
<span class="-4595954144030537160" onmouseenter="enter('-4595954144030537160');" onmouseout="out('-4595954144030537160');" style=""> 139         // Avoid javascript:... expressions                                                              </span>
<span class="6373996626499193281" onmouseenter="enter('6373996626499193281');" onmouseout="out('6373996626499193281');" style=""> 140         scriptPattern = Pattern.compile(&quot;javascript:&quot;, Pattern.CASE_INSENSITIVE);                        </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 141         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 142                                                                                                          </span>
<span class="-6512395678660236515" onmouseenter="enter('-6512395678660236515');" onmouseout="out('-6512395678660236515');" style=""> 143         // Avoid vbscript:... expressions                                                                </span>
<span class="1832057038020562894" onmouseenter="enter('1832057038020562894');" onmouseout="out('1832057038020562894');" style=""> 144         scriptPattern = Pattern.compile(&quot;vbscript:&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 145         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span  style=""> 146                                                                                                          </span>
<span class="174807639881656761" onmouseenter="enter('174807639881656761');" onmouseout="out('174807639881656761');" style=""> 147         // Avoid onload= expressions                                                                     </span>
<span class="-8062647608714535778" onmouseenter="enter('-8062647608714535778');" onmouseout="out('-8062647608714535778');" style=""><abbr title=" 148         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 148         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 149         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style=""> 150         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="6211491254187717485" onmouseenter="enter('6211491254187717485');" onmouseout="out('6211491254187717485');" style="">   3  * BroadleafCommerce Framework Web                                                                       </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="6368461695275167603" onmouseenter="enter('6368461695275167603');" onmouseout="out('6368461695275167603');" style="">   5  * Copyright (C) 2009 - 2020 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-8735476477837920118" onmouseenter="enter('-8735476477837920118');" onmouseout="out('-8735476477837920118');" style="">  18 package org.broadleafcommerce.core.web.security;                                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="">  20 import java.util.regex.Pattern;                                                                          </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="">  21 import javax.servlet.http.HttpServletRequest;                                                            </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="">  22 import javax.servlet.http.HttpServletRequestWrapper;                                                     </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  23 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="">  24 import org.owasp.esapi.ESAPI;                                                                            </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="">  25 import org.owasp.esapi.errors.ValidationException;                                                       </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="">  26 import org.springframework.core.env.Environment;                                                         </span>
<span  style="">  27                                                                                                          </span>
<span  style="">  28                                                                                                          </span>
<span class="7240506517697615930" onmouseenter="enter('7240506517697615930');" onmouseout="out('7240506517697615930');" style="">  29 public class XssRequestWrapper extends HttpServletRequestWrapper {                                       </span>
<span class="-5301339098521171602" onmouseenter="enter('-5301339098521171602');" onmouseout="out('-5301339098521171602');" style="">  30     protected final Environment environment;                                                             </span>
<span  style="">  31                                                                                                          </span>
<span class="2945116331415148530" onmouseenter="enter('2945116331415148530');" onmouseout="out('2945116331415148530');" style="">  32     private String[] whiteListParamNames;                                                                </span>
<span  style="">  33                                                                                                          </span>
<span class="7469358884798831464" onmouseenter="enter('7469358884798831464');" onmouseout="out('7469358884798831464');" style=""><abbr title="  34     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNames) {">  34     public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteLiðŸ”µ</abbr></span>
<span class="-2476574974832826807" onmouseenter="enter('-2476574974832826807');" onmouseout="out('-2476574974832826807');" style="">  35         super(servletRequest);                                                                           </span>
<span class="6037771345906590421" onmouseenter="enter('6037771345906590421');" onmouseout="out('6037771345906590421');" style="">  36         this.environment = environment;                                                                  </span>
<span class="1602335029228011967" onmouseenter="enter('1602335029228011967');" onmouseout="out('1602335029228011967');" style="">  37         this.whiteListParamNames = whiteListParamNames;                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  38     }                                                                                                    </span>
<span  style="">  39                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  40     @Override                                                                                            </span>
<span class="-730054160571091135" onmouseenter="enter('-730054160571091135');" onmouseout="out('-730054160571091135');" style="">  41     public String[] getParameterValues(String parameter) {                                               </span>
<span class="-7263309478327302000" onmouseenter="enter('-7263309478327302000');" onmouseout="out('-7263309478327302000');" style="">  42         String[] values = super.getParameterValues(parameter);                                           </span>
<span class="2085448241636047067" onmouseenter="enter('2085448241636047067');" onmouseout="out('2085448241636047067');" style="">  43         if (checkWhitelist(parameter)) {                                                                 </span>
<span class="-1403866763234897512" onmouseenter="enter('-1403866763234897512');" onmouseout="out('-1403866763234897512');" style="">  44             return values;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  45         }                                                                                                </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style="">  46         if (values == null) {                                                                            </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="">  47             return null;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  48         }                                                                                                </span>
<span class="-4319277101857929872" onmouseenter="enter('-4319277101857929872');" onmouseout="out('-4319277101857929872');" style="">  49         int count = values.length;                                                                       </span>
<span class="-338720533136963362" onmouseenter="enter('-338720533136963362');" onmouseout="out('-338720533136963362');" style="">  50         String[] encodedValues = new String[count];                                                      </span>
<span class="678980937581768133" onmouseenter="enter('678980937581768133');" onmouseout="out('678980937581768133');" style="">  51         for (int i = 0; i &lt; count; i++) {                                                                </span>
<span class="3908211113095353722" onmouseenter="enter('3908211113095353722');" onmouseout="out('3908211113095353722');" style="">  52             encodedValues[i] = stripXSS(values[i]);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  53         }                                                                                                </span>
<span class="7706221160690087958" onmouseenter="enter('7706221160690087958');" onmouseout="out('7706221160690087958');" style="">  54         return encodedValues;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  55     }                                                                                                    </span>
<span  style="">  56                                                                                                          </span>
<span class="936209222493849998" onmouseenter="enter('936209222493849998');" onmouseout="out('936209222493849998');" style="">  57     private boolean checkWhitelist(String parameter) {                                                   </span>
<span class="2171030091002445245" onmouseenter="enter('2171030091002445245');" onmouseout="out('2171030091002445245');" style="">  58         for (String whiteListParamName : whiteListParamNames) {                                          </span>
<span class="7473858645715880150" onmouseenter="enter('7473858645715880150');" onmouseout="out('7473858645715880150');" style="">  59             if (whiteListParamName.equals(parameter)) {                                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="">  60                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="">  63         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  64     }                                                                                                    </span>
<span  style="">  65                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  66     @Override                                                                                            </span>
<span class="-5314707390951704733" onmouseenter="enter('-5314707390951704733');" onmouseout="out('-5314707390951704733');" style="">  67     public String getParameter(String parameter) {                                                       </span>
<span class="-5517476204448767810" onmouseenter="enter('-5517476204448767810');" onmouseout="out('-5517476204448767810');" style="">  68         String value = super.getParameter(parameter);                                                    </span>
<span class="2085448241636047067" onmouseenter="enter('2085448241636047067');" onmouseout="out('2085448241636047067');" style="">  69         if (checkWhitelist(parameter)) {                                                                 </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="">  70             return value;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71         }                                                                                                </span>
<span class="8682929678615015504" onmouseenter="enter('8682929678615015504');" onmouseout="out('8682929678615015504');" style="">  72         return stripXSS(value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  73     }                                                                                                    </span>
<span  style="">  74                                                                                                          </span>
<span class="7608347127962844256" onmouseenter="enter('7608347127962844256');" onmouseout="out('7608347127962844256');" style="">  75     private String stripXSS(String value) {                                                              </span>
<span class="3197362083799660545" onmouseenter="enter('3197362083799660545');" onmouseout="out('3197362083799660545');" style="">  76         if (value != null) {                                                                             </span>
<span class="-4972037796604402806" onmouseenter="enter('-4972037796604402806');" onmouseout="out('-4972037796604402806');" style=""><abbr title="  77             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;false&quot;));">  77             boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;faðŸ”µ</abbr></span>
<span class="6814945305258007572" onmouseenter="enter('6814945305258007572');" onmouseout="out('6814945305258007572');" style="">  78             if (customStripXss) {                                                                        </span>
<span class="-9220533892966069497" onmouseenter="enter('-9220533892966069497');" onmouseout="out('-9220533892966069497');" style="">  79                 value = customStripXss(value);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  80             } else {                                                                                     </span>
<span class="-2591248796215307470" onmouseenter="enter('-2591248796215307470');" onmouseout="out('-2591248796215307470');" style="">  81                 String newValue;                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  82                 try {                                                                                    </span>
<span class="-6946294996353376925" onmouseenter="enter('-6946294996353376925');" onmouseout="out('-6946294996353376925');" style="">  83                     newValue = ESAPI.validator().getValidSafeHTML(&quot;context&quot;, value, 99999, true);        </span>
<span class="-2758815083603308802" onmouseenter="enter('-2758815083603308802');" onmouseout="out('-2758815083603308802');" style="">  84                 } catch (ValidationException e) {                                                        </span>
<span class="7974887226905815406" onmouseenter="enter('7974887226905815406');" onmouseout="out('7974887226905815406');" style="">  85                     newValue = ESAPI.encoder().encodeForHTML(value);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86                 }                                                                                        </span>
<span class="-4146372292624448848" onmouseenter="enter('-4146372292624448848');" onmouseout="out('-4146372292624448848');" style="">  87                 value = newValue;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="">  90         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span  style="">  92                                                                                                          </span>
<span class="-2035135679607582655" onmouseenter="enter('-2035135679607582655');" onmouseout="out('-2035135679607582655');" style="">  93     private String customStripXss(String value) {                                                        </span>
<span class="-5986641454980488547" onmouseenter="enter('-5986641454980488547');" onmouseout="out('-5986641454980488547');" style="">  94         // Avoid null characters                                                                         </span>
<span class="4941938962724982196" onmouseenter="enter('4941938962724982196');" onmouseout="out('4941938962724982196');" style="">  95         value = value.replaceAll(&quot;&quot;, &quot;&quot;);                                                                </span>
<span class="-2587752387172220147" onmouseenter="enter('-2587752387172220147');" onmouseout="out('-2587752387172220147');" style="">  96         // Avoid anything between script tags                                                            </span>
<span class="4803216797968678849" onmouseenter="enter('4803216797968678849');" onmouseout="out('4803216797968678849');" style="">  97         Pattern scriptPattern = Pattern.compile(&quot;&lt;script&gt;(.*?)&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);     </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="">  98         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-2548960611975407605" onmouseenter="enter('-2548960611975407605');" onmouseout="out('-2548960611975407605');" style="">  99         // Avoid anything in a src=&#x27;...&#x27; type of expression                                              </span>
<span class="-7195453999116951819" onmouseenter="enter('-7195453999116951819');" onmouseout="out('-7195453999116951819');" style=""><abbr title=" 100         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 100         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, (Pattern.CASE_INSENSITIVE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 101         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-8834364349381625856" onmouseenter="enter('-8834364349381625856');" onmouseout="out('-8834364349381625856');" style=""><abbr title=" 102         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 102         scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, (Pattern.CASE_INSENSITIVE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 103         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="4601472072351380063" onmouseenter="enter('4601472072351380063');" onmouseout="out('4601472072351380063');" style=""> 104         // Remove any lonesome &lt;/script&gt; tag                                                             </span>
<span class="-9099449904459528773" onmouseenter="enter('-9099449904459528773');" onmouseout="out('-9099449904459528773');" style=""> 105         scriptPattern = Pattern.compile(&quot;&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 106         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="4194220385061148196" onmouseenter="enter('4194220385061148196');" onmouseout="out('4194220385061148196');" style=""> 107         // Remove any lonesome &lt;script ...&gt; tag                                                          </span>
<span class="2596856528211634361" onmouseenter="enter('2596856528211634361');" onmouseout="out('2596856528211634361');" style=""><abbr title=" 108         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 108         scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) |ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 109         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-5854135753203141422" onmouseenter="enter('-5854135753203141422');" onmouseout="out('-5854135753203141422');" style=""> 110         // Avoid eval(...) expressions                                                                   </span>
<span class="-4961596130172928793" onmouseenter="enter('-4961596130172928793');" onmouseout="out('-4961596130172928793');" style=""><abbr title=" 111         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 111         scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE)ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 112         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="1550969277018045985" onmouseenter="enter('1550969277018045985');" onmouseout="out('1550969277018045985');" style=""> 113         // Avoid expression(...) expressions                                                             </span>
<span class="8698607342299693603" onmouseenter="enter('8698607342299693603');" onmouseout="out('8698607342299693603');" style=""><abbr title=" 114         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 114         scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 115         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-4595954144030537160" onmouseenter="enter('-4595954144030537160');" onmouseout="out('-4595954144030537160');" style=""> 116         // Avoid javascript:... expressions                                                              </span>
<span class="6373996626499193281" onmouseenter="enter('6373996626499193281');" onmouseout="out('6373996626499193281');" style=""> 117         scriptPattern = Pattern.compile(&quot;javascript:&quot;, Pattern.CASE_INSENSITIVE);                        </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 118         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-6512395678660236515" onmouseenter="enter('-6512395678660236515');" onmouseout="out('-6512395678660236515');" style=""> 119         // Avoid vbscript:... expressions                                                                </span>
<span class="1832057038020562894" onmouseenter="enter('1832057038020562894');" onmouseout="out('1832057038020562894');" style=""> 120         scriptPattern = Pattern.compile(&quot;vbscript:&quot;, Pattern.CASE_INSENSITIVE);                          </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 121         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="174807639881656761" onmouseenter="enter('174807639881656761');" onmouseout="out('174807639881656761');" style=""> 122         // Avoid onload= expressions                                                                     </span>
<span class="2043615473774044529" onmouseenter="enter('2043615473774044529');" onmouseout="out('2043615473774044529');" style=""><abbr title=" 123         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | Pattern.DOTALL);"> 123         scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, (Pattern.CASE_INSENSITIVE | Pattern.MULTILINE) | ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style=""> 124         value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                             </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style=""> 125         return value;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127 }                                                                                                        </span>























</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   1 +/*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   2 + * #%L                                                                                                            </span>
<span class="6211491254187717485" onmouseenter="enter('6211491254187717485');" onmouseout="out('6211491254187717485');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   3 + * BroadleafCommerce Framework Web                                                                                </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   4 + * %%                                                                                                             </span>
<span class="6368461695275167603" onmouseenter="enter('6368461695275167603');" onmouseout="out('6368461695275167603');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   5 + * Copyright (C) 2009 - 2020 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   6 + * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   7 + * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   8 + * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 + * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  10 + * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  11 + * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  12 + * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  13 + *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  14 + * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14 + * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  15 + * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 + * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  17 + */                                                                                                               </span>
<span class="-8735476477837920118" onmouseenter="enter('-8735476477837920118');" onmouseout="out('-8735476477837920118');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  18 +package org.broadleafcommerce.core.web.security;                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  19 +                                                                                                                  </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  20 +import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  21 +import org.owasp.esapi.ESAPI;                                                                                     </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import org.owasp.esapi.errors.ValidationException;                                                                </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import org.springframework.core.env.Environment;                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +                                                                                                                  </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import javax.servlet.http.HttpServletRequest;                                                                     </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import javax.servlet.http.HttpServletRequestWrapper;                                                              </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import java.util.regex.Pattern;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +                                                                                                                  </span>
<span class="7240506517697615930" onmouseenter="enter('7240506517697615930');" onmouseout="out('7240506517697615930');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +public class XssRequestWrapper extends HttpServletRequestWrapper {                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +                                                                                                                  </span>
<span class="-5301339098521171602" onmouseenter="enter('-5301339098521171602');" onmouseout="out('-5301339098521171602');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +    protected final Environment environment;                                                                      </span>
<span class="2945116331415148530" onmouseenter="enter('2945116331415148530');" onmouseout="out('2945116331415148530');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +    private String[] whiteListParamNames;                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +                                                                                                                  </span>
<span class="7469358884798831464" onmouseenter="enter('7469358884798831464');" onmouseout="out('7469358884798831464');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  34 +    public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNames) {">  34 +    public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNaðŸ”µ</abbr></span>
<span class="-2476574974832826807" onmouseenter="enter('-2476574974832826807');" onmouseout="out('-2476574974832826807');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +        super(servletRequest);                                                                                    </span>
<span class="6037771345906590421" onmouseenter="enter('6037771345906590421');" onmouseout="out('6037771345906590421');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +        this.environment = environment;                                                                           </span>
<span class="1602335029228011967" onmouseenter="enter('1602335029228011967');" onmouseout="out('1602335029228011967');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  37 +        this.whiteListParamNames = whiteListParamNames;                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  39 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +    @Override                                                                                                     </span>
<span class="-730054160571091135" onmouseenter="enter('-730054160571091135');" onmouseout="out('-730054160571091135');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +    public String[] getParameterValues(String parameter) {                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +                                                                                                                  </span>
<span class="-7263309478327302000" onmouseenter="enter('-7263309478327302000');" onmouseout="out('-7263309478327302000');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +        String[] values = super.getParameterValues(parameter);                                                    </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +        if(checkWhitelist(parameter)){                                                                            </span>
<span class="-1403866763234897512" onmouseenter="enter('-1403866763234897512');" onmouseout="out('-1403866763234897512');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +            return values;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +        }                                                                                                         </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +        if (values == null) {                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +            return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +                                                                                                                  </span>
<span class="-4319277101857929872" onmouseenter="enter('-4319277101857929872');" onmouseout="out('-4319277101857929872');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +        int count = values.length;                                                                                </span>
<span class="-338720533136963362" onmouseenter="enter('-338720533136963362');" onmouseout="out('-338720533136963362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +        String[] encodedValues = new String[count];                                                               </span>
<span class="678980937581768133" onmouseenter="enter('678980937581768133');" onmouseout="out('678980937581768133');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +        for (int i = 0; i &lt; count; i++) {                                                                         </span>
<span class="3908211113095353722" onmouseenter="enter('3908211113095353722');" onmouseout="out('3908211113095353722');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +            encodedValues[i] = stripXSS(values[i]);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +                                                                                                                  </span>
<span class="7706221160690087958" onmouseenter="enter('7706221160690087958');" onmouseout="out('7706221160690087958');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +        return encodedValues;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>
<span class="936209222493849998" onmouseenter="enter('936209222493849998');" onmouseout="out('936209222493849998');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +    private boolean checkWhitelist(String parameter) {                                                            </span>
<span class="2171030091002445245" onmouseenter="enter('2171030091002445245');" onmouseout="out('2171030091002445245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +        for (String whiteListParamName : whiteListParamNames) {                                                   </span>
<span class="725602149507868612" onmouseenter="enter('725602149507868612');" onmouseout="out('725602149507868612');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +            if(whiteListParamName.equals(parameter)){                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +                return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +        }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +        return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +    @Override                                                                                                     </span>
<span class="-5314707390951704733" onmouseenter="enter('-5314707390951704733');" onmouseout="out('-5314707390951704733');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +    public String getParameter(String parameter) {                                                                </span>
<span class="-5517476204448767810" onmouseenter="enter('-5517476204448767810');" onmouseout="out('-5517476204448767810');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +        String value = super.getParameter(parameter);                                                             </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +        if(checkWhitelist(parameter)){                                                                            </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +            return value;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +        }                                                                                                         </span>
<span class="8682929678615015504" onmouseenter="enter('8682929678615015504');" onmouseout="out('8682929678615015504');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +        return stripXSS(value);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +                                                                                                                  </span>
<span class="7608347127962844256" onmouseenter="enter('7608347127962844256');" onmouseout="out('7608347127962844256');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +    private String stripXSS(String value) {                                                                       </span>
<span class="3197362083799660545" onmouseenter="enter('3197362083799660545');" onmouseout="out('3197362083799660545');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +        if (value != null) {                                                                                      </span>
<span class="-4972037796604402806" onmouseenter="enter('-4972037796604402806');" onmouseout="out('-4972037796604402806');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +            boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;false&quot;));  </span>
<span class="6814945305258007572" onmouseenter="enter('6814945305258007572');" onmouseout="out('6814945305258007572');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +            if (customStripXss) {                                                                                 </span>
<span class="-9220533892966069497" onmouseenter="enter('-9220533892966069497');" onmouseout="out('-9220533892966069497');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +                value = customStripXss(value);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +            } else {                                                                                              </span>
<span class="-2591248796215307470" onmouseenter="enter('-2591248796215307470');" onmouseout="out('-2591248796215307470');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +                String newValue;                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +                try {                                                                                             </span>
<span class="-6946294996353376925" onmouseenter="enter('-6946294996353376925');" onmouseout="out('-6946294996353376925');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +                    newValue = ESAPI.validator().getValidSafeHTML(&quot;context&quot;, value, 99999, true);                 </span>
<span class="-2758815083603308802" onmouseenter="enter('-2758815083603308802');" onmouseout="out('-2758815083603308802');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +                } catch (ValidationException e) {                                                                 </span>
<span class="7974887226905815406" onmouseenter="enter('7974887226905815406');" onmouseout="out('7974887226905815406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +                    newValue = ESAPI.encoder().encodeForHTML(value);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +                }                                                                                                 </span>
<span class="-4146372292624448848" onmouseenter="enter('-4146372292624448848');" onmouseout="out('-4146372292624448848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +                value = newValue;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +        }                                                                                                         </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +        return value;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +                                                                                                                  </span>
<span class="-2035135679607582655" onmouseenter="enter('-2035135679607582655');" onmouseout="out('-2035135679607582655');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +    private String customStripXss(String value) {                                                                 </span>
<span class="-5986641454980488547" onmouseenter="enter('-5986641454980488547');" onmouseout="out('-5986641454980488547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +        // Avoid null characters                                                                                  </span>
<span class="4941938962724982196" onmouseenter="enter('4941938962724982196');" onmouseout="out('4941938962724982196');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +        value = value.replaceAll(&quot;&quot;, &quot;&quot;);                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +                                                                                                                  </span>
<span class="-2587752387172220147" onmouseenter="enter('-2587752387172220147');" onmouseout="out('-2587752387172220147');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +        // Avoid anything between script tags                                                                     </span>
<span class="4803216797968678849" onmouseenter="enter('4803216797968678849');" onmouseout="out('4803216797968678849');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +        Pattern scriptPattern = Pattern.compile(&quot;&lt;script&gt;(.*?)&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);              </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +                                                                                                                  </span>
<span class="-2548960611975407605" onmouseenter="enter('-2548960611975407605');" onmouseout="out('-2548960611975407605');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +        // Avoid anything in a src=&#x27;...&#x27; type of expression                                                       </span>
<span class="-2484342397782265345" onmouseenter="enter('-2484342397782265345');" onmouseout="out('-2484342397782265345');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 105 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 105 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                                                                                                                  </span>
<span class="-3002262870837328736" onmouseenter="enter('-3002262870837328736');" onmouseout="out('-3002262870837328736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 108 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 108 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                                                                                                                  </span>
<span class="4601472072351380063" onmouseenter="enter('4601472072351380063');" onmouseout="out('4601472072351380063');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +        // Remove any lonesome &lt;/script&gt; tag                                                                      </span>
<span class="-9099449904459528773" onmouseenter="enter('-9099449904459528773');" onmouseout="out('-9099449904459528773');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +        scriptPattern = Pattern.compile(&quot;&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);                                   </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +                                                                                                                  </span>
<span class="4194220385061148196" onmouseenter="enter('4194220385061148196');" onmouseout="out('4194220385061148196');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +        // Remove any lonesome &lt;script ...&gt; tag                                                                   </span>
<span class="-6621438538505291629" onmouseenter="enter('-6621438538505291629');" onmouseout="out('-6621438538505291629');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 116 +        scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 116 +        scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                                                                                                                  </span>
<span class="-5854135753203141422" onmouseenter="enter('-5854135753203141422');" onmouseout="out('-5854135753203141422');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +        // Avoid eval(...) expressions                                                                            </span>
<span class="5623118522740761305" onmouseenter="enter('5623118522740761305');" onmouseout="out('5623118522740761305');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 120 +        scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 120 +        scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                                                                                                                  </span>
<span class="1550969277018045985" onmouseenter="enter('1550969277018045985');" onmouseout="out('1550969277018045985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        // Avoid expression(...) expressions                                                                      </span>
<span class="1420764100785512570" onmouseenter="enter('1420764100785512570');" onmouseout="out('1420764100785512570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 124 +        scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 124 +        scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                                                                                                                  </span>
<span class="-4595954144030537160" onmouseenter="enter('-4595954144030537160');" onmouseout="out('-4595954144030537160');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        // Avoid javascript:... expressions                                                                       </span>
<span class="6373996626499193281" onmouseenter="enter('6373996626499193281');" onmouseout="out('6373996626499193281');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +        scriptPattern = Pattern.compile(&quot;javascript:&quot;, Pattern.CASE_INSENSITIVE);                                 </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +                                                                                                                  </span>
<span class="-6512395678660236515" onmouseenter="enter('-6512395678660236515');" onmouseout="out('-6512395678660236515');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +        // Avoid vbscript:... expressions                                                                         </span>
<span class="1832057038020562894" onmouseenter="enter('1832057038020562894');" onmouseout="out('1832057038020562894');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +        scriptPattern = Pattern.compile(&quot;vbscript:&quot;, Pattern.CASE_INSENSITIVE);                                   </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +                                                                                                                  </span>
<span class="174807639881656761" onmouseenter="enter('174807639881656761');" onmouseout="out('174807639881656761');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +        // Avoid onload= expressions                                                                              </span>
<span class="-8062647608714535778" onmouseenter="enter('-8062647608714535778');" onmouseout="out('-8062647608714535778');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 136 +        scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 136 +        scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +        return value;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +}                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   1 +/*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   2 + * #%L                                                                                                            </span>
<span class="6211491254187717485" onmouseenter="enter('6211491254187717485');" onmouseout="out('6211491254187717485');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   3 + * BroadleafCommerce Framework Web                                                                                </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   4 + * %%                                                                                                             </span>
<span class="6368461695275167603" onmouseenter="enter('6368461695275167603');" onmouseout="out('6368461695275167603');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   5 + * Copyright (C) 2009 - 2020 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   6 + * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   7 + * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   8 + * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 + * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  10 + * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  11 + * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  12 + * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  13 + *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  14 + * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14 + * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  15 + * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  16 + * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  17 + */                                                                                                               </span>
<span class="-8735476477837920118" onmouseenter="enter('-8735476477837920118');" onmouseout="out('-8735476477837920118');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  18 +package org.broadleafcommerce.core.web.security;                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  19 +                                                                                                                  </span>
<span class="-8074434671692511485" onmouseenter="enter('-8074434671692511485');" onmouseout="out('-8074434671692511485');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  20 +import org.owasp.esapi.ESAPI;                                                                                     </span>
<span class="4647329225601596424" onmouseenter="enter('4647329225601596424');" onmouseout="out('4647329225601596424');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  21 +import org.owasp.esapi.errors.ValidationException;                                                                </span>
<span class="2802840430073505079" onmouseenter="enter('2802840430073505079');" onmouseout="out('2802840430073505079');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import org.springframework.core.env.Environment;                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +                                                                                                                  </span>
<span class="1513108047920599059" onmouseenter="enter('1513108047920599059');" onmouseout="out('1513108047920599059');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import java.util.regex.Pattern;                                                                                   </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +                                                                                                                  </span>
<span class="-2972028083581866805" onmouseenter="enter('-2972028083581866805');" onmouseout="out('-2972028083581866805');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import javax.servlet.http.HttpServletRequest;                                                                     </span>
<span class="1010213755584986245" onmouseenter="enter('1010213755584986245');" onmouseout="out('1010213755584986245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import javax.servlet.http.HttpServletRequestWrapper;                                                              </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +                                                                                                                  </span>
<span class="7240506517697615930" onmouseenter="enter('7240506517697615930');" onmouseout="out('7240506517697615930');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +public class XssRequestWrapper extends HttpServletRequestWrapper {                                                </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +                                                                                                                  </span>
<span class="-5301339098521171602" onmouseenter="enter('-5301339098521171602');" onmouseout="out('-5301339098521171602');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +    protected final Environment environment;                                                                      </span>
<span class="2945116331415148530" onmouseenter="enter('2945116331415148530');" onmouseout="out('2945116331415148530');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 +    private String[] whiteListParamNames;                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +                                                                                                                  </span>
<span class="7469358884798831464" onmouseenter="enter('7469358884798831464');" onmouseout="out('7469358884798831464');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  34 +    public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNames) {">  34 +    public XssRequestWrapper(HttpServletRequest servletRequest, Environment environment, String[] whiteListParamNaðŸ”µ</abbr></span>
<span class="-2476574974832826807" onmouseenter="enter('-2476574974832826807');" onmouseout="out('-2476574974832826807');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +        super(servletRequest);                                                                                    </span>
<span class="6037771345906590421" onmouseenter="enter('6037771345906590421');" onmouseout="out('6037771345906590421');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +        this.environment = environment;                                                                           </span>
<span class="1602335029228011967" onmouseenter="enter('1602335029228011967');" onmouseout="out('1602335029228011967');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  37 +        this.whiteListParamNames = whiteListParamNames;                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  39 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +    @Override                                                                                                     </span>
<span class="-730054160571091135" onmouseenter="enter('-730054160571091135');" onmouseout="out('-730054160571091135');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +    public String[] getParameterValues(String parameter) {                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +                                                                                                                  </span>
<span class="-7263309478327302000" onmouseenter="enter('-7263309478327302000');" onmouseout="out('-7263309478327302000');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +        String[] values = super.getParameterValues(parameter);                                                    </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +        if(checkWhitelist(parameter)){                                                                            </span>
<span class="-1403866763234897512" onmouseenter="enter('-1403866763234897512');" onmouseout="out('-1403866763234897512');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +            return values;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +        }                                                                                                         </span>
<span class="6588288335812254858" onmouseenter="enter('6588288335812254858');" onmouseout="out('6588288335812254858');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +        if (values == null) {                                                                                     </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +            return null;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +                                                                                                                  </span>
<span class="-4319277101857929872" onmouseenter="enter('-4319277101857929872');" onmouseout="out('-4319277101857929872');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +        int count = values.length;                                                                                </span>
<span class="-338720533136963362" onmouseenter="enter('-338720533136963362');" onmouseout="out('-338720533136963362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +        String[] encodedValues = new String[count];                                                               </span>
<span class="678980937581768133" onmouseenter="enter('678980937581768133');" onmouseout="out('678980937581768133');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +        for (int i = 0; i &lt; count; i++) {                                                                         </span>
<span class="3908211113095353722" onmouseenter="enter('3908211113095353722');" onmouseout="out('3908211113095353722');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +            encodedValues[i] = stripXSS(values[i]);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +                                                                                                                  </span>
<span class="7706221160690087958" onmouseenter="enter('7706221160690087958');" onmouseout="out('7706221160690087958');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +        return encodedValues;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +                                                                                                                  </span>
<span class="936209222493849998" onmouseenter="enter('936209222493849998');" onmouseout="out('936209222493849998');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +    private boolean checkWhitelist(String parameter) {                                                            </span>
<span class="2171030091002445245" onmouseenter="enter('2171030091002445245');" onmouseout="out('2171030091002445245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +        for (String whiteListParamName : whiteListParamNames) {                                                   </span>
<span class="725602149507868612" onmouseenter="enter('725602149507868612');" onmouseout="out('725602149507868612');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +            if(whiteListParamName.equals(parameter)){                                                             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +                return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +        }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +        return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +    @Override                                                                                                     </span>
<span class="-5314707390951704733" onmouseenter="enter('-5314707390951704733');" onmouseout="out('-5314707390951704733');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +    public String getParameter(String parameter) {                                                                </span>
<span class="-5517476204448767810" onmouseenter="enter('-5517476204448767810');" onmouseout="out('-5517476204448767810');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +        String value = super.getParameter(parameter);                                                             </span>
<span class="-1392677195724418259" onmouseenter="enter('-1392677195724418259');" onmouseout="out('-1392677195724418259');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +        if(checkWhitelist(parameter)){                                                                            </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +            return value;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +        }                                                                                                         </span>
<span class="8682929678615015504" onmouseenter="enter('8682929678615015504');" onmouseout="out('8682929678615015504');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +        return stripXSS(value);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +                                                                                                                  </span>
<span class="7608347127962844256" onmouseenter="enter('7608347127962844256');" onmouseout="out('7608347127962844256');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +    private String stripXSS(String value) {                                                                       </span>
<span class="3197362083799660545" onmouseenter="enter('3197362083799660545');" onmouseout="out('3197362083799660545');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +        if (value != null) {                                                                                      </span>
<span class="-4972037796604402806" onmouseenter="enter('-4972037796604402806');" onmouseout="out('-4972037796604402806');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +            boolean customStripXss = Boolean.parseBoolean(environment.getProperty(&quot;custom.strip.xss&quot;, &quot;false&quot;));  </span>
<span class="6814945305258007572" onmouseenter="enter('6814945305258007572');" onmouseout="out('6814945305258007572');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +            if (customStripXss) {                                                                                 </span>
<span class="-9220533892966069497" onmouseenter="enter('-9220533892966069497');" onmouseout="out('-9220533892966069497');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +                value = customStripXss(value);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +            } else {                                                                                              </span>
<span class="-2591248796215307470" onmouseenter="enter('-2591248796215307470');" onmouseout="out('-2591248796215307470');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +                String newValue;                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +                try {                                                                                             </span>
<span class="-6946294996353376925" onmouseenter="enter('-6946294996353376925');" onmouseout="out('-6946294996353376925');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +                    newValue = ESAPI.validator().getValidSafeHTML(&quot;context&quot;, value, 99999, true);                 </span>
<span class="-2758815083603308802" onmouseenter="enter('-2758815083603308802');" onmouseout="out('-2758815083603308802');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +                } catch (ValidationException e) {                                                                 </span>
<span class="7974887226905815406" onmouseenter="enter('7974887226905815406');" onmouseout="out('7974887226905815406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +                    newValue = ESAPI.encoder().encodeForHTML(value);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +                }                                                                                                 </span>
<span class="-4146372292624448848" onmouseenter="enter('-4146372292624448848');" onmouseout="out('-4146372292624448848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  90 +                value = newValue;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  92 +        }                                                                                                         </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +        return value;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +                                                                                                                  </span>
<span class="-2035135679607582655" onmouseenter="enter('-2035135679607582655');" onmouseout="out('-2035135679607582655');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +    private String customStripXss(String value) {                                                                 </span>
<span class="-5986641454980488547" onmouseenter="enter('-5986641454980488547');" onmouseout="out('-5986641454980488547');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +        // Avoid null characters                                                                                  </span>
<span class="4941938962724982196" onmouseenter="enter('4941938962724982196');" onmouseout="out('4941938962724982196');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +        value = value.replaceAll(&quot;&quot;, &quot;&quot;);                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +                                                                                                                  </span>
<span class="-2587752387172220147" onmouseenter="enter('-2587752387172220147');" onmouseout="out('-2587752387172220147');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +        // Avoid anything between script tags                                                                     </span>
<span class="4803216797968678849" onmouseenter="enter('4803216797968678849');" onmouseout="out('4803216797968678849');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +        Pattern scriptPattern = Pattern.compile(&quot;&lt;script&gt;(.*?)&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);              </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 102 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 103 +                                                                                                                  </span>
<span class="-2548960611975407605" onmouseenter="enter('-2548960611975407605');" onmouseout="out('-2548960611975407605');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +        // Avoid anything in a src=&#x27;...&#x27; type of expression                                                       </span>
<span class="-2484342397782265345" onmouseenter="enter('-2484342397782265345');" onmouseout="out('-2484342397782265345');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 105 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 105 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&#x27;(.*?)\\\&#x27;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +                                                                                                                  </span>
<span class="-3002262870837328736" onmouseenter="enter('-3002262870837328736');" onmouseout="out('-3002262870837328736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 108 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 108 +        scriptPattern = Pattern.compile(&quot;src[\r\n]*=[\r\n]*\\\&quot;(.*?)\\\&quot;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                                                                                                                  </span>
<span class="4601472072351380063" onmouseenter="enter('4601472072351380063');" onmouseout="out('4601472072351380063');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +        // Remove any lonesome &lt;/script&gt; tag                                                                      </span>
<span class="-9099449904459528773" onmouseenter="enter('-9099449904459528773');" onmouseout="out('-9099449904459528773');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +        scriptPattern = Pattern.compile(&quot;&lt;/script&gt;&quot;, Pattern.CASE_INSENSITIVE);                                   </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +                                                                                                                  </span>
<span class="4194220385061148196" onmouseenter="enter('4194220385061148196');" onmouseout="out('4194220385061148196');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +        // Remove any lonesome &lt;script ...&gt; tag                                                                   </span>
<span class="-6621438538505291629" onmouseenter="enter('-6621438538505291629');" onmouseout="out('-6621438538505291629');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 116 +        scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 116 +        scriptPattern = Pattern.compile(&quot;&lt;script(.*?)&gt;&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                                                                                                                  </span>
<span class="-5854135753203141422" onmouseenter="enter('-5854135753203141422');" onmouseout="out('-5854135753203141422');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +        // Avoid eval(...) expressions                                                                            </span>
<span class="5623118522740761305" onmouseenter="enter('5623118522740761305');" onmouseout="out('5623118522740761305');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 120 +        scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 120 +        scriptPattern = Pattern.compile(&quot;eval\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.ðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +                                                                                                                  </span>
<span class="1550969277018045985" onmouseenter="enter('1550969277018045985');" onmouseout="out('1550969277018045985');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        // Avoid expression(...) expressions                                                                      </span>
<span class="1420764100785512570" onmouseenter="enter('1420764100785512570');" onmouseout="out('1420764100785512570');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 124 +        scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 124 +        scriptPattern = Pattern.compile(&quot;expression\\((.*?)\\)&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | PaðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +                                                                                                                  </span>
<span class="-4595954144030537160" onmouseenter="enter('-4595954144030537160');" onmouseout="out('-4595954144030537160');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        // Avoid javascript:... expressions                                                                       </span>
<span class="6373996626499193281" onmouseenter="enter('6373996626499193281');" onmouseout="out('6373996626499193281');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +        scriptPattern = Pattern.compile(&quot;javascript:&quot;, Pattern.CASE_INSENSITIVE);                                 </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +                                                                                                                  </span>
<span class="-6512395678660236515" onmouseenter="enter('-6512395678660236515');" onmouseout="out('-6512395678660236515');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +        // Avoid vbscript:... expressions                                                                         </span>
<span class="1832057038020562894" onmouseenter="enter('1832057038020562894');" onmouseout="out('1832057038020562894');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +        scriptPattern = Pattern.compile(&quot;vbscript:&quot;, Pattern.CASE_INSENSITIVE);                                   </span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +                                                                                                                  </span>
<span class="174807639881656761" onmouseenter="enter('174807639881656761');" onmouseout="out('174807639881656761');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +        // Avoid onload= expressions                                                                              </span>
<span class="-8062647608714535778" onmouseenter="enter('-8062647608714535778');" onmouseout="out('-8062647608714535778');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 136 +        scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTALL);"> 136 +        scriptPattern = Pattern.compile(&quot;onload(.*?)=&quot;, Pattern.CASE_INSENSITIVE | Pattern.MULTILINE | Pattern.DOTðŸ”µ</abbr></span>
<span class="-1478409391188607293" onmouseenter="enter('-1478409391188607293');" onmouseout="out('-1478409391188607293');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +        value = scriptPattern.matcher(value).replaceAll(&quot;&quot;);                                                      </span>
<span class="-4905322242800291335" onmouseenter="enter('-4905322242800291335');" onmouseout="out('-4905322242800291335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +        return value;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +}                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            