<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>580</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    580
                    <a href="579.html">prev</a>
                    <a href="581.html">next</a>
                    <a href="580_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_f05e92b15d5e4c94442e53a9f83e2659c369aa5e_redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^1:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^2:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;14446f4dd844b1bb9da6c412e3556e135bafcba4:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [j], [j], [s], [s], [s]], subset: [[bs], [b], [j], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  23 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  25 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  26 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  28                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  29 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  30 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  31 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  32 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  34 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  35 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  36 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  37 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  38 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  39 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  40 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  41 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  42 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  43 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  46 import com.google.common.collect.Maps;                                                                   </span>
<span  style="">  47                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  51 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  57     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  58                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  59     private RedisClient redisClient;                                                                     </span>
<span  style="">  60                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  61     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  62                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  63     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  65     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  66                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  67     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  68                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  69     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  70                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  71     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  72                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  74         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  75         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  81         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  82         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83     }                                                                                                    </span>
<span  style="">  84                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  85     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  86         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  87         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  88         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  89             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  91             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  93         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  94         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  95             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  97         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  98             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  99                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 100                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 101                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 102                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 103                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 105             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 106                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 107                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 109                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 110                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 111                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 113             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 114                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 115                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 116                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 117                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 118                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 119             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 125     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 126         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 130 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 131     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 131     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132         String key = buildCacheKey(inputParams);                                                         </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136         if (values.length == 0) {                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 137             dealMissKey(input, resultFuture);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 139             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 139             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                             String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);      </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146                             keyValue.put(splitKeys[1], splitKeys[2]);                                    </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147                             keyValue.put(splitKeys[3], keyValues.get(i).getValue());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 148                         }                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 149                         try {                                                                            </span>
<span class="-2820718685971995659" onmouseenter="enter('-2820718685971995659');" onmouseout="out('-2820718685971995659');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150                             Row row = fillData(input.row(), keyValue);                                   </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 151                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));"> 151                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValðŸ”µ</abbr></span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152                             resultFuture.complete(Collections.singleton(new CRow(row, input.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153                         } catch (Exception e) {                                                          </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154                             dealFillDataError(resultFuture, e, input);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 155                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156                     } else {                                                                             </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157                         dealMissKey(input, resultFuture);                                                </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 158                         dealCacheData(key, CacheMissVal.getMissKeyObj());                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 159 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="-4706706522308261371" onmouseenter="enter('-4706706522308261371');" onmouseout="out('-4706706522308261371');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161         CRow inputCopy = new CRow(input.row(),input.change());                                           </span>
<span class="-303153469629925649" onmouseenter="enter('-303153469629925649');" onmouseout="out('-303153469629925649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162         List&lt;String&gt; keyData = Lists.newLinkedList();                                                    </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165             Object equalObj = inputCopy.row().getField(conValIndex);                                     </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166             if(equalObj == null){                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169             }                                                                                            </span>
<span class="2887844577456871278" onmouseenter="enter('2887844577456871278');" onmouseout="out('2887844577456871278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170             String value = equalObj.toString();                                                          </span>
<span class="-2170493469799044193" onmouseenter="enter('-2170493469799044193');" onmouseout="out('-2170493469799044193');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171             keyData.add(sideInfo.getEqualFieldList().get(i));                                            </span>
<span class="3849389580127899071" onmouseenter="enter('3849389580127899071');" onmouseout="out('3849389580127899071');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172             keyData.add(value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                                                                                                          </span>
<span class="-8711689112925343628" onmouseenter="enter('-8711689112925343628');" onmouseout="out('-8711689112925343628');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175         String key = buildCacheKey(keyData);                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176                                                                                                          </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177         if(openCache()){                                                                                 </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178             CacheObj val = getFromCache(key);                                                            </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179             if(val != null){                                                                             </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180                 if(ECacheContentType.MissVal == val.getType()){                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182                     return;                                                                              </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183                 }else if(ECacheContentType.MultiLine == val.getType()){                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                     try {                                                                                </span>
<span class="6802212136073345643" onmouseenter="enter('6802212136073345643');" onmouseout="out('6802212136073345643');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                         Row row = fillData(inputCopy.row(), val.getContent());                           </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                 }else{                                                                                   </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 191                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 191                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + valðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                     resultFuture.completeExceptionally(exception);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197                                                                                                          </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201         if (values.length == 0) {                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202             dealMissKey(inputCopy, resultFuture);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 204             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 204             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 210 =======                                                                                                  </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-7758690600237266983" onmouseenter="enter('-7758690600237266983');" onmouseout="out('-7758690600237266983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213         Map&lt;String, Object&gt; refData = Maps.newHashMap();                                                 </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217             if(equalObj == null){                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220             }                                                                                            </span>
<span class="85629276949166904" onmouseenter="enter('85629276949166904');" onmouseout="out('85629276949166904');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221             refData.put(sideInfo.getEqualFieldList().get(i), equalObj);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223                                                                                                          </span>
<span class="5100915750795106940" onmouseenter="enter('5100915750795106940');" onmouseout="out('5100915750795106940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224         String key = buildCacheKey(refData);                                                             </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227         }                                                                                                </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228         if(openCache()){                                                                                 </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229             CacheObj val = getFromCache(key);                                                            </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230             if(val != null){                                                                             </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231                 if(ECacheContentType.MissVal == val.getType()){                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233                     return;                                                                              </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234                 }else if(ECacheContentType.MultiLine == val.getType()){                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241                 }else{                                                                                   </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 242                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 242                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + valðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243                     resultFuture.completeExceptionally(exception);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248                                                                                                          </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 260 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262                 } else {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 263                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 264                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 267         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268     }                                                                                                    </span>
<span  style=""> 269                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 270 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 271     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 272     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="4719873832516487915" onmouseenter="enter('4719873832516487915');" onmouseout="out('4719873832516487915');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 273         String kv = StringUtils.join(inputParams.values(), &quot;:&quot;);                                         </span>
<span class="7614186089505803066" onmouseenter="enter('7614186089505803066');" onmouseout="out('7614186089505803066');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 274         String tableName = redisSideTableInfo.getTableName();                                            </span>
<span class="-5964725243621491152" onmouseenter="enter('-5964725243621491152');" onmouseout="out('-5964725243621491152');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 275         StringBuilder preKey =  new StringBuilder();                                                     </span>
<span class="-5172448576059326852" onmouseenter="enter('-5172448576059326852');" onmouseout="out('-5172448576059326852');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 276         preKey.append(tableName).append(&quot;:&quot;).append(kv);                                                 </span>
<span class="4375341752415796420" onmouseenter="enter('4375341752415796420');" onmouseout="out('4375341752415796420');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 277         return preKey.toString();                                                                        </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 278 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                                                                                                          </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286         if (values.length == 0) {                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287             dealMissKey(inputCopy, resultFuture);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 289             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 289             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                             String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);      </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296                             keyValue.put(splitKeys[1], splitKeys[2]);                                    </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297                             keyValue.put(splitKeys[3], keyValues.get(i).getValue());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298                         }                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299                         try {                                                                            </span>
<span class="5367810708668286095" onmouseenter="enter('5367810708668286095');" onmouseout="out('5367810708668286095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300                             Row row = fillData(inputCopy.row(), keyValue);                               </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 301                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));"> 301                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValðŸ”µ</abbr></span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 302                             resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));"> 302                             resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())ðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                         } catch (Exception e) {                                                          </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                             dealFillDataError(resultFuture, e, inputCopy);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                     } else {                                                                             </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                         dealMissKey(inputCopy, resultFuture);                                            </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                         dealCacheData(key, CacheMissVal.getMissKeyObj());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 314 =======                                                                                                  </span>
<span class="6901897164566696834" onmouseenter="enter('6901897164566696834');" onmouseout="out('6901897164566696834');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315     private String buildCacheKey(Map&lt;String, Object&gt; refData) {                                          </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316         StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                 </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317         List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                  </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318         for(String primaryKey : primaryKeys){                                                            </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319             if(!refData.containsKey(primaryKey)){                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321             }                                                                                            </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322             keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323         }                                                                                                </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324         return keyBuilder.toString();                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 325 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326     }                                                                                                    </span>
<span  style=""> 327                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 328     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 329     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 330         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 331         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 332             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 334         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 335             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 337         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 338             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 340         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 341             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343     }                                                                                                    </span>
<span  style=""> 344                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  23 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  25 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  26 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  28                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  29 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  30 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  31 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  32 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  34 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  35 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  36 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  37 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  38 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  39 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  40 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  41 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  42 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  43 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  46 import com.google.common.collect.Maps;                                                                   </span>
<span  style="">  47                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  51 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  57     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  58                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  59     private RedisClient redisClient;                                                                     </span>
<span  style="">  60                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  61     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  62                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  63     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  65     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  66                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  67     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  68                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  69     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  70                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  71     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  72                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  73     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  74         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  75         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  81         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  82         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83     }                                                                                                    </span>
<span  style="">  84                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  85     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  86         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  87         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  88         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  89             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  91             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  93         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  94         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  95             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  97         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  98             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  99                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 100                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 101                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 102                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 103                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 105             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 106                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 107                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 108                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 109                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 110                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 111                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 113             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 114                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 115                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 116                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 117                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 118                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 119             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 125     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 126         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 130     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 131         String key = buildCacheKey(inputParams);                                                         </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style=""> 132         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style=""> 133         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style=""> 134         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style=""> 135         if (values.length == 0) {                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 136             dealMissKey(input, resultFuture);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 137         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style=""><abbr title=" 138             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 138             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style=""> 139             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 140                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style=""> 141                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style=""> 142                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style=""> 143                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style=""> 144                             String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);      </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style=""> 145                             keyValue.put(splitKeys[1], splitKeys[2]);                                    </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style=""> 146                             keyValue.put(splitKeys[3], keyValues.get(i).getValue());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147                         }                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 148                         try {                                                                            </span>
<span class="-2820718685971995659" onmouseenter="enter('-2820718685971995659');" onmouseout="out('-2820718685971995659');" style=""> 149                             Row row = fillData(input.row(), keyValue);                                   </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style=""><abbr title=" 150                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));"> 150                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValðŸ”µ</abbr></span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 151                             resultFuture.complete(Collections.singleton(new CRow(row, input.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 152                         } catch (Exception e) {                                                          </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style=""> 153                             dealFillDataError(resultFuture, e, input);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 155                     } else {                                                                             </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 156                         dealMissKey(input, resultFuture);                                                </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 157                         dealCacheData(key, CacheMissVal.getMissKeyObj());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 160             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 163 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 164 ||||||| BASE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 @Override                                                                                                </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="-4706706522308261371" onmouseenter="enter('-4706706522308261371');" onmouseout="out('-4706706522308261371');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         CRow inputCopy = new CRow(input.row(),input.change());                                           </span>
<span class="-303153469629925649" onmouseenter="enter('-303153469629925649');" onmouseout="out('-303153469629925649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168         List&lt;String&gt; keyData = Lists.newLinkedList();                                                    </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171             Object equalObj = inputCopy.row().getField(conValIndex);                                     </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172             if(equalObj == null){                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             }                                                                                            </span>
<span class="2887844577456871278" onmouseenter="enter('2887844577456871278');" onmouseout="out('2887844577456871278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176             String value = equalObj.toString();                                                          </span>
<span class="-2170493469799044193" onmouseenter="enter('-2170493469799044193');" onmouseout="out('-2170493469799044193');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177             keyData.add(sideInfo.getEqualFieldList().get(i));                                            </span>
<span class="3849389580127899071" onmouseenter="enter('3849389580127899071');" onmouseout="out('3849389580127899071');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178             keyData.add(value);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180                                                                                                          </span>
<span class="-8711689112925343628" onmouseenter="enter('-8711689112925343628');" onmouseout="out('-8711689112925343628');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         String key = buildCacheKey(keyData);                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182                                                                                                          </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183         if(openCache()){                                                                                 </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184             CacheObj val = getFromCache(key);                                                            </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185             if(val != null){                                                                             </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                 if(ECacheContentType.MissVal == val.getType()){                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                     return;                                                                              </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                 }else if(ECacheContentType.MultiLine == val.getType()){                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190                     try {                                                                                </span>
<span class="6802212136073345643" onmouseenter="enter('6802212136073345643');" onmouseout="out('6802212136073345643');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                         Row row = fillData(inputCopy.row(), val.getContent());                           </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 }else{                                                                                   </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 197                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 197                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + valðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198                     resultFuture.completeExceptionally(exception);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                                                                                                          </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207         if (values.length == 0) {                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208             dealMissKey(inputCopy, resultFuture);                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 210             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 210             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216                             String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);      </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217                             keyValue.put(splitKeys[1], splitKeys[2]);                                    </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                             keyValue.put(splitKeys[3], keyValues.get(i).getValue());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219                         }                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220                         try {                                                                            </span>
<span class="5367810708668286095" onmouseenter="enter('5367810708668286095');" onmouseout="out('5367810708668286095');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                             Row row = fillData(inputCopy.row(), keyValue);                               </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 222                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));"> 222                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValðŸ”µ</abbr></span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 223                             resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));"> 223                             resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())ðŸ”µ</abbr></span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224                         } catch (Exception e) {                                                          </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225                             dealFillDataError(resultFuture, e, inputCopy);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227                     } else {                                                                             </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228                         dealMissKey(inputCopy, resultFuture);                                            </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229                         dealCacheData(key, CacheMissVal.getMissKeyObj());                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231                 }                                                                                        </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232             });                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 235 =======                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236 @Override                                                                                                </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-7758690600237266983" onmouseenter="enter('-7758690600237266983');" onmouseout="out('-7758690600237266983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239         Map&lt;String, Object&gt; refData = Maps.newHashMap();                                                 </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243             if(equalObj == null){                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246             }                                                                                            </span>
<span class="85629276949166904" onmouseenter="enter('85629276949166904');" onmouseout="out('85629276949166904');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247             refData.put(sideInfo.getEqualFieldList().get(i), equalObj);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249                                                                                                          </span>
<span class="5100915750795106940" onmouseenter="enter('5100915750795106940');" onmouseout="out('5100915750795106940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250         String key = buildCacheKey(refData);                                                             </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253         }                                                                                                </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254         if(openCache()){                                                                                 </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255             CacheObj val = getFromCache(key);                                                            </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256             if(val != null){                                                                             </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257                 if(ECacheContentType.MissVal == val.getType()){                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259                     return;                                                                              </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260                 }else if(ECacheContentType.MultiLine == val.getType()){                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267                 }else{                                                                                   </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 268                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 268                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + valðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269                     resultFuture.completeExceptionally(exception);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 270                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 271                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 272             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 273         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 274                                                                                                          </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 275         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287                 } else {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 294 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 295                                                                                                          </span>
<span  style=""> 296                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 297 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 298     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 299     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="4719873832516487915" onmouseenter="enter('4719873832516487915');" onmouseout="out('4719873832516487915');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 300         String kv = StringUtils.join(inputParams.values(), &quot;:&quot;);                                         </span>
<span class="7614186089505803066" onmouseenter="enter('7614186089505803066');" onmouseout="out('7614186089505803066');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 301         String tableName = redisSideTableInfo.getTableName();                                            </span>
<span class="-5964725243621491152" onmouseenter="enter('-5964725243621491152');" onmouseout="out('-5964725243621491152');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 302         StringBuilder preKey =  new StringBuilder();                                                     </span>
<span class="-5172448576059326852" onmouseenter="enter('-5172448576059326852');" onmouseout="out('-5172448576059326852');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 303         preKey.append(tableName).append(&quot;:&quot;).append(kv);                                                 </span>
<span class="4375341752415796420" onmouseenter="enter('4375341752415796420');" onmouseout="out('4375341752415796420');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 304         return preKey.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 305     }                                                                                                    </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 306 ||||||| BASE                                                                                             </span>
<span class="-4874568584154894582" onmouseenter="enter('-4874568584154894582');" onmouseout="out('-4874568584154894582');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307     private String buildCacheKey(List&lt;String&gt; keyData) {                                                 </span>
<span class="-6521119560499060353" onmouseenter="enter('-6521119560499060353');" onmouseout="out('-6521119560499060353');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308         String kv = String.join(&quot;:&quot;, keyData);                                                           </span>
<span class="7614186089505803066" onmouseenter="enter('7614186089505803066');" onmouseout="out('7614186089505803066');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309         String tableName = redisSideTableInfo.getTableName();                                            </span>
<span class="-5964725243621491152" onmouseenter="enter('-5964725243621491152');" onmouseout="out('-5964725243621491152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310         StringBuilder preKey =  new StringBuilder();                                                     </span>
<span class="-5172448576059326852" onmouseenter="enter('-5172448576059326852');" onmouseout="out('-5172448576059326852');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311         preKey.append(tableName).append(&quot;:&quot;).append(kv);                                                 </span>
<span class="4375341752415796420" onmouseenter="enter('4375341752415796420');" onmouseout="out('4375341752415796420');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312         return preKey.toString();                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 314 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315                                                                                                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 316 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 317                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 318     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 319     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 320         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 321         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 322             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 324         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 325             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 327         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 328             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 330         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 331             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333     }                                                                                                    </span>
<span  style=""> 334                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335 }                                                                                                        </span>








</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  18 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  27 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  28 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  30 import com.google.common.collect.Maps;                                                                   </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  31 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  32 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  33 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  34 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  35 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  36 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  37 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  38 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  41 import java.util.function.Consumer;                                                                      </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  42 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  43 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  44 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  45 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  46 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  47 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  48 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  49                                                                                                          </span>
<span  style="">  50                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  51 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  52  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  53  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  54 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  55     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  56                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  57     private RedisClient redisClient;                                                                     </span>
<span  style="">  58                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  59     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  60                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  61     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  62                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  63     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  64                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  65     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  66                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  67     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  68                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  69     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  70                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  71     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  71     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  72         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  73         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  76     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  77     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  78         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  79         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  80         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="7748152788990363550" onmouseenter="enter('7748152788990363550');" onmouseout="out('7748152788990363550');" style="">  83     private void buildRedisClient(RedisSideTableInfo tableInfo) {                                        </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  84         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  85         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="7919957419485840462" onmouseenter="enter('7919957419485840462');" onmouseout="out('7919957419485840462');" style="">  86         if (password != null) {                                                                          </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  87             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  88         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  89             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  91         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="-9026313238376494393" onmouseenter="enter('-9026313238376494393');" onmouseout="out('-9026313238376494393');" style="">  92         if (database == null) {                                                                          </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  93             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94         }                                                                                                </span>
<span class="-4392454403551039604" onmouseenter="enter('-4392454403551039604');" onmouseout="out('-4392454403551039604');" style="">  95         switch (RedisType.parse(tableInfo.getRedisType())) {                                             </span>
<span class="-2949951463250628099" onmouseenter="enter('-2949951463250628099');" onmouseout="out('-2949951463250628099');" style="">  96             case STANDALONE :                                                                            </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  97                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style="">  98                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style="">  99                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 100                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 101                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 102                 break;                                                                                   </span>
<span class="-2039731520025434486" onmouseenter="enter('-2039731520025434486');" onmouseout="out('-2039731520025434486');" style=""> 103             case SENTINEL :                                                                              </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 104                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-3743082660540527083" onmouseenter="enter('-3743082660540527083');" onmouseout="out('-3743082660540527083');" style=""><abbr title=" 105                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password).append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 105                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password).append(url).append(&quot;/&quot;).append(dðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 106                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 107                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 108                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 109                 break;                                                                                   </span>
<span class="-6189414154434577421" onmouseenter="enter('-6189414154434577421');" onmouseout="out('-6189414154434577421');" style=""> 110             case CLUSTER :                                                                               </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 111                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 112                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 113                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 114                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 115                 async = clusterConnection.async();                                                       </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 116             default :                                                                                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 117                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119     }                                                                                                    </span>
<span  style=""> 120                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 121     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 122     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 123         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124     }                                                                                                    </span>
<span  style=""> 125                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 126     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 127     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 127     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFðŸ”µ</abbr></span>
<span  style=""> 128                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 129 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130         String key = buildCacheKey(inputParams);                                                         </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131         Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132         List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                               </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 133         String[] values = value.toArray(new String[value.size()]);                                       </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 134         if (values.length == 0) {                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 135             dealMissKey(input, resultFuture);                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 136         } else {                                                                                         </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 137             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values);"> 137             RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(ðŸ”µ</abbr></span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 138             future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 139                 @Override                                                                                </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 140                 public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                           </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 141                     if (keyValues.size() != 0) {                                                         </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 142                         for (int i = 0; i &lt; keyValues.size(); i++) {                                     </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 143                             String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);      </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 144                             keyValue.put(splitKeys[1], splitKeys[2]);                                    </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                             keyValue.put(splitKeys[3], keyValues.get(i).getValue());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146                         }                                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147                         try {                                                                            </span>
<span class="-2820718685971995659" onmouseenter="enter('-2820718685971995659');" onmouseout="out('-2820718685971995659');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 148                             Row row = fillData(input.row(), keyValue);                                   </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 149                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));"> 149                             dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValðŸ”µ</abbr></span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 150                             resultFuture.complete(Collections.singleton(new CRow(row, input.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 151                         } catch (Exception e) {                                                          </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 152                             dealFillDataError(resultFuture, e, input);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 153                         }                                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 154                     } else {                                                                             </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 155                         dealMissKey(input, resultFuture);                                                </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 156                         dealCacheData(key, CacheMissVal.getMissKeyObj());                                </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 157                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 158 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 159 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 159 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 160 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161                                                                                                          </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-7758690600237266983" onmouseenter="enter('-7758690600237266983');" onmouseout="out('-7758690600237266983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163         Map&lt;String, Object&gt; refData = Maps.newHashMap();                                                 </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166             Object equalObj = input.row().getField(conValIndex);                                         </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167             if(equalObj == null){                                                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170             }                                                                                            </span>
<span class="85629276949166904" onmouseenter="enter('85629276949166904');" onmouseout="out('85629276949166904');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171             refData.put(sideInfo.getEqualFieldList().get(i), equalObj);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173                                                                                                          </span>
<span class="5100915750795106940" onmouseenter="enter('5100915750795106940');" onmouseout="out('5100915750795106940');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174         String key = buildCacheKey(refData);                                                             </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177         }                                                                                                </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178         if(openCache()){                                                                                 </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179             CacheObj val = getFromCache(key);                                                            </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180             if(val != null){                                                                             </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181                 if(ECacheContentType.MissVal == val.getType()){                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183                     return;                                                                              </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184                 }else if(ECacheContentType.MultiLine == val.getType()){                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185                     try {                                                                                </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186                         Row row = fillData(input.row(), val.getContent());                               </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 188                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 190                     }                                                                                    </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191                 }else{                                                                                   </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 192                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 192                     RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + valðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193                     resultFuture.completeExceptionally(exception);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198                                                                                                          </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204                     try {                                                                                </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 205                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 206                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 207                         resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change()))); </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208                     } catch (Exception e) {                                                              </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209                         dealFillDataError(resultFuture, e, inputCopy);                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210                                                                                                          </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 211 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 213                 } else {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 214                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 215                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 218         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219     }                                                                                                    </span>
<span  style=""> 220                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 221     @Override                                                                                            </span>
<span class="4952527391614247512" onmouseenter="enter('4952527391614247512');" onmouseout="out('4952527391614247512');" style=""> 222     public String buildCacheKey(Map&lt;String,                                                              </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 223 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="-2580540349855590762" onmouseenter="enter('-2580540349855590762');" onmouseout="out('-2580540349855590762');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 224 Object                                                                                                   </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 225 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 226 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 226 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 227 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228                                                                                                          </span>
<span class="-2580540349855590762" onmouseenter="enter('-2580540349855590762');" onmouseout="out('-2580540349855590762');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229 Object                                                                                                   </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 230 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-8496499409701436774" onmouseenter="enter('-8496499409701436774');" onmouseout="out('-8496499409701436774');" style=""> 231     &gt;                                                                                                    </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 232 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="6116536713350583022" onmouseenter="enter('6116536713350583022');" onmouseout="out('6116536713350583022');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 233 inputParams                                                                                              </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 234 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 235 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 235 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 236 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237                                                                                                          </span>
<span class="4269427887609020487" onmouseenter="enter('4269427887609020487');" onmouseout="out('4269427887609020487');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238 refData                                                                                                  </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 239 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-1344992967432647558" onmouseenter="enter('-1344992967432647558');" onmouseout="out('-1344992967432647558');" style=""> 240     ) {                                                                                                  </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 241         StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                 </span>
<span class="9198008703294342533" onmouseenter="enter('9198008703294342533');" onmouseout="out('9198008703294342533');" style=""> 242         List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys(inputParams.values(), &quot;:&quot;);         </span>
<span class="21476828095204078" onmouseenter="enter('21476828095204078');" onmouseout="out('21476828095204078');" style=""> 243         for (String primaryKey : primaryKeys) {                                                          </span>
<span class="-1192912929310033990" onmouseenter="enter('-1192912929310033990');" onmouseout="out('-1192912929310033990');" style=""> 244             if (!refData.containsKey(primaryKey)) {                                                      </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 245                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246             }                                                                                            </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 247             keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248         }                                                                                                </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 249         return keyBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 252     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 253     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 254         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 255         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 256             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 258         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 259             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 261         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 262             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 264         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 265             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268 }                                                                                                        </span>











































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  23  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  25  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  26  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  28                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  29  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  30  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  31  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  32  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>

<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  34  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  35  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  36  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  37  import com.google.common.collect.Maps;                                                                            </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="">  38  import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  39  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  40  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  41  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>

<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  42  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="">  43  import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  44  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  45  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  46  import org.apache.commons.lang3.StringUtils;                                                                      </span>



<span  style="">  47                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  51  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  52  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  53   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  55  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  56                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  57      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  58                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  59      private RedisClient redisClient;                                                                              </span>
<span  style="">  60                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  61      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  62                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  63      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  64                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  65      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  66                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  67      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  68                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  69      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  70                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  71      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  72                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  73      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  73      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  74          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  75          redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  78      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  79      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  80          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  81          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  82          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83      }                                                                                                             </span>
<span  style="">  84                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  85      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  86          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  87          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  88          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  89              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  90          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  91              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  93          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  94          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  95              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96          }                                                                                                         </span>
<span class="2197270836708388999" onmouseenter="enter('2197270836708388999');" onmouseout="out('2197270836708388999');" style="">  97          switch (tableInfo.getRedisType()){                                                                        </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style="">  98              case 1:                                                                                               </span>


<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style="">  99                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 100                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 101                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 102                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 103                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 104                  break;                                                                                            </span>
<span class="1568233748741705754" onmouseenter="enter('1568233748741705754');" onmouseout="out('1568233748741705754');" style=""> 105              case 2:                                                                                               </span>

<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 106                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 107                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 108                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 108                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 109                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 110                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 111                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 112                  break;                                                                                            </span>
<span class="6137898315495918692" onmouseenter="enter('6137898315495918692');" onmouseout="out('6137898315495918692');" style=""> 113              case 3:                                                                                               </span>

<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 114                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 115                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 116                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 117                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 118                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 119              default:                                                                                              </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121      }                                                                                                             </span>
<span  style=""> 122                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 123      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 124      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 125          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126      }                                                                                                             </span>
<span  style=""> 127                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 128      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="-4706706522308261371" onmouseenter="enter('-4706706522308261371');" onmouseout="out('-4706706522308261371');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -        CRow inputCopy = new CRow(input.row(),input.change());                                                    </span>
<span class="-303153469629925649" onmouseenter="enter('-303153469629925649');" onmouseout="out('-303153469629925649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -        List&lt;String&gt; keyData = Lists.newLinkedList();                                                             </span>


<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -        for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -            Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -            Object equalObj = inputCopy.row().getField(conValIndex);                                              </span>

<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -            if(equalObj == null){                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -                dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -            }                                                                                                     </span>
<span class="2887844577456871278" onmouseenter="enter('2887844577456871278');" onmouseout="out('2887844577456871278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -            String value = equalObj.toString();                                                                   </span>
<span class="-2170493469799044193" onmouseenter="enter('-2170493469799044193');" onmouseout="out('-2170493469799044193');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -            keyData.add(sideInfo.getEqualFieldList().get(i));                                                     </span>
<span class="3849389580127899071" onmouseenter="enter('3849389580127899071');" onmouseout="out('3849389580127899071');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -            keyData.add(value);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -                                                                                                                  </span>
<span class="-8711689112925343628" onmouseenter="enter('-8711689112925343628');" onmouseout="out('-8711689112925343628');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -        String key = buildCacheKey(keyData);                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -                                                                                                                  </span>







<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -        if(openCache()){                                                                                          </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -            CacheObj val = getFromCache(key);                                                                     </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -            if(val != null){                                                                                      </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                if(ECacheContentType.MissVal == val.getType()){                                                   </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -                    dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 151 -                    return;                                                                                       </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -                }else if(ECacheContentType.MultiLine == val.getType()){                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -                    try {                                                                                         </span>
<span class="6802212136073345643" onmouseenter="enter('6802212136073345643');" onmouseout="out('6802212136073345643');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -                        Row row = fillData(inputCopy.row(), val.getContent());                                    </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>


<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -                    } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -                        dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -                    }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -                }else{                                                                                            </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 160 -                    RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 160 -                    RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType(ðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -                    resultFuture.completeExceptionally(exception);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -                                                                                                                  </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 167 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 167 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) thðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +        String key = buildCacheKey(inputParams);                                                                  </span>
<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style=""> 169          Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                         </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style=""> 170          List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                                        </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style=""> 171          String[] values = value.toArray(new String[value.size()]);                                                </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style=""> 172          if (values.length == 0) {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -            dealMissKey(inputCopy, resultFuture);                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +            dealMissKey(input, resultFuture);                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 175          } else {                                                                                                  </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style=""> 176              RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values); </span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style=""> 177              future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 178                  @Override                                                                                         </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style=""> 179                  public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                                    </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style=""> 180                      if (keyValues.size() != 0) {                                                                  </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style=""> 181                          for (int i = 0; i &lt; keyValues.size(); i++) {                                              </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style=""> 182                              String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);               </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style=""> 183                              keyValue.put(splitKeys[1], splitKeys[2]);                                             </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style=""> 184                              keyValue.put(splitKeys[3], keyValues.get(i).getValue());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185                          }                                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 186                          try {                                                                                     </span>
<span class="5367810708668286095" onmouseenter="enter('5367810708668286095');" onmouseout="out('5367810708668286095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -                            Row row = fillData(inputCopy.row(), keyValue);                                        </span>
<span class="-2820718685971995659" onmouseenter="enter('-2820718685971995659');" onmouseout="out('-2820718685971995659');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +                            Row row = fillData(input.row(), keyValue);                                            </span>
<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style=""> 189                              dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));    </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                            resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));      </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +                            resultFuture.complete(Collections.singleton(new CRow(row, input.change())));          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 192                          } catch (Exception e) {                                                                   </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                            dealFillDataError(resultFuture, e, inputCopy);                                        </span>
<span class="-3844853042986402173" onmouseenter="enter('-3844853042986402173');" onmouseout="out('-3844853042986402173');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +                            dealFillDataError(resultFuture, e, input);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195                          }                                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 196                      } else {                                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                        dealMissKey(inputCopy, resultFuture);                                                     </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +                        dealMissKey(input, resultFuture);                                                         </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 199                          dealCacheData(key, CacheMissVal.getMissKeyObj());                                         </span>











<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200                      }                                                                                             </span>



<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201                  }                                                                                                 </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 202              });                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="-4874568584154894582" onmouseenter="enter('-4874568584154894582');" onmouseout="out('-4874568584154894582');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -    private String buildCacheKey(List&lt;String&gt; keyData) {                                                          </span>
<span class="-6521119560499060353" onmouseenter="enter('-6521119560499060353');" onmouseout="out('-6521119560499060353');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -        String kv = String.join(&quot;:&quot;, keyData);                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 208 +    @Override                                                                                                     </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 209 +    public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                                </span>
<span class="4719873832516487915" onmouseenter="enter('4719873832516487915');" onmouseout="out('4719873832516487915');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 210 +        String kv = StringUtils.join(inputParams.values(), &quot;:&quot;);                                                  </span>
<span class="7614186089505803066" onmouseenter="enter('7614186089505803066');" onmouseout="out('7614186089505803066');" style=""> 211          String tableName = redisSideTableInfo.getTableName();                                                     </span>
<span class="-5964725243621491152" onmouseenter="enter('-5964725243621491152');" onmouseout="out('-5964725243621491152');" style=""> 212          StringBuilder preKey =  new StringBuilder();                                                              </span>
<span class="-5172448576059326852" onmouseenter="enter('-5172448576059326852');" onmouseout="out('-5172448576059326852');" style=""> 213          preKey.append(tableName).append(&quot;:&quot;).append(kv);                                                          </span>
<span class="4375341752415796420" onmouseenter="enter('4375341752415796420');" onmouseout="out('4375341752415796420');" style=""> 214          return preKey.toString();                                                                                 </span>














<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215      }                                                                                                             </span>
<span  style=""> 216                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 217      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 218      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 219          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 220          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 221              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 223          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 224              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 226          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 227              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 229          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 230              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232      }                                                                                                             </span>
<span  style=""> 233                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  23  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  25  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  26  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  28                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  29  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  30  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  31  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  32  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  33  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  34 +import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  35  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  36  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import com.google.common.collect.Maps;                                                                            </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  40  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  41  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  42  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  44  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  46  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  47  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  49 +import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 +import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import com.google.common.collect.Maps;                                                                            </span>
<span  style="">  52                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  53  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  54  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  55  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  56  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  57  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  58   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  59   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  60  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  61                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  62      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  63                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  64      private RedisClient redisClient;                                                                              </span>
<span  style="">  65                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  66      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  67                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  68      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  69                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  70      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  71                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  72      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  73                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  74      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  75                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  76      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  77                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  78      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  78      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  79          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  80          redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81      }                                                                                                             </span>
<span  style="">  82                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  84      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  85          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  86          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  87          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88      }                                                                                                             </span>
<span  style="">  89                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  90      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  91          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  92          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  93          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  94              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  95          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  96              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  98          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  99          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style=""> 100              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101          }                                                                                                         </span>
<span class="2197270836708388999" onmouseenter="enter('2197270836708388999');" onmouseout="out('2197270836708388999');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -        switch (tableInfo.getRedisType()){                                                                        </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -            case 1:                                                                                               </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 104 +        switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 105 +            case STANDALONE:                                                                                      </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 106                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 107                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 108                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 109                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 110                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 111                  break;                                                                                            </span>
<span class="1568233748741705754" onmouseenter="enter('1568233748741705754');" onmouseout="out('1568233748741705754');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -            case 2:                                                                                               </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +            case SENTINEL:                                                                                        </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 114                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 115                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 116                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 116                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 117                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 118                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 119                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 120                  break;                                                                                            </span>
<span class="6137898315495918692" onmouseenter="enter('6137898315495918692');" onmouseout="out('6137898315495918692');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -            case 3:                                                                                               </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +            case CLUSTER:                                                                                         </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 123                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 124                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 125                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 126                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 127                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 128              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +                break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131      }                                                                                                             </span>
<span  style=""> 132                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 133      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 134      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 135          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136      }                                                                                                             </span>
<span  style=""> 137                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style=""> 139      public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="-4706706522308261371" onmouseenter="enter('-4706706522308261371');" onmouseout="out('-4706706522308261371');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -        CRow inputCopy = new CRow(input.row(),input.change());                                                    </span>
<span class="-303153469629925649" onmouseenter="enter('-303153469629925649');" onmouseout="out('-303153469629925649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        List&lt;String&gt; keyData = Lists.newLinkedList();                                                             </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +        CRow inputCopy = new CRow(input.row(), input.change());                                                   </span>
<span class="-7758690600237266983" onmouseenter="enter('-7758690600237266983');" onmouseout="out('-7758690600237266983');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +        Map&lt;String, Object&gt; refData = Maps.newHashMap();                                                          </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 144          for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 145              Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -            Object equalObj = inputCopy.row().getField(conValIndex);                                              </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +            Object equalObj = input.row().getField(conValIndex);                                                  </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 148              if(equalObj == null){                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 149                  dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 150                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151              }                                                                                                     </span>
<span class="2887844577456871278" onmouseenter="enter('2887844577456871278');" onmouseout="out('2887844577456871278');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -            String value = equalObj.toString();                                                                   </span>
<span class="-2170493469799044193" onmouseenter="enter('-2170493469799044193');" onmouseout="out('-2170493469799044193');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -            keyData.add(sideInfo.getEqualFieldList().get(i));                                                     </span>
<span class="3849389580127899071" onmouseenter="enter('3849389580127899071');" onmouseout="out('3849389580127899071');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -            keyData.add(value);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -                                                                                                                  </span>
<span class="-8711689112925343628" onmouseenter="enter('-8711689112925343628');" onmouseout="out('-8711689112925343628');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -        String key = buildCacheKey(keyData);                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -                                                                                                                  </span>
<span class="85629276949166904" onmouseenter="enter('85629276949166904');" onmouseout="out('85629276949166904');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +            refData.put(sideInfo.getEqualFieldList().get(i), equalObj);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +        }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +                                                                                                                  </span>
<span class="5100915750795106940" onmouseenter="enter('5100915750795106940');" onmouseout="out('5100915750795106940');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +        String key = buildCacheKey(refData);                                                                      </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +        if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +        }                                                                                                         </span>
<span class="5381833647003229829" onmouseenter="enter('5381833647003229829');" onmouseout="out('5381833647003229829');" style=""> 166          if(openCache()){                                                                                          </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style=""> 167              CacheObj val = getFromCache(key);                                                                     </span>
<span class="7405568993436942391" onmouseenter="enter('7405568993436942391');" onmouseout="out('7405568993436942391');" style=""> 168              if(val != null){                                                                                      </span>
<span class="-5257918970192190871" onmouseenter="enter('-5257918970192190871');" onmouseout="out('-5257918970192190871');" style=""> 169                  if(ECacheContentType.MissVal == val.getType()){                                                   </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 170                      dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 171                      return;                                                                                       </span>
<span class="-3336838396512225091" onmouseenter="enter('-3336838396512225091');" onmouseout="out('-3336838396512225091');" style=""> 172                  }else if(ECacheContentType.MultiLine == val.getType()){                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 173                      try {                                                                                         </span>
<span class="6802212136073345643" onmouseenter="enter('6802212136073345643');" onmouseout="out('6802212136073345643');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -                        Row row = fillData(inputCopy.row(), val.getContent());                                    </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +                        Row row = fillData(input.row(), val.getContent());                                        </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +                        resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 178                      } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style=""> 179                          dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180                      }                                                                                             </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 181                  }else{                                                                                            </span>
<span class="-225535239073884393" onmouseenter="enter('-225535239073884393');" onmouseout="out('-225535239073884393');" style=""><abbr title=" 182                      RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType());"> 182                      RuntimeException exception = new RuntimeException(&quot;not support cache obj type &quot; + val.getType(ðŸ”µ</abbr></span>
<span class="-4832941612496907275" onmouseenter="enter('-4832941612496907275');" onmouseout="out('-4832941612496907275');" style=""> 183                      resultFuture.completeExceptionally(exception);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 185                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187          }                                                                                                         </span>
<span  style=""> 188                                                                                                                    </span>


<span class="7216486663177643691" onmouseenter="enter('7216486663177643691');" onmouseout="out('7216486663177643691');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -        Map&lt;String, String&gt; keyValue = Maps.newHashMap();                                                         </span>
<span class="216556070174537721" onmouseenter="enter('216556070174537721');" onmouseout="out('216556070174537721');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -        List&lt;String&gt; value = async.keys(key + &quot;:*&quot;).get();                                                        </span>
<span class="2894140600140114317" onmouseenter="enter('2894140600140114317');" onmouseout="out('2894140600140114317');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -        String[] values = value.toArray(new String[value.size()]);                                                </span>
<span class="-5941444948197680725" onmouseenter="enter('-5941444948197680725');" onmouseout="out('-5941444948197680725');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -        if (values.length == 0) {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -            dealMissKey(inputCopy, resultFuture);                                                                 </span>

<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -        } else {                                                                                                  </span>
<span class="6769767562859473482" onmouseenter="enter('6769767562859473482');" onmouseout="out('6769767562859473482');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -            RedisFuture&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt; future = ((RedisStringAsyncCommands) async).mget(values); </span>
<span class="6535806676848184604" onmouseenter="enter('6535806676848184604');" onmouseout="out('6535806676848184604');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -            future.thenAccept(new Consumer&lt;List&lt;KeyValue&lt;String, String&gt;&gt;&gt;() {                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -                @Override                                                                                         </span>
<span class="5858188065373765092" onmouseenter="enter('5858188065373765092');" onmouseout="out('5858188065373765092');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                public void accept(List&lt;KeyValue&lt;String, String&gt;&gt; keyValues) {                                    </span>
<span class="819015419855286921" onmouseenter="enter('819015419855286921');" onmouseout="out('819015419855286921');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -                    if (keyValues.size() != 0) {                                                                  </span>
<span class="2232130946141587100" onmouseenter="enter('2232130946141587100');" onmouseout="out('2232130946141587100');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -                        for (int i = 0; i &lt; keyValues.size(); i++) {                                              </span>
<span class="2333173142818872926" onmouseenter="enter('2333173142818872926');" onmouseout="out('2333173142818872926');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                            String[] splitKeys = StringUtils.split(keyValues.get(i).getKey(), &quot;:&quot;);               </span>
<span class="-1624370516862024706" onmouseenter="enter('-1624370516862024706');" onmouseout="out('-1624370516862024706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                            keyValue.put(splitKeys[1], splitKeys[2]);                                             </span>
<span class="-7673682185957687298" onmouseenter="enter('-7673682185957687298');" onmouseout="out('-7673682185957687298');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -                            keyValue.put(splitKeys[3], keyValues.get(i).getValue());                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                        }                                                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                        try {                                                                                     </span>
<span class="5367810708668286095" onmouseenter="enter('5367810708668286095');" onmouseout="out('5367810708668286095');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -                            Row row = fillData(inputCopy.row(), keyValue);                                        </span>

<span class="5913183826596228903" onmouseenter="enter('5913183826596228903');" onmouseout="out('5913183826596228903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -                            dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, keyValue));    </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -                            resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));      </span>

<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                        } catch (Exception e) {                                                                   </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -                            dealFillDataError(resultFuture, e, inputCopy);                                        </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                        }                                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -                    } else {                                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -                        dealMissKey(inputCopy, resultFuture);                                                     </span>

<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -                        dealCacheData(key, CacheMissVal.getMissKeyObj());                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 215 +        RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 216 +        future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 217 +            @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +            public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 219 +                if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +                    try {                                                                                         </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +                        Row row = fillData(input.row(), values);                                                  </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 222 +                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));           </span>
<span class="-1505167640152627246" onmouseenter="enter('-1505167640152627246');" onmouseout="out('-1505167640152627246');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 223 +                        resultFuture.complete(Collections.singleton(new CRow(row, inputCopy.change())));          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 224 +                    } catch (Exception e) {                                                                       </span>
<span class="9180165165607029377" onmouseenter="enter('9180165165607029377');" onmouseout="out('9180165165607029377');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 225 +                        dealFillDataError(resultFuture, e, inputCopy);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 227 +                } else {                                                                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 228 +                    dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 229 +                    dealCacheData(key,CacheMissVal.getMissKeyObj());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230                  }                                                                                                 </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -            });                                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -                                                                                                                  </span>
<span class="-4874568584154894582" onmouseenter="enter('-4874568584154894582');" onmouseout="out('-4874568584154894582');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -    private String buildCacheKey(List&lt;String&gt; keyData) {                                                          </span>
<span class="-6521119560499060353" onmouseenter="enter('-6521119560499060353');" onmouseout="out('-6521119560499060353');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        String kv = String.join(&quot;:&quot;, keyData);                                                                    </span>



<span class="7614186089505803066" onmouseenter="enter('7614186089505803066');" onmouseout="out('7614186089505803066');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -        String tableName = redisSideTableInfo.getTableName();                                                     </span>
<span class="-5964725243621491152" onmouseenter="enter('-5964725243621491152');" onmouseout="out('-5964725243621491152');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -        StringBuilder preKey =  new StringBuilder();                                                              </span>
<span class="-5172448576059326852" onmouseenter="enter('-5172448576059326852');" onmouseout="out('-5172448576059326852');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -        preKey.append(tableName).append(&quot;:&quot;).append(kv);                                                          </span>
<span class="4375341752415796420" onmouseenter="enter('4375341752415796420');" onmouseout="out('4375341752415796420');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -        return preKey.toString();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 241 +            }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 242 +        });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 243 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 244 +                                                                                                                  </span>
<span class="6901897164566696834" onmouseenter="enter('6901897164566696834');" onmouseout="out('6901897164566696834');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 245 +    private String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                   </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 246 +        StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                          </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 247 +        List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                           </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 248 +        for(String primaryKey : primaryKeys){                                                                     </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 249 +            if(!refData.containsKey(primaryKey)){                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 250 +                return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 251 +            }                                                                                                     </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +            keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 253 +        }                                                                                                         </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 254 +        return keyBuilder.toString();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255      }                                                                                                             </span>
<span  style=""> 256                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 257      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 258      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 259          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 260          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 261              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 263          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 264              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 266          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 267              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 269          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 270              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            