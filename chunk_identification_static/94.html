<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>94</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    94
                    <a href="93.html">prev</a>
                    <a href="95.html">next</a>
                    <a href="94_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    CarGuo/GSYVideoPlayer_a1061d62099001b02357c265e6d4fce0b95a66fc_gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/ExoSourceManager.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;a1061d62099001b02357c265e6d4fce0b95a66fc:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/ExoSourceManager.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;a1061d62099001b02357c265e6d4fce0b95a66fc^1:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/ExoSourceManager.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;a1061d62099001b02357c265e6d4fce0b95a66fc^2:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/ExoSourceManager.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CarGuo\GSYVideoPlayer show &quot;0bbf9d653eac231e9add9fe4bd2073e7054970dc:gsyVideoPlayer-exo_player2/src/main/java/tv/danmaku/ijk/media/exo2/ExoSourceManager.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj], [b], [bj], [j], [s]], subset: [[bsj], [bj], [bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-5503081748616462646" onmouseenter="enter('-5503081748616462646');" onmouseout="out('-5503081748616462646');" style="">   1 package tv.danmaku.ijk.media.exo2;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-3997288425915246049" onmouseenter="enter('-3997288425915246049');" onmouseout="out('-3997288425915246049');" style="">   3 import android.annotation.SuppressLint;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5 import android.net.Uri;                                                                                  </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   6 import android.text.TextUtils;                                                                           </span>
<span  style="">   7                                                                                                          </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   8 import androidx.annotation.NonNull;                                                                      </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">   9 import androidx.annotation.Nullable;                                                                     </span>
<span  style="">  10                                                                                                          </span>
<span class="1487611449423756792" onmouseenter="enter('1487611449423756792');" onmouseout="out('1487611449423756792');" style="">  11 import com.google.android.exoplayer2.C;                                                                  </span>
<span class="867094050949454463" onmouseenter="enter('867094050949454463');" onmouseout="out('867094050949454463');" style="">  12 import com.google.android.exoplayer2.MediaItem;                                                          </span>
<span class="-3172072599128556050" onmouseenter="enter('-3172072599128556050');" onmouseout="out('-3172072599128556050');" style="">  13 import com.google.android.exoplayer2.database.DatabaseProvider;                                          </span>
<span class="-2844689653783287849" onmouseenter="enter('-2844689653783287849');" onmouseout="out('-2844689653783287849');" style="">  14 import com.google.android.exoplayer2.ext.rtmp.RtmpDataSourceFactory;                                     </span>
<span class="3675920877003625902" onmouseenter="enter('3675920877003625902');" onmouseout="out('3675920877003625902');" style="">  15 import com.google.android.exoplayer2.extractor.DefaultExtractorsFactory;                                 </span>
<span class="-6167091960224777303" onmouseenter="enter('-6167091960224777303');" onmouseout="out('-6167091960224777303');" style="">  16 import com.google.android.exoplayer2.source.MediaSource;                                                 </span>
<span class="-3105544688913650545" onmouseenter="enter('-3105544688913650545');" onmouseout="out('-3105544688913650545');" style="">  17 import com.google.android.exoplayer2.source.ProgressiveMediaSource;                                      </span>
<span class="-4960919004069838122" onmouseenter="enter('-4960919004069838122');" onmouseout="out('-4960919004069838122');" style="">  18 import com.google.android.exoplayer2.source.dash.DashMediaSource;                                        </span>
<span class="-4413409349911342092" onmouseenter="enter('-4413409349911342092');" onmouseout="out('-4413409349911342092');" style="">  19 import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;                                 </span>
<span class="392947657445256672" onmouseenter="enter('392947657445256672');" onmouseout="out('392947657445256672');" style="">  20 import com.google.android.exoplayer2.source.hls.HlsMediaSource;                                          </span>
<span class="1080782699538105726" onmouseenter="enter('1080782699538105726');" onmouseout="out('1080782699538105726');" style="">  21 import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;                        </span>
<span class="-8280776144719855835" onmouseenter="enter('-8280776144719855835');" onmouseout="out('-8280776144719855835');" style="">  22 import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;                               </span>
<span class="-5025142600139113447" onmouseenter="enter('-5025142600139113447');" onmouseout="out('-5025142600139113447');" style="">  23 import com.google.android.exoplayer2.upstream.DataSource;                                                </span>
<span class="-6054887794217826236" onmouseenter="enter('-6054887794217826236');" onmouseout="out('-6054887794217826236');" style="">  24 import com.google.android.exoplayer2.upstream.DataSpec;                                                  </span>
<span class="-1926464862603214616" onmouseenter="enter('-1926464862603214616');" onmouseout="out('-1926464862603214616');" style="">  25 import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;                                     </span>
<span class="7691807062585918827" onmouseenter="enter('7691807062585918827');" onmouseout="out('7691807062585918827');" style="">  26 import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;                                  </span>
<span class="8221609960337784667" onmouseenter="enter('8221609960337784667');" onmouseout="out('8221609960337784667');" style="">  27 import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;                                     </span>
<span class="3684976669809945769" onmouseenter="enter('3684976669809945769');" onmouseout="out('3684976669809945769');" style="">  28 import com.google.android.exoplayer2.upstream.RawResourceDataSource;                                     </span>
<span class="3791899211787747371" onmouseenter="enter('3791899211787747371');" onmouseout="out('3791899211787747371');" style="">  29 import com.google.android.exoplayer2.upstream.cache.Cache;                                               </span>
<span class="-8148834636982163692" onmouseenter="enter('-8148834636982163692');" onmouseout="out('-8148834636982163692');" style="">  30 import com.google.android.exoplayer2.upstream.cache.CacheDataSource;                                     </span>
<span class="-8685955199172896893" onmouseenter="enter('-8685955199172896893');" onmouseout="out('-8685955199172896893');" style="">  31 import com.google.android.exoplayer2.upstream.cache.CacheKeyFactory;                                     </span>
<span class="-4601203435061269454" onmouseenter="enter('-4601203435061269454');" onmouseout="out('-4601203435061269454');" style="">  32 import com.google.android.exoplayer2.upstream.cache.CacheSpan;                                           </span>
<span class="-8498858967217479983" onmouseenter="enter('-8498858967217479983');" onmouseout="out('-8498858967217479983');" style="">  33 import com.google.android.exoplayer2.upstream.cache.ContentMetadata;                                     </span>
<span class="-2820765455975363243" onmouseenter="enter('-2820765455975363243');" onmouseout="out('-2820765455975363243');" style="">  34 import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;                       </span>
<span class="-7748643470419441439" onmouseenter="enter('-7748643470419441439');" onmouseout="out('-7748643470419441439');" style="">  35 import com.google.android.exoplayer2.upstream.cache.SimpleCache;                                         </span>
<span class="-1809507180972376256" onmouseenter="enter('-1809507180972376256');" onmouseout="out('-1809507180972376256');" style="">  36 import com.google.android.exoplayer2.util.Util;                                                          </span>
<span class="-5152250604397781057" onmouseenter="enter('-5152250604397781057');" onmouseout="out('-5152250604397781057');" style="">  37 import com.google.common.base.Ascii;                                                                     </span>
<span  style="">  38                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39 import java.io.File;                                                                                     </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  40 import java.util.Locale;                                                                                 </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  41 import java.util.Map;                                                                                    </span>
<span class="-5539540480142207555" onmouseenter="enter('-5539540480142207555');" onmouseout="out('-5539540480142207555');" style="">  42 import java.util.NavigableSet;                                                                           </span>
<span  style="">  43                                                                                                          </span>
<span  style="">  44                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45 /**                                                                                                      </span>
<span class="-3817795341581382404" onmouseenter="enter('-3817795341581382404');" onmouseout="out('-3817795341581382404');" style="">  46  * Created by guoshuyu on 2018/5/18.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47  */                                                                                                      </span>
<span  style="">  48                                                                                                          </span>
<span class="5978956340021809315" onmouseenter="enter('5978956340021809315');" onmouseout="out('5978956340021809315');" style="">  49 public class ExoSourceManager {                                                                          </span>
<span  style="">  50                                                                                                          </span>
<span class="2143614905519812283" onmouseenter="enter('2143614905519812283');" onmouseout="out('2143614905519812283');" style="">  51     private static final String TAG = &quot;ExoSourceManager&quot;;                                                </span>
<span  style="">  52                                                                                                          </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="">  53     private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                      </span>
<span  style="">  54                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  55 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-7434648719207555161" onmouseenter="enter('-7434648719207555161');" onmouseout="out('-7434648719207555161');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56     public static final int TYPE_RTMP = 100;                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  57 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58     private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59                                                                                                          </span>
<span class="2805559058863362301" onmouseenter="enter('2805559058863362301');" onmouseout="out('2805559058863362301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60     public static final int TYPE_RTMP = 4;                                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  61 =======                                                                                                  </span>
<span class="4060007595904198083" onmouseenter="enter('4060007595904198083');" onmouseout="out('4060007595904198083');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62     public static final int TYPE_RTMP = 14;                                                              </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  63 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  64                                                                                                          </span>
<span class="2866779009294581851" onmouseenter="enter('2866779009294581851');" onmouseout="out('2866779009294581851');" style="">  65     private static Cache mCache;                                                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  66     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style="">  67      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  68      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style="">  69      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  70      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  71     @Deprecated                                                                                          </span>
<span class="6733722337026437480" onmouseenter="enter('6733722337026437480');" onmouseout="out('6733722337026437480');" style="">  72     private static boolean sSkipSSLChain = false;                                                        </span>
<span  style="">  73                                                                                                          </span>
<span class="-8322579848361947255" onmouseenter="enter('-8322579848361947255');" onmouseout="out('-8322579848361947255');" style="">  74     private static int sHttpReadTimeout = -1;                                                            </span>
<span  style="">  75                                                                                                          </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="">  76     private static int sHttpConnectTimeout = -1;                                                         </span>
<span  style="">  77                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  78 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  79                                                                                                          </span>
<span class="2978752276401696079" onmouseenter="enter('2978752276401696079');" onmouseout="out('2978752276401696079');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  80     private static final boolean s = false;                                                              </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  81                                                                                                          </span>
<span class="7019408237288028740" onmouseenter="enter('7019408237288028740');" onmouseout="out('7019408237288028740');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  82     private final Context mAppContext;                                                                   </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  83 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84     private static int sHttpConnectTimeout = -1;                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                                                                                                          </span>
<span class="-1940276823349157224" onmouseenter="enter('-1940276823349157224');" onmouseout="out('-1940276823349157224');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87     private static boolean s = false;                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88                                                                                                          </span>
<span class="-2042973733649017522" onmouseenter="enter('-2042973733649017522');" onmouseout="out('-2042973733649017522');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89     private Context mAppContext;                                                                         </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  90 =======                                                                                                  </span>
<span class="-2042973733649017522" onmouseenter="enter('-2042973733649017522');" onmouseout="out('-2042973733649017522');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91     private Context mAppContext;                                                                         </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  92 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style="">  93                                                                                                          </span>
<span class="-4374222225418050568" onmouseenter="enter('-4374222225418050568');" onmouseout="out('-4374222225418050568');" style="">  94     private final Map&lt;String, String&gt; mMapHeadData;                                                      </span>
<span  style="">  95                                                                                                          </span>
<span class="2720391937428942309" onmouseenter="enter('2720391937428942309');" onmouseout="out('2720391937428942309');" style="">  96     private String mDataSource;                                                                          </span>
<span  style="">  97                                                                                                          </span>
<span class="898136537903361042" onmouseenter="enter('898136537903361042');" onmouseout="out('898136537903361042');" style="">  98     private static ExoMediaSourceInterceptListener sExoMediaSourceInterceptListener;                     </span>
<span class="8633327969830562634" onmouseenter="enter('8633327969830562634');" onmouseout="out('8633327969830562634');" style="">  99     private static DatabaseProvider sDatabaseProvider;                                                   </span>
<span  style=""> 100                                                                                                          </span>
<span class="-2905075036207193429" onmouseenter="enter('-2905075036207193429');" onmouseout="out('-2905075036207193429');" style=""> 101     private boolean isCached = false;                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="-3397611666931429980" onmouseenter="enter('-3397611666931429980');" onmouseout="out('-3397611666931429980');" style=""><abbr title=" 103     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData) {"> 103     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData🔵</abbr></span>
<span class="-6448993279383120903" onmouseenter="enter('-6448993279383120903');" onmouseout="out('-6448993279383120903');" style=""> 104         return new ExoSourceManager(context, mapHeadData);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105     }                                                                                                    </span>
<span  style=""> 106                                                                                                          </span>
<span class="-2557713181218471643" onmouseenter="enter('-2557713181218471643');" onmouseout="out('-2557713181218471643');" style=""> 107     private ExoSourceManager(Context context, Map&lt;String, String&gt; mapHeadData) {                         </span>
<span class="7302624818817228010" onmouseenter="enter('7302624818817228010');" onmouseout="out('7302624818817228010');" style=""> 108         mAppContext = context.getApplicationContext();                                                   </span>
<span class="3872213483840267174" onmouseenter="enter('3872213483840267174');" onmouseout="out('3872213483840267174');" style=""> 109         mMapHeadData = mapHeadData;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span  style=""> 111                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 112     /**                                                                                                  </span>
<span class="-8955960166298079068" onmouseenter="enter('-8955960166298079068');" onmouseout="out('-8955960166298079068');" style=""> 113      * @param dataSource  链接                                                                             </span>
<span class="-8878537572148364092" onmouseenter="enter('-8878537572148364092');" onmouseout="out('-8878537572148364092');" style=""> 114      * @param preview     是否带上header，默认有header自动设置为true                                                  </span>
<span class="86969417606586940" onmouseenter="enter('86969417606586940');" onmouseout="out('86969417606586940');" style=""> 115      * @param cacheEnable 是否需要缓存                                                                         </span>
<span class="-966782913438754" onmouseenter="enter('-966782913438754');" onmouseout="out('-966782913438754');" style=""> 116      * @param isLooping   是否循环                                                                           </span>
<span class="3920492570930179262" onmouseenter="enter('3920492570930179262');" onmouseout="out('3920492570930179262');" style=""> 117      * @param cacheDir    自定义缓存目录                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 118      */                                                                                                  </span>
<span class="-5248766375747874279" onmouseenter="enter('-5248766375747874279');" onmouseout="out('-5248766375747874279');" style=""><abbr title=" 119     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, File cacheDir, @Nullable String overrideExtension) {"> 119     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean is🔵</abbr></span>
<span class="-8115162023017778502" onmouseenter="enter('-8115162023017778502');" onmouseout="out('-8115162023017778502');" style=""> 120         MediaSource mediaSource = null;                                                                  </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 121         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="1460304608887237329" onmouseenter="enter('1460304608887237329');" onmouseout="out('1460304608887237329');" style=""><abbr title=" 122             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLooping, cacheDir);"> 122             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnabl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123         }                                                                                                </span>
<span class="-6444727352463407138" onmouseenter="enter('-6444727352463407138');" onmouseout="out('-6444727352463407138');" style=""> 124         if (mediaSource != null) {                                                                       </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 125             return mediaSource;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span class="-143711945711027689" onmouseenter="enter('-143711945711027689');" onmouseout="out('-143711945711027689');" style=""> 127         mDataSource = dataSource;                                                                        </span>
<span class="4324385998490320101" onmouseenter="enter('4324385998490320101');" onmouseout="out('4324385998490320101');" style=""> 128         Uri contentUri = Uri.parse(dataSource);                                                          </span>
<span class="1133761916200375127" onmouseenter="enter('1133761916200375127');" onmouseout="out('1133761916200375127');" style=""> 129         MediaItem mediaItem = MediaItem.fromUri(contentUri);                                             </span>
<span class="-999163251238408129" onmouseenter="enter('-999163251238408129');" onmouseout="out('-999163251238408129');" style=""> 130         int contentType = inferContentType(dataSource, overrideExtension);                               </span>
<span  style=""> 131                                                                                                          </span>
<span class="-3913681325976844847" onmouseenter="enter('-3913681325976844847');" onmouseout="out('-3913681325976844847');" style=""> 132         String uerAgent = null;                                                                          </span>
<span class="-7096342993828865452" onmouseenter="enter('-7096342993828865452');" onmouseout="out('-7096342993828865452');" style=""> 133         if (mMapHeadData != null) {                                                                      </span>
<span class="-2322630379955906840" onmouseenter="enter('-2322630379955906840');" onmouseout="out('-2322630379955906840');" style=""> 134             uerAgent = mMapHeadData.get(&quot;User-Agent&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="-8719898405424144062" onmouseenter="enter('-8719898405424144062');" onmouseout="out('-8719898405424144062');" style=""> 136         if (&quot;android.resource&quot;.equals(contentUri.getScheme())) {                                         </span>
<span class="8727359621133688309" onmouseenter="enter('8727359621133688309');" onmouseout="out('8727359621133688309');" style=""> 137             DataSpec dataSpec = new DataSpec(contentUri);                                                </span>
<span class="4481052292773557445" onmouseenter="enter('4481052292773557445');" onmouseout="out('4481052292773557445');" style=""> 138             final RawResourceDataSource rawResourceDataSource = new RawResourceDataSource(mAppContext);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 139             try {                                                                                        </span>
<span class="2726278993395089263" onmouseenter="enter('2726278993395089263');" onmouseout="out('2726278993395089263');" style=""> 140                 rawResourceDataSource.open(dataSpec);                                                    </span>
<span class="-4974591032746021510" onmouseenter="enter('-4974591032746021510');" onmouseout="out('-4974591032746021510');" style=""> 141             } catch (RawResourceDataSource.RawResourceDataSourceException e) {                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 142                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143             }                                                                                            </span>
<span class="7704964188260260407" onmouseenter="enter('7704964188260260407');" onmouseout="out('7704964188260260407');" style=""> 144             DataSource.Factory factory = () -&gt; rawResourceDataSource;                                    </span>
<span class="-8858487266224522333" onmouseenter="enter('-8858487266224522333');" onmouseout="out('-8858487266224522333');" style=""> 145             return new ProgressiveMediaSource.Factory(                                                   </span>
<span class="-5546760697718138686" onmouseenter="enter('-5546760697718138686');" onmouseout="out('-5546760697718138686');" style=""> 146                     factory).createMediaSource(mediaItem);                                               </span>
<span  style=""> 147                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148         }                                                                                                </span>
<span  style=""> 149                                                                                                          </span>
<span class="2154133365005964027" onmouseenter="enter('2154133365005964027');" onmouseout="out('2154133365005964027');" style=""> 150         switch (contentType) {                                                                           </span>
<span class="1440548643499835250" onmouseenter="enter('1440548643499835250');" onmouseout="out('1440548643499835250');" style=""> 151             case C.TYPE_SS:                                                                              </span>
<span class="6042799697120325248" onmouseenter="enter('6042799697120325248');" onmouseout="out('6042799697120325248');" style=""> 152                 mediaSource = new SsMediaSource.Factory(                                                 </span>
<span class="-5358541595256219402" onmouseenter="enter('-5358541595256219402');" onmouseout="out('-5358541595256219402');" style=""><abbr title=" 153                         new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 153                         new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnab🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 154                         new DefaultDataSourceFactory(mAppContext, null,                                  </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 155                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 155                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 156                 break;                                                                                   </span>
<span class="-3000250717744089757" onmouseenter="enter('-3000250717744089757');" onmouseout="out('-3000250717744089757');" style=""> 157             case C.TYPE_DASH:                                                                            </span>
<span class="7863200340161482433" onmouseenter="enter('7863200340161482433');" onmouseout="out('7863200340161482433');" style=""><abbr title=" 158                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 158                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourc🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 159                         new DefaultDataSourceFactory(mAppContext, null,                                  </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 160                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 160                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 161                 break;                                                                                   </span>
<span class="-1208187129867902777" onmouseenter="enter('-1208187129867902777');" onmouseout="out('-1208187129867902777');" style=""> 162             case C.TYPE_HLS:                                                                             </span>
<span class="-8404544135870355940" onmouseenter="enter('-8404544135870355940');" onmouseout="out('-8404544135870355940');" style=""><abbr title=" 163                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent))"> 163                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnab🔵</abbr></span>
<span class="7648135411500465639" onmouseenter="enter('7648135411500465639');" onmouseout="out('7648135411500465639');" style=""> 164                         .setAllowChunklessPreparation(true)                                              </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 165                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 166                 break;                                                                                   </span>
<span class="8699527861425038714" onmouseenter="enter('8699527861425038714');" onmouseout="out('8699527861425038714');" style=""> 167             case TYPE_RTMP:                                                                              </span>
<span class="-652703182204257991" onmouseenter="enter('-652703182204257991');" onmouseout="out('-652703182204257991');" style=""> 168                 RtmpDataSourceFactory rtmpDataSourceFactory = new RtmpDataSourceFactory(null);           </span>
<span class="-4274032462282112427" onmouseenter="enter('-4274032462282112427');" onmouseout="out('-4274032462282112427');" style=""> 169                 mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory,                  </span>
<span class="44950493304430817" onmouseenter="enter('44950493304430817');" onmouseout="out('44950493304430817');" style=""> 170                         new DefaultExtractorsFactory())                                                  </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 171                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 172                 break;                                                                                   </span>
<span class="-6101660085664083502" onmouseenter="enter('-6101660085664083502');" onmouseout="out('-6101660085664083502');" style=""> 173             case C.TYPE_OTHER:                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 174             default:                                                                                     </span>
<span class="2057287837755864137" onmouseenter="enter('2057287837755864137');" onmouseout="out('2057287837755864137');" style=""><abbr title=" 175                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable,"> 175                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, c🔵</abbr></span>
<span class="-1940406333279134193" onmouseenter="enter('-1940406333279134193');" onmouseout="out('-1940406333279134193');" style=""> 176                         preview, cacheDir, uerAgent), new DefaultExtractorsFactory())                    </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 177                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 178                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179         }                                                                                                </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 180         return mediaSource;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181     }                                                                                                    </span>
<span  style=""> 182                                                                                                          </span>
<span  style=""> 183                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 184     /**                                                                                                  </span>
<span class="268464750667491347" onmouseenter="enter('268464750667491347');" onmouseout="out('268464750667491347');" style=""> 185      * 设置ExoPlayer 的 MediaSource 创建拦截                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 186      */                                                                                                  </span>
<span class="-3220193549345070784" onmouseenter="enter('-3220193549345070784');" onmouseout="out('-3220193549345070784');" style=""><abbr title=" 187     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptListener) {"> 187     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceI🔵</abbr></span>
<span class="6889549739386344871" onmouseenter="enter('6889549739386344871');" onmouseout="out('6889549739386344871');" style=""> 188         sExoMediaSourceInterceptListener = exoMediaSourceInterceptListener;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="-4818621628615420115" onmouseenter="enter('-4818621628615420115');" onmouseout="out('-4818621628615420115');" style=""> 191     public static void resetExoMediaSourceInterceptListener() {                                          </span>
<span class="-256584753286895392" onmouseenter="enter('-256584753286895392');" onmouseout="out('-256584753286895392');" style=""> 192         sExoMediaSourceInterceptListener = null;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193     }                                                                                                    </span>
<span  style=""> 194                                                                                                          </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style=""> 195     public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                 </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style=""> 196         return sExoMediaSourceInterceptListener;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197     }                                                                                                    </span>
<span  style=""> 198                                                                                                          </span>
<span  style=""> 199                                                                                                          </span>
<span class="-1063844347616692784" onmouseenter="enter('-1063844347616692784');" onmouseout="out('-1063844347616692784');" style=""> 200     @SuppressLint(&quot;WrongConstant&quot;)                                                                       </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 201     @C.ContentType                                                                                       </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 202 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-1063986311404684031" onmouseenter="enter('-1063986311404684031');" onmouseout="out('-1063986311404684031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 203     public static int inferContentType(@NonNull String fileName, @Nullable String overrideExtension) {   </span>
<span class="-8972737784242637319" onmouseenter="enter('-8972737784242637319');" onmouseout="out('-8972737784242637319');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 204         fileName = fileName.toLowerCase(Locale.US);                                                      </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 205 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206     public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                 </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207         return sExoMediaSourceInterceptListener;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 210 =======                                                                                                  </span>
<span class="-8571548472546648501" onmouseenter="enter('-8571548472546648501');" onmouseout="out('-8571548472546648501');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211     public static int inferContentType(String fileName, @Nullable String overrideExtension) {            </span>
<span class="-1058212535841907919" onmouseenter="enter('-1058212535841907919');" onmouseout="out('-1058212535841907919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212         fileName = Ascii.toLowerCase(fileName);                                                          </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 213 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="6865607915146658606" onmouseenter="enter('6865607915146658606');" onmouseout="out('6865607915146658606');" style=""> 214         if (fileName.startsWith(&quot;rtmp:&quot;)) {                                                              </span>
<span class="-2335515362235810488" onmouseenter="enter('-2335515362235810488');" onmouseout="out('-2335515362235810488');" style=""> 215             return TYPE_RTMP;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 216         } else {                                                                                         </span>
<span class="-4150133085136108549" onmouseenter="enter('-4150133085136108549');" onmouseout="out('-4150133085136108549');" style=""> 217             return inferContentType(Uri.parse(fileName), overrideExtension);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219     }                                                                                                    </span>
<span  style=""> 220                                                                                                          </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 221     @C.ContentType                                                                                       </span>
<span class="51086760664059912" onmouseenter="enter('51086760664059912');" onmouseout="out('51086760664059912');" style=""> 222     public static int inferContentType(Uri uri, @Nullable String overrideExtension) {                    </span>
<span class="8118578399735665553" onmouseenter="enter('8118578399735665553');" onmouseout="out('8118578399735665553');" style=""> 223         return Util.inferContentType(uri, overrideExtension);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 226     /**                                                                                                  </span>
<span class="-2918834671047387949" onmouseenter="enter('-2918834671047387949');" onmouseout="out('-2918834671047387949');" style=""> 227      * 本地缓存目录                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 228      */                                                                                                  </span>
<span class="8373741442571147480" onmouseenter="enter('8373741442571147480');" onmouseout="out('8373741442571147480');" style=""> 229     public static synchronized Cache getCacheSingleInstance(Context context, File cacheDir) {            </span>
<span class="5493858603497608540" onmouseenter="enter('5493858603497608540');" onmouseout="out('5493858603497608540');" style=""> 230         String dirs = context.getCacheDir().getAbsolutePath();                                           </span>
<span class="7445937115127050990" onmouseenter="enter('7445937115127050990');" onmouseout="out('7445937115127050990');" style=""> 231         if (cacheDir != null) {                                                                          </span>
<span class="4597761149181751399" onmouseenter="enter('4597761149181751399');" onmouseout="out('4597761149181751399');" style=""> 232             dirs = cacheDir.getAbsolutePath();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="-5262494487137808971" onmouseenter="enter('-5262494487137808971');" onmouseout="out('-5262494487137808971');" style=""> 234         if (mCache == null) {                                                                            </span>
<span class="-8514817442366527959" onmouseenter="enter('-8514817442366527959');" onmouseout="out('-8514817442366527959');" style=""> 235             String path = dirs + File.separator + &quot;exo&quot;;                                                 </span>
<span class="-1725211349640716689" onmouseenter="enter('-1725211349640716689');" onmouseout="out('-1725211349640716689');" style=""> 236             boolean isLocked = SimpleCache.isCacheFolderLocked(new File(path));                          </span>
<span class="-5993825009051200231" onmouseenter="enter('-5993825009051200231');" onmouseout="out('-5993825009051200231');" style=""> 237             if (!isLocked) {                                                                             </span>
<span class="-6256951664120801242" onmouseenter="enter('-6256951664120801242');" onmouseout="out('-6256951664120801242');" style=""><abbr title=" 238                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE), sDatabaseProvider);"> 238                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SI🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240         }                                                                                                </span>
<span class="2375441079046756829" onmouseenter="enter('2375441079046756829');" onmouseout="out('2375441079046756829');" style=""> 241         return mCache;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span  style=""> 243                                                                                                          </span>
<span class="2702286103088736995" onmouseenter="enter('2702286103088736995');" onmouseout="out('2702286103088736995');" style=""> 244     public void release() {                                                                              </span>
<span class="-4077098582254622113" onmouseenter="enter('-4077098582254622113');" onmouseout="out('-4077098582254622113');" style=""> 245         isCached = false;                                                                                </span>
<span class="-6083569314997925846" onmouseenter="enter('-6083569314997925846');" onmouseout="out('-6083569314997925846');" style=""> 246         if (mCache != null) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 247             try {                                                                                        </span>
<span class="529169855077323853" onmouseenter="enter('529169855077323853');" onmouseout="out('529169855077323853');" style=""> 248                 mCache.release();                                                                        </span>
<span class="-5535969345357657316" onmouseenter="enter('-5535969345357657316');" onmouseout="out('-5535969345357657316');" style=""> 249                 mCache = null;                                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 250             } catch (Exception e) {                                                                      </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 251                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254     }                                                                                                    </span>
<span  style=""> 255                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 256     /**                                                                                                  </span>
<span class="2545213195216124485" onmouseenter="enter('2545213195216124485');" onmouseout="out('2545213195216124485');" style=""> 257      * Cache需要release之后才能clear                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 258      */                                                                                                  </span>
<span class="6047086158735776789" onmouseenter="enter('6047086158735776789');" onmouseout="out('6047086158735776789');" style=""> 259     public static void clearCache(Context context, File cacheDir, String url) {                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 260         try {                                                                                            </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 261             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 262             if (!TextUtils.isEmpty(url)) {                                                               </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 263                 if (cache != null) {                                                                     </span>
<span class="-5650187598242283898" onmouseenter="enter('-5650187598242283898');" onmouseout="out('-5650187598242283898');" style=""> 264                     removeCache(cache, url);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 266             } else {                                                                                     </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 267                 if (cache != null) {                                                                     </span>
<span class="7961042807133489432" onmouseenter="enter('7961042807133489432');" onmouseout="out('7961042807133489432');" style=""> 268                     for (String key : cache.getKeys()) {                                                 </span>
<span class="-7152962664806820071" onmouseenter="enter('-7152962664806820071');" onmouseout="out('-7152962664806820071');" style=""> 269                         removeCache(cache, key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 273         } catch (Exception e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 274             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276     }                                                                                                    </span>
<span  style=""> 277                                                                                                          </span>
<span  style=""> 278                                                                                                          </span>
<span class="167482028640019662" onmouseenter="enter('167482028640019662');" onmouseout="out('167482028640019662');" style=""> 279     public static void removeCache(Cache cache, String url) {                                            </span>
<span class="-1909055186960113209" onmouseenter="enter('-1909055186960113209');" onmouseout="out('-1909055186960113209');" style=""> 280         NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(buildCacheKey(url));                  </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 281         for (CacheSpan cachedSpan : cachedSpans) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 282             try {                                                                                        </span>
<span class="1961840987401424959" onmouseenter="enter('1961840987401424959');" onmouseout="out('1961840987401424959');" style=""> 283                 cache.removeSpan(cachedSpan);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 284             } catch (Exception e) {                                                                      </span>
<span class="-4130810023601196090" onmouseenter="enter('-4130810023601196090');" onmouseout="out('-4130810023601196090');" style=""> 285                 // Do nothing.                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288     }                                                                                                    </span>
<span  style=""> 289                                                                                                          </span>
<span class="-8198521815859651674" onmouseenter="enter('-8198521815859651674');" onmouseout="out('-8198521815859651674');" style=""> 290     public static String buildCacheKey(String url) {                                                     </span>
<span class="3080452641973210712" onmouseenter="enter('3080452641973210712');" onmouseout="out('3080452641973210712');" style=""> 291         DataSpec dataSpec = new DataSpec(Uri.parse(url));                                                </span>
<span class="3397752349715137889" onmouseenter="enter('3397752349715137889');" onmouseout="out('3397752349715137889');" style=""> 292         return CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293     }                                                                                                    </span>
<span  style=""> 294                                                                                                          </span>
<span class="-2359379937002163053" onmouseenter="enter('-2359379937002163053');" onmouseout="out('-2359379937002163053');" style=""> 295     public static boolean cachePreView(Context context, File cacheDir, String url) {                     </span>
<span class="6669724668123101030" onmouseenter="enter('6669724668123101030');" onmouseout="out('6669724668123101030');" style=""> 296         return resolveCacheState(getCacheSingleInstance(context, cacheDir), url);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297     }                                                                                                    </span>
<span  style=""> 298                                                                                                          </span>
<span class="4275422663013542480" onmouseenter="enter('4275422663013542480');" onmouseout="out('4275422663013542480');" style=""> 299     public boolean hadCached() {                                                                         </span>
<span class="3074888405336734299" onmouseenter="enter('3074888405336734299');" onmouseout="out('3074888405336734299');" style=""> 300         return isCached;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 303     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style=""> 304      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 305      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 306      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 307      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 308     @Deprecated                                                                                          </span>
<span class="2198318641674923085" onmouseenter="enter('2198318641674923085');" onmouseout="out('2198318641674923085');" style=""> 309     public static boolean isSkipSSLChain() {                                                             </span>
<span class="873024860049770122" onmouseenter="enter('873024860049770122');" onmouseout="out('873024860049770122');" style=""> 310         return sSkipSSLChain;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 313     /**                                                                                                  </span>
<span class="2007360617581285918" onmouseenter="enter('2007360617581285918');" onmouseout="out('2007360617581285918');" style=""> 314      * 设置https忽略证书                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 315      *                                                                                                   </span>
<span class="-8071550217355649258" onmouseenter="enter('-8071550217355649258');" onmouseout="out('-8071550217355649258');" style=""> 316      * @param skipSSLChain true时是hulve                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 317      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 318      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 319     @Deprecated                                                                                          </span>
<span class="-1308991004088670996" onmouseenter="enter('-1308991004088670996');" onmouseout="out('-1308991004088670996');" style=""> 320     public static void setSkipSSLChain(boolean skipSSLChain) {                                           </span>
<span class="1121146022274574744" onmouseenter="enter('1121146022274574744');" onmouseout="out('1121146022274574744');" style=""> 321         sSkipSSLChain = skipSSLChain;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322     }                                                                                                    </span>
<span  style=""> 323                                                                                                          </span>
<span  style=""> 324                                                                                                          </span>
<span class="2976239622278297742" onmouseenter="enter('2976239622278297742');" onmouseout="out('2976239622278297742');" style=""> 325     public static int getHttpReadTimeout() {                                                             </span>
<span class="5523542451485133181" onmouseenter="enter('5523542451485133181');" onmouseout="out('5523542451485133181');" style=""> 326         return sHttpReadTimeout;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327     }                                                                                                    </span>
<span  style=""> 328                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 329     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 330      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 331      */                                                                                                  </span>
<span class="2919025488051579831" onmouseenter="enter('2919025488051579831');" onmouseout="out('2919025488051579831');" style=""> 332     public static void setHttpReadTimeout(int httpReadTimeout) {                                         </span>
<span class="-3997040606525716839" onmouseenter="enter('-3997040606525716839');" onmouseout="out('-3997040606525716839');" style=""> 333         ExoSourceManager.sHttpReadTimeout = httpReadTimeout;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334     }                                                                                                    </span>
<span  style=""> 335                                                                                                          </span>
<span class="5450236011176178791" onmouseenter="enter('5450236011176178791');" onmouseout="out('5450236011176178791');" style=""> 336     public static int getHttpConnectTimeout() {                                                          </span>
<span class="1111499796559727252" onmouseenter="enter('1111499796559727252');" onmouseout="out('1111499796559727252');" style=""> 337         return sHttpConnectTimeout;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338     }                                                                                                    </span>
<span  style=""> 339                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 340     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 341      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 342      */                                                                                                  </span>
<span class="-7016684631510872274" onmouseenter="enter('-7016684631510872274');" onmouseout="out('-7016684631510872274');" style=""> 343     public static void setHttpConnectTimeout(int httpConnectTimeout) {                                   </span>
<span class="-2795264608914979197" onmouseenter="enter('-2795264608914979197');" onmouseout="out('-2795264608914979197');" style=""> 344         ExoSourceManager.sHttpConnectTimeout = httpConnectTimeout;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345     }                                                                                                    </span>
<span  style=""> 346                                                                                                          </span>
<span class="-3420724575907019098" onmouseenter="enter('-3420724575907019098');" onmouseout="out('-3420724575907019098');" style=""> 347     public static DatabaseProvider getDatabaseProvider() {                                               </span>
<span class="-2185808013130137608" onmouseenter="enter('-2185808013130137608');" onmouseout="out('-2185808013130137608');" style=""> 348         return sDatabaseProvider;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349     }                                                                                                    </span>
<span  style=""> 350                                                                                                          </span>
<span class="-1193343422611666410" onmouseenter="enter('-1193343422611666410');" onmouseout="out('-1193343422611666410');" style=""> 351     public static void setDatabaseProvider(DatabaseProvider databaseProvider) {                          </span>
<span class="-7671573637861427354" onmouseenter="enter('-7671573637861427354');" onmouseout="out('-7671573637861427354');" style=""> 352         ExoSourceManager.sDatabaseProvider = databaseProvider;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 353     }                                                                                                    </span>
<span  style=""> 354                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 355     /**                                                                                                  </span>
<span class="-1233347272602211288" onmouseenter="enter('-1233347272602211288');" onmouseout="out('-1233347272602211288');" style=""> 356      * 获取SourceFactory，是否带Cache                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 357      */                                                                                                  </span>
<span class="-8060849973918439601" onmouseenter="enter('-8060849973918439601');" onmouseout="out('-8060849973918439601');" style=""><abbr title=" 358     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, File cacheDir, String uerAgent) {"> 358     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean pr🔵</abbr></span>
<span class="7825217223858997247" onmouseenter="enter('7825217223858997247');" onmouseout="out('7825217223858997247');" style=""> 359         if (cacheEnable) {                                                                               </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 360             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 361             if (cache != null) {                                                                         </span>
<span class="9021007000539438017" onmouseenter="enter('9021007000539438017');" onmouseout="out('9021007000539438017');" style=""> 362                 isCached = resolveCacheState(cache, mDataSource);                                        </span>
<span class="-3761479699771438765" onmouseenter="enter('-3761479699771438765');" onmouseout="out('-3761479699771438765');" style=""> 363                 CacheDataSource.Factory factory = new CacheDataSource.Factory();                         </span>
<span class="-8093724037283287608" onmouseenter="enter('-8093724037283287608');" onmouseout="out('-8093724037283287608');" style=""> 364                 return factory.                                                                          </span>
<span class="-5074485159975905347" onmouseenter="enter('-5074485159975905347');" onmouseout="out('-5074485159975905347');" style=""><abbr title=" 365                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAgent)).setFlags(CacheDataSource.FLAG_IGNORE_CACHE_ON_ERROR);"> 365                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, previ🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 366             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367         }                                                                                                </span>
<span class="-1431913544698159813" onmouseenter="enter('-1431913544698159813');" onmouseout="out('-1431913544698159813');" style=""> 368         return getDataSourceFactory(context, preview, uerAgent);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369     }                                                                                                    </span>
<span  style=""> 370                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 371     /**                                                                                                  </span>
<span class="-283092449438347556" onmouseenter="enter('-283092449438347556');" onmouseout="out('-283092449438347556');" style=""> 372      * 获取SourceFactory                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 373      */                                                                                                  </span>
<span class="1834018894786004406" onmouseenter="enter('1834018894786004406');" onmouseout="out('1834018894786004406');" style=""> 374     private DataSource.Factory getDataSourceFactory(Context context, boolean preview, String uerAgent) { </span>
<span class="1829813597817317525" onmouseenter="enter('1829813597817317525');" onmouseout="out('1829813597817317525');" style=""><abbr title=" 375         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).build(),"> 375         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(c🔵</abbr></span>
<span class="-4652974943362556447" onmouseenter="enter('-4652974943362556447');" onmouseout="out('-4652974943362556447');" style=""> 376                 getHttpDataSourceFactory(context, preview, uerAgent));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377     }                                                                                                    </span>
<span  style=""> 378                                                                                                          </span>
<span class="-879776573326484759" onmouseenter="enter('-879776573326484759');" onmouseout="out('-879776573326484759');" style=""><abbr title=" 379     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent) {"> 379     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent🔵</abbr></span>
<span class="4493368850476432367" onmouseenter="enter('4493368850476432367');" onmouseout="out('4493368850476432367');" style=""> 380         if (uerAgent == null) {                                                                          </span>
<span class="-1748097148375756721" onmouseenter="enter('-1748097148375756721');" onmouseout="out('-1748097148375756721');" style=""> 381             uerAgent = Util.getUserAgent(context, TAG);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382         }                                                                                                </span>
<span class="-9065933110167474911" onmouseenter="enter('-9065933110167474911');" onmouseout="out('-9065933110167474911');" style=""> 383         int connectTimeout = DefaultHttpDataSource.DEFAULT_CONNECT_TIMEOUT_MILLIS;                       </span>
<span class="6449380685464591139" onmouseenter="enter('6449380685464591139');" onmouseout="out('6449380685464591139');" style=""> 384         int readTimeout = DefaultHttpDataSource.DEFAULT_READ_TIMEOUT_MILLIS;                             </span>
<span class="-1006385169289819833" onmouseenter="enter('-1006385169289819833');" onmouseout="out('-1006385169289819833');" style=""> 385         if (sHttpConnectTimeout &gt; 0) {                                                                   </span>
<span class="-1115887819057715189" onmouseenter="enter('-1115887819057715189');" onmouseout="out('-1115887819057715189');" style=""> 386             connectTimeout = sHttpConnectTimeout;                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387         }                                                                                                </span>
<span class="623482186481107038" onmouseenter="enter('623482186481107038');" onmouseout="out('623482186481107038');" style=""> 388         if (sHttpReadTimeout &gt; 0) {                                                                      </span>
<span class="3096862042682748327" onmouseenter="enter('3096862042682748327');" onmouseout="out('3096862042682748327');" style=""> 389             readTimeout = sHttpReadTimeout;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390         }                                                                                                </span>
<span class="-1477830294864050779" onmouseenter="enter('-1477830294864050779');" onmouseout="out('-1477830294864050779');" style=""> 391         boolean allowCrossProtocolRedirects = false;                                                     </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 392         if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                           </span>
<span class="-8838917078629499221" onmouseenter="enter('-8838917078629499221');" onmouseout="out('-8838917078629499221');" style=""> 393             allowCrossProtocolRedirects = &quot;true&quot;.equals(mMapHeadData.get(&quot;allowCrossProtocolRedirects&quot;));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="3270687530488436452" onmouseenter="enter('3270687530488436452');" onmouseout="out('3270687530488436452');" style=""> 395         DataSource.Factory dataSourceFactory;                                                            </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 396         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="2091451277126898709" onmouseenter="enter('2091451277126898709');" onmouseout="out('2091451277126898709');" style=""><abbr title=" 397             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 397             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, previ🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style=""> 398                     connectTimeout,                                                                      </span>
<span class="-51576699489615850" onmouseenter="enter('-51576699489615850');" onmouseout="out('-51576699489615850');" style=""> 399                     readTimeout, mMapHeadData, allowCrossProtocolRedirects);                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 400         } else {                                                                                         </span>
<span class="8445214236760378199" onmouseenter="enter('8445214236760378199');" onmouseout="out('8445214236760378199');" style=""> 401             dataSourceFactory = new DefaultHttpDataSource.Factory()                                      </span>
<span class="4157379816614128432" onmouseenter="enter('4157379816614128432');" onmouseout="out('4157379816614128432');" style=""> 402                     .setAllowCrossProtocolRedirects(allowCrossProtocolRedirects)                         </span>
<span class="-6788353891995527067" onmouseenter="enter('-6788353891995527067');" onmouseout="out('-6788353891995527067');" style=""> 403                     .setConnectTimeoutMs(connectTimeout)                                                 </span>
<span class="-4562924741655466840" onmouseenter="enter('-4562924741655466840');" onmouseout="out('-4562924741655466840');" style=""> 404                     .setReadTimeoutMs(readTimeout)                                                       </span>
<span class="5513192411211624142" onmouseenter="enter('5513192411211624142');" onmouseout="out('5513192411211624142');" style=""><abbr title=" 405                     .setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build());"> 405                     .setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).🔵</abbr></span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 406             if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                       </span>
<span class="-3433586199384292394" onmouseenter="enter('-3433586199384292394');" onmouseout="out('-3433586199384292394');" style=""><abbr title=" 407                 ((DefaultHttpDataSource.Factory) dataSourceFactory).setDefaultRequestProperties(mMapHeadData);"> 407                 ((DefaultHttpDataSource.Factory) dataSourceFactory).setDefaultRequestProperties(mMapHeadD🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409         }                                                                                                </span>
<span class="1723753173213071643" onmouseenter="enter('1723753173213071643');" onmouseout="out('1723753173213071643');" style=""> 410         return dataSourceFactory;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 411     }                                                                                                    </span>
<span  style=""> 412                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 413     /**                                                                                                  </span>
<span class="-5059148079091929211" onmouseenter="enter('-5059148079091929211');" onmouseout="out('-5059148079091929211');" style=""> 414      * 根据缓存块判断是否缓存成功                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 415      */                                                                                                  </span>
<span class="-2204351825262319384" onmouseenter="enter('-2204351825262319384');" onmouseout="out('-2204351825262319384');" style=""> 416     private static boolean resolveCacheState(Cache cache, String url) {                                  </span>
<span class="124753744680968754" onmouseenter="enter('124753744680968754');" onmouseout="out('124753744680968754');" style=""> 417         boolean isCache = true;                                                                          </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 418         if (!TextUtils.isEmpty(url)) {                                                                   </span>
<span class="9175234064888605862" onmouseenter="enter('9175234064888605862');" onmouseout="out('9175234064888605862');" style=""> 419             String key = buildCacheKey(url);                                                             </span>
<span class="8462256178484181139" onmouseenter="enter('8462256178484181139');" onmouseout="out('8462256178484181139');" style=""> 420             if (!TextUtils.isEmpty(key)) {                                                               </span>
<span class="-8737585301747024644" onmouseenter="enter('-8737585301747024644');" onmouseout="out('-8737585301747024644');" style=""> 421                 NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(key);                         </span>
<span class="6104552210198839213" onmouseenter="enter('6104552210198839213');" onmouseout="out('6104552210198839213');" style=""> 422                 if (cachedSpans.size() == 0) {                                                           </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 423                     isCache = false;                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 424                 } else {                                                                                 </span>
<span class="122280032006644231" onmouseenter="enter('122280032006644231');" onmouseout="out('122280032006644231');" style=""><abbr title=" 425                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.LENGTH_UNSET);"> 425                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LE🔵</abbr></span>
<span class="2548419966105293269" onmouseenter="enter('2548419966105293269');" onmouseout="out('2548419966105293269');" style=""> 426                     long currentLength = 0;                                                              </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 427                     for (CacheSpan cachedSpan : cachedSpans) {                                           </span>
<span class="-228864752981275902" onmouseenter="enter('-228864752981275902');" onmouseout="out('-228864752981275902');" style=""><abbr title=" 428                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.length);"> 428                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.lengt🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429                     }                                                                                    </span>
<span class="-95640198430383414" onmouseenter="enter('-95640198430383414');" onmouseout="out('-95640198430383414');" style=""> 430                     isCache = currentLength &gt;= contentLength;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 432             } else {                                                                                     </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 433                 isCache = false;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435         }                                                                                                </span>
<span class="-4805343878943095560" onmouseenter="enter('-4805343878943095560');" onmouseout="out('-4805343878943095560');" style=""> 436         return isCache;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 437     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438 }                                                                                                        </span></pre></td>
                            <td><pre><span class="-5503081748616462646" onmouseenter="enter('-5503081748616462646');" onmouseout="out('-5503081748616462646');" style="">   1 package tv.danmaku.ijk.media.exo2;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-3997288425915246049" onmouseenter="enter('-3997288425915246049');" onmouseout="out('-3997288425915246049');" style="">   3 import android.annotation.SuppressLint;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5 import android.net.Uri;                                                                                  </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">   6 import androidx.annotation.Nullable;                                                                     </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   7 import android.text.TextUtils;                                                                           </span>
<span  style="">   8                                                                                                          </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   9 import androidx.annotation.NonNull;                                                                      </span>
<span  style="">  10                                                                                                          </span>
<span class="1487611449423756792" onmouseenter="enter('1487611449423756792');" onmouseout="out('1487611449423756792');" style="">  11 import com.google.android.exoplayer2.C;                                                                  </span>
<span class="867094050949454463" onmouseenter="enter('867094050949454463');" onmouseout="out('867094050949454463');" style="">  12 import com.google.android.exoplayer2.MediaItem;                                                          </span>
<span class="-3172072599128556050" onmouseenter="enter('-3172072599128556050');" onmouseout="out('-3172072599128556050');" style="">  13 import com.google.android.exoplayer2.database.DatabaseProvider;                                          </span>
<span class="-2844689653783287849" onmouseenter="enter('-2844689653783287849');" onmouseout="out('-2844689653783287849');" style="">  14 import com.google.android.exoplayer2.ext.rtmp.RtmpDataSourceFactory;                                     </span>
<span class="3675920877003625902" onmouseenter="enter('3675920877003625902');" onmouseout="out('3675920877003625902');" style="">  15 import com.google.android.exoplayer2.extractor.DefaultExtractorsFactory;                                 </span>
<span class="-6167091960224777303" onmouseenter="enter('-6167091960224777303');" onmouseout="out('-6167091960224777303');" style="">  16 import com.google.android.exoplayer2.source.MediaSource;                                                 </span>
<span class="-3105544688913650545" onmouseenter="enter('-3105544688913650545');" onmouseout="out('-3105544688913650545');" style="">  17 import com.google.android.exoplayer2.source.ProgressiveMediaSource;                                      </span>
<span class="-4960919004069838122" onmouseenter="enter('-4960919004069838122');" onmouseout="out('-4960919004069838122');" style="">  18 import com.google.android.exoplayer2.source.dash.DashMediaSource;                                        </span>
<span class="-4413409349911342092" onmouseenter="enter('-4413409349911342092');" onmouseout="out('-4413409349911342092');" style="">  19 import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;                                 </span>
<span class="392947657445256672" onmouseenter="enter('392947657445256672');" onmouseout="out('392947657445256672');" style="">  20 import com.google.android.exoplayer2.source.hls.HlsMediaSource;                                          </span>
<span class="1080782699538105726" onmouseenter="enter('1080782699538105726');" onmouseout="out('1080782699538105726');" style="">  21 import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;                        </span>
<span class="-8280776144719855835" onmouseenter="enter('-8280776144719855835');" onmouseout="out('-8280776144719855835');" style="">  22 import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;                               </span>
<span class="-5025142600139113447" onmouseenter="enter('-5025142600139113447');" onmouseout="out('-5025142600139113447');" style="">  23 import com.google.android.exoplayer2.upstream.DataSource;                                                </span>
<span class="-6054887794217826236" onmouseenter="enter('-6054887794217826236');" onmouseout="out('-6054887794217826236');" style="">  24 import com.google.android.exoplayer2.upstream.DataSpec;                                                  </span>
<span class="-1926464862603214616" onmouseenter="enter('-1926464862603214616');" onmouseout="out('-1926464862603214616');" style="">  25 import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;                                     </span>
<span class="7691807062585918827" onmouseenter="enter('7691807062585918827');" onmouseout="out('7691807062585918827');" style="">  26 import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;                                  </span>
<span class="8221609960337784667" onmouseenter="enter('8221609960337784667');" onmouseout="out('8221609960337784667');" style="">  27 import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;                                     </span>
<span class="3684976669809945769" onmouseenter="enter('3684976669809945769');" onmouseout="out('3684976669809945769');" style="">  28 import com.google.android.exoplayer2.upstream.RawResourceDataSource;                                     </span>
<span class="3791899211787747371" onmouseenter="enter('3791899211787747371');" onmouseout="out('3791899211787747371');" style="">  29 import com.google.android.exoplayer2.upstream.cache.Cache;                                               </span>
<span class="-8148834636982163692" onmouseenter="enter('-8148834636982163692');" onmouseout="out('-8148834636982163692');" style="">  30 import com.google.android.exoplayer2.upstream.cache.CacheDataSource;                                     </span>
<span class="-8685955199172896893" onmouseenter="enter('-8685955199172896893');" onmouseout="out('-8685955199172896893');" style="">  31 import com.google.android.exoplayer2.upstream.cache.CacheKeyFactory;                                     </span>
<span class="-4601203435061269454" onmouseenter="enter('-4601203435061269454');" onmouseout="out('-4601203435061269454');" style="">  32 import com.google.android.exoplayer2.upstream.cache.CacheSpan;                                           </span>
<span class="-8498858967217479983" onmouseenter="enter('-8498858967217479983');" onmouseout="out('-8498858967217479983');" style="">  33 import com.google.android.exoplayer2.upstream.cache.ContentMetadata;                                     </span>
<span class="-2820765455975363243" onmouseenter="enter('-2820765455975363243');" onmouseout="out('-2820765455975363243');" style="">  34 import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;                       </span>
<span class="-7748643470419441439" onmouseenter="enter('-7748643470419441439');" onmouseout="out('-7748643470419441439');" style="">  35 import com.google.android.exoplayer2.upstream.cache.SimpleCache;                                         </span>
<span class="-1809507180972376256" onmouseenter="enter('-1809507180972376256');" onmouseout="out('-1809507180972376256');" style="">  36 import com.google.android.exoplayer2.util.Util;                                                          </span>
<span class="-5152250604397781057" onmouseenter="enter('-5152250604397781057');" onmouseout="out('-5152250604397781057');" style="">  37 import com.google.common.base.Ascii;                                                                     </span>
<span  style="">  38                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39 import java.io.File;                                                                                     </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  40 import java.util.Locale;                                                                                 </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  41 import java.util.Map;                                                                                    </span>
<span class="-5539540480142207555" onmouseenter="enter('-5539540480142207555');" onmouseout="out('-5539540480142207555');" style="">  42 import java.util.NavigableSet;                                                                           </span>
<span  style="">  43                                                                                                          </span>
<span  style="">  44                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  45 /**                                                                                                      </span>
<span class="-3817795341581382404" onmouseenter="enter('-3817795341581382404');" onmouseout="out('-3817795341581382404');" style="">  46  * Created by guoshuyu on 2018/5/18.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  47  */                                                                                                      </span>
<span  style="">  48                                                                                                          </span>
<span class="5978956340021809315" onmouseenter="enter('5978956340021809315');" onmouseout="out('5978956340021809315');" style="">  49 public class ExoSourceManager {                                                                          </span>
<span  style="">  50                                                                                                          </span>
<span class="2143614905519812283" onmouseenter="enter('2143614905519812283');" onmouseout="out('2143614905519812283');" style="">  51     private static final String TAG = &quot;ExoSourceManager&quot;;                                                </span>
<span  style="">  52                                                                                                          </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="">  53     private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                      </span>
<span  style="">  54                                                                                                          </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  55 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-7434648719207555161" onmouseenter="enter('-7434648719207555161');" onmouseout="out('-7434648719207555161');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  56 public static final int TYPE_RTMP = 100;                                                                 </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  57 ||||||| BASE                                                                                             </span>
<span class="2805559058863362301" onmouseenter="enter('2805559058863362301');" onmouseout="out('2805559058863362301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 public static final int TYPE_RTMP = 4;                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  59 =======                                                                                                  </span>
<span class="4060007595904198083" onmouseenter="enter('4060007595904198083');" onmouseout="out('4060007595904198083');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  60 public static final int TYPE_RTMP = 14;                                                                  </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  61 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">  62                                                                                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="2866779009294581851" onmouseenter="enter('2866779009294581851');" onmouseout="out('2866779009294581851');" style="">  64     private static Cache mCache;                                                                         </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  65     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style="">  66      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style="">  68      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  70     @Deprecated                                                                                          </span>
<span class="6733722337026437480" onmouseenter="enter('6733722337026437480');" onmouseout="out('6733722337026437480');" style="">  71     private static boolean sSkipSSLChain = false;                                                        </span>
<span  style="">  72                                                                                                          </span>
<span class="-8322579848361947255" onmouseenter="enter('-8322579848361947255');" onmouseout="out('-8322579848361947255');" style="">  73     private static int sHttpReadTimeout = -1;                                                            </span>
<span  style="">  74                                                                                                          </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="">  75     private static int sHttpConnectTimeout = -1;                                                         </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  76 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="2978752276401696079" onmouseenter="enter('2978752276401696079');" onmouseout="out('2978752276401696079');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  77 private static final boolean s = false;                                                                  </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  78 ||||||| BASE                                                                                             </span>
<span class="-1940276823349157224" onmouseenter="enter('-1940276823349157224');" onmouseout="out('-1940276823349157224');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79 private static boolean s = false;                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  80 =======                                                                                                  </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  81 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">  82                                                                                                          </span>
<span  style="">  83                                                                                                          </span>
<span class="7019408237288028740" onmouseenter="enter('7019408237288028740');" onmouseout="out('7019408237288028740');" style="">  84     private final Context mAppContext;                                                                   </span>
<span  style="">  85                                                                                                          </span>
<span class="-4374222225418050568" onmouseenter="enter('-4374222225418050568');" onmouseout="out('-4374222225418050568');" style="">  86     private final Map&lt;String, String&gt; mMapHeadData;                                                      </span>
<span  style="">  87                                                                                                          </span>
<span class="2720391937428942309" onmouseenter="enter('2720391937428942309');" onmouseout="out('2720391937428942309');" style="">  88     private String mDataSource;                                                                          </span>
<span  style="">  89                                                                                                          </span>
<span class="898136537903361042" onmouseenter="enter('898136537903361042');" onmouseout="out('898136537903361042');" style="">  90     private static ExoMediaSourceInterceptListener sExoMediaSourceInterceptListener;                     </span>
<span class="8633327969830562634" onmouseenter="enter('8633327969830562634');" onmouseout="out('8633327969830562634');" style="">  91     private static DatabaseProvider sDatabaseProvider;                                                   </span>
<span  style="">  92                                                                                                          </span>
<span class="-2905075036207193429" onmouseenter="enter('-2905075036207193429');" onmouseout="out('-2905075036207193429');" style="">  93     private boolean isCached = false;                                                                    </span>
<span  style="">  94                                                                                                          </span>
<span class="-3397611666931429980" onmouseenter="enter('-3397611666931429980');" onmouseout="out('-3397611666931429980');" style=""><abbr title="  95     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData) {">  95     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData🔵</abbr></span>
<span class="-6448993279383120903" onmouseenter="enter('-6448993279383120903');" onmouseout="out('-6448993279383120903');" style="">  96         return new ExoSourceManager(context, mapHeadData);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97     }                                                                                                    </span>
<span  style="">  98                                                                                                          </span>
<span class="-2557713181218471643" onmouseenter="enter('-2557713181218471643');" onmouseout="out('-2557713181218471643');" style="">  99     private ExoSourceManager(Context context, Map&lt;String, String&gt; mapHeadData) {                         </span>
<span class="7302624818817228010" onmouseenter="enter('7302624818817228010');" onmouseout="out('7302624818817228010');" style=""> 100         mAppContext = context.getApplicationContext();                                                   </span>
<span class="3872213483840267174" onmouseenter="enter('3872213483840267174');" onmouseout="out('3872213483840267174');" style=""> 101         mMapHeadData = mapHeadData;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102     }                                                                                                    </span>
<span  style=""> 103                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 104     /**                                                                                                  </span>
<span class="-8955960166298079068" onmouseenter="enter('-8955960166298079068');" onmouseout="out('-8955960166298079068');" style=""> 105      * @param dataSource  链接                                                                             </span>
<span class="-8878537572148364092" onmouseenter="enter('-8878537572148364092');" onmouseout="out('-8878537572148364092');" style=""> 106      * @param preview     是否带上header，默认有header自动设置为true                                                  </span>
<span class="86969417606586940" onmouseenter="enter('86969417606586940');" onmouseout="out('86969417606586940');" style=""> 107      * @param cacheEnable 是否需要缓存                                                                         </span>
<span class="-966782913438754" onmouseenter="enter('-966782913438754');" onmouseout="out('-966782913438754');" style=""> 108      * @param isLooping   是否循环                                                                           </span>
<span class="3920492570930179262" onmouseenter="enter('3920492570930179262');" onmouseout="out('3920492570930179262');" style=""> 109      * @param cacheDir    自定义缓存目录                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 110      */                                                                                                  </span>
<span class="-5248766375747874279" onmouseenter="enter('-5248766375747874279');" onmouseout="out('-5248766375747874279');" style=""><abbr title=" 111     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, File cacheDir, @Nullable String overrideExtension) {"> 111     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean is🔵</abbr></span>
<span class="-8115162023017778502" onmouseenter="enter('-8115162023017778502');" onmouseout="out('-8115162023017778502');" style=""> 112         MediaSource mediaSource = null;                                                                  </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 113         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="1460304608887237329" onmouseenter="enter('1460304608887237329');" onmouseout="out('1460304608887237329');" style=""><abbr title=" 114             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLooping, cacheDir);"> 114             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnabl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span class="-6444727352463407138" onmouseenter="enter('-6444727352463407138');" onmouseout="out('-6444727352463407138');" style=""> 116         if (mediaSource != null) {                                                                       </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 117             return mediaSource;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118         }                                                                                                </span>
<span class="-143711945711027689" onmouseenter="enter('-143711945711027689');" onmouseout="out('-143711945711027689');" style=""> 119         mDataSource = dataSource;                                                                        </span>
<span class="4324385998490320101" onmouseenter="enter('4324385998490320101');" onmouseout="out('4324385998490320101');" style=""> 120         Uri contentUri = Uri.parse(dataSource);                                                          </span>
<span class="1133761916200375127" onmouseenter="enter('1133761916200375127');" onmouseout="out('1133761916200375127');" style=""> 121         MediaItem mediaItem = MediaItem.fromUri(contentUri);                                             </span>
<span class="-999163251238408129" onmouseenter="enter('-999163251238408129');" onmouseout="out('-999163251238408129');" style=""> 122         int contentType = inferContentType(dataSource, overrideExtension);                               </span>
<span  style=""> 123                                                                                                          </span>
<span class="-3913681325976844847" onmouseenter="enter('-3913681325976844847');" onmouseout="out('-3913681325976844847');" style=""> 124         String uerAgent = null;                                                                          </span>
<span class="-7096342993828865452" onmouseenter="enter('-7096342993828865452');" onmouseout="out('-7096342993828865452');" style=""> 125         if (mMapHeadData != null) {                                                                      </span>
<span class="-2322630379955906840" onmouseenter="enter('-2322630379955906840');" onmouseout="out('-2322630379955906840');" style=""> 126             uerAgent = mMapHeadData.get(&quot;User-Agent&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127         }                                                                                                </span>
<span class="-8719898405424144062" onmouseenter="enter('-8719898405424144062');" onmouseout="out('-8719898405424144062');" style=""> 128         if (&quot;android.resource&quot;.equals(contentUri.getScheme())) {                                         </span>
<span class="8727359621133688309" onmouseenter="enter('8727359621133688309');" onmouseout="out('8727359621133688309');" style=""> 129             DataSpec dataSpec = new DataSpec(contentUri);                                                </span>
<span class="4481052292773557445" onmouseenter="enter('4481052292773557445');" onmouseout="out('4481052292773557445');" style=""> 130             final RawResourceDataSource rawResourceDataSource = new RawResourceDataSource(mAppContext);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 131             try {                                                                                        </span>
<span class="2726278993395089263" onmouseenter="enter('2726278993395089263');" onmouseout="out('2726278993395089263');" style=""> 132                 rawResourceDataSource.open(dataSpec);                                                    </span>
<span class="-4974591032746021510" onmouseenter="enter('-4974591032746021510');" onmouseout="out('-4974591032746021510');" style=""> 133             } catch (RawResourceDataSource.RawResourceDataSourceException e) {                           </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 134                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135             }                                                                                            </span>
<span class="7704964188260260407" onmouseenter="enter('7704964188260260407');" onmouseout="out('7704964188260260407');" style=""> 136             DataSource.Factory factory = () -&gt; rawResourceDataSource;                                    </span>
<span class="-8858487266224522333" onmouseenter="enter('-8858487266224522333');" onmouseout="out('-8858487266224522333');" style=""> 137             return new ProgressiveMediaSource.Factory(                                                   </span>
<span class="-5546760697718138686" onmouseenter="enter('-5546760697718138686');" onmouseout="out('-5546760697718138686');" style=""> 138                     factory).createMediaSource(mediaItem);                                               </span>
<span  style=""> 139                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140         }                                                                                                </span>
<span  style=""> 141                                                                                                          </span>
<span class="2154133365005964027" onmouseenter="enter('2154133365005964027');" onmouseout="out('2154133365005964027');" style=""> 142         switch (contentType) {                                                                           </span>
<span class="1440548643499835250" onmouseenter="enter('1440548643499835250');" onmouseout="out('1440548643499835250');" style=""> 143             case C.TYPE_SS:                                                                              </span>
<span class="6042799697120325248" onmouseenter="enter('6042799697120325248');" onmouseout="out('6042799697120325248');" style=""> 144                 mediaSource = new SsMediaSource.Factory(                                                 </span>
<span class="-5358541595256219402" onmouseenter="enter('-5358541595256219402');" onmouseout="out('-5358541595256219402');" style=""><abbr title=" 145                         new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 145                         new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnab🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 146                         new DefaultDataSourceFactory(mAppContext, null,                                  </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 147                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 147                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 148                 break;                                                                                   </span>
<span class="-3000250717744089757" onmouseenter="enter('-3000250717744089757');" onmouseout="out('-3000250717744089757');" style=""> 149             case C.TYPE_DASH:                                                                            </span>
<span class="7863200340161482433" onmouseenter="enter('7863200340161482433');" onmouseout="out('7863200340161482433');" style=""><abbr title=" 150                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 150                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourc🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 151                         new DefaultDataSourceFactory(mAppContext, null,                                  </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 152                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 152                                 getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSou🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 153                 break;                                                                                   </span>
<span class="-1208187129867902777" onmouseenter="enter('-1208187129867902777');" onmouseout="out('-1208187129867902777');" style=""> 154             case C.TYPE_HLS:                                                                             </span>
<span class="-8404544135870355940" onmouseenter="enter('-8404544135870355940');" onmouseout="out('-8404544135870355940');" style=""><abbr title=" 155                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent))"> 155                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnab🔵</abbr></span>
<span class="7648135411500465639" onmouseenter="enter('7648135411500465639');" onmouseout="out('7648135411500465639');" style=""> 156                         .setAllowChunklessPreparation(true)                                              </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 157                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 158                 break;                                                                                   </span>
<span class="8699527861425038714" onmouseenter="enter('8699527861425038714');" onmouseout="out('8699527861425038714');" style=""> 159             case TYPE_RTMP:                                                                              </span>
<span class="-652703182204257991" onmouseenter="enter('-652703182204257991');" onmouseout="out('-652703182204257991');" style=""> 160                 RtmpDataSourceFactory rtmpDataSourceFactory = new RtmpDataSourceFactory(null);           </span>
<span class="-4274032462282112427" onmouseenter="enter('-4274032462282112427');" onmouseout="out('-4274032462282112427');" style=""> 161                 mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory,                  </span>
<span class="44950493304430817" onmouseenter="enter('44950493304430817');" onmouseout="out('44950493304430817');" style=""> 162                         new DefaultExtractorsFactory())                                                  </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 163                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 164                 break;                                                                                   </span>
<span class="-6101660085664083502" onmouseenter="enter('-6101660085664083502');" onmouseout="out('-6101660085664083502');" style=""> 165             case C.TYPE_OTHER:                                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 166             default:                                                                                     </span>
<span class="2057287837755864137" onmouseenter="enter('2057287837755864137');" onmouseout="out('2057287837755864137');" style=""><abbr title=" 167                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable,"> 167                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, c🔵</abbr></span>
<span class="-1940406333279134193" onmouseenter="enter('-1940406333279134193');" onmouseout="out('-1940406333279134193');" style=""> 168                         preview, cacheDir, uerAgent), new DefaultExtractorsFactory())                    </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 169                         .createMediaSource(mediaItem);                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 170                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171         }                                                                                                </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 172         return mediaSource;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173     }                                                                                                    </span>
<span  style=""> 174                                                                                                          </span>
<span  style=""> 175                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 176     /**                                                                                                  </span>
<span class="268464750667491347" onmouseenter="enter('268464750667491347');" onmouseout="out('268464750667491347');" style=""> 177      * 设置ExoPlayer 的 MediaSource 创建拦截                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 178      */                                                                                                  </span>
<span class="-3220193549345070784" onmouseenter="enter('-3220193549345070784');" onmouseout="out('-3220193549345070784');" style=""><abbr title=" 179     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptListener) {"> 179     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceI🔵</abbr></span>
<span class="6889549739386344871" onmouseenter="enter('6889549739386344871');" onmouseout="out('6889549739386344871');" style=""> 180         sExoMediaSourceInterceptListener = exoMediaSourceInterceptListener;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181     }                                                                                                    </span>
<span  style=""> 182                                                                                                          </span>
<span class="-4818621628615420115" onmouseenter="enter('-4818621628615420115');" onmouseout="out('-4818621628615420115');" style=""> 183     public static void resetExoMediaSourceInterceptListener() {                                          </span>
<span class="-256584753286895392" onmouseenter="enter('-256584753286895392');" onmouseout="out('-256584753286895392');" style=""> 184         sExoMediaSourceInterceptListener = null;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185     }                                                                                                    </span>
<span  style=""> 186                                                                                                          </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style=""> 187     public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                 </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style=""> 188         return sExoMediaSourceInterceptListener;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span  style=""> 191                                                                                                          </span>
<span class="-1063844347616692784" onmouseenter="enter('-1063844347616692784');" onmouseout="out('-1063844347616692784');" style=""> 192     @SuppressLint(&quot;WrongConstant&quot;)                                                                       </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 193     @C.ContentType                                                                                       </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 194 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-1063986311404684031" onmouseenter="enter('-1063986311404684031');" onmouseout="out('-1063986311404684031');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 195     public static int inferContentType(@NonNull String fileName, @Nullable String overrideExtension) {   </span>
<span class="-8972737784242637319" onmouseenter="enter('-8972737784242637319');" onmouseout="out('-8972737784242637319');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 196         fileName = fileName.toLowerCase(Locale.US);                                                      </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 197 ||||||| BASE                                                                                             </span>
<span class="-8571548472546648501" onmouseenter="enter('-8571548472546648501');" onmouseout="out('-8571548472546648501');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198     public static int inferContentType(String fileName, @Nullable String overrideExtension) {            </span>
<span class="-392879567198634870" onmouseenter="enter('-392879567198634870');" onmouseout="out('-392879567198634870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199         fileName = Util.toLowerInvariant(fileName);                                                      </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 200 =======                                                                                                  </span>
<span class="-8571548472546648501" onmouseenter="enter('-8571548472546648501');" onmouseout="out('-8571548472546648501');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201     public static int inferContentType(String fileName, @Nullable String overrideExtension) {            </span>
<span class="-1058212535841907919" onmouseenter="enter('-1058212535841907919');" onmouseout="out('-1058212535841907919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202         fileName = Ascii.toLowerCase(fileName);                                                          </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 203 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="6865607915146658606" onmouseenter="enter('6865607915146658606');" onmouseout="out('6865607915146658606');" style=""> 204         if (fileName.startsWith(&quot;rtmp:&quot;)) {                                                              </span>
<span class="-2335515362235810488" onmouseenter="enter('-2335515362235810488');" onmouseout="out('-2335515362235810488');" style=""> 205             return TYPE_RTMP;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 206         } else {                                                                                         </span>
<span class="-4150133085136108549" onmouseenter="enter('-4150133085136108549');" onmouseout="out('-4150133085136108549');" style=""> 207             return inferContentType(Uri.parse(fileName), overrideExtension);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 211     @C.ContentType                                                                                       </span>
<span class="51086760664059912" onmouseenter="enter('51086760664059912');" onmouseout="out('51086760664059912');" style=""> 212     public static int inferContentType(Uri uri, @Nullable String overrideExtension) {                    </span>
<span class="8118578399735665553" onmouseenter="enter('8118578399735665553');" onmouseout="out('8118578399735665553');" style=""> 213         return Util.inferContentType(uri, overrideExtension);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 216     /**                                                                                                  </span>
<span class="-2918834671047387949" onmouseenter="enter('-2918834671047387949');" onmouseout="out('-2918834671047387949');" style=""> 217      * 本地缓存目录                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 218      */                                                                                                  </span>
<span class="8373741442571147480" onmouseenter="enter('8373741442571147480');" onmouseout="out('8373741442571147480');" style=""> 219     public static synchronized Cache getCacheSingleInstance(Context context, File cacheDir) {            </span>
<span class="5493858603497608540" onmouseenter="enter('5493858603497608540');" onmouseout="out('5493858603497608540');" style=""> 220         String dirs = context.getCacheDir().getAbsolutePath();                                           </span>
<span class="7445937115127050990" onmouseenter="enter('7445937115127050990');" onmouseout="out('7445937115127050990');" style=""> 221         if (cacheDir != null) {                                                                          </span>
<span class="4597761149181751399" onmouseenter="enter('4597761149181751399');" onmouseout="out('4597761149181751399');" style=""> 222             dirs = cacheDir.getAbsolutePath();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223         }                                                                                                </span>
<span class="-5262494487137808971" onmouseenter="enter('-5262494487137808971');" onmouseout="out('-5262494487137808971');" style=""> 224         if (mCache == null) {                                                                            </span>
<span class="-8514817442366527959" onmouseenter="enter('-8514817442366527959');" onmouseout="out('-8514817442366527959');" style=""> 225             String path = dirs + File.separator + &quot;exo&quot;;                                                 </span>
<span class="-1725211349640716689" onmouseenter="enter('-1725211349640716689');" onmouseout="out('-1725211349640716689');" style=""> 226             boolean isLocked = SimpleCache.isCacheFolderLocked(new File(path));                          </span>
<span class="-5993825009051200231" onmouseenter="enter('-5993825009051200231');" onmouseout="out('-5993825009051200231');" style=""> 227             if (!isLocked) {                                                                             </span>
<span class="-6256951664120801242" onmouseenter="enter('-6256951664120801242');" onmouseout="out('-6256951664120801242');" style=""><abbr title=" 228                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE), sDatabaseProvider);"> 228                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SI🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230         }                                                                                                </span>
<span class="2375441079046756829" onmouseenter="enter('2375441079046756829');" onmouseout="out('2375441079046756829');" style=""> 231         return mCache;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232     }                                                                                                    </span>
<span  style=""> 233                                                                                                          </span>
<span class="2702286103088736995" onmouseenter="enter('2702286103088736995');" onmouseout="out('2702286103088736995');" style=""> 234     public void release() {                                                                              </span>
<span class="-4077098582254622113" onmouseenter="enter('-4077098582254622113');" onmouseout="out('-4077098582254622113');" style=""> 235         isCached = false;                                                                                </span>
<span class="-6083569314997925846" onmouseenter="enter('-6083569314997925846');" onmouseout="out('-6083569314997925846');" style=""> 236         if (mCache != null) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 237             try {                                                                                        </span>
<span class="529169855077323853" onmouseenter="enter('529169855077323853');" onmouseout="out('529169855077323853');" style=""> 238                 mCache.release();                                                                        </span>
<span class="-5535969345357657316" onmouseenter="enter('-5535969345357657316');" onmouseout="out('-5535969345357657316');" style=""> 239                 mCache = null;                                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 240             } catch (Exception e) {                                                                      </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 241                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244     }                                                                                                    </span>
<span  style=""> 245                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 246     /**                                                                                                  </span>
<span class="2545213195216124485" onmouseenter="enter('2545213195216124485');" onmouseout="out('2545213195216124485');" style=""> 247      * Cache需要release之后才能clear                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 248      */                                                                                                  </span>
<span class="6047086158735776789" onmouseenter="enter('6047086158735776789');" onmouseout="out('6047086158735776789');" style=""> 249     public static void clearCache(Context context, File cacheDir, String url) {                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 250         try {                                                                                            </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 251             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 252             if (!TextUtils.isEmpty(url)) {                                                               </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 253                 if (cache != null) {                                                                     </span>
<span class="-5650187598242283898" onmouseenter="enter('-5650187598242283898');" onmouseout="out('-5650187598242283898');" style=""> 254                     removeCache(cache, url);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 256             } else {                                                                                     </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 257                 if (cache != null) {                                                                     </span>
<span class="7961042807133489432" onmouseenter="enter('7961042807133489432');" onmouseout="out('7961042807133489432');" style=""> 258                     for (String key : cache.getKeys()) {                                                 </span>
<span class="-7152962664806820071" onmouseenter="enter('-7152962664806820071');" onmouseout="out('-7152962664806820071');" style=""> 259                         removeCache(cache, key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 263         } catch (Exception e) {                                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 264             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span  style=""> 267                                                                                                          </span>
<span  style=""> 268                                                                                                          </span>
<span class="167482028640019662" onmouseenter="enter('167482028640019662');" onmouseout="out('167482028640019662');" style=""> 269     public static void removeCache(Cache cache, String url) {                                            </span>
<span class="-1909055186960113209" onmouseenter="enter('-1909055186960113209');" onmouseout="out('-1909055186960113209');" style=""> 270         NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(buildCacheKey(url));                  </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 271         for (CacheSpan cachedSpan : cachedSpans) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 272             try {                                                                                        </span>
<span class="1961840987401424959" onmouseenter="enter('1961840987401424959');" onmouseout="out('1961840987401424959');" style=""> 273                 cache.removeSpan(cachedSpan);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 274             } catch (Exception e) {                                                                      </span>
<span class="-4130810023601196090" onmouseenter="enter('-4130810023601196090');" onmouseout="out('-4130810023601196090');" style=""> 275                 // Do nothing.                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span class="-8198521815859651674" onmouseenter="enter('-8198521815859651674');" onmouseout="out('-8198521815859651674');" style=""> 280     public static String buildCacheKey(String url) {                                                     </span>
<span class="3080452641973210712" onmouseenter="enter('3080452641973210712');" onmouseout="out('3080452641973210712');" style=""> 281         DataSpec dataSpec = new DataSpec(Uri.parse(url));                                                </span>
<span class="3397752349715137889" onmouseenter="enter('3397752349715137889');" onmouseout="out('3397752349715137889');" style=""> 282         return CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="-2359379937002163053" onmouseenter="enter('-2359379937002163053');" onmouseout="out('-2359379937002163053');" style=""> 285     public static boolean cachePreView(Context context, File cacheDir, String url) {                     </span>
<span class="6669724668123101030" onmouseenter="enter('6669724668123101030');" onmouseout="out('6669724668123101030');" style=""> 286         return resolveCacheState(getCacheSingleInstance(context, cacheDir), url);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287     }                                                                                                    </span>
<span  style=""> 288                                                                                                          </span>
<span class="4275422663013542480" onmouseenter="enter('4275422663013542480');" onmouseout="out('4275422663013542480');" style=""> 289     public boolean hadCached() {                                                                         </span>
<span class="3074888405336734299" onmouseenter="enter('3074888405336734299');" onmouseout="out('3074888405336734299');" style=""> 290         return isCached;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style=""> 294      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 296      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 297      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 298     @Deprecated                                                                                          </span>
<span class="2198318641674923085" onmouseenter="enter('2198318641674923085');" onmouseout="out('2198318641674923085');" style=""> 299     public static boolean isSkipSSLChain() {                                                             </span>
<span class="873024860049770122" onmouseenter="enter('873024860049770122');" onmouseout="out('873024860049770122');" style=""> 300         return sSkipSSLChain;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 303     /**                                                                                                  </span>
<span class="2007360617581285918" onmouseenter="enter('2007360617581285918');" onmouseout="out('2007360617581285918');" style=""> 304      * 设置https忽略证书                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 305      *                                                                                                   </span>
<span class="-8071550217355649258" onmouseenter="enter('-8071550217355649258');" onmouseout="out('-8071550217355649258');" style=""> 306      * @param skipSSLChain true时是hulve                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 307      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 308      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 309     @Deprecated                                                                                          </span>
<span class="-1308991004088670996" onmouseenter="enter('-1308991004088670996');" onmouseout="out('-1308991004088670996');" style=""> 310     public static void setSkipSSLChain(boolean skipSSLChain) {                                           </span>
<span class="1121146022274574744" onmouseenter="enter('1121146022274574744');" onmouseout="out('1121146022274574744');" style=""> 311         sSkipSSLChain = skipSSLChain;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312     }                                                                                                    </span>
<span  style=""> 313                                                                                                          </span>
<span  style=""> 314                                                                                                          </span>
<span class="2976239622278297742" onmouseenter="enter('2976239622278297742');" onmouseout="out('2976239622278297742');" style=""> 315     public static int getHttpReadTimeout() {                                                             </span>
<span class="5523542451485133181" onmouseenter="enter('5523542451485133181');" onmouseout="out('5523542451485133181');" style=""> 316         return sHttpReadTimeout;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317     }                                                                                                    </span>
<span  style=""> 318                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 319     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 320      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 321      */                                                                                                  </span>
<span class="2919025488051579831" onmouseenter="enter('2919025488051579831');" onmouseout="out('2919025488051579831');" style=""> 322     public static void setHttpReadTimeout(int httpReadTimeout) {                                         </span>
<span class="-3997040606525716839" onmouseenter="enter('-3997040606525716839');" onmouseout="out('-3997040606525716839');" style=""> 323         ExoSourceManager.sHttpReadTimeout = httpReadTimeout;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324     }                                                                                                    </span>
<span  style=""> 325                                                                                                          </span>
<span class="5450236011176178791" onmouseenter="enter('5450236011176178791');" onmouseout="out('5450236011176178791');" style=""> 326     public static int getHttpConnectTimeout() {                                                          </span>
<span class="1111499796559727252" onmouseenter="enter('1111499796559727252');" onmouseout="out('1111499796559727252');" style=""> 327         return sHttpConnectTimeout;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328     }                                                                                                    </span>
<span  style=""> 329                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 330     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 331      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332      */                                                                                                  </span>
<span class="-7016684631510872274" onmouseenter="enter('-7016684631510872274');" onmouseout="out('-7016684631510872274');" style=""> 333     public static void setHttpConnectTimeout(int httpConnectTimeout) {                                   </span>
<span class="-2795264608914979197" onmouseenter="enter('-2795264608914979197');" onmouseout="out('-2795264608914979197');" style=""> 334         ExoSourceManager.sHttpConnectTimeout = httpConnectTimeout;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335     }                                                                                                    </span>
<span  style=""> 336                                                                                                          </span>
<span class="-3420724575907019098" onmouseenter="enter('-3420724575907019098');" onmouseout="out('-3420724575907019098');" style=""> 337     public static DatabaseProvider getDatabaseProvider() {                                               </span>
<span class="-2185808013130137608" onmouseenter="enter('-2185808013130137608');" onmouseout="out('-2185808013130137608');" style=""> 338         return sDatabaseProvider;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339     }                                                                                                    </span>
<span  style=""> 340                                                                                                          </span>
<span class="-1193343422611666410" onmouseenter="enter('-1193343422611666410');" onmouseout="out('-1193343422611666410');" style=""> 341     public static void setDatabaseProvider(DatabaseProvider databaseProvider) {                          </span>
<span class="-7671573637861427354" onmouseenter="enter('-7671573637861427354');" onmouseout="out('-7671573637861427354');" style=""> 342         ExoSourceManager.sDatabaseProvider = databaseProvider;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343     }                                                                                                    </span>
<span  style=""> 344                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 345     /**                                                                                                  </span>
<span class="-1233347272602211288" onmouseenter="enter('-1233347272602211288');" onmouseout="out('-1233347272602211288');" style=""> 346      * 获取SourceFactory，是否带Cache                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 347      */                                                                                                  </span>
<span class="-8060849973918439601" onmouseenter="enter('-8060849973918439601');" onmouseout="out('-8060849973918439601');" style=""><abbr title=" 348     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, File cacheDir, String uerAgent) {"> 348     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean pr🔵</abbr></span>
<span class="7825217223858997247" onmouseenter="enter('7825217223858997247');" onmouseout="out('7825217223858997247');" style=""> 349         if (cacheEnable) {                                                                               </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 350             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 351             if (cache != null) {                                                                         </span>
<span class="9021007000539438017" onmouseenter="enter('9021007000539438017');" onmouseout="out('9021007000539438017');" style=""> 352                 isCached = resolveCacheState(cache, mDataSource);                                        </span>
<span class="-3761479699771438765" onmouseenter="enter('-3761479699771438765');" onmouseout="out('-3761479699771438765');" style=""> 353                 CacheDataSource.Factory factory = new CacheDataSource.Factory();                         </span>
<span class="-8093724037283287608" onmouseenter="enter('-8093724037283287608');" onmouseout="out('-8093724037283287608');" style=""> 354                 return factory.                                                                          </span>
<span class="-5074485159975905347" onmouseenter="enter('-5074485159975905347');" onmouseout="out('-5074485159975905347');" style=""><abbr title=" 355                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAgent)).setFlags(CacheDataSource.FLAG_IGNORE_CACHE_ON_ERROR);"> 355                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, previ🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357         }                                                                                                </span>
<span class="-1431913544698159813" onmouseenter="enter('-1431913544698159813');" onmouseout="out('-1431913544698159813');" style=""> 358         return getDataSourceFactory(context, preview, uerAgent);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359     }                                                                                                    </span>
<span  style=""> 360                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 361     /**                                                                                                  </span>
<span class="-283092449438347556" onmouseenter="enter('-283092449438347556');" onmouseout="out('-283092449438347556');" style=""> 362      * 获取SourceFactory                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 363      */                                                                                                  </span>
<span class="1834018894786004406" onmouseenter="enter('1834018894786004406');" onmouseout="out('1834018894786004406');" style=""> 364     private DataSource.Factory getDataSourceFactory(Context context, boolean preview, String uerAgent) { </span>
<span class="1829813597817317525" onmouseenter="enter('1829813597817317525');" onmouseout="out('1829813597817317525');" style=""><abbr title=" 365         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).build(),"> 365         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(c🔵</abbr></span>
<span class="-4652974943362556447" onmouseenter="enter('-4652974943362556447');" onmouseout="out('-4652974943362556447');" style=""> 366                 getHttpDataSourceFactory(context, preview, uerAgent));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367     }                                                                                                    </span>
<span  style=""> 368                                                                                                          </span>
<span class="-879776573326484759" onmouseenter="enter('-879776573326484759');" onmouseout="out('-879776573326484759');" style=""><abbr title=" 369     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent) {"> 369     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent🔵</abbr></span>
<span class="4493368850476432367" onmouseenter="enter('4493368850476432367');" onmouseout="out('4493368850476432367');" style=""> 370         if (uerAgent == null) {                                                                          </span>
<span class="-1748097148375756721" onmouseenter="enter('-1748097148375756721');" onmouseout="out('-1748097148375756721');" style=""> 371             uerAgent = Util.getUserAgent(context, TAG);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372         }                                                                                                </span>
<span class="-9065933110167474911" onmouseenter="enter('-9065933110167474911');" onmouseout="out('-9065933110167474911');" style=""> 373         int connectTimeout = DefaultHttpDataSource.DEFAULT_CONNECT_TIMEOUT_MILLIS;                       </span>
<span class="6449380685464591139" onmouseenter="enter('6449380685464591139');" onmouseout="out('6449380685464591139');" style=""> 374         int readTimeout = DefaultHttpDataSource.DEFAULT_READ_TIMEOUT_MILLIS;                             </span>
<span class="-1006385169289819833" onmouseenter="enter('-1006385169289819833');" onmouseout="out('-1006385169289819833');" style=""> 375         if (sHttpConnectTimeout &gt; 0) {                                                                   </span>
<span class="-1115887819057715189" onmouseenter="enter('-1115887819057715189');" onmouseout="out('-1115887819057715189');" style=""> 376             connectTimeout = sHttpConnectTimeout;                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377         }                                                                                                </span>
<span class="623482186481107038" onmouseenter="enter('623482186481107038');" onmouseout="out('623482186481107038');" style=""> 378         if (sHttpReadTimeout &gt; 0) {                                                                      </span>
<span class="3096862042682748327" onmouseenter="enter('3096862042682748327');" onmouseout="out('3096862042682748327');" style=""> 379             readTimeout = sHttpReadTimeout;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380         }                                                                                                </span>
<span class="-1477830294864050779" onmouseenter="enter('-1477830294864050779');" onmouseout="out('-1477830294864050779');" style=""> 381         boolean allowCrossProtocolRedirects = false;                                                     </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 382         if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                           </span>
<span class="-8838917078629499221" onmouseenter="enter('-8838917078629499221');" onmouseout="out('-8838917078629499221');" style=""> 383             allowCrossProtocolRedirects = &quot;true&quot;.equals(mMapHeadData.get(&quot;allowCrossProtocolRedirects&quot;));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span class="3270687530488436452" onmouseenter="enter('3270687530488436452');" onmouseout="out('3270687530488436452');" style=""> 385         DataSource.Factory dataSourceFactory;                                                            </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 386         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="2091451277126898709" onmouseenter="enter('2091451277126898709');" onmouseout="out('2091451277126898709');" style=""><abbr title=" 387             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 387             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, previ🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style=""> 388                     connectTimeout,                                                                      </span>
<span class="-51576699489615850" onmouseenter="enter('-51576699489615850');" onmouseout="out('-51576699489615850');" style=""> 389                     readTimeout, mMapHeadData, allowCrossProtocolRedirects);                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 390         } else {                                                                                         </span>
<span class="8445214236760378199" onmouseenter="enter('8445214236760378199');" onmouseout="out('8445214236760378199');" style=""> 391             dataSourceFactory = new DefaultHttpDataSource.Factory()                                      </span>
<span class="4157379816614128432" onmouseenter="enter('4157379816614128432');" onmouseout="out('4157379816614128432');" style=""> 392                     .setAllowCrossProtocolRedirects(allowCrossProtocolRedirects)                         </span>
<span class="-6788353891995527067" onmouseenter="enter('-6788353891995527067');" onmouseout="out('-6788353891995527067');" style=""> 393                     .setConnectTimeoutMs(connectTimeout)                                                 </span>
<span class="-4562924741655466840" onmouseenter="enter('-4562924741655466840');" onmouseout="out('-4562924741655466840');" style=""> 394                     .setReadTimeoutMs(readTimeout)                                                       </span>
<span class="5513192411211624142" onmouseenter="enter('5513192411211624142');" onmouseout="out('5513192411211624142');" style=""><abbr title=" 395                     .setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build());"> 395                     .setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).🔵</abbr></span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 396         if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                           </span>
<span class="-3433586199384292394" onmouseenter="enter('-3433586199384292394');" onmouseout="out('-3433586199384292394');" style=""><abbr title=" 397                 ((DefaultHttpDataSource.Factory) dataSourceFactory).setDefaultRequestProperties(mMapHeadData);"> 397                 ((DefaultHttpDataSource.Factory) dataSourceFactory).setDefaultRequestProperties(mMapHeadD🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399         }                                                                                                </span>
<span class="1723753173213071643" onmouseenter="enter('1723753173213071643');" onmouseout="out('1723753173213071643');" style=""> 400         return dataSourceFactory;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401     }                                                                                                    </span>
<span  style=""> 402                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 403     /**                                                                                                  </span>
<span class="-5059148079091929211" onmouseenter="enter('-5059148079091929211');" onmouseout="out('-5059148079091929211');" style=""> 404      * 根据缓存块判断是否缓存成功                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 405      */                                                                                                  </span>
<span class="-2204351825262319384" onmouseenter="enter('-2204351825262319384');" onmouseout="out('-2204351825262319384');" style=""> 406     private static boolean resolveCacheState(Cache cache, String url) {                                  </span>
<span class="124753744680968754" onmouseenter="enter('124753744680968754');" onmouseout="out('124753744680968754');" style=""> 407         boolean isCache = true;                                                                          </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 408         if (!TextUtils.isEmpty(url)) {                                                                   </span>
<span class="9175234064888605862" onmouseenter="enter('9175234064888605862');" onmouseout="out('9175234064888605862');" style=""> 409             String key = buildCacheKey(url);                                                             </span>
<span class="8462256178484181139" onmouseenter="enter('8462256178484181139');" onmouseout="out('8462256178484181139');" style=""> 410             if (!TextUtils.isEmpty(key)) {                                                               </span>
<span class="-8737585301747024644" onmouseenter="enter('-8737585301747024644');" onmouseout="out('-8737585301747024644');" style=""> 411                 NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(key);                         </span>
<span class="6104552210198839213" onmouseenter="enter('6104552210198839213');" onmouseout="out('6104552210198839213');" style=""> 412                 if (cachedSpans.size() == 0) {                                                           </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 413                     isCache = false;                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 414                 } else {                                                                                 </span>
<span class="122280032006644231" onmouseenter="enter('122280032006644231');" onmouseout="out('122280032006644231');" style=""><abbr title=" 415                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.LENGTH_UNSET);"> 415                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LE🔵</abbr></span>
<span class="2548419966105293269" onmouseenter="enter('2548419966105293269');" onmouseout="out('2548419966105293269');" style=""> 416                     long currentLength = 0;                                                              </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 417                     for (CacheSpan cachedSpan : cachedSpans) {                                           </span>
<span class="-228864752981275902" onmouseenter="enter('-228864752981275902');" onmouseout="out('-228864752981275902');" style=""><abbr title=" 418                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.length);"> 418                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.lengt🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419                     }                                                                                    </span>
<span class="-95640198430383414" onmouseenter="enter('-95640198430383414');" onmouseout="out('-95640198430383414');" style=""> 420                     isCache = currentLength &gt;= contentLength;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 422             } else {                                                                                     </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 423                 isCache = false;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425         }                                                                                                </span>
<span class="-4805343878943095560" onmouseenter="enter('-4805343878943095560');" onmouseout="out('-4805343878943095560');" style=""> 426         return isCache;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428 }                                                                                                        </span>








</pre></td>
                            <td><pre><span class="-5503081748616462646" onmouseenter="enter('-5503081748616462646');" onmouseout="out('-5503081748616462646');" style="">   1 package tv.danmaku.ijk.media.exo2;                                                                       </span>
<span  style="">   2                                                                                                          </span>
<span class="-3997288425915246049" onmouseenter="enter('-3997288425915246049');" onmouseout="out('-3997288425915246049');" style="">   3 import android.annotation.SuppressLint;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4 import android.content.Context;                                                                          </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5 import android.net.Uri;                                                                                  </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   6 import android.text.TextUtils;                                                                           </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="">   7 import androidx.annotation.NonNull;                                                                      </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">   8 import androidx.annotation.Nullable;                                                                     </span>
<span class="1487611449423756792" onmouseenter="enter('1487611449423756792');" onmouseout="out('1487611449423756792');" style="">   9 import com.google.android.exoplayer2.C;                                                                  </span>
<span class="867094050949454463" onmouseenter="enter('867094050949454463');" onmouseout="out('867094050949454463');" style="">  10 import com.google.android.exoplayer2.MediaItem;                                                          </span>
<span class="-3172072599128556050" onmouseenter="enter('-3172072599128556050');" onmouseout="out('-3172072599128556050');" style="">  11 import com.google.android.exoplayer2.database.DatabaseProvider;                                          </span>
<span class="-2844689653783287849" onmouseenter="enter('-2844689653783287849');" onmouseout="out('-2844689653783287849');" style="">  12 import com.google.android.exoplayer2.ext.rtmp.RtmpDataSourceFactory;                                     </span>
<span class="3675920877003625902" onmouseenter="enter('3675920877003625902');" onmouseout="out('3675920877003625902');" style="">  13 import com.google.android.exoplayer2.extractor.DefaultExtractorsFactory;                                 </span>
<span class="-6167091960224777303" onmouseenter="enter('-6167091960224777303');" onmouseout="out('-6167091960224777303');" style="">  14 import com.google.android.exoplayer2.source.MediaSource;                                                 </span>
<span class="-3105544688913650545" onmouseenter="enter('-3105544688913650545');" onmouseout="out('-3105544688913650545');" style="">  15 import com.google.android.exoplayer2.source.ProgressiveMediaSource;                                      </span>
<span class="-4960919004069838122" onmouseenter="enter('-4960919004069838122');" onmouseout="out('-4960919004069838122');" style="">  16 import com.google.android.exoplayer2.source.dash.DashMediaSource;                                        </span>
<span class="-4413409349911342092" onmouseenter="enter('-4413409349911342092');" onmouseout="out('-4413409349911342092');" style="">  17 import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;                                 </span>
<span class="392947657445256672" onmouseenter="enter('392947657445256672');" onmouseout="out('392947657445256672');" style="">  18 import com.google.android.exoplayer2.source.hls.HlsMediaSource;                                          </span>
<span class="1080782699538105726" onmouseenter="enter('1080782699538105726');" onmouseout="out('1080782699538105726');" style="">  19 import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;                        </span>
<span class="-8280776144719855835" onmouseenter="enter('-8280776144719855835');" onmouseout="out('-8280776144719855835');" style="">  20 import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;                               </span>
<span class="-5025142600139113447" onmouseenter="enter('-5025142600139113447');" onmouseout="out('-5025142600139113447');" style="">  21 import com.google.android.exoplayer2.upstream.DataSource;                                                </span>
<span class="-6054887794217826236" onmouseenter="enter('-6054887794217826236');" onmouseout="out('-6054887794217826236');" style="">  22 import com.google.android.exoplayer2.upstream.DataSpec;                                                  </span>
<span class="-1926464862603214616" onmouseenter="enter('-1926464862603214616');" onmouseout="out('-1926464862603214616');" style="">  23 import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;                                     </span>
<span class="7691807062585918827" onmouseenter="enter('7691807062585918827');" onmouseout="out('7691807062585918827');" style="">  24 import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;                                  </span>
<span class="8221609960337784667" onmouseenter="enter('8221609960337784667');" onmouseout="out('8221609960337784667');" style="">  25 import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;                                     </span>
<span class="3684976669809945769" onmouseenter="enter('3684976669809945769');" onmouseout="out('3684976669809945769');" style="">  26 import com.google.android.exoplayer2.upstream.RawResourceDataSource;                                     </span>
<span class="3791899211787747371" onmouseenter="enter('3791899211787747371');" onmouseout="out('3791899211787747371');" style="">  27 import com.google.android.exoplayer2.upstream.cache.Cache;                                               </span>
<span class="-8148834636982163692" onmouseenter="enter('-8148834636982163692');" onmouseout="out('-8148834636982163692');" style="">  28 import com.google.android.exoplayer2.upstream.cache.CacheDataSource;                                     </span>
<span class="-8685955199172896893" onmouseenter="enter('-8685955199172896893');" onmouseout="out('-8685955199172896893');" style="">  29 import com.google.android.exoplayer2.upstream.cache.CacheKeyFactory;                                     </span>
<span class="-4601203435061269454" onmouseenter="enter('-4601203435061269454');" onmouseout="out('-4601203435061269454');" style="">  30 import com.google.android.exoplayer2.upstream.cache.CacheSpan;                                           </span>
<span class="-8498858967217479983" onmouseenter="enter('-8498858967217479983');" onmouseout="out('-8498858967217479983');" style="">  31 import com.google.android.exoplayer2.upstream.cache.ContentMetadata;                                     </span>
<span class="-2820765455975363243" onmouseenter="enter('-2820765455975363243');" onmouseout="out('-2820765455975363243');" style="">  32 import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;                       </span>
<span class="-7748643470419441439" onmouseenter="enter('-7748643470419441439');" onmouseout="out('-7748643470419441439');" style="">  33 import com.google.android.exoplayer2.upstream.cache.SimpleCache;                                         </span>
<span class="-1809507180972376256" onmouseenter="enter('-1809507180972376256');" onmouseout="out('-1809507180972376256');" style="">  34 import com.google.android.exoplayer2.util.Util;                                                          </span>
<span class="-5152250604397781057" onmouseenter="enter('-5152250604397781057');" onmouseout="out('-5152250604397781057');" style="">  35 import com.google.common.base.Ascii;                                                                     </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  36 import java.io.File;                                                                                     </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="">  37 import java.util.Locale;                                                                                 </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  38 import java.util.Map;                                                                                    </span>
<span class="-5539540480142207555" onmouseenter="enter('-5539540480142207555');" onmouseout="out('-5539540480142207555');" style="">  39 import java.util.NavigableSet;                                                                           </span>
<span  style="">  40                                                                                                          </span>
<span  style="">  41                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  42 /**                                                                                                      </span>
<span class="-3817795341581382404" onmouseenter="enter('-3817795341581382404');" onmouseout="out('-3817795341581382404');" style="">  43  * Created by guoshuyu on 2018/5/18.                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  44  */                                                                                                      </span>
<span class="5978956340021809315" onmouseenter="enter('5978956340021809315');" onmouseout="out('5978956340021809315');" style="">  45 public class ExoSourceManager {                                                                          </span>
<span class="2143614905519812283" onmouseenter="enter('2143614905519812283');" onmouseout="out('2143614905519812283');" style="">  46     private static final String TAG = &quot;ExoSourceManager&quot;;                                                </span>
<span  style="">  47                                                                                                          </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="">  48     private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                      </span>
<span  style="">  49                                                                                                          </span>
<span class="7190915484758380076" onmouseenter="enter('7190915484758380076');" onmouseout="out('7190915484758380076');" style="">  50     public static final int TYPE_RTMP =                                                                  </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">  51 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="1262363877953995338" onmouseenter="enter('1262363877953995338');" onmouseout="out('1262363877953995338');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  52 100                                                                                                      </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  53 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  54 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">  54 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  55 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56                                                                                                          </span>
<span class="-6024621852987905742" onmouseenter="enter('-6024621852987905742');" onmouseout="out('-6024621852987905742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  57 14                                                                                                       </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style="">  58 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-2934185353411265329" onmouseenter="enter('-2934185353411265329');" onmouseout="out('-2934185353411265329');" style="">  59     ;                                                                                                    </span>
<span  style="">  60                                                                                                          </span>
<span class="2866779009294581851" onmouseenter="enter('2866779009294581851');" onmouseout="out('2866779009294581851');" style="">  61     private static Cache mCache;                                                                         </span>
<span  style="">  62                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style="">  64      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style="">  66      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  67      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  68     @Deprecated                                                                                          </span>
<span class="6733722337026437480" onmouseenter="enter('6733722337026437480');" onmouseout="out('6733722337026437480');" style="">  69     private static boolean sSkipSSLChain = false;                                                        </span>
<span  style="">  70                                                                                                          </span>
<span class="-8322579848361947255" onmouseenter="enter('-8322579848361947255');" onmouseout="out('-8322579848361947255');" style="">  71     private static int sHttpReadTimeout = -1;                                                            </span>
<span  style="">  72                                                                                                          </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="">  73     private static int sHttpConnectTimeout = -1;                                                         </span>
<span  style="">  74                                                                                                          </span>
<span class="7019408237288028740" onmouseenter="enter('7019408237288028740');" onmouseout="out('7019408237288028740');" style="">  75     private final Context mAppContext;                                                                   </span>
<span  style="">  76                                                                                                          </span>
<span class="-4374222225418050568" onmouseenter="enter('-4374222225418050568');" onmouseout="out('-4374222225418050568');" style="">  77     private final Map&lt;String, String&gt; mMapHeadData;                                                      </span>
<span  style="">  78                                                                                                          </span>
<span class="2720391937428942309" onmouseenter="enter('2720391937428942309');" onmouseout="out('2720391937428942309');" style="">  79     private String mDataSource;                                                                          </span>
<span  style="">  80                                                                                                          </span>
<span class="898136537903361042" onmouseenter="enter('898136537903361042');" onmouseout="out('898136537903361042');" style="">  81     private static ExoMediaSourceInterceptListener sExoMediaSourceInterceptListener;                     </span>
<span  style="">  82                                                                                                          </span>
<span class="6692810545416200650" onmouseenter="enter('6692810545416200650');" onmouseout="out('6692810545416200650');" style="">  83     private static final DatabaseProvider sDatabaseProvider;                                             </span>
<span  style="">  84                                                                                                          </span>
<span class="-2905075036207193429" onmouseenter="enter('-2905075036207193429');" onmouseout="out('-2905075036207193429');" style="">  85     private boolean isCached = false;                                                                    </span>
<span  style="">  86                                                                                                          </span>
<span class="-3397611666931429980" onmouseenter="enter('-3397611666931429980');" onmouseout="out('-3397611666931429980');" style=""><abbr title="  87     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData) {">  87     public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData🔵</abbr></span>
<span class="-6448993279383120903" onmouseenter="enter('-6448993279383120903');" onmouseout="out('-6448993279383120903');" style="">  88         return new ExoSourceManager(context, mapHeadData);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89     }                                                                                                    </span>
<span  style="">  90                                                                                                          </span>
<span class="-2557713181218471643" onmouseenter="enter('-2557713181218471643');" onmouseout="out('-2557713181218471643');" style="">  91     private ExoSourceManager(Context context, Map&lt;String, String&gt; mapHeadData) {                         </span>
<span class="7302624818817228010" onmouseenter="enter('7302624818817228010');" onmouseout="out('7302624818817228010');" style="">  92         mAppContext = context.getApplicationContext();                                                   </span>
<span class="3872213483840267174" onmouseenter="enter('3872213483840267174');" onmouseout="out('3872213483840267174');" style="">  93         mMapHeadData = mapHeadData;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94     }                                                                                                    </span>
<span  style="">  95                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  96     /**                                                                                                  </span>
<span class="-8955960166298079068" onmouseenter="enter('-8955960166298079068');" onmouseout="out('-8955960166298079068');" style="">  97      * @param dataSource  链接                                                                             </span>
<span class="-8878537572148364092" onmouseenter="enter('-8878537572148364092');" onmouseout="out('-8878537572148364092');" style="">  98      * @param preview     是否带上header，默认有header自动设置为true                                                  </span>
<span class="86969417606586940" onmouseenter="enter('86969417606586940');" onmouseout="out('86969417606586940');" style="">  99      * @param cacheEnable 是否需要缓存                                                                         </span>
<span class="-966782913438754" onmouseenter="enter('-966782913438754');" onmouseout="out('-966782913438754');" style=""> 100      * @param isLooping   是否循环                                                                           </span>
<span class="3920492570930179262" onmouseenter="enter('3920492570930179262');" onmouseout="out('3920492570930179262');" style=""> 101      * @param cacheDir    自定义缓存目录                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 102      */                                                                                                  </span>
<span class="-557641936909764262" onmouseenter="enter('-557641936909764262');" onmouseout="out('-557641936909764262');" style=""><abbr title=" 103     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, File cacheDir, @Nullable"> 103     public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean is🔵</abbr></span>
<span class="-1444738599190350902" onmouseenter="enter('-1444738599190350902');" onmouseout="out('-1444738599190350902');" style=""> 104     String overrideExtension) {                                                                          </span>
<span class="-8115162023017778502" onmouseenter="enter('-8115162023017778502');" onmouseout="out('-8115162023017778502');" style=""> 105         MediaSource mediaSource = null;                                                                  </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 106         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="1460304608887237329" onmouseenter="enter('1460304608887237329');" onmouseout="out('1460304608887237329');" style=""><abbr title=" 107             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLooping, cacheDir);"> 107             mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnabl🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="-6444727352463407138" onmouseenter="enter('-6444727352463407138');" onmouseout="out('-6444727352463407138');" style=""> 109         if (mediaSource != null) {                                                                       </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 110             return mediaSource;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111         }                                                                                                </span>
<span class="-143711945711027689" onmouseenter="enter('-143711945711027689');" onmouseout="out('-143711945711027689');" style=""> 112         mDataSource = dataSource;                                                                        </span>
<span class="4324385998490320101" onmouseenter="enter('4324385998490320101');" onmouseout="out('4324385998490320101');" style=""> 113         Uri contentUri = Uri.parse(dataSource);                                                          </span>
<span class="1133761916200375127" onmouseenter="enter('1133761916200375127');" onmouseout="out('1133761916200375127');" style=""> 114         MediaItem mediaItem = MediaItem.fromUri(contentUri);                                             </span>
<span class="-999163251238408129" onmouseenter="enter('-999163251238408129');" onmouseout="out('-999163251238408129');" style=""> 115         int contentType = inferContentType(dataSource, overrideExtension);                               </span>
<span class="-3913681325976844847" onmouseenter="enter('-3913681325976844847');" onmouseout="out('-3913681325976844847');" style=""> 116         String uerAgent = null;                                                                          </span>
<span class="-7096342993828865452" onmouseenter="enter('-7096342993828865452');" onmouseout="out('-7096342993828865452');" style=""> 117         if (mMapHeadData != null) {                                                                      </span>
<span class="-2322630379955906840" onmouseenter="enter('-2322630379955906840');" onmouseout="out('-2322630379955906840');" style=""> 118             uerAgent = mMapHeadData.get(&quot;User-Agent&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119         }                                                                                                </span>
<span class="-8719898405424144062" onmouseenter="enter('-8719898405424144062');" onmouseout="out('-8719898405424144062');" style=""> 120         if (&quot;android.resource&quot;.equals(contentUri.getScheme())) {                                         </span>
<span class="8727359621133688309" onmouseenter="enter('8727359621133688309');" onmouseout="out('8727359621133688309');" style=""> 121             DataSpec dataSpec = new DataSpec(contentUri);                                                </span>
<span class="4481052292773557445" onmouseenter="enter('4481052292773557445');" onmouseout="out('4481052292773557445');" style=""> 122             final RawResourceDataSource rawResourceDataSource = new RawResourceDataSource(mAppContext);  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 123             try {                                                                                        </span>
<span class="2726278993395089263" onmouseenter="enter('2726278993395089263');" onmouseout="out('2726278993395089263');" style=""> 124                 rawResourceDataSource.open(dataSpec);                                                    </span>
<span class="1570087337785213824" onmouseenter="enter('1570087337785213824');" onmouseout="out('1570087337785213824');" style=""> 125             } catch (RawResourceDataSource e) {                                                          </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 126                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127             }                                                                                            </span>
<span class="7704964188260260407" onmouseenter="enter('7704964188260260407');" onmouseout="out('7704964188260260407');" style=""> 128             DataSource.Factory factory = () -&gt; rawResourceDataSource;                                    </span>
<span class="-494103000094544297" onmouseenter="enter('-494103000094544297');" onmouseout="out('-494103000094544297');" style=""> 129             return new ProgressiveMediaSource.Factory(factory).createMediaSource(mediaItem);             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130         }                                                                                                </span>
<span class="2154133365005964027" onmouseenter="enter('2154133365005964027');" onmouseout="out('2154133365005964027');" style=""> 131         switch (contentType) {                                                                           </span>
<span class="-8260160782130231053" onmouseenter="enter('-8260160782130231053');" onmouseout="out('-8260160782130231053');" style=""> 132             case C.TYPE_SS :                                                                             </span>
<span class="3210330732768270150" onmouseenter="enter('3210330732768270150');" onmouseout="out('3210330732768270150');" style=""><abbr title=" 133                 mediaSource = new SsMediaSource.Factory(new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)), new DefaultDataSourceFactory(mAppContext, null, getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 133                 mediaSource = new SsMediaSource.Factory(new DefaultSsChunkSource.Factory(getDataSourceFac🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 134                 break;                                                                                   </span>
<span class="-180799006719976757" onmouseenter="enter('-180799006719976757');" onmouseout="out('-180799006719976757');" style=""> 135             case C.TYPE_DASH :                                                                           </span>
<span class="955059543619722900" onmouseenter="enter('955059543619722900');" onmouseout="out('955059543619722900');" style=""><abbr title=" 136                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)), new DefaultDataSourceFactory(mAppContext, null, getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 136                 mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourc🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 137                 break;                                                                                   </span>
<span class="1275028301213503841" onmouseenter="enter('1275028301213503841');" onmouseout="out('1275028301213503841');" style=""> 138             case C.TYPE_HLS :                                                                            </span>
<span class="3299947955952801596" onmouseenter="enter('3299947955952801596');" onmouseout="out('3299947955952801596');" style=""><abbr title=" 139                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)).setAllowChunklessPreparation(true).createMediaSource(mediaItem);"> 139                 mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnab🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 140                 break;                                                                                   </span>
<span class="-3040166889121252233" onmouseenter="enter('-3040166889121252233');" onmouseout="out('-3040166889121252233');" style=""> 141             case TYPE_RTMP :                                                                             </span>
<span class="-652703182204257991" onmouseenter="enter('-652703182204257991');" onmouseout="out('-652703182204257991');" style=""> 142                 RtmpDataSourceFactory rtmpDataSourceFactory = new RtmpDataSourceFactory(null);           </span>
<span class="-8876536953700089199" onmouseenter="enter('-8876536953700089199');" onmouseout="out('-8876536953700089199');" style=""><abbr title=" 143                 mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory, new DefaultExtractorsFactory()).createMediaSource(mediaItem);"> 143                 mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory, new DefaultExtrac🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 144                 break;                                                                                   </span>
<span class="6112175639660926084" onmouseenter="enter('6112175639660926084');" onmouseout="out('6112175639660926084');" style=""> 145             case C.TYPE_OTHER :                                                                          </span>
<span class="3050734735710613783" onmouseenter="enter('3050734735710613783');" onmouseout="out('3050734735710613783');" style=""> 146             default :                                                                                    </span>
<span class="-210806445958508008" onmouseenter="enter('-210806445958508008');" onmouseout="out('-210806445958508008');" style=""><abbr title=" 147                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent), new DefaultExtractorsFactory()).createMediaSource(mediaItem);"> 147                 mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, c🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 148                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149         }                                                                                                </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 150         return mediaSource;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151     }                                                                                                    </span>
<span  style=""> 152                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 153     /**                                                                                                  </span>
<span class="268464750667491347" onmouseenter="enter('268464750667491347');" onmouseout="out('268464750667491347');" style=""> 154      * 设置ExoPlayer 的 MediaSource 创建拦截                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 155      */                                                                                                  </span>
<span class="-3220193549345070784" onmouseenter="enter('-3220193549345070784');" onmouseout="out('-3220193549345070784');" style=""><abbr title=" 156     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptListener) {"> 156     public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceI🔵</abbr></span>
<span class="6889549739386344871" onmouseenter="enter('6889549739386344871');" onmouseout="out('6889549739386344871');" style=""> 157         sExoMediaSourceInterceptListener = exoMediaSourceInterceptListener;                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158     }                                                                                                    </span>
<span  style=""> 159                                                                                                          </span>
<span class="-4818621628615420115" onmouseenter="enter('-4818621628615420115');" onmouseout="out('-4818621628615420115');" style=""> 160     public static void resetExoMediaSourceInterceptListener() {                                          </span>
<span class="-256584753286895392" onmouseenter="enter('-256584753286895392');" onmouseout="out('-256584753286895392');" style=""> 161         sExoMediaSourceInterceptListener = null;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style=""> 164     public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                 </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style=""> 165         return sExoMediaSourceInterceptListener;                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166     }                                                                                                    </span>
<span  style=""> 167                                                                                                          </span>
<span class="-1063844347616692784" onmouseenter="enter('-1063844347616692784');" onmouseout="out('-1063844347616692784');" style=""> 168     @SuppressLint(&quot;WrongConstant&quot;)                                                                       </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 169     @C.ContentType                                                                                       </span>
<span class="-4315877078803198285" onmouseenter="enter('-4315877078803198285');" onmouseout="out('-4315877078803198285');" style=""> 170     public static int inferContentType(@NonNull                                                          </span>
<span class="-4681450023014948314" onmouseenter="enter('-4681450023014948314');" onmouseout="out('-4681450023014948314');" style=""> 171     String fileName, @Nullable                                                                           </span>
<span class="-1444738599190350902" onmouseenter="enter('-1444738599190350902');" onmouseout="out('-1444738599190350902');" style=""> 172     String overrideExtension) {                                                                          </span>
<span class="-8972737784242637319" onmouseenter="enter('-8972737784242637319');" onmouseout="out('-8972737784242637319');" style=""> 173         fileName = fileName.toLowerCase(Locale.US);                                                      </span>
<span class="6865607915146658606" onmouseenter="enter('6865607915146658606');" onmouseout="out('6865607915146658606');" style=""> 174         if (fileName.startsWith(&quot;rtmp:&quot;)) {                                                              </span>
<span class="-2335515362235810488" onmouseenter="enter('-2335515362235810488');" onmouseout="out('-2335515362235810488');" style=""> 175             return TYPE_RTMP;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 176         } else {                                                                                         </span>
<span class="-4150133085136108549" onmouseenter="enter('-4150133085136108549');" onmouseout="out('-4150133085136108549');" style=""> 177             return inferContentType(Uri.parse(fileName), overrideExtension);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 181     @C.ContentType                                                                                       </span>
<span class="51086760664059912" onmouseenter="enter('51086760664059912');" onmouseout="out('51086760664059912');" style=""> 182     public static int inferContentType(Uri uri, @Nullable String overrideExtension) {                    </span>
<span class="8118578399735665553" onmouseenter="enter('8118578399735665553');" onmouseout="out('8118578399735665553');" style=""> 183         return Util.inferContentType(uri, overrideExtension);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 186     /**                                                                                                  </span>
<span class="-2918834671047387949" onmouseenter="enter('-2918834671047387949');" onmouseout="out('-2918834671047387949');" style=""> 187      * 本地缓存目录                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 188      */                                                                                                  </span>
<span class="8373741442571147480" onmouseenter="enter('8373741442571147480');" onmouseout="out('8373741442571147480');" style=""> 189     public static synchronized Cache getCacheSingleInstance(Context context, File cacheDir) {            </span>
<span class="5493858603497608540" onmouseenter="enter('5493858603497608540');" onmouseout="out('5493858603497608540');" style=""> 190         String dirs = context.getCacheDir().getAbsolutePath();                                           </span>
<span class="7445937115127050990" onmouseenter="enter('7445937115127050990');" onmouseout="out('7445937115127050990');" style=""> 191         if (cacheDir != null) {                                                                          </span>
<span class="4597761149181751399" onmouseenter="enter('4597761149181751399');" onmouseout="out('4597761149181751399');" style=""> 192             dirs = cacheDir.getAbsolutePath();                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193         }                                                                                                </span>
<span class="-5262494487137808971" onmouseenter="enter('-5262494487137808971');" onmouseout="out('-5262494487137808971');" style=""> 194         if (mCache == null) {                                                                            </span>
<span class="252040046092368917" onmouseenter="enter('252040046092368917');" onmouseout="out('252040046092368917');" style=""> 195             String path = (dirs + File.separator) + &quot;exo&quot;;                                               </span>
<span class="-1725211349640716689" onmouseenter="enter('-1725211349640716689');" onmouseout="out('-1725211349640716689');" style=""> 196             boolean isLocked = SimpleCache.isCacheFolderLocked(new File(path));                          </span>
<span class="-5993825009051200231" onmouseenter="enter('-5993825009051200231');" onmouseout="out('-5993825009051200231');" style=""> 197             if (!isLocked) {                                                                             </span>
<span class="-6256951664120801242" onmouseenter="enter('-6256951664120801242');" onmouseout="out('-6256951664120801242');" style=""><abbr title=" 198                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE), sDatabaseProvider);"> 198                 mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SI🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200         }                                                                                                </span>
<span class="2375441079046756829" onmouseenter="enter('2375441079046756829');" onmouseout="out('2375441079046756829');" style=""> 201         return mCache;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202     }                                                                                                    </span>
<span  style=""> 203                                                                                                          </span>
<span class="2702286103088736995" onmouseenter="enter('2702286103088736995');" onmouseout="out('2702286103088736995');" style=""> 204     public void release() {                                                                              </span>
<span class="-4077098582254622113" onmouseenter="enter('-4077098582254622113');" onmouseout="out('-4077098582254622113');" style=""> 205         isCached = false;                                                                                </span>
<span class="-6083569314997925846" onmouseenter="enter('-6083569314997925846');" onmouseout="out('-6083569314997925846');" style=""> 206         if (mCache != null) {                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 207             try {                                                                                        </span>
<span class="529169855077323853" onmouseenter="enter('529169855077323853');" onmouseout="out('529169855077323853');" style=""> 208                 mCache.release();                                                                        </span>
<span class="-5535969345357657316" onmouseenter="enter('-5535969345357657316');" onmouseout="out('-5535969345357657316');" style=""> 209                 mCache = null;                                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 210             } catch (Exception e) {                                                                      </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 211                 e.printStackTrace();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 216     /**                                                                                                  </span>
<span class="2545213195216124485" onmouseenter="enter('2545213195216124485');" onmouseout="out('2545213195216124485');" style=""> 217      * Cache需要release之后才能clear                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 218      */                                                                                                  </span>
<span class="6047086158735776789" onmouseenter="enter('6047086158735776789');" onmouseout="out('6047086158735776789');" style=""> 219     public static void clearCache(Context context, File cacheDir, String url) {                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 220         try {                                                                                            </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 221             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 222             if (!TextUtils.isEmpty(url)) {                                                               </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 223                 if (cache != null) {                                                                     </span>
<span class="-5650187598242283898" onmouseenter="enter('-5650187598242283898');" onmouseout="out('-5650187598242283898');" style=""> 224                     removeCache(cache, url);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225                 }                                                                                        </span>
<span class="-4608909050122532447" onmouseenter="enter('-4608909050122532447');" onmouseout="out('-4608909050122532447');" style=""> 226             } else if (cache != null) {                                                                  </span>
<span class="7961042807133489432" onmouseenter="enter('7961042807133489432');" onmouseout="out('7961042807133489432');" style=""> 227                 for (String key : cache.getKeys()) {                                                     </span>
<span class="-7152962664806820071" onmouseenter="enter('-7152962664806820071');" onmouseout="out('-7152962664806820071');" style=""> 228                     removeCache(cache, key);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230             }                                                                                            </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 231         } catch (java.lang.Exception e) {                                                                </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 232             e.printStackTrace();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234     }                                                                                                    </span>
<span  style=""> 235                                                                                                          </span>
<span class="167482028640019662" onmouseenter="enter('167482028640019662');" onmouseout="out('167482028640019662');" style=""> 236     public static void removeCache(Cache cache, String url) {                                            </span>
<span class="-1909055186960113209" onmouseenter="enter('-1909055186960113209');" onmouseout="out('-1909055186960113209');" style=""> 237         NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(buildCacheKey(url));                  </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 238         for (CacheSpan cachedSpan : cachedSpans) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 239             try {                                                                                        </span>
<span class="1961840987401424959" onmouseenter="enter('1961840987401424959');" onmouseout="out('1961840987401424959');" style=""> 240                 cache.removeSpan(cachedSpan);                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 241             } catch (Exception e) {                                                                      </span>
<span class="-4130810023601196090" onmouseenter="enter('-4130810023601196090');" onmouseout="out('-4130810023601196090');" style=""> 242                 // Do nothing.                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245     }                                                                                                    </span>
<span  style=""> 246                                                                                                          </span>
<span class="-8198521815859651674" onmouseenter="enter('-8198521815859651674');" onmouseout="out('-8198521815859651674');" style=""> 247     public static String buildCacheKey(String url) {                                                     </span>
<span class="3080452641973210712" onmouseenter="enter('3080452641973210712');" onmouseout="out('3080452641973210712');" style=""> 248         DataSpec dataSpec = new DataSpec(Uri.parse(url));                                                </span>
<span class="3397752349715137889" onmouseenter="enter('3397752349715137889');" onmouseout="out('3397752349715137889');" style=""> 249         return CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="-2359379937002163053" onmouseenter="enter('-2359379937002163053');" onmouseout="out('-2359379937002163053');" style=""> 252     public static boolean cachePreView(Context context, File cacheDir, String url) {                     </span>
<span class="6669724668123101030" onmouseenter="enter('6669724668123101030');" onmouseout="out('6669724668123101030');" style=""> 253         return resolveCacheState(getCacheSingleInstance(context, cacheDir), url);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254     }                                                                                                    </span>
<span  style=""> 255                                                                                                          </span>
<span class="4275422663013542480" onmouseenter="enter('4275422663013542480');" onmouseout="out('4275422663013542480');" style=""> 256     public boolean hadCached() {                                                                         </span>
<span class="3074888405336734299" onmouseenter="enter('3074888405336734299');" onmouseout="out('3074888405336734299');" style=""> 257         return isCached;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 260     /**                                                                                                  </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style=""> 261      * 忽律Https证书校验                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 262      *                                                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 263      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 264      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 265     @Deprecated                                                                                          </span>
<span class="2198318641674923085" onmouseenter="enter('2198318641674923085');" onmouseout="out('2198318641674923085');" style=""> 266     public static boolean isSkipSSLChain() {                                                             </span>
<span class="873024860049770122" onmouseenter="enter('873024860049770122');" onmouseout="out('873024860049770122');" style=""> 267         return sSkipSSLChain;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268     }                                                                                                    </span>
<span  style=""> 269                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 270     /**                                                                                                  </span>
<span class="2007360617581285918" onmouseenter="enter('2007360617581285918');" onmouseout="out('2007360617581285918');" style=""> 271      * 设置https忽略证书                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 272      *                                                                                                   </span>
<span class="-8071550217355649258" onmouseenter="enter('-8071550217355649258');" onmouseout="out('-8071550217355649258');" style=""> 273      * @param skipSSLChain true时是hulve                                                                   </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 274      * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 275      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 276     @Deprecated                                                                                          </span>
<span class="-1308991004088670996" onmouseenter="enter('-1308991004088670996');" onmouseout="out('-1308991004088670996');" style=""> 277     public static void setSkipSSLChain(boolean skipSSLChain) {                                           </span>
<span class="1121146022274574744" onmouseenter="enter('1121146022274574744');" onmouseout="out('1121146022274574744');" style=""> 278         sSkipSSLChain = skipSSLChain;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="2976239622278297742" onmouseenter="enter('2976239622278297742');" onmouseout="out('2976239622278297742');" style=""> 281     public static int getHttpReadTimeout() {                                                             </span>
<span class="5523542451485133181" onmouseenter="enter('5523542451485133181');" onmouseout="out('5523542451485133181');" style=""> 282         return sHttpReadTimeout;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 285     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 286      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 287      */                                                                                                  </span>
<span class="2919025488051579831" onmouseenter="enter('2919025488051579831');" onmouseout="out('2919025488051579831');" style=""> 288     public static void setHttpReadTimeout(int httpReadTimeout) {                                         </span>
<span class="-3997040606525716839" onmouseenter="enter('-3997040606525716839');" onmouseout="out('-3997040606525716839');" style=""> 289         ExoSourceManager.sHttpReadTimeout = httpReadTimeout;                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290     }                                                                                                    </span>
<span  style=""> 291                                                                                                          </span>
<span class="5450236011176178791" onmouseenter="enter('5450236011176178791');" onmouseout="out('5450236011176178791');" style=""> 292     public static int getHttpConnectTimeout() {                                                          </span>
<span class="1111499796559727252" onmouseenter="enter('1111499796559727252');" onmouseout="out('1111499796559727252');" style=""> 293         return sHttpConnectTimeout;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294     }                                                                                                    </span>
<span  style=""> 295                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 296     /**                                                                                                  </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 297      * 如果设置小于 0 就使用默认 8000 MILLIS                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 298      */                                                                                                  </span>
<span class="-7016684631510872274" onmouseenter="enter('-7016684631510872274');" onmouseout="out('-7016684631510872274');" style=""> 299     public static void setHttpConnectTimeout(int httpConnectTimeout) {                                   </span>
<span class="-2795264608914979197" onmouseenter="enter('-2795264608914979197');" onmouseout="out('-2795264608914979197');" style=""> 300         ExoSourceManager.sHttpConnectTimeout = httpConnectTimeout;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="-3420724575907019098" onmouseenter="enter('-3420724575907019098');" onmouseout="out('-3420724575907019098');" style=""> 303     public static DatabaseProvider getDatabaseProvider() {                                               </span>
<span class="-2185808013130137608" onmouseenter="enter('-2185808013130137608');" onmouseout="out('-2185808013130137608');" style=""> 304         return sDatabaseProvider;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305     }                                                                                                    </span>
<span  style=""> 306                                                                                                          </span>
<span class="-1193343422611666410" onmouseenter="enter('-1193343422611666410');" onmouseout="out('-1193343422611666410');" style=""> 307     public static void setDatabaseProvider(DatabaseProvider databaseProvider) {                          </span>
<span class="-7671573637861427354" onmouseenter="enter('-7671573637861427354');" onmouseout="out('-7671573637861427354');" style=""> 308         ExoSourceManager.sDatabaseProvider = databaseProvider;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309     }                                                                                                    </span>
<span  style=""> 310                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 311     /**                                                                                                  </span>
<span class="-1233347272602211288" onmouseenter="enter('-1233347272602211288');" onmouseout="out('-1233347272602211288');" style=""> 312      * 获取SourceFactory，是否带Cache                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 313      */                                                                                                  </span>
<span class="-8060849973918439601" onmouseenter="enter('-8060849973918439601');" onmouseout="out('-8060849973918439601');" style=""><abbr title=" 314     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, File cacheDir, String uerAgent) {"> 314     private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean pr🔵</abbr></span>
<span class="7825217223858997247" onmouseenter="enter('7825217223858997247');" onmouseout="out('7825217223858997247');" style=""> 315         if (cacheEnable) {                                                                               </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 316             Cache cache = getCacheSingleInstance(context, cacheDir);                                     </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 317             if (cache != null) {                                                                         </span>
<span class="9021007000539438017" onmouseenter="enter('9021007000539438017');" onmouseout="out('9021007000539438017');" style=""> 318                 isCached = resolveCacheState(cache, mDataSource);                                        </span>
<span class="-3761479699771438765" onmouseenter="enter('-3761479699771438765');" onmouseout="out('-3761479699771438765');" style=""> 319                 CacheDataSource.Factory factory = new CacheDataSource.Factory();                         </span>
<span class="-8093724037283287608" onmouseenter="enter('-8093724037283287608');" onmouseout="out('-8093724037283287608');" style=""> 320                 return factory.                                                                          </span>
<span class="-5074485159975905347" onmouseenter="enter('-5074485159975905347');" onmouseout="out('-5074485159975905347');" style=""><abbr title=" 321                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAgent)).setFlags(CacheDataSource.FLAG_IGNORE_CACHE_ON_ERROR);"> 321                         setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, previ🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323         }                                                                                                </span>
<span class="-1431913544698159813" onmouseenter="enter('-1431913544698159813');" onmouseout="out('-1431913544698159813');" style=""> 324         return getDataSourceFactory(context, preview, uerAgent);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325     }                                                                                                    </span>
<span  style=""> 326                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 327     /**                                                                                                  </span>
<span class="-283092449438347556" onmouseenter="enter('-283092449438347556');" onmouseout="out('-283092449438347556');" style=""> 328      * 获取SourceFactory                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 329      */                                                                                                  </span>
<span class="1834018894786004406" onmouseenter="enter('1834018894786004406');" onmouseout="out('1834018894786004406');" style=""> 330     private DataSource.Factory getDataSourceFactory(Context context, boolean preview, String uerAgent) { </span>
<span class="1829813597817317525" onmouseenter="enter('1829813597817317525');" onmouseout="out('1829813597817317525');" style=""><abbr title=" 331         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).build(),"> 331         return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(c🔵</abbr></span>
<span class="-4652974943362556447" onmouseenter="enter('-4652974943362556447');" onmouseout="out('-4652974943362556447');" style=""> 332                 getHttpDataSourceFactory(context, preview, uerAgent));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333     }                                                                                                    </span>
<span  style=""> 334                                                                                                          </span>
<span class="-879776573326484759" onmouseenter="enter('-879776573326484759');" onmouseout="out('-879776573326484759');" style=""><abbr title=" 335     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent) {"> 335     private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent🔵</abbr></span>
<span class="4493368850476432367" onmouseenter="enter('4493368850476432367');" onmouseout="out('4493368850476432367');" style=""> 336         if (uerAgent == null) {                                                                          </span>
<span class="-1748097148375756721" onmouseenter="enter('-1748097148375756721');" onmouseout="out('-1748097148375756721');" style=""> 337             uerAgent = Util.getUserAgent(context, TAG);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338         }                                                                                                </span>
<span class="-9065933110167474911" onmouseenter="enter('-9065933110167474911');" onmouseout="out('-9065933110167474911');" style=""> 339         int connectTimeout = DefaultHttpDataSource.DEFAULT_CONNECT_TIMEOUT_MILLIS;                       </span>
<span class="6449380685464591139" onmouseenter="enter('6449380685464591139');" onmouseout="out('6449380685464591139');" style=""> 340         int readTimeout = DefaultHttpDataSource.DEFAULT_READ_TIMEOUT_MILLIS;                             </span>
<span class="-1006385169289819833" onmouseenter="enter('-1006385169289819833');" onmouseout="out('-1006385169289819833');" style=""> 341         if (sHttpConnectTimeout &gt; 0) {                                                                   </span>
<span class="-1115887819057715189" onmouseenter="enter('-1115887819057715189');" onmouseout="out('-1115887819057715189');" style=""> 342             connectTimeout = sHttpConnectTimeout;                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343         }                                                                                                </span>
<span class="623482186481107038" onmouseenter="enter('623482186481107038');" onmouseout="out('623482186481107038');" style=""> 344         if (sHttpReadTimeout &gt; 0) {                                                                      </span>
<span class="3096862042682748327" onmouseenter="enter('3096862042682748327');" onmouseout="out('3096862042682748327');" style=""> 345             readTimeout = sHttpReadTimeout;                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346         }                                                                                                </span>
<span class="-1477830294864050779" onmouseenter="enter('-1477830294864050779');" onmouseout="out('-1477830294864050779');" style=""> 347         boolean allowCrossProtocolRedirects = false;                                                     </span>
<span class="-2570748491223477578" onmouseenter="enter('-2570748491223477578');" onmouseout="out('-2570748491223477578');" style=""> 348         if ((mMapHeadData != null) &amp;&amp; (mMapHeadData.size() &gt; 0)) {                                       </span>
<span class="-8838917078629499221" onmouseenter="enter('-8838917078629499221');" onmouseout="out('-8838917078629499221');" style=""> 349             allowCrossProtocolRedirects = &quot;true&quot;.equals(mMapHeadData.get(&quot;allowCrossProtocolRedirects&quot;));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 350         }                                                                                                </span>
<span class="3270687530488436452" onmouseenter="enter('3270687530488436452');" onmouseout="out('3270687530488436452');" style=""> 351         DataSource.Factory dataSourceFactory;                                                            </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 352         if (sExoMediaSourceInterceptListener != null) {                                                  </span>
<span class="-6284371282587068503" onmouseenter="enter('-6284371282587068503');" onmouseout="out('-6284371282587068503');" style=""><abbr title=" 353             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(), connectTimeout, readTimeout, mMapHeadData, allowCrossProtocolRedirects);"> 353             dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, previ🔵</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 354         } else {                                                                                         </span>
<span class="-5438469387773217817" onmouseenter="enter('-5438469387773217817');" onmouseout="out('-5438469387773217817');" style=""><abbr title=" 355             dataSourceFactory = new DefaultHttpDataSource.Factory().setAllowCrossProtocolRedirects(allowCrossProtocolRedirects).setConnectTimeoutMs(connectTimeout).setReadTimeoutMs(readTimeout).setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build());"> 355             dataSourceFactory = new DefaultHttpDataSource.Factory().setAllowCrossProtocolRedirects(allowC🔵</abbr></span>
<span class="-2570748491223477578" onmouseenter="enter('-2570748491223477578');" onmouseout="out('-2570748491223477578');" style=""> 356             if ((mMapHeadData != null) &amp;&amp; (mMapHeadData.size() &gt; 0)) {                                   </span>
<span class="-5121015179685549363" onmouseenter="enter('-5121015179685549363');" onmouseout="out('-5121015179685549363');" style=""><abbr title=" 357                 ((DefaultHttpDataSource.Factory) (dataSourceFactory)).setDefaultRequestProperties(mMapHeadData);"> 357                 ((DefaultHttpDataSource.Factory) (dataSourceFactory)).setDefaultRequestProperties(mMapHea🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359         }                                                                                                </span>
<span class="1723753173213071643" onmouseenter="enter('1723753173213071643');" onmouseout="out('1723753173213071643');" style=""> 360         return dataSourceFactory;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361     }                                                                                                    </span>
<span  style=""> 362                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 363     /**                                                                                                  </span>
<span class="-5059148079091929211" onmouseenter="enter('-5059148079091929211');" onmouseout="out('-5059148079091929211');" style=""> 364      * 根据缓存块判断是否缓存成功                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 365      */                                                                                                  </span>
<span class="-2204351825262319384" onmouseenter="enter('-2204351825262319384');" onmouseout="out('-2204351825262319384');" style=""> 366     private static boolean resolveCacheState(Cache cache, String url) {                                  </span>
<span class="124753744680968754" onmouseenter="enter('124753744680968754');" onmouseout="out('124753744680968754');" style=""> 367         boolean isCache = true;                                                                          </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 368         if (!TextUtils.isEmpty(url)) {                                                                   </span>
<span class="9175234064888605862" onmouseenter="enter('9175234064888605862');" onmouseout="out('9175234064888605862');" style=""> 369             String key = buildCacheKey(url);                                                             </span>
<span class="8462256178484181139" onmouseenter="enter('8462256178484181139');" onmouseout="out('8462256178484181139');" style=""> 370             if (!TextUtils.isEmpty(key)) {                                                               </span>
<span class="-8737585301747024644" onmouseenter="enter('-8737585301747024644');" onmouseout="out('-8737585301747024644');" style=""> 371                 NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(key);                         </span>
<span class="6104552210198839213" onmouseenter="enter('6104552210198839213');" onmouseout="out('6104552210198839213');" style=""> 372                 if (cachedSpans.size() == 0) {                                                           </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 373                     isCache = false;                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 374                 } else {                                                                                 </span>
<span class="122280032006644231" onmouseenter="enter('122280032006644231');" onmouseout="out('122280032006644231');" style=""><abbr title=" 375                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.LENGTH_UNSET);"> 375                     long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LE🔵</abbr></span>
<span class="2548419966105293269" onmouseenter="enter('2548419966105293269');" onmouseout="out('2548419966105293269');" style=""> 376                     long currentLength = 0;                                                              </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 377                     for (CacheSpan cachedSpan : cachedSpans) {                                           </span>
<span class="-228864752981275902" onmouseenter="enter('-228864752981275902');" onmouseout="out('-228864752981275902');" style=""><abbr title=" 378                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.length);"> 378                         currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.lengt🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379                     }                                                                                    </span>
<span class="-95640198430383414" onmouseenter="enter('-95640198430383414');" onmouseout="out('-95640198430383414');" style=""> 380                     isCache = currentLength &gt;= contentLength;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381                 }                                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 382             } else {                                                                                     </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 383                 isCache = false;                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385         }                                                                                                </span>
<span class="-4805343878943095560" onmouseenter="enter('-4805343878943095560');" onmouseout="out('-4805343878943095560');" style=""> 386         return isCache;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 387     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388 }                                                                                                        </span>
















































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-5503081748616462646" onmouseenter="enter('-5503081748616462646');" onmouseout="out('-5503081748616462646');" style="">   1  package tv.danmaku.ijk.media.exo2;                                                                                </span>
<span  style="">   2                                                                                                                    </span>
<span class="-3997288425915246049" onmouseenter="enter('-3997288425915246049');" onmouseout="out('-3997288425915246049');" style="">   3  import android.annotation.SuppressLint;                                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4  import android.content.Context;                                                                                   </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5  import android.net.Uri;                                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   6 -                                                                                                                  </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   7 +import android.text.TextUtils;                                                                                    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   8 +                                                                                                                  </span>
<span class="6963272077887521702" onmouseenter="enter('6963272077887521702');" onmouseout="out('6963272077887521702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">   9 +import androidx.annotation.NonNull;                                                                               </span>
<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">  10  import androidx.annotation.Nullable;                                                                              </span>
<span  style="">  11                                                                                                                    </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  12 -import android.text.TextUtils;                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  13 -                                                                                                                  </span>
<span class="1487611449423756792" onmouseenter="enter('1487611449423756792');" onmouseout="out('1487611449423756792');" style="">  14  import com.google.android.exoplayer2.C;                                                                           </span>
<span class="5545754444729343641" onmouseenter="enter('5545754444729343641');" onmouseout="out('5545754444729343641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  15 -import com.google.android.exoplayer2.Format;                                                                      </span>
<span class="867094050949454463" onmouseenter="enter('867094050949454463');" onmouseout="out('867094050949454463');" style="">  16  import com.google.android.exoplayer2.MediaItem;                                                                   </span>

<span class="-2844689653783287849" onmouseenter="enter('-2844689653783287849');" onmouseout="out('-2844689653783287849');" style="">  17  import com.google.android.exoplayer2.ext.rtmp.RtmpDataSourceFactory;                                              </span>
<span class="3675920877003625902" onmouseenter="enter('3675920877003625902');" onmouseout="out('3675920877003625902');" style="">  18  import com.google.android.exoplayer2.extractor.DefaultExtractorsFactory;                                          </span>
<span class="-7139094694606036211" onmouseenter="enter('-7139094694606036211');" onmouseout="out('-7139094694606036211');" style="">  19  import com.google.android.exoplayer2.source.LoopingMediaSource;                                                   </span>
<span class="-6167091960224777303" onmouseenter="enter('-6167091960224777303');" onmouseout="out('-6167091960224777303');" style="">  20  import com.google.android.exoplayer2.source.MediaSource;                                                          </span>
<span class="-3105544688913650545" onmouseenter="enter('-3105544688913650545');" onmouseout="out('-3105544688913650545');" style="">  21  import com.google.android.exoplayer2.source.ProgressiveMediaSource;                                               </span>
<span class="-4960919004069838122" onmouseenter="enter('-4960919004069838122');" onmouseout="out('-4960919004069838122');" style="">  22  import com.google.android.exoplayer2.source.dash.DashMediaSource;                                                 </span>
<span class="-4413409349911342092" onmouseenter="enter('-4413409349911342092');" onmouseout="out('-4413409349911342092');" style="">  23  import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;                                          </span>
<span class="392947657445256672" onmouseenter="enter('392947657445256672');" onmouseout="out('392947657445256672');" style="">  24  import com.google.android.exoplayer2.source.hls.HlsMediaSource;                                                   </span>
<span class="1080782699538105726" onmouseenter="enter('1080782699538105726');" onmouseout="out('1080782699538105726');" style="">  25  import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;                                 </span>
<span class="-8280776144719855835" onmouseenter="enter('-8280776144719855835');" onmouseout="out('-8280776144719855835');" style="">  26  import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;                                        </span>
<span class="-5025142600139113447" onmouseenter="enter('-5025142600139113447');" onmouseout="out('-5025142600139113447');" style="">  27  import com.google.android.exoplayer2.upstream.DataSource;                                                         </span>
<span class="-6054887794217826236" onmouseenter="enter('-6054887794217826236');" onmouseout="out('-6054887794217826236');" style="">  28  import com.google.android.exoplayer2.upstream.DataSpec;                                                           </span>
<span class="-1926464862603214616" onmouseenter="enter('-1926464862603214616');" onmouseout="out('-1926464862603214616');" style="">  29  import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;                                              </span>
<span class="7691807062585918827" onmouseenter="enter('7691807062585918827');" onmouseout="out('7691807062585918827');" style="">  30  import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;                                           </span>
<span class="8221609960337784667" onmouseenter="enter('8221609960337784667');" onmouseout="out('8221609960337784667');" style="">  31  import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;                                              </span>
<span class="4352946809774292357" onmouseenter="enter('4352946809774292357');" onmouseout="out('4352946809774292357');" style="">  32  import com.google.android.exoplayer2.upstream.DefaultHttpDataSourceFactory;                                       </span>
<span class="-9104345953255581198" onmouseenter="enter('-9104345953255581198');" onmouseout="out('-9104345953255581198');" style="">  33  import com.google.android.exoplayer2.upstream.HttpDataSource;                                                     </span>
<span class="3684976669809945769" onmouseenter="enter('3684976669809945769');" onmouseout="out('3684976669809945769');" style="">  34  import com.google.android.exoplayer2.upstream.RawResourceDataSource;                                              </span>
<span class="3791899211787747371" onmouseenter="enter('3791899211787747371');" onmouseout="out('3791899211787747371');" style="">  35  import com.google.android.exoplayer2.upstream.cache.Cache;                                                        </span>
<span class="-8148834636982163692" onmouseenter="enter('-8148834636982163692');" onmouseout="out('-8148834636982163692');" style="">  36  import com.google.android.exoplayer2.upstream.cache.CacheDataSource;                                              </span>
<span class="-8685955199172896893" onmouseenter="enter('-8685955199172896893');" onmouseout="out('-8685955199172896893');" style="">  37  import com.google.android.exoplayer2.upstream.cache.CacheKeyFactory;                                              </span>
<span class="-4601203435061269454" onmouseenter="enter('-4601203435061269454');" onmouseout="out('-4601203435061269454');" style="">  38  import com.google.android.exoplayer2.upstream.cache.CacheSpan;                                                    </span>
<span class="-8498858967217479983" onmouseenter="enter('-8498858967217479983');" onmouseout="out('-8498858967217479983');" style="">  39  import com.google.android.exoplayer2.upstream.cache.ContentMetadata;                                              </span>
<span class="-2820765455975363243" onmouseenter="enter('-2820765455975363243');" onmouseout="out('-2820765455975363243');" style="">  40  import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;                                </span>
<span class="-7748643470419441439" onmouseenter="enter('-7748643470419441439');" onmouseout="out('-7748643470419441439');" style="">  41  import com.google.android.exoplayer2.upstream.cache.SimpleCache;                                                  </span>
<span class="-1809507180972376256" onmouseenter="enter('-1809507180972376256');" onmouseout="out('-1809507180972376256');" style="">  42  import com.google.android.exoplayer2.util.Util;                                                                   </span>

<span  style="">  43                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  44  import java.io.File;                                                                                              </span>
<span class="-4563680703184802189" onmouseenter="enter('-4563680703184802189');" onmouseout="out('-4563680703184802189');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  45 +import java.util.Locale;                                                                                          </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  46  import java.util.Map;                                                                                             </span>
<span class="-5539540480142207555" onmouseenter="enter('-5539540480142207555');" onmouseout="out('-5539540480142207555');" style="">  47  import java.util.NavigableSet;                                                                                    </span>
<span  style="">  48                                                                                                                    </span>
<span  style="">  49                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  50  /**                                                                                                               </span>
<span class="-3817795341581382404" onmouseenter="enter('-3817795341581382404');" onmouseout="out('-3817795341581382404');" style="">  51   * Created by guoshuyu on 2018/5/18.                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  52   */                                                                                                               </span>
<span  style="">  53                                                                                                                    </span>
<span class="5978956340021809315" onmouseenter="enter('5978956340021809315');" onmouseout="out('5978956340021809315');" style="">  54  public class ExoSourceManager {                                                                                   </span>
<span  style="">  55                                                                                                                    </span>
<span class="2143614905519812283" onmouseenter="enter('2143614905519812283');" onmouseout="out('2143614905519812283');" style="">  56      private static final String TAG = &quot;ExoSourceManager&quot;;                                                         </span>
<span  style="">  57                                                                                                                    </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="">  58      private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                               </span>
<span  style="">  59                                                                                                                    </span>
<span class="2805559058863362301" onmouseenter="enter('2805559058863362301');" onmouseout="out('2805559058863362301');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -    public static final int TYPE_RTMP = 4;                                                                        </span>
<span class="-7434648719207555161" onmouseenter="enter('-7434648719207555161');" onmouseout="out('-7434648719207555161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +    public static final int TYPE_RTMP = 100;                                                                      </span>
<span  style="">  62                                                                                                                    </span>
<span class="2866779009294581851" onmouseenter="enter('2866779009294581851');" onmouseout="out('2866779009294581851');" style="">  63      private static Cache mCache;                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64      /**                                                                                                           </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style="">  65       * 忽律Https证书校验                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  66       *                                                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style="">  67       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  69      @Deprecated                                                                                                   </span>
<span class="6733722337026437480" onmouseenter="enter('6733722337026437480');" onmouseout="out('6733722337026437480');" style="">  70      private static boolean sSkipSSLChain = false;                                                                 </span>
<span  style="">  71                                                                                                                    </span>
<span class="-8322579848361947255" onmouseenter="enter('-8322579848361947255');" onmouseout="out('-8322579848361947255');" style="">  72      private static int sHttpReadTimeout = -1;                                                                     </span>
<span  style="">  73                                                                                                                    </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="">  74      private static int sHttpConnectTimeout = -1;                                                                  </span>
<span  style="">  75                                                                                                                    </span>
<span  style="">  76                                                                                                                    </span>
<span class="-1940276823349157224" onmouseenter="enter('-1940276823349157224');" onmouseout="out('-1940276823349157224');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -    private static boolean s = false;                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -                                                                                                                  </span>
<span class="-2042973733649017522" onmouseenter="enter('-2042973733649017522');" onmouseout="out('-2042973733649017522');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -    private Context mAppContext;                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -                                                                                                                  </span>
<span class="-2341385085944071006" onmouseenter="enter('-2341385085944071006');" onmouseout="out('-2341385085944071006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -    private Map&lt;String, String&gt; mMapHeadData;                                                                     </span>
<span class="2978752276401696079" onmouseenter="enter('2978752276401696079');" onmouseout="out('2978752276401696079');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +    private static final boolean s = false;                                                                       </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +                                                                                                                  </span>
<span class="7019408237288028740" onmouseenter="enter('7019408237288028740');" onmouseout="out('7019408237288028740');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +    private final Context mAppContext;                                                                            </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +                                                                                                                  </span>
<span class="-4374222225418050568" onmouseenter="enter('-4374222225418050568');" onmouseout="out('-4374222225418050568');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +    private final Map&lt;String, String&gt; mMapHeadData;                                                               </span>
<span  style="">  87                                                                                                                    </span>
<span class="2720391937428942309" onmouseenter="enter('2720391937428942309');" onmouseout="out('2720391937428942309');" style="">  88      private String mDataSource;                                                                                   </span>
<span  style="">  89                                                                                                                    </span>
<span class="898136537903361042" onmouseenter="enter('898136537903361042');" onmouseout="out('898136537903361042');" style="">  90      private static ExoMediaSourceInterceptListener sExoMediaSourceInterceptListener;                              </span>

<span  style="">  91                                                                                                                    </span>
<span class="-2905075036207193429" onmouseenter="enter('-2905075036207193429');" onmouseout="out('-2905075036207193429');" style="">  92      private boolean isCached = false;                                                                             </span>
<span  style="">  93                                                                                                                    </span>
<span class="-3397611666931429980" onmouseenter="enter('-3397611666931429980');" onmouseout="out('-3397611666931429980');" style="">  94      public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData) {      </span>
<span class="-6448993279383120903" onmouseenter="enter('-6448993279383120903');" onmouseout="out('-6448993279383120903');" style="">  95          return new ExoSourceManager(context, mapHeadData);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="-2557713181218471643" onmouseenter="enter('-2557713181218471643');" onmouseout="out('-2557713181218471643');" style="">  98      private ExoSourceManager(Context context, Map&lt;String, String&gt; mapHeadData) {                                  </span>
<span class="7302624818817228010" onmouseenter="enter('7302624818817228010');" onmouseout="out('7302624818817228010');" style="">  99          mAppContext = context.getApplicationContext();                                                            </span>
<span class="3872213483840267174" onmouseenter="enter('3872213483840267174');" onmouseout="out('3872213483840267174');" style=""> 100          mMapHeadData = mapHeadData;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101      }                                                                                                             </span>
<span  style=""> 102                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 103      /**                                                                                                           </span>
<span class="-8955960166298079068" onmouseenter="enter('-8955960166298079068');" onmouseout="out('-8955960166298079068');" style=""> 104       * @param dataSource  链接                                                                                      </span>
<span class="-8878537572148364092" onmouseenter="enter('-8878537572148364092');" onmouseout="out('-8878537572148364092');" style=""> 105       * @param preview     是否带上header，默认有header自动设置为true                                                           </span>
<span class="86969417606586940" onmouseenter="enter('86969417606586940');" onmouseout="out('86969417606586940');" style=""> 106       * @param cacheEnable 是否需要缓存                                                                                  </span>
<span class="-966782913438754" onmouseenter="enter('-966782913438754');" onmouseout="out('-966782913438754');" style=""> 107       * @param isLooping   是否循环                                                                                    </span>
<span class="3920492570930179262" onmouseenter="enter('3920492570930179262');" onmouseout="out('3920492570930179262');" style=""> 108       * @param cacheDir    自定义缓存目录                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 109       */                                                                                                           </span>
<span class="-5248766375747874279" onmouseenter="enter('-5248766375747874279');" onmouseout="out('-5248766375747874279');" style=""><abbr title=" 110      public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, File cacheDir, @Nullable String overrideExtension) {"> 110      public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, 🔵</abbr></span>
<span class="-8115162023017778502" onmouseenter="enter('-8115162023017778502');" onmouseout="out('-8115162023017778502');" style=""> 111          MediaSource mediaSource = null;                                                                           </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 112          if (sExoMediaSourceInterceptListener != null) {                                                           </span>
<span class="1460304608887237329" onmouseenter="enter('1460304608887237329');" onmouseout="out('1460304608887237329');" style=""><abbr title=" 113              mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLooping, cacheDir);"> 113              mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLoop🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114          }                                                                                                         </span>
<span class="-6444727352463407138" onmouseenter="enter('-6444727352463407138');" onmouseout="out('-6444727352463407138');" style=""> 115          if (mediaSource != null) {                                                                                </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 116              return mediaSource;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117          }                                                                                                         </span>
<span class="-143711945711027689" onmouseenter="enter('-143711945711027689');" onmouseout="out('-143711945711027689');" style=""> 118          mDataSource = dataSource;                                                                                 </span>
<span class="4324385998490320101" onmouseenter="enter('4324385998490320101');" onmouseout="out('4324385998490320101');" style=""> 119          Uri contentUri = Uri.parse(dataSource);                                                                   </span>
<span class="1133761916200375127" onmouseenter="enter('1133761916200375127');" onmouseout="out('1133761916200375127');" style=""> 120          MediaItem mediaItem = MediaItem.fromUri(contentUri);                                                      </span>
<span class="-999163251238408129" onmouseenter="enter('-999163251238408129');" onmouseout="out('-999163251238408129');" style=""> 121          int contentType = inferContentType(dataSource, overrideExtension);                                        </span>
<span  style=""> 122                                                                                                                    </span>
<span class="-3913681325976844847" onmouseenter="enter('-3913681325976844847');" onmouseout="out('-3913681325976844847');" style=""> 123          String uerAgent = null;                                                                                   </span>
<span class="-7096342993828865452" onmouseenter="enter('-7096342993828865452');" onmouseout="out('-7096342993828865452');" style=""> 124          if (mMapHeadData != null) {                                                                               </span>
<span class="-2322630379955906840" onmouseenter="enter('-2322630379955906840');" onmouseout="out('-2322630379955906840');" style=""> 125              uerAgent = mMapHeadData.get(&quot;User-Agent&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126          }                                                                                                         </span>
<span class="-8719898405424144062" onmouseenter="enter('-8719898405424144062');" onmouseout="out('-8719898405424144062');" style=""> 127          if (&quot;android.resource&quot;.equals(contentUri.getScheme())) {                                                  </span>
<span class="8727359621133688309" onmouseenter="enter('8727359621133688309');" onmouseout="out('8727359621133688309');" style=""> 128              DataSpec dataSpec = new DataSpec(contentUri);                                                         </span>
<span class="4481052292773557445" onmouseenter="enter('4481052292773557445');" onmouseout="out('4481052292773557445');" style=""> 129              final RawResourceDataSource rawResourceDataSource = new RawResourceDataSource(mAppContext);           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 130              try {                                                                                                 </span>
<span class="2726278993395089263" onmouseenter="enter('2726278993395089263');" onmouseout="out('2726278993395089263');" style=""> 131                  rawResourceDataSource.open(dataSpec);                                                             </span>
<span class="-4974591032746021510" onmouseenter="enter('-4974591032746021510');" onmouseout="out('-4974591032746021510');" style=""> 132              } catch (RawResourceDataSource.RawResourceDataSourceException e) {                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 133                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134              }                                                                                                     </span>
<span class="-1372997540993869402" onmouseenter="enter('-1372997540993869402');" onmouseout="out('-1372997540993869402');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -            DataSource.Factory factory = new DataSource.Factory() {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -                @Override                                                                                         </span>
<span class="6014436885970126822" onmouseenter="enter('6014436885970126822');" onmouseout="out('6014436885970126822');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -                public DataSource createDataSource() {                                                            </span>
<span class="2172287862623123157" onmouseenter="enter('2172287862623123157');" onmouseout="out('2172287862623123157');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -                    return rawResourceDataSource;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -                }                                                                                                 </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -            };                                                                                                    </span>
<span class="7704964188260260407" onmouseenter="enter('7704964188260260407');" onmouseout="out('7704964188260260407');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +            DataSource.Factory factory = () -&gt; rawResourceDataSource;                                             </span>
<span class="-8858487266224522333" onmouseenter="enter('-8858487266224522333');" onmouseout="out('-8858487266224522333');" style=""> 142              return new ProgressiveMediaSource.Factory(                                                            </span>
<span class="-5546760697718138686" onmouseenter="enter('-5546760697718138686');" onmouseout="out('-5546760697718138686');" style=""> 143                      factory).createMediaSource(mediaItem);                                                        </span>
<span  style=""> 144                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 145          }                                                                                                         </span>
<span  style=""> 146                                                                                                                    </span>
<span class="2154133365005964027" onmouseenter="enter('2154133365005964027');" onmouseout="out('2154133365005964027');" style=""> 147          switch (contentType) {                                                                                    </span>
<span class="1440548643499835250" onmouseenter="enter('1440548643499835250');" onmouseout="out('1440548643499835250');" style=""> 148              case C.TYPE_SS:                                                                                       </span>
<span class="6042799697120325248" onmouseenter="enter('6042799697120325248');" onmouseout="out('6042799697120325248');" style=""> 149                  mediaSource = new SsMediaSource.Factory(                                                          </span>
<span class="-5358541595256219402" onmouseenter="enter('-5358541595256219402');" onmouseout="out('-5358541595256219402');" style=""><abbr title=" 150                          new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 150                          new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, previ🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 151                          new DefaultDataSourceFactory(mAppContext, null,                                           </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 152                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 152                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(media🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 153                  break;                                                                                            </span>
<span class="-3000250717744089757" onmouseenter="enter('-3000250717744089757');" onmouseout="out('-3000250717744089757');" style=""> 154              case C.TYPE_DASH:                                                                                     </span>
<span class="7863200340161482433" onmouseenter="enter('7863200340161482433');" onmouseout="out('7863200340161482433');" style=""><abbr title=" 155                  mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 155                  mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryC🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 156                          new DefaultDataSourceFactory(mAppContext, null,                                           </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 157                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 157                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(media🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 158                  break;                                                                                            </span>
<span class="-1208187129867902777" onmouseenter="enter('-1208187129867902777');" onmouseout="out('-1208187129867902777');" style=""> 159              case C.TYPE_HLS:                                                                                      </span>
<span class="-8404544135870355940" onmouseenter="enter('-8404544135870355940');" onmouseout="out('-8404544135870355940');" style=""><abbr title=" 160                  mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent))"> 160                  mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, previ🔵</abbr></span>
<span class="7648135411500465639" onmouseenter="enter('7648135411500465639');" onmouseout="out('7648135411500465639');" style=""> 161                          .setAllowChunklessPreparation(true)                                                       </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 162                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 163                  break;                                                                                            </span>
<span class="8699527861425038714" onmouseenter="enter('8699527861425038714');" onmouseout="out('8699527861425038714');" style=""> 164              case TYPE_RTMP:                                                                                       </span>
<span class="-652703182204257991" onmouseenter="enter('-652703182204257991');" onmouseout="out('-652703182204257991');" style=""> 165                  RtmpDataSourceFactory rtmpDataSourceFactory = new RtmpDataSourceFactory(null);                    </span>
<span class="-4274032462282112427" onmouseenter="enter('-4274032462282112427');" onmouseout="out('-4274032462282112427');" style=""> 166                  mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory,                           </span>
<span class="44950493304430817" onmouseenter="enter('44950493304430817');" onmouseout="out('44950493304430817');" style=""> 167                          new DefaultExtractorsFactory())                                                           </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 168                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 169                  break;                                                                                            </span>
<span class="-6101660085664083502" onmouseenter="enter('-6101660085664083502');" onmouseout="out('-6101660085664083502');" style=""> 170              case C.TYPE_OTHER:                                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 171              default:                                                                                              </span>
<span class="2057287837755864137" onmouseenter="enter('2057287837755864137');" onmouseout="out('2057287837755864137');" style=""><abbr title=" 172                  mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable,"> 172                  mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnabl🔵</abbr></span>
<span class="-1940406333279134193" onmouseenter="enter('-1940406333279134193');" onmouseout="out('-1940406333279134193');" style=""> 173                          preview, cacheDir, uerAgent), new DefaultExtractorsFactory())                             </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 174                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 175                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span class="-6437128767689830906" onmouseenter="enter('-6437128767689830906');" onmouseout="out('-6437128767689830906');" style=""> 177          if (isLooping) {                                                                                          </span>
<span class="4960838216480500998" onmouseenter="enter('4960838216480500998');" onmouseout="out('4960838216480500998');" style=""> 178              return new LoopingMediaSource(mediaSource);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 180          return mediaSource;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span  style=""> 183                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 184      /**                                                                                                           </span>
<span class="268464750667491347" onmouseenter="enter('268464750667491347');" onmouseout="out('268464750667491347');" style=""> 185       * 设置ExoPlayer 的 MediaSource 创建拦截                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 186       */                                                                                                           </span>
<span class="-3220193549345070784" onmouseenter="enter('-3220193549345070784');" onmouseout="out('-3220193549345070784');" style=""><abbr title=" 187      public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptListener) {"> 187      public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptL🔵</abbr></span>
<span class="6889549739386344871" onmouseenter="enter('6889549739386344871');" onmouseout="out('6889549739386344871');" style=""> 188          sExoMediaSourceInterceptListener = exoMediaSourceInterceptListener;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189      }                                                                                                             </span>
<span  style=""> 190                                                                                                                    </span>
<span class="-4818621628615420115" onmouseenter="enter('-4818621628615420115');" onmouseout="out('-4818621628615420115');" style=""> 191      public static void resetExoMediaSourceInterceptListener() {                                                   </span>
<span class="-256584753286895392" onmouseenter="enter('-256584753286895392');" onmouseout="out('-256584753286895392');" style=""> 192          sExoMediaSourceInterceptListener = null;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style=""> 195      public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                          </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style=""> 196          return sExoMediaSourceInterceptListener;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197      }                                                                                                             </span>
<span  style=""> 198                                                                                                                    </span>
<span  style=""> 199                                                                                                                    </span>
<span class="-1063844347616692784" onmouseenter="enter('-1063844347616692784');" onmouseout="out('-1063844347616692784');" style=""> 200      @SuppressLint(&quot;WrongConstant&quot;)                                                                                </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 201      @C.ContentType                                                                                                </span>
<span class="-8571548472546648501" onmouseenter="enter('-8571548472546648501');" onmouseout="out('-8571548472546648501');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -    public static int inferContentType(String fileName, @Nullable String overrideExtension) {                     </span>
<span class="-392879567198634870" onmouseenter="enter('-392879567198634870');" onmouseout="out('-392879567198634870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -        fileName = Util.toLowerInvariant(fileName);                                                               </span>
<span class="-1063986311404684031" onmouseenter="enter('-1063986311404684031');" onmouseout="out('-1063986311404684031');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 204 +    public static int inferContentType(@NonNull String fileName, @Nullable String overrideExtension) {            </span>
<span class="-8972737784242637319" onmouseenter="enter('-8972737784242637319');" onmouseout="out('-8972737784242637319');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 205 +        fileName = fileName.toLowerCase(Locale.US);                                                               </span>
<span class="6865607915146658606" onmouseenter="enter('6865607915146658606');" onmouseout="out('6865607915146658606');" style=""> 206          if (fileName.startsWith(&quot;rtmp:&quot;)) {                                                                       </span>
<span class="-2335515362235810488" onmouseenter="enter('-2335515362235810488');" onmouseout="out('-2335515362235810488');" style=""> 207              return TYPE_RTMP;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 208          } else {                                                                                                  </span>
<span class="-4150133085136108549" onmouseenter="enter('-4150133085136108549');" onmouseout="out('-4150133085136108549');" style=""> 209              return inferContentType(Uri.parse(fileName), overrideExtension);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211      }                                                                                                             </span>
<span  style=""> 212                                                                                                                    </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 213      @C.ContentType                                                                                                </span>
<span class="51086760664059912" onmouseenter="enter('51086760664059912');" onmouseout="out('51086760664059912');" style=""> 214      public static int inferContentType(Uri uri, @Nullable String overrideExtension) {                             </span>
<span class="8118578399735665553" onmouseenter="enter('8118578399735665553');" onmouseout="out('8118578399735665553');" style=""> 215          return Util.inferContentType(uri, overrideExtension);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216      }                                                                                                             </span>
<span  style=""> 217                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 218      /**                                                                                                           </span>
<span class="-2918834671047387949" onmouseenter="enter('-2918834671047387949');" onmouseout="out('-2918834671047387949');" style=""> 219       * 本地缓存目录                                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 220       */                                                                                                           </span>
<span class="8373741442571147480" onmouseenter="enter('8373741442571147480');" onmouseout="out('8373741442571147480');" style=""> 221      public static synchronized Cache getCacheSingleInstance(Context context, File cacheDir) {                     </span>
<span class="5493858603497608540" onmouseenter="enter('5493858603497608540');" onmouseout="out('5493858603497608540');" style=""> 222          String dirs = context.getCacheDir().getAbsolutePath();                                                    </span>
<span class="7445937115127050990" onmouseenter="enter('7445937115127050990');" onmouseout="out('7445937115127050990');" style=""> 223          if (cacheDir != null) {                                                                                   </span>
<span class="4597761149181751399" onmouseenter="enter('4597761149181751399');" onmouseout="out('4597761149181751399');" style=""> 224              dirs = cacheDir.getAbsolutePath();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225          }                                                                                                         </span>
<span class="-5262494487137808971" onmouseenter="enter('-5262494487137808971');" onmouseout="out('-5262494487137808971');" style=""> 226          if (mCache == null) {                                                                                     </span>
<span class="-8514817442366527959" onmouseenter="enter('-8514817442366527959');" onmouseout="out('-8514817442366527959');" style=""> 227              String path = dirs + File.separator + &quot;exo&quot;;                                                          </span>
<span class="-1725211349640716689" onmouseenter="enter('-1725211349640716689');" onmouseout="out('-1725211349640716689');" style=""> 228              boolean isLocked = SimpleCache.isCacheFolderLocked(new File(path));                                   </span>
<span class="-5993825009051200231" onmouseenter="enter('-5993825009051200231');" onmouseout="out('-5993825009051200231');" style=""> 229              if (!isLocked) {                                                                                      </span>
<span class="-703744863139117980" onmouseenter="enter('-703744863139117980');" onmouseout="out('-703744863139117980');" style=""> 230                  mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE));    </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232          }                                                                                                         </span>
<span class="2375441079046756829" onmouseenter="enter('2375441079046756829');" onmouseout="out('2375441079046756829');" style=""> 233          return mCache;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234      }                                                                                                             </span>
<span  style=""> 235                                                                                                                    </span>
<span class="2702286103088736995" onmouseenter="enter('2702286103088736995');" onmouseout="out('2702286103088736995');" style=""> 236      public void release() {                                                                                       </span>
<span class="-4077098582254622113" onmouseenter="enter('-4077098582254622113');" onmouseout="out('-4077098582254622113');" style=""> 237          isCached = false;                                                                                         </span>
<span class="-6083569314997925846" onmouseenter="enter('-6083569314997925846');" onmouseout="out('-6083569314997925846');" style=""> 238          if (mCache != null) {                                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 239              try {                                                                                                 </span>
<span class="529169855077323853" onmouseenter="enter('529169855077323853');" onmouseout="out('529169855077323853');" style=""> 240                  mCache.release();                                                                                 </span>
<span class="-5535969345357657316" onmouseenter="enter('-5535969345357657316');" onmouseout="out('-5535969345357657316');" style=""> 241                  mCache = null;                                                                                    </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 242              } catch (Exception e) {                                                                               </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 243                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 245          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246      }                                                                                                             </span>
<span  style=""> 247                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 248      /**                                                                                                           </span>
<span class="2545213195216124485" onmouseenter="enter('2545213195216124485');" onmouseout="out('2545213195216124485');" style=""> 249       * Cache需要release之后才能clear                                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -     *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -     * @param context                                                                                             </span>
<span class="3209897607463931648" onmouseenter="enter('3209897607463931648');" onmouseout="out('3209897607463931648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -     * @param cacheDir                                                                                            </span>
<span class="6502316225866244393" onmouseenter="enter('6502316225866244393');" onmouseout="out('6502316225866244393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -     * @param url                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 254       */                                                                                                           </span>
<span class="6047086158735776789" onmouseenter="enter('6047086158735776789');" onmouseout="out('6047086158735776789');" style=""> 255      public static void clearCache(Context context, File cacheDir, String url) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 256          try {                                                                                                     </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 257              Cache cache = getCacheSingleInstance(context, cacheDir);                                              </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 258              if (!TextUtils.isEmpty(url)) {                                                                        </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 259                  if (cache != null) {                                                                              </span>
<span class="-5650187598242283898" onmouseenter="enter('-5650187598242283898');" onmouseout="out('-5650187598242283898');" style=""> 260                      removeCache(cache, url);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262              } else {                                                                                              </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 263                  if (cache != null) {                                                                              </span>
<span class="7961042807133489432" onmouseenter="enter('7961042807133489432');" onmouseout="out('7961042807133489432');" style=""> 264                      for (String key : cache.getKeys()) {                                                          </span>
<span class="-7152962664806820071" onmouseenter="enter('-7152962664806820071');" onmouseout="out('-7152962664806820071');" style=""> 265                          removeCache(cache, key);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268              }                                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 269          } catch (Exception e) {                                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 270              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span  style=""> 274                                                                                                                    </span>
<span class="167482028640019662" onmouseenter="enter('167482028640019662');" onmouseout="out('167482028640019662');" style=""> 275      public static void removeCache(Cache cache, String url) {                                                     </span>
<span class="-1909055186960113209" onmouseenter="enter('-1909055186960113209');" onmouseout="out('-1909055186960113209');" style=""> 276          NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(buildCacheKey(url));                           </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 277          for (CacheSpan cachedSpan : cachedSpans) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 278              try {                                                                                                 </span>
<span class="1961840987401424959" onmouseenter="enter('1961840987401424959');" onmouseout="out('1961840987401424959');" style=""> 279                  cache.removeSpan(cachedSpan);                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 280              } catch (Exception e) {                                                                               </span>
<span class="-4130810023601196090" onmouseenter="enter('-4130810023601196090');" onmouseout="out('-4130810023601196090');" style=""> 281                  // Do nothing.                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 282              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284      }                                                                                                             </span>
<span  style=""> 285                                                                                                                    </span>
<span class="-8198521815859651674" onmouseenter="enter('-8198521815859651674');" onmouseout="out('-8198521815859651674');" style=""> 286      public static String buildCacheKey(String url) {                                                              </span>
<span class="3080452641973210712" onmouseenter="enter('3080452641973210712');" onmouseout="out('3080452641973210712');" style=""> 287          DataSpec dataSpec = new DataSpec(Uri.parse(url));                                                         </span>
<span class="3026971444796471896" onmouseenter="enter('3026971444796471896');" onmouseout="out('3026971444796471896');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -        String key = CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                             </span>
<span class="5738733750165622395" onmouseenter="enter('5738733750165622395');" onmouseout="out('5738733750165622395');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -        return key;                                                                                               </span>
<span class="3397752349715137889" onmouseenter="enter('3397752349715137889');" onmouseout="out('3397752349715137889');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 290 +        return CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291      }                                                                                                             </span>
<span  style=""> 292                                                                                                                    </span>
<span class="-2359379937002163053" onmouseenter="enter('-2359379937002163053');" onmouseout="out('-2359379937002163053');" style=""> 293      public static boolean cachePreView(Context context, File cacheDir, String url) {                              </span>
<span class="6669724668123101030" onmouseenter="enter('6669724668123101030');" onmouseout="out('6669724668123101030');" style=""> 294          return resolveCacheState(getCacheSingleInstance(context, cacheDir), url);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295      }                                                                                                             </span>
<span  style=""> 296                                                                                                                    </span>
<span class="4275422663013542480" onmouseenter="enter('4275422663013542480');" onmouseout="out('4275422663013542480');" style=""> 297      public boolean hadCached() {                                                                                  </span>
<span class="3074888405336734299" onmouseenter="enter('3074888405336734299');" onmouseout="out('3074888405336734299');" style=""> 298          return isCached;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299      }                                                                                                             </span>
<span  style=""> 300                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 301      /**                                                                                                           </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style=""> 302       * 忽律Https证书校验                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 303       *                                                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 304       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 305       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 306      @Deprecated                                                                                                   </span>
<span class="2198318641674923085" onmouseenter="enter('2198318641674923085');" onmouseout="out('2198318641674923085');" style=""> 307      public static boolean isSkipSSLChain() {                                                                      </span>
<span class="873024860049770122" onmouseenter="enter('873024860049770122');" onmouseout="out('873024860049770122');" style=""> 308          return sSkipSSLChain;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309      }                                                                                                             </span>
<span  style=""> 310                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 311      /**                                                                                                           </span>
<span class="2007360617581285918" onmouseenter="enter('2007360617581285918');" onmouseout="out('2007360617581285918');" style=""> 312       * 设置https忽略证书                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 313       *                                                                                                            </span>
<span class="-8071550217355649258" onmouseenter="enter('-8071550217355649258');" onmouseout="out('-8071550217355649258');" style=""> 314       * @param skipSSLChain true时是hulve                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 315       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 316       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 317      @Deprecated                                                                                                   </span>
<span class="-1308991004088670996" onmouseenter="enter('-1308991004088670996');" onmouseout="out('-1308991004088670996');" style=""> 318      public static void setSkipSSLChain(boolean skipSSLChain) {                                                    </span>
<span class="1121146022274574744" onmouseenter="enter('1121146022274574744');" onmouseout="out('1121146022274574744');" style=""> 319          sSkipSSLChain = skipSSLChain;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320      }                                                                                                             </span>
<span  style=""> 321                                                                                                                    </span>
<span  style=""> 322                                                                                                                    </span>
<span class="2976239622278297742" onmouseenter="enter('2976239622278297742');" onmouseout="out('2976239622278297742');" style=""> 323      public static int getHttpReadTimeout() {                                                                      </span>
<span class="5523542451485133181" onmouseenter="enter('5523542451485133181');" onmouseout="out('5523542451485133181');" style=""> 324          return sHttpReadTimeout;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325      }                                                                                                             </span>
<span  style=""> 326                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 327      /**                                                                                                           </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 328       * 如果设置小于 0 就使用默认 8000 MILLIS                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 329       */                                                                                                           </span>
<span class="2919025488051579831" onmouseenter="enter('2919025488051579831');" onmouseout="out('2919025488051579831');" style=""> 330      public static void setHttpReadTimeout(int httpReadTimeout) {                                                  </span>
<span class="-3997040606525716839" onmouseenter="enter('-3997040606525716839');" onmouseout="out('-3997040606525716839');" style=""> 331          ExoSourceManager.sHttpReadTimeout = httpReadTimeout;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="5450236011176178791" onmouseenter="enter('5450236011176178791');" onmouseout="out('5450236011176178791');" style=""> 334      public static int getHttpConnectTimeout() {                                                                   </span>
<span class="1111499796559727252" onmouseenter="enter('1111499796559727252');" onmouseout="out('1111499796559727252');" style=""> 335          return sHttpConnectTimeout;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336      }                                                                                                             </span>
<span  style=""> 337                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 338      /**                                                                                                           </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 339       * 如果设置小于 0 就使用默认 8000 MILLIS                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 340       */                                                                                                           </span>
<span class="-7016684631510872274" onmouseenter="enter('-7016684631510872274');" onmouseout="out('-7016684631510872274');" style=""> 341      public static void setHttpConnectTimeout(int httpConnectTimeout) {                                            </span>
<span class="-2795264608914979197" onmouseenter="enter('-2795264608914979197');" onmouseout="out('-2795264608914979197');" style=""> 342          ExoSourceManager.sHttpConnectTimeout = httpConnectTimeout;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343      }                                                                                                             </span>
<span  style=""> 344                                                                                                                    </span>








<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 345      /**                                                                                                           </span>
<span class="-1233347272602211288" onmouseenter="enter('-1233347272602211288');" onmouseout="out('-1233347272602211288');" style=""> 346       * 获取SourceFactory，是否带Cache                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 347       */                                                                                                           </span>
<span class="-8060849973918439601" onmouseenter="enter('-8060849973918439601');" onmouseout="out('-8060849973918439601');" style=""><abbr title=" 348      private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, File cacheDir, String uerAgent) {"> 348      private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, Fi🔵</abbr></span>
<span class="7825217223858997247" onmouseenter="enter('7825217223858997247');" onmouseout="out('7825217223858997247');" style=""> 349          if (cacheEnable) {                                                                                        </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 350              Cache cache = getCacheSingleInstance(context, cacheDir);                                              </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 351              if (cache != null) {                                                                                  </span>
<span class="9021007000539438017" onmouseenter="enter('9021007000539438017');" onmouseout="out('9021007000539438017');" style=""> 352                  isCached = resolveCacheState(cache, mDataSource);                                                 </span>
<span class="-3761479699771438765" onmouseenter="enter('-3761479699771438765');" onmouseout="out('-3761479699771438765');" style=""> 353                  CacheDataSource.Factory factory = new CacheDataSource.Factory();                                  </span>
<span class="-8093724037283287608" onmouseenter="enter('-8093724037283287608');" onmouseout="out('-8093724037283287608');" style=""> 354                  return factory.                                                                                   </span>
<span class="-5074485159975905347" onmouseenter="enter('-5074485159975905347');" onmouseout="out('-5074485159975905347');" style=""><abbr title=" 355                          setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAgent)).setFlags(CacheDataSource.FLAG_IGNORE_CACHE_ON_ERROR);"> 355                          setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAg🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357          }                                                                                                         </span>
<span class="-1431913544698159813" onmouseenter="enter('-1431913544698159813');" onmouseout="out('-1431913544698159813');" style=""> 358          return getDataSourceFactory(context, preview, uerAgent);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359      }                                                                                                             </span>
<span  style=""> 360                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 361      /**                                                                                                           </span>
<span class="-283092449438347556" onmouseenter="enter('-283092449438347556');" onmouseout="out('-283092449438347556');" style=""> 362       * 获取SourceFactory                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 363       */                                                                                                           </span>
<span class="1834018894786004406" onmouseenter="enter('1834018894786004406');" onmouseout="out('1834018894786004406');" style=""> 364      private DataSource.Factory getDataSourceFactory(Context context, boolean preview, String uerAgent) {          </span>
<span class="1829813597817317525" onmouseenter="enter('1829813597817317525');" onmouseout="out('1829813597817317525');" style=""><abbr title=" 365          return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).build(),"> 365          return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).b🔵</abbr></span>
<span class="-4652974943362556447" onmouseenter="enter('-4652974943362556447');" onmouseout="out('-4652974943362556447');" style=""> 366                  getHttpDataSourceFactory(context, preview, uerAgent));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367      }                                                                                                             </span>
<span  style=""> 368                                                                                                                    </span>
<span class="-879776573326484759" onmouseenter="enter('-879776573326484759');" onmouseout="out('-879776573326484759');" style=""> 369      private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent) {      </span>
<span class="4493368850476432367" onmouseenter="enter('4493368850476432367');" onmouseout="out('4493368850476432367');" style=""> 370          if (uerAgent == null) {                                                                                   </span>
<span class="-1748097148375756721" onmouseenter="enter('-1748097148375756721');" onmouseout="out('-1748097148375756721');" style=""> 371              uerAgent = Util.getUserAgent(context, TAG);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372          }                                                                                                         </span>
<span class="-9065933110167474911" onmouseenter="enter('-9065933110167474911');" onmouseout="out('-9065933110167474911');" style=""> 373          int connectTimeout = DefaultHttpDataSource.DEFAULT_CONNECT_TIMEOUT_MILLIS;                                </span>
<span class="6449380685464591139" onmouseenter="enter('6449380685464591139');" onmouseout="out('6449380685464591139');" style=""> 374          int readTimeout = DefaultHttpDataSource.DEFAULT_READ_TIMEOUT_MILLIS;                                      </span>
<span class="-1006385169289819833" onmouseenter="enter('-1006385169289819833');" onmouseout="out('-1006385169289819833');" style=""> 375          if (sHttpConnectTimeout &gt; 0) {                                                                            </span>
<span class="-1115887819057715189" onmouseenter="enter('-1115887819057715189');" onmouseout="out('-1115887819057715189');" style=""> 376              connectTimeout = sHttpConnectTimeout;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377          }                                                                                                         </span>
<span class="623482186481107038" onmouseenter="enter('623482186481107038');" onmouseout="out('623482186481107038');" style=""> 378          if (sHttpReadTimeout &gt; 0) {                                                                               </span>
<span class="3096862042682748327" onmouseenter="enter('3096862042682748327');" onmouseout="out('3096862042682748327');" style=""> 379              readTimeout = sHttpReadTimeout;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380          }                                                                                                         </span>
<span class="-1477830294864050779" onmouseenter="enter('-1477830294864050779');" onmouseout="out('-1477830294864050779');" style=""> 381          boolean allowCrossProtocolRedirects = false;                                                              </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 382          if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                                    </span>
<span class="-8838917078629499221" onmouseenter="enter('-8838917078629499221');" onmouseout="out('-8838917078629499221');" style=""> 383              allowCrossProtocolRedirects = &quot;true&quot;.equals(mMapHeadData.get(&quot;allowCrossProtocolRedirects&quot;));         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384          }                                                                                                         </span>
<span class="3221029067501196489" onmouseenter="enter('3221029067501196489');" onmouseout="out('3221029067501196489');" style=""> 385          HttpDataSource.BaseFactory dataSourceFactory;                                                             </span>

<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 386          if (sExoMediaSourceInterceptListener != null) {                                                           </span>
<span class="2091451277126898709" onmouseenter="enter('2091451277126898709');" onmouseout="out('2091451277126898709');" style=""><abbr title=" 387              dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 387              dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style=""> 388                      connectTimeout,                                                                               </span>
<span class="-5101637653190280170" onmouseenter="enter('-5101637653190280170');" onmouseout="out('-5101637653190280170');" style=""> 389                      readTimeout, allowCrossProtocolRedirects);                                                    </span>

<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 390          } else {                                                                                                  </span>
<span class="8166862827820244898" onmouseenter="enter('8166862827820244898');" onmouseout="out('8166862827820244898');" style=""><abbr title=" 391              dataSourceFactory = new DefaultHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 391              dataSourceFactory = new DefaultHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMe🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style=""> 392                      connectTimeout,                                                                               </span>
<span class="-5101637653190280170" onmouseenter="enter('-5101637653190280170');" onmouseout="out('-5101637653190280170');" style=""> 393                      readTimeout, allowCrossProtocolRedirects);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394          }                                                                                                         </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 395          if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                                    </span>
<span class="2616194727311752071" onmouseenter="enter('2616194727311752071');" onmouseout="out('2616194727311752071');" style=""> 396              for (Map.Entry&lt;String, String&gt; header : mMapHeadData.entrySet()) {                                    </span>
<span class="-6694194845723559940" onmouseenter="enter('-6694194845723559940');" onmouseout="out('-6694194845723559940');" style=""> 397                  dataSourceFactory.getDefaultRequestProperties().set(header.getKey(), header.getValue());          </span>







<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399          }                                                                                                         </span>
<span class="1723753173213071643" onmouseenter="enter('1723753173213071643');" onmouseout="out('1723753173213071643');" style=""> 400          return dataSourceFactory;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401      }                                                                                                             </span>
<span  style=""> 402                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 403      /**                                                                                                           </span>
<span class="-5059148079091929211" onmouseenter="enter('-5059148079091929211');" onmouseout="out('-5059148079091929211');" style=""> 404       * 根据缓存块判断是否缓存成功                                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 405 -     *                                                                                                            </span>
<span class="1237233419561726312" onmouseenter="enter('1237233419561726312');" onmouseout="out('1237233419561726312');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 406 -     * @param cache                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 407       */                                                                                                           </span>
<span class="-2204351825262319384" onmouseenter="enter('-2204351825262319384');" onmouseout="out('-2204351825262319384');" style=""> 408      private static boolean resolveCacheState(Cache cache, String url) {                                           </span>
<span class="124753744680968754" onmouseenter="enter('124753744680968754');" onmouseout="out('124753744680968754');" style=""> 409          boolean isCache = true;                                                                                   </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 410          if (!TextUtils.isEmpty(url)) {                                                                            </span>
<span class="9175234064888605862" onmouseenter="enter('9175234064888605862');" onmouseout="out('9175234064888605862');" style=""> 411              String key = buildCacheKey(url);                                                                      </span>
<span class="8462256178484181139" onmouseenter="enter('8462256178484181139');" onmouseout="out('8462256178484181139');" style=""> 412              if (!TextUtils.isEmpty(key)) {                                                                        </span>
<span class="-8737585301747024644" onmouseenter="enter('-8737585301747024644');" onmouseout="out('-8737585301747024644');" style=""> 413                  NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(key);                                  </span>
<span class="6104552210198839213" onmouseenter="enter('6104552210198839213');" onmouseout="out('6104552210198839213');" style=""> 414                  if (cachedSpans.size() == 0) {                                                                    </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 415                      isCache = false;                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 416                  } else {                                                                                          </span>
<span class="122280032006644231" onmouseenter="enter('122280032006644231');" onmouseout="out('122280032006644231');" style=""><abbr title=" 417                      long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.LENGTH_UNSET);"> 417                      long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.L🔵</abbr></span>
<span class="2548419966105293269" onmouseenter="enter('2548419966105293269');" onmouseout="out('2548419966105293269');" style=""> 418                      long currentLength = 0;                                                                       </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 419                      for (CacheSpan cachedSpan : cachedSpans) {                                                    </span>
<span class="-228864752981275902" onmouseenter="enter('-228864752981275902');" onmouseout="out('-228864752981275902');" style=""> 420                          currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.length);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421                      }                                                                                             </span>
<span class="-95640198430383414" onmouseenter="enter('-95640198430383414');" onmouseout="out('-95640198430383414');" style=""> 422                      isCache = currentLength &gt;= contentLength;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 424              } else {                                                                                              </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 425                  isCache = false;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427          }                                                                                                         </span>
<span class="-4805343878943095560" onmouseenter="enter('-4805343878943095560');" onmouseout="out('-4805343878943095560');" style=""> 428          return isCache;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="-5503081748616462646" onmouseenter="enter('-5503081748616462646');" onmouseout="out('-5503081748616462646');" style="">   1  package tv.danmaku.ijk.media.exo2;                                                                                </span>
<span  style="">   2                                                                                                                    </span>
<span class="-3997288425915246049" onmouseenter="enter('-3997288425915246049');" onmouseout="out('-3997288425915246049');" style="">   3  import android.annotation.SuppressLint;                                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">   4  import android.content.Context;                                                                                   </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">   5  import android.net.Uri;                                                                                           </span>
<span  style="">   6                                                                                                                    </span>



<span class="-6436154409168942626" onmouseenter="enter('-6436154409168942626');" onmouseout="out('-6436154409168942626');" style="">   7  import androidx.annotation.Nullable;                                                                              </span>
<span  style="">   8                                                                                                                    </span>
<span class="3727887607099278716" onmouseenter="enter('3727887607099278716');" onmouseout="out('3727887607099278716');" style="">   9  import android.text.TextUtils;                                                                                    </span>
<span  style="">  10                                                                                                                    </span>
<span class="1487611449423756792" onmouseenter="enter('1487611449423756792');" onmouseout="out('1487611449423756792');" style="">  11  import com.google.android.exoplayer2.C;                                                                           </span>
<span class="5545754444729343641" onmouseenter="enter('5545754444729343641');" onmouseout="out('5545754444729343641');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  12 -import com.google.android.exoplayer2.Format;                                                                      </span>
<span class="867094050949454463" onmouseenter="enter('867094050949454463');" onmouseout="out('867094050949454463');" style="">  13  import com.google.android.exoplayer2.MediaItem;                                                                   </span>
<span class="-3172072599128556050" onmouseenter="enter('-3172072599128556050');" onmouseout="out('-3172072599128556050');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  14 +import com.google.android.exoplayer2.database.DatabaseProvider;                                                   </span>
<span class="-2844689653783287849" onmouseenter="enter('-2844689653783287849');" onmouseout="out('-2844689653783287849');" style="">  15  import com.google.android.exoplayer2.ext.rtmp.RtmpDataSourceFactory;                                              </span>
<span class="3675920877003625902" onmouseenter="enter('3675920877003625902');" onmouseout="out('3675920877003625902');" style="">  16  import com.google.android.exoplayer2.extractor.DefaultExtractorsFactory;                                          </span>
<span class="-7139094694606036211" onmouseenter="enter('-7139094694606036211');" onmouseout="out('-7139094694606036211');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  17 -import com.google.android.exoplayer2.source.LoopingMediaSource;                                                   </span>
<span class="-6167091960224777303" onmouseenter="enter('-6167091960224777303');" onmouseout="out('-6167091960224777303');" style="">  18  import com.google.android.exoplayer2.source.MediaSource;                                                          </span>
<span class="-3105544688913650545" onmouseenter="enter('-3105544688913650545');" onmouseout="out('-3105544688913650545');" style="">  19  import com.google.android.exoplayer2.source.ProgressiveMediaSource;                                               </span>
<span class="-4960919004069838122" onmouseenter="enter('-4960919004069838122');" onmouseout="out('-4960919004069838122');" style="">  20  import com.google.android.exoplayer2.source.dash.DashMediaSource;                                                 </span>
<span class="-4413409349911342092" onmouseenter="enter('-4413409349911342092');" onmouseout="out('-4413409349911342092');" style="">  21  import com.google.android.exoplayer2.source.dash.DefaultDashChunkSource;                                          </span>
<span class="392947657445256672" onmouseenter="enter('392947657445256672');" onmouseout="out('392947657445256672');" style="">  22  import com.google.android.exoplayer2.source.hls.HlsMediaSource;                                                   </span>
<span class="1080782699538105726" onmouseenter="enter('1080782699538105726');" onmouseout="out('1080782699538105726');" style="">  23  import com.google.android.exoplayer2.source.smoothstreaming.DefaultSsChunkSource;                                 </span>
<span class="-8280776144719855835" onmouseenter="enter('-8280776144719855835');" onmouseout="out('-8280776144719855835');" style="">  24  import com.google.android.exoplayer2.source.smoothstreaming.SsMediaSource;                                        </span>
<span class="-5025142600139113447" onmouseenter="enter('-5025142600139113447');" onmouseout="out('-5025142600139113447');" style="">  25  import com.google.android.exoplayer2.upstream.DataSource;                                                         </span>
<span class="-6054887794217826236" onmouseenter="enter('-6054887794217826236');" onmouseout="out('-6054887794217826236');" style="">  26  import com.google.android.exoplayer2.upstream.DataSpec;                                                           </span>
<span class="-1926464862603214616" onmouseenter="enter('-1926464862603214616');" onmouseout="out('-1926464862603214616');" style="">  27  import com.google.android.exoplayer2.upstream.DefaultBandwidthMeter;                                              </span>
<span class="7691807062585918827" onmouseenter="enter('7691807062585918827');" onmouseout="out('7691807062585918827');" style="">  28  import com.google.android.exoplayer2.upstream.DefaultDataSourceFactory;                                           </span>
<span class="8221609960337784667" onmouseenter="enter('8221609960337784667');" onmouseout="out('8221609960337784667');" style="">  29  import com.google.android.exoplayer2.upstream.DefaultHttpDataSource;                                              </span>
<span class="4352946809774292357" onmouseenter="enter('4352946809774292357');" onmouseout="out('4352946809774292357');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import com.google.android.exoplayer2.upstream.DefaultHttpDataSourceFactory;                                       </span>
<span class="-9104345953255581198" onmouseenter="enter('-9104345953255581198');" onmouseout="out('-9104345953255581198');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import com.google.android.exoplayer2.upstream.HttpDataSource;                                                     </span>
<span class="3684976669809945769" onmouseenter="enter('3684976669809945769');" onmouseout="out('3684976669809945769');" style="">  32  import com.google.android.exoplayer2.upstream.RawResourceDataSource;                                              </span>
<span class="3791899211787747371" onmouseenter="enter('3791899211787747371');" onmouseout="out('3791899211787747371');" style="">  33  import com.google.android.exoplayer2.upstream.cache.Cache;                                                        </span>
<span class="-8148834636982163692" onmouseenter="enter('-8148834636982163692');" onmouseout="out('-8148834636982163692');" style="">  34  import com.google.android.exoplayer2.upstream.cache.CacheDataSource;                                              </span>
<span class="-8685955199172896893" onmouseenter="enter('-8685955199172896893');" onmouseout="out('-8685955199172896893');" style="">  35  import com.google.android.exoplayer2.upstream.cache.CacheKeyFactory;                                              </span>
<span class="-4601203435061269454" onmouseenter="enter('-4601203435061269454');" onmouseout="out('-4601203435061269454');" style="">  36  import com.google.android.exoplayer2.upstream.cache.CacheSpan;                                                    </span>
<span class="-8498858967217479983" onmouseenter="enter('-8498858967217479983');" onmouseout="out('-8498858967217479983');" style="">  37  import com.google.android.exoplayer2.upstream.cache.ContentMetadata;                                              </span>
<span class="-2820765455975363243" onmouseenter="enter('-2820765455975363243');" onmouseout="out('-2820765455975363243');" style="">  38  import com.google.android.exoplayer2.upstream.cache.LeastRecentlyUsedCacheEvictor;                                </span>
<span class="-7748643470419441439" onmouseenter="enter('-7748643470419441439');" onmouseout="out('-7748643470419441439');" style="">  39  import com.google.android.exoplayer2.upstream.cache.SimpleCache;                                                  </span>
<span class="-1809507180972376256" onmouseenter="enter('-1809507180972376256');" onmouseout="out('-1809507180972376256');" style="">  40  import com.google.android.exoplayer2.util.Util;                                                                   </span>
<span class="-5152250604397781057" onmouseenter="enter('-5152250604397781057');" onmouseout="out('-5152250604397781057');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +import com.google.common.base.Ascii;                                                                              </span>
<span  style="">  42                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  43  import java.io.File;                                                                                              </span>

<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  44  import java.util.Map;                                                                                             </span>
<span class="-5539540480142207555" onmouseenter="enter('-5539540480142207555');" onmouseout="out('-5539540480142207555');" style="">  45  import java.util.NavigableSet;                                                                                    </span>
<span  style="">  46                                                                                                                    </span>
<span  style="">  47                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  48  /**                                                                                                               </span>
<span class="-3817795341581382404" onmouseenter="enter('-3817795341581382404');" onmouseout="out('-3817795341581382404');" style="">  49   * Created by guoshuyu on 2018/5/18.                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50   */                                                                                                               </span>
<span  style="">  51                                                                                                                    </span>
<span class="5978956340021809315" onmouseenter="enter('5978956340021809315');" onmouseout="out('5978956340021809315');" style="">  52  public class ExoSourceManager {                                                                                   </span>
<span  style="">  53                                                                                                                    </span>
<span class="2143614905519812283" onmouseenter="enter('2143614905519812283');" onmouseout="out('2143614905519812283');" style="">  54      private static final String TAG = &quot;ExoSourceManager&quot;;                                                         </span>
<span  style="">  55                                                                                                                    </span>
<span class="-8235560656483603794" onmouseenter="enter('-8235560656483603794');" onmouseout="out('-8235560656483603794');" style="">  56      private static final long DEFAULT_MAX_SIZE = 512 * 1024 * 1024;                                               </span>
<span  style="">  57                                                                                                                    </span>
<span class="2805559058863362301" onmouseenter="enter('2805559058863362301');" onmouseout="out('2805559058863362301');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -    public static final int TYPE_RTMP = 4;                                                                        </span>
<span class="4060007595904198083" onmouseenter="enter('4060007595904198083');" onmouseout="out('4060007595904198083');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +    public static final int TYPE_RTMP = 14;                                                                       </span>
<span  style="">  60                                                                                                                    </span>
<span class="2866779009294581851" onmouseenter="enter('2866779009294581851');" onmouseout="out('2866779009294581851');" style="">  61      private static Cache mCache;                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62      /**                                                                                                           </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style="">  63       * 忽律Https证书校验                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  64       *                                                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style="">  65       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="">  67      @Deprecated                                                                                                   </span>
<span class="6733722337026437480" onmouseenter="enter('6733722337026437480');" onmouseout="out('6733722337026437480');" style="">  68      private static boolean sSkipSSLChain = false;                                                                 </span>
<span  style="">  69                                                                                                                    </span>
<span class="-8322579848361947255" onmouseenter="enter('-8322579848361947255');" onmouseout="out('-8322579848361947255');" style="">  70      private static int sHttpReadTimeout = -1;                                                                     </span>
<span  style="">  71                                                                                                                    </span>
<span class="-7656130485523399493" onmouseenter="enter('-7656130485523399493');" onmouseout="out('-7656130485523399493');" style="">  72      private static int sHttpConnectTimeout = -1;                                                                  </span>
<span  style="">  73                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -                                                                                                                  </span>
<span class="-1940276823349157224" onmouseenter="enter('-1940276823349157224');" onmouseout="out('-1940276823349157224');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -    private static boolean s = false;                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -                                                                                                                  </span>
<span class="-2042973733649017522" onmouseenter="enter('-2042973733649017522');" onmouseout="out('-2042973733649017522');" style="">  77      private Context mAppContext;                                                                                  </span>
<span  style="">  78                                                                                                                    </span>
<span class="-2341385085944071006" onmouseenter="enter('-2341385085944071006');" onmouseout="out('-2341385085944071006');" style="">  79      private Map&lt;String, String&gt; mMapHeadData;                                                                     </span>





<span  style="">  80                                                                                                                    </span>
<span class="2720391937428942309" onmouseenter="enter('2720391937428942309');" onmouseout="out('2720391937428942309');" style="">  81      private String mDataSource;                                                                                   </span>
<span  style="">  82                                                                                                                    </span>
<span class="898136537903361042" onmouseenter="enter('898136537903361042');" onmouseout="out('898136537903361042');" style="">  83      private static ExoMediaSourceInterceptListener sExoMediaSourceInterceptListener;                              </span>
<span class="8633327969830562634" onmouseenter="enter('8633327969830562634');" onmouseout="out('8633327969830562634');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +    private static DatabaseProvider sDatabaseProvider;                                                            </span>
<span  style="">  85                                                                                                                    </span>
<span class="-2905075036207193429" onmouseenter="enter('-2905075036207193429');" onmouseout="out('-2905075036207193429');" style="">  86      private boolean isCached = false;                                                                             </span>
<span  style="">  87                                                                                                                    </span>
<span class="-3397611666931429980" onmouseenter="enter('-3397611666931429980');" onmouseout="out('-3397611666931429980');" style="">  88      public static ExoSourceManager newInstance(Context context, @Nullable Map&lt;String, String&gt; mapHeadData) {      </span>
<span class="-6448993279383120903" onmouseenter="enter('-6448993279383120903');" onmouseout="out('-6448993279383120903');" style="">  89          return new ExoSourceManager(context, mapHeadData);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="-2557713181218471643" onmouseenter="enter('-2557713181218471643');" onmouseout="out('-2557713181218471643');" style="">  92      private ExoSourceManager(Context context, Map&lt;String, String&gt; mapHeadData) {                                  </span>
<span class="7302624818817228010" onmouseenter="enter('7302624818817228010');" onmouseout="out('7302624818817228010');" style="">  93          mAppContext = context.getApplicationContext();                                                            </span>
<span class="3872213483840267174" onmouseenter="enter('3872213483840267174');" onmouseout="out('3872213483840267174');" style="">  94          mMapHeadData = mapHeadData;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95      }                                                                                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  97      /**                                                                                                           </span>
<span class="-8955960166298079068" onmouseenter="enter('-8955960166298079068');" onmouseout="out('-8955960166298079068');" style="">  98       * @param dataSource  链接                                                                                      </span>
<span class="-8878537572148364092" onmouseenter="enter('-8878537572148364092');" onmouseout="out('-8878537572148364092');" style="">  99       * @param preview     是否带上header，默认有header自动设置为true                                                           </span>
<span class="86969417606586940" onmouseenter="enter('86969417606586940');" onmouseout="out('86969417606586940');" style=""> 100       * @param cacheEnable 是否需要缓存                                                                                  </span>
<span class="-966782913438754" onmouseenter="enter('-966782913438754');" onmouseout="out('-966782913438754');" style=""> 101       * @param isLooping   是否循环                                                                                    </span>
<span class="3920492570930179262" onmouseenter="enter('3920492570930179262');" onmouseout="out('3920492570930179262');" style=""> 102       * @param cacheDir    自定义缓存目录                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 103       */                                                                                                           </span>
<span class="-5248766375747874279" onmouseenter="enter('-5248766375747874279');" onmouseout="out('-5248766375747874279');" style=""><abbr title=" 104      public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, File cacheDir, @Nullable String overrideExtension) {"> 104      public MediaSource getMediaSource(String dataSource, boolean preview, boolean cacheEnable, boolean isLooping, 🔵</abbr></span>
<span class="-8115162023017778502" onmouseenter="enter('-8115162023017778502');" onmouseout="out('-8115162023017778502');" style=""> 105          MediaSource mediaSource = null;                                                                           </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 106          if (sExoMediaSourceInterceptListener != null) {                                                           </span>
<span class="1460304608887237329" onmouseenter="enter('1460304608887237329');" onmouseout="out('1460304608887237329');" style=""><abbr title=" 107              mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLooping, cacheDir);"> 107              mediaSource = sExoMediaSourceInterceptListener.getMediaSource(dataSource, preview, cacheEnable, isLoop🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108          }                                                                                                         </span>
<span class="-6444727352463407138" onmouseenter="enter('-6444727352463407138');" onmouseout="out('-6444727352463407138');" style=""> 109          if (mediaSource != null) {                                                                                </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 110              return mediaSource;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111          }                                                                                                         </span>
<span class="-143711945711027689" onmouseenter="enter('-143711945711027689');" onmouseout="out('-143711945711027689');" style=""> 112          mDataSource = dataSource;                                                                                 </span>
<span class="4324385998490320101" onmouseenter="enter('4324385998490320101');" onmouseout="out('4324385998490320101');" style=""> 113          Uri contentUri = Uri.parse(dataSource);                                                                   </span>
<span class="1133761916200375127" onmouseenter="enter('1133761916200375127');" onmouseout="out('1133761916200375127');" style=""> 114          MediaItem mediaItem = MediaItem.fromUri(contentUri);                                                      </span>
<span class="-999163251238408129" onmouseenter="enter('-999163251238408129');" onmouseout="out('-999163251238408129');" style=""> 115          int contentType = inferContentType(dataSource, overrideExtension);                                        </span>
<span  style=""> 116                                                                                                                    </span>
<span class="-3913681325976844847" onmouseenter="enter('-3913681325976844847');" onmouseout="out('-3913681325976844847');" style=""> 117          String uerAgent = null;                                                                                   </span>
<span class="-7096342993828865452" onmouseenter="enter('-7096342993828865452');" onmouseout="out('-7096342993828865452');" style=""> 118          if (mMapHeadData != null) {                                                                               </span>
<span class="-2322630379955906840" onmouseenter="enter('-2322630379955906840');" onmouseout="out('-2322630379955906840');" style=""> 119              uerAgent = mMapHeadData.get(&quot;User-Agent&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 120          }                                                                                                         </span>
<span class="-8719898405424144062" onmouseenter="enter('-8719898405424144062');" onmouseout="out('-8719898405424144062');" style=""> 121          if (&quot;android.resource&quot;.equals(contentUri.getScheme())) {                                                  </span>
<span class="8727359621133688309" onmouseenter="enter('8727359621133688309');" onmouseout="out('8727359621133688309');" style=""> 122              DataSpec dataSpec = new DataSpec(contentUri);                                                         </span>
<span class="4481052292773557445" onmouseenter="enter('4481052292773557445');" onmouseout="out('4481052292773557445');" style=""> 123              final RawResourceDataSource rawResourceDataSource = new RawResourceDataSource(mAppContext);           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 124              try {                                                                                                 </span>
<span class="2726278993395089263" onmouseenter="enter('2726278993395089263');" onmouseout="out('2726278993395089263');" style=""> 125                  rawResourceDataSource.open(dataSpec);                                                             </span>
<span class="-4974591032746021510" onmouseenter="enter('-4974591032746021510');" onmouseout="out('-4974591032746021510');" style=""> 126              } catch (RawResourceDataSource.RawResourceDataSourceException e) {                                    </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 127                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128              }                                                                                                     </span>
<span class="-1372997540993869402" onmouseenter="enter('-1372997540993869402');" onmouseout="out('-1372997540993869402');" style=""> 129              DataSource.Factory factory = new DataSource.Factory() {                                               </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 130                  @Override                                                                                         </span>
<span class="6014436885970126822" onmouseenter="enter('6014436885970126822');" onmouseout="out('6014436885970126822');" style=""> 131                  public DataSource createDataSource() {                                                            </span>
<span class="2172287862623123157" onmouseenter="enter('2172287862623123157');" onmouseout="out('2172287862623123157');" style=""> 132                      return rawResourceDataSource;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133                  }                                                                                                 </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 134              };                                                                                                    </span>

<span class="-8858487266224522333" onmouseenter="enter('-8858487266224522333');" onmouseout="out('-8858487266224522333');" style=""> 135              return new ProgressiveMediaSource.Factory(                                                            </span>
<span class="-5546760697718138686" onmouseenter="enter('-5546760697718138686');" onmouseout="out('-5546760697718138686');" style=""> 136                      factory).createMediaSource(mediaItem);                                                        </span>
<span  style=""> 137                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138          }                                                                                                         </span>
<span  style=""> 139                                                                                                                    </span>
<span class="2154133365005964027" onmouseenter="enter('2154133365005964027');" onmouseout="out('2154133365005964027');" style=""> 140          switch (contentType) {                                                                                    </span>
<span class="1440548643499835250" onmouseenter="enter('1440548643499835250');" onmouseout="out('1440548643499835250');" style=""> 141              case C.TYPE_SS:                                                                                       </span>
<span class="6042799697120325248" onmouseenter="enter('6042799697120325248');" onmouseout="out('6042799697120325248');" style=""> 142                  mediaSource = new SsMediaSource.Factory(                                                          </span>
<span class="-5358541595256219402" onmouseenter="enter('-5358541595256219402');" onmouseout="out('-5358541595256219402');" style=""><abbr title=" 143                          new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 143                          new DefaultSsChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, previ🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 144                          new DefaultDataSourceFactory(mAppContext, null,                                           </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 145                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 145                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(media🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 146                  break;                                                                                            </span>
<span class="-3000250717744089757" onmouseenter="enter('-3000250717744089757');" onmouseout="out('-3000250717744089757');" style=""> 147              case C.TYPE_DASH:                                                                                     </span>
<span class="7863200340161482433" onmouseenter="enter('7863200340161482433');" onmouseout="out('7863200340161482433');" style=""><abbr title=" 148                  mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent)),"> 148                  mediaSource = new DashMediaSource.Factory(new DefaultDashChunkSource.Factory(getDataSourceFactoryC🔵</abbr></span>
<span class="4889340019639093455" onmouseenter="enter('4889340019639093455');" onmouseout="out('4889340019639093455');" style=""> 149                          new DefaultDataSourceFactory(mAppContext, null,                                           </span>
<span class="-1355297202761877683" onmouseenter="enter('-1355297202761877683');" onmouseout="out('-1355297202761877683');" style=""><abbr title=" 150                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(mediaItem);"> 150                                  getHttpDataSourceFactory(mAppContext, preview, uerAgent))).createMediaSource(media🔵</abbr></span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 151                  break;                                                                                            </span>
<span class="-1208187129867902777" onmouseenter="enter('-1208187129867902777');" onmouseout="out('-1208187129867902777');" style=""> 152              case C.TYPE_HLS:                                                                                      </span>
<span class="-8404544135870355940" onmouseenter="enter('-8404544135870355940');" onmouseout="out('-8404544135870355940');" style=""><abbr title=" 153                  mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, preview, cacheDir, uerAgent))"> 153                  mediaSource = new HlsMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable, previ🔵</abbr></span>
<span class="7648135411500465639" onmouseenter="enter('7648135411500465639');" onmouseout="out('7648135411500465639');" style=""> 154                          .setAllowChunklessPreparation(true)                                                       </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 155                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 156                  break;                                                                                            </span>
<span class="8699527861425038714" onmouseenter="enter('8699527861425038714');" onmouseout="out('8699527861425038714');" style=""> 157              case TYPE_RTMP:                                                                                       </span>
<span class="-652703182204257991" onmouseenter="enter('-652703182204257991');" onmouseout="out('-652703182204257991');" style=""> 158                  RtmpDataSourceFactory rtmpDataSourceFactory = new RtmpDataSourceFactory(null);                    </span>
<span class="-4274032462282112427" onmouseenter="enter('-4274032462282112427');" onmouseout="out('-4274032462282112427');" style=""> 159                  mediaSource = new ProgressiveMediaSource.Factory(rtmpDataSourceFactory,                           </span>
<span class="44950493304430817" onmouseenter="enter('44950493304430817');" onmouseout="out('44950493304430817');" style=""> 160                          new DefaultExtractorsFactory())                                                           </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 161                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 162                  break;                                                                                            </span>
<span class="-6101660085664083502" onmouseenter="enter('-6101660085664083502');" onmouseout="out('-6101660085664083502');" style=""> 163              case C.TYPE_OTHER:                                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 164              default:                                                                                              </span>
<span class="2057287837755864137" onmouseenter="enter('2057287837755864137');" onmouseout="out('2057287837755864137');" style=""><abbr title=" 165                  mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnable,"> 165                  mediaSource = new ProgressiveMediaSource.Factory(getDataSourceFactoryCache(mAppContext, cacheEnabl🔵</abbr></span>
<span class="-1940406333279134193" onmouseenter="enter('-1940406333279134193');" onmouseout="out('-1940406333279134193');" style=""> 166                          preview, cacheDir, uerAgent), new DefaultExtractorsFactory())                             </span>
<span class="-5849083771089249093" onmouseenter="enter('-5849083771089249093');" onmouseout="out('-5849083771089249093');" style=""> 167                          .createMediaSource(mediaItem);                                                            </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 168                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169          }                                                                                                         </span>
<span class="-6437128767689830906" onmouseenter="enter('-6437128767689830906');" onmouseout="out('-6437128767689830906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -        if (isLooping) {                                                                                          </span>
<span class="4960838216480500998" onmouseenter="enter('4960838216480500998');" onmouseout="out('4960838216480500998');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -            return new LoopingMediaSource(mediaSource);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -        }                                                                                                         </span>
<span class="-1838117677937229064" onmouseenter="enter('-1838117677937229064');" onmouseout="out('-1838117677937229064');" style=""> 173          return mediaSource;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174      }                                                                                                             </span>
<span  style=""> 175                                                                                                                    </span>
<span  style=""> 176                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 177      /**                                                                                                           </span>
<span class="268464750667491347" onmouseenter="enter('268464750667491347');" onmouseout="out('268464750667491347');" style=""> 178       * 设置ExoPlayer 的 MediaSource 创建拦截                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 179       */                                                                                                           </span>
<span class="-3220193549345070784" onmouseenter="enter('-3220193549345070784');" onmouseout="out('-3220193549345070784');" style=""><abbr title=" 180      public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptListener) {"> 180      public static void setExoMediaSourceInterceptListener(ExoMediaSourceInterceptListener exoMediaSourceInterceptL🔵</abbr></span>
<span class="6889549739386344871" onmouseenter="enter('6889549739386344871');" onmouseout="out('6889549739386344871');" style=""> 181          sExoMediaSourceInterceptListener = exoMediaSourceInterceptListener;                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182      }                                                                                                             </span>
<span  style=""> 183                                                                                                                    </span>
<span class="-4818621628615420115" onmouseenter="enter('-4818621628615420115');" onmouseout="out('-4818621628615420115');" style=""> 184      public static void resetExoMediaSourceInterceptListener() {                                                   </span>
<span class="-256584753286895392" onmouseenter="enter('-256584753286895392');" onmouseout="out('-256584753286895392');" style=""> 185          sExoMediaSourceInterceptListener = null;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="5865073637765895493" onmouseenter="enter('5865073637765895493');" onmouseout="out('5865073637765895493');" style=""> 188      public static ExoMediaSourceInterceptListener getExoMediaSourceInterceptListener() {                          </span>
<span class="-8762576506944240560" onmouseenter="enter('-8762576506944240560');" onmouseout="out('-8762576506944240560');" style=""> 189          return sExoMediaSourceInterceptListener;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190      }                                                                                                             </span>
<span  style=""> 191                                                                                                                    </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-1063844347616692784" onmouseenter="enter('-1063844347616692784');" onmouseout="out('-1063844347616692784');" style=""> 193      @SuppressLint(&quot;WrongConstant&quot;)                                                                                </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 194      @C.ContentType                                                                                                </span>
<span class="-8571548472546648501" onmouseenter="enter('-8571548472546648501');" onmouseout="out('-8571548472546648501');" style=""> 195      public static int inferContentType(String fileName, @Nullable String overrideExtension) {                     </span>
<span class="-392879567198634870" onmouseenter="enter('-392879567198634870');" onmouseout="out('-392879567198634870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -        fileName = Util.toLowerInvariant(fileName);                                                               </span>
<span class="-1058212535841907919" onmouseenter="enter('-1058212535841907919');" onmouseout="out('-1058212535841907919');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +        fileName = Ascii.toLowerCase(fileName);                                                                   </span>

<span class="6865607915146658606" onmouseenter="enter('6865607915146658606');" onmouseout="out('6865607915146658606');" style=""> 198          if (fileName.startsWith(&quot;rtmp:&quot;)) {                                                                       </span>
<span class="-2335515362235810488" onmouseenter="enter('-2335515362235810488');" onmouseout="out('-2335515362235810488');" style=""> 199              return TYPE_RTMP;                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 200          } else {                                                                                                  </span>
<span class="-4150133085136108549" onmouseenter="enter('-4150133085136108549');" onmouseout="out('-4150133085136108549');" style=""> 201              return inferContentType(Uri.parse(fileName), overrideExtension);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203      }                                                                                                             </span>
<span  style=""> 204                                                                                                                    </span>
<span class="9044649654583386748" onmouseenter="enter('9044649654583386748');" onmouseout="out('9044649654583386748');" style=""> 205      @C.ContentType                                                                                                </span>
<span class="51086760664059912" onmouseenter="enter('51086760664059912');" onmouseout="out('51086760664059912');" style=""> 206      public static int inferContentType(Uri uri, @Nullable String overrideExtension) {                             </span>
<span class="8118578399735665553" onmouseenter="enter('8118578399735665553');" onmouseout="out('8118578399735665553');" style=""> 207          return Util.inferContentType(uri, overrideExtension);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208      }                                                                                                             </span>
<span  style=""> 209                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 210      /**                                                                                                           </span>
<span class="-2918834671047387949" onmouseenter="enter('-2918834671047387949');" onmouseout="out('-2918834671047387949');" style=""> 211       * 本地缓存目录                                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 212       */                                                                                                           </span>
<span class="8373741442571147480" onmouseenter="enter('8373741442571147480');" onmouseout="out('8373741442571147480');" style=""> 213      public static synchronized Cache getCacheSingleInstance(Context context, File cacheDir) {                     </span>
<span class="5493858603497608540" onmouseenter="enter('5493858603497608540');" onmouseout="out('5493858603497608540');" style=""> 214          String dirs = context.getCacheDir().getAbsolutePath();                                                    </span>
<span class="7445937115127050990" onmouseenter="enter('7445937115127050990');" onmouseout="out('7445937115127050990');" style=""> 215          if (cacheDir != null) {                                                                                   </span>
<span class="4597761149181751399" onmouseenter="enter('4597761149181751399');" onmouseout="out('4597761149181751399');" style=""> 216              dirs = cacheDir.getAbsolutePath();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217          }                                                                                                         </span>
<span class="-5262494487137808971" onmouseenter="enter('-5262494487137808971');" onmouseout="out('-5262494487137808971');" style=""> 218          if (mCache == null) {                                                                                     </span>
<span class="-8514817442366527959" onmouseenter="enter('-8514817442366527959');" onmouseout="out('-8514817442366527959');" style=""> 219              String path = dirs + File.separator + &quot;exo&quot;;                                                          </span>
<span class="-1725211349640716689" onmouseenter="enter('-1725211349640716689');" onmouseout="out('-1725211349640716689');" style=""> 220              boolean isLocked = SimpleCache.isCacheFolderLocked(new File(path));                                   </span>
<span class="-5993825009051200231" onmouseenter="enter('-5993825009051200231');" onmouseout="out('-5993825009051200231');" style=""> 221              if (!isLocked) {                                                                                      </span>
<span class="-703744863139117980" onmouseenter="enter('-703744863139117980');" onmouseout="out('-703744863139117980');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -                mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE));    </span>
<span class="-6256951664120801242" onmouseenter="enter('-6256951664120801242');" onmouseout="out('-6256951664120801242');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 223 +                mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE), sDatabaseProvider);"> 223 +                mCache = new SimpleCache(new File(path), new LeastRecentlyUsedCacheEvictor(DEFAULT_MAX_SIZE), sDat🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225          }                                                                                                         </span>
<span class="2375441079046756829" onmouseenter="enter('2375441079046756829');" onmouseout="out('2375441079046756829');" style=""> 226          return mCache;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227      }                                                                                                             </span>
<span  style=""> 228                                                                                                                    </span>
<span class="2702286103088736995" onmouseenter="enter('2702286103088736995');" onmouseout="out('2702286103088736995');" style=""> 229      public void release() {                                                                                       </span>
<span class="-4077098582254622113" onmouseenter="enter('-4077098582254622113');" onmouseout="out('-4077098582254622113');" style=""> 230          isCached = false;                                                                                         </span>
<span class="-6083569314997925846" onmouseenter="enter('-6083569314997925846');" onmouseout="out('-6083569314997925846');" style=""> 231          if (mCache != null) {                                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 232              try {                                                                                                 </span>
<span class="529169855077323853" onmouseenter="enter('529169855077323853');" onmouseout="out('529169855077323853');" style=""> 233                  mCache.release();                                                                                 </span>
<span class="-5535969345357657316" onmouseenter="enter('-5535969345357657316');" onmouseout="out('-5535969345357657316');" style=""> 234                  mCache = null;                                                                                    </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 235              } catch (Exception e) {                                                                               </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 236                  e.printStackTrace();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239      }                                                                                                             </span>
<span  style=""> 240                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 241      /**                                                                                                           </span>
<span class="2545213195216124485" onmouseenter="enter('2545213195216124485');" onmouseout="out('2545213195216124485');" style=""> 242       * Cache需要release之后才能clear                                                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -     *                                                                                                            </span>
<span class="-5592793211053726605" onmouseenter="enter('-5592793211053726605');" onmouseout="out('-5592793211053726605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -     * @param context                                                                                             </span>
<span class="3209897607463931648" onmouseenter="enter('3209897607463931648');" onmouseout="out('3209897607463931648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -     * @param cacheDir                                                                                            </span>
<span class="6502316225866244393" onmouseenter="enter('6502316225866244393');" onmouseout="out('6502316225866244393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -     * @param url                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 247       */                                                                                                           </span>
<span class="6047086158735776789" onmouseenter="enter('6047086158735776789');" onmouseout="out('6047086158735776789');" style=""> 248      public static void clearCache(Context context, File cacheDir, String url) {                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 249          try {                                                                                                     </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 250              Cache cache = getCacheSingleInstance(context, cacheDir);                                              </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 251              if (!TextUtils.isEmpty(url)) {                                                                        </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 252                  if (cache != null) {                                                                              </span>
<span class="-5650187598242283898" onmouseenter="enter('-5650187598242283898');" onmouseout="out('-5650187598242283898');" style=""> 253                      removeCache(cache, url);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 255              } else {                                                                                              </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 256                  if (cache != null) {                                                                              </span>
<span class="7961042807133489432" onmouseenter="enter('7961042807133489432');" onmouseout="out('7961042807133489432');" style=""> 257                      for (String key : cache.getKeys()) {                                                          </span>
<span class="-7152962664806820071" onmouseenter="enter('-7152962664806820071');" onmouseout="out('-7152962664806820071');" style=""> 258                          removeCache(cache, key);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261              }                                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 262          } catch (Exception e) {                                                                                   </span>
<span class="4090663313211582937" onmouseenter="enter('4090663313211582937');" onmouseout="out('4090663313211582937');" style=""> 263              e.printStackTrace();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265      }                                                                                                             </span>
<span  style=""> 266                                                                                                                    </span>
<span  style=""> 267                                                                                                                    </span>
<span class="167482028640019662" onmouseenter="enter('167482028640019662');" onmouseout="out('167482028640019662');" style=""> 268      public static void removeCache(Cache cache, String url) {                                                     </span>
<span class="-1909055186960113209" onmouseenter="enter('-1909055186960113209');" onmouseout="out('-1909055186960113209');" style=""> 269          NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(buildCacheKey(url));                           </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 270          for (CacheSpan cachedSpan : cachedSpans) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 271              try {                                                                                                 </span>
<span class="1961840987401424959" onmouseenter="enter('1961840987401424959');" onmouseout="out('1961840987401424959');" style=""> 272                  cache.removeSpan(cachedSpan);                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 273              } catch (Exception e) {                                                                               </span>
<span class="-4130810023601196090" onmouseenter="enter('-4130810023601196090');" onmouseout="out('-4130810023601196090');" style=""> 274                  // Do nothing.                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277      }                                                                                                             </span>
<span  style=""> 278                                                                                                                    </span>
<span class="-8198521815859651674" onmouseenter="enter('-8198521815859651674');" onmouseout="out('-8198521815859651674');" style=""> 279      public static String buildCacheKey(String url) {                                                              </span>
<span class="3080452641973210712" onmouseenter="enter('3080452641973210712');" onmouseout="out('3080452641973210712');" style=""> 280          DataSpec dataSpec = new DataSpec(Uri.parse(url));                                                         </span>
<span class="3026971444796471896" onmouseenter="enter('3026971444796471896');" onmouseout="out('3026971444796471896');" style=""> 281          String key = CacheKeyFactory.DEFAULT.buildCacheKey(dataSpec);                                             </span>
<span class="5738733750165622395" onmouseenter="enter('5738733750165622395');" onmouseout="out('5738733750165622395');" style=""> 282          return key;                                                                                               </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="-2359379937002163053" onmouseenter="enter('-2359379937002163053');" onmouseout="out('-2359379937002163053');" style=""> 285      public static boolean cachePreView(Context context, File cacheDir, String url) {                              </span>
<span class="6669724668123101030" onmouseenter="enter('6669724668123101030');" onmouseout="out('6669724668123101030');" style=""> 286          return resolveCacheState(getCacheSingleInstance(context, cacheDir), url);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 287      }                                                                                                             </span>
<span  style=""> 288                                                                                                                    </span>
<span class="4275422663013542480" onmouseenter="enter('4275422663013542480');" onmouseout="out('4275422663013542480');" style=""> 289      public boolean hadCached() {                                                                                  </span>
<span class="3074888405336734299" onmouseenter="enter('3074888405336734299');" onmouseout="out('3074888405336734299');" style=""> 290          return isCached;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291      }                                                                                                             </span>
<span  style=""> 292                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 293      /**                                                                                                           </span>
<span class="8473691039153214479" onmouseenter="enter('8473691039153214479');" onmouseout="out('8473691039153214479');" style=""> 294       * 忽律Https证书校验                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 295       *                                                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 296       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 297       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 298      @Deprecated                                                                                                   </span>
<span class="2198318641674923085" onmouseenter="enter('2198318641674923085');" onmouseout="out('2198318641674923085');" style=""> 299      public static boolean isSkipSSLChain() {                                                                      </span>
<span class="873024860049770122" onmouseenter="enter('873024860049770122');" onmouseout="out('873024860049770122');" style=""> 300          return sSkipSSLChain;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301      }                                                                                                             </span>
<span  style=""> 302                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 303      /**                                                                                                           </span>
<span class="2007360617581285918" onmouseenter="enter('2007360617581285918');" onmouseout="out('2007360617581285918');" style=""> 304       * 设置https忽略证书                                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 305       *                                                                                                            </span>
<span class="-8071550217355649258" onmouseenter="enter('-8071550217355649258');" onmouseout="out('-8071550217355649258');" style=""> 306       * @param skipSSLChain true时是hulve                                                                            </span>
<span class="2636810227752018954" onmouseenter="enter('2636810227752018954');" onmouseout="out('2636810227752018954');" style=""> 307       * @deprecated 如果需要忽略证书，请直接使用 ExoMediaSourceInterceptListener 的 getHttpDataSourceFactory                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 308       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 309      @Deprecated                                                                                                   </span>
<span class="-1308991004088670996" onmouseenter="enter('-1308991004088670996');" onmouseout="out('-1308991004088670996');" style=""> 310      public static void setSkipSSLChain(boolean skipSSLChain) {                                                    </span>
<span class="1121146022274574744" onmouseenter="enter('1121146022274574744');" onmouseout="out('1121146022274574744');" style=""> 311          sSkipSSLChain = skipSSLChain;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312      }                                                                                                             </span>
<span  style=""> 313                                                                                                                    </span>
<span  style=""> 314                                                                                                                    </span>
<span class="2976239622278297742" onmouseenter="enter('2976239622278297742');" onmouseout="out('2976239622278297742');" style=""> 315      public static int getHttpReadTimeout() {                                                                      </span>
<span class="5523542451485133181" onmouseenter="enter('5523542451485133181');" onmouseout="out('5523542451485133181');" style=""> 316          return sHttpReadTimeout;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317      }                                                                                                             </span>
<span  style=""> 318                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 319      /**                                                                                                           </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 320       * 如果设置小于 0 就使用默认 8000 MILLIS                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 321       */                                                                                                           </span>
<span class="2919025488051579831" onmouseenter="enter('2919025488051579831');" onmouseout="out('2919025488051579831');" style=""> 322      public static void setHttpReadTimeout(int httpReadTimeout) {                                                  </span>
<span class="-3997040606525716839" onmouseenter="enter('-3997040606525716839');" onmouseout="out('-3997040606525716839');" style=""> 323          ExoSourceManager.sHttpReadTimeout = httpReadTimeout;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324      }                                                                                                             </span>
<span  style=""> 325                                                                                                                    </span>
<span class="5450236011176178791" onmouseenter="enter('5450236011176178791');" onmouseout="out('5450236011176178791');" style=""> 326      public static int getHttpConnectTimeout() {                                                                   </span>
<span class="1111499796559727252" onmouseenter="enter('1111499796559727252');" onmouseout="out('1111499796559727252');" style=""> 327          return sHttpConnectTimeout;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 328      }                                                                                                             </span>
<span  style=""> 329                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 330      /**                                                                                                           </span>
<span class="-2579204953947088387" onmouseenter="enter('-2579204953947088387');" onmouseout="out('-2579204953947088387');" style=""> 331       * 如果设置小于 0 就使用默认 8000 MILLIS                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 332       */                                                                                                           </span>
<span class="-7016684631510872274" onmouseenter="enter('-7016684631510872274');" onmouseout="out('-7016684631510872274');" style=""> 333      public static void setHttpConnectTimeout(int httpConnectTimeout) {                                            </span>
<span class="-2795264608914979197" onmouseenter="enter('-2795264608914979197');" onmouseout="out('-2795264608914979197');" style=""> 334          ExoSourceManager.sHttpConnectTimeout = httpConnectTimeout;                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335      }                                                                                                             </span>
<span  style=""> 336                                                                                                                    </span>
<span class="-3420724575907019098" onmouseenter="enter('-3420724575907019098');" onmouseout="out('-3420724575907019098');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 337 +    public static DatabaseProvider getDatabaseProvider() {                                                        </span>
<span class="-2185808013130137608" onmouseenter="enter('-2185808013130137608');" onmouseout="out('-2185808013130137608');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 338 +        return sDatabaseProvider;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 339 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 340 +                                                                                                                  </span>
<span class="-1193343422611666410" onmouseenter="enter('-1193343422611666410');" onmouseout="out('-1193343422611666410');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 341 +    public static void setDatabaseProvider(DatabaseProvider databaseProvider) {                                   </span>
<span class="-7671573637861427354" onmouseenter="enter('-7671573637861427354');" onmouseout="out('-7671573637861427354');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 342 +        ExoSourceManager.sDatabaseProvider = databaseProvider;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 343 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 344 +                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 345      /**                                                                                                           </span>
<span class="-1233347272602211288" onmouseenter="enter('-1233347272602211288');" onmouseout="out('-1233347272602211288');" style=""> 346       * 获取SourceFactory，是否带Cache                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 347       */                                                                                                           </span>
<span class="-8060849973918439601" onmouseenter="enter('-8060849973918439601');" onmouseout="out('-8060849973918439601');" style=""><abbr title=" 348      private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, File cacheDir, String uerAgent) {"> 348      private DataSource.Factory getDataSourceFactoryCache(Context context, boolean cacheEnable, boolean preview, Fi🔵</abbr></span>
<span class="7825217223858997247" onmouseenter="enter('7825217223858997247');" onmouseout="out('7825217223858997247');" style=""> 349          if (cacheEnable) {                                                                                        </span>
<span class="4288800246601110476" onmouseenter="enter('4288800246601110476');" onmouseout="out('4288800246601110476');" style=""> 350              Cache cache = getCacheSingleInstance(context, cacheDir);                                              </span>
<span class="7036681402971593232" onmouseenter="enter('7036681402971593232');" onmouseout="out('7036681402971593232');" style=""> 351              if (cache != null) {                                                                                  </span>
<span class="9021007000539438017" onmouseenter="enter('9021007000539438017');" onmouseout="out('9021007000539438017');" style=""> 352                  isCached = resolveCacheState(cache, mDataSource);                                                 </span>
<span class="-3761479699771438765" onmouseenter="enter('-3761479699771438765');" onmouseout="out('-3761479699771438765');" style=""> 353                  CacheDataSource.Factory factory = new CacheDataSource.Factory();                                  </span>
<span class="-8093724037283287608" onmouseenter="enter('-8093724037283287608');" onmouseout="out('-8093724037283287608');" style=""> 354                  return factory.                                                                                   </span>
<span class="-5074485159975905347" onmouseenter="enter('-5074485159975905347');" onmouseout="out('-5074485159975905347');" style=""><abbr title=" 355                          setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAgent)).setFlags(CacheDataSource.FLAG_IGNORE_CACHE_ON_ERROR);"> 355                          setCache(cache).setCacheReadDataSourceFactory(getDataSourceFactory(context, preview, uerAg🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357          }                                                                                                         </span>
<span class="-1431913544698159813" onmouseenter="enter('-1431913544698159813');" onmouseout="out('-1431913544698159813');" style=""> 358          return getDataSourceFactory(context, preview, uerAgent);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359      }                                                                                                             </span>
<span  style=""> 360                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 361      /**                                                                                                           </span>
<span class="-283092449438347556" onmouseenter="enter('-283092449438347556');" onmouseout="out('-283092449438347556');" style=""> 362       * 获取SourceFactory                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 363       */                                                                                                           </span>
<span class="1834018894786004406" onmouseenter="enter('1834018894786004406');" onmouseout="out('1834018894786004406');" style=""> 364      private DataSource.Factory getDataSourceFactory(Context context, boolean preview, String uerAgent) {          </span>
<span class="1829813597817317525" onmouseenter="enter('1829813597817317525');" onmouseout="out('1829813597817317525');" style=""><abbr title=" 365          return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).build(),"> 365          return new DefaultDataSourceFactory(context, preview ? null : new DefaultBandwidthMeter.Builder(context).b🔵</abbr></span>
<span class="-4652974943362556447" onmouseenter="enter('-4652974943362556447');" onmouseout="out('-4652974943362556447');" style=""> 366                  getHttpDataSourceFactory(context, preview, uerAgent));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367      }                                                                                                             </span>
<span  style=""> 368                                                                                                                    </span>
<span class="-879776573326484759" onmouseenter="enter('-879776573326484759');" onmouseout="out('-879776573326484759');" style=""> 369      private DataSource.Factory getHttpDataSourceFactory(Context context, boolean preview, String uerAgent) {      </span>
<span class="4493368850476432367" onmouseenter="enter('4493368850476432367');" onmouseout="out('4493368850476432367');" style=""> 370          if (uerAgent == null) {                                                                                   </span>
<span class="-1748097148375756721" onmouseenter="enter('-1748097148375756721');" onmouseout="out('-1748097148375756721');" style=""> 371              uerAgent = Util.getUserAgent(context, TAG);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372          }                                                                                                         </span>
<span class="-9065933110167474911" onmouseenter="enter('-9065933110167474911');" onmouseout="out('-9065933110167474911');" style=""> 373          int connectTimeout = DefaultHttpDataSource.DEFAULT_CONNECT_TIMEOUT_MILLIS;                                </span>
<span class="6449380685464591139" onmouseenter="enter('6449380685464591139');" onmouseout="out('6449380685464591139');" style=""> 374          int readTimeout = DefaultHttpDataSource.DEFAULT_READ_TIMEOUT_MILLIS;                                      </span>
<span class="-1006385169289819833" onmouseenter="enter('-1006385169289819833');" onmouseout="out('-1006385169289819833');" style=""> 375          if (sHttpConnectTimeout &gt; 0) {                                                                            </span>
<span class="-1115887819057715189" onmouseenter="enter('-1115887819057715189');" onmouseout="out('-1115887819057715189');" style=""> 376              connectTimeout = sHttpConnectTimeout;                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377          }                                                                                                         </span>
<span class="623482186481107038" onmouseenter="enter('623482186481107038');" onmouseout="out('623482186481107038');" style=""> 378          if (sHttpReadTimeout &gt; 0) {                                                                               </span>
<span class="3096862042682748327" onmouseenter="enter('3096862042682748327');" onmouseout="out('3096862042682748327');" style=""> 379              readTimeout = sHttpReadTimeout;                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380          }                                                                                                         </span>
<span class="-1477830294864050779" onmouseenter="enter('-1477830294864050779');" onmouseout="out('-1477830294864050779');" style=""> 381          boolean allowCrossProtocolRedirects = false;                                                              </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style=""> 382          if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                                    </span>
<span class="-8838917078629499221" onmouseenter="enter('-8838917078629499221');" onmouseout="out('-8838917078629499221');" style=""> 383              allowCrossProtocolRedirects = &quot;true&quot;.equals(mMapHeadData.get(&quot;allowCrossProtocolRedirects&quot;));         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384          }                                                                                                         </span>
<span class="3221029067501196489" onmouseenter="enter('3221029067501196489');" onmouseout="out('3221029067501196489');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 385 -        HttpDataSource.BaseFactory dataSourceFactory;                                                             </span>
<span class="3270687530488436452" onmouseenter="enter('3270687530488436452');" onmouseout="out('3270687530488436452');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 386 +        DataSource.Factory dataSourceFactory;                                                                     </span>
<span class="-4716664710360121701" onmouseenter="enter('-4716664710360121701');" onmouseout="out('-4716664710360121701');" style=""> 387          if (sExoMediaSourceInterceptListener != null) {                                                           </span>
<span class="2091451277126898709" onmouseenter="enter('2091451277126898709');" onmouseout="out('2091451277126898709');" style=""><abbr title=" 388              dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 388              dataSourceFactory = sExoMediaSourceInterceptListener.getHttpDataSourceFactory(uerAgent, preview ? null🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style=""> 389                      connectTimeout,                                                                               </span>
<span class="-5101637653190280170" onmouseenter="enter('-5101637653190280170');" onmouseout="out('-5101637653190280170');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 390 -                    readTimeout, allowCrossProtocolRedirects);                                                    </span>
<span class="-51576699489615850" onmouseenter="enter('-51576699489615850');" onmouseout="out('-51576699489615850');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 391 +                    readTimeout, mMapHeadData, allowCrossProtocolRedirects);                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 392          } else {                                                                                                  </span>
<span class="8166862827820244898" onmouseenter="enter('8166862827820244898');" onmouseout="out('8166862827820244898');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 393 -            dataSourceFactory = new DefaultHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build(),"> 393 -            dataSourceFactory = new DefaultHttpDataSourceFactory(uerAgent, preview ? null : new DefaultBandwidthMe🔵</abbr></span>
<span class="-2066127133263875776" onmouseenter="enter('-2066127133263875776');" onmouseout="out('-2066127133263875776');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 394 -                    connectTimeout,                                                                               </span>
<span class="-5101637653190280170" onmouseenter="enter('-5101637653190280170');" onmouseout="out('-5101637653190280170');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 395 -                    readTimeout, allowCrossProtocolRedirects);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 396 -        }                                                                                                         </span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 397 -        if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                                    </span>
<span class="2616194727311752071" onmouseenter="enter('2616194727311752071');" onmouseout="out('2616194727311752071');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 398 -            for (Map.Entry&lt;String, String&gt; header : mMapHeadData.entrySet()) {                                    </span>
<span class="-6694194845723559940" onmouseenter="enter('-6694194845723559940');" onmouseout="out('-6694194845723559940');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 399 -                dataSourceFactory.getDefaultRequestProperties().set(header.getKey(), header.getValue());          </span>
<span class="8445214236760378199" onmouseenter="enter('8445214236760378199');" onmouseout="out('8445214236760378199');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 400 +            dataSourceFactory = new DefaultHttpDataSource.Factory()                                               </span>
<span class="4157379816614128432" onmouseenter="enter('4157379816614128432');" onmouseout="out('4157379816614128432');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 401 +                    .setAllowCrossProtocolRedirects(allowCrossProtocolRedirects)                                  </span>
<span class="-6788353891995527067" onmouseenter="enter('-6788353891995527067');" onmouseout="out('-6788353891995527067');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 402 +                    .setConnectTimeoutMs(connectTimeout)                                                          </span>
<span class="-4562924741655466840" onmouseenter="enter('-4562924741655466840');" onmouseout="out('-4562924741655466840');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 403 +                    .setReadTimeoutMs(readTimeout)                                                                </span>
<span class="5513192411211624142" onmouseenter="enter('5513192411211624142');" onmouseout="out('5513192411211624142');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 404 +                    .setTransferListener(preview ? null : new DefaultBandwidthMeter.Builder(mAppContext).build());</span>
<span class="-237384248072607147" onmouseenter="enter('-237384248072607147');" onmouseout="out('-237384248072607147');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 405 +            if (mMapHeadData != null &amp;&amp; mMapHeadData.size() &gt; 0) {                                                </span>
<span class="-3433586199384292394" onmouseenter="enter('-3433586199384292394');" onmouseout="out('-3433586199384292394');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 406 +                ((DefaultHttpDataSource.Factory) dataSourceFactory).setDefaultRequestProperties(mMapHeadData);    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 407              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408          }                                                                                                         </span>
<span class="1723753173213071643" onmouseenter="enter('1723753173213071643');" onmouseout="out('1723753173213071643');" style=""> 409          return dataSourceFactory;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410      }                                                                                                             </span>
<span  style=""> 411                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 412      /**                                                                                                           </span>
<span class="-5059148079091929211" onmouseenter="enter('-5059148079091929211');" onmouseout="out('-5059148079091929211');" style=""> 413       * 根据缓存块判断是否缓存成功                                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 414 -     *                                                                                                            </span>
<span class="1237233419561726312" onmouseenter="enter('1237233419561726312');" onmouseout="out('1237233419561726312');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 415 -     * @param cache                                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 416       */                                                                                                           </span>
<span class="-2204351825262319384" onmouseenter="enter('-2204351825262319384');" onmouseout="out('-2204351825262319384');" style=""> 417      private static boolean resolveCacheState(Cache cache, String url) {                                           </span>
<span class="124753744680968754" onmouseenter="enter('124753744680968754');" onmouseout="out('124753744680968754');" style=""> 418          boolean isCache = true;                                                                                   </span>
<span class="-5326042123235939301" onmouseenter="enter('-5326042123235939301');" onmouseout="out('-5326042123235939301');" style=""> 419          if (!TextUtils.isEmpty(url)) {                                                                            </span>
<span class="9175234064888605862" onmouseenter="enter('9175234064888605862');" onmouseout="out('9175234064888605862');" style=""> 420              String key = buildCacheKey(url);                                                                      </span>
<span class="8462256178484181139" onmouseenter="enter('8462256178484181139');" onmouseout="out('8462256178484181139');" style=""> 421              if (!TextUtils.isEmpty(key)) {                                                                        </span>
<span class="-8737585301747024644" onmouseenter="enter('-8737585301747024644');" onmouseout="out('-8737585301747024644');" style=""> 422                  NavigableSet&lt;CacheSpan&gt; cachedSpans = cache.getCachedSpans(key);                                  </span>
<span class="6104552210198839213" onmouseenter="enter('6104552210198839213');" onmouseout="out('6104552210198839213');" style=""> 423                  if (cachedSpans.size() == 0) {                                                                    </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 424                      isCache = false;                                                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 425                  } else {                                                                                          </span>
<span class="122280032006644231" onmouseenter="enter('122280032006644231');" onmouseout="out('122280032006644231');" style=""><abbr title=" 426                      long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.LENGTH_UNSET);"> 426                      long contentLength = cache.getContentMetadata(key).get(ContentMetadata.KEY_CONTENT_LENGTH, C.L🔵</abbr></span>
<span class="2548419966105293269" onmouseenter="enter('2548419966105293269');" onmouseout="out('2548419966105293269');" style=""> 427                      long currentLength = 0;                                                                       </span>
<span class="-1723891119711717521" onmouseenter="enter('-1723891119711717521');" onmouseout="out('-1723891119711717521');" style=""> 428                      for (CacheSpan cachedSpan : cachedSpans) {                                                    </span>
<span class="-228864752981275902" onmouseenter="enter('-228864752981275902');" onmouseout="out('-228864752981275902');" style=""> 429                          currentLength += cache.getCachedLength(key, cachedSpan.position, cachedSpan.length);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430                      }                                                                                             </span>
<span class="-95640198430383414" onmouseenter="enter('-95640198430383414');" onmouseout="out('-95640198430383414');" style=""> 431                      isCache = currentLength &gt;= contentLength;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 432                  }                                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 433              } else {                                                                                              </span>
<span class="-3658574401751057593" onmouseenter="enter('-3658574401751057593');" onmouseout="out('-3658574401751057593');" style=""> 434                  isCache = false;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436          }                                                                                                         </span>
<span class="-4805343878943095560" onmouseenter="enter('-4805343878943095560');" onmouseout="out('-4805343878943095560');" style=""> 437          return isCache;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            