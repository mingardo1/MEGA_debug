<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>434</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    434
                    <a href="433.html">prev</a>
                    <a href="435.html">next</a>
                    <a href="434_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_94c27847a127071795c452d91ec81426640fb20c_kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;94c27847a127071795c452d91ec81426640fb20c:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;94c27847a127071795c452d91ec81426640fb20c^1:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;94c27847a127071795c452d91ec81426640fb20c^2:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;d124305ffe07b66f8eee430b3c0ac1072281dc14:kafka-base/kafka-base-source/src/main/java/com/dtstack/flink/sql/source/kafka/table/KafkaSourceParser.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 
  20 package com.dtstack.flink.sql.source.kafka.table;
  21 
  22 import com.dtstack.flink.sql.format.FormatType;
  23 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;
  24 import com.dtstack.flink.sql.table.AbstractSourceParser;
  25 import com.dtstack.flink.sql.table.AbstractTableInfo;
  26 import com.dtstack.flink.sql.util.MathUtil;
  27 
  28 import java.util.Map;
  29 import java.util.stream.Collectors;
  30 
  31 /**
  32  * Reason:
  33  * Date: 2018/09/18
  34  * Company: www.dtstack.com
  35  *
  36  * @author sishu.yss
  37  */
  38 public class KafkaSourceParser extends AbstractSourceParser {
  39     @Override
<abbr title="  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr>
  41 
  42         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();
  43         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);
  44 
  45         kafkaSourceTableInfo.setName(tableName);
<abbr title="  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr>
<abbr title="  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr>
<abbr title="  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr>
<abbr title="  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr>
<abbr title="  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr>
  51 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  52         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  52         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  53         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  53         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  54 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  55         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  55         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  56         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  56         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  57         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  57         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  58         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  58         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  59 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  62 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
<abbr title="  63         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  63         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr>
  64 
<abbr title="  65         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  65         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr>
<abbr title="  66         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  66         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
<abbr title="  67         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  67         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
  68 
  69         Map&lt;String, String&gt; kafkaParams = props.keySet().stream()
  70                 .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))
  71                 .collect(Collectors.toMap(
  72                         key -&gt; key.substring(6), key -&gt; props.get(key).toString())
  73                 );
  74 
  75         kafkaSourceTableInfo.addKafkaParam(kafkaParams);
  76         kafkaSourceTableInfo.check();
  77 
  78         return kafkaSourceTableInfo;
  79     }
  80 }
 
 </pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 
  20 package com.dtstack.flink.sql.source.kafka.table;
  21 
  22 import com.dtstack.flink.sql.format.FormatType;
  23 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;
  24 import com.dtstack.flink.sql.table.AbstractSourceParser;
  25 import com.dtstack.flink.sql.table.AbstractTableInfo;
  26 import com.dtstack.flink.sql.util.MathUtil;
  27 
  28 import java.util.Map;
  29 import java.util.stream.Collectors;
  30 
  31 /**
  32  * Reason:
  33  * Date: 2018/09/18
  34  * Company: www.dtstack.com
  35  *
  36  * @author sishu.yss
  37  */
  38 public class KafkaSourceParser extends AbstractSourceParser {
  39     @Override
<abbr title="  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  40     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr>
  41 
  42         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();
  43         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);
  44 
  45         kafkaSourceTableInfo.setName(tableName);
<abbr title="  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr>
<abbr title="  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  47         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr>
<abbr title="  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  48         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr>
<abbr title="  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  49         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr>
<abbr title="  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  50         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr>
  51 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  52         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  52         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title="  53         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  53         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  54 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55         } else {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56             kafkaSourceTableInfo.setBootstrapServers(bootstrapServer);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57         }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  58         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  58         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  59         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  59         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  60         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  61         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  62 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  63         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  63         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title="  64         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  64         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr></span>
  65 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
<abbr title="  66         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  66         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr>
  67 
<abbr title="  68         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  68         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr>
<abbr title="  69         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  69         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
<abbr title="  70         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  70         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
  71 
  72         Map&lt;String, String&gt; kafkaParams = props.keySet().stream()
  73                 .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))
  74                 .collect(Collectors.toMap(
  75                         key -&gt; key.substring(6), key -&gt; props.get(key).toString())
  76                 );
  77 
  78         kafkaSourceTableInfo.addKafkaParam(kafkaParams);
  79         kafkaSourceTableInfo.check();
  80 
  81         return kafkaSourceTableInfo;
  82     }
  83 }</pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 package com.dtstack.flink.sql.source.kafka.table;
  19 
  20 import com.dtstack.flink.sql.format.FormatType;
  21 import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;
  22 import com.dtstack.flink.sql.table.AbstractSourceParser;
  23 import com.dtstack.flink.sql.table.AbstractTableInfo;
  24 import com.dtstack.flink.sql.util.MathUtil;
  25 import java.util.Map;
  26 import java.util.stream.Collectors;
  27 
  28 
  29 /**
  30  * Reason:
  31  * Date: 2018/09/18
  32  * Company: www.dtstack.com
  33  *
  34  * @author sishu.yss
  35  */
  36 public class KafkaSourceParser extends AbstractSourceParser {
  37     @Override
<abbr title="  38     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  38     public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props)ðŸ”µ</abbr>
  39         KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();
  40         parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);
  41         kafkaSourceTableInfo.setName(tableName);
<abbr title="  42         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));">  42         kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCaðŸ”µ</abbr>
<abbr title="  43         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  43         kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLEðŸ”µ</abbr>
<abbr title="  44         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  44         kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTðŸ”µ</abbr>
<abbr title="  45         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  45         kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLðŸ”µ</abbr>
<abbr title="  46         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  46         kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerðŸ”µ</abbr>
<abbr title="  47         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  47         kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFðŸ”µ</abbr>
<abbr title="  48         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  48         kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISðŸ”µ</abbr>
<abbr title="  49         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  49         kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.ðŸ”µ</abbr>
<abbr title="  50         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  50         kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRðŸ”µ</abbr>
<abbr title="  51         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  51         kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
<abbr title="  52         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  52         kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfoðŸ”µ</abbr>
<abbr title="  53         Map&lt;String, String&gt; kafkaParams = props.keySet().stream().filter(( key) -&gt; (!key.isEmpty()) &amp;&amp; key.startsWith(&quot;kafka.&quot;)).collect(Collectors.toMap(( key) -&gt; key.substring(6), ( key) -&gt; props.get(key).toString()));">  53         Map&lt;String, String&gt; kafkaParams = props.keySet().stream().filter(( key) -&gt; (!key.isEmpty()) &amp;&amp; keðŸ”µ</abbr>
  54         kafkaSourceTableInfo.addKafkaParam(kafkaParams);
  55         kafkaSourceTableInfo.check();
  56         return kafkaSourceTableInfo;
  57     }
  58 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
  19  
  20  package com.dtstack.flink.sql.source.kafka.table;
  21  


  22  import com.dtstack.flink.sql.table.AbstractSourceParser;
  23  import com.dtstack.flink.sql.table.AbstractTableInfo;
  24  import com.dtstack.flink.sql.util.MathUtil;
  25  
  26  import java.util.Map;

  27  
  28  /**
  29   * Reason:
  30   * Date: 2018/09/18
  31   * Company: www.dtstack.com
  32   *
  33   * @author sishu.yss
  34   */
  35  public class KafkaSourceParser extends AbstractSourceParser {
  36      @Override
<abbr title="  37      public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  37      public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws EðŸ”µ</abbr>
  38  
  39          KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();


  40          kafkaSourceTableInfo.setName(tableName);
  41          kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));
  42          parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);
  43  
<abbr title="  44          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  44          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.ðŸ”µ</abbr>
<abbr title="  45          String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase()));">  45          String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCasðŸ”µ</abbr>
  46          if (bootstrapServer == null || &quot;&quot;.equals(bootstrapServer.trim())) {
  47              throw new Exception(&quot;BootstrapServers can not be empty!&quot;);
  48          } else {
  49              kafkaSourceTableInfo.setBootstrapServers(bootstrapServer);
  50          }

<abbr title="  51          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  51          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase(ðŸ”µ</abbr>
<abbr title="  52          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  52          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())))ðŸ”µ</abbr>
<abbr title="  53          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  53          kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLoðŸ”µ</abbr>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title="  54 -        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  54 -        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  55 +        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase()), false));">  55 +        kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr></span>
<abbr title="  56          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  56          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCaðŸ”µ</abbr>
  57          for (String key : props.keySet()) {
  58              if (!key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;)) {
  59                  kafkaSourceTableInfo.addKafkaParam(key.substring(6), props.get(key).toString());
  60              }
  61          }












  62          kafkaSourceTableInfo.check();

  63          return kafkaSourceTableInfo;
  64      }
  65  }</pre></td>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
  19  
  20  package com.dtstack.flink.sql.source.kafka.table;
  21  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  22 +import com.dtstack.flink.sql.format.FormatType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.source.kafka.enums.EKafkaOffset;</span>
  24  import com.dtstack.flink.sql.table.AbstractSourceParser;
  25  import com.dtstack.flink.sql.table.AbstractTableInfo;
  26  import com.dtstack.flink.sql.util.MathUtil;
  27  
  28  import java.util.Map;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import java.util.stream.Collectors;</span>
  30  
  31  /**
  32   * Reason:
  33   * Date: 2018/09/18
  34   * Company: www.dtstack.com
  35   *
  36   * @author sishu.yss
  37   */
  38  public class KafkaSourceParser extends AbstractSourceParser {
  39      @Override
<abbr title="  40      public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws Exception {">  40      public AbstractTableInfo getTableInfo(String tableName, String fieldsInfo, Map&lt;String, Object&gt; props) throws EðŸ”µ</abbr>
  41  
  42          KafkaSourceTableInfo kafkaSourceTableInfo = new KafkaSourceTableInfo();
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  43 +        parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  44 +</span>
  45          kafkaSourceTableInfo.setName(tableName);
  46          kafkaSourceTableInfo.setType(MathUtil.getString(props.get(KafkaSourceTableInfo.TYPE_KEY.toLowerCase())));
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  47 -        parseFieldsInfo(fieldsInfo, kafkaSourceTableInfo);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  48 -</span>
<abbr title="  49          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.toLowerCase())));">  49          kafkaSourceTableInfo.setParallelism(MathUtil.getIntegerVal(props.get(KafkaSourceTableInfo.PARALLELISM_KEY.ðŸ”µ</abbr>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title="  50 -        String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase()));">  50 -        String bootstrapServer = MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCasðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  51 -        if (bootstrapServer == null || &quot;&quot;.equals(bootstrapServer.trim())) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  52 -            throw new Exception(&quot;BootstrapServers can not be empty!&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  53 -        } else {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  54 -            kafkaSourceTableInfo.setBootstrapServers(bootstrapServer);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  55 -        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  56 +        kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERS_KEY.toLowerCase())));">  56 +        kafkaSourceTableInfo.setBootstrapServers(MathUtil.getString(props.get(KafkaSourceTableInfo.BOOTSTRAPSERVERðŸ”µ</abbr></span>
<abbr title="  57          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase())));">  57          kafkaSourceTableInfo.setGroupId(MathUtil.getString(props.get(KafkaSourceTableInfo.GROUPID_KEY.toLowerCase(ðŸ”µ</abbr>
<abbr title="  58          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())));">  58          kafkaSourceTableInfo.setTopic(MathUtil.getString(props.get(KafkaSourceTableInfo.TOPIC_KEY.toLowerCase())))ðŸ”µ</abbr>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title="  59 -        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase())));">  59 -        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.get(KafkaSourceTableInfo.OFFSETRESET_KEY.toLoðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  60 +        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESET_KEY.toLowerCase(), EKafkaOffset.LATEST.name().toLowerCase())));">  60 +        kafkaSourceTableInfo.setOffsetReset(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.OFFSETRESETðŸ”µ</abbr></span>
<abbr title="  61          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KEY.toLowerCase())));">  61          kafkaSourceTableInfo.setTopicIsPattern(MathUtil.getBoolean(props.get(KafkaSourceTableInfo.TOPICISPATTERN_KðŸ”µ</abbr>

<abbr title="  62          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCase())));">  62          kafkaSourceTableInfo.setTimeZone(MathUtil.getString(props.get(KafkaSourceTableInfo.TIME_ZONE_KEY.toLowerCaðŸ”µ</abbr>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  63 -        for (String key : props.keySet()) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  64 -            if (!key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;)) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  65 -                kafkaSourceTableInfo.addKafkaParam(key.substring(6), props.get(key).toString());</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  66 -            }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  67 -        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  69 +        kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.toLowerCase())));">  69 +        kafkaSourceTableInfo.setSchemaString(MathUtil.getString(props.get(KafkaSourceTableInfo.SCHEMA_STRING_KEY.tðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  70 +        kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELD_DELIMITER_KEY.toLowerCase(), &quot;|&quot;)));">  70 +        kafkaSourceTableInfo.setFieldDelimiter(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.CSV_FIELðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  71 +        kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DATA_TYPE_KEY.toLowerCase(), FormatType.DT_NEST.name())));">  71 +        kafkaSourceTableInfo.setSourceDataType(MathUtil.getString(props.getOrDefault(KafkaSourceTableInfo.SOURCE_DðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +        Map&lt;String, String&gt; kafkaParams = props.keySet().stream()</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +                .filter(key -&gt; !key.isEmpty() &amp;&amp; key.startsWith(&quot;kafka.&quot;))</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +                .collect(Collectors.toMap(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +                        key -&gt; key.substring(6), key -&gt; props.get(key).toString())</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +                );</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +        kafkaSourceTableInfo.addKafkaParam(kafkaParams);</span>
  80          kafkaSourceTableInfo.check();
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +</span>
  82          return kafkaSourceTableInfo;
  83      }
  84  }</pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            