<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>343</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    343
                    <a href="342.html">prev</a>
                    <a href="344.html">next</a>
                    <a href="343_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_cbc70fa886c8cb9647e92d5fa9f8a4c032c94031_impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/table/ImpalaTableInfo.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/table/ImpalaTableInfo.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031^1:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/table/ImpalaTableInfo.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cbc70fa886c8cb9647e92d5fa9f8a4c032c94031^2:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/table/ImpalaTableInfo.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;64c00d303220e98a602fec341743013447048eea:impala/impala-sink/src/main/java/com/dtstack/flink/sql/sink/impala/table/ImpalaTableInfo.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bs], [bs], [sbj], [bs], [sbj]], subset: [[bs], [bs], [sbj], [bs], [sbj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 package com.dtstack.flink.sql.sink.impala.table;
  20 
  21 import com.dtstack.flink.sql.enums.EUpdateMode;
  22 import com.dtstack.flink.sql.table.AbstractTargetTableInfo;
  23 import com.google.common.base.Preconditions;
  24 import org.apache.commons.lang3.StringUtils;
  25 
  26 import java.util.Objects;
  27 
  28 /**
  29  * Date: 2020/10/14
  30  * Company: www.dtstack.com
  31  *
  32  * @author tiezhu
  33  */
  34 public class ImpalaTableInfo extends AbstractTargetTableInfo {
  35 
  36     private static final int MAX_BATCH_SIZE = 10000;
  37 
  38     private String url;
  39 
  40     private String tableName;
  41 
  42     private String userName;
  43 
  44     private String password;
  45 
  46     private Integer batchSize;
  47 
  48     private Long batchWaitInterval;
  49 
  50     private String bufferSize;
  51 
  52     private String flushIntervalMs;
  53 
  54     private String schema;
  55 
  56 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57     public static final String STORE_TYPE_KEY = &quot;storeType&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  59     public static final String KUDU_TYPE = &quot;kudu&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61     private static final String CURR_TYPE = &quot;impala&quot;;</span>
  62 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63     private static final String CURR_TYPE = &quot;impala&quot;;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65     private static final String PARTITION_FIELD_SPLIT_REGEX = &quot;,&quot;;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67     private Integer authMech;</span>
  68 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69     private boolean allReplace;</span>
  70 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
  71 
  72     private String updateMode;
  73 
  74     private Integer authMech;
  75 
  76     private String krb5FilePath;
  77 
  78     private String principal;
  79 
  80     private String keyTabFilePath;
  81 
  82     private String krbRealm;
  83 
  84     private String krbHostFQDN;
  85 
  86     private String krbServiceName;
  87 
  88     private boolean enablePartition = false;
  89 
  90     private String partitionFields;
  91 
  92 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  93     /**</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  94      * If the type of storage is kudu, the logic of partition is ignore</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  95      */</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  96     private String storeType;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  97 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  98     public ImpalaTableInfo() {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  99         setType(CURR_TYPE);</span>
 100 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102     public Integer getAuthMech() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103         return authMech;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106     public void setAuthMech(Integer authMech) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107         this.authMech = authMech;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110     public String getKrb5FilePath() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111         return krb5FilePath;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114     public void setKrb5FilePath(String krb5FilePath) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115         this.krb5FilePath = krb5FilePath;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118     public String getPrincipal() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119         return principal;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122     public void setPrincipal(String principal) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123         this.principal = principal;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126     public String getKeyTabFilePath() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127         return keyTabFilePath;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130     public void setKeyTabFilePath(String keyTabFilePath) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131         this.keyTabFilePath = keyTabFilePath;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134     public String getKrbRealm() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135         return krbRealm;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138     public void setKrbRealm(String krbRealm) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139         this.krbRealm = krbRealm;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142     public String getKrbHostFQDN() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         return krbHostFQDN;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146     public void setKrbHostFQDN(String krbHostFQDN) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147         this.krbHostFQDN = krbHostFQDN;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150     public String getKrbServiceName() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151         return krbServiceName;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154     public void setKrbServiceName(String krbServiceName) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155         this.krbServiceName = krbServiceName;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158     public boolean isEnablePartition() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159         return enablePartition;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162     public void setEnablePartition(boolean enablePartition) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         this.enablePartition = enablePartition;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166     public String[] getPartitionFields() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         return partitionFields;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170     public void setPartitionFields(String partitionFields) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         this.partitionFields = StringUtils.split(partitionFields, PARTITION_FIELD_SPLIT_REGEX);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174     @Override</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175     public boolean check() {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176         Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177         Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178         Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179         Integer authMech = getAuthMech();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180 </span>
 181 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182     private String storeType;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184     public String getUrl() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185         return url;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 188     public void setUrl(String url) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189         this.url = url;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 190     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 192     public String getTableName() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193         return tableName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196     public void setTableName(String tableName) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197         this.tableName = tableName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200     public String getUserName() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201         return userName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204     public void setUserName(String userName) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 205         this.userName = userName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 206     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 207 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208     public String getPassword() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209         return password;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212     public void setPassword(String password) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213         this.password = password;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216     public Integer getBatchSize() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217         return batchSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220     public void setBatchSize(Integer batchSize) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221         this.batchSize = batchSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 222     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224     public Long getBatchWaitInterval() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225         return batchWaitInterval;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228     public void setBatchWaitInterval(Long batchWaitInterval) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229         this.batchWaitInterval = batchWaitInterval;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232     public String getBufferSize() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233         return bufferSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 234     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236     public void setBufferSize(String bufferSize) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237         this.bufferSize = bufferSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240     public String getFlushIntervalMs() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241         return flushIntervalMs;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 244     public void setFlushIntervalMs(String flushIntervalMs) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245         this.flushIntervalMs = flushIntervalMs;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248     public String getSchema() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249         return schema;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252     public void setSchema(String schema) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253         this.schema = schema;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256     public String getUpdateMode() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257         return updateMode;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260     public void setUpdateMode(String updateMode) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261         this.updateMode = updateMode;</span>
 262 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 263     }
 264 
 265     public Integer getAuthMech() {
 266         return authMech;
 267     }
 268 
 269     public void setAuthMech(Integer authMech) {
 270         this.authMech = authMech;
 271     }
 272 
 273     public String getKrb5FilePath() {
 274         return krb5FilePath;
 275     }
 276 
 277     public void setKrb5FilePath(String krb5FilePath) {
 278         this.krb5FilePath = krb5FilePath;
 279     }
 280 
 281     public String getPrincipal() {
 282         return principal;
 283     }
 284 
 285     public void setPrincipal(String principal) {
 286         this.principal = principal;
 287     }
 288 
 289     public String getKeyTabFilePath() {
 290         return keyTabFilePath;
 291     }
 292 
 293     public void setKeyTabFilePath(String keyTabFilePath) {
 294         this.keyTabFilePath = keyTabFilePath;
 295     }
 296 
 297     public String getKrbRealm() {
 298         return krbRealm;
 299     }
 300 
 301     public void setKrbRealm(String krbRealm) {
 302         this.krbRealm = krbRealm;
 303     }
 304 
 305     public String getKrbHostFQDN() {
 306         return krbHostFQDN;
 307     }
 308 
 309     public void setKrbHostFQDN(String krbHostFQDN) {
 310         this.krbHostFQDN = krbHostFQDN;
 311     }
 312 
 313     public String getKrbServiceName() {
 314         return krbServiceName;
 315     }
 316 
 317     public void setKrbServiceName(String krbServiceName) {
 318         this.krbServiceName = krbServiceName;
 319     }
 320 
 321     public boolean isEnablePartition() {
 322         return enablePartition;
 323     }
 324 
 325     public void setEnablePartition(boolean enablePartition) {
 326         this.enablePartition = enablePartition;
 327     }
 328 
 329     public String getPartitionFields() {
 330         return partitionFields;
 331     }
 332 
 333     public void setPartitionFields(String partitionFields) {
 334         this.partitionFields = partitionFields;
 335     }
 336 
 337     public String getStoreType() {
 338         return storeType;
 339     }
 340 
 341     public void setStoreType(String storeType) {
 342         this.storeType = storeType;
 343     }
 344 
 345     @Override
 346     public String getType() {
 347         return super.getType().toLowerCase();
 348     }
 349 
 350     public void setStoreType(String storeType) {
 351         this.storeType = storeType;
 352     }
 353 
 354     public String getStoreType() {
 355         return storeType;
 356     }
 357 
 358     @Override
 359     public boolean check() {
 360 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 361         Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 362         Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 363         Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 364         Preconditions.checkNotNull(this.getStoreType(), &quot;impala field of storeType is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 365         Integer authMech = getAuthMech();</span>
 366 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368         if (isEnablePartition()) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 369             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 369             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 370         }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 371 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 372         return true;</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374 }</span>
 375 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376         Preconditions.checkNotNull(url, &quot;impala field of URL is required&quot;);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377         Preconditions.checkNotNull(tableName, &quot;impala field of tableName is required&quot;);</span>
 378 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 379 
 380 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 381         if (authMech == 1) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 382             Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;);"> 382             Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;ðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 383             Preconditions.checkNotNull(this.getPrincipal(), &quot;impala field of principal is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 384             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is required&quot;);"> 384             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 385             Preconditions.checkNotNull(this.getKrbHostFQDN(), &quot;impala field of krbHostFQDN is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 386             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is required&quot;);"> 386             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 387         } else if (authMech == 2) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 388             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 389         } else if (authMech == 3) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 390             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 391             Preconditions.checkNotNull(this.getPassword(), &quot;impala field of password is required&quot;);</span>
 392 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 393     }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 394 }</span>
 395 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396         if (Objects.nonNull(batchSize)) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 397             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAX_BATCH_SIZE);"> 397             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAXðŸ”µ</abbr></span>
 398 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 399         }
 400 
 401 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 402         if (!this.getStoreType().equalsIgnoreCase(KUDU_TYPE) &amp;&amp; isEnablePartition()) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 403             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 403             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFðŸ”µ</abbr></span>
 404 ||||||| GitAnalyzerPlus_base
 405 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406         if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 407             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0, &quot;updateMode mode primary is required&quot;);"> 407             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0,ðŸ”µ</abbr></span>
 408 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
 409         }
 410 
 411         if (Objects.nonNull(getPrimaryKeys())) {
 412             getPrimaryKeys().forEach(pk -&gt; {
<abbr title=" 413                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not found in sink table field&quot;);"> 413                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not founðŸ”µ</abbr>
 414             });
 415         }
 416 
 417 
 418         Preconditions.checkArgument(getFieldList().size() == getFieldExtraInfoList().size(),
 419                 &quot;fields and fieldExtraInfoList attributes must be the same length&quot;);
 420         return true;
 421     }
 422 }</pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 
  20 package com.dtstack.flink.sql.sink.impala.table;
  21 
  22 import com.dtstack.flink.sql.enums.EUpdateMode;
  23 import com.dtstack.flink.sql.table.AbstractTargetTableInfo;
  24 import com.google.common.base.Preconditions;
  25 import org.apache.commons.lang3.StringUtils;
  26 
  27 import java.util.Objects;
  28 
  29 /**
  30  * Date: 2020/10/14
  31  * Company: www.dtstack.com
  32  *
  33  * @author tiezhu
  34  */
  35 public class ImpalaTableInfo extends AbstractTargetTableInfo {
  36 
  37     public static final String STORE_TYPE_KEY = &quot;storeType&quot;;
  38 
  39     public static final String KUDU_TYPE = &quot;kudu&quot;;
  40 
  41     private static final int MAX_BATCH_SIZE = 10000;
  42 
  43     private String url;
  44 
  45     private String tableName;
  46 
  47     private String userName;
  48 
  49     private String password;
  50 
  51     private Integer batchSize;
  52 
  53     private Long batchWaitInterval;
  54 
  55     private String bufferSize;
  56 
  57     private String flushIntervalMs;
  58 
  59     private String schema;
  60 
  61     private boolean allReplace;
  62 
  63     private String updateMode;
  64 
  65     private Integer authMech;
  66 
  67     private String krb5FilePath;
  68 
  69     private String principal;
  70 
  71     private String keyTabFilePath;
  72 
  73     private String krbRealm;
  74 
  75     private String krbHostFQDN;
  76 
  77     private String krbServiceName;
  78 
  79     private boolean enablePartition = false;
  80 
  81     private String partitionFields;
  82 
  83     /**
  84      * If the type of storage is kudu, the logic of partition is ignore
  85      */
  86     private String storeType;
  87 
  88     public String getUrl() {
  89         return url;
  90     }
  91 
  92     public void setUrl(String url) {
  93         this.url = url;
  94     }
  95 
  96     public String getTableName() {
  97         return tableName;
  98     }
  99 
 100     public void setTableName(String tableName) {
 101         this.tableName = tableName;
 102     }
 103 
 104     public String getUserName() {
 105         return userName;
 106     }
 107 
 108     public void setUserName(String userName) {
 109         this.userName = userName;
 110     }
 111 
 112     public String getPassword() {
 113         return password;
 114     }
 115 
 116     public void setPassword(String password) {
 117         this.password = password;
 118     }
 119 
 120     public Integer getBatchSize() {
 121         return batchSize;
 122     }
 123 
 124     public void setBatchSize(Integer batchSize) {
 125         this.batchSize = batchSize;
 126     }
 127 
 128     public Long getBatchWaitInterval() {
 129         return batchWaitInterval;
 130     }
 131 
 132     public void setBatchWaitInterval(Long batchWaitInterval) {
 133         this.batchWaitInterval = batchWaitInterval;
 134     }
 135 
 136     public String getBufferSize() {
 137         return bufferSize;
 138     }
 139 
 140     public void setBufferSize(String bufferSize) {
 141         this.bufferSize = bufferSize;
 142     }
 143 
 144     public String getFlushIntervalMs() {
 145         return flushIntervalMs;
 146     }
 147 
 148     public void setFlushIntervalMs(String flushIntervalMs) {
 149         this.flushIntervalMs = flushIntervalMs;
 150     }
 151 
 152     public String getSchema() {
 153         return schema;
 154     }
 155 
 156     public void setSchema(String schema) {
 157         this.schema = schema;
 158     }
 159 
 160     public String getUpdateMode() {
 161         return updateMode;
 162     }
 163 
 164     public void setUpdateMode(String updateMode) {
 165         this.updateMode = updateMode;
 166     }
 167 
 168     public Integer getAuthMech() {
 169         return authMech;
 170     }
 171 
 172     public void setAuthMech(Integer authMech) {
 173         this.authMech = authMech;
 174     }
 175 
 176     public String getKrb5FilePath() {
 177         return krb5FilePath;
 178     }
 179 
 180     public void setKrb5FilePath(String krb5FilePath) {
 181         this.krb5FilePath = krb5FilePath;
 182     }
 183 
 184     public String getPrincipal() {
 185         return principal;
 186     }
 187 
 188     public void setPrincipal(String principal) {
 189         this.principal = principal;
 190     }
 191 
 192     public String getKeyTabFilePath() {
 193         return keyTabFilePath;
 194     }
 195 
 196     public void setKeyTabFilePath(String keyTabFilePath) {
 197         this.keyTabFilePath = keyTabFilePath;
 198     }
 199 
 200     public String getKrbRealm() {
 201         return krbRealm;
 202     }
 203 
 204     public void setKrbRealm(String krbRealm) {
 205         this.krbRealm = krbRealm;
 206     }
 207 
 208     public String getKrbHostFQDN() {
 209         return krbHostFQDN;
 210     }
 211 
 212     public void setKrbHostFQDN(String krbHostFQDN) {
 213         this.krbHostFQDN = krbHostFQDN;
 214     }
 215 
 216     public String getKrbServiceName() {
 217         return krbServiceName;
 218     }
 219 
 220     public void setKrbServiceName(String krbServiceName) {
 221         this.krbServiceName = krbServiceName;
 222     }
 223 
 224     public boolean isEnablePartition() {
 225         return enablePartition;
 226     }
 227 
 228     public void setEnablePartition(boolean enablePartition) {
 229         this.enablePartition = enablePartition;
 230     }
 231 
 232     public String getPartitionFields() {
 233         return partitionFields;
 234     }
 235 
 236     public void setPartitionFields(String partitionFields) {
 237         this.partitionFields = partitionFields;
 238     }
 239 
 240     public String getStoreType() {
 241         return storeType;
 242     }
 243 
 244     public void setStoreType(String storeType) {
 245         this.storeType = storeType;
 246     }
 247 
 248     @Override
 249     public String getType() {
 250         return super.getType().toLowerCase();
 251     }
 252 
 253     @Override
 254     public boolean check() {
 255 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 256         Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 257         Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 258         Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 259         Preconditions.checkNotNull(this.getStoreType(), &quot;impala field of storeType is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 260         Integer authMech = getAuthMech();</span>
 261 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262         Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263         Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264         Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265         Integer authMech = getAuthMech();</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266 </span>
 267 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268         Preconditions.checkNotNull(url, &quot;impala field of URL is required&quot;);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269         Preconditions.checkNotNull(tableName, &quot;impala field of tableName is required&quot;);</span>
 270 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 271 
 272         if (Objects.nonNull(batchSize)) {
<abbr title=" 273             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAX_BATCH_SIZE);"> 273             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAXðŸ”µ</abbr>
 274         }
 275 
 276 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 277         if (!this.getStoreType().equalsIgnoreCase(KUDU_TYPE) &amp;&amp; isEnablePartition()) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 278             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 278             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFðŸ”µ</abbr></span>
 279 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280             Preconditions.checkNotNull(this.getPrincipal(), &quot;impala field of principal is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 281             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is required&quot;);"> 281             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282             Preconditions.checkNotNull(this.getKrbHostFQDN(), &quot;impala field of krbHostFQDN is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 283             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is required&quot;);"> 283             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284         } else if (authMech == 2) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286         }else if (authMech == 3) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288             Preconditions.checkNotNull(this.getPassword(), &quot;impala field of password is required&quot;);</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289         }</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291         if (isEnablePartition()) {</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 292             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 292             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293         }</span>
 294 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295         if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 296             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0, &quot;updateMode mode primary is required&quot;);"> 296             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0,ðŸ”µ</abbr></span>
 297 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS
 298         }
 299 
 300         if (Objects.nonNull(getPrimaryKeys())) {
 301             getPrimaryKeys().forEach(pk -&gt; {
<abbr title=" 302                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not found in sink table field&quot;);"> 302                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not founðŸ”µ</abbr>
 303             });
 304         }
 305 
 306 
 307         Preconditions.checkArgument(getFieldList().size() == getFieldExtraInfoList().size(),
 308                 &quot;fields and fieldExtraInfoList attributes must be the same length&quot;);
 309         return true;
 310     }
 311 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 package com.dtstack.flink.sql.sink.impala.table;
  19 
  20 import com.dtstack.flink.sql.enums.EUpdateMode;
  21 import com.dtstack.flink.sql.table.AbstractTargetTableInfo;
  22 import com.google.common.base.Preconditions;
  23 import java.util.Objects;
  24 import org.apache.commons.lang3.StringUtils;
  25 
  26 
  27 /**
  28  * Date: 2020/10/14
  29  * Company: www.dtstack.com
  30  *
  31  * @author tiezhu
  32  */
  33 public class ImpalaTableInfo extends AbstractTargetTableInfo {
  34 
  35     private static final int MAX_BATCH_SIZE = 10000;
  36 
  37     private String url;
  38 
  39     private String tableName;
  40 
  41     private String userName;
  42 
  43     private String password;
  44 
  45     private Integer batchSize;
  46 
  47     private Long batchWaitInterval;
  48 
  49     private String bufferSize;
  50 
  51     private String flushIntervalMs;
  52 
  53     private String schema;
  54 
  55 
  56 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  57     public static final String STORE_TYPE_KEY = &quot;storeType&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  59     public static final String KUDU_TYPE = &quot;kudu&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  60 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  61     private static final String CURR_TYPE = &quot;impala&quot;;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  62 </span>
  63 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="  64 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">  64 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
  65 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67     private boolean allReplace;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  68 </span>
  69 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
  70 
  71     private String updateMode;
  72 
  73     private Integer authMech;
  74 
  75     private String krb5FilePath;
  76 
  77     private String principal;
  78 
  79     private String keyTabFilePath;
  80 
  81     private String krbRealm;
  82 
  83     private String krbHostFQDN;
  84 
  85     private String krbServiceName;
  86 
  87     private boolean enablePartition = false;
  88 
  89     private String partitionFields;
  90 
  91 
  92 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  93     /**</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  94      * If the type of storage is kudu, the logic of partition is ignore</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  95      */</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  96     private String storeType;</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  97 </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  98     public ImpalaTableInfo() {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  99         setType(CURR_TYPE);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 100 </span>
 101 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 102 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 102 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
 103 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 104 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105     private String storeType;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107     public String getUrl() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108         return url;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111     public void setUrl(String url) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112         this.url = url;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 113     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115     public String getTableName() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116         return tableName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119     public void setTableName(String tableName) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120         this.tableName = tableName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123     public String getUserName() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124         return userName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127     public void setUserName(String userName) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128         this.userName = userName;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131     public String getPassword() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132         return password;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135     public void setPassword(String password) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136         this.password = password;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139     public Integer getBatchSize() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140         return batchSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143     public void setBatchSize(Integer batchSize) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144         this.batchSize = batchSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147     public Long getBatchWaitInterval() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148         return batchWaitInterval;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151     public void setBatchWaitInterval(Long batchWaitInterval) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152         this.batchWaitInterval = batchWaitInterval;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155     public String getBufferSize() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156         return bufferSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159     public void setBufferSize(String bufferSize) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160         this.bufferSize = bufferSize;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163     public String getFlushIntervalMs() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164         return flushIntervalMs;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167     public void setFlushIntervalMs(String flushIntervalMs) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168         this.flushIntervalMs = flushIntervalMs;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171     public String getSchema() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172         return schema;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175     public void setSchema(String schema) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176         this.schema = schema;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179     public String getUpdateMode() {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180         return updateMode;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181     }</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183     public void setUpdateMode(String updateMode) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184         this.updateMode = updateMode;</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185 </span>
 186 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 187     }
 188 
 189     public Integer getAuthMech() {
 190         return authMech;
 191     }
 192 
 193     public void setAuthMech(Integer authMech) {
 194         this.authMech = authMech;
 195     }
 196 
 197     public String getKrb5FilePath() {
 198         return krb5FilePath;
 199     }
 200 
 201     public void setKrb5FilePath(String krb5FilePath) {
 202         this.krb5FilePath = krb5FilePath;
 203     }
 204 
 205     public String getPrincipal() {
 206         return principal;
 207     }
 208 
 209     public void setPrincipal(String principal) {
 210         this.principal = principal;
 211     }
 212 
 213     public String getKeyTabFilePath() {
 214         return keyTabFilePath;
 215     }
 216 
 217     public void setKeyTabFilePath(String keyTabFilePath) {
 218         this.keyTabFilePath = keyTabFilePath;
 219     }
 220 
 221     public String getKrbRealm() {
 222         return krbRealm;
 223     }
 224 
 225     public void setKrbRealm(String krbRealm) {
 226         this.krbRealm = krbRealm;
 227     }
 228 
 229     public String getKrbHostFQDN() {
 230         return krbHostFQDN;
 231     }
 232 
 233     public void setKrbHostFQDN(String krbHostFQDN) {
 234         this.krbHostFQDN = krbHostFQDN;
 235     }
 236 
 237     public String getKrbServiceName() {
 238         return krbServiceName;
 239     }
 240 
 241     public void setKrbServiceName(String krbServiceName) {
 242         this.krbServiceName = krbServiceName;
 243     }
 244 
 245     public boolean isEnablePartition() {
 246         return enablePartition;
 247     }
 248 
 249     public void setEnablePartition(boolean enablePartition) {
 250         this.enablePartition = enablePartition;
 251     }
 252 
 253     public String getPartitionFields() {
 254         return partitionFields;
 255     }
 256 
 257     public void setPartitionFields(String partitionFields) {
 258         this.partitionFields = partitionFields;
 259     }
 260 
 261     public String getStoreType() {
 262         return storeType;
 263     }
 264 
 265     public void setStoreType(String storeType) {
 266         this.storeType = storeType;
 267     }
 268 
 269     @Override
 270     public String getType() {
 271         return super.getType().toLowerCase();
 272     }
 273 
 274     public void setStoreType(String storeType) {
 275         this.storeType = storeType;
 276     }
 277 
 278     public String getStoreType() {
 279         return storeType;
 280     }
 281 
 282     @Override
 283     public boolean check() {
 284 
 285 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 286         Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 287         Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 288         Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 289         Preconditions.checkNotNull(this.getStoreType(), &quot;impala field of storeType is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 290         Integer authMech = getAuthMech();</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 291 </span>
 292 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 293 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 293 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
 294 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296         Preconditions.checkNotNull(url, &quot;impala field of URL is required&quot;);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297         Preconditions.checkNotNull(tableName, &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298 </span>
 299 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 300 
 301 
 302 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 303         if (authMech == 1) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 304             Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;);"> 304             Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;ðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 305             Preconditions.checkNotNull(this.getPrincipal(), &quot;impala field of principal is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 306             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is required&quot;);"> 306             Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 307             Preconditions.checkNotNull(this.getKrbHostFQDN(), &quot;impala field of krbHostFQDN is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 308             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is required&quot;);"> 308             Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is requiðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 309         } else if (authMech == 2) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 310             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 311         } else if (authMech == 3) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 312             Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 313             Preconditions.checkNotNull(this.getPassword(), &quot;impala field of password is required&quot;);</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 314 </span>
 315 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 316 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 316 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
 317 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319         if (Objects.nonNull(batchSize)) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 320             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAX_BATCH_SIZE);"> 320             Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAXðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321 </span>
 322 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 323         }
 324 
 325 
 326 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 327         if (!this.getStoreType().equalsIgnoreCase(KUDU_TYPE) &amp;&amp; isEnablePartition()) {</span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 328             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 328             Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFðŸ”µ</abbr></span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 329 </span>
 330 ||||||| BASE
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 331 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 331 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
 332 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333 </span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334         if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 335             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0, &quot;updateMode mode primary is required&quot;);"> 335             Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0,ðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336 </span>
 337 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT
 338         }
 339 
 340         if (Objects.nonNull(getPrimaryKeys())) {
 341             getPrimaryKeys().forEach(pk -&gt; {
<abbr title=" 342                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not found in sink table field&quot;);"> 342                 Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not founðŸ”µ</abbr>
 343             });
 344         }
 345 
 346 
 347         Preconditions.checkArgument(getFieldList().size() == getFieldExtraInfoList().size(),
 348                 &quot;fields and fieldExtraInfoList attributes must be the same length&quot;);
 349         return true;
 350     }
 351 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
  19  
  20  package com.dtstack.flink.sql.sink.impala.table;
  21  
  22  import com.dtstack.flink.sql.sink.rdb.table.RdbTableInfo;


  23  import com.google.common.base.Preconditions;
  24  import org.apache.commons.lang3.StringUtils;
  25  


  26  /**
  27   * Date: 2019/11/13

  28   * Company: www.dtstack.com
  29   *
  30   * @author xiuzhu

  31   */
  32  
  33  public class ImpalaTableInfo extends RdbTableInfo {
  34  
  35      public static final String AUTHMECH_KEY = &quot;authMech&quot;;
  36  
  37      public static final String KRB5FILEPATH_KEY = &quot;krb5FilePath&quot;;
  38  
  39      public static final String PRINCIPAL_KEY = &quot;principal&quot;;
  40  
  41      public static final String KEYTABFILEPATH_KEY = &quot;keyTabFilePath&quot;;
  42  
  43      public static final String KRBREALM_KEY = &quot;krbRealm&quot;;
  44  
  45      public static final String KRBHOSTFQDN_KEY = &quot;krbHostFQDN&quot;;
  46  
  47      public static final String KRBSERVICENAME_KEY = &quot;krbServiceName&quot;;
  48  
  49      public static final String ENABLEPARITION_KEY = &quot;enablePartition&quot;;
  50  
  51      public static final String PARTITIONFIELDS_KEY = &quot;partitionFields&quot;;
  52  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +    public static final String STORE_TYPE_KEY = &quot;storeType&quot;;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +    public static final String KUDU_TYPE = &quot;kudu&quot;;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +</span>
  57      private static final String CURR_TYPE = &quot;impala&quot;;
  58  
  59      private static final String PARTITION_FIELD_SPLIT_REGEX = &quot;,&quot;;

























  60  
  61      private Integer authMech;
  62  
  63      private String krb5FilePath;
  64  
  65      private String principal;
  66  
  67      private String keyTabFilePath;
  68  
  69      private String krbRealm;
  70  
  71      private String krbHostFQDN;
  72  
  73      private String krbServiceName;
  74  
  75      private boolean enablePartition;
  76  
  77      private String[] partitionFields;
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +    /**</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +     * If the type of storage is kudu, the logic of partition is ignore</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +     */</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +    private String storeType;</span>
  83  
  84      public ImpalaTableInfo() {
  85          setType(CURR_TYPE);




















































































  86      }
  87  
  88      public Integer getAuthMech() {
  89          return authMech;
  90      }
  91  
  92      public void setAuthMech(Integer authMech) {
  93          this.authMech = authMech;
  94      }
  95  
  96      public String getKrb5FilePath() {
  97          return krb5FilePath;
  98      }
  99  
 100      public void setKrb5FilePath(String krb5FilePath) {
 101          this.krb5FilePath = krb5FilePath;
 102      }
 103  
 104      public String getPrincipal() {
 105          return principal;
 106      }
 107  
 108      public void setPrincipal(String principal) {
 109          this.principal = principal;
 110      }
 111  
 112      public String getKeyTabFilePath() {
 113          return keyTabFilePath;
 114      }
 115  
 116      public void setKeyTabFilePath(String keyTabFilePath) {
 117          this.keyTabFilePath = keyTabFilePath;
 118      }
 119  
 120      public String getKrbRealm() {
 121          return krbRealm;
 122      }
 123  
 124      public void setKrbRealm(String krbRealm) {
 125          this.krbRealm = krbRealm;
 126      }
 127  
 128      public String getKrbHostFQDN() {
 129          return krbHostFQDN;
 130      }
 131  
 132      public void setKrbHostFQDN(String krbHostFQDN) {
 133          this.krbHostFQDN = krbHostFQDN;
 134      }
 135  
 136      public String getKrbServiceName() {
 137          return krbServiceName;
 138      }
 139  
 140      public void setKrbServiceName(String krbServiceName) {
 141          this.krbServiceName = krbServiceName;
 142      }
 143  
 144      public boolean isEnablePartition() {
 145          return enablePartition;
 146      }
 147  
 148      public void setEnablePartition(boolean enablePartition) {
 149          this.enablePartition = enablePartition;
 150      }
 151  
 152      public String[] getPartitionFields() {

 153          return partitionFields;
 154      }
 155  
 156      public void setPartitionFields(String partitionFields) {
 157          this.partitionFields = StringUtils.split(partitionFields, PARTITION_FIELD_SPLIT_REGEX);














 158      }
 159  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +    public void setStoreType(String storeType) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +        this.storeType = storeType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +    public String getStoreType() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +        return storeType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +</span>
 168      @Override
 169      public boolean check() {
 170          Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);
 171          Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);
 172          Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +        Preconditions.checkNotNull(this.getStoreType(), &quot;impala field of storeType is required&quot;);</span>
 174          Integer authMech = getAuthMech();
 175  
 176          if (authMech == 1) {
 177              Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;);
 178              Preconditions.checkNotNull(this.getPrincipal(), &quot;impala field of principal is required&quot;);
 179              Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is required&quot;);
 180              Preconditions.checkNotNull(this.getKrbHostFQDN(), &quot;impala field of krbHostFQDN is required&quot;);
 181              Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is required&quot;);
 182          } else if (authMech == 2) {
 183              Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 184 -        }else if (authMech == 3) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +        } else if (authMech == 3) {</span>
 186              Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);
 187              Preconditions.checkNotNull(this.getPassword(), &quot;impala field of password is required&quot;);





 188          }
 189  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 190 -        if (isEnablePartition()) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +        if (!this.getStoreType().equalsIgnoreCase(KUDU_TYPE) &amp;&amp; isEnablePartition()) {</span>
<abbr title=" 192              Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 192              Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is ðŸ”µ</abbr>


 193          }
 194  









 195          return true;
 196      }
 197  }</pre></td>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  19 -</span>
  20  package com.dtstack.flink.sql.sink.impala.table;
  21  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  22 -import com.dtstack.flink.sql.sink.rdb.table.RdbTableInfo;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.enums.EUpdateMode;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.table.AbstractTargetTableInfo;</span>
  25  import com.google.common.base.Preconditions;
  26  import org.apache.commons.lang3.StringUtils;
  27  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +import java.util.Objects;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +</span>
  30  /**
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  31 - * Date: 2019/11/13</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  32 + * Date: 2020/10/14</span>
  33   * Company: www.dtstack.com
  34   *
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  35 - * @author xiuzhu</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 + * @author tiezhu</span>
  37   */
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  38 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  39 -public class ImpalaTableInfo extends RdbTableInfo {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  40 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  41 -    public static final String AUTHMECH_KEY = &quot;authMech&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  42 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  43 -    public static final String KRB5FILEPATH_KEY = &quot;krb5FilePath&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  44 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  45 -    public static final String PRINCIPAL_KEY = &quot;principal&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  46 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  47 -    public static final String KEYTABFILEPATH_KEY = &quot;keyTabFilePath&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  48 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  49 -    public static final String KRBREALM_KEY = &quot;krbRealm&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  50 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  51 -    public static final String KRBHOSTFQDN_KEY = &quot;krbHostFQDN&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  52 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  53 -    public static final String KRBSERVICENAME_KEY = &quot;krbServiceName&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  54 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  55 -    public static final String ENABLEPARITION_KEY = &quot;enablePartition&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  56 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  57 -    public static final String PARTITIONFIELDS_KEY = &quot;partitionFields&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  58 -</span>




<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  59 -    private static final String CURR_TYPE = &quot;impala&quot;;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  60 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  61 -    private static final String PARTITION_FIELD_SPLIT_REGEX = &quot;,&quot;;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  62 +public class ImpalaTableInfo extends AbstractTargetTableInfo {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  63 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  64 +    private static final int MAX_BATCH_SIZE = 10000;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  65 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +    private String url;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +    private String tableName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +    private String userName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  71 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +    private String password;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  73 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  74 +    private Integer batchSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  75 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +    private Long batchWaitInterval;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  77 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  78 +    private String bufferSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  79 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  80 +    private String flushIntervalMs;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  81 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  82 +    private String schema;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  83 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +    private boolean allReplace;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +    private String updateMode;</span>
  87  
  88      private Integer authMech;
  89  
  90      private String krb5FilePath;
  91  
  92      private String principal;
  93  
  94      private String keyTabFilePath;
  95  
  96      private String krbRealm;
  97  
  98      private String krbHostFQDN;
  99  
 100      private String krbServiceName;
 101  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 102 -    private boolean enablePartition;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 103 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 104 -    private String[] partitionFields;</span>





<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 105 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 106 -    public ImpalaTableInfo() {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 107 -        setType(CURR_TYPE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 108 +    private boolean enablePartition = false;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 109 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +    private String partitionFields;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 111 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 112 +    private String storeType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 114 +    public String getUrl() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 115 +        return url;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 116 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +    public void setUrl(String url) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +        this.url = url;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 120 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 122 +    public String getTableName() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        return tableName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +    public void setTableName(String tableName) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +        this.tableName = tableName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 130 +    public String getUserName() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 131 +        return userName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 132 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 133 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 134 +    public void setUserName(String userName) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 135 +        this.userName = userName;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 136 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 137 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +    public String getPassword() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 139 +        return password;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 140 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 141 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +    public void setPassword(String password) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 143 +        this.password = password;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 144 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +    public Integer getBatchSize() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +        return batchSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +    public void setBatchSize(Integer batchSize) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +        this.batchSize = batchSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +    public Long getBatchWaitInterval() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        return batchWaitInterval;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +    public void setBatchWaitInterval(Long batchWaitInterval) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +        this.batchWaitInterval = batchWaitInterval;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +    public String getBufferSize() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +        return bufferSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +    public void setBufferSize(String bufferSize) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +        this.bufferSize = bufferSize;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +    public String getFlushIntervalMs() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +        return flushIntervalMs;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +    public void setFlushIntervalMs(String flushIntervalMs) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +        this.flushIntervalMs = flushIntervalMs;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 177 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 178 +    public String getSchema() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 179 +        return schema;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 180 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 181 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 182 +    public void setSchema(String schema) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 183 +        this.schema = schema;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 184 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 185 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 186 +    public String getUpdateMode() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 187 +        return updateMode;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 189 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 190 +    public void setUpdateMode(String updateMode) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +        this.updateMode = updateMode;</span>
 192      }
 193  
 194      public Integer getAuthMech() {
 195          return authMech;
 196      }
 197  
 198      public void setAuthMech(Integer authMech) {
 199          this.authMech = authMech;
 200      }
 201  
 202      public String getKrb5FilePath() {
 203          return krb5FilePath;
 204      }
 205  
 206      public void setKrb5FilePath(String krb5FilePath) {
 207          this.krb5FilePath = krb5FilePath;
 208      }
 209  
 210      public String getPrincipal() {
 211          return principal;
 212      }
 213  
 214      public void setPrincipal(String principal) {
 215          this.principal = principal;
 216      }
 217  
 218      public String getKeyTabFilePath() {
 219          return keyTabFilePath;
 220      }
 221  
 222      public void setKeyTabFilePath(String keyTabFilePath) {
 223          this.keyTabFilePath = keyTabFilePath;
 224      }
 225  
 226      public String getKrbRealm() {
 227          return krbRealm;
 228      }
 229  
 230      public void setKrbRealm(String krbRealm) {
 231          this.krbRealm = krbRealm;
 232      }
 233  
 234      public String getKrbHostFQDN() {
 235          return krbHostFQDN;
 236      }
 237  
 238      public void setKrbHostFQDN(String krbHostFQDN) {
 239          this.krbHostFQDN = krbHostFQDN;
 240      }
 241  
 242      public String getKrbServiceName() {
 243          return krbServiceName;
 244      }
 245  
 246      public void setKrbServiceName(String krbServiceName) {
 247          this.krbServiceName = krbServiceName;
 248      }
 249  
 250      public boolean isEnablePartition() {
 251          return enablePartition;
 252      }
 253  
 254      public void setEnablePartition(boolean enablePartition) {
 255          this.enablePartition = enablePartition;
 256      }
 257  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 258 -    public String[] getPartitionFields() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 259 +    public String getPartitionFields() {</span>
 260          return partitionFields;
 261      }
 262  
 263      public void setPartitionFields(String partitionFields) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 264 -        this.partitionFields = StringUtils.split(partitionFields, PARTITION_FIELD_SPLIT_REGEX);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 265 +        this.partitionFields = partitionFields;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 266 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 267 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 268 +    public String getStoreType() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 269 +        return storeType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 270 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 271 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 272 +    public void setStoreType(String storeType) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 273 +        this.storeType = storeType;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 274 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 275 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 276 +    @Override</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 277 +    public String getType() {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 278 +        return super.getType().toLowerCase();</span>
 279      }
 280  








 281      @Override
 282      public boolean check() {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 283 -        Preconditions.checkNotNull(this.getUrl(), &quot;impala field of url is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 284 -        Preconditions.checkNotNull(this.getTableName(), &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 285 -        Preconditions.checkNotNull(this.getAuthMech(), &quot;impala field of authMech is required&quot;);</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 286 -        Integer authMech = getAuthMech();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 287 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 288 -        if (authMech == 1) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 289 -            Preconditions.checkNotNull(this.getKrb5FilePath(), &quot;impala field of krb5FilePath is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 290 -            Preconditions.checkNotNull(this.getPrincipal(), &quot;impala field of principal is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 291 -            Preconditions.checkNotNull(this.getKeyTabFilePath(), &quot;impala field of keyTabFilePath is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 292 -            Preconditions.checkNotNull(this.getKrbHostFQDN(), &quot;impala field of krbHostFQDN is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 293 -            Preconditions.checkNotNull(this.getKrbServiceName(), &quot;impala field of krbServiceName is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 294 -        } else if (authMech == 2) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 295 -            Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 296 -        }else if (authMech == 3) {</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 297 -            Preconditions.checkNotNull(this.getUserName(), &quot;impala field of userName is required&quot;);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 298 -            Preconditions.checkNotNull(this.getPassword(), &quot;impala field of password is required&quot;);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 299 +        Preconditions.checkNotNull(url, &quot;impala field of URL is required&quot;);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 300 +        Preconditions.checkNotNull(tableName, &quot;impala field of tableName is required&quot;);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 301 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 302 +        if (Objects.nonNull(batchSize)) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 303 +            Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAX_BATCH_SIZE);"> 303 +            Preconditions.checkArgument(batchSize &lt;= MAX_BATCH_SIZE, &quot;batchSize must be less than &quot; + MAX_BATCH_SIðŸ”µ</abbr></span>
 304          }
 305  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 306 -        if (isEnablePartition()) {</span>

<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"><abbr title=" 307 -            Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is required&quot;);"> 307 -            Preconditions.checkArgument(this.getPartitionFields().length &gt; 0, &quot;impala field of partitionFields is ðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 308 +        if (StringUtils.equalsIgnoreCase(updateMode, EUpdateMode.UPSERT.name())) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 309 +            Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0, &quot;updateMode mode primary is required&quot;);"> 309 +            Preconditions.checkArgument(Objects.nonNull(getPrimaryKeys()) &amp;&amp; getPrimaryKeys().size() &gt; 0, &quot;updateMðŸ”µ</abbr></span>
 310          }
 311  
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +        if (Objects.nonNull(getPrimaryKeys())) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 313 +            getPrimaryKeys().forEach(pk -&gt; {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 314 +                Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not found in sink table field&quot;);"> 314 +                Preconditions.checkArgument(getFieldList().contains(pk), &quot;primary key &quot; + pk + &quot; not found in sinkðŸ”µ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 315 +            });</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 316 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 317 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 318 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 319 +        Preconditions.checkArgument(getFieldList().size() == getFieldExtraInfoList().size(),</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 320 +                &quot;fields and fieldExtraInfoList attributes must be the same length&quot;);</span>
 321          return true;
 322      }
 323  }</pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            