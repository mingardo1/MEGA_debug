<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>441</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    441
                    <a href="440.html">prev</a>
                    <a href="442.html">next</a>
                    <a href="441_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_b63656500d9b073f921794c2cc40b27527832032_rdb/rdb-sink/src/main/java/com/dtstack/flink/sql/sink/rdb/format/RetractJDBCOutputFormat.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b63656500d9b073f921794c2cc40b27527832032:rdb/rdb-sink/src/main/java/com/dtstack/flink/sql/sink/rdb/format/RetractJDBCOutputFormat.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b63656500d9b073f921794c2cc40b27527832032^1:rdb/rdb-sink/src/main/java/com/dtstack/flink/sql/sink/rdb/format/RetractJDBCOutputFormat.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;b63656500d9b073f921794c2cc40b27527832032^2:rdb/rdb-sink/src/main/java/com/dtstack/flink/sql/sink/rdb/format/RetractJDBCOutputFormat.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;260ddcdf26b6c427016a191901ba6a9a4541a426:rdb/rdb-sink/src/main/java/com/dtstack/flink/sql/sink/rdb/format/RetractJDBCOutputFormat.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bsj]], subset: [[bsj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">   2 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.sink.rdb.format;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import com.google.common.collect.Maps;                                                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import java.io.IOException;                                                                              </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import java.sql.SQLException;                                                                            </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import java.util.Map;                                                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 /**                                                                                                      </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48  * OutputFormat to write tuples into a database.                                                         </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49  * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51  */                                                                                                      </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                        </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54                                                                                                          </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55     private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56                                                                                                          </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57     private String username;                                                                             </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58     private String password;                                                                             </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59     private String drivername;                                                                           </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60     private String dbURL;                                                                                </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61     private String tableName;                                                                            </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62     private String dbType;                                                                               </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63     private String schema;                                                                               </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64     private RdbSink dbSink;                                                                              </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65     // trigger preparedStatement execute batch interval                                                  </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66     private long batchWaitInterval = 10000l;                                                             </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67     // PreparedStatement execute batch num                                                               </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68     private int batchNum = 100;                                                                          </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69     private String insertQuery;                                                                          </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70     public int[] typesArray;                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71                                                                                                          </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72     /** 存储用于批量写入的数据 */                                                                                   </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73     protected List&lt;Row&gt; rows = new ArrayList();                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74                                                                                                          </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75     private Connection dbConn;                                                                           </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76     private PreparedStatement upload;                                                                    </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77     private transient ScheduledThreadPoolExecutor timerService;                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80     //index field                                                                                        </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81     private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                   </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82     //full field                                                                                         </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83     private List&lt;String&gt; fullField = Lists.newArrayList();                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84                                                                                                          </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85     public RetractJDBCOutputFormat() {                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92     /**                                                                                                  </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93      * Connects to the target database and initializes the prepared statement.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94      *                                                                                                   </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95      * @param taskNumber The number of the parallel instance.                                            </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96      * @throws IOException Thrown, if the output could not be opened due to an                           </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97      *                     I/O problem.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101         try {                                                                                            </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102             LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                             </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103             dbConn = establishConnection();                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104             initMetric();                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105                                                                                                          </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106             if (existTabname()) {                                                                        </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107                 if (isReplaceInsertQuery()) {                                                            </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 108                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 108                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getField🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                 }                                                                                        </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111             } else {                                                                                     </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                 throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                                                                                                          </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115             if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                 </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116                 LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117                                                                                                          </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118                 timerService = new ScheduledThreadPoolExecutor(1);                                       </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119                 timerService.scheduleAtFixedRate(() -&gt; {                                                 </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120                     submitExecuteBatch();                                                                </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                 }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124                                                                                                          </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125         } catch (SQLException sqe) {                                                                     </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126             LOG.error(&quot;&quot;, sqe);                                                                          </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127             throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                   </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128         } catch (ClassNotFoundException cnfe) {                                                          </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129             LOG.error(&quot;&quot;, cnfe);                                                                         </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130             throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134                                                                                                          </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135     public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {   </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136         Connection connection ;                                                                          </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         JDBCUtils.forName(drivername, getClass().getClassLoader());                                      </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         if (username == null) {                                                                          </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139             connection = DriverManager.getConnection(dbURL);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         } else {                                                                                         </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141             connection = DriverManager.getConnection(dbURL, username, password);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142         }                                                                                                </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         connection.setAutoCommit(false);                                                                 </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         return connection;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147     /**                                                                                                  </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148      * Adds a record to the prepared statement.                                                          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149      * &lt;p&gt;                                                                                               </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150      * When this method is called, the output format is guaranteed to be opened.                         </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151      * &lt;/p&gt;                                                                                              </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152      * &lt;p&gt;                                                                                               </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 153      * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 153      * WARNING: this may fail when no column types specified (because a best effort approach is attempted🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 154      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 154      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObje🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155      *                                                                                                   </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156      * @param tuple2 The records to add to the output.                                                   </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157      * @throws IOException Thrown, if the records could not be added due to an I/O problem.              </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158      * @see PreparedStatement                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     @Override                                                                                            </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161     public void writeRecord(Tuple2 tuple2)  {                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162                                                                                                          </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                        </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164         Boolean retract = tupleTrans.getField(0);                                                        </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         Row row = tupleTrans.getField(1);                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {        </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 168             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);"> 168             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                                                                                                          </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         if (retract) {                                                                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172                                                                                                          </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173             if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                      </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                 LOG.info(&quot;Receive data : {}&quot;, row);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176                                                                                                          </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177             outRecords.inc();                                                                            </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178             insertWrite(row);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179         } else {                                                                                         </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180             //do nothing                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                                                                                                          </span>
<span class="-4476666207180013827" onmouseenter="enter('-4476666207180013827');" onmouseout="out('-4476666207180013827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185     private void insertWrite(Row row) {                                                                  </span>
<span class="-1086395285886649574" onmouseenter="enter('-1086395285886649574');" onmouseout="out('-1086395285886649574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186         checkConnectionOpen(dbConn);                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187         try {                                                                                            </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188             if (batchNum == 1) {                                                                         </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                 writeSingleRecord(row);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190             } else {                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                 updatePreparedStmt(row, upload);                                                         </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                 rows.add(row);                                                                           </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 upload.addBatch();                                                                       </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                 if (rows.size() &gt;= batchNum) {                                                           </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                     submitExecuteBatch();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         } catch (SQLException e) {                                                                       </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 201                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 201                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203             } else {                                                                                     </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                                                                                                          </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212     private void writeSingleRecord(Row row) {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213         try {                                                                                            </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214             updatePreparedStmt(row, upload);                                                             </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             upload.executeUpdate();                                                                      </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217         } catch (SQLException e) {                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                                                                                                          </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 220                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 220                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223                                                                                                          </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224             outDirtyRecords.inc();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227                                                                                                          </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228     private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {              </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229         if (typesArray == null) {                                                                        </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230             // no types provided                                                                         </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 232                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 232                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;,🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                 pstmt.setObject(index + 1, row.getField(index));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235         } else {                                                                                         </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236             // types provided                                                                            </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238                                                                                                          </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239                 if (row.getField(index) == null) {                                                       </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240                     pstmt.setNull(index + 1, typesArray[index]);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241                 } else {                                                                                 </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 242                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 242                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                     switch (typesArray[index]) {                                                         </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                         case java.sql.Types.NULL:                                                        </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                             pstmt.setNull(index + 1, typesArray[index]);                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                             break;                                                                       </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                         case java.sql.Types.BOOLEAN:                                                     </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                         case java.sql.Types.BIT:                                                         </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                             pstmt.setBoolean(index + 1, (boolean) row.getField(index));                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                             break;                                                                       </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                         case java.sql.Types.CHAR:                                                        </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                         case java.sql.Types.NCHAR:                                                       </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                         case java.sql.Types.VARCHAR:                                                     </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                         case java.sql.Types.LONGVARCHAR:                                                 </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                         case java.sql.Types.LONGNVARCHAR:                                                </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                             pstmt.setString(index + 1, (String) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                             break;                                                                       </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                         case java.sql.Types.TINYINT:                                                     </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                             pstmt.setByte(index + 1, (byte) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                             break;                                                                       </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                         case java.sql.Types.SMALLINT:                                                    </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                             pstmt.setShort(index + 1, (short) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                             break;                                                                       </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                         case java.sql.Types.INTEGER:                                                     </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                             pstmt.setInt(index + 1, (int) row.getField(index));                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                             break;                                                                       </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                         case java.sql.Types.BIGINT:                                                      </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                             pstmt.setLong(index + 1, (long) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                             break;                                                                       </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270                         case java.sql.Types.REAL:                                                        </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                         case java.sql.Types.FLOAT:                                                       </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272                             pstmt.setFloat(index + 1, (float) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                             break;                                                                       </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                         case java.sql.Types.DOUBLE:                                                      </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                             pstmt.setDouble(index + 1, (double) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                             break;                                                                       </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277                         case java.sql.Types.DECIMAL:                                                     </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                         case java.sql.Types.NUMERIC:                                                     </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                             pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                             break;                                                                       </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                         case java.sql.Types.DATE:                                                        </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                             pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                             break;                                                                       </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                         case java.sql.Types.TIME:                                                        </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                             pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                             break;                                                                       </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                         case java.sql.Types.TIMESTAMP:                                                   </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                             pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                             break;                                                                       </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                         case java.sql.Types.BINARY:                                                      </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                         case java.sql.Types.VARBINARY:                                                   </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                         case java.sql.Types.LONGVARBINARY:                                               </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                             pstmt.setBytes(index + 1, (byte[]) row.getField(index));                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294                             break;                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                         default:                                                                         </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296                             pstmt.setObject(index + 1, row.getField(index));                             </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 297                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 297                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set 🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298                                     typesArray[index], index + 1, row.getField(index));                  </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299                             // case java.sql.Types.SQLXML                                                </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300                             // case java.sql.Types.ARRAY:                                                </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                             // case java.sql.Types.JAVA_OBJECT:                                          </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302                             // case java.sql.Types.BLOB:                                                 </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                             // case java.sql.Types.CLOB:                                                 </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                             // case java.sql.Types.NCLOB:                                                </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                             // case java.sql.Types.DATALINK:                                             </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                             // case java.sql.Types.DISTINCT:                                             </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                             // case java.sql.Types.OTHER:                                                </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                             // case java.sql.Types.REF:                                                  </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                             // case java.sql.Types.ROWID:                                                </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310                             // case java.sql.Types.STRUC                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317                                                                                                          </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318     private synchronized void submitExecuteBatch() {                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319         try {                                                                                            </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320             this.upload.executeBatch();                                                                  </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322         } catch (SQLException e) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323             try {                                                                                        </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324                 dbConn.rollback();                                                                       </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325             } catch (SQLException e1) {                                                                  </span>
<span class="-7536698771404360230" onmouseenter="enter('-7536698771404360230');" onmouseout="out('-7536698771404360230');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                 LOG.error(&quot;rollback  data error !&quot;, e);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328                                                                                                          </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329             rows.forEach(this::writeSingleRecord);                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330         } finally {                                                                                      </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334                                                                                                          </span>
<span class="-3522961204041572073" onmouseenter="enter('-3522961204041572073');" onmouseout="out('-3522961204041572073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335     private void checkConnectionOpen(Connection dbConn) {                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336         try {                                                                                            </span>
<span class="-2855961023100454886" onmouseenter="enter('-2855961023100454886');" onmouseout="out('-2855961023100454886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337             if (dbConn.isClosed()) {                                                                     </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338                 LOG.info(&quot;db connection reconnect..&quot;);                                                   </span>
<span class="-4293595830544602858" onmouseenter="enter('-4293595830544602858');" onmouseout="out('-4293595830544602858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339                 dbConn= establishConnection();                                                           </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341                 this.dbConn = dbConn;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343         } catch (SQLException e) {                                                                       </span>
<span class="814403640845951473" onmouseenter="enter('814403640845951473');" onmouseout="out('814403640845951473');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344             LOG.error(&quot;check connection open failed..&quot;, e);                                              </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345         } catch (ClassNotFoundException e) {                                                             </span>
<span class="1123805251307592465" onmouseenter="enter('1123805251307592465');" onmouseout="out('1123805251307592465');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346             LOG.error(&quot;load jdbc class error when reconnect db..&quot;, e);                                   </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347         } catch (IOException e) {                                                                        </span>
<span class="-720388217547677793" onmouseenter="enter('-720388217547677793');" onmouseout="out('-720388217547677793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348             LOG.error(&quot;kerberos authentication failed..&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352     /**                                                                                                  </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353      * Executes prepared statement and closes all resources of this instance.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354      *                                                                                                   </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355      * @throws IOException Thrown, if the input could not be closed properly.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358     public void close() throws IOException {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359         try {                                                                                            </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360             if (upload != null) {                                                                        </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361                 upload.executeBatch();                                                                   </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362                 upload.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363             }                                                                                            </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364             if (null != timerService) {                                                                  </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365                 timerService.shutdown();                                                                 </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366                 LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 369             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 370         } finally {                                                                                      </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 371             upload = null;                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 372             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 375         try {                                                                                            </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 376             if (dbConn != null) {                                                                        </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 377                 dbConn.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 378             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 379         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 380             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 381         } finally {                                                                                      </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 382             dbConn = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 383         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 384     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 385                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 386                                                                                                          </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 387     public boolean isReplaceInsertQuery() throws SQLException {                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 388         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 389     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 390                                                                                                          </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 391     public void verifyField() {                                                                          </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 392         if (StringUtils.isBlank(username)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 393             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 394         }                                                                                                </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 395         if (StringUtils.isBlank(password)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 396             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 397         }                                                                                                </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 398         if (StringUtils.isBlank(dbURL)) {                                                                </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 399             throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 400         }                                                                                                </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 401         if (StringUtils.isBlank(insertQuery)) {                                                          </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 402             throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 403         }                                                                                                </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 404         if (StringUtils.isBlank(drivername)) {                                                           </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 405             throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 406         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 407     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 408                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 409                                                                                                          </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 410     public void setUsername(String username) {                                                           </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 411         this.username = username;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 412     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 413                                                                                                          </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 414     public String getSchema() {                                                                          </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 415         if (StringUtils.isNotEmpty(schema)) {                                                            </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 416             return schema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 417         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 418         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 419     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 420                                                                                                          </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 421     public void setSchema(String schema) {                                                               </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422         this.schema = schema;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424                                                                                                          </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425     public boolean existTabname() throws SQLException {                                                  </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426         return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 427     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 428                                                                                                          </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429     public void setPassword(String password) {                                                           </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430         this.password = password;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432                                                                                                          </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433     public void setDrivername(String drivername) {                                                       </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434         this.drivername = drivername;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436                                                                                                          </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437     public String getDrivername() {                                                                      </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438         return this.drivername;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440                                                                                                          </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441     public void setDbURL(String dbURL) {                                                                 </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442         this.dbURL = dbURL;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444                                                                                                          </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445     public void setTableName(String tableName) {                                                         </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446         this.tableName = tableName;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448                                                                                                          </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449     public void setDbType(String dbType) {                                                               </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450         this.dbType = dbType;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452                                                                                                          </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453     public void setDbSink(RdbSink dbSink) {                                                              </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454         this.dbSink = dbSink;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456                                                                                                          </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457     public void setBatchNum(int batchNum) {                                                              </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458         this.batchNum = batchNum;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460                                                                                                          </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461     public void setInsertQuery(String insertQuery) {                                                     </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462         this.insertQuery = insertQuery;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464                                                                                                          </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465     public void setTypesArray(int[] typesArray) {                                                        </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466         this.typesArray = typesArray;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468                                                                                                          </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469     public String getDbType() {                                                                          </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470         return dbType;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472                                                                                                          </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473     public RdbSink getDbSink() {                                                                         </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474         return dbSink;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476                                                                                                          </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477     public Connection getDbConn() {                                                                      </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478         return dbConn;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480                                                                                                          </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481     public String getTableName() {                                                                       </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482         return tableName;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484                                                                                                          </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485     public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                     </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486         this.realIndexes.put(index, fieldes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488                                                                                                          </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489     public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                   </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490         return realIndexes;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 493                                                                                                          </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 494     public void setBatchWaitInterval(long batchWaitInterval) {                                           </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495         this.batchWaitInterval = batchWaitInterval;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497                                                                                                          </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498     public List&lt;String&gt; getFullField() {                                                                 </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499         return fullField;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501                                                                                                          </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 502     public void fullFieldAdd(String colName) {                                                           </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503         this.fullField.add(colName);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 506 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524                                                                                                          </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525 package com.dtstack.flink.sql.sink.rdb.format;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526                                                                                                          </span>
<span class="-3311622777804768870" onmouseenter="enter('-3311622777804768870');" onmouseout="out('-3311622777804768870');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527 import com.dtstack.flink.sql.enums.EConnectionErrorCode;                                                 </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534 import com.google.common.collect.Maps;                                                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538 import java.io.IOException;                                                                              </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542 import java.sql.SQLException;                                                                            </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546 import java.util.Map;                                                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549                                                                                                          </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550 import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552 /**                                                                                                      </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553  * OutputFormat to write tuples into a database.                                                         </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554  * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556  */                                                                                                      </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557 public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                        </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559                                                                                                          </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560     private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);            </span>
<span class="-5647401529104718799" onmouseenter="enter('-5647401529104718799');" onmouseout="out('-5647401529104718799');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561     private static final int CONNECTION_CHECK_FREQUENCY = 100;                                           </span>
<span class="4613588471810503867" onmouseenter="enter('4613588471810503867');" onmouseout="out('4613588471810503867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562     private int checkTimes;                                                                              </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563     private String username;                                                                             </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564     private String password;                                                                             </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565     private String drivername;                                                                           </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566     private String dbURL;                                                                                </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567     private String tableName;                                                                            </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568     private String dbType;                                                                               </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569     private String schema;                                                                               </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570     private RdbSink dbSink;                                                                              </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571     // trigger preparedStatement execute batch interval                                                  </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572     private long batchWaitInterval = 10000l;                                                             </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573     // PreparedStatement execute batch num                                                               </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574     private int batchNum = 100;                                                                          </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575     private String insertQuery;                                                                          </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576     public int[] typesArray;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577                                                                                                          </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578     /** 存储用于批量写入的数据 */                                                                                   </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579     protected List&lt;Row&gt; rows = new ArrayList();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580                                                                                                          </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581     private Connection dbConn;                                                                           </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582     private PreparedStatement upload;                                                                    </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583     private transient ScheduledThreadPoolExecutor timerService;                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585                                                                                                          </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586     //index field                                                                                        </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587     private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                   </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588     //full field                                                                                         </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589     private List&lt;String&gt; fullField = Lists.newArrayList();                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590                                                                                                          </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591     public RetractJDBCOutputFormat() {                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598     /**                                                                                                  </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599      * Connects to the target database and initializes the prepared statement.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600      *                                                                                                   </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601      * @param taskNumber The number of the parallel instance.                                            </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602      * @throws IOException Thrown, if the output could not be opened due to an                           </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603      *                     I/O problem.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 606     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607         try {                                                                                            </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608             LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                             </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609             dbConn = establishConnection();                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610             initMetric();                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611                                                                                                          </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612             if (existTabname()) {                                                                        </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613                 if (isReplaceInsertQuery()) {                                                            </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 614                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 614                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getField🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615                 }                                                                                        </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617             } else {                                                                                     </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618                 throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620                                                                                                          </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621             if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                 </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622                 LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623                                                                                                          </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624                 timerService = new ScheduledThreadPoolExecutor(1);                                       </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625                 timerService.scheduleAtFixedRate(() -&gt; {                                                 </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626                     submitExecuteBatch();                                                                </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627                 }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630                                                                                                          </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631         } catch (SQLException sqe) {                                                                     </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632             LOG.error(&quot;&quot;, sqe);                                                                          </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633             throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                   </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634         } catch (ClassNotFoundException cnfe) {                                                          </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635             LOG.error(&quot;&quot;, cnfe);                                                                         </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636             throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640                                                                                                          </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641     public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {   </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642         Connection connection ;                                                                          </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643         JDBCUtils.forName(drivername, getClass().getClassLoader());                                      </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644         if (username == null) {                                                                          </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645             connection = DriverManager.getConnection(dbURL);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646         } else {                                                                                         </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647             connection = DriverManager.getConnection(dbURL, username, password);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648         }                                                                                                </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649         connection.setAutoCommit(false);                                                                 </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650         return connection;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653     /**                                                                                                  </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654      * Adds a record to the prepared statement.                                                          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655      * &lt;p&gt;                                                                                               </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656      * When this method is called, the output format is guaranteed to be opened.                         </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657      * &lt;/p&gt;                                                                                              </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658      * &lt;p&gt;                                                                                               </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 659      * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 659      * WARNING: this may fail when no column types specified (because a best effort approach is attempted🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 660      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 660      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObje🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661      *                                                                                                   </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662      * @param tuple2 The records to add to the output.                                                   </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663      * @throws IOException Thrown, if the records could not be added due to an I/O problem.              </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664      * @see PreparedStatement                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666     @Override                                                                                            </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667     public void writeRecord(Tuple2 tuple2)  {                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668                                                                                                          </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669         Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                        </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670         Boolean retract = tupleTrans.getField(0);                                                        </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671         Row row = tupleTrans.getField(1);                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672                                                                                                          </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673         if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {        </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 674             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);"> 674             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                                                                                                          </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677         if (retract) {                                                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678                                                                                                          </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679             if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                      </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680                 LOG.info(&quot;Receive data : {}&quot;, row);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682                                                                                                          </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683             outRecords.inc();                                                                            </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684             insertWrite(row);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685         } else {                                                                                         </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686             //do nothing                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690                                                                                                          </span>
<span class="2080741281463881552" onmouseenter="enter('2080741281463881552');" onmouseout="out('2080741281463881552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691     private void insertWrite(Row row)  {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692         try {                                                                                            </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693             if (batchNum == 1) {                                                                         </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694                 writeSingleRecord(row);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695             } else {                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696                 updatePreparedStmt(row, upload);                                                         </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697                 rows.add(row);                                                                           </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                 upload.addBatch();                                                                       </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699                 if (rows.size() &gt;= batchNum) {                                                           </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                     submitExecuteBatch();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703         } catch (SQLException e) {                                                                       </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 706                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 706                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708             } else {                                                                                     </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714                                                                                                          </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715     private void writeSingleRecord(Row row) {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716         try {                                                                                            </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717             updatePreparedStmt(row, upload);                                                             </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718             upload.executeUpdate();                                                                      </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720         } catch (SQLException e) {                                                                       </span>
<span class="-6799605853464900245" onmouseenter="enter('-6799605853464900245');" onmouseout="out('-6799605853464900245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721             dealSQLException(e);                                                                         </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 723                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 723                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726                                                                                                          </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727             outDirtyRecords.inc();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                                                                                                          </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731     private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {              </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732         if (typesArray == null) {                                                                        </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733             // no types provided                                                                         </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 735                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 735                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;,🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736                 pstmt.setObject(index + 1, row.getField(index));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738         } else {                                                                                         </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739             // types provided                                                                            </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741                                                                                                          </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742                 if (row.getField(index) == null) {                                                       </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743                     pstmt.setNull(index + 1, typesArray[index]);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744                 } else {                                                                                 </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 745                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 745                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746                     switch (typesArray[index]) {                                                         </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                         case java.sql.Types.NULL:                                                        </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748                             pstmt.setNull(index + 1, typesArray[index]);                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749                             break;                                                                       </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750                         case java.sql.Types.BOOLEAN:                                                     </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                         case java.sql.Types.BIT:                                                         </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752                             pstmt.setBoolean(index + 1, (boolean) row.getField(index));                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753                             break;                                                                       </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 754                         case java.sql.Types.CHAR:                                                        </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 755                         case java.sql.Types.NCHAR:                                                       </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 756                         case java.sql.Types.VARCHAR:                                                     </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 757                         case java.sql.Types.LONGVARCHAR:                                                 </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 758                         case java.sql.Types.LONGNVARCHAR:                                                </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 759                             pstmt.setString(index + 1, (String) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 760                             break;                                                                       </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 761                         case java.sql.Types.TINYINT:                                                     </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 762                             pstmt.setByte(index + 1, (byte) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 763                             break;                                                                       </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 764                         case java.sql.Types.SMALLINT:                                                    </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 765                             pstmt.setShort(index + 1, (short) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 766                             break;                                                                       </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 767                         case java.sql.Types.INTEGER:                                                     </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 768                             pstmt.setInt(index + 1, (int) row.getField(index));                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 769                             break;                                                                       </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 770                         case java.sql.Types.BIGINT:                                                      </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 771                             pstmt.setLong(index + 1, (long) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772                             break;                                                                       </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 773                         case java.sql.Types.REAL:                                                        </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774                         case java.sql.Types.FLOAT:                                                       </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775                             pstmt.setFloat(index + 1, (float) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776                             break;                                                                       </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 777                         case java.sql.Types.DOUBLE:                                                      </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778                             pstmt.setDouble(index + 1, (double) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779                             break;                                                                       </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 780                         case java.sql.Types.DECIMAL:                                                     </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 781                         case java.sql.Types.NUMERIC:                                                     </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 782                             pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 783                             break;                                                                       </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 784                         case java.sql.Types.DATE:                                                        </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 785                             pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 786                             break;                                                                       </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 787                         case java.sql.Types.TIME:                                                        </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 788                             pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 789                             break;                                                                       </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 790                         case java.sql.Types.TIMESTAMP:                                                   </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 791                             pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792                             break;                                                                       </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793                         case java.sql.Types.BINARY:                                                      </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794                         case java.sql.Types.VARBINARY:                                                   </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 795                         case java.sql.Types.LONGVARBINARY:                                               </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 796                             pstmt.setBytes(index + 1, (byte[]) row.getField(index));                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 797                             break;                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 798                         default:                                                                         </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 799                             pstmt.setObject(index + 1, row.getField(index));                             </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 800                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 800                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set 🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 801                                     typesArray[index], index + 1, row.getField(index));                  </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 802                             // case java.sql.Types.SQLXML                                                </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 803                             // case java.sql.Types.ARRAY:                                                </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 804                             // case java.sql.Types.JAVA_OBJECT:                                          </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 805                             // case java.sql.Types.BLOB:                                                 </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 806                             // case java.sql.Types.CLOB:                                                 </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 807                             // case java.sql.Types.NCLOB:                                                </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 808                             // case java.sql.Types.DATALINK:                                             </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 809                             // case java.sql.Types.DISTINCT:                                             </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 810                             // case java.sql.Types.OTHER:                                                </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 811                             // case java.sql.Types.REF:                                                  </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 812                             // case java.sql.Types.ROWID:                                                </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 813                             // case java.sql.Types.STRUC                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 814                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 815                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 816             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 817         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 818     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 819                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 820                                                                                                          </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821     private synchronized void submitExecuteBatch() {                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 822         try {                                                                                            </span>
<span class="6813843412968272702" onmouseenter="enter('6813843412968272702');" onmouseout="out('6813843412968272702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 823             regularlyCheckConnection();                                                                  </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 824             this.upload.executeBatch();                                                                  </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 825             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826         } catch (SQLException e) {                                                                       </span>
<span class="-9174161656279899685" onmouseenter="enter('-9174161656279899685');" onmouseout="out('-9174161656279899685');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827             LOG.warn(&quot;submitExecuteBatch error {}&quot;, e);                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828             try {                                                                                        </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829                 dbConn.rollback();                                                                       </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 830             } catch (SQLException e1) {                                                                  </span>
<span class="246786700485249677" onmouseenter="enter('246786700485249677');" onmouseout="out('246786700485249677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 831                 dealSQLException(e1);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 832             }                                                                                            </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 833             rows.forEach(this::writeSingleRecord);                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 834         } finally {                                                                                      </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 835             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 836         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 837     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 838                                                                                                          </span>
<span class="-3874353238638658215" onmouseenter="enter('-3874353238638658215');" onmouseout="out('-3874353238638658215');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 839     private void dealSQLException(Exception e) {                                                         </span>
<span class="6407700796198700478" onmouseenter="enter('6407700796198700478');" onmouseout="out('6407700796198700478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 840         EConnectionErrorCode errorCode = EConnectionErrorCode.resolveErrorCodeFromException(e);          </span>
<span class="-3680639726838673504" onmouseenter="enter('-3680639726838673504');" onmouseout="out('-3680639726838673504');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 841         switch (errorCode) {                                                                             </span>
<span class="1225374239746753698" onmouseenter="enter('1225374239746753698');" onmouseout="out('1225374239746753698');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 842             case CONN_DB_INVALID:                                                                        </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 843                 reconnection();                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 844                 break;                                                                                   </span>
<span class="1755343140467316574" onmouseenter="enter('1755343140467316574');" onmouseout="out('1755343140467316574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 845             case CONN_DB_FAILED:                                                                         </span>
<span class="-1198874643364045165" onmouseenter="enter('-1198874643364045165');" onmouseout="out('-1198874643364045165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 846             case DB_TABLE_NOT_EXIST:                                                                     </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 847                 throw new RuntimeException(e);                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 848             default:                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 849         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 850     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 851                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 852                                                                                                          </span>
<span class="-1258602931071673845" onmouseenter="enter('-1258602931071673845');" onmouseout="out('-1258602931071673845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 853     private void regularlyCheckConnection() throws SQLException {                                        </span>
<span class="-1222192591979868781" onmouseenter="enter('-1222192591979868781');" onmouseout="out('-1222192591979868781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 854         checkTimes++;                                                                                    </span>
<span class="-5151471990775264393" onmouseenter="enter('-5151471990775264393');" onmouseout="out('-5151471990775264393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 855         if (checkTimes % CONNECTION_CHECK_FREQUENCY != 0) {                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 856             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 857         }                                                                                                </span>
<span class="5795923628795732420" onmouseenter="enter('5795923628795732420');" onmouseout="out('5795923628795732420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 858         LOG.warn(&quot;db connection Valid check !&quot;);                                                         </span>
<span class="8215065968495159984" onmouseenter="enter('8215065968495159984');" onmouseout="out('8215065968495159984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 859         if (dbConn.isClosed() || !dbConn.isValid(100)) {                                                 </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 860             reconnection();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 861         }                                                                                                </span>
<span class="-8215063589164597765" onmouseenter="enter('-8215063589164597765');" onmouseout="out('-8215063589164597765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 862         checkTimes = 0;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 863     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 864                                                                                                          </span>
<span class="-5737401042898679127" onmouseenter="enter('-5737401042898679127');" onmouseout="out('-5737401042898679127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 865     public void reconnection() throws RuntimeException {                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 866         try {                                                                                            </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 867             LOG.info(&quot;db connection reconnect..&quot;);                                                       </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 868             dbConn = establishConnection();                                                              </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 869             upload = dbConn.prepareStatement(insertQuery);                                               </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 870             this.dbConn = dbConn;                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 871         } catch (Exception e) {                                                                          </span>
<span class="5310062978023364230" onmouseenter="enter('5310062978023364230');" onmouseout="out('5310062978023364230');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 872             throw new RuntimeException(&quot;connection open failed..&quot;, e);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 873         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 874     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 875                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 876     /**                                                                                                  </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 877      * Executes prepared statement and closes all resources of this instance.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 878      *                                                                                                   </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 879      * @throws IOException Thrown, if the input could not be closed properly.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 880      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 881     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 882     public void close() throws IOException {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 883         try {                                                                                            </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 884             if (upload != null) {                                                                        </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 885                 upload.executeBatch();                                                                   </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 886                 upload.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 887             }                                                                                            </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 888             if (null != timerService) {                                                                  </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 889                 timerService.shutdown();                                                                 </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 890                 LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 891             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 892         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 893             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 894         } finally {                                                                                      </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 895             upload = null;                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 896             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 897         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 898                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 899         try {                                                                                            </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 900             if (dbConn != null) {                                                                        </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 901                 dbConn.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 902             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 903         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 904             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 905         } finally {                                                                                      </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 906             dbConn = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 907         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 908     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 909                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 910                                                                                                          </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 911     public boolean isReplaceInsertQuery() throws SQLException {                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 912         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 913     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 914                                                                                                          </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 915     public void verifyField() {                                                                          </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 916         if (StringUtils.isBlank(username)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 917             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 918         }                                                                                                </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 919         if (StringUtils.isBlank(password)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 920             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 921         }                                                                                                </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 922         if (StringUtils.isBlank(dbURL)) {                                                                </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 923             throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 924         }                                                                                                </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 925         if (StringUtils.isBlank(insertQuery)) {                                                          </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 926             throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 927         }                                                                                                </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 928         if (StringUtils.isBlank(drivername)) {                                                           </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 929             throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 930         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 931     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 932                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 933                                                                                                          </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 934     public void setUsername(String username) {                                                           </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 935         this.username = username;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 936     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 937                                                                                                          </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 938     public String getSchema() {                                                                          </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 939         if (StringUtils.isNotEmpty(schema)) {                                                            </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 940             return schema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 941         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 942         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 943     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 944                                                                                                          </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 945     public void setSchema(String schema) {                                                               </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 946         this.schema = schema;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 947     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 948                                                                                                          </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 949     public boolean existTabname() throws SQLException {                                                  </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 950         return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 951     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 952                                                                                                          </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 953     public void setPassword(String password) {                                                           </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 954         this.password = password;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 955     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 956                                                                                                          </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 957     public void setDrivername(String drivername) {                                                       </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 958         this.drivername = drivername;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 959     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 960                                                                                                          </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 961     public String getDrivername() {                                                                      </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 962         return this.drivername;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 963     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 964                                                                                                          </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 965     public void setDbURL(String dbURL) {                                                                 </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 966         this.dbURL = dbURL;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 967     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 968                                                                                                          </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 969     public void setTableName(String tableName) {                                                         </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 970         this.tableName = tableName;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 971     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 972                                                                                                          </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 973     public void setDbType(String dbType) {                                                               </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 974         this.dbType = dbType;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 975     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 976                                                                                                          </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 977     public void setDbSink(RdbSink dbSink) {                                                              </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 978         this.dbSink = dbSink;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 979     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 980                                                                                                          </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 981     public void setBatchNum(int batchNum) {                                                              </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 982         this.batchNum = batchNum;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 983     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 984                                                                                                          </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 985     public void setInsertQuery(String insertQuery) {                                                     </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 986         this.insertQuery = insertQuery;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 987     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 988                                                                                                          </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 989     public void setTypesArray(int[] typesArray) {                                                        </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 990         this.typesArray = typesArray;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 991     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 992                                                                                                          </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 993     public String getDbType() {                                                                          </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 994         return dbType;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 995     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 996                                                                                                          </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 997     public RdbSink getDbSink() {                                                                         </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 998         return dbSink;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 999     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1000                                                                                                          </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1001     public Connection getDbConn() {                                                                      </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1002         return dbConn;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1003     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1004                                                                                                          </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1005     public String getTableName() {                                                                       </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1006         return tableName;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1007     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1008                                                                                                          </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1009     public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                     </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1010         this.realIndexes.put(index, fieldes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1011     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1012                                                                                                          </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1013     public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                   </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1014         return realIndexes;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1015     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1016                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1017                                                                                                          </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1018     public void setBatchWaitInterval(long batchWaitInterval) {                                           </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1019         this.batchWaitInterval = batchWaitInterval;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1020     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1021                                                                                                          </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1022     public List&lt;String&gt; getFullField() {                                                                 </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1023         return fullField;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1024     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1025                                                                                                          </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1026     public void fullFieldAdd(String colName) {                                                           </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1027         this.fullField.add(colName);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1028     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1029 }                                                                                                        </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">1030 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span></pre></td>
                            <td><pre><span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   3 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   4  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   5  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   6  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   7  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   8  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">   9  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  10  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  11  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  12  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  13  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  14  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  15  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  16  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  17  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  18  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  19  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  20                                                                                                          </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  21 package com.dtstack.flink.sql.sink.rdb.format;                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  22                                                                                                          </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  23 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import com.google.common.collect.Maps;                                                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  31 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  32 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  33 import java.io.IOException;                                                                              </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  34 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37 import java.sql.SQLException;                                                                            </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 import java.util.Map;                                                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44                                                                                                          </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45 import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47 /**                                                                                                      </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48  * OutputFormat to write tuples into a database.                                                         </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49  * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51  */                                                                                                      </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                        </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54                                                                                                          </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55     private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56                                                                                                          </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57     private String username;                                                                             </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58     private String password;                                                                             </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59     private String drivername;                                                                           </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60     private String dbURL;                                                                                </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61     private String tableName;                                                                            </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62     private String dbType;                                                                               </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63     private String schema;                                                                               </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64     private RdbSink dbSink;                                                                              </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65     // trigger preparedStatement execute batch interval                                                  </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66     private long batchWaitInterval = 10000l;                                                             </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67     // PreparedStatement execute batch num                                                               </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68     private int batchNum = 100;                                                                          </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69     private String insertQuery;                                                                          </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70     public int[] typesArray;                                                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71                                                                                                          </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72     /** 存储用于批量写入的数据 */                                                                                   </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73     protected List&lt;Row&gt; rows = new ArrayList();                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74                                                                                                          </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75     private Connection dbConn;                                                                           </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76     private PreparedStatement upload;                                                                    </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77     private transient ScheduledThreadPoolExecutor timerService;                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79                                                                                                          </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80     //index field                                                                                        </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81     private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                   </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82     //full field                                                                                         </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83     private List&lt;String&gt; fullField = Lists.newArrayList();                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84                                                                                                          </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85     public RetractJDBCOutputFormat() {                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92     /**                                                                                                  </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93      * Connects to the target database and initializes the prepared statement.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94      *                                                                                                   </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95      * @param taskNumber The number of the parallel instance.                                            </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96      * @throws IOException Thrown, if the output could not be opened due to an                           </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97      *                     I/O problem.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101         try {                                                                                            </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102             LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                             </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103             dbConn = establishConnection();                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104             initMetric();                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105                                                                                                          </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106             if (existTabname()) {                                                                        </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107                 if (isReplaceInsertQuery()) {                                                            </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 108                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 108                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getField🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109                 }                                                                                        </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111             } else {                                                                                     </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112                 throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                                                                                                          </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 115             if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                 </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 116                 LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 117                                                                                                          </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118                 timerService = new ScheduledThreadPoolExecutor(1);                                       </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119                 timerService.scheduleAtFixedRate(() -&gt; {                                                 </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120                     submitExecuteBatch();                                                                </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121                 }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124                                                                                                          </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 125         } catch (SQLException sqe) {                                                                     </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 126             LOG.error(&quot;&quot;, sqe);                                                                          </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 127             throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                   </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 128         } catch (ClassNotFoundException cnfe) {                                                          </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 129             LOG.error(&quot;&quot;, cnfe);                                                                         </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 130             throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 131         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 132     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 133                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134                                                                                                          </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135     public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {   </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136         Connection connection ;                                                                          </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137         JDBCUtils.forName(drivername, getClass().getClassLoader());                                      </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138         if (username == null) {                                                                          </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 139             connection = DriverManager.getConnection(dbURL);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140         } else {                                                                                         </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141             connection = DriverManager.getConnection(dbURL, username, password);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142         }                                                                                                </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143         connection.setAutoCommit(false);                                                                 </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144         return connection;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147     /**                                                                                                  </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 148      * Adds a record to the prepared statement.                                                          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149      * &lt;p&gt;                                                                                               </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150      * When this method is called, the output format is guaranteed to be opened.                         </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151      * &lt;/p&gt;                                                                                              </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152      * &lt;p&gt;                                                                                               </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 153      * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 153      * WARNING: this may fail when no column types specified (because a best effort approach is attempted🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 154      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 154      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObje🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155      *                                                                                                   </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156      * @param tuple2 The records to add to the output.                                                   </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157      * @throws IOException Thrown, if the records could not be added due to an I/O problem.              </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158      * @see PreparedStatement                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     @Override                                                                                            </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161     public void writeRecord(Tuple2 tuple2)  {                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162                                                                                                          </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163         Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                        </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164         Boolean retract = tupleTrans.getField(0);                                                        </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 165         Row row = tupleTrans.getField(1);                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166                                                                                                          </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167         if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {        </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 168             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);"> 168             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170                                                                                                          </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171         if (retract) {                                                                                   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172                                                                                                          </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173             if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                      </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                 LOG.info(&quot;Receive data : {}&quot;, row);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176                                                                                                          </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177             outRecords.inc();                                                                            </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178             insertWrite(row);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179         } else {                                                                                         </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180             //do nothing                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184                                                                                                          </span>
<span class="-4476666207180013827" onmouseenter="enter('-4476666207180013827');" onmouseout="out('-4476666207180013827');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185     private void insertWrite(Row row) {                                                                  </span>
<span class="-1086395285886649574" onmouseenter="enter('-1086395285886649574');" onmouseout="out('-1086395285886649574');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186         checkConnectionOpen(dbConn);                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187         try {                                                                                            </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188             if (batchNum == 1) {                                                                         </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                 writeSingleRecord(row);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190             } else {                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                 updatePreparedStmt(row, upload);                                                         </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192                 rows.add(row);                                                                           </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                 upload.addBatch();                                                                       </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194                 if (rows.size() &gt;= batchNum) {                                                           </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195                     submitExecuteBatch();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198         } catch (SQLException e) {                                                                       </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 201                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 201                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203             } else {                                                                                     </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                                                                                                          </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212     private void writeSingleRecord(Row row) {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213         try {                                                                                            </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214             updatePreparedStmt(row, upload);                                                             </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             upload.executeUpdate();                                                                      </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217         } catch (SQLException e) {                                                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218                                                                                                          </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 220                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 220                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223                                                                                                          </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224             outDirtyRecords.inc();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227                                                                                                          </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228     private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {              </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229         if (typesArray == null) {                                                                        </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230             // no types provided                                                                         </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 232                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 232                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;,🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                 pstmt.setObject(index + 1, row.getField(index));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235         } else {                                                                                         </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236             // types provided                                                                            </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238                                                                                                          </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239                 if (row.getField(index) == null) {                                                       </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240                     pstmt.setNull(index + 1, typesArray[index]);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241                 } else {                                                                                 </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 242                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 242                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                     switch (typesArray[index]) {                                                         </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244                         case java.sql.Types.NULL:                                                        </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                             pstmt.setNull(index + 1, typesArray[index]);                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246                             break;                                                                       </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247                         case java.sql.Types.BOOLEAN:                                                     </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248                         case java.sql.Types.BIT:                                                         </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249                             pstmt.setBoolean(index + 1, (boolean) row.getField(index));                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                             break;                                                                       </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                         case java.sql.Types.CHAR:                                                        </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                         case java.sql.Types.NCHAR:                                                       </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                         case java.sql.Types.VARCHAR:                                                     </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254                         case java.sql.Types.LONGVARCHAR:                                                 </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                         case java.sql.Types.LONGNVARCHAR:                                                </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                             pstmt.setString(index + 1, (String) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                             break;                                                                       </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258                         case java.sql.Types.TINYINT:                                                     </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259                             pstmt.setByte(index + 1, (byte) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260                             break;                                                                       </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                         case java.sql.Types.SMALLINT:                                                    </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262                             pstmt.setShort(index + 1, (short) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                             break;                                                                       </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                         case java.sql.Types.INTEGER:                                                     </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265                             pstmt.setInt(index + 1, (int) row.getField(index));                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                             break;                                                                       </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                         case java.sql.Types.BIGINT:                                                      </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268                             pstmt.setLong(index + 1, (long) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                             break;                                                                       </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270                         case java.sql.Types.REAL:                                                        </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                         case java.sql.Types.FLOAT:                                                       </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272                             pstmt.setFloat(index + 1, (float) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273                             break;                                                                       </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                         case java.sql.Types.DOUBLE:                                                      </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275                             pstmt.setDouble(index + 1, (double) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276                             break;                                                                       </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277                         case java.sql.Types.DECIMAL:                                                     </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                         case java.sql.Types.NUMERIC:                                                     </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                             pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                             break;                                                                       </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                         case java.sql.Types.DATE:                                                        </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                             pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                             break;                                                                       </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                         case java.sql.Types.TIME:                                                        </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                             pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                             break;                                                                       </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                         case java.sql.Types.TIMESTAMP:                                                   </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                             pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                             break;                                                                       </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                         case java.sql.Types.BINARY:                                                      </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                         case java.sql.Types.VARBINARY:                                                   </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                         case java.sql.Types.LONGVARBINARY:                                               </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293                             pstmt.setBytes(index + 1, (byte[]) row.getField(index));                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294                             break;                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                         default:                                                                         </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296                             pstmt.setObject(index + 1, row.getField(index));                             </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 297                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 297                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set 🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298                                     typesArray[index], index + 1, row.getField(index));                  </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299                             // case java.sql.Types.SQLXML                                                </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300                             // case java.sql.Types.ARRAY:                                                </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                             // case java.sql.Types.JAVA_OBJECT:                                          </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302                             // case java.sql.Types.BLOB:                                                 </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                             // case java.sql.Types.CLOB:                                                 </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                             // case java.sql.Types.NCLOB:                                                </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                             // case java.sql.Types.DATALINK:                                             </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                             // case java.sql.Types.DISTINCT:                                             </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                             // case java.sql.Types.OTHER:                                                </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                             // case java.sql.Types.REF:                                                  </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                             // case java.sql.Types.ROWID:                                                </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310                             // case java.sql.Types.STRUC                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317                                                                                                          </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318     private synchronized void submitExecuteBatch() {                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319         try {                                                                                            </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320             this.upload.executeBatch();                                                                  </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322         } catch (SQLException e) {                                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323             try {                                                                                        </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324                 dbConn.rollback();                                                                       </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325             } catch (SQLException e1) {                                                                  </span>
<span class="-7536698771404360230" onmouseenter="enter('-7536698771404360230');" onmouseout="out('-7536698771404360230');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                 LOG.error(&quot;rollback  data error !&quot;, e);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328                                                                                                          </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329             rows.forEach(this::writeSingleRecord);                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330         } finally {                                                                                      </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334                                                                                                          </span>
<span class="-3522961204041572073" onmouseenter="enter('-3522961204041572073');" onmouseout="out('-3522961204041572073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335     private void checkConnectionOpen(Connection dbConn) {                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336         try {                                                                                            </span>
<span class="-2855961023100454886" onmouseenter="enter('-2855961023100454886');" onmouseout="out('-2855961023100454886');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337             if (dbConn.isClosed()) {                                                                     </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338                 LOG.info(&quot;db connection reconnect..&quot;);                                                   </span>
<span class="-4293595830544602858" onmouseenter="enter('-4293595830544602858');" onmouseout="out('-4293595830544602858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339                 dbConn= establishConnection();                                                           </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341                 this.dbConn = dbConn;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343         } catch (SQLException e) {                                                                       </span>
<span class="814403640845951473" onmouseenter="enter('814403640845951473');" onmouseout="out('814403640845951473');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344             LOG.error(&quot;check connection open failed..&quot;, e);                                              </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345         } catch (ClassNotFoundException e) {                                                             </span>
<span class="1123805251307592465" onmouseenter="enter('1123805251307592465');" onmouseout="out('1123805251307592465');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346             LOG.error(&quot;load jdbc class error when reconnect db..&quot;, e);                                   </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347         } catch (IOException e) {                                                                        </span>
<span class="-720388217547677793" onmouseenter="enter('-720388217547677793');" onmouseout="out('-720388217547677793');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348             LOG.error(&quot;kerberos authentication failed..&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352     /**                                                                                                  </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353      * Executes prepared statement and closes all resources of this instance.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354      *                                                                                                   </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 355      * @throws IOException Thrown, if the input could not be closed properly.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 356      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 357     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 358     public void close() throws IOException {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 359         try {                                                                                            </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 360             if (upload != null) {                                                                        </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 361                 upload.executeBatch();                                                                   </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 362                 upload.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 363             }                                                                                            </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 364             if (null != timerService) {                                                                  </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 365                 timerService.shutdown();                                                                 </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 366                 LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 367             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 368         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 369             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 370         } finally {                                                                                      </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 371             upload = null;                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 372             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 373         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 374                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 375         try {                                                                                            </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 376             if (dbConn != null) {                                                                        </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 377                 dbConn.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 378             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 379         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 380             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 381         } finally {                                                                                      </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 382             dbConn = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 383         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 384     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 385                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 386                                                                                                          </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 387     public boolean isReplaceInsertQuery() throws SQLException {                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 388         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 389     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 390                                                                                                          </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 391     public void verifyField() {                                                                          </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 392         if (StringUtils.isBlank(username)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 393             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 394         }                                                                                                </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 395         if (StringUtils.isBlank(password)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 396             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 397         }                                                                                                </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 398         if (StringUtils.isBlank(dbURL)) {                                                                </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 399             throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 400         }                                                                                                </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 401         if (StringUtils.isBlank(insertQuery)) {                                                          </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 402             throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 403         }                                                                                                </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 404         if (StringUtils.isBlank(drivername)) {                                                           </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 405             throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 406         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 407     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 408                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 409                                                                                                          </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 410     public void setUsername(String username) {                                                           </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 411         this.username = username;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 412     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 413                                                                                                          </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 414     public String getSchema() {                                                                          </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 415         if (StringUtils.isNotEmpty(schema)) {                                                            </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 416             return schema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 417         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 418         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 419     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 420                                                                                                          </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 421     public void setSchema(String schema) {                                                               </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 422         this.schema = schema;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 423     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 424                                                                                                          </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 425     public boolean existTabname() throws SQLException {                                                  </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 426         return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 427     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 428                                                                                                          </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 429     public void setPassword(String password) {                                                           </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 430         this.password = password;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 431     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 432                                                                                                          </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433     public void setDrivername(String drivername) {                                                       </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434         this.drivername = drivername;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436                                                                                                          </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437     public String getDrivername() {                                                                      </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438         return this.drivername;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440                                                                                                          </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441     public void setDbURL(String dbURL) {                                                                 </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442         this.dbURL = dbURL;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444                                                                                                          </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445     public void setTableName(String tableName) {                                                         </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446         this.tableName = tableName;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448                                                                                                          </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449     public void setDbType(String dbType) {                                                               </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450         this.dbType = dbType;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452                                                                                                          </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453     public void setDbSink(RdbSink dbSink) {                                                              </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454         this.dbSink = dbSink;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456                                                                                                          </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457     public void setBatchNum(int batchNum) {                                                              </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458         this.batchNum = batchNum;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460                                                                                                          </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461     public void setInsertQuery(String insertQuery) {                                                     </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462         this.insertQuery = insertQuery;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464                                                                                                          </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465     public void setTypesArray(int[] typesArray) {                                                        </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466         this.typesArray = typesArray;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468                                                                                                          </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469     public String getDbType() {                                                                          </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470         return dbType;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472                                                                                                          </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473     public RdbSink getDbSink() {                                                                         </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474         return dbSink;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476                                                                                                          </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477     public Connection getDbConn() {                                                                      </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478         return dbConn;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480                                                                                                          </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481     public String getTableName() {                                                                       </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482         return tableName;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484                                                                                                          </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485     public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                     </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486         this.realIndexes.put(index, fieldes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488                                                                                                          </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489     public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                   </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 490         return realIndexes;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 491     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 492                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 493                                                                                                          </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 494     public void setBatchWaitInterval(long batchWaitInterval) {                                           </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 495         this.batchWaitInterval = batchWaitInterval;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 496     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 497                                                                                                          </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 498     public List&lt;String&gt; getFullField() {                                                                 </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 499         return fullField;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 500     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 501                                                                                                          </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 502     public void fullFieldAdd(String colName) {                                                           </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 503         this.fullField.add(colName);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 504     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505 }                                                                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 506 =======                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524                                                                                                          </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525 package com.dtstack.flink.sql.sink.rdb.format;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526                                                                                                          </span>
<span class="-3311622777804768870" onmouseenter="enter('-3311622777804768870');" onmouseout="out('-3311622777804768870');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527 import com.dtstack.flink.sql.enums.EConnectionErrorCode;                                                 </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534 import com.google.common.collect.Maps;                                                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538 import java.io.IOException;                                                                              </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 540 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 541 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 542 import java.sql.SQLException;                                                                            </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 543 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 544 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 545 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 546 import java.util.Map;                                                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 547 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 548 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 549                                                                                                          </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 550 import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 551                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 552 /**                                                                                                      </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 553  * OutputFormat to write tuples into a database.                                                         </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 554  * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 555  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 556  */                                                                                                      </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 557 public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                        </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 558     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 559                                                                                                          </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 560     private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);            </span>
<span class="-5647401529104718799" onmouseenter="enter('-5647401529104718799');" onmouseout="out('-5647401529104718799');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 561     private static final int CONNECTION_CHECK_FREQUENCY = 100;                                           </span>
<span class="4613588471810503867" onmouseenter="enter('4613588471810503867');" onmouseout="out('4613588471810503867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 562     private int checkTimes;                                                                              </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563     private String username;                                                                             </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 564     private String password;                                                                             </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 565     private String drivername;                                                                           </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 566     private String dbURL;                                                                                </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 567     private String tableName;                                                                            </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 568     private String dbType;                                                                               </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 569     private String schema;                                                                               </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 570     private RdbSink dbSink;                                                                              </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 571     // trigger preparedStatement execute batch interval                                                  </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 572     private long batchWaitInterval = 10000l;                                                             </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 573     // PreparedStatement execute batch num                                                               </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 574     private int batchNum = 100;                                                                          </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 575     private String insertQuery;                                                                          </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 576     public int[] typesArray;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 577                                                                                                          </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 578     /** 存储用于批量写入的数据 */                                                                                   </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 579     protected List&lt;Row&gt; rows = new ArrayList();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 580                                                                                                          </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 581     private Connection dbConn;                                                                           </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 582     private PreparedStatement upload;                                                                    </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 583     private transient ScheduledThreadPoolExecutor timerService;                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 584                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 585                                                                                                          </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 586     //index field                                                                                        </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 587     private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                   </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 588     //full field                                                                                         </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 589     private List&lt;String&gt; fullField = Lists.newArrayList();                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 590                                                                                                          </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 591     public RetractJDBCOutputFormat() {                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 592     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 593                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 594     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 595     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 596     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 597                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 598     /**                                                                                                  </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 599      * Connects to the target database and initializes the prepared statement.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 600      *                                                                                                   </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 601      * @param taskNumber The number of the parallel instance.                                            </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 602      * @throws IOException Thrown, if the output could not be opened due to an                           </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 603      *                     I/O problem.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 604      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 605     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 606     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 607         try {                                                                                            </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 608             LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                             </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 609             dbConn = establishConnection();                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 610             initMetric();                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 611                                                                                                          </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 612             if (existTabname()) {                                                                        </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 613                 if (isReplaceInsertQuery()) {                                                            </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 614                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 614                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getField🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 615                 }                                                                                        </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 616                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 617             } else {                                                                                     </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 618                 throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 619             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 620                                                                                                          </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 621             if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                 </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 622                 LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 623                                                                                                          </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 624                 timerService = new ScheduledThreadPoolExecutor(1);                                       </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 625                 timerService.scheduleAtFixedRate(() -&gt; {                                                 </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 626                     submitExecuteBatch();                                                                </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 627                 }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 628                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 629             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 630                                                                                                          </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 631         } catch (SQLException sqe) {                                                                     </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 632             LOG.error(&quot;&quot;, sqe);                                                                          </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 633             throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                   </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 634         } catch (ClassNotFoundException cnfe) {                                                          </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 635             LOG.error(&quot;&quot;, cnfe);                                                                         </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 636             throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 637         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 638     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 639                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 640                                                                                                          </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 641     public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {   </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 642         Connection connection ;                                                                          </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 643         JDBCUtils.forName(drivername, getClass().getClassLoader());                                      </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 644         if (username == null) {                                                                          </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 645             connection = DriverManager.getConnection(dbURL);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 646         } else {                                                                                         </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 647             connection = DriverManager.getConnection(dbURL, username, password);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 648         }                                                                                                </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 649         connection.setAutoCommit(false);                                                                 </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 650         return connection;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 651     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 652                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 653     /**                                                                                                  </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 654      * Adds a record to the prepared statement.                                                          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 655      * &lt;p&gt;                                                                                               </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 656      * When this method is called, the output format is guaranteed to be opened.                         </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 657      * &lt;/p&gt;                                                                                              </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 658      * &lt;p&gt;                                                                                               </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 659      * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 659      * WARNING: this may fail when no column types specified (because a best effort approach is attempted🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 660      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 660      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObje🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 661      *                                                                                                   </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 662      * @param tuple2 The records to add to the output.                                                   </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 663      * @throws IOException Thrown, if the records could not be added due to an I/O problem.              </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 664      * @see PreparedStatement                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 665      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 666     @Override                                                                                            </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 667     public void writeRecord(Tuple2 tuple2)  {                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 668                                                                                                          </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 669         Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                        </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 670         Boolean retract = tupleTrans.getField(0);                                                        </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 671         Row row = tupleTrans.getField(1);                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 672                                                                                                          </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 673         if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {        </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 674             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);"> 674             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 675         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 676                                                                                                          </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 677         if (retract) {                                                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 678                                                                                                          </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 679             if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                      </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 680                 LOG.info(&quot;Receive data : {}&quot;, row);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 681             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 682                                                                                                          </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 683             outRecords.inc();                                                                            </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 684             insertWrite(row);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 685         } else {                                                                                         </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 686             //do nothing                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 687         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 688     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 689                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 690                                                                                                          </span>
<span class="2080741281463881552" onmouseenter="enter('2080741281463881552');" onmouseout="out('2080741281463881552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 691     private void insertWrite(Row row)  {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 692         try {                                                                                            </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 693             if (batchNum == 1) {                                                                         </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 694                 writeSingleRecord(row);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 695             } else {                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 696                 updatePreparedStmt(row, upload);                                                         </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 697                 rows.add(row);                                                                           </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 698                 upload.addBatch();                                                                       </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 699                 if (rows.size() &gt;= batchNum) {                                                           </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 700                     submitExecuteBatch();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 701                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 702             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 703         } catch (SQLException e) {                                                                       </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 704             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 705                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 706                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 706                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 707                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 708             } else {                                                                                     </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 709                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 710             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 711         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 712                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 713     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 714                                                                                                          </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 715     private void writeSingleRecord(Row row) {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 716         try {                                                                                            </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 717             updatePreparedStmt(row, upload);                                                             </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 718             upload.executeUpdate();                                                                      </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 719             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 720         } catch (SQLException e) {                                                                       </span>
<span class="-6799605853464900245" onmouseenter="enter('-6799605853464900245');" onmouseout="out('-6799605853464900245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 721             dealSQLException(e);                                                                         </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 722             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 723                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 723                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 724                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 725             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 726                                                                                                          </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 727             outDirtyRecords.inc();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 728         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 729     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 730                                                                                                          </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 731     private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {              </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 732         if (typesArray == null) {                                                                        </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 733             // no types provided                                                                         </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 734             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 735                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 735                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;,🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 736                 pstmt.setObject(index + 1, row.getField(index));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 737             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 738         } else {                                                                                         </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 739             // types provided                                                                            </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 740             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 741                                                                                                          </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 742                 if (row.getField(index) == null) {                                                       </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 743                     pstmt.setNull(index + 1, typesArray[index]);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 744                 } else {                                                                                 </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 745                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 745                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 746                     switch (typesArray[index]) {                                                         </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 747                         case java.sql.Types.NULL:                                                        </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 748                             pstmt.setNull(index + 1, typesArray[index]);                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 749                             break;                                                                       </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 750                         case java.sql.Types.BOOLEAN:                                                     </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 751                         case java.sql.Types.BIT:                                                         </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 752                             pstmt.setBoolean(index + 1, (boolean) row.getField(index));                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 753                             break;                                                                       </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 754                         case java.sql.Types.CHAR:                                                        </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 755                         case java.sql.Types.NCHAR:                                                       </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 756                         case java.sql.Types.VARCHAR:                                                     </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 757                         case java.sql.Types.LONGVARCHAR:                                                 </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 758                         case java.sql.Types.LONGNVARCHAR:                                                </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 759                             pstmt.setString(index + 1, (String) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 760                             break;                                                                       </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 761                         case java.sql.Types.TINYINT:                                                     </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 762                             pstmt.setByte(index + 1, (byte) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 763                             break;                                                                       </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 764                         case java.sql.Types.SMALLINT:                                                    </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 765                             pstmt.setShort(index + 1, (short) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 766                             break;                                                                       </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 767                         case java.sql.Types.INTEGER:                                                     </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 768                             pstmt.setInt(index + 1, (int) row.getField(index));                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 769                             break;                                                                       </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 770                         case java.sql.Types.BIGINT:                                                      </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 771                             pstmt.setLong(index + 1, (long) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772                             break;                                                                       </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 773                         case java.sql.Types.REAL:                                                        </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774                         case java.sql.Types.FLOAT:                                                       </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775                             pstmt.setFloat(index + 1, (float) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776                             break;                                                                       </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 777                         case java.sql.Types.DOUBLE:                                                      </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778                             pstmt.setDouble(index + 1, (double) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779                             break;                                                                       </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 780                         case java.sql.Types.DECIMAL:                                                     </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 781                         case java.sql.Types.NUMERIC:                                                     </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 782                             pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 783                             break;                                                                       </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 784                         case java.sql.Types.DATE:                                                        </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 785                             pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 786                             break;                                                                       </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 787                         case java.sql.Types.TIME:                                                        </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 788                             pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 789                             break;                                                                       </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 790                         case java.sql.Types.TIMESTAMP:                                                   </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 791                             pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792                             break;                                                                       </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793                         case java.sql.Types.BINARY:                                                      </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794                         case java.sql.Types.VARBINARY:                                                   </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 795                         case java.sql.Types.LONGVARBINARY:                                               </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 796                             pstmt.setBytes(index + 1, (byte[]) row.getField(index));                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 797                             break;                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 798                         default:                                                                         </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 799                             pstmt.setObject(index + 1, row.getField(index));                             </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 800                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 800                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set 🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 801                                     typesArray[index], index + 1, row.getField(index));                  </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 802                             // case java.sql.Types.SQLXML                                                </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 803                             // case java.sql.Types.ARRAY:                                                </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 804                             // case java.sql.Types.JAVA_OBJECT:                                          </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 805                             // case java.sql.Types.BLOB:                                                 </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 806                             // case java.sql.Types.CLOB:                                                 </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 807                             // case java.sql.Types.NCLOB:                                                </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 808                             // case java.sql.Types.DATALINK:                                             </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 809                             // case java.sql.Types.DISTINCT:                                             </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 810                             // case java.sql.Types.OTHER:                                                </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 811                             // case java.sql.Types.REF:                                                  </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 812                             // case java.sql.Types.ROWID:                                                </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 813                             // case java.sql.Types.STRUC                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 814                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 815                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 816             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 817         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 818     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 819                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 820                                                                                                          </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 821     private synchronized void submitExecuteBatch() {                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 822         try {                                                                                            </span>
<span class="6813843412968272702" onmouseenter="enter('6813843412968272702');" onmouseout="out('6813843412968272702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 823             regularlyCheckConnection();                                                                  </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 824             this.upload.executeBatch();                                                                  </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 825             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 826         } catch (SQLException e) {                                                                       </span>
<span class="-9174161656279899685" onmouseenter="enter('-9174161656279899685');" onmouseout="out('-9174161656279899685');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 827             LOG.warn(&quot;submitExecuteBatch error {}&quot;, e);                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 828             try {                                                                                        </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 829                 dbConn.rollback();                                                                       </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 830             } catch (SQLException e1) {                                                                  </span>
<span class="246786700485249677" onmouseenter="enter('246786700485249677');" onmouseout="out('246786700485249677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 831                 dealSQLException(e1);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 832             }                                                                                            </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 833             rows.forEach(this::writeSingleRecord);                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 834         } finally {                                                                                      </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 835             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 836         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 837     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 838                                                                                                          </span>
<span class="-3874353238638658215" onmouseenter="enter('-3874353238638658215');" onmouseout="out('-3874353238638658215');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 839     private void dealSQLException(Exception e) {                                                         </span>
<span class="6407700796198700478" onmouseenter="enter('6407700796198700478');" onmouseout="out('6407700796198700478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 840         EConnectionErrorCode errorCode = EConnectionErrorCode.resolveErrorCodeFromException(e);          </span>
<span class="-3680639726838673504" onmouseenter="enter('-3680639726838673504');" onmouseout="out('-3680639726838673504');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 841         switch (errorCode) {                                                                             </span>
<span class="1225374239746753698" onmouseenter="enter('1225374239746753698');" onmouseout="out('1225374239746753698');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 842             case CONN_DB_INVALID:                                                                        </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 843                 reconnection();                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 844                 break;                                                                                   </span>
<span class="1755343140467316574" onmouseenter="enter('1755343140467316574');" onmouseout="out('1755343140467316574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 845             case CONN_DB_FAILED:                                                                         </span>
<span class="-1198874643364045165" onmouseenter="enter('-1198874643364045165');" onmouseout="out('-1198874643364045165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 846             case DB_TABLE_NOT_EXIST:                                                                     </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 847                 throw new RuntimeException(e);                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 848             default:                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 849         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 850     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 851                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 852                                                                                                          </span>
<span class="-1258602931071673845" onmouseenter="enter('-1258602931071673845');" onmouseout="out('-1258602931071673845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 853     private void regularlyCheckConnection() throws SQLException {                                        </span>
<span class="-1222192591979868781" onmouseenter="enter('-1222192591979868781');" onmouseout="out('-1222192591979868781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 854         checkTimes++;                                                                                    </span>
<span class="-5151471990775264393" onmouseenter="enter('-5151471990775264393');" onmouseout="out('-5151471990775264393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 855         if (checkTimes % CONNECTION_CHECK_FREQUENCY != 0) {                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 856             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 857         }                                                                                                </span>
<span class="5795923628795732420" onmouseenter="enter('5795923628795732420');" onmouseout="out('5795923628795732420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 858         LOG.warn(&quot;db connection Valid check !&quot;);                                                         </span>
<span class="8215065968495159984" onmouseenter="enter('8215065968495159984');" onmouseout="out('8215065968495159984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 859         if (dbConn.isClosed() || !dbConn.isValid(100)) {                                                 </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 860             reconnection();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 861         }                                                                                                </span>
<span class="-8215063589164597765" onmouseenter="enter('-8215063589164597765');" onmouseout="out('-8215063589164597765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 862         checkTimes = 0;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 863     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 864                                                                                                          </span>
<span class="-5737401042898679127" onmouseenter="enter('-5737401042898679127');" onmouseout="out('-5737401042898679127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 865     public void reconnection() throws RuntimeException {                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 866         try {                                                                                            </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 867             LOG.info(&quot;db connection reconnect..&quot;);                                                       </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 868             dbConn = establishConnection();                                                              </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 869             upload = dbConn.prepareStatement(insertQuery);                                               </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 870             this.dbConn = dbConn;                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 871         } catch (Exception e) {                                                                          </span>
<span class="5310062978023364230" onmouseenter="enter('5310062978023364230');" onmouseout="out('5310062978023364230');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 872             throw new RuntimeException(&quot;connection open failed..&quot;, e);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 873         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 874     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 875                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 876     /**                                                                                                  </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 877      * Executes prepared statement and closes all resources of this instance.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 878      *                                                                                                   </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 879      * @throws IOException Thrown, if the input could not be closed properly.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 880      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 881     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 882     public void close() throws IOException {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 883         try {                                                                                            </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 884             if (upload != null) {                                                                        </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 885                 upload.executeBatch();                                                                   </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 886                 upload.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 887             }                                                                                            </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 888             if (null != timerService) {                                                                  </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 889                 timerService.shutdown();                                                                 </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 890                 LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 891             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 892         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 893             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 894         } finally {                                                                                      </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 895             upload = null;                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 896             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 897         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 898                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 899         try {                                                                                            </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 900             if (dbConn != null) {                                                                        </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 901                 dbConn.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 902             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 903         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 904             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 905         } finally {                                                                                      </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 906             dbConn = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 907         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 908     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 909                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 910                                                                                                          </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 911     public boolean isReplaceInsertQuery() throws SQLException {                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 912         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 913     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 914                                                                                                          </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 915     public void verifyField() {                                                                          </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 916         if (StringUtils.isBlank(username)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 917             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 918         }                                                                                                </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 919         if (StringUtils.isBlank(password)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 920             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 921         }                                                                                                </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 922         if (StringUtils.isBlank(dbURL)) {                                                                </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 923             throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 924         }                                                                                                </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 925         if (StringUtils.isBlank(insertQuery)) {                                                          </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 926             throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 927         }                                                                                                </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 928         if (StringUtils.isBlank(drivername)) {                                                           </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 929             throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 930         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 931     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 932                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 933                                                                                                          </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 934     public void setUsername(String username) {                                                           </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 935         this.username = username;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 936     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 937                                                                                                          </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 938     public String getSchema() {                                                                          </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 939         if (StringUtils.isNotEmpty(schema)) {                                                            </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 940             return schema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 941         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 942         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 943     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 944                                                                                                          </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 945     public void setSchema(String schema) {                                                               </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 946         this.schema = schema;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 947     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 948                                                                                                          </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 949     public boolean existTabname() throws SQLException {                                                  </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 950         return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 951     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 952                                                                                                          </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 953     public void setPassword(String password) {                                                           </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 954         this.password = password;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 955     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 956                                                                                                          </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 957     public void setDrivername(String drivername) {                                                       </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 958         this.drivername = drivername;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 959     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 960                                                                                                          </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 961     public String getDrivername() {                                                                      </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 962         return this.drivername;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 963     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 964                                                                                                          </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 965     public void setDbURL(String dbURL) {                                                                 </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 966         this.dbURL = dbURL;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 967     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 968                                                                                                          </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 969     public void setTableName(String tableName) {                                                         </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 970         this.tableName = tableName;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 971     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 972                                                                                                          </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 973     public void setDbType(String dbType) {                                                               </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 974         this.dbType = dbType;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 975     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 976                                                                                                          </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 977     public void setDbSink(RdbSink dbSink) {                                                              </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 978         this.dbSink = dbSink;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 979     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 980                                                                                                          </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 981     public void setBatchNum(int batchNum) {                                                              </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 982         this.batchNum = batchNum;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 983     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 984                                                                                                          </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 985     public void setInsertQuery(String insertQuery) {                                                     </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 986         this.insertQuery = insertQuery;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 987     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 988                                                                                                          </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 989     public void setTypesArray(int[] typesArray) {                                                        </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 990         this.typesArray = typesArray;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 991     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 992                                                                                                          </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 993     public String getDbType() {                                                                          </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 994         return dbType;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 995     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 996                                                                                                          </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 997     public RdbSink getDbSink() {                                                                         </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 998         return dbSink;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 999     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1000                                                                                                          </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1001     public Connection getDbConn() {                                                                      </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1002         return dbConn;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1003     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1004                                                                                                          </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1005     public String getTableName() {                                                                       </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1006         return tableName;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1007     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1008                                                                                                          </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1009     public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                     </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1010         this.realIndexes.put(index, fieldes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1011     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1012                                                                                                          </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1013     public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                   </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1014         return realIndexes;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1015     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1016                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1017                                                                                                          </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1018     public void setBatchWaitInterval(long batchWaitInterval) {                                           </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1019         this.batchWaitInterval = batchWaitInterval;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1020     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1021                                                                                                          </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1022     public List&lt;String&gt; getFullField() {                                                                 </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1023         return fullField;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1024     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1025                                                                                                          </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1026     public void fullFieldAdd(String colName) {                                                           </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1027         this.fullField.add(colName);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1028     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">1029 }                                                                                                        </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">1030 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span></pre></td>
                            <td><pre><span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style="">   1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">   2 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title="   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/">   3 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kw🔵</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">   4 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   5                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   6 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   7  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   8  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">   9  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  10  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  11  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  12  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  13  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  14  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  15  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  16  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  17  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  18  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  19  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  20  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  21  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  22  */                                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  23                                                                                                          </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  24 package com.dtstack.flink.sql.sink.rdb.format;                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  25                                                                                                          </span>
<span class="-3311622777804768870" onmouseenter="enter('-3311622777804768870');" onmouseout="out('-3311622777804768870');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  26 import com.dtstack.flink.sql.enums.EConnectionErrorCode;                                                 </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  27 import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                           </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  28 import com.dtstack.flink.sql.util.JDBCUtils;                                                             </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  29 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  30 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  31 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import com.google.common.collect.Maps;                                                                   </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36 import org.slf4j.LoggerFactory;                                                                          </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import java.io.IOException;                                                                              </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import java.sql.Connection;                                                                              </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  39 import java.sql.DriverManager;                                                                           </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  40 import java.sql.PreparedStatement;                                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  41 import java.sql.SQLException;                                                                            </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import java.util.ArrayList;                                                                              </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  43 import java.util.Arrays;                                                                                 </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  44 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  45 import java.util.Map;                                                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  46 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  47 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  48                                                                                                          </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  49 import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  50                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51 /**                                                                                                      </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52  * OutputFormat to write tuples into a database.                                                         </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  53  * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  54  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55  */                                                                                                      </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56 public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                        </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  57     private static final long serialVersionUID = 1L;                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58                                                                                                          </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59     private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);            </span>
<span class="-5647401529104718799" onmouseenter="enter('-5647401529104718799');" onmouseout="out('-5647401529104718799');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  60     private static final int CONNECTION_CHECK_FREQUENCY = 100;                                           </span>
<span class="4613588471810503867" onmouseenter="enter('4613588471810503867');" onmouseout="out('4613588471810503867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61     private int checkTimes;                                                                              </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62     private String username;                                                                             </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63     private String password;                                                                             </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64     private String drivername;                                                                           </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65     private String dbURL;                                                                                </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  66     private String tableName;                                                                            </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  67     private String dbType;                                                                               </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  68     private String schema;                                                                               </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  69     private RdbSink dbSink;                                                                              </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  70     // trigger preparedStatement execute batch interval                                                  </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  71     private long batchWaitInterval = 10000l;                                                             </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  72     // PreparedStatement execute batch num                                                               </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  73     private int batchNum = 100;                                                                          </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  74     private String insertQuery;                                                                          </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  75     public int[] typesArray;                                                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  76                                                                                                          </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  77     /** 存储用于批量写入的数据 */                                                                                   </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  78     protected List&lt;Row&gt; rows = new ArrayList();                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  79                                                                                                          </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  80     private Connection dbConn;                                                                           </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  81     private PreparedStatement upload;                                                                    </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  82     private transient ScheduledThreadPoolExecutor timerService;                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  83                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  84                                                                                                          </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  85     //index field                                                                                        </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  86     private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                   </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  87     //full field                                                                                         </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  88     private List&lt;String&gt; fullField = Lists.newArrayList();                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  89                                                                                                          </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  90     public RetractJDBCOutputFormat() {                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  91     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  92                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  93     @Override                                                                                            </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  94     public void configure(Configuration parameters) {                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  95     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  96                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  97     /**                                                                                                  </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  98      * Connects to the target database and initializes the prepared statement.                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  99      *                                                                                                   </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 100      * @param taskNumber The number of the parallel instance.                                            </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 101      * @throws IOException Thrown, if the output could not be opened due to an                           </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 102      *                     I/O problem.                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 103      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 104     @Override                                                                                            </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 105     public void open(int taskNumber, int numTasks) throws IOException {                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 106         try {                                                                                            </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 107             LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                             </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 108             dbConn = establishConnection();                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 109             initMetric();                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 110                                                                                                          </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 111             if (existTabname()) {                                                                        </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 112                 if (isReplaceInsertQuery()) {                                                            </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 113                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 113                     insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getField🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 114                 }                                                                                        </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 115                 upload = dbConn.prepareStatement(insertQuery);                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116             } else {                                                                                     </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117                 throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119                                                                                                          </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120             if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                 </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121                 LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122                                                                                                          </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123                 timerService = new ScheduledThreadPoolExecutor(1);                                       </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124                 timerService.scheduleAtFixedRate(() -&gt; {                                                 </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125                     submitExecuteBatch();                                                                </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126                 }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129                                                                                                          </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130         } catch (SQLException sqe) {                                                                     </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131             LOG.error(&quot;&quot;, sqe);                                                                          </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132             throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                   </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133         } catch (ClassNotFoundException cnfe) {                                                          </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134             LOG.error(&quot;&quot;, cnfe);                                                                         </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135             throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139                                                                                                          </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140     public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {   </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141         Connection connection ;                                                                          </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142         JDBCUtils.forName(drivername, getClass().getClassLoader());                                      </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143         if (username == null) {                                                                          </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144             connection = DriverManager.getConnection(dbURL);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145         } else {                                                                                         </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146             connection = DriverManager.getConnection(dbURL, username, password);                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147         }                                                                                                </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148         connection.setAutoCommit(false);                                                                 </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149         return connection;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152     /**                                                                                                  </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153      * Adds a record to the prepared statement.                                                          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154      * &lt;p&gt;                                                                                               </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155      * When this method is called, the output format is guaranteed to be opened.                         </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156      * &lt;/p&gt;                                                                                              </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157      * &lt;p&gt;                                                                                               </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 158      * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 158      * WARNING: this may fail when no column types specified (because a best effort approach is attempted🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 159      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 159      * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObje🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160      *                                                                                                   </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161      * @param tuple2 The records to add to the output.                                                   </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162      * @throws IOException Thrown, if the records could not be added due to an I/O problem.              </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163      * @see PreparedStatement                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165     @Override                                                                                            </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166     public void writeRecord(Tuple2 tuple2)  {                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167                                                                                                          </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168         Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                        </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169         Boolean retract = tupleTrans.getField(0);                                                        </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170         Row row = tupleTrans.getField(1);                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171                                                                                                          </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172         if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {        </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 173             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);"> 173             LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175                                                                                                          </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176         if (retract) {                                                                                   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 177                                                                                                          </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 178             if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                      </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179                 LOG.info(&quot;Receive data : {}&quot;, row);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181                                                                                                          </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182             outRecords.inc();                                                                            </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183             insertWrite(row);                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184         } else {                                                                                         </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185             //do nothing                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 188                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189                                                                                                          </span>
<span class="2080741281463881552" onmouseenter="enter('2080741281463881552');" onmouseout="out('2080741281463881552');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 190     private void insertWrite(Row row)  {                                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191         try {                                                                                            </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 192             if (batchNum == 1) {                                                                         </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193                 writeSingleRecord(row);                                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194             } else {                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195                 updatePreparedStmt(row, upload);                                                         </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 196                 rows.add(row);                                                                           </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 197                 upload.addBatch();                                                                       </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 198                 if (rows.size() &gt;= batchNum) {                                                           </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 199                     submitExecuteBatch();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 200                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 201             }                                                                                            </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 202         } catch (SQLException e) {                                                                       </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 203             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 204                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 205                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 205                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 206                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 207             } else {                                                                                     </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 208                 outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 209             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 210         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 211                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 212     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 213                                                                                                          </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 214     private void writeSingleRecord(Row row) {                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 215         try {                                                                                            </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 216             updatePreparedStmt(row, upload);                                                             </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 217             upload.executeUpdate();                                                                      </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 218             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 219         } catch (SQLException e) {                                                                       </span>
<span class="-6799605853464900245" onmouseenter="enter('-6799605853464900245');" onmouseout="out('-6799605853464900245');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 220             dealSQLException(e);                                                                         </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 221             if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {       </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 222                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 222                 LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.get🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 223                 LOG.error(&quot;&quot;, e);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225                                                                                                          </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 226             outDirtyRecords.inc();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 227         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 228     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 229                                                                                                          </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 230     private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {              </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 231         if (typesArray == null) {                                                                        </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 232             // no types provided                                                                         </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 233             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 234                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 234                 LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;,🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 235                 pstmt.setObject(index + 1, row.getField(index));                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 236             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 237         } else {                                                                                         </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 238             // types provided                                                                            </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 239             for (int index = 0; index &lt; row.getArity(); index++) {                                       </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 240                                                                                                          </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 241                 if (row.getField(index) == null) {                                                       </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 242                     pstmt.setNull(index + 1, typesArray[index]);                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 243                 } else {                                                                                 </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 244                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 244                     // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 245                     switch (typesArray[index]) {                                                         </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 246                         case java.sql.Types.NULL:                                                        </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 247                             pstmt.setNull(index + 1, typesArray[index]);                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 248                             break;                                                                       </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 249                         case java.sql.Types.BOOLEAN:                                                     </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 250                         case java.sql.Types.BIT:                                                         </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 251                             pstmt.setBoolean(index + 1, (boolean) row.getField(index));                  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 252                             break;                                                                       </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 253                         case java.sql.Types.CHAR:                                                        </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 254                         case java.sql.Types.NCHAR:                                                       </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 255                         case java.sql.Types.VARCHAR:                                                     </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 256                         case java.sql.Types.LONGVARCHAR:                                                 </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 257                         case java.sql.Types.LONGNVARCHAR:                                                </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 258                             pstmt.setString(index + 1, (String) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 259                             break;                                                                       </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 260                         case java.sql.Types.TINYINT:                                                     </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 261                             pstmt.setByte(index + 1, (byte) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 262                             break;                                                                       </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263                         case java.sql.Types.SMALLINT:                                                    </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264                             pstmt.setShort(index + 1, (short) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265                             break;                                                                       </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266                         case java.sql.Types.INTEGER:                                                     </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267                             pstmt.setInt(index + 1, (int) row.getField(index));                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268                             break;                                                                       </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269                         case java.sql.Types.BIGINT:                                                      </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 270                             pstmt.setLong(index + 1, (long) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 271                             break;                                                                       </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 272                         case java.sql.Types.REAL:                                                        </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 273                         case java.sql.Types.FLOAT:                                                       </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 274                             pstmt.setFloat(index + 1, (float) row.getField(index));                      </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 275                             break;                                                                       </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 276                         case java.sql.Types.DOUBLE:                                                      </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 277                             pstmt.setDouble(index + 1, (double) row.getField(index));                    </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 278                             break;                                                                       </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 279                         case java.sql.Types.DECIMAL:                                                     </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 280                         case java.sql.Types.NUMERIC:                                                     </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 281                             pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));  </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 282                             break;                                                                       </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 283                         case java.sql.Types.DATE:                                                        </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 284                             pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 285                             break;                                                                       </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 286                         case java.sql.Types.TIME:                                                        </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 287                             pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 288                             break;                                                                       </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 289                         case java.sql.Types.TIMESTAMP:                                                   </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 290                             pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 291                             break;                                                                       </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 292                         case java.sql.Types.BINARY:                                                      </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 293                         case java.sql.Types.VARBINARY:                                                   </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 294                         case java.sql.Types.LONGVARBINARY:                                               </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 295                             pstmt.setBytes(index + 1, (byte[]) row.getField(index));                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 296                             break;                                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 297                         default:                                                                         </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 298                             pstmt.setObject(index + 1, row.getField(index));                             </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 299                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 299                             LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set 🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 300                                     typesArray[index], index + 1, row.getField(index));                  </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 301                             // case java.sql.Types.SQLXML                                                </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302                             // case java.sql.Types.ARRAY:                                                </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303                             // case java.sql.Types.JAVA_OBJECT:                                          </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304                             // case java.sql.Types.BLOB:                                                 </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305                             // case java.sql.Types.CLOB:                                                 </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306                             // case java.sql.Types.NCLOB:                                                </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307                             // case java.sql.Types.DATALINK:                                             </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308                             // case java.sql.Types.DISTINCT:                                             </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309                             // case java.sql.Types.OTHER:                                                </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 310                             // case java.sql.Types.REF:                                                  </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 311                             // case java.sql.Types.ROWID:                                                </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 312                             // case java.sql.Types.STRUC                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 313                     }                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 314                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 315             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 316         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 317     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 318                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 319                                                                                                          </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 320     private synchronized void submitExecuteBatch() {                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 321         try {                                                                                            </span>
<span class="6813843412968272702" onmouseenter="enter('6813843412968272702');" onmouseout="out('6813843412968272702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 322             regularlyCheckConnection();                                                                  </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 323             this.upload.executeBatch();                                                                  </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 324             dbConn.commit();                                                                             </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 325         } catch (SQLException e) {                                                                       </span>
<span class="-9174161656279899685" onmouseenter="enter('-9174161656279899685');" onmouseout="out('-9174161656279899685');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 326             LOG.warn(&quot;submitExecuteBatch error {}&quot;, e);                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 327             try {                                                                                        </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 328                 dbConn.rollback();                                                                       </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 329             } catch (SQLException e1) {                                                                  </span>
<span class="246786700485249677" onmouseenter="enter('246786700485249677');" onmouseout="out('246786700485249677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 330                 dealSQLException(e1);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 331             }                                                                                            </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 332             rows.forEach(this::writeSingleRecord);                                                       </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 333         } finally {                                                                                      </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 334             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 335         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 336     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 337                                                                                                          </span>
<span class="-3874353238638658215" onmouseenter="enter('-3874353238638658215');" onmouseout="out('-3874353238638658215');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 338     private void dealSQLException(Exception e) {                                                         </span>
<span class="6407700796198700478" onmouseenter="enter('6407700796198700478');" onmouseout="out('6407700796198700478');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 339         EConnectionErrorCode errorCode = EConnectionErrorCode.resolveErrorCodeFromException(e);          </span>
<span class="-3680639726838673504" onmouseenter="enter('-3680639726838673504');" onmouseout="out('-3680639726838673504');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 340         switch (errorCode) {                                                                             </span>
<span class="1225374239746753698" onmouseenter="enter('1225374239746753698');" onmouseout="out('1225374239746753698');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 341             case CONN_DB_INVALID:                                                                        </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 342                 reconnection();                                                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 343                 break;                                                                                   </span>
<span class="1755343140467316574" onmouseenter="enter('1755343140467316574');" onmouseout="out('1755343140467316574');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 344             case CONN_DB_FAILED:                                                                         </span>
<span class="-1198874643364045165" onmouseenter="enter('-1198874643364045165');" onmouseout="out('-1198874643364045165');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 345             case DB_TABLE_NOT_EXIST:                                                                     </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 346                 throw new RuntimeException(e);                                                           </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 347             default:                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 348         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 349     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 350                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 351                                                                                                          </span>
<span class="-1258602931071673845" onmouseenter="enter('-1258602931071673845');" onmouseout="out('-1258602931071673845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 352     private void regularlyCheckConnection() throws SQLException {                                        </span>
<span class="-1222192591979868781" onmouseenter="enter('-1222192591979868781');" onmouseout="out('-1222192591979868781');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 353         checkTimes++;                                                                                    </span>
<span class="-5151471990775264393" onmouseenter="enter('-5151471990775264393');" onmouseout="out('-5151471990775264393');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 354         if (checkTimes % CONNECTION_CHECK_FREQUENCY != 0) {                                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 355             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356         }                                                                                                </span>
<span class="5795923628795732420" onmouseenter="enter('5795923628795732420');" onmouseout="out('5795923628795732420');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357         LOG.warn(&quot;db connection Valid check !&quot;);                                                         </span>
<span class="8215065968495159984" onmouseenter="enter('8215065968495159984');" onmouseout="out('8215065968495159984');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358         if (dbConn.isClosed() || !dbConn.isValid(100)) {                                                 </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359             reconnection();                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360         }                                                                                                </span>
<span class="-8215063589164597765" onmouseenter="enter('-8215063589164597765');" onmouseout="out('-8215063589164597765');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361         checkTimes = 0;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 362     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 363                                                                                                          </span>
<span class="-5737401042898679127" onmouseenter="enter('-5737401042898679127');" onmouseout="out('-5737401042898679127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364     public void reconnection() throws RuntimeException {                                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365         try {                                                                                            </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366             LOG.info(&quot;db connection reconnect..&quot;);                                                       </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 367             dbConn = establishConnection();                                                              </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368             upload = dbConn.prepareStatement(insertQuery);                                               </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369             this.dbConn = dbConn;                                                                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370         } catch (Exception e) {                                                                          </span>
<span class="5310062978023364230" onmouseenter="enter('5310062978023364230');" onmouseout="out('5310062978023364230');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371             throw new RuntimeException(&quot;connection open failed..&quot;, e);                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375     /**                                                                                                  </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376      * Executes prepared statement and closes all resources of this instance.                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377      *                                                                                                   </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378      * @throws IOException Thrown, if the input could not be closed properly.                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379      */                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380     @Override                                                                                            </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381     public void close() throws IOException {                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382         try {                                                                                            </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383             if (upload != null) {                                                                        </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384                 upload.executeBatch();                                                                   </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385                 upload.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386             }                                                                                            </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387             if (null != timerService) {                                                                  </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388                 timerService.shutdown();                                                                 </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                 LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393         } finally {                                                                                      </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394             upload = null;                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395             rows.clear();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397                                                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398         try {                                                                                            </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399             if (dbConn != null) {                                                                        </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400                 dbConn.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401             }                                                                                            </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402         } catch (SQLException se) {                                                                      </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403             LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                           </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404         } finally {                                                                                      </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405             dbConn = null;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409                                                                                                          </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410     public boolean isReplaceInsertQuery() throws SQLException {                                          </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 411         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413                                                                                                          </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414     public void verifyField() {                                                                          </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415         if (StringUtils.isBlank(username)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417         }                                                                                                </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418         if (StringUtils.isBlank(password)) {                                                             </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419             LOG.warn(&quot;Username was not supplied separately.&quot;);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420         }                                                                                                </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421         if (StringUtils.isBlank(dbURL)) {                                                                </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422             throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423         }                                                                                                </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424         if (StringUtils.isBlank(insertQuery)) {                                                          </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425             throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426         }                                                                                                </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427         if (StringUtils.isBlank(drivername)) {                                                           </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428             throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432                                                                                                          </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433     public void setUsername(String username) {                                                           </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434         this.username = username;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 435     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436                                                                                                          </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437     public String getSchema() {                                                                          </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438         if (StringUtils.isNotEmpty(schema)) {                                                            </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439             return schema;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440         }                                                                                                </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441         return null;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443                                                                                                          </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444     public void setSchema(String schema) {                                                               </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445         this.schema = schema;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                                                                                                          </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448     public boolean existTabname() throws SQLException {                                                  </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449         return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451                                                                                                          </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452     public void setPassword(String password) {                                                           </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453         this.password = password;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455                                                                                                          </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456     public void setDrivername(String drivername) {                                                       </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457         this.drivername = drivername;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459                                                                                                          </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460     public String getDrivername() {                                                                      </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461         return this.drivername;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463                                                                                                          </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464     public void setDbURL(String dbURL) {                                                                 </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 465         this.dbURL = dbURL;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 466     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 467                                                                                                          </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 468     public void setTableName(String tableName) {                                                         </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 469         this.tableName = tableName;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 470     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 471                                                                                                          </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 472     public void setDbType(String dbType) {                                                               </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 473         this.dbType = dbType;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 474     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 475                                                                                                          </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 476     public void setDbSink(RdbSink dbSink) {                                                              </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 477         this.dbSink = dbSink;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 478     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 479                                                                                                          </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 480     public void setBatchNum(int batchNum) {                                                              </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 481         this.batchNum = batchNum;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 482     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 483                                                                                                          </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 484     public void setInsertQuery(String insertQuery) {                                                     </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 485         this.insertQuery = insertQuery;                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 486     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 487                                                                                                          </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 488     public void setTypesArray(int[] typesArray) {                                                        </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 489         this.typesArray = typesArray;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 490     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 491                                                                                                          </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 492     public String getDbType() {                                                                          </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 493         return dbType;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 494     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 495                                                                                                          </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 496     public RdbSink getDbSink() {                                                                         </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 497         return dbSink;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 498     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 499                                                                                                          </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 500     public Connection getDbConn() {                                                                      </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 501         return dbConn;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 502     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 503                                                                                                          </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 504     public String getTableName() {                                                                       </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 505         return tableName;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507                                                                                                          </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508     public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                     </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509         this.realIndexes.put(index, fieldes);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511                                                                                                          </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 512     public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                   </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513         return realIndexes;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515                                                                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516                                                                                                          </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517     public void setBatchWaitInterval(long batchWaitInterval) {                                           </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518         this.batchWaitInterval = batchWaitInterval;                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520                                                                                                          </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521     public List&lt;String&gt; getFullField() {                                                                 </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522         return fullField;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524                                                                                                          </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525     public void fullFieldAdd(String colName) {                                                           </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526         this.fullField.add(colName);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528 }                                                                                                        </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 529 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>



















































































































































































































































































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   1 -/*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   2 - * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   3 - * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   4 - * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   5 - * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   6 - * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   7 - * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   8 - * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">   9 - *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  10 - *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  11 - *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  12 - * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  13 - * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  14 - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  15 - * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  16 - * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  17 - */                                                                                                               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  18 -                                                                                                                  </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -package com.dtstack.flink.sql.sink.rdb.format;                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -                                                                                                                  </span>

<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                                    </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import com.dtstack.flink.sql.util.JDBCUtils;                                                                      </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  27 -import com.google.common.collect.Maps;                                                                            </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  29 -import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  30 -import org.slf4j.LoggerFactory;                                                                                   </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  31 -import java.io.IOException;                                                                                       </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import java.sql.Connection;                                                                                       </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import java.sql.DriverManager;                                                                                    </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import java.sql.PreparedStatement;                                                                                </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  35 -import java.sql.SQLException;                                                                                     </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  39 -import java.util.Map;                                                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  40 -import java.util.concurrent.ScheduledThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  42 -                                                                                                                  </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  43 -import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -/**                                                                                                               </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  46 - * OutputFormat to write tuples into a database.                                                                  </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 - * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 - *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 - */                                                                                                               </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                                 </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -    private static final long serialVersionUID = 1L;                                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -                                                                                                                  </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -    private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -                                                                                                                  </span>


<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -    private String username;                                                                                      </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -    private String password;                                                                                      </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -    private String drivername;                                                                                    </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -    private String dbURL;                                                                                         </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -    private String tableName;                                                                                     </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -    private String dbType;                                                                                        </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -    private String schema;                                                                                        </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -    private RdbSink dbSink;                                                                                       </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -    // trigger preparedStatement execute batch interval                                                           </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -    private long batchWaitInterval = 10000l;                                                                      </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -    // PreparedStatement execute batch num                                                                        </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -    private int batchNum = 100;                                                                                   </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -    private String insertQuery;                                                                                   </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -    public int[] typesArray;                                                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -                                                                                                                  </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -    /** 存储用于批量写入的数据 */                                                                                            </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -    protected List&lt;Row&gt; rows = new ArrayList();                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -                                                                                                                  </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -    private Connection dbConn;                                                                                    </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -    private PreparedStatement upload;                                                                             </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -    private transient ScheduledThreadPoolExecutor timerService;                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -    //index field                                                                                                 </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -    private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                            </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -    //full field                                                                                                  </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -    private List&lt;String&gt; fullField = Lists.newArrayList();                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -                                                                                                                  </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -    public RetractJDBCOutputFormat() {                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -    @Override                                                                                                     </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -    public void configure(Configuration parameters) {                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -    /**                                                                                                           </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -     * Connects to the target database and initializes the prepared statement.                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -     *                                                                                                            </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -     * @param taskNumber The number of the parallel instance.                                                     </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -     * @throws IOException Thrown, if the output could not be opened due to an                                    </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -     *                     I/O problem.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -     */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -    @Override                                                                                                     </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -    public void open(int taskNumber, int numTasks) throws IOException {                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -        try {                                                                                                     </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -            LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                                      </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -            dbConn = establishConnection();                                                                       </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -            initMetric();                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -                                                                                                                  </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -            if (existTabname()) {                                                                                 </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -                if (isReplaceInsertQuery()) {                                                                     </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 106 -                    insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 106 -                    insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()),🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -                }                                                                                                 </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -                upload = dbConn.prepareStatement(insertQuery);                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -            } else {                                                                                              </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -                throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -                                                                                                                  </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -            if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                          </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -                LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -                                                                                                                  </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                timerService = new ScheduledThreadPoolExecutor(1);                                                </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 117 -                timerService.scheduleAtFixedRate(() -&gt; {                                                          </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 118 -                    submitExecuteBatch();                                                                         </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -                }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -                                                                                                                  </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        } catch (SQLException sqe) {                                                                              </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -            LOG.error(&quot;&quot;, sqe);                                                                                   </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -            throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                            </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -        } catch (ClassNotFoundException cnfe) {                                                                   </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -            LOG.error(&quot;&quot;, cnfe);                                                                                  </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -            throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -                                                                                                                  </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -    public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {            </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -        Connection connection ;                                                                                   </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        JDBCUtils.forName(drivername, getClass().getClassLoader());                                               </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        if (username == null) {                                                                                   </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -            connection = DriverManager.getConnection(dbURL);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -        } else {                                                                                                  </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -            connection = DriverManager.getConnection(dbURL, username, password);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -        }                                                                                                         </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        connection.setAutoCommit(false);                                                                          </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        return connection;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -    /**                                                                                                           </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -     * Adds a record to the prepared statement.                                                                   </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -     * &lt;p&gt;                                                                                                        </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -     * When this method is called, the output format is guaranteed to be opened.                                  </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -     * &lt;/p&gt;                                                                                                       </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -     * &lt;p&gt;                                                                                                        </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 151 -     * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 151 -     * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 152 -     * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 152 -     * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, n🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -     *                                                                                                            </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -     * @param tuple2 The records to add to the output.                                                            </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 155 -     * @throws IOException Thrown, if the records could not be added due to an I/O problem.                       </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -     * @see PreparedStatement                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 157 -     */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -    @Override                                                                                                     </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -    public void writeRecord(Tuple2 tuple2)  {                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -                                                                                                                  </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -        Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                                 </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -        Boolean retract = tupleTrans.getField(0);                                                                 </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -        Row row = tupleTrans.getField(1);                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -                                                                                                                  </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -        if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {                 </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -            LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -                                                                                                                  </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -        if (retract) {                                                                                            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                                                                                                                  </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -            if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                               </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -                LOG.info(&quot;Receive data : {}&quot;, row);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -                                                                                                                  </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -            outRecords.inc();                                                                                     </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -            insertWrite(row);                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -        } else {                                                                                                  </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -            //do nothing                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                                                                                                                  </span>
<span class="-4476666207180013827" onmouseenter="enter('-4476666207180013827');" onmouseout="out('-4476666207180013827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -    private void insertWrite(Row row) {                                                                           </span>
<span class="-1086395285886649574" onmouseenter="enter('-1086395285886649574');" onmouseout="out('-1086395285886649574');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -        checkConnectionOpen(dbConn);                                                                              </span>

<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -        try {                                                                                                     </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -            if (batchNum == 1) {                                                                                  </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -                writeSingleRecord(row);                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -            } else {                                                                                              </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -                updatePreparedStmt(row, upload);                                                                  </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                rows.add(row);                                                                                    </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -                upload.addBatch();                                                                                </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -                if (rows.size() &gt;= batchNum) {                                                                    </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -                    submitExecuteBatch();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -            }                                                                                                     </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -        } catch (SQLException e) {                                                                                </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -            if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {                </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                                      </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 199 -                LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 199 -                LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), 🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -                LOG.error(&quot;&quot;, e);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -            } else {                                                                                              </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                                                                                                                  </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -    private void writeSingleRecord(Row row) {                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -        try {                                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -            updatePreparedStmt(row, upload);                                                                      </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            upload.executeUpdate();                                                                               </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -            dbConn.commit();                                                                                      </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -        } catch (SQLException e) {                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -                                                                                                                  </span>

<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -            if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {                </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 218 -                LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 218 -                LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), 🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -                LOG.error(&quot;&quot;, e);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -                                                                                                                  </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -            outDirtyRecords.inc();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -                                                                                                                  </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -    private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {                       </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -        if (typesArray == null) {                                                                                 </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -            // no types provided                                                                                  </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -            for (int index = 0; index &lt; row.getArity(); index++) {                                                </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 230 -                LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 230 -                LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -                pstmt.setObject(index + 1, row.getField(index));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -            }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -        } else {                                                                                                  </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -            // types provided                                                                                     </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -            for (int index = 0; index &lt; row.getArity(); index++) {                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -                                                                                                                  </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -                if (row.getField(index) == null) {                                                                </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -                    pstmt.setNull(index + 1, typesArray[index]);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -                } else {                                                                                          </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 240 -                    // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 240 -                    // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -                    switch (typesArray[index]) {                                                                  </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -                        case java.sql.Types.NULL:                                                                 </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                            pstmt.setNull(index + 1, typesArray[index]);                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -                            break;                                                                                </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -                        case java.sql.Types.BOOLEAN:                                                              </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                        case java.sql.Types.BIT:                                                                  </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                            pstmt.setBoolean(index + 1, (boolean) row.getField(index));                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                            break;                                                                                </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -                        case java.sql.Types.CHAR:                                                                 </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -                        case java.sql.Types.NCHAR:                                                                </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                        case java.sql.Types.VARCHAR:                                                              </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                        case java.sql.Types.LONGVARCHAR:                                                          </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                        case java.sql.Types.LONGNVARCHAR:                                                         </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                            pstmt.setString(index + 1, (String) row.getField(index));                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                            break;                                                                                </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -                        case java.sql.Types.TINYINT:                                                              </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -                            pstmt.setByte(index + 1, (byte) row.getField(index));                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -                            break;                                                                                </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -                        case java.sql.Types.SMALLINT:                                                             </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                            pstmt.setShort(index + 1, (short) row.getField(index));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -                            break;                                                                                </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -                        case java.sql.Types.INTEGER:                                                              </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -                            pstmt.setInt(index + 1, (int) row.getField(index));                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -                            break;                                                                                </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -                        case java.sql.Types.BIGINT:                                                               </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -                            pstmt.setLong(index + 1, (long) row.getField(index));                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -                            break;                                                                                </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -                        case java.sql.Types.REAL:                                                                 </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                        case java.sql.Types.FLOAT:                                                                </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -                            pstmt.setFloat(index + 1, (float) row.getField(index));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                            break;                                                                                </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -                        case java.sql.Types.DOUBLE:                                                               </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                            pstmt.setDouble(index + 1, (double) row.getField(index));                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -                            break;                                                                                </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -                        case java.sql.Types.DECIMAL:                                                              </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -                        case java.sql.Types.NUMERIC:                                                              </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -                            pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -                            break;                                                                                </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                        case java.sql.Types.DATE:                                                                 </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -                            pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -                            break;                                                                                </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -                        case java.sql.Types.TIME:                                                                 </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -                            pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -                            break;                                                                                </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -                        case java.sql.Types.TIMESTAMP:                                                            </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -                            pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -                            break;                                                                                </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -                        case java.sql.Types.BINARY:                                                               </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -                        case java.sql.Types.VARBINARY:                                                            </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -                        case java.sql.Types.LONGVARBINARY:                                                        </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -                            pstmt.setBytes(index + 1, (byte[]) row.getField(index));                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -                            break;                                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -                        default:                                                                                  </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                            pstmt.setObject(index + 1, row.getField(index));                                      </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 295 -                            LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 295 -                            LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -                                    typesArray[index], index + 1, row.getField(index));                           </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -                            // case java.sql.Types.SQLXML                                                         </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -                            // case java.sql.Types.ARRAY:                                                         </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -                            // case java.sql.Types.JAVA_OBJECT:                                                   </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -                            // case java.sql.Types.BLOB:                                                          </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -                            // case java.sql.Types.CLOB:                                                          </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -                            // case java.sql.Types.NCLOB:                                                         </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -                            // case java.sql.Types.DATALINK:                                                      </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 304 -                            // case java.sql.Types.DISTINCT:                                                      </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 305 -                            // case java.sql.Types.OTHER:                                                         </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 306 -                            // case java.sql.Types.REF:                                                           </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 307 -                            // case java.sql.Types.ROWID:                                                         </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 308 -                            // case java.sql.Types.STRUC                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 309 -                    }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 310 -                }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 311 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 312 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 313 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 314 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 315 -                                                                                                                  </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 316 -    private synchronized void submitExecuteBatch() {                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 317 -        try {                                                                                                     </span>

<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 318 -            this.upload.executeBatch();                                                                           </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 319 -            dbConn.commit();                                                                                      </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 320 -        } catch (SQLException e) {                                                                                </span>

<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 321 -            try {                                                                                                 </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 322 -                dbConn.rollback();                                                                                </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 323 -            } catch (SQLException e1) {                                                                           </span>
<span class="-7536698771404360230" onmouseenter="enter('-7536698771404360230');" onmouseout="out('-7536698771404360230');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 324 -                LOG.error(&quot;rollback  data error !&quot;, e);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 325 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 326 -                                                                                                                  </span>


<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 327 -            rows.forEach(this::writeSingleRecord);                                                                </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 328 -        } finally {                                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 329 -            rows.clear();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 330 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 331 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 332 -                                                                                                                  </span>
<span class="-3522961204041572073" onmouseenter="enter('-3522961204041572073');" onmouseout="out('-3522961204041572073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 333 -    private void checkConnectionOpen(Connection dbConn) {                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 334 -        try {                                                                                                     </span>
<span class="-2855961023100454886" onmouseenter="enter('-2855961023100454886');" onmouseout="out('-2855961023100454886');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 335 -            if (dbConn.isClosed()) {                                                                              </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -                LOG.info(&quot;db connection reconnect..&quot;);                                                            </span>
<span class="-4293595830544602858" onmouseenter="enter('-4293595830544602858');" onmouseout="out('-4293595830544602858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 337 -                dbConn= establishConnection();                                                                    </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 338 -                upload = dbConn.prepareStatement(insertQuery);                                                    </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 339 -                this.dbConn = dbConn;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 340 -            }                                                                                                     </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -        } catch (SQLException e) {                                                                                </span>
<span class="814403640845951473" onmouseenter="enter('814403640845951473');" onmouseout="out('814403640845951473');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 342 -            LOG.error(&quot;check connection open failed..&quot;, e);                                                       </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 343 -        } catch (ClassNotFoundException e) {                                                                      </span>
<span class="1123805251307592465" onmouseenter="enter('1123805251307592465');" onmouseout="out('1123805251307592465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 344 -            LOG.error(&quot;load jdbc class error when reconnect db..&quot;, e);                                            </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 345 -        } catch (IOException e) {                                                                                 </span>
<span class="-720388217547677793" onmouseenter="enter('-720388217547677793');" onmouseout="out('-720388217547677793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 346 -            LOG.error(&quot;kerberos authentication failed..&quot;, e);                                                     </span>


































<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 347 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 348 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 349 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 350 -    /**                                                                                                           </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 351 -     * Executes prepared statement and closes all resources of this instance.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 352 -     *                                                                                                            </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 353 -     * @throws IOException Thrown, if the input could not be closed properly.                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 354 -     */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 355 -    @Override                                                                                                     </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 356 -    public void close() throws IOException {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 357 -        try {                                                                                                     </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 358 -            if (upload != null) {                                                                                 </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 359 -                upload.executeBatch();                                                                            </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 360 -                upload.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 361 -            }                                                                                                     </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 362 -            if (null != timerService) {                                                                           </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 363 -                timerService.shutdown();                                                                          </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 364 -                LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 365 -            }                                                                                                     </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 366 -        } catch (SQLException se) {                                                                               </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 367 -            LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 368 -        } finally {                                                                                               </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 369 -            upload = null;                                                                                        </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 370 -            rows.clear();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 371 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 372 -                                                                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 373 -        try {                                                                                                     </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 374 -            if (dbConn != null) {                                                                                 </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 375 -                dbConn.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 376 -            }                                                                                                     </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 377 -        } catch (SQLException se) {                                                                               </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 378 -            LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 379 -        } finally {                                                                                               </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 380 -            dbConn = null;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 381 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 382 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 383 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 384 -                                                                                                                  </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 385 -    public boolean isReplaceInsertQuery() throws SQLException {                                                   </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 386 -        return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 387 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 388 -                                                                                                                  </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 389 -    public void verifyField() {                                                                                   </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 390 -        if (StringUtils.isBlank(username)) {                                                                      </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 391 -            LOG.warn(&quot;Username was not supplied separately.&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 392 -        }                                                                                                         </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 393 -        if (StringUtils.isBlank(password)) {                                                                      </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 394 -            LOG.warn(&quot;Username was not supplied separately.&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 395 -        }                                                                                                         </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 396 -        if (StringUtils.isBlank(dbURL)) {                                                                         </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 397 -            throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 398 -        }                                                                                                         </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 399 -        if (StringUtils.isBlank(insertQuery)) {                                                                   </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 400 -            throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 401 -        }                                                                                                         </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 402 -        if (StringUtils.isBlank(drivername)) {                                                                    </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 403 -            throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 404 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 405 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 406 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 407 -                                                                                                                  </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 408 -    public void setUsername(String username) {                                                                    </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 409 -        this.username = username;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 410 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 411 -                                                                                                                  </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 412 -    public String getSchema() {                                                                                   </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 413 -        if (StringUtils.isNotEmpty(schema)) {                                                                     </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 414 -            return schema;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 415 -        }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 416 -        return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 417 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 418 -                                                                                                                  </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 419 -    public void setSchema(String schema) {                                                                        </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 420 -        this.schema = schema;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 421 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 422 -                                                                                                                  </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 423 -    public boolean existTabname() throws SQLException {                                                           </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 424 -        return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 425 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 426 -                                                                                                                  </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 427 -    public void setPassword(String password) {                                                                    </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 428 -        this.password = password;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 429 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 430 -                                                                                                                  </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 431 -    public void setDrivername(String drivername) {                                                                </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 432 -        this.drivername = drivername;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 433 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 434 -                                                                                                                  </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 435 -    public String getDrivername() {                                                                               </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 436 -        return this.drivername;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 437 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 438 -                                                                                                                  </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 439 -    public void setDbURL(String dbURL) {                                                                          </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 440 -        this.dbURL = dbURL;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 441 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 442 -                                                                                                                  </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 443 -    public void setTableName(String tableName) {                                                                  </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 444 -        this.tableName = tableName;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 445 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 446 -                                                                                                                  </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 447 -    public void setDbType(String dbType) {                                                                        </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 448 -        this.dbType = dbType;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 449 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 450 -                                                                                                                  </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 451 -    public void setDbSink(RdbSink dbSink) {                                                                       </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 452 -        this.dbSink = dbSink;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 453 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 454 -                                                                                                                  </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 455 -    public void setBatchNum(int batchNum) {                                                                       </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 456 -        this.batchNum = batchNum;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 457 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 458 -                                                                                                                  </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 459 -    public void setInsertQuery(String insertQuery) {                                                              </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 460 -        this.insertQuery = insertQuery;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 461 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 462 -                                                                                                                  </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 463 -    public void setTypesArray(int[] typesArray) {                                                                 </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 464 -        this.typesArray = typesArray;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 465 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 466 -                                                                                                                  </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 467 -    public String getDbType() {                                                                                   </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 468 -        return dbType;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 469 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 470 -                                                                                                                  </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 471 -    public RdbSink getDbSink() {                                                                                  </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 472 -        return dbSink;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 473 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 474 -                                                                                                                  </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 475 -    public Connection getDbConn() {                                                                               </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 476 -        return dbConn;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 477 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 478 -                                                                                                                  </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 479 -    public String getTableName() {                                                                                </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 480 -        return tableName;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 481 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 482 -                                                                                                                  </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 483 -    public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                              </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 484 -        this.realIndexes.put(index, fieldes);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 485 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 486 -                                                                                                                  </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 487 -    public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                            </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 488 -        return realIndexes;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 489 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 490 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 491 -                                                                                                                  </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 492 -    public void setBatchWaitInterval(long batchWaitInterval) {                                                    </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 493 -        this.batchWaitInterval = batchWaitInterval;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 494 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 495 -                                                                                                                  </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 496 -    public List&lt;String&gt; getFullField() {                                                                          </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 497 -        return fullField;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 498 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 499 -                                                                                                                  </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 500 -    public void fullFieldAdd(String colName) {                                                                    </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 501 -        this.fullField.add(colName);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 502 -    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 503 -}                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-7763894389533695672" onmouseenter="enter('-7763894389533695672');" onmouseout="out('-7763894389533695672');" style="">  19  package com.dtstack.flink.sql.sink.rdb.format;                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="-3311622777804768870" onmouseenter="enter('-3311622777804768870');" onmouseout="out('-3311622777804768870');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  21 +import com.dtstack.flink.sql.enums.EConnectionErrorCode;                                                          </span>
<span class="5448403155483785742" onmouseenter="enter('5448403155483785742');" onmouseout="out('5448403155483785742');" style="">  22  import com.dtstack.flink.sql.sink.rdb.RdbSink;                                                                    </span>
<span class="2068796536125305875" onmouseenter="enter('2068796536125305875');" onmouseout="out('2068796536125305875');" style="">  23  import com.dtstack.flink.sql.util.JDBCUtils;                                                                      </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  24  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  25  import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  26  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  27  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  28  import com.google.common.collect.Maps;                                                                            </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  29  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  30  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  31  import org.slf4j.LoggerFactory;                                                                                   </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  32  import java.io.IOException;                                                                                       </span>
<span class="-7136330293413175449" onmouseenter="enter('-7136330293413175449');" onmouseout="out('-7136330293413175449');" style="">  33  import java.sql.Connection;                                                                                       </span>
<span class="7894029524760905232" onmouseenter="enter('7894029524760905232');" onmouseout="out('7894029524760905232');" style="">  34  import java.sql.DriverManager;                                                                                    </span>
<span class="-3337023324264694028" onmouseenter="enter('-3337023324264694028');" onmouseout="out('-3337023324264694028');" style="">  35  import java.sql.PreparedStatement;                                                                                </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  36  import java.sql.SQLException;                                                                                     </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  37  import java.util.ArrayList;                                                                                       </span>
<span class="-28465676010609596" onmouseenter="enter('-28465676010609596');" onmouseout="out('-28465676010609596');" style="">  38  import java.util.Arrays;                                                                                          </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  39  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  40  import java.util.Map;                                                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  41  import java.util.concurrent.ScheduledThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  42  import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  43                                                                                                                    </span>
<span class="-9119219960338019666" onmouseenter="enter('-9119219960338019666');" onmouseout="out('-9119219960338019666');" style="">  44  import com.dtstack.flink.sql.outputformat.DtRichOutputFormat;                                                     </span>
<span  style="">  45                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46  /**                                                                                                               </span>
<span class="-2673493163237022733" onmouseenter="enter('-2673493163237022733');" onmouseout="out('-2673493163237022733');" style="">  47   * OutputFormat to write tuples into a database.                                                                  </span>
<span class="7176247636190616595" onmouseenter="enter('7176247636190616595');" onmouseout="out('7176247636190616595');" style="">  48   * The OutputFormat has to be configured using the supplied OutputFormatBuilder.                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  49   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  50   */                                                                                                               </span>
<span class="-2898283232036938566" onmouseenter="enter('-2898283232036938566');" onmouseout="out('-2898283232036938566');" style="">  51  public class RetractJDBCOutputFormat extends DtRichOutputFormat {                                                 </span>
<span class="-4645219268431852454" onmouseenter="enter('-4645219268431852454');" onmouseout="out('-4645219268431852454');" style="">  52      private static final long serialVersionUID = 1L;                                                              </span>
<span  style="">  53                                                                                                                    </span>
<span class="1059511739915118618" onmouseenter="enter('1059511739915118618');" onmouseout="out('1059511739915118618');" style="">  54      private static final Logger LOG = LoggerFactory.getLogger(RetractJDBCOutputFormat.class);                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -                                                                                                                  </span>
<span class="-5647401529104718799" onmouseenter="enter('-5647401529104718799');" onmouseout="out('-5647401529104718799');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +    private static final int CONNECTION_CHECK_FREQUENCY = 100;                                                    </span>
<span class="4613588471810503867" onmouseenter="enter('4613588471810503867');" onmouseout="out('4613588471810503867');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +    private int checkTimes;                                                                                       </span>
<span class="7229268647485028444" onmouseenter="enter('7229268647485028444');" onmouseout="out('7229268647485028444');" style="">  58      private String username;                                                                                      </span>
<span class="5733369821133183434" onmouseenter="enter('5733369821133183434');" onmouseout="out('5733369821133183434');" style="">  59      private String password;                                                                                      </span>
<span class="-4070916161624333342" onmouseenter="enter('-4070916161624333342');" onmouseout="out('-4070916161624333342');" style="">  60      private String drivername;                                                                                    </span>
<span class="444273205471171334" onmouseenter="enter('444273205471171334');" onmouseout="out('444273205471171334');" style="">  61      private String dbURL;                                                                                         </span>
<span class="774144980546385333" onmouseenter="enter('774144980546385333');" onmouseout="out('774144980546385333');" style="">  62      private String tableName;                                                                                     </span>
<span class="-7599244189298179979" onmouseenter="enter('-7599244189298179979');" onmouseout="out('-7599244189298179979');" style="">  63      private String dbType;                                                                                        </span>
<span class="7793327283191472881" onmouseenter="enter('7793327283191472881');" onmouseout="out('7793327283191472881');" style="">  64      private String schema;                                                                                        </span>
<span class="6232830546911964879" onmouseenter="enter('6232830546911964879');" onmouseout="out('6232830546911964879');" style="">  65      private RdbSink dbSink;                                                                                       </span>
<span class="-5106539997665310813" onmouseenter="enter('-5106539997665310813');" onmouseout="out('-5106539997665310813');" style="">  66      // trigger preparedStatement execute batch interval                                                           </span>
<span class="912240613753498884" onmouseenter="enter('912240613753498884');" onmouseout="out('912240613753498884');" style="">  67      private long batchWaitInterval = 10000l;                                                                      </span>
<span class="6572315265081964978" onmouseenter="enter('6572315265081964978');" onmouseout="out('6572315265081964978');" style="">  68      // PreparedStatement execute batch num                                                                        </span>
<span class="879300006436234600" onmouseenter="enter('879300006436234600');" onmouseout="out('879300006436234600');" style="">  69      private int batchNum = 100;                                                                                   </span>
<span class="5486692919041170591" onmouseenter="enter('5486692919041170591');" onmouseout="out('5486692919041170591');" style="">  70      private String insertQuery;                                                                                   </span>
<span class="-2756150593481179349" onmouseenter="enter('-2756150593481179349');" onmouseout="out('-2756150593481179349');" style="">  71      public int[] typesArray;                                                                                      </span>
<span  style="">  72                                                                                                                    </span>
<span class="-6496565219391716151" onmouseenter="enter('-6496565219391716151');" onmouseout="out('-6496565219391716151');" style="">  73      /** 存储用于批量写入的数据 */                                                                                            </span>
<span class="-3895824731157064322" onmouseenter="enter('-3895824731157064322');" onmouseout="out('-3895824731157064322');" style="">  74      protected List&lt;Row&gt; rows = new ArrayList();                                                                   </span>
<span  style="">  75                                                                                                                    </span>
<span class="5276665253328712476" onmouseenter="enter('5276665253328712476');" onmouseout="out('5276665253328712476');" style="">  76      private Connection dbConn;                                                                                    </span>
<span class="-2938446661915646143" onmouseenter="enter('-2938446661915646143');" onmouseout="out('-2938446661915646143');" style="">  77      private PreparedStatement upload;                                                                             </span>
<span class="6163212986872145690" onmouseenter="enter('6163212986872145690');" onmouseout="out('6163212986872145690');" style="">  78      private transient ScheduledThreadPoolExecutor timerService;                                                   </span>
<span  style="">  79                                                                                                                    </span>
<span  style="">  80                                                                                                                    </span>
<span class="-8174251774593430308" onmouseenter="enter('-8174251774593430308');" onmouseout="out('-8174251774593430308');" style="">  81      //index field                                                                                                 </span>
<span class="-7174608961312611642" onmouseenter="enter('-7174608961312611642');" onmouseout="out('-7174608961312611642');" style="">  82      private Map&lt;String, List&lt;String&gt;&gt; realIndexes = Maps.newHashMap();                                            </span>
<span class="7954703571993967219" onmouseenter="enter('7954703571993967219');" onmouseout="out('7954703571993967219');" style="">  83      //full field                                                                                                  </span>
<span class="6211312413274971569" onmouseenter="enter('6211312413274971569');" onmouseout="out('6211312413274971569');" style="">  84      private List&lt;String&gt; fullField = Lists.newArrayList();                                                        </span>
<span  style="">  85                                                                                                                    </span>
<span class="4147856126689175938" onmouseenter="enter('4147856126689175938');" onmouseout="out('4147856126689175938');" style="">  86      public RetractJDBCOutputFormat() {                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87      }                                                                                                             </span>
<span  style="">  88                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  89      @Override                                                                                                     </span>
<span class="-7846204402542625177" onmouseenter="enter('-7846204402542625177');" onmouseout="out('-7846204402542625177');" style="">  90      public void configure(Configuration parameters) {                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91      }                                                                                                             </span>
<span  style="">  92                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  93      /**                                                                                                           </span>
<span class="-9108345922719935697" onmouseenter="enter('-9108345922719935697');" onmouseout="out('-9108345922719935697');" style="">  94       * Connects to the target database and initializes the prepared statement.                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  95       *                                                                                                            </span>
<span class="-2779370099573988758" onmouseenter="enter('-2779370099573988758');" onmouseout="out('-2779370099573988758');" style="">  96       * @param taskNumber The number of the parallel instance.                                                     </span>
<span class="1021807763854124995" onmouseenter="enter('1021807763854124995');" onmouseout="out('1021807763854124995');" style="">  97       * @throws IOException Thrown, if the output could not be opened due to an                                    </span>
<span class="1933221733186851290" onmouseenter="enter('1933221733186851290');" onmouseout="out('1933221733186851290');" style="">  98       *                     I/O problem.                                                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  99       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 100      @Override                                                                                                     </span>
<span class="8196832651644244787" onmouseenter="enter('8196832651644244787');" onmouseout="out('8196832651644244787');" style=""> 101      public void open(int taskNumber, int numTasks) throws IOException {                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 102          try {                                                                                                     </span>
<span class="6773770078938549015" onmouseenter="enter('6773770078938549015');" onmouseout="out('6773770078938549015');" style=""> 103              LOG.info(&quot;PreparedStatement execute batch num is {}&quot;, batchNum);                                      </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style=""> 104              dbConn = establishConnection();                                                                       </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style=""> 105              initMetric();                                                                                         </span>
<span  style=""> 106                                                                                                                    </span>
<span class="3206674840628408112" onmouseenter="enter('3206674840628408112');" onmouseout="out('3206674840628408112');" style=""> 107              if (existTabname()) {                                                                                 </span>
<span class="1417903317231968633" onmouseenter="enter('1417903317231968633');" onmouseout="out('1417903317231968633');" style=""> 108                  if (isReplaceInsertQuery()) {                                                                     </span>
<span class="-5758345137923464881" onmouseenter="enter('-5758345137923464881');" onmouseout="out('-5758345137923464881');" style=""><abbr title=" 109                      insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()), realIndexes, fullField);"> 109                      insertQuery = dbSink.buildUpdateSql(schema , tableName, Arrays.asList(dbSink.getFieldNames()),🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110                  }                                                                                                 </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style=""> 111                  upload = dbConn.prepareStatement(insertQuery);                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 112              } else {                                                                                              </span>
<span class="-6742814813008266447" onmouseenter="enter('-6742814813008266447');" onmouseout="out('-6742814813008266447');" style=""> 113                  throw new SQLException(&quot;Table &quot; + tableName + &quot; doesn&#x27;t exist&quot;);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114              }                                                                                                     </span>
<span  style=""> 115                                                                                                                    </span>
<span class="-6209900637959676147" onmouseenter="enter('-6209900637959676147');" onmouseout="out('-6209900637959676147');" style=""> 116              if (batchWaitInterval &gt; 0 &amp;&amp; batchNum &gt; 1) {                                                          </span>
<span class="-8778334906435463839" onmouseenter="enter('-8778334906435463839');" onmouseout="out('-8778334906435463839');" style=""> 117                  LOG.info(&quot;open batch wait interval scheduled, interval is {} ms&quot;, batchWaitInterval);             </span>
<span  style=""> 118                                                                                                                    </span>
<span class="3796815349862659380" onmouseenter="enter('3796815349862659380');" onmouseout="out('3796815349862659380');" style=""> 119                  timerService = new ScheduledThreadPoolExecutor(1);                                                </span>
<span class="-8610605953257990872" onmouseenter="enter('-8610605953257990872');" onmouseout="out('-8610605953257990872');" style=""> 120                  timerService.scheduleAtFixedRate(() -&gt; {                                                          </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style=""> 121                      submitExecuteBatch();                                                                         </span>
<span class="3487088389080796867" onmouseenter="enter('3487088389080796867');" onmouseout="out('3487088389080796867');" style=""> 122                  }, 0, batchWaitInterval, TimeUnit.MILLISECONDS);                                                  </span>
<span  style=""> 123                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124              }                                                                                                     </span>
<span  style=""> 125                                                                                                                    </span>
<span class="-3830951589613094705" onmouseenter="enter('-3830951589613094705');" onmouseout="out('-3830951589613094705');" style=""> 126          } catch (SQLException sqe) {                                                                              </span>
<span class="-2828573109065483996" onmouseenter="enter('-2828573109065483996');" onmouseout="out('-2828573109065483996');" style=""> 127              LOG.error(&quot;&quot;, sqe);                                                                                   </span>
<span class="1788638523780619514" onmouseenter="enter('1788638523780619514');" onmouseout="out('1788638523780619514');" style=""> 128              throw new IllegalArgumentException(&quot;open() failed.&quot;, sqe);                                            </span>
<span class="-1356738128426719209" onmouseenter="enter('-1356738128426719209');" onmouseout="out('-1356738128426719209');" style=""> 129          } catch (ClassNotFoundException cnfe) {                                                                   </span>
<span class="-9052751040872969605" onmouseenter="enter('-9052751040872969605');" onmouseout="out('-9052751040872969605');" style=""> 130              LOG.error(&quot;&quot;, cnfe);                                                                                  </span>
<span class="2959252105681033013" onmouseenter="enter('2959252105681033013');" onmouseout="out('2959252105681033013');" style=""> 131              throw new IllegalArgumentException(&quot;JDBC driver class not found.&quot;, cnfe);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 133      }                                                                                                             </span>
<span  style=""> 134                                                                                                                    </span>
<span  style=""> 135                                                                                                                    </span>
<span class="-6855882573302218102" onmouseenter="enter('-6855882573302218102');" onmouseout="out('-6855882573302218102');" style=""> 136      public Connection establishConnection() throws SQLException, ClassNotFoundException, IOException {            </span>
<span class="7550878328812119528" onmouseenter="enter('7550878328812119528');" onmouseout="out('7550878328812119528');" style=""> 137          Connection connection ;                                                                                   </span>
<span class="1002679229741717436" onmouseenter="enter('1002679229741717436');" onmouseout="out('1002679229741717436');" style=""> 138          JDBCUtils.forName(drivername, getClass().getClassLoader());                                               </span>
<span class="-7411237215020822355" onmouseenter="enter('-7411237215020822355');" onmouseout="out('-7411237215020822355');" style=""> 139          if (username == null) {                                                                                   </span>
<span class="-2508040535224995853" onmouseenter="enter('-2508040535224995853');" onmouseout="out('-2508040535224995853');" style=""> 140              connection = DriverManager.getConnection(dbURL);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 141          } else {                                                                                                  </span>
<span class="5300550519005355486" onmouseenter="enter('5300550519005355486');" onmouseout="out('5300550519005355486');" style=""> 142              connection = DriverManager.getConnection(dbURL, username, password);                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143          }                                                                                                         </span>
<span class="1164602517684291637" onmouseenter="enter('1164602517684291637');" onmouseout="out('1164602517684291637');" style=""> 144          connection.setAutoCommit(false);                                                                          </span>
<span class="-5724672903034820214" onmouseenter="enter('-5724672903034820214');" onmouseout="out('-5724672903034820214');" style=""> 145          return connection;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146      }                                                                                                             </span>
<span  style=""> 147                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 148      /**                                                                                                           </span>
<span class="7011448598014774122" onmouseenter="enter('7011448598014774122');" onmouseout="out('7011448598014774122');" style=""> 149       * Adds a record to the prepared statement.                                                                   </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 150       * &lt;p&gt;                                                                                                        </span>
<span class="-7005365549264951868" onmouseenter="enter('-7005365549264951868');" onmouseout="out('-7005365549264951868');" style=""> 151       * When this method is called, the output format is guaranteed to be opened.                                  </span>
<span class="-5136230954678527136" onmouseenter="enter('-5136230954678527136');" onmouseout="out('-5136230954678527136');" style=""> 152       * &lt;/p&gt;                                                                                                       </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 153       * &lt;p&gt;                                                                                                        </span>
<span class="-454443948710458937" onmouseenter="enter('-454443948710458937');" onmouseout="out('-454443948710458937');" style=""><abbr title=" 154       * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order to"> 154       * WARNING: this may fail when no column types specified (because a best effort approach is attempted in order🔵</abbr></span>
<span class="-2015066005631121972" onmouseenter="enter('-2015066005631121972');" onmouseout="out('-2015066005631121972');" style=""><abbr title=" 155       * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, null))"> 155       * insert a null value but it&#x27;s not guaranteed that the JDBC driver handles PreparedStatement.setObject(pos, n🔵</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 156       *                                                                                                            </span>
<span class="-7496228104282242690" onmouseenter="enter('-7496228104282242690');" onmouseout="out('-7496228104282242690');" style=""> 157       * @param tuple2 The records to add to the output.                                                            </span>
<span class="-5948006046046314721" onmouseenter="enter('-5948006046046314721');" onmouseout="out('-5948006046046314721');" style=""> 158       * @throws IOException Thrown, if the records could not be added due to an I/O problem.                       </span>
<span class="-7392500204013093027" onmouseenter="enter('-7392500204013093027');" onmouseout="out('-7392500204013093027');" style=""> 159       * @see PreparedStatement                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 160       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 161      @Override                                                                                                     </span>
<span class="2300083278712666328" onmouseenter="enter('2300083278712666328');" onmouseout="out('2300083278712666328');" style=""> 162      public void writeRecord(Tuple2 tuple2)  {                                                                     </span>
<span  style=""> 163                                                                                                                    </span>
<span class="-6701151034505735722" onmouseenter="enter('-6701151034505735722');" onmouseout="out('-6701151034505735722');" style=""> 164          Tuple2&lt;Boolean, Row&gt; tupleTrans = tuple2;                                                                 </span>
<span class="6577300888595595780" onmouseenter="enter('6577300888595595780');" onmouseout="out('6577300888595595780');" style=""> 165          Boolean retract = tupleTrans.getField(0);                                                                 </span>
<span class="-6229141304709212777" onmouseenter="enter('-6229141304709212777');" onmouseout="out('-6229141304709212777');" style=""> 166          Row row = tupleTrans.getField(1);                                                                         </span>
<span  style=""> 167                                                                                                                    </span>
<span class="-8152348397257782471" onmouseenter="enter('-8152348397257782471');" onmouseout="out('-8152348397257782471');" style=""> 168          if (typesArray != null &amp;&amp; typesArray.length &gt; 0 &amp;&amp; typesArray.length != row.getArity()) {                 </span>
<span class="-2180065414466058126" onmouseenter="enter('-2180065414466058126');" onmouseout="out('-2180065414466058126');" style=""> 169              LOG.warn(&quot;Column SQL types array doesn&#x27;t match arity of passed Row! Check the passed array...&quot;);      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170          }                                                                                                         </span>
<span  style=""> 171                                                                                                                    </span>
<span class="-4738216633021392189" onmouseenter="enter('-4738216633021392189');" onmouseout="out('-4738216633021392189');" style=""> 172          if (retract) {                                                                                            </span>
<span  style=""> 173                                                                                                                    </span>
<span class="319547505475825588" onmouseenter="enter('319547505475825588');" onmouseout="out('319547505475825588');" style=""> 174              if (outRecords.getCount() % ROW_PRINT_FREQUENCY == 0) {                                               </span>
<span class="-5473506727678944675" onmouseenter="enter('-5473506727678944675');" onmouseout="out('-5473506727678944675');" style=""> 175                  LOG.info(&quot;Receive data : {}&quot;, row);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176              }                                                                                                     </span>
<span  style=""> 177                                                                                                                    </span>
<span class="-6698244658870964997" onmouseenter="enter('-6698244658870964997');" onmouseout="out('-6698244658870964997');" style=""> 178              outRecords.inc();                                                                                     </span>
<span class="-2594042272669047516" onmouseenter="enter('-2594042272669047516');" onmouseout="out('-2594042272669047516');" style=""> 179              insertWrite(row);                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 180          } else {                                                                                                  </span>
<span class="860828310248678739" onmouseenter="enter('860828310248678739');" onmouseout="out('860828310248678739');" style=""> 181              //do nothing                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183      }                                                                                                             </span>
<span  style=""> 184                                                                                                                    </span>
<span  style=""> 185                                                                                                                    </span>
<span class="-4476666207180013827" onmouseenter="enter('-4476666207180013827');" onmouseout="out('-4476666207180013827');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -    private void insertWrite(Row row) {                                                                           </span>
<span class="-1086395285886649574" onmouseenter="enter('-1086395285886649574');" onmouseout="out('-1086395285886649574');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -        checkConnectionOpen(dbConn);                                                                              </span>
<span class="2080741281463881552" onmouseenter="enter('2080741281463881552');" onmouseout="out('2080741281463881552');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 188 +    private void insertWrite(Row row)  {                                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 189          try {                                                                                                     </span>
<span class="-257588147030687667" onmouseenter="enter('-257588147030687667');" onmouseout="out('-257588147030687667');" style=""> 190              if (batchNum == 1) {                                                                                  </span>
<span class="-5864806063089756510" onmouseenter="enter('-5864806063089756510');" onmouseout="out('-5864806063089756510');" style=""> 191                  writeSingleRecord(row);                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 192              } else {                                                                                              </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style=""> 193                  updatePreparedStmt(row, upload);                                                                  </span>
<span class="-6499543354599456148" onmouseenter="enter('-6499543354599456148');" onmouseout="out('-6499543354599456148');" style=""> 194                  rows.add(row);                                                                                    </span>
<span class="3486417456593927531" onmouseenter="enter('3486417456593927531');" onmouseout="out('3486417456593927531');" style=""> 195                  upload.addBatch();                                                                                </span>
<span class="-685791959883519743" onmouseenter="enter('-685791959883519743');" onmouseout="out('-685791959883519743');" style=""> 196                  if (rows.size() &gt;= batchNum) {                                                                    </span>
<span class="-6942019472805130203" onmouseenter="enter('-6942019472805130203');" onmouseout="out('-6942019472805130203');" style=""> 197                      submitExecuteBatch();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199              }                                                                                                     </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style=""> 200          } catch (SQLException e) {                                                                                </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style=""> 201              if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {                </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style=""> 202                  outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                                      </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style=""><abbr title=" 203                  LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 203                  LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), 🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style=""> 204                  LOG.error(&quot;&quot;, e);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 205              } else {                                                                                              </span>
<span class="-1723301348826514346" onmouseenter="enter('-1723301348826514346');" onmouseout="out('-1723301348826514346');" style=""> 206                  outDirtyRecords.inc(batchNum == 1 ? batchNum : rows.size());                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207              }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -                                                                                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210          }                                                                                                         </span>
<span  style=""> 211                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212      }                                                                                                             </span>
<span  style=""> 213                                                                                                                    </span>
<span class="-1822726443649000713" onmouseenter="enter('-1822726443649000713');" onmouseout="out('-1822726443649000713');" style=""> 214      private void writeSingleRecord(Row row) {                                                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 215          try {                                                                                                     </span>
<span class="239402160935757489" onmouseenter="enter('239402160935757489');" onmouseout="out('239402160935757489');" style=""> 216              updatePreparedStmt(row, upload);                                                                      </span>
<span class="-6521512620095366793" onmouseenter="enter('-6521512620095366793');" onmouseout="out('-6521512620095366793');" style=""> 217              upload.executeUpdate();                                                                               </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style=""> 218              dbConn.commit();                                                                                      </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style=""> 219          } catch (SQLException e) {                                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                                                                                                                  </span>
<span class="-6799605853464900245" onmouseenter="enter('-6799605853464900245');" onmouseout="out('-6799605853464900245');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 221 +            dealSQLException(e);                                                                                  </span>
<span class="-1553153886547914794" onmouseenter="enter('-1553153886547914794');" onmouseout="out('-1553153886547914794');" style=""> 222              if (outDirtyRecords.getCount() % DIRTY_PRINT_FREQUENCY == 0 || LOG.isDebugEnabled()) {                </span>
<span class="-1412957943843304982" onmouseenter="enter('-1412957943843304982');" onmouseout="out('-1412957943843304982');" style=""><abbr title=" 223                  LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), row.toString());"> 223                  LOG.error(&quot;record insert failed,dirty record num:{}, current row:{}&quot;, outDirtyRecords.getCount(), 🔵</abbr></span>
<span class="5662170612738471238" onmouseenter="enter('5662170612738471238');" onmouseout="out('5662170612738471238');" style=""> 224                  LOG.error(&quot;&quot;, e);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225              }                                                                                                     </span>
<span  style=""> 226                                                                                                                    </span>
<span class="999846223812588238" onmouseenter="enter('999846223812588238');" onmouseout="out('999846223812588238');" style=""> 227              outDirtyRecords.inc();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229      }                                                                                                             </span>
<span  style=""> 230                                                                                                                    </span>
<span class="7232590174034523536" onmouseenter="enter('7232590174034523536');" onmouseout="out('7232590174034523536');" style=""> 231      private void updatePreparedStmt(Row row, PreparedStatement pstmt) throws SQLException {                       </span>
<span class="-2293281033286262081" onmouseenter="enter('-2293281033286262081');" onmouseout="out('-2293281033286262081');" style=""> 232          if (typesArray == null) {                                                                                 </span>
<span class="1190370661446642331" onmouseenter="enter('1190370661446642331');" onmouseout="out('1190370661446642331');" style=""> 233              // no types provided                                                                                  </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style=""> 234              for (int index = 0; index &lt; row.getArity(); index++) {                                                </span>
<span class="1329206757438352640" onmouseenter="enter('1329206757438352640');" onmouseout="out('1329206757438352640');" style=""><abbr title=" 235                  LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 1, row.getField(index));"> 235                  LOG.warn(&quot;Unknown column type for column %s. Best effort approach to set its value: %s.&quot;, index + 🔵</abbr></span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style=""> 236                  pstmt.setObject(index + 1, row.getField(index));                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237              }                                                                                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 238          } else {                                                                                                  </span>
<span class="-6399260504676880414" onmouseenter="enter('-6399260504676880414');" onmouseout="out('-6399260504676880414');" style=""> 239              // types provided                                                                                     </span>
<span class="6881422987120969037" onmouseenter="enter('6881422987120969037');" onmouseout="out('6881422987120969037');" style=""> 240              for (int index = 0; index &lt; row.getArity(); index++) {                                                </span>
<span  style=""> 241                                                                                                                    </span>
<span class="6330605857195500610" onmouseenter="enter('6330605857195500610');" onmouseout="out('6330605857195500610');" style=""> 242                  if (row.getField(index) == null) {                                                                </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style=""> 243                      pstmt.setNull(index + 1, typesArray[index]);                                                  </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 244                  } else {                                                                                          </span>
<span class="-888913128366165256" onmouseenter="enter('-888913128366165256');" onmouseout="out('-888913128366165256');" style=""><abbr title=" 245                      // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html"> 245                      // casting values as suggested by http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart🔵</abbr></span>
<span class="-6206986839679195256" onmouseenter="enter('-6206986839679195256');" onmouseout="out('-6206986839679195256');" style=""> 246                      switch (typesArray[index]) {                                                                  </span>
<span class="3980797866812438422" onmouseenter="enter('3980797866812438422');" onmouseout="out('3980797866812438422');" style=""> 247                          case java.sql.Types.NULL:                                                                 </span>
<span class="5685147736198234271" onmouseenter="enter('5685147736198234271');" onmouseout="out('5685147736198234271');" style=""> 248                              pstmt.setNull(index + 1, typesArray[index]);                                          </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 249                              break;                                                                                </span>
<span class="5326948189446200073" onmouseenter="enter('5326948189446200073');" onmouseout="out('5326948189446200073');" style=""> 250                          case java.sql.Types.BOOLEAN:                                                              </span>
<span class="6562523454428900362" onmouseenter="enter('6562523454428900362');" onmouseout="out('6562523454428900362');" style=""> 251                          case java.sql.Types.BIT:                                                                  </span>
<span class="6271448587594814326" onmouseenter="enter('6271448587594814326');" onmouseout="out('6271448587594814326');" style=""> 252                              pstmt.setBoolean(index + 1, (boolean) row.getField(index));                           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 253                              break;                                                                                </span>
<span class="8828531975479869234" onmouseenter="enter('8828531975479869234');" onmouseout="out('8828531975479869234');" style=""> 254                          case java.sql.Types.CHAR:                                                                 </span>
<span class="-3188091274196598140" onmouseenter="enter('-3188091274196598140');" onmouseout="out('-3188091274196598140');" style=""> 255                          case java.sql.Types.NCHAR:                                                                </span>
<span class="-6450742873324800064" onmouseenter="enter('-6450742873324800064');" onmouseout="out('-6450742873324800064');" style=""> 256                          case java.sql.Types.VARCHAR:                                                              </span>
<span class="-770433648002173407" onmouseenter="enter('-770433648002173407');" onmouseout="out('-770433648002173407');" style=""> 257                          case java.sql.Types.LONGVARCHAR:                                                          </span>
<span class="3871043401648763739" onmouseenter="enter('3871043401648763739');" onmouseout="out('3871043401648763739');" style=""> 258                          case java.sql.Types.LONGNVARCHAR:                                                         </span>
<span class="120156960823266369" onmouseenter="enter('120156960823266369');" onmouseout="out('120156960823266369');" style=""> 259                              pstmt.setString(index + 1, (String) row.getField(index));                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 260                              break;                                                                                </span>
<span class="1424832555196809333" onmouseenter="enter('1424832555196809333');" onmouseout="out('1424832555196809333');" style=""> 261                          case java.sql.Types.TINYINT:                                                              </span>
<span class="-9053355825773737032" onmouseenter="enter('-9053355825773737032');" onmouseout="out('-9053355825773737032');" style=""> 262                              pstmt.setByte(index + 1, (byte) row.getField(index));                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 263                              break;                                                                                </span>
<span class="-821876964315606759" onmouseenter="enter('-821876964315606759');" onmouseout="out('-821876964315606759');" style=""> 264                          case java.sql.Types.SMALLINT:                                                             </span>
<span class="8371453768705790371" onmouseenter="enter('8371453768705790371');" onmouseout="out('8371453768705790371');" style=""> 265                              pstmt.setShort(index + 1, (short) row.getField(index));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 266                              break;                                                                                </span>
<span class="8915380011239607695" onmouseenter="enter('8915380011239607695');" onmouseout="out('8915380011239607695');" style=""> 267                          case java.sql.Types.INTEGER:                                                              </span>
<span class="-389469068215742727" onmouseenter="enter('-389469068215742727');" onmouseout="out('-389469068215742727');" style=""> 268                              pstmt.setInt(index + 1, (int) row.getField(index));                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 269                              break;                                                                                </span>
<span class="-1960141132936049755" onmouseenter="enter('-1960141132936049755');" onmouseout="out('-1960141132936049755');" style=""> 270                          case java.sql.Types.BIGINT:                                                               </span>
<span class="-4186906028791504221" onmouseenter="enter('-4186906028791504221');" onmouseout="out('-4186906028791504221');" style=""> 271                              pstmt.setLong(index + 1, (long) row.getField(index));                                 </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 272                              break;                                                                                </span>
<span class="-844935429253438742" onmouseenter="enter('-844935429253438742');" onmouseout="out('-844935429253438742');" style=""> 273                          case java.sql.Types.REAL:                                                                 </span>
<span class="-3953430522737134777" onmouseenter="enter('-3953430522737134777');" onmouseout="out('-3953430522737134777');" style=""> 274                          case java.sql.Types.FLOAT:                                                                </span>
<span class="5571153339467382138" onmouseenter="enter('5571153339467382138');" onmouseout="out('5571153339467382138');" style=""> 275                              pstmt.setFloat(index + 1, (float) row.getField(index));                               </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 276                              break;                                                                                </span>
<span class="914781803962898843" onmouseenter="enter('914781803962898843');" onmouseout="out('914781803962898843');" style=""> 277                          case java.sql.Types.DOUBLE:                                                               </span>
<span class="3360599766805384486" onmouseenter="enter('3360599766805384486');" onmouseout="out('3360599766805384486');" style=""> 278                              pstmt.setDouble(index + 1, (double) row.getField(index));                             </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 279                              break;                                                                                </span>
<span class="-8036890299038316152" onmouseenter="enter('-8036890299038316152');" onmouseout="out('-8036890299038316152');" style=""> 280                          case java.sql.Types.DECIMAL:                                                              </span>
<span class="-9165207194575939714" onmouseenter="enter('-9165207194575939714');" onmouseout="out('-9165207194575939714');" style=""> 281                          case java.sql.Types.NUMERIC:                                                              </span>
<span class="8399898048413438045" onmouseenter="enter('8399898048413438045');" onmouseout="out('8399898048413438045');" style=""> 282                              pstmt.setBigDecimal(index + 1, (java.math.BigDecimal) row.getField(index));           </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 283                              break;                                                                                </span>
<span class="-7750412360063699681" onmouseenter="enter('-7750412360063699681');" onmouseout="out('-7750412360063699681');" style=""> 284                          case java.sql.Types.DATE:                                                                 </span>
<span class="-8024294844650305524" onmouseenter="enter('-8024294844650305524');" onmouseout="out('-8024294844650305524');" style=""> 285                              pstmt.setDate(index + 1, (java.sql.Date) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 286                              break;                                                                                </span>
<span class="5048478500341194017" onmouseenter="enter('5048478500341194017');" onmouseout="out('5048478500341194017');" style=""> 287                          case java.sql.Types.TIME:                                                                 </span>
<span class="1730476504740418277" onmouseenter="enter('1730476504740418277');" onmouseout="out('1730476504740418277');" style=""> 288                              pstmt.setTime(index + 1, (java.sql.Time) row.getField(index));                        </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 289                              break;                                                                                </span>
<span class="2709337408985985525" onmouseenter="enter('2709337408985985525');" onmouseout="out('2709337408985985525');" style=""> 290                          case java.sql.Types.TIMESTAMP:                                                            </span>
<span class="8592636976940757146" onmouseenter="enter('8592636976940757146');" onmouseout="out('8592636976940757146');" style=""> 291                              pstmt.setTimestamp(index + 1, (java.sql.Timestamp) row.getField(index));              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 292                              break;                                                                                </span>
<span class="-4502809053507445921" onmouseenter="enter('-4502809053507445921');" onmouseout="out('-4502809053507445921');" style=""> 293                          case java.sql.Types.BINARY:                                                               </span>
<span class="-1577362498515180089" onmouseenter="enter('-1577362498515180089');" onmouseout="out('-1577362498515180089');" style=""> 294                          case java.sql.Types.VARBINARY:                                                            </span>
<span class="-5244104637533642881" onmouseenter="enter('-5244104637533642881');" onmouseout="out('-5244104637533642881');" style=""> 295                          case java.sql.Types.LONGVARBINARY:                                                        </span>
<span class="-5881408138265736138" onmouseenter="enter('-5881408138265736138');" onmouseout="out('-5881408138265736138');" style=""> 296                              pstmt.setBytes(index + 1, (byte[]) row.getField(index));                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 297                              break;                                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 298                          default:                                                                                  </span>
<span class="7478786930234195919" onmouseenter="enter('7478786930234195919');" onmouseout="out('7478786930234195919');" style=""> 299                              pstmt.setObject(index + 1, row.getField(index));                                      </span>
<span class="-447604781323530793" onmouseenter="enter('-447604781323530793');" onmouseout="out('-447604781323530793');" style=""><abbr title=" 300                              LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value: %s.&quot;,"> 300                              LOG.warn(&quot;Unmanaged sql type (%s) for column %s. Best effort approach to set its value🔵</abbr></span>
<span class="6537654624471993703" onmouseenter="enter('6537654624471993703');" onmouseout="out('6537654624471993703');" style=""> 301                                      typesArray[index], index + 1, row.getField(index));                           </span>
<span class="-402272292164915592" onmouseenter="enter('-402272292164915592');" onmouseout="out('-402272292164915592');" style=""> 302                              // case java.sql.Types.SQLXML                                                         </span>
<span class="2704220002356605806" onmouseenter="enter('2704220002356605806');" onmouseout="out('2704220002356605806');" style=""> 303                              // case java.sql.Types.ARRAY:                                                         </span>
<span class="-3670332139337360144" onmouseenter="enter('-3670332139337360144');" onmouseout="out('-3670332139337360144');" style=""> 304                              // case java.sql.Types.JAVA_OBJECT:                                                   </span>
<span class="-626771261891264177" onmouseenter="enter('-626771261891264177');" onmouseout="out('-626771261891264177');" style=""> 305                              // case java.sql.Types.BLOB:                                                          </span>
<span class="5700826384919403657" onmouseenter="enter('5700826384919403657');" onmouseout="out('5700826384919403657');" style=""> 306                              // case java.sql.Types.CLOB:                                                          </span>
<span class="-358906598084177311" onmouseenter="enter('-358906598084177311');" onmouseout="out('-358906598084177311');" style=""> 307                              // case java.sql.Types.NCLOB:                                                         </span>
<span class="-4676991729935655231" onmouseenter="enter('-4676991729935655231');" onmouseout="out('-4676991729935655231');" style=""> 308                              // case java.sql.Types.DATALINK:                                                      </span>
<span class="-6575095246115904812" onmouseenter="enter('-6575095246115904812');" onmouseout="out('-6575095246115904812');" style=""> 309                              // case java.sql.Types.DISTINCT:                                                      </span>
<span class="7939586389712676381" onmouseenter="enter('7939586389712676381');" onmouseout="out('7939586389712676381');" style=""> 310                              // case java.sql.Types.OTHER:                                                         </span>
<span class="-7824295129879704498" onmouseenter="enter('-7824295129879704498');" onmouseout="out('-7824295129879704498');" style=""> 311                              // case java.sql.Types.REF:                                                           </span>
<span class="-1944206350667440803" onmouseenter="enter('-1944206350667440803');" onmouseout="out('-1944206350667440803');" style=""> 312                              // case java.sql.Types.ROWID:                                                         </span>
<span class="4209037970536823538" onmouseenter="enter('4209037970536823538');" onmouseout="out('4209037970536823538');" style=""> 313                              // case java.sql.Types.STRUC                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314                      }                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318      }                                                                                                             </span>
<span  style=""> 319                                                                                                                    </span>
<span  style=""> 320                                                                                                                    </span>
<span class="-2255704765632364867" onmouseenter="enter('-2255704765632364867');" onmouseout="out('-2255704765632364867');" style=""> 321      private synchronized void submitExecuteBatch() {                                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 322          try {                                                                                                     </span>
<span class="6813843412968272702" onmouseenter="enter('6813843412968272702');" onmouseout="out('6813843412968272702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 323 +            regularlyCheckConnection();                                                                           </span>
<span class="-569207269143264374" onmouseenter="enter('-569207269143264374');" onmouseout="out('-569207269143264374');" style=""> 324              this.upload.executeBatch();                                                                           </span>
<span class="-1768564331589068679" onmouseenter="enter('-1768564331589068679');" onmouseout="out('-1768564331589068679');" style=""> 325              dbConn.commit();                                                                                      </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style=""> 326          } catch (SQLException e) {                                                                                </span>
<span class="-9174161656279899685" onmouseenter="enter('-9174161656279899685');" onmouseout="out('-9174161656279899685');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 327 +            LOG.warn(&quot;submitExecuteBatch error {}&quot;, e);                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 328              try {                                                                                                 </span>
<span class="6987150276207810320" onmouseenter="enter('6987150276207810320');" onmouseout="out('6987150276207810320');" style=""> 329                  dbConn.rollback();                                                                                </span>
<span class="-9008476763811710828" onmouseenter="enter('-9008476763811710828');" onmouseout="out('-9008476763811710828');" style=""> 330              } catch (SQLException e1) {                                                                           </span>
<span class="-7536698771404360230" onmouseenter="enter('-7536698771404360230');" onmouseout="out('-7536698771404360230');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 331 -                LOG.error(&quot;rollback  data error !&quot;, e);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 332 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 333 -                                                                                                                  </span>
<span class="246786700485249677" onmouseenter="enter('246786700485249677');" onmouseout="out('246786700485249677');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 334 +                dealSQLException(e1);                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 335 +            }                                                                                                     </span>
<span class="-3048449050671756239" onmouseenter="enter('-3048449050671756239');" onmouseout="out('-3048449050671756239');" style=""> 336              rows.forEach(this::writeSingleRecord);                                                                </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 337          } finally {                                                                                               </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 338              rows.clear();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340      }                                                                                                             </span>
<span  style=""> 341                                                                                                                    </span>
<span class="-3522961204041572073" onmouseenter="enter('-3522961204041572073');" onmouseout="out('-3522961204041572073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 342 -    private void checkConnectionOpen(Connection dbConn) {                                                         </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 343 -        try {                                                                                                     </span>
<span class="-2855961023100454886" onmouseenter="enter('-2855961023100454886');" onmouseout="out('-2855961023100454886');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 344 -            if (dbConn.isClosed()) {                                                                              </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 345 -                LOG.info(&quot;db connection reconnect..&quot;);                                                            </span>
<span class="-4293595830544602858" onmouseenter="enter('-4293595830544602858');" onmouseout="out('-4293595830544602858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 346 -                dbConn= establishConnection();                                                                    </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 347 -                upload = dbConn.prepareStatement(insertQuery);                                                    </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 348 -                this.dbConn = dbConn;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 349 -            }                                                                                                     </span>
<span class="2505888527841761400" onmouseenter="enter('2505888527841761400');" onmouseout="out('2505888527841761400');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 350 -        } catch (SQLException e) {                                                                                </span>
<span class="814403640845951473" onmouseenter="enter('814403640845951473');" onmouseout="out('814403640845951473');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 351 -            LOG.error(&quot;check connection open failed..&quot;, e);                                                       </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 352 -        } catch (ClassNotFoundException e) {                                                                      </span>
<span class="1123805251307592465" onmouseenter="enter('1123805251307592465');" onmouseout="out('1123805251307592465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 353 -            LOG.error(&quot;load jdbc class error when reconnect db..&quot;, e);                                            </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 354 -        } catch (IOException e) {                                                                                 </span>
<span class="-720388217547677793" onmouseenter="enter('-720388217547677793');" onmouseout="out('-720388217547677793');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 355 -            LOG.error(&quot;kerberos authentication failed..&quot;, e);                                                     </span>
<span class="-3874353238638658215" onmouseenter="enter('-3874353238638658215');" onmouseout="out('-3874353238638658215');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 356 +    private void dealSQLException(Exception e) {                                                                  </span>
<span class="6407700796198700478" onmouseenter="enter('6407700796198700478');" onmouseout="out('6407700796198700478');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 357 +        EConnectionErrorCode errorCode = EConnectionErrorCode.resolveErrorCodeFromException(e);                   </span>
<span class="-3680639726838673504" onmouseenter="enter('-3680639726838673504');" onmouseout="out('-3680639726838673504');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 358 +        switch (errorCode) {                                                                                      </span>
<span class="1225374239746753698" onmouseenter="enter('1225374239746753698');" onmouseout="out('1225374239746753698');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 359 +            case CONN_DB_INVALID:                                                                                 </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 360 +                reconnection();                                                                                   </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 361 +                break;                                                                                            </span>
<span class="1755343140467316574" onmouseenter="enter('1755343140467316574');" onmouseout="out('1755343140467316574');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 362 +            case CONN_DB_FAILED:                                                                                  </span>
<span class="-1198874643364045165" onmouseenter="enter('-1198874643364045165');" onmouseout="out('-1198874643364045165');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 363 +            case DB_TABLE_NOT_EXIST:                                                                              </span>
<span class="5897285764286536997" onmouseenter="enter('5897285764286536997');" onmouseout="out('5897285764286536997');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 364 +                throw new RuntimeException(e);                                                                    </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 365 +            default:                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 366 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 367 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 368 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 369 +                                                                                                                  </span>
<span class="-1258602931071673845" onmouseenter="enter('-1258602931071673845');" onmouseout="out('-1258602931071673845');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 370 +    private void regularlyCheckConnection() throws SQLException {                                                 </span>
<span class="-1222192591979868781" onmouseenter="enter('-1222192591979868781');" onmouseout="out('-1222192591979868781');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 371 +        checkTimes++;                                                                                             </span>
<span class="-5151471990775264393" onmouseenter="enter('-5151471990775264393');" onmouseout="out('-5151471990775264393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 372 +        if (checkTimes % CONNECTION_CHECK_FREQUENCY != 0) {                                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 373 +            return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 374 +        }                                                                                                         </span>
<span class="5795923628795732420" onmouseenter="enter('5795923628795732420');" onmouseout="out('5795923628795732420');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 375 +        LOG.warn(&quot;db connection Valid check !&quot;);                                                                  </span>
<span class="8215065968495159984" onmouseenter="enter('8215065968495159984');" onmouseout="out('8215065968495159984');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 376 +        if (dbConn.isClosed() || !dbConn.isValid(100)) {                                                          </span>
<span class="-7491922073238895440" onmouseenter="enter('-7491922073238895440');" onmouseout="out('-7491922073238895440');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 377 +            reconnection();                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 378 +        }                                                                                                         </span>
<span class="-8215063589164597765" onmouseenter="enter('-8215063589164597765');" onmouseout="out('-8215063589164597765');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 379 +        checkTimes = 0;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 380 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 381 +                                                                                                                  </span>
<span class="-5737401042898679127" onmouseenter="enter('-5737401042898679127');" onmouseout="out('-5737401042898679127');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 382 +    public void reconnection() throws RuntimeException {                                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 383 +        try {                                                                                                     </span>
<span class="9140763359945115560" onmouseenter="enter('9140763359945115560');" onmouseout="out('9140763359945115560');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 384 +            LOG.info(&quot;db connection reconnect..&quot;);                                                                </span>
<span class="8698706409519300847" onmouseenter="enter('8698706409519300847');" onmouseout="out('8698706409519300847');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 385 +            dbConn = establishConnection();                                                                       </span>
<span class="-7807552728419051008" onmouseenter="enter('-7807552728419051008');" onmouseout="out('-7807552728419051008');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 386 +            upload = dbConn.prepareStatement(insertQuery);                                                        </span>
<span class="-4644686081500447818" onmouseenter="enter('-4644686081500447818');" onmouseout="out('-4644686081500447818');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 387 +            this.dbConn = dbConn;                                                                                 </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 388 +        } catch (Exception e) {                                                                                   </span>
<span class="5310062978023364230" onmouseenter="enter('5310062978023364230');" onmouseout="out('5310062978023364230');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 389 +            throw new RuntimeException(&quot;connection open failed..&quot;, e);                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391      }                                                                                                             </span>
<span  style=""> 392                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 393      /**                                                                                                           </span>
<span class="7764624096756200468" onmouseenter="enter('7764624096756200468');" onmouseout="out('7764624096756200468');" style=""> 394       * Executes prepared statement and closes all resources of this instance.                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 395       *                                                                                                            </span>
<span class="-3280822762542927138" onmouseenter="enter('-3280822762542927138');" onmouseout="out('-3280822762542927138');" style=""> 396       * @throws IOException Thrown, if the input could not be closed properly.                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 397       */                                                                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 398      @Override                                                                                                     </span>
<span class="3075770629113308700" onmouseenter="enter('3075770629113308700');" onmouseout="out('3075770629113308700');" style=""> 399      public void close() throws IOException {                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 400          try {                                                                                                     </span>
<span class="-8955892456431751944" onmouseenter="enter('-8955892456431751944');" onmouseout="out('-8955892456431751944');" style=""> 401              if (upload != null) {                                                                                 </span>
<span class="4476182864224268318" onmouseenter="enter('4476182864224268318');" onmouseout="out('4476182864224268318');" style=""> 402                  upload.executeBatch();                                                                            </span>
<span class="-1294613312497720712" onmouseenter="enter('-1294613312497720712');" onmouseout="out('-1294613312497720712');" style=""> 403                  upload.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 404              }                                                                                                     </span>
<span class="6528129630111491277" onmouseenter="enter('6528129630111491277');" onmouseout="out('6528129630111491277');" style=""> 405              if (null != timerService) {                                                                           </span>
<span class="4574097920361024223" onmouseenter="enter('4574097920361024223');" onmouseout="out('4574097920361024223');" style=""> 406                  timerService.shutdown();                                                                          </span>
<span class="4292957137411407963" onmouseenter="enter('4292957137411407963');" onmouseout="out('4292957137411407963');" style=""> 407                  LOG.info(&quot;batch wait interval scheduled service  closed &quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 408              }                                                                                                     </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style=""> 409          } catch (SQLException se) {                                                                               </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style=""> 410              LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 411          } finally {                                                                                               </span>
<span class="7922306416703071402" onmouseenter="enter('7922306416703071402');" onmouseout="out('7922306416703071402');" style=""> 412              upload = null;                                                                                        </span>
<span class="753423689300194539" onmouseenter="enter('753423689300194539');" onmouseout="out('753423689300194539');" style=""> 413              rows.clear();                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414          }                                                                                                         </span>
<span  style=""> 415                                                                                                                    </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 416          try {                                                                                                     </span>
<span class="-5480872818273093935" onmouseenter="enter('-5480872818273093935');" onmouseout="out('-5480872818273093935');" style=""> 417              if (dbConn != null) {                                                                                 </span>
<span class="6851061119172161772" onmouseenter="enter('6851061119172161772');" onmouseout="out('6851061119172161772');" style=""> 418                  dbConn.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419              }                                                                                                     </span>
<span class="-7929892757875402744" onmouseenter="enter('-7929892757875402744');" onmouseout="out('-7929892757875402744');" style=""> 420          } catch (SQLException se) {                                                                               </span>
<span class="-6090424552935256387" onmouseenter="enter('-6090424552935256387');" onmouseout="out('-6090424552935256387');" style=""> 421              LOG.info(&quot;Inputformat couldn&#x27;t be closed - &quot;, se);                                                    </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 422          } finally {                                                                                               </span>
<span class="-6420552092194928702" onmouseenter="enter('-6420552092194928702');" onmouseout="out('-6420552092194928702');" style=""> 423              dbConn = null;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 425      }                                                                                                             </span>
<span  style=""> 426                                                                                                                    </span>
<span  style=""> 427                                                                                                                    </span>
<span class="4012794122578595858" onmouseenter="enter('4012794122578595858');" onmouseout="out('4012794122578595858');" style=""> 428      public boolean isReplaceInsertQuery() throws SQLException {                                                   </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 429          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430      }                                                                                                             </span>
<span  style=""> 431                                                                                                                    </span>
<span class="2579382846946895656" onmouseenter="enter('2579382846946895656');" onmouseout="out('2579382846946895656');" style=""> 432      public void verifyField() {                                                                                   </span>
<span class="2267368456818658758" onmouseenter="enter('2267368456818658758');" onmouseout="out('2267368456818658758');" style=""> 433          if (StringUtils.isBlank(username)) {                                                                      </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style=""> 434              LOG.warn(&quot;Username was not supplied separately.&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435          }                                                                                                         </span>
<span class="-905320514214931941" onmouseenter="enter('-905320514214931941');" onmouseout="out('-905320514214931941');" style=""> 436          if (StringUtils.isBlank(password)) {                                                                      </span>
<span class="-8396708428771077585" onmouseenter="enter('-8396708428771077585');" onmouseout="out('-8396708428771077585');" style=""> 437              LOG.warn(&quot;Username was not supplied separately.&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438          }                                                                                                         </span>
<span class="442214318206026638" onmouseenter="enter('442214318206026638');" onmouseout="out('442214318206026638');" style=""> 439          if (StringUtils.isBlank(dbURL)) {                                                                         </span>
<span class="-5074896509375255570" onmouseenter="enter('-5074896509375255570');" onmouseout="out('-5074896509375255570');" style=""> 440              throw new IllegalArgumentException(&quot;No dababase URL supplied.&quot;);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441          }                                                                                                         </span>
<span class="-4995400321234975955" onmouseenter="enter('-4995400321234975955');" onmouseout="out('-4995400321234975955');" style=""> 442          if (StringUtils.isBlank(insertQuery)) {                                                                   </span>
<span class="2419775560692294033" onmouseenter="enter('2419775560692294033');" onmouseout="out('2419775560692294033');" style=""> 443              throw new IllegalArgumentException(&quot;No insertQuery supplied&quot;);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444          }                                                                                                         </span>
<span class="-6596978720539512809" onmouseenter="enter('-6596978720539512809');" onmouseout="out('-6596978720539512809');" style=""> 445          if (StringUtils.isBlank(drivername)) {                                                                    </span>
<span class="2786164034484170881" onmouseenter="enter('2786164034484170881');" onmouseout="out('2786164034484170881');" style=""> 446              throw new IllegalArgumentException(&quot;No driver supplied&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448      }                                                                                                             </span>
<span  style=""> 449                                                                                                                    </span>
<span  style=""> 450                                                                                                                    </span>
<span class="6406463361493174961" onmouseenter="enter('6406463361493174961');" onmouseout="out('6406463361493174961');" style=""> 451      public void setUsername(String username) {                                                                    </span>
<span class="3814814532238894677" onmouseenter="enter('3814814532238894677');" onmouseout="out('3814814532238894677');" style=""> 452          this.username = username;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453      }                                                                                                             </span>
<span  style=""> 454                                                                                                                    </span>
<span class="-3825272909736982583" onmouseenter="enter('-3825272909736982583');" onmouseout="out('-3825272909736982583');" style=""> 455      public String getSchema() {                                                                                   </span>
<span class="5446221637389984235" onmouseenter="enter('5446221637389984235');" onmouseout="out('5446221637389984235');" style=""> 456          if (StringUtils.isNotEmpty(schema)) {                                                                     </span>
<span class="7825857328791523733" onmouseenter="enter('7825857328791523733');" onmouseout="out('7825857328791523733');" style=""> 457              return schema;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458          }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 459          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460      }                                                                                                             </span>
<span  style=""> 461                                                                                                                    </span>
<span class="-8275115006432137720" onmouseenter="enter('-8275115006432137720');" onmouseout="out('-8275115006432137720');" style=""> 462      public void setSchema(String schema) {                                                                        </span>
<span class="-1474709937401640845" onmouseenter="enter('-1474709937401640845');" onmouseout="out('-1474709937401640845');" style=""> 463          this.schema = schema;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464      }                                                                                                             </span>
<span  style=""> 465                                                                                                                    </span>
<span class="-3205434816469053104" onmouseenter="enter('-3205434816469053104');" onmouseout="out('-3205434816469053104');" style=""> 466      public boolean existTabname() throws SQLException {                                                           </span>
<span class="3116641972317368973" onmouseenter="enter('3116641972317368973');" onmouseout="out('3116641972317368973');" style=""> 467          return dbConn.getMetaData().getTables(null, getSchema(), tableName, null).next();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468      }                                                                                                             </span>
<span  style=""> 469                                                                                                                    </span>
<span class="-8762905993839540808" onmouseenter="enter('-8762905993839540808');" onmouseout="out('-8762905993839540808');" style=""> 470      public void setPassword(String password) {                                                                    </span>
<span class="-1203449108757708291" onmouseenter="enter('-1203449108757708291');" onmouseout="out('-1203449108757708291');" style=""> 471          this.password = password;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472      }                                                                                                             </span>
<span  style=""> 473                                                                                                                    </span>
<span class="-6451273902705400944" onmouseenter="enter('-6451273902705400944');" onmouseout="out('-6451273902705400944');" style=""> 474      public void setDrivername(String drivername) {                                                                </span>
<span class="-6527539835349297323" onmouseenter="enter('-6527539835349297323');" onmouseout="out('-6527539835349297323');" style=""> 475          this.drivername = drivername;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476      }                                                                                                             </span>
<span  style=""> 477                                                                                                                    </span>
<span class="-4450191325013822656" onmouseenter="enter('-4450191325013822656');" onmouseout="out('-4450191325013822656');" style=""> 478      public String getDrivername() {                                                                               </span>
<span class="49971901064726256" onmouseenter="enter('49971901064726256');" onmouseout="out('49971901064726256');" style=""> 479          return this.drivername;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480      }                                                                                                             </span>
<span  style=""> 481                                                                                                                    </span>
<span class="-8785843843756664618" onmouseenter="enter('-8785843843756664618');" onmouseout="out('-8785843843756664618');" style=""> 482      public void setDbURL(String dbURL) {                                                                          </span>
<span class="8598265963597311104" onmouseenter="enter('8598265963597311104');" onmouseout="out('8598265963597311104');" style=""> 483          this.dbURL = dbURL;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484      }                                                                                                             </span>
<span  style=""> 485                                                                                                                    </span>
<span class="107024788727095650" onmouseenter="enter('107024788727095650');" onmouseout="out('107024788727095650');" style=""> 486      public void setTableName(String tableName) {                                                                  </span>
<span class="-2576382372206679378" onmouseenter="enter('-2576382372206679378');" onmouseout="out('-2576382372206679378');" style=""> 487          this.tableName = tableName;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488      }                                                                                                             </span>
<span  style=""> 489                                                                                                                    </span>
<span class="-9063600953796397432" onmouseenter="enter('-9063600953796397432');" onmouseout="out('-9063600953796397432');" style=""> 490      public void setDbType(String dbType) {                                                                        </span>
<span class="2007854907846702668" onmouseenter="enter('2007854907846702668');" onmouseout="out('2007854907846702668');" style=""> 491          this.dbType = dbType;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492      }                                                                                                             </span>
<span  style=""> 493                                                                                                                    </span>
<span class="-4134987697216204079" onmouseenter="enter('-4134987697216204079');" onmouseout="out('-4134987697216204079');" style=""> 494      public void setDbSink(RdbSink dbSink) {                                                                       </span>
<span class="-5605037428917107584" onmouseenter="enter('-5605037428917107584');" onmouseout="out('-5605037428917107584');" style=""> 495          this.dbSink = dbSink;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 496      }                                                                                                             </span>
<span  style=""> 497                                                                                                                    </span>
<span class="-3828322885637319660" onmouseenter="enter('-3828322885637319660');" onmouseout="out('-3828322885637319660');" style=""> 498      public void setBatchNum(int batchNum) {                                                                       </span>
<span class="-752167515364497179" onmouseenter="enter('-752167515364497179');" onmouseout="out('-752167515364497179');" style=""> 499          this.batchNum = batchNum;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500      }                                                                                                             </span>
<span  style=""> 501                                                                                                                    </span>
<span class="-3154576976316646938" onmouseenter="enter('-3154576976316646938');" onmouseout="out('-3154576976316646938');" style=""> 502      public void setInsertQuery(String insertQuery) {                                                              </span>
<span class="6967226552077948511" onmouseenter="enter('6967226552077948511');" onmouseout="out('6967226552077948511');" style=""> 503          this.insertQuery = insertQuery;                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 504      }                                                                                                             </span>
<span  style=""> 505                                                                                                                    </span>
<span class="1736919445659097293" onmouseenter="enter('1736919445659097293');" onmouseout="out('1736919445659097293');" style=""> 506      public void setTypesArray(int[] typesArray) {                                                                 </span>
<span class="-3171196374898256583" onmouseenter="enter('-3171196374898256583');" onmouseout="out('-3171196374898256583');" style=""> 507          this.typesArray = typesArray;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508      }                                                                                                             </span>
<span  style=""> 509                                                                                                                    </span>
<span class="-4603983989767211124" onmouseenter="enter('-4603983989767211124');" onmouseout="out('-4603983989767211124');" style=""> 510      public String getDbType() {                                                                                   </span>
<span class="8502844325642156582" onmouseenter="enter('8502844325642156582');" onmouseout="out('8502844325642156582');" style=""> 511          return dbType;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 512      }                                                                                                             </span>
<span  style=""> 513                                                                                                                    </span>
<span class="-430221742195887105" onmouseenter="enter('-430221742195887105');" onmouseout="out('-430221742195887105');" style=""> 514      public RdbSink getDbSink() {                                                                                  </span>
<span class="2284643160968561900" onmouseenter="enter('2284643160968561900');" onmouseout="out('2284643160968561900');" style=""> 515          return dbSink;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 516      }                                                                                                             </span>
<span  style=""> 517                                                                                                                    </span>
<span class="6178464245069286985" onmouseenter="enter('6178464245069286985');" onmouseout="out('6178464245069286985');" style=""> 518      public Connection getDbConn() {                                                                               </span>
<span class="1577087324280520407" onmouseenter="enter('1577087324280520407');" onmouseout="out('1577087324280520407');" style=""> 519          return dbConn;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 520      }                                                                                                             </span>
<span  style=""> 521                                                                                                                    </span>
<span class="5796947355340463495" onmouseenter="enter('5796947355340463495');" onmouseout="out('5796947355340463495');" style=""> 522      public String getTableName() {                                                                                </span>
<span class="7440436830317723056" onmouseenter="enter('7440436830317723056');" onmouseout="out('7440436830317723056');" style=""> 523          return tableName;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 524      }                                                                                                             </span>
<span  style=""> 525                                                                                                                    </span>
<span class="3310009708120385440" onmouseenter="enter('3310009708120385440');" onmouseout="out('3310009708120385440');" style=""> 526      public void realIndexesAdd(String index, List&lt;String&gt; fieldes) {                                              </span>
<span class="-2473533017553798079" onmouseenter="enter('-2473533017553798079');" onmouseout="out('-2473533017553798079');" style=""> 527          this.realIndexes.put(index, fieldes);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 528      }                                                                                                             </span>
<span  style=""> 529                                                                                                                    </span>
<span class="-2641499233738766061" onmouseenter="enter('-2641499233738766061');" onmouseout="out('-2641499233738766061');" style=""> 530      public Map&lt;String,List&lt;String&gt;&gt; getRealIndexes() {                                                            </span>
<span class="-1400103300826067343" onmouseenter="enter('-1400103300826067343');" onmouseout="out('-1400103300826067343');" style=""> 531          return realIndexes;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 532      }                                                                                                             </span>
<span  style=""> 533                                                                                                                    </span>
<span  style=""> 534                                                                                                                    </span>
<span class="-5991793941006063518" onmouseenter="enter('-5991793941006063518');" onmouseout="out('-5991793941006063518');" style=""> 535      public void setBatchWaitInterval(long batchWaitInterval) {                                                    </span>
<span class="-163778283108065789" onmouseenter="enter('-163778283108065789');" onmouseout="out('-163778283108065789');" style=""> 536          this.batchWaitInterval = batchWaitInterval;                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 537      }                                                                                                             </span>
<span  style=""> 538                                                                                                                    </span>
<span class="-5773190938839750646" onmouseenter="enter('-5773190938839750646');" onmouseout="out('-5773190938839750646');" style=""> 539      public List&lt;String&gt; getFullField() {                                                                          </span>
<span class="3348915112342931759" onmouseenter="enter('3348915112342931759');" onmouseout="out('3348915112342931759');" style=""> 540          return fullField;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541      }                                                                                                             </span>
<span  style=""> 542                                                                                                                    </span>
<span class="8256206851148910081" onmouseenter="enter('8256206851148910081');" onmouseout="out('8256206851148910081');" style=""> 543      public void fullFieldAdd(String colName) {                                                                    </span>
<span class="-7286725227748384380" onmouseenter="enter('-7286725227748384380');" onmouseout="out('-7286725227748384380');" style=""> 544          this.fullField.add(colName);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 545      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 546  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            