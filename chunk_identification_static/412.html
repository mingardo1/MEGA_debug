<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>412</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    412
                    <a href="411.html">prev</a>
                    <a href="413.html">next</a>
                    <a href="412_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_5553ee5c6410a412ab4ed61d9499805adee8995a_core/src/main/java/com/dtstack/flink/sql/side/BaseAllReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;5553ee5c6410a412ab4ed61d9499805adee8995a:core/src/main/java/com/dtstack/flink/sql/side/BaseAllReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;5553ee5c6410a412ab4ed61d9499805adee8995a^1:core/src/main/java/com/dtstack/flink/sql/side/BaseAllReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;5553ee5c6410a412ab4ed61d9499805adee8995a^2:core/src/main/java/com/dtstack/flink/sql/side/BaseAllReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;e0a10435dcb243a911c0405daebc6aa667d5119d:core/src/main/java/com/dtstack/flink/sql/side/BaseAllReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  20 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  21                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  22 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  23 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  24 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="7719258113580079788" onmouseenter="enter('7719258113580079788');" onmouseout="out('7719258113580079788');" style="">  25 import org.apache.flink.api.common.functions.RichFlatMapFunction;                                        </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  26 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  27 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  28 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  29 import org.apache.flink.types.Row;                                                                       </span>
<span class="1346044542033208814" onmouseenter="enter('1346044542033208814');" onmouseout="out('1346044542033208814');" style="">  30 import org.apache.flink.util.Collector;                                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  31 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  32 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  33                                                                                                          </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  34 import java.sql.SQLException;                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  35 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  36 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37 import java.time.LocalDateTime;                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  38 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  41 =======                                                                                                  </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  42 import java.util.TimeZone;                                                                               </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  43 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  44 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  45 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  46 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  47                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  48 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  49  * Reason:                                                                                               </span>
<span class="1629917692812984019" onmouseenter="enter('1629917692812984019');" onmouseout="out('1629917692812984019');" style="">  50  * Date: 2018/9/18                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  51  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  52  *                                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  53  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  54  */                                                                                                      </span>
<span  style="">  55                                                                                                          </span>
<span class="-592333095480929454" onmouseenter="enter('-592333095480929454');" onmouseout="out('-592333095480929454');" style="">  56 public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;Row, BaseRow&gt; implements ISideReqRow {   </span>
<span  style="">  57                                                                                                          </span>
<span class="4559857832609116843" onmouseenter="enter('4559857832609116843');" onmouseout="out('4559857832609116843');" style="">  58     private static final Logger LOG = LoggerFactory.getLogger(BaseAllReqRow.class);                      </span>
<span  style="">  59                                                                                                          </span>
<span class="1054905838001152821" onmouseenter="enter('1054905838001152821');" onmouseout="out('1054905838001152821');" style="">  60     public static final long LOAD_DATA_ERROR_SLEEP_TIME = 5_000L;                                        </span>
<span  style="">  61                                                                                                          </span>
<span class="-2641970720271398233" onmouseenter="enter('-2641970720271398233');" onmouseout="out('-2641970720271398233');" style="">  62     public static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                       </span>
<span  style="">  63                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  64     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  65                                                                                                          </span>
<span class="-1933417338228490272" onmouseenter="enter('-1933417338228490272');" onmouseout="out('-1933417338228490272');" style="">  66     private ScheduledExecutorService es;                                                                 </span>
<span  style="">  67                                                                                                          </span>
<span class="678581596433187218" onmouseenter="enter('678581596433187218');" onmouseout="out('678581596433187218');" style="">  68     public BaseAllReqRow(BaseSideInfo sideInfo) {                                                        </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  69         this.sideInfo = sideInfo;                                                                        </span>
<span  style="">  70                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  71     }                                                                                                    </span>
<span  style="">  72                                                                                                          </span>
<span class="2177058353100463642" onmouseenter="enter('2177058353100463642');" onmouseout="out('2177058353100463642');" style="">  73     protected abstract void initCache() throws SQLException;                                             </span>
<span  style="">  74                                                                                                          </span>
<span class="560392996096394966" onmouseenter="enter('560392996096394966');" onmouseout="out('560392996096394966');" style="">  75     protected abstract void reloadCache();                                                               </span>
<span  style="">  76                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  78     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  79         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  80         initCache();                                                                                     </span>
<span class="8845348154668107011" onmouseenter="enter('8845348154668107011');" onmouseout="out('8845348154668107011');" style="">  81         LOG.info(&quot;----- all cacheRef init end-----&quot;);                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="-7500816428168491395" onmouseenter="enter('-7500816428168491395');" onmouseout="out('-7500816428168491395');" style="">  83         //start reload cache thread                                                                      </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  84         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-3954173836383058259" onmouseenter="enter('-3954173836383058259');" onmouseout="out('-3954173836383058259');" style="">  85         es = new ScheduledThreadPoolExecutor(1, new DTThreadFactory(&quot;cache-all-reload&quot;));                </span>
<span class="2535441862580160729" onmouseenter="enter('2535441862580160729');" onmouseout="out('2535441862580160729');" style=""><abbr title="  86         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout(), TimeUnit.MILLISECONDS);">  86         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCac🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87     }                                                                                                    </span>
<span  style="">  88                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="">  89     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title="  90         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());">  90         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style="">  91                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title="  92         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long.">  92         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="">  93         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="">  94             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="">  96         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97     }                                                                                                    </span>
<span  style="">  98                                                                                                          </span>
<span class="5898257856531057198" onmouseenter="enter('5898257856531057198');" onmouseout="out('5898257856531057198');" style="">  99     protected void sendOutputRow(Row value, Object sideInput, Collector&lt;BaseRow&gt; out) {                  </span>
<span class="1908058223338426859" onmouseenter="enter('1908058223338426859');" onmouseout="out('1908058223338426859');" style=""> 100         if (sideInput == null &amp;&amp; sideInfo.getJoinType() != JoinType.LEFT) {                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 101             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span class="-2218530923901110220" onmouseenter="enter('-2218530923901110220');" onmouseout="out('-2218530923901110220');" style=""> 103         Row row = fillData(value, sideInput);                                                            </span>
<span class="-7906969292003116947" onmouseenter="enter('-7906969292003116947');" onmouseout="out('-7906969292003116947');" style=""> 104         RowDataComplete.collectRow(out, row);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105     }                                                                                                    </span>
<span  style=""> 106                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 107     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 108     public void close() throws Exception {                                                               </span>
<span class="8260874055341927211" onmouseenter="enter('8260874055341927211');" onmouseout="out('8260874055341927211');" style=""> 109         if (null != es &amp;&amp; !es.isShutdown()) {                                                            </span>
<span class="-1313555539312876173" onmouseenter="enter('-1313555539312876173');" onmouseout="out('-1313555539312876173');" style=""> 110             es.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  20 package com.dtstack.flink.sql.side;                                                                      </span>
<span class="7719258113580079788" onmouseenter="enter('7719258113580079788');" onmouseout="out('7719258113580079788');" style="">  21 import org.apache.flink.api.common.functions.RichFlatMapFunction;                                        </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  22 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  23 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  24 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  25 import org.apache.flink.types.Row;                                                                       </span>
<span class="1346044542033208814" onmouseenter="enter('1346044542033208814');" onmouseout="out('1346044542033208814');" style="">  26 import org.apache.flink.util.Collector;                                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  27 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  28 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  29                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  30 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  31 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  32 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span  style="">  33                                                                                                          </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  34 import java.sql.SQLException;                                                                            </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  35 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  36 import java.time.LocalDateTime;                                                                          </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  37 import java.util.TimeZone;                                                                               </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  38 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  39 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  40 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  41                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  42 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  43  * Reason:                                                                                               </span>
<span class="1629917692812984019" onmouseenter="enter('1629917692812984019');" onmouseout="out('1629917692812984019');" style="">  44  * Date: 2018/9/18                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  45  * Company: www.dtstack.com                                                                              </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  46  *                                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  47  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  48  */                                                                                                      </span>
<span  style="">  49                                                                                                          </span>
<span class="-592333095480929454" onmouseenter="enter('-592333095480929454');" onmouseout="out('-592333095480929454');" style="">  50 public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;Row, BaseRow&gt; implements ISideReqRow {   </span>
<span  style="">  51                                                                                                          </span>
<span class="4559857832609116843" onmouseenter="enter('4559857832609116843');" onmouseout="out('4559857832609116843');" style="">  52     private static final Logger LOG = LoggerFactory.getLogger(BaseAllReqRow.class);                      </span>
<span  style="">  53                                                                                                          </span>
<span class="1054905838001152821" onmouseenter="enter('1054905838001152821');" onmouseout="out('1054905838001152821');" style="">  54     public static final long LOAD_DATA_ERROR_SLEEP_TIME = 5_000L;                                        </span>
<span  style="">  55                                                                                                          </span>
<span class="-2641970720271398233" onmouseenter="enter('-2641970720271398233');" onmouseout="out('-2641970720271398233');" style="">  56     public static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                       </span>
<span  style="">  57                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  58     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  59                                                                                                          </span>
<span class="-1933417338228490272" onmouseenter="enter('-1933417338228490272');" onmouseout="out('-1933417338228490272');" style="">  60     private ScheduledExecutorService es;                                                                 </span>
<span  style="">  61                                                                                                          </span>
<span class="-1082580852522369274" onmouseenter="enter('-1082580852522369274');" onmouseout="out('-1082580852522369274');" style="">  62     public BaseAllReqRow(BaseSideInfo sideInfo){                                                         </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  63         this.sideInfo = sideInfo;                                                                        </span>
<span  style="">  64                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65     }                                                                                                    </span>
<span  style="">  66                                                                                                          </span>
<span class="2177058353100463642" onmouseenter="enter('2177058353100463642');" onmouseout="out('2177058353100463642');" style="">  67     protected abstract void initCache() throws SQLException;                                             </span>
<span  style="">  68                                                                                                          </span>
<span class="560392996096394966" onmouseenter="enter('560392996096394966');" onmouseout="out('560392996096394966');" style="">  69     protected abstract void reloadCache();                                                               </span>
<span  style="">  70                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  71     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  72     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  73         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  74         initCache();                                                                                     </span>
<span class="8845348154668107011" onmouseenter="enter('8845348154668107011');" onmouseout="out('8845348154668107011');" style="">  75         LOG.info(&quot;----- all cacheRef init end-----&quot;);                                                    </span>
<span  style="">  76                                                                                                          </span>
<span class="-7500816428168491395" onmouseenter="enter('-7500816428168491395');" onmouseout="out('-7500816428168491395');" style="">  77         //start reload cache thread                                                                      </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  78         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="3954738900753555595" onmouseenter="enter('3954738900753555595');" onmouseout="out('3954738900753555595');" style="">  79         es = new ScheduledThreadPoolExecutor(1,new DTThreadFactory(&quot;cache-all-reload&quot;));                 </span>
<span class="2535441862580160729" onmouseenter="enter('2535441862580160729');" onmouseout="out('2535441862580160729');" style=""><abbr title="  80         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout(), TimeUnit.MILLISECONDS);">  80         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCac🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="">  83     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title="  84         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());">  84         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style="">  85                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title="  86         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long.">  86         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="">  87         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="">  88             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="">  90         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span  style="">  92                                                                                                          </span>
<span class="5898257856531057198" onmouseenter="enter('5898257856531057198');" onmouseout="out('5898257856531057198');" style="">  93     protected void sendOutputRow(Row value, Object sideInput, Collector&lt;BaseRow&gt; out) {                  </span>
<span class="1908058223338426859" onmouseenter="enter('1908058223338426859');" onmouseout="out('1908058223338426859');" style="">  94         if (sideInput == null &amp;&amp; sideInfo.getJoinType() != JoinType.LEFT) {                              </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  95             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96         }                                                                                                </span>
<span class="-2218530923901110220" onmouseenter="enter('-2218530923901110220');" onmouseout="out('-2218530923901110220');" style="">  97         Row row = fillData(value, sideInput);                                                            </span>
<span class="-7906969292003116947" onmouseenter="enter('-7906969292003116947');" onmouseout="out('-7906969292003116947');" style="">  98         RowDataComplete.collectRow(out, row);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99     }                                                                                                    </span>
<span  style=""> 100                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 101     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 102     public void close() throws Exception {                                                               </span>
<span class="8260874055341927211" onmouseenter="enter('8260874055341927211');" onmouseout="out('8260874055341927211');" style=""> 103         if (null != es &amp;&amp; !es.isShutdown()) {                                                            </span>
<span class="-1313555539312876173" onmouseenter="enter('-1313555539312876173');" onmouseout="out('-1313555539312876173');" style=""> 104             es.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107 }                                                                                                        </span>




</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  20 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  21 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  22 import java.sql.SQLException;                                                                            </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  23 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  24 import java.time.LocalDateTime;                                                                          </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="">  25 import java.util.TimeZone;                                                                               </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  26 import java.util.concurrent.ScheduledExecutorService;                                                    </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  27 import java.util.concurrent.ScheduledThreadPoolExecutor;                                                 </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  28 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  29 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="7719258113580079788" onmouseenter="enter('7719258113580079788');" onmouseout="out('7719258113580079788');" style="">  30 import org.apache.flink.api.common.functions.RichFlatMapFunction;                                        </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  31 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  32 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  33 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  34 import org.apache.flink.types.Row;                                                                       </span>
<span class="1346044542033208814" onmouseenter="enter('1346044542033208814');" onmouseout="out('1346044542033208814');" style="">  35 import org.apache.flink.util.Collector;                                                                  </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  36 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  37 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  38                                                                                                          </span>
<span  style="">  39                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  41  * Reason:                                                                                               </span>
<span class="1629917692812984019" onmouseenter="enter('1629917692812984019');" onmouseout="out('1629917692812984019');" style="">  42  * Date: 2018/9/18                                                                                       </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  43  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  44  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45  */                                                                                                      </span>
<span class="-592333095480929454" onmouseenter="enter('-592333095480929454');" onmouseout="out('-592333095480929454');" style="">  46 public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;Row, BaseRow&gt; implements ISideReqRow {   </span>
<span class="4559857832609116843" onmouseenter="enter('4559857832609116843');" onmouseout="out('4559857832609116843');" style="">  47     private static final Logger LOG = LoggerFactory.getLogger(BaseAllReqRow.class);                      </span>
<span  style="">  48                                                                                                          </span>
<span class="1054905838001152821" onmouseenter="enter('1054905838001152821');" onmouseout="out('1054905838001152821');" style="">  49     public static final long LOAD_DATA_ERROR_SLEEP_TIME = 5_000L;                                        </span>
<span  style="">  50                                                                                                          </span>
<span class="-2641970720271398233" onmouseenter="enter('-2641970720271398233');" onmouseout="out('-2641970720271398233');" style="">  51     public static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                       </span>
<span  style="">  52                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  53     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  54                                                                                                          </span>
<span class="-1933417338228490272" onmouseenter="enter('-1933417338228490272');" onmouseout="out('-1933417338228490272');" style="">  55     private ScheduledExecutorService es;                                                                 </span>
<span  style="">  56                                                                                                          </span>
<span class="678581596433187218" onmouseenter="enter('678581596433187218');" onmouseout="out('678581596433187218');" style="">  57     public BaseAllReqRow(BaseSideInfo sideInfo) {                                                        </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  58         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  59     }                                                                                                    </span>
<span  style="">  60                                                                                                          </span>
<span class="2177058353100463642" onmouseenter="enter('2177058353100463642');" onmouseout="out('2177058353100463642');" style="">  61     protected abstract void initCache() throws SQLException;                                             </span>
<span  style="">  62                                                                                                          </span>
<span class="560392996096394966" onmouseenter="enter('560392996096394966');" onmouseout="out('560392996096394966');" style="">  63     protected abstract void reloadCache();                                                               </span>
<span  style="">  64                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  65     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  66     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  67         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  68         initCache();                                                                                     </span>
<span class="8845348154668107011" onmouseenter="enter('8845348154668107011');" onmouseout="out('8845348154668107011');" style="">  69         LOG.info(&quot;----- all cacheRef init end-----&quot;);                                                    </span>
<span class="6713825140408801191" onmouseenter="enter('6713825140408801191');" onmouseout="out('6713825140408801191');" style="">  70         // start reload cache thread                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  71         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-3954173836383058259" onmouseenter="enter('-3954173836383058259');" onmouseout="out('-3954173836383058259');" style="">  72         es = new ScheduledThreadPoolExecutor(1, new DTThreadFactory(&quot;cache-all-reload&quot;));                </span>
<span class="2535441862580160729" onmouseenter="enter('2535441862580160729');" onmouseout="out('2535441862580160729');" style=""><abbr title="  73         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout(), TimeUnit.MILLISECONDS);">  73         es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCac🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74     }                                                                                                    </span>
<span  style="">  75                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="">  76     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title="  77         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());">  77         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTyp🔵</abbr></span>
<span  style="">  78                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title="  79         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long.">  79         //Type information for indicating event or processing time. However, it behaves like a regular SQ🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="">  80         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="">  81             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="">  83         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="5898257856531057198" onmouseenter="enter('5898257856531057198');" onmouseout="out('5898257856531057198');" style="">  86     protected void sendOutputRow(Row value, Object sideInput, Collector&lt;BaseRow&gt; out) {                  </span>
<span class="3379082144054716371" onmouseenter="enter('3379082144054716371');" onmouseout="out('3379082144054716371');" style="">  87         if ((sideInput == null) &amp;&amp; (sideInfo.getJoinType() != JoinType.LEFT)) {                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  88             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  89         }                                                                                                </span>
<span class="-2218530923901110220" onmouseenter="enter('-2218530923901110220');" onmouseout="out('-2218530923901110220');" style="">  90         Row row = fillData(value, sideInput);                                                            </span>
<span class="-7906969292003116947" onmouseenter="enter('-7906969292003116947');" onmouseout="out('-7906969292003116947');" style="">  91         RowDataComplete.collectRow(out, row);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  92     }                                                                                                    </span>
<span  style="">  93                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  94     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style="">  95     public void close() throws Exception {                                                               </span>
<span class="8260874055341927211" onmouseenter="enter('8260874055341927211');" onmouseout="out('8260874055341927211');" style="">  96         if (null != es &amp;&amp; !es.isShutdown()) {                                                            </span>
<span class="-1313555539312876173" onmouseenter="enter('-1313555539312876173');" onmouseout="out('-1313555539312876173');" style="">  97             es.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100 }                                                                                                        </span>











</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -                                                                                                                  </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  23 +import com.dtstack.flink.sql.factory.DTThreadFactory;                                                             </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  24 +import com.dtstack.flink.sql.util.RowDataComplete;                                                                </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="7719258113580079788" onmouseenter="enter('7719258113580079788');" onmouseout="out('7719258113580079788');" style="">  26  import org.apache.flink.api.common.functions.RichFlatMapFunction;                                                 </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  27  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  28 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import org.apache.flink.table.dataformat.BaseRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  31  import org.apache.flink.types.Row;                                                                                </span>
<span class="1346044542033208814" onmouseenter="enter('1346044542033208814');" onmouseout="out('1346044542033208814');" style="">  32  import org.apache.flink.util.Collector;                                                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  33  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  34  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  35                                                                                                                    </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  36 -import com.dtstack.flink.sql.factory.DTThreadFactory;                                                             </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  37 -import org.apache.calcite.sql.JoinType;                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  38 -                                                                                                                  </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  39  import java.sql.SQLException;                                                                                     </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import java.sql.Timestamp;                                                                                        </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 +import java.time.LocalDateTime;                                                                                   </span>
<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  42  import java.util.concurrent.ScheduledExecutorService;                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  43  import java.util.concurrent.ScheduledThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  44  import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  45                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  46  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  47   * Reason:                                                                                                        </span>
<span class="1629917692812984019" onmouseenter="enter('1629917692812984019');" onmouseout="out('1629917692812984019');" style="">  48   * Date: 2018/9/18                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  49   * Company: www.dtstack.com                                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  50 + *                                                                                                                </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  51   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  52   */                                                                                                               </span>
<span  style="">  53                                                                                                                    </span>
<span class="-8511606881954796372" onmouseenter="enter('-8511606881954796372');" onmouseout="out('-8511606881954796372');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>
<span class="-592333095480929454" onmouseenter="enter('-592333095480929454');" onmouseout="out('-592333095480929454');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  55 +public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;Row, BaseRow&gt; implements ISideReqRow {            </span>
<span  style="">  56                                                                                                                    </span>
<span class="4559857832609116843" onmouseenter="enter('4559857832609116843');" onmouseout="out('4559857832609116843');" style="">  57      private static final Logger LOG = LoggerFactory.getLogger(BaseAllReqRow.class);                               </span>
<span  style="">  58                                                                                                                    </span>
<span class="1054905838001152821" onmouseenter="enter('1054905838001152821');" onmouseout="out('1054905838001152821');" style="">  59      public static final long LOAD_DATA_ERROR_SLEEP_TIME = 5_000L;                                                 </span>


<span  style="">  60                                                                                                                    </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  61      protected BaseSideInfo sideInfo;                                                                              </span>
<span  style="">  62                                                                                                                    </span>
<span class="-1933417338228490272" onmouseenter="enter('-1933417338228490272');" onmouseout="out('-1933417338228490272');" style="">  63      private ScheduledExecutorService es;                                                                          </span>
<span  style="">  64                                                                                                                    </span>
<span class="-1082580852522369274" onmouseenter="enter('-1082580852522369274');" onmouseout="out('-1082580852522369274');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -    public BaseAllReqRow(BaseSideInfo sideInfo){                                                                  </span>
<span class="678581596433187218" onmouseenter="enter('678581596433187218');" onmouseout="out('678581596433187218');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  66 +    public BaseAllReqRow(BaseSideInfo sideInfo) {                                                                 </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  67          this.sideInfo = sideInfo;                                                                                 </span>
<span  style="">  68                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  69      }                                                                                                             </span>
<span  style="">  70                                                                                                                    </span>
<span class="2177058353100463642" onmouseenter="enter('2177058353100463642');" onmouseout="out('2177058353100463642');" style="">  71      protected abstract void initCache() throws SQLException;                                                      </span>
<span  style="">  72                                                                                                                    </span>
<span class="560392996096394966" onmouseenter="enter('560392996096394966');" onmouseout="out('560392996096394966');" style="">  73      protected abstract void reloadCache();                                                                        </span>
<span  style="">  74                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  75      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  76      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  77          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  78          initCache();                                                                                              </span>
<span class="8845348154668107011" onmouseenter="enter('8845348154668107011');" onmouseout="out('8845348154668107011');" style="">  79          LOG.info(&quot;----- all cacheRef init end-----&quot;);                                                             </span>
<span  style="">  80                                                                                                                    </span>
<span class="-7500816428168491395" onmouseenter="enter('-7500816428168491395');" onmouseout="out('-7500816428168491395');" style="">  81          //start reload cache thread                                                                               </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  82          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="3954738900753555595" onmouseenter="enter('3954738900753555595');" onmouseout="out('3954738900753555595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -        es = new ScheduledThreadPoolExecutor(1,new DTThreadFactory(&quot;cache-all-reload&quot;));                          </span>
<span class="-3954173836383058259" onmouseenter="enter('-3954173836383058259');" onmouseout="out('-3954173836383058259');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  84 +        es = new ScheduledThreadPoolExecutor(1, new DTThreadFactory(&quot;cache-all-reload&quot;));                         </span>
<span class="2535441862580160729" onmouseenter="enter('2535441862580160729');" onmouseout="out('2535441862580160729');" style=""><abbr title="  85          es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout(), TimeUnit.MILLISECONDS);">  85          es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86      }                                                                                                             </span>
<span  style="">  87                                                                                                                    </span>
<span class="-82493003469376609" onmouseenter="enter('-82493003469376609');" onmouseout="out('-82493003469376609');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -    protected void sendOutputRow(CRow value, Object sideInput, Collector&lt;CRow&gt; out) {                             </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  89 +    protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                                     </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  90 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());">  90 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().g🔵</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  91 +                                                                                                                  </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  92 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long.">  92 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timesta🔵</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  93 +        if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  94 +            obj = Timestamp.valueOf(((LocalDateTime) obj));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  95 +        }                                                                                                         </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  96 +        return obj;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  97 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  98 +                                                                                                                  </span>
<span class="5898257856531057198" onmouseenter="enter('5898257856531057198');" onmouseout="out('5898257856531057198');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +    protected void sendOutputRow(Row value, Object sideInput, Collector&lt;BaseRow&gt; out) {                           </span>
<span class="1908058223338426859" onmouseenter="enter('1908058223338426859');" onmouseout="out('1908058223338426859');" style=""> 100          if (sideInput == null &amp;&amp; sideInfo.getJoinType() != JoinType.LEFT) {                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 101              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102          }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -                                                                                                                  </span>
<span class="8723480223552712867" onmouseenter="enter('8723480223552712867');" onmouseout="out('8723480223552712867');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -        Row row = fillData(value.row(), sideInput);                                                               </span>
<span class="5841932535843497133" onmouseenter="enter('5841932535843497133');" onmouseout="out('5841932535843497133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -        out.collect(new CRow(row, value.change()));                                                               </span>
<span class="-2218530923901110220" onmouseenter="enter('-2218530923901110220');" onmouseout="out('-2218530923901110220');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 106 +        Row row = fillData(value, sideInput);                                                                     </span>
<span class="-7906969292003116947" onmouseenter="enter('-7906969292003116947');" onmouseout="out('-7906969292003116947');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 107 +        RowDataComplete.collectRow(out, row);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108      }                                                                                                             </span>
<span  style=""> 109                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 110      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 111      public void close() throws Exception {                                                                        </span>
<span class="8260874055341927211" onmouseenter="enter('8260874055341927211');" onmouseout="out('8260874055341927211');" style=""> 112          if (null != es &amp;&amp; !es.isShutdown()) {                                                                     </span>
<span class="-1313555539312876173" onmouseenter="enter('-1313555539312876173');" onmouseout="out('-1313555539312876173');" style=""> 113              es.shutdown();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>



<span class="7719258113580079788" onmouseenter="enter('7719258113580079788');" onmouseout="out('7719258113580079788');" style="">  23  import org.apache.flink.api.common.functions.RichFlatMapFunction;                                                 </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  24  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  25  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>


<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  26  import org.apache.flink.types.Row;                                                                                </span>
<span class="1346044542033208814" onmouseenter="enter('1346044542033208814');" onmouseout="out('1346044542033208814');" style="">  27  import org.apache.flink.util.Collector;                                                                           </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  28  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  29  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  30                                                                                                                    </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  31  import com.dtstack.flink.sql.factory.DTThreadFactory;                                                             </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  32  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span  style="">  33                                                                                                                    </span>
<span class="-515559982825150111" onmouseenter="enter('-515559982825150111');" onmouseout="out('-515559982825150111');" style="">  34  import java.sql.SQLException;                                                                                     </span>
<span class="-3682115440535733483" onmouseenter="enter('-3682115440535733483');" onmouseout="out('-3682115440535733483');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import java.util.TimeZone;                                                                                        </span>

<span class="-3897126621644903861" onmouseenter="enter('-3897126621644903861');" onmouseout="out('-3897126621644903861');" style="">  36  import java.util.concurrent.ScheduledExecutorService;                                                             </span>
<span class="-300443590434253982" onmouseenter="enter('-300443590434253982');" onmouseout="out('-300443590434253982');" style="">  37  import java.util.concurrent.ScheduledThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  38  import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  39                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  40  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  41   * Reason:                                                                                                        </span>
<span class="1629917692812984019" onmouseenter="enter('1629917692812984019');" onmouseout="out('1629917692812984019');" style="">  42   * Date: 2018/9/18                                                                                                </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  43   * Company: www.dtstack.com                                                                                       </span>

<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  44   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  45   */                                                                                                               </span>
<span  style="">  46                                                                                                                    </span>
<span class="-8511606881954796372" onmouseenter="enter('-8511606881954796372');" onmouseout="out('-8511606881954796372');" style="">  47  public abstract class BaseAllReqRow extends RichFlatMapFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>

<span  style="">  48                                                                                                                    </span>
<span class="4559857832609116843" onmouseenter="enter('4559857832609116843');" onmouseout="out('4559857832609116843');" style="">  49      private static final Logger LOG = LoggerFactory.getLogger(BaseAllReqRow.class);                               </span>
<span  style="">  50                                                                                                                    </span>
<span class="1054905838001152821" onmouseenter="enter('1054905838001152821');" onmouseout="out('1054905838001152821');" style="">  51      public static final long LOAD_DATA_ERROR_SLEEP_TIME = 5_000L;                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +                                                                                                                  </span>
<span class="-2641970720271398233" onmouseenter="enter('-2641970720271398233');" onmouseout="out('-2641970720271398233');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +    public static final TimeZone LOCAL_TZ = TimeZone.getDefault();                                                </span>
<span  style="">  54                                                                                                                    </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  55      protected BaseSideInfo sideInfo;                                                                              </span>
<span  style="">  56                                                                                                                    </span>
<span class="-1933417338228490272" onmouseenter="enter('-1933417338228490272');" onmouseout="out('-1933417338228490272');" style="">  57      private ScheduledExecutorService es;                                                                          </span>
<span  style="">  58                                                                                                                    </span>
<span class="-1082580852522369274" onmouseenter="enter('-1082580852522369274');" onmouseout="out('-1082580852522369274');" style="">  59      public BaseAllReqRow(BaseSideInfo sideInfo){                                                                  </span>

<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  60          this.sideInfo = sideInfo;                                                                                 </span>
<span  style="">  61                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  62      }                                                                                                             </span>
<span  style="">  63                                                                                                                    </span>
<span class="2177058353100463642" onmouseenter="enter('2177058353100463642');" onmouseout="out('2177058353100463642');" style="">  64      protected abstract void initCache() throws SQLException;                                                      </span>
<span  style="">  65                                                                                                                    </span>
<span class="560392996096394966" onmouseenter="enter('560392996096394966');" onmouseout="out('560392996096394966');" style="">  66      protected abstract void reloadCache();                                                                        </span>
<span  style="">  67                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  68      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  69      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  70          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  71          initCache();                                                                                              </span>
<span class="8845348154668107011" onmouseenter="enter('8845348154668107011');" onmouseout="out('8845348154668107011');" style="">  72          LOG.info(&quot;----- all cacheRef init end-----&quot;);                                                             </span>
<span  style="">  73                                                                                                                    </span>
<span class="-7500816428168491395" onmouseenter="enter('-7500816428168491395');" onmouseout="out('-7500816428168491395');" style="">  74          //start reload cache thread                                                                               </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  75          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="3954738900753555595" onmouseenter="enter('3954738900753555595');" onmouseout="out('3954738900753555595');" style="">  76          es = new ScheduledThreadPoolExecutor(1,new DTThreadFactory(&quot;cache-all-reload&quot;));                          </span>

<span class="2535441862580160729" onmouseenter="enter('2535441862580160729');" onmouseout="out('2535441862580160729');" style=""><abbr title="  77          es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout(), TimeUnit.MILLISECONDS);">  77          es.scheduleAtFixedRate(() -&gt; reloadCache(), sideTableInfo.getCacheTimeout(), sideTableInfo.getCacheTimeout🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78      }                                                                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="-82493003469376609" onmouseenter="enter('-82493003469376609');" onmouseout="out('-82493003469376609');" style="">  80      protected void sendOutputRow(CRow value, Object sideInput, Collector&lt;CRow&gt; out) {                             </span>











<span class="1908058223338426859" onmouseenter="enter('1908058223338426859');" onmouseout="out('1908058223338426859');" style="">  81          if (sideInput == null &amp;&amp; sideInfo.getJoinType() != JoinType.LEFT) {                                       </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  82              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83          }                                                                                                         </span>
<span  style="">  84                                                                                                                    </span>
<span class="8723480223552712867" onmouseenter="enter('8723480223552712867');" onmouseout="out('8723480223552712867');" style="">  85          Row row = fillData(value.row(), sideInput);                                                               </span>
<span class="5841932535843497133" onmouseenter="enter('5841932535843497133');" onmouseout="out('5841932535843497133');" style="">  86          out.collect(new CRow(row, value.change()));                                                               </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87      }                                                                                                             </span>
<span  style="">  88                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  89      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style="">  90      public void close() throws Exception {                                                                        </span>
<span class="8260874055341927211" onmouseenter="enter('8260874055341927211');" onmouseout="out('8260874055341927211');" style="">  91          if (null != es &amp;&amp; !es.isShutdown()) {                                                                     </span>
<span class="-1313555539312876173" onmouseenter="enter('-1313555539312876173');" onmouseout="out('-1313555539312876173');" style="">  92              es.shutdown();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            