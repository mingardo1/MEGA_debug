<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>445</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    445
                    <a href="444.html">prev</a>
                    <a href="446.html">next</a>
                    <a href="445_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_cb68efb9e51ba697e771581059b9c11c3fe66ccb_core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cb68efb9e51ba697e771581059b9c11c3fe66ccb:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cb68efb9e51ba697e771581059b9c11c3fe66ccb^1:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;cb68efb9e51ba697e771581059b9c11c3fe66ccb^2:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;828062ef514a8028632086b1c19ef248140da519:core/src/main/java/com/dtstack/flink/sql/side/BaseAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [j]], subset: [[b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  25 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  26 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  27 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  28 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  29 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="-6846378294395456716" onmouseenter="enter('-6846378294395456716');" onmouseout="out('-6846378294395456716');" style="">  30 import com.dtstack.flink.sql.util.ReflectionUtils;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  31 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  32 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  33 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  34 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  35 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  36 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  37 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  38 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  39 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  40 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  41 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="509787159639480518" onmouseenter="enter('509787159639480518');" onmouseout="out('509787159639480518');" style="">  42 import org.apache.flink.streaming.api.operators.async.AsyncWaitOperator;                                 </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  43 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  44 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  45 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  46 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  49                                                                                                          </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="">  50 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="">  51 import java.lang.reflect.Method;                                                                         </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  52 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  53 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  54 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  55 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  56 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  57 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  58 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  59 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  60 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  63  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  64  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  65  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  66  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  67  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span  style="">  69                                                                                                          </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style=""><abbr title="  70 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  70 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt;ðŸ”µ</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  71     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  72     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  73     private RuntimeContext runtimeContext;                                                               </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  74     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  75     private int timeOutNum = 0;                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  76     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  77     protected transient Counter parseErrorRecords;                                                       </span>
<span class="-4235282784698995183" onmouseenter="enter('-4235282784698995183');" onmouseout="out('-4235282784698995183');" style="">  78     private transient ThreadPoolExecutor cancelExecutor;                                                 </span>
<span  style="">  79                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  80     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  81         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  84     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  85         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  86         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  88     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  89     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  90         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  91         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  92         initMetric();                                                                                    </span>
<span class="-5357350395681950564" onmouseenter="enter('-5357350395681950564');" onmouseout="out('-5357350395681950564');" style=""><abbr title="  93         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;(100000),">  93         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;ðŸ”µ</abbr></span>
<span class="-6973609401263910133" onmouseenter="enter('-6973609401263910133');" onmouseout="out('-6973609401263910133');" style="">  94                 new DTThreadFactory(&quot;cancel-timer-executor&quot;));                                           </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  95         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  98     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  99         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title=" 100         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){"> 100         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 101             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span  style=""> 103                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 104         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 105         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 106             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 107             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 108         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 109             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 109             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110         }                                                                                                </span>
<span  style=""> 111                                                                                                          </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 112         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span  style=""> 114                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 115     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 116         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 116         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSEðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117     }                                                                                                    </span>
<span  style=""> 118                                                                                                          </span>
<span  style=""> 119                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 120     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 121         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 121         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypðŸ”µ</abbr></span>
<span  style=""> 122                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 123         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 123         //Type information for indicating event or processing time. However, it behaves like a regular SQðŸ”µ</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 124         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 125             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 127         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 130     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 131         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 134     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 135         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136     }                                                                                                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 138     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 139         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140     }                                                                                                    </span>
<span  style=""> 141                                                                                                          </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style=""><abbr title=" 142     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 142     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)ðŸ”µ</abbr></span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 143         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 144             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 145             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 146                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 147                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 148             } catch (Exception e) {                                                                      </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 149                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 151         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 152             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154     }                                                                                                    </span>
<span  style=""> 155                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 156     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 157         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 158             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160     }                                                                                                    </span>
<span  style=""> 161                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 162     @Override                                                                                            </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style=""><abbr title=" 163     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 163     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throwsðŸ”µ</abbr></span>
<span  style=""> 164                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 165         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 166             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 166             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 168         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 169         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 170             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 171             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 173         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 174             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 174             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limiðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 175             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 177         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178     }                                                                                                    </span>
<span  style=""> 179                                                                                                          </span>
<span class="8126553163376563521" onmouseenter="enter('8126553163376563521');" onmouseout="out('8126553163376563521');" style=""> 180     protected void preInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)  </span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style=""> 181             throws InvocationTargetException, IllegalAccessException {                                   </span>
<span class="4387345248637534881" onmouseenter="enter('4387345248637534881');" onmouseout="out('4387345248637534881');" style=""> 182         registerTimerAndAddToHandler(input, resultFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 185     @Override                                                                                            </span>
<span class="-2243275033089377514" onmouseenter="enter('-2243275033089377514');" onmouseout="out('-2243275033089377514');" style=""><abbr title=" 186     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 186     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throðŸ”µ</abbr></span>
<span class="9065096426058295166" onmouseenter="enter('9065096426058295166');" onmouseout="out('9065096426058295166');" style=""> 187         Tuple2&lt;Boolean,Row&gt; input = Tuple2.of(row.f0, Row.copy(row.f1));                                 </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 188         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 189         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 190         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 191             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 192             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 194         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 195             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 196             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 198         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="-9003909312035718914" onmouseenter="enter('-9003909312035718914');" onmouseout="out('-9003909312035718914');" style=""> 201     private Map&lt;String, Object&gt; parseInputParam(Tuple2&lt;Boolean,Row&gt; input){                              </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 202         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 203         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 204             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="6191100121973195799" onmouseenter="enter('6191100121973195799');" onmouseout="out('6191100121973195799');" style=""> 205             Object equalObj = input.f1.getField(conValIndex);                                            </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 206             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 207                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 209             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 210             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 212         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 215     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 216         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217     }                                                                                                    </span>
<span  style=""> 218                                                                                                          </span>
<span class="-7723747577752883478" onmouseenter="enter('-7723747577752883478');" onmouseout="out('-7723747577752883478');" style=""><abbr title=" 219     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 219     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFutureðŸ”µ</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 220         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 221             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 222             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 223                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 224                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 225                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 226                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 227                     try {                                                                                </span>
<span class="8419751648379908906" onmouseenter="enter('8419751648379908906');" onmouseout="out('8419751648379908906');" style=""> 228                         Row row = fillData(input.f1, val.getContent());                                  </span>
<span class="3519738722574292955" onmouseenter="enter('3519738722574292955');" onmouseout="out('3519738722574292955');" style=""> 229                         resultFuture.complete(Collections.singleton(Tuple2.of(input.f0, row)));          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 230                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 231                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 233                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 234                     try {                                                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style=""> 235                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                        </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 236                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="-8913065612488796809" onmouseenter="enter('-8913065612488796809');" onmouseout="out('-8913065612488796809');" style=""> 237                             Row row = fillData(input.f1, one);                                           </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 238                             rowList.add(Tuple2.of(input.f0, row));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 240                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 241                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 242                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 244                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 245                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 245                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 247                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="-898482693488436802" onmouseenter="enter('-898482693488436802');" onmouseout="out('-898482693488436802');" style=""><abbr title=" 252     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception;"> 252     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, RðŸ”µ</abbr></span>
<span  style=""> 253                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 254     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 255                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 256     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 257         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="-630611453970550853" onmouseenter="enter('-630611453970550853');" onmouseout="out('-630611453970550853');" style=""><abbr title=" 260     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 260     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,RowðŸ”µ</abbr></span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 261         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 261         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(ðŸ”µ</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 262         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 263                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 264                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 266                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 267                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 269                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270     }                                                                                                    </span>
<span  style=""> 271                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 272 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-280332981243741686" onmouseenter="enter('-280332981243741686');" onmouseout="out('-280332981243741686');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 273     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)"> 273     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,RoðŸ”µ</abbr></span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 274             throws InvocationTargetException, IllegalAccessException {                                   </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 275         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="-1697127321132349868" onmouseenter="enter('-1697127321132349868');" onmouseout="out('-1697127321132349868');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 276         // resultFuture æ˜¯ResultHandler çš„å®žä¾‹                                                               </span>
<span class="-3856627095426761215" onmouseenter="enter('-3856627095426761215');" onmouseout="out('-3856627095426761215');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 277         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, ScheduledFuture.class);"> 277         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, SchedðŸ”µ</abbr></span>
<span class="-2306705786868597281" onmouseenter="enter('-2306705786868597281');" onmouseout="out('-2306705786868597281');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 278         setTimeoutTimer.invoke(resultFuture, timeFuture);                                                </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 279 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                                                                                                          </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286     protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {         </span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287         parseErrorRecords.inc();                                                                         </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 288         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){"> 288         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE))ðŸ”µ</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 300 =======                                                                                                  </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 301     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){"> 301     protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuturðŸ”µ</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305                 timerFuture.cancel(true);                                                                </span>
<span class="1131192414662341470" onmouseenter="enter('1131192414662341470');" onmouseout="out('1131192414662341470');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306             }, cancelExecutor);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307         }                                                                                                </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 308 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309     }                                                                                                    </span>
<span  style=""> 310                                                                                                          </span>
<span  style=""> 311                                                                                                          </span>
<span class="-3547135807325970611" onmouseenter="enter('-3547135807325970611');" onmouseout="out('-3547135807325970611');" style=""><abbr title=" 312     protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Throwable e) {"> 312     protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFðŸ”µ</abbr></span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 313         parseErrorRecords.inc();                                                                         </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""><abbr title=" 314         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){"> 314         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE))ðŸ”µ</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 315             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 316             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 317         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 318             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320     }                                                                                                    </span>
<span  style=""> 321                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 322     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 323     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 324         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 325     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span  style="">  20                                                                                                          </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  22                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  25 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  26 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  27 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  28 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  29 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="-6846378294395456716" onmouseenter="enter('-6846378294395456716');" onmouseout="out('-6846378294395456716');" style="">  30 import com.dtstack.flink.sql.util.ReflectionUtils;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  31 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  32 import com.google.common.collect.Maps;                                                                   </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  33 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  34 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  35 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  36 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  37 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  38 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  39 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  40 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  41 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="509787159639480518" onmouseenter="enter('509787159639480518');" onmouseout="out('509787159639480518');" style="">  42 import org.apache.flink.streaming.api.operators.async.AsyncWaitOperator;                                 </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  43 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  44 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  45 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  46 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  47 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  48 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  49                                                                                                          </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="">  50 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="">  51 import java.lang.reflect.Method;                                                                         </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  52 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  53 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  54 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  55 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  56 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  57 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  58 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  59 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  60 import java.util.concurrent.TimeUnit;                                                                    </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  63  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  64  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  65  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  66  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  67  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span  style="">  69                                                                                                          </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style=""><abbr title="  70 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  70 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt;ðŸ”µ</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  71     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  72     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  73     private RuntimeContext runtimeContext;                                                               </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  74     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  75     private int timeOutNum = 0;                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  76     protected BaseSideInfo sideInfo;                                                                     </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  77     protected transient Counter parseErrorRecords;                                                       </span>
<span class="-4235282784698995183" onmouseenter="enter('-4235282784698995183');" onmouseout="out('-4235282784698995183');" style="">  78     private transient ThreadPoolExecutor cancelExecutor;                                                 </span>
<span  style="">  79                                                                                                          </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  80     public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                       </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  81         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  82     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  83     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  84     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  85         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  86         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  87     }                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  88     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  89     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  90         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  91         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  92         initMetric();                                                                                    </span>
<span class="-5357350395681950564" onmouseenter="enter('-5357350395681950564');" onmouseout="out('-5357350395681950564');" style=""><abbr title="  93         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;(100000),">  93         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;ðŸ”µ</abbr></span>
<span class="-6973609401263910133" onmouseenter="enter('-6973609401263910133');" onmouseout="out('-6973609401263910133');" style="">  94                 new DTThreadFactory(&quot;cancel-timer-executor&quot;));                                           </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  95         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  98     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  99         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title=" 100         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){"> 100         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 101             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 102         }                                                                                                </span>
<span  style=""> 103                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 104         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 105         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 106             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 107             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 108         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 109             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 109             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110         }                                                                                                </span>
<span  style=""> 111                                                                                                          </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 112         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span  style=""> 114                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 115     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 116         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 116         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSEðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117     }                                                                                                    </span>
<span  style=""> 118                                                                                                          </span>
<span  style=""> 119                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 120     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 121         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 121         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypðŸ”µ</abbr></span>
<span  style=""> 122                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 123         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 123         //Type information for indicating event or processing time. However, it behaves like a regular SQðŸ”µ</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 124         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 125             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 126         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 127         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 130     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 131         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132     }                                                                                                    </span>
<span  style=""> 133                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 134     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 135         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136     }                                                                                                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 138     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 139         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140     }                                                                                                    </span>
<span  style=""> 141                                                                                                          </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style=""><abbr title=" 142     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 142     protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)ðŸ”µ</abbr></span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 143         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 144             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 145             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 146                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 147                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 148             } catch (Exception e) {                                                                      </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 149                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150             }                                                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 151         }else{                                                                                           </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 152             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154     }                                                                                                    </span>
<span  style=""> 155                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 156     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 157         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 158             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160     }                                                                                                    </span>
<span  style=""> 161                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 162     @Override                                                                                            </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style=""><abbr title=" 163     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 163     public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throwsðŸ”µ</abbr></span>
<span  style=""> 164                                                                                                          </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 165         if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                     </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""><abbr title=" 166             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);"> 166             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167         }                                                                                                </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 168         timeOutNum ++;                                                                                   </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 169         if(sideInfo.getJoinType() == JoinType.LEFT){                                                     </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 170             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 171             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172         }                                                                                                </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 173         if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                 </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 174             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 174             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limiðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 175             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 177         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178     }                                                                                                    </span>
<span  style=""> 179                                                                                                          </span>
<span class="8126553163376563521" onmouseenter="enter('8126553163376563521');" onmouseout="out('8126553163376563521');" style=""> 180     protected void preInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)  </span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style=""> 181             throws InvocationTargetException, IllegalAccessException {                                   </span>
<span class="4387345248637534881" onmouseenter="enter('4387345248637534881');" onmouseout="out('4387345248637534881');" style=""> 182         registerTimerAndAddToHandler(input, resultFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183     }                                                                                                    </span>
<span  style=""> 184                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 185     @Override                                                                                            </span>
<span class="-2243275033089377514" onmouseenter="enter('-2243275033089377514');" onmouseout="out('-2243275033089377514');" style=""><abbr title=" 186     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 186     public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throðŸ”µ</abbr></span>
<span class="9065096426058295166" onmouseenter="enter('9065096426058295166');" onmouseout="out('9065096426058295166');" style=""> 187         Tuple2&lt;Boolean,Row&gt; input = Tuple2.of(row.f0, Row.copy(row.f1));                                 </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 188         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 189         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 190         if(MapUtils.isEmpty(inputParams)){                                                               </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 191             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 192             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193         }                                                                                                </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 194         if(isUseCache(inputParams)){                                                                     </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 195             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 196             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 198         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="-9003909312035718914" onmouseenter="enter('-9003909312035718914');" onmouseout="out('-9003909312035718914');" style=""> 201     private Map&lt;String, Object&gt; parseInputParam(Tuple2&lt;Boolean,Row&gt; input){                              </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 202         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 203         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 204             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="6191100121973195799" onmouseenter="enter('6191100121973195799');" onmouseout="out('6191100121973195799');" style=""> 205             Object equalObj = input.f1.getField(conValIndex);                                            </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 206             if(equalObj == null){                                                                        </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 207                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 209             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 210             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 212         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 215     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 216         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217     }                                                                                                    </span>
<span  style=""> 218                                                                                                          </span>
<span class="-7723747577752883478" onmouseenter="enter('-7723747577752883478');" onmouseout="out('-7723747577752883478');" style=""><abbr title=" 219     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 219     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFutureðŸ”µ</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 220         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 221             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 222             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 223                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 224                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 225                     return;                                                                              </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 226                 }else if(ECacheContentType.SingleLine == val.getType()){                                 </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 227                     try {                                                                                </span>
<span class="8419751648379908906" onmouseenter="enter('8419751648379908906');" onmouseout="out('8419751648379908906');" style=""> 228                         Row row = fillData(input.f1, val.getContent());                                  </span>
<span class="3519738722574292955" onmouseenter="enter('3519738722574292955');" onmouseout="out('3519738722574292955');" style=""> 229                         resultFuture.complete(Collections.singleton(Tuple2.of(input.f0, row)));          </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 230                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 231                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 233                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 234                     try {                                                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style=""> 235                         List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                        </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 236                         for (Object one : (List) val.getContent()) {                                     </span>
<span class="-8913065612488796809" onmouseenter="enter('-8913065612488796809');" onmouseout="out('-8913065612488796809');" style=""> 237                             Row row = fillData(input.f1, one);                                           </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 238                             rowList.add(Tuple2.of(input.f0, row));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 240                         resultFuture.complete(rowList);                                                  </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 241                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 242                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 244                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 245                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 245                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 247                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250     }                                                                                                    </span>
<span  style=""> 251                                                                                                          </span>
<span class="-898482693488436802" onmouseenter="enter('-898482693488436802');" onmouseout="out('-898482693488436802');" style=""><abbr title=" 252     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception;"> 252     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, RðŸ”µ</abbr></span>
<span  style=""> 253                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 254     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 255                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 256     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 257         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="-630611453970550853" onmouseenter="enter('-630611453970550853');" onmouseout="out('-630611453970550853');" style=""><abbr title=" 260     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 260     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,RowðŸ”µ</abbr></span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 261         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 261         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(ðŸ”µ</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 262         return getProcessingTimeService().registerTimer(                                                 </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 263                 timeoutTimestamp,                                                                        </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 264                 new ProcessingTimeCallback() {                                                           </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265                     @Override                                                                            </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 266                     public void onProcessingTime(long timestamp) throws Exception {                      </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 267                         timeout(input, resultFuture);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 269                 });                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270     }                                                                                                    </span>
<span  style=""> 271                                                                                                          </span>
<span class="-280332981243741686" onmouseenter="enter('-280332981243741686');" onmouseout="out('-280332981243741686');" style=""><abbr title=" 272     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)"> 272     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,RoðŸ”µ</abbr></span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style=""> 273             throws InvocationTargetException, IllegalAccessException {                                   </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 274         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="-1697127321132349868" onmouseenter="enter('-1697127321132349868');" onmouseout="out('-1697127321132349868');" style=""> 275         // resultFuture æ˜¯ResultHandler çš„å®žä¾‹                                                               </span>
<span class="-3856627095426761215" onmouseenter="enter('-3856627095426761215');" onmouseout="out('-3856627095426761215');" style=""><abbr title=" 276         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, ScheduledFuture.class);"> 276         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, SchedðŸ”µ</abbr></span>
<span class="-2306705786868597281" onmouseenter="enter('-2306705786868597281');" onmouseout="out('-2306705786868597281');" style=""> 277         setTimeoutTimer.invoke(resultFuture, timeFuture);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span  style=""> 280                                                                                                          </span>
<span class="-3547135807325970611" onmouseenter="enter('-3547135807325970611');" onmouseout="out('-3547135807325970611');" style=""><abbr title=" 281     protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Throwable e) {"> 281     protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFðŸ”µ</abbr></span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 282         parseErrorRecords.inc();                                                                         </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""><abbr title=" 283         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){"> 283         if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE))ðŸ”µ</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 284             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 285             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 286         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 287             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 290 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 291 ||||||| BASE                                                                                             </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292 protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){ </span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 293         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 293         ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBðŸ”µ</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297                 timerFuture.cancel(true);                                                                </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298             },executors);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 301 =======                                                                                                  </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 302 protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){ </span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 303         if(resultFuture instanceof StreamRecordQueueEntry){                                              </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 304             StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;      </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 305             streamRecordBufferEntry.onComplete((Object value) -&gt; {                                       </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 306                 timerFuture.cancel(true);                                                                </span>
<span class="1131192414662341470" onmouseenter="enter('1131192414662341470');" onmouseout="out('1131192414662341470');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 307             }, cancelExecutor);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 308         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 309     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 310 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 311                                                                                                          </span>
<span  style=""> 312                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 313     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 314     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 315         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317 }                                                                                                        </span>







</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  18 package com.dtstack.flink.sql.side;                                                                      </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  21 import com.dtstack.flink.sql.enums.ECacheType;                                                           </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="">  22 import com.dtstack.flink.sql.factory.DTThreadFactory;                                                    </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  23 import com.dtstack.flink.sql.metric.MetricConstant;                                                      </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  24 import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                               </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  25 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  26 import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                    </span>
<span class="-6846378294395456716" onmouseenter="enter('-6846378294395456716');" onmouseout="out('-6846378294395456716');" style="">  27 import com.dtstack.flink.sql.util.ReflectionUtils;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  28 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  29 import com.google.common.collect.Maps;                                                                   </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="">  30 import java.lang.reflect.InvocationTargetException;                                                      </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="">  31 import java.lang.reflect.Method;                                                                         </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  32 import java.sql.Timestamp;                                                                               </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="">  33 import java.time.LocalDateTime;                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  34 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  35 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  36 import java.util.Map;                                                                                    </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  37 import java.util.concurrent.LinkedBlockingQueue;                                                         </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  38 import java.util.concurrent.ScheduledFuture;                                                             </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  39 import java.util.concurrent.ThreadPoolExecutor;                                                          </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  40 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  41 import org.apache.calcite.sql.JoinType;                                                                  </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  42 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  43 import org.apache.flink.api.common.functions.RuntimeContext;                                             </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  44 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  45 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  46 import org.apache.flink.metrics.Counter;                                                                 </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  47 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  48 import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                 </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  49 import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                 </span>
<span class="509787159639480518" onmouseenter="enter('509787159639480518');" onmouseout="out('509787159639480518');" style="">  50 import org.apache.flink.streaming.api.operators.async.AsyncWaitOperator;                                 </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  51 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                  </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  52 import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                   </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  53 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  54 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  57                                                                                                          </span>
<span  style="">  58                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59 /**                                                                                                      </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  60  * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  61  * only support Left join / inner join(join),not support right join                                      </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  62  * Date: 2018/7/9                                                                                        </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  63  * Company: www.dtstack.com                                                                              </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  64  * @author xuchao                                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  65  */                                                                                                      </span>
<span class="5004288966946545706" onmouseenter="enter('5004288966946545706');" onmouseout="out('5004288966946545706');" style=""><abbr title="  66 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean, Row&gt;, Tuple2&lt;Boolean, Row&gt;&gt; implements ISideReqRow {">  66 public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean, Row&gt;, Tuple2&lt;Boolean, RowðŸ”µ</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  67     private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                    </span>
<span  style="">  68                                                                                                          </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  69     private static final long serialVersionUID = 2098635244857937717L;                                   </span>
<span  style="">  70                                                                                                          </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  71     private RuntimeContext runtimeContext;                                                               </span>
<span  style="">  72                                                                                                          </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  73     private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                       </span>
<span  style="">  74                                                                                                          </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  75     private int timeOutNum = 0;                                                                          </span>
<span  style="">  76                                                                                                          </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  77     protected BaseSideInfo sideInfo;                                                                     </span>
<span  style="">  78                                                                                                          </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  79     protected transient Counter parseErrorRecords;                                                       </span>
<span  style="">  80                                                                                                          </span>
<span class="-4235282784698995183" onmouseenter="enter('-4235282784698995183');" onmouseout="out('-4235282784698995183');" style="">  81     private transient ThreadPoolExecutor cancelExecutor;                                                 </span>
<span  style="">  82                                                                                                          </span>
<span class="8633132124041356827" onmouseenter="enter('8633132124041356827');" onmouseout="out('8633132124041356827');" style="">  83     public BaseAsyncReqRow(BaseSideInfo sideInfo) {                                                      </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  84         this.sideInfo = sideInfo;                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85     }                                                                                                    </span>
<span  style="">  86                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  87     @Override                                                                                            </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  88     public void setRuntimeContext(RuntimeContext runtimeContext) {                                       </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  89         super.setRuntimeContext(runtimeContext);                                                         </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  90         this.runtimeContext = runtimeContext;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  91     }                                                                                                    </span>
<span  style="">  92                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  93     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  94     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  95         super.open(parameters);                                                                          </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  96         initCache();                                                                                     </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  97         initMetric();                                                                                    </span>
<span class="-5357350395681950564" onmouseenter="enter('-5357350395681950564');" onmouseout="out('-5357350395681950564');" style=""><abbr title="  98         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;(100000),">  98         cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;ðŸ”µ</abbr></span>
<span class="-6973609401263910133" onmouseenter="enter('-6973609401263910133');" onmouseout="out('-6973609401263910133');" style="">  99                 new DTThreadFactory(&quot;cancel-timer-executor&quot;));                                           </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style=""> 100         LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101     }                                                                                                    </span>
<span  style=""> 102                                                                                                          </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style=""> 103     private void initCache(){                                                                            </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style=""> 104         AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                               </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title=" 105         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){"> 105         if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.ðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 106             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107         }                                                                                                </span>
<span  style=""> 108                                                                                                          </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 109         AbstractSideCache sideCache;                                                                     </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 110         if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                        </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 111             sideCache = new LRUSideCache(sideTableInfo);                                                 </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 112             sideInfo.setSideCache(sideCache);                                                            </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 113         }else{                                                                                           </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""><abbr title=" 114             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());"> 114             throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType()ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115         }                                                                                                </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 116         sideCache.initCache();                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117     }                                                                                                    </span>
<span  style=""> 118                                                                                                          </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 119     private void initMetric() {                                                                          </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 120         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 120         parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSEðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 121     }                                                                                                    </span>
<span  style=""> 122                                                                                                          </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style=""> 123     protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                            </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style=""><abbr title=" 124         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 124         boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypðŸ”µ</abbr></span>
<span  style=""> 125                                                                                                          </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style=""><abbr title=" 126         //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 126         //Type information for indicating event or processing time. However, it behaves like a regular SQðŸ”µ</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style=""> 127         if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style=""> 128             obj = Timestamp.valueOf(((LocalDateTime) obj));                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129         }                                                                                                </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style=""> 130         return obj;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 133     protected CacheObj getFromCache(String key){                                                         </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 134         return sideInfo.getSideCache().getFromCache(key);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135     }                                                                                                    </span>
<span  style=""> 136                                                                                                          </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 137     protected void putCache(String key, CacheObj value){                                                 </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 138         sideInfo.getSideCache().putCache(key, value);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139     }                                                                                                    </span>
<span  style=""> 140                                                                                                          </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 141     protected boolean openCache(){                                                                       </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 142         return sideInfo.getSideCache() != null;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143     }                                                                                                    </span>
<span  style=""> 144                                                                                                          </span>
<span class="-98716559701656738" onmouseenter="enter('-98716559701656738');" onmouseout="out('-98716559701656738');" style=""><abbr title=" 145     protected void dealMissKey(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) {"> 145     protected void dealMissKey(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuturðŸ”µ</abbr></span>
<span class="3012505652182075436" onmouseenter="enter('3012505652182075436');" onmouseout="out('3012505652182075436');" style=""> 146         if (sideInfo.getJoinType() == JoinType.LEFT) {                                                   </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 147             //Reserved left table data                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 148             try {                                                                                        </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style=""> 149                 Row row = fillData(input.f1, null);                                                      </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style=""> 150                 resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));               </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 151             } catch (java.lang.Exception e) {                                                            </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 152                 dealFillDataError(input, resultFuture, e);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153             }                                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 154         } else {                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 155             resultFuture.complete(null);                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 159     protected void dealCacheData(String key, CacheObj missKeyObj) {                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 160         if (openCache()) {                                                                               </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 161             putCache(key, missKeyObj);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163     }                                                                                                    </span>
<span  style=""> 164                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165     @Override                                                                                            </span>
<span class="-4832727189529261219" onmouseenter="enter('-4832727189529261219');" onmouseout="out('-4832727189529261219');" style=""><abbr title=" 166     public void timeout(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception {"> 166     public void timeout(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throðŸ”µ</abbr></span>
<span class="-4512921245805166737" onmouseenter="enter('-4512921245805166737');" onmouseout="out('-4512921245805166737');" style=""> 167         if ((timeOutNum % TIMEOUT_LOG_FLUSH_NUM) == 0) {                                                 </span>
<span class="969036689275660584" onmouseenter="enter('969036689275660584');" onmouseout="out('969036689275660584');" style=""><abbr title=" 168             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), timeOutNum);"> 168             LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;, input.toString(), timeðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169         }                                                                                                </span>
<span class="-2219815117127949521" onmouseenter="enter('-2219815117127949521');" onmouseout="out('-2219815117127949521');" style=""> 170         timeOutNum++;                                                                                    </span>
<span class="3012505652182075436" onmouseenter="enter('3012505652182075436');" onmouseout="out('3012505652182075436');" style=""> 171         if (sideInfo.getJoinType() == JoinType.LEFT) {                                                   </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 172             resultFuture.complete(null);                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 173             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="1912651862938115971" onmouseenter="enter('1912651862938115971');" onmouseout="out('1912651862938115971');" style=""> 175         if (timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)) {               </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""><abbr title=" 176             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));"> 176             resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limiðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 177             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178         }                                                                                                </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 179         resultFuture.complete(null);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180     }                                                                                                    </span>
<span  style=""> 181                                                                                                          </span>
<span class="6123230478625074411" onmouseenter="enter('6123230478625074411');" onmouseout="out('6123230478625074411');" style=""><abbr title=" 182     protected void preInvoke(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws InvocationTargetException, IllegalAccessException {"> 182     protected void preInvoke(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture)ðŸ”µ</abbr></span>
<span class="4387345248637534881" onmouseenter="enter('4387345248637534881');" onmouseout="out('4387345248637534881');" style=""> 183         registerTimerAndAddToHandler(input, resultFuture);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 186     @Override                                                                                            </span>
<span class="-2736268063097777489" onmouseenter="enter('-2736268063097777489');" onmouseout="out('-2736268063097777489');" style=""><abbr title=" 187     public void asyncInvoke(Tuple2&lt;Boolean, Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception {"> 187     public void asyncInvoke(Tuple2&lt;Boolean, Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) thðŸ”µ</abbr></span>
<span class="2143876025219382983" onmouseenter="enter('2143876025219382983');" onmouseout="out('2143876025219382983');" style=""> 188         Tuple2&lt;Boolean, Row&gt; input = Tuple2.of(row.f0, Row.copy(row.f1));                                </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 189         preInvoke(input, resultFuture);                                                                  </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 190         Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                        </span>
<span class="-7264079055940701546" onmouseenter="enter('-7264079055940701546');" onmouseout="out('-7264079055940701546');" style=""> 191         if (MapUtils.isEmpty(inputParams)) {                                                             </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 192             dealMissKey(input, resultFuture);                                                            </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 193             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194         }                                                                                                </span>
<span class="9114579006700652139" onmouseenter="enter('9114579006700652139');" onmouseout="out('9114579006700652139');" style=""> 195         if (isUseCache(inputParams)) {                                                                   </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 196             invokeWithCache(inputParams, input, resultFuture);                                           </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 197             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198         }                                                                                                </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 199         handleAsyncInvoke(inputParams, input, resultFuture);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="-9050797943637994032" onmouseenter="enter('-9050797943637994032');" onmouseout="out('-9050797943637994032');" style=""> 202     private Map&lt;String, Object&gt; parseInputParam(Tuple2&lt;Boolean, Row&gt; input) {                            </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 203         Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                             </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 204         for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                   </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 205             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="6191100121973195799" onmouseenter="enter('6191100121973195799');" onmouseout="out('6191100121973195799');" style=""> 206             Object equalObj = input.f1.getField(conValIndex);                                            </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style=""> 207             if (equalObj == null) {                                                                      </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 208                 return inputParams;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209             }                                                                                            </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 210             String columnName = sideInfo.getEqualFieldList().get(i);                                     </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 211             inputParams.put(columnName, equalObj);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212         }                                                                                                </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 213         return inputParams;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 216     protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                       </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 217         return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="-1319739485411087975" onmouseenter="enter('-1319739485411087975');" onmouseout="out('-1319739485411087975');" style=""><abbr title=" 220     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) {"> 220     private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFuturðŸ”µ</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 221         if (openCache()) {                                                                               </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 222             CacheObj val = getFromCache(buildCacheKey(inputParams));                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 223             if (val != null) {                                                                           </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 224                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 225                     dealMissKey(input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 226                     return;                                                                              </span>
<span class="-2008897206859372663" onmouseenter="enter('-2008897206859372663');" onmouseout="out('-2008897206859372663');" style=""> 227                 } else if (ECacheContentType.SingleLine == val.getType()) {                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 228                     try {                                                                                </span>
<span class="8419751648379908906" onmouseenter="enter('8419751648379908906');" onmouseout="out('8419751648379908906');" style=""> 229                         Row row = fillData(input.f1, val.getContent());                                  </span>
<span class="3519738722574292955" onmouseenter="enter('3519738722574292955');" onmouseout="out('3519738722574292955');" style=""> 230                         resultFuture.complete(Collections.singleton(Tuple2.of(input.f0, row)));          </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 231                     } catch (java.lang.Exception e) {                                                    </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 232                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233                     }                                                                                    </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 234                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 235                     try {                                                                                </span>
<span class="6351868012214346308" onmouseenter="enter('6351868012214346308');" onmouseout="out('6351868012214346308');" style=""> 236                         List&lt;Tuple2&lt;Boolean, Row&gt;&gt; rowList = Lists.newArrayList();                       </span>
<span class="4327590853316091067" onmouseenter="enter('4327590853316091067');" onmouseout="out('4327590853316091067');" style=""> 237                         for (Object one : ((List) (val.getContent()))) {                                 </span>
<span class="-8913065612488796809" onmouseenter="enter('-8913065612488796809');" onmouseout="out('-8913065612488796809');" style=""> 238                             Row row = fillData(input.f1, one);                                           </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style=""> 239                             rowList.add(Tuple2.of(input.f0, row));                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240                         }                                                                                </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 241                         resultFuture.complete(rowList);                                                  </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 242                     } catch (java.lang.Exception e) {                                                    </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 243                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 245                 } else {                                                                                 </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 246                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 246                     resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot;ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 248                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251     }                                                                                                    </span>
<span  style=""> 252                                                                                                          </span>
<span class="4673934150011107477" onmouseenter="enter('4673934150011107477');" onmouseout="out('4673934150011107477');" style=""><abbr title=" 253     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws Exception;"> 253     public abstract void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean, Row&gt; input, RðŸ”µ</abbr></span>
<span  style=""> 254                                                                                                          </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 255     public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                               </span>
<span  style=""> 256                                                                                                          </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 257     private ProcessingTimeService getProcessingTimeService(){                                            </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 258         return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259     }                                                                                                    </span>
<span  style=""> 260                                                                                                          </span>
<span class="-6321779188552838624" onmouseenter="enter('-6321779188552838624');" onmouseout="out('-6321779188552838624');" style=""><abbr title=" 261     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) {"> 261     protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, RðŸ”µ</abbr></span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 262         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 262         long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService(ðŸ”µ</abbr></span>
<span class="-7151909297394971445" onmouseenter="enter('-7151909297394971445');" onmouseout="out('-7151909297394971445');" style=""> 263         return getProcessingTimeService().registerTimer(timeoutTimestamp, new ProcessingTimeCallback() { </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 264             @Override                                                                                    </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 265             public void onProcessingTime(long timestamp) throws Exception {                              </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 266                 timeout(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 268         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269     }                                                                                                    </span>
<span  style=""> 270                                                                                                          </span>
<span class="3393030605895880639" onmouseenter="enter('3393030605895880639');" onmouseout="out('3393030605895880639');" style=""><abbr title=" 271     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture) throws InvocationTargetException, IllegalAccessException {"> 271     protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, ðŸ”µ</abbr></span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 272         ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                              </span>
<span class="-1697127321132349868" onmouseenter="enter('-1697127321132349868');" onmouseout="out('-1697127321132349868');" style=""> 273         // resultFuture æ˜¯ResultHandler çš„å®žä¾‹                                                               </span>
<span class="-3856627095426761215" onmouseenter="enter('-3856627095426761215');" onmouseout="out('-3856627095426761215');" style=""><abbr title=" 274         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, ScheduledFuture.class);"> 274         Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, SchedðŸ”µ</abbr></span>
<span class="-2306705786868597281" onmouseenter="enter('-2306705786868597281');" onmouseout="out('-2306705786868597281');" style=""> 275         setTimeoutTimer.invoke(resultFuture, timeFuture);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276     }                                                                                                    </span>
<span  style=""> 277                                                                                                          </span>
<span class="-187954083357552369" onmouseenter="enter('-187954083357552369');" onmouseout="out('-187954083357552369');" style=""><abbr title=" 278     protected void dealFillDataError(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resultFuture, Throwable e) {"> 278     protected void dealFillDataError(Tuple2&lt;Boolean, Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean, Row&gt;&gt; resulðŸ”µ</abbr></span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 279         parseErrorRecords.inc();                                                                         </span>
<span class="6939484962528932570" onmouseenter="enter('6939484962528932570');" onmouseout="out('6939484962528932570');" style=""><abbr title=" 280         if (parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)) {"> 280         if (parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)ðŸ”µ</abbr></span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 281             LOG.info(&quot;dealFillDataError&quot;, e);                                                            </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 282             resultFuture.completeExceptionally(e);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 283         } else {                                                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 284             dealMissKey(input, resultFuture);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286     }                                                                                                    </span>
<span  style=""> 287                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 288     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 289     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 290         super.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292 }                                                                                                        </span>
































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>

<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  25  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  26  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  27  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  28  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>
<span class="-6846378294395456716" onmouseenter="enter('-6846378294395456716');" onmouseout="out('-6846378294395456716');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import com.dtstack.flink.sql.util.ReflectionUtils;                                                                </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  30  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  31  import com.google.common.collect.Maps;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  32  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  33  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  34  import org.apache.flink.api.common.functions.RuntimeContext;                                                      </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  36  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  37  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  38  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  39  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  40  import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                          </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  41 -import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                               </span>
<span class="509787159639480518" onmouseenter="enter('509787159639480518');" onmouseout="out('509787159639480518');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +import org.apache.flink.streaming.api.operators.async.AsyncWaitOperator;                                          </span>
<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  43  import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                           </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  44  import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  46 +import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  47  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  48  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  49  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  50                                                                                                                    </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  51 +import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  52 +import java.lang.reflect.Method;                                                                                  </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  53 +import java.sql.Timestamp;                                                                                        </span>
<span class="-608398790767092657" onmouseenter="enter('-608398790767092657');" onmouseout="out('-608398790767092657');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import java.time.LocalDateTime;                                                                                   </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  55  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  56  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  57  import java.util.Map;                                                                                             </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  58  import java.util.concurrent.LinkedBlockingQueue;                                                                  </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  59  import java.util.concurrent.ScheduledFuture;                                                                      </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  60  import java.util.concurrent.ThreadPoolExecutor;                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  61  import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  62                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  64   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  65   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  66   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  67   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  68   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69   */                                                                                                               </span>
<span  style="">  70                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>
<span class="-3761651597271895964" onmouseenter="enter('-3761651597271895964');" onmouseout="out('-3761651597271895964');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  72 +public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implements ISideReqRow {">  72 +public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;Tuple2&lt;Boolean,Row&gt;, Tuple2&lt;Boolean,Row&gt;&gt; implemenðŸ”µ</abbr></span>
<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  73      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  74      private static final long serialVersionUID = 2098635244857937717L;                                            </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  75      private RuntimeContext runtimeContext;                                                                        </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  76      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  77      private int timeOutNum = 0;                                                                                   </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  78      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  79      protected transient Counter parseErrorRecords;                                                                </span>

<span  style="">  80                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  81      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  82          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83      }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  84      @Override                                                                                                     </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  85      public void setRuntimeContext(RuntimeContext runtimeContext) {                                                </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  86          super.setRuntimeContext(runtimeContext);                                                                  </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  87          this.runtimeContext = runtimeContext;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88      }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  89      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  90      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  91          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  92          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  93          initMetric();                                                                                             </span>


<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  94          LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95      }                                                                                                             </span>
<span  style="">  96                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  97      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  98          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  99          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  99          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheTðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 100              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 101          }                                                                                                         </span>
<span  style=""> 102                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style=""> 103          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style=""> 104          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 105              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 106              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 107          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""> 108              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 109          }                                                                                                         </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 110 +                                                                                                                  </span>
<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 111          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112      }                                                                                                             </span>
<span  style=""> 113                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 114      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 115          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 115          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_REðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116      }                                                                                                             </span>
<span  style=""> 117                                                                                                                    </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +                                                                                                                  </span>
<span class="8882378893662803707" onmouseenter="enter('8882378893662803707');" onmouseout="out('8882378893662803707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 119 +    protected Object convertTimeIndictorTypeInfo(Integer index, Object obj) {                                     </span>
<span class="-8713079285683523197" onmouseenter="enter('-8713079285683523197');" onmouseout="out('-8713079285683523197');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 120 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(index).getClass());"> 120 +        boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().gðŸ”µ</abbr></span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 121 +                                                                                                                  </span>
<span class="-3282491156107731631" onmouseenter="enter('-3282491156107731631');" onmouseout="out('-3282491156107731631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 122 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timestamp but is serialized as Long."> 122 +        //Type information for indicating event or processing time. However, it behaves like a regular SQL timestaðŸ”µ</abbr></span>
<span class="1452307447442944053" onmouseenter="enter('1452307447442944053');" onmouseout="out('1452307447442944053');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 123 +        if (obj instanceof LocalDateTime &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-4621669505255820300" onmouseenter="enter('-4621669505255820300');" onmouseout="out('-4621669505255820300');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 124 +            obj = Timestamp.valueOf(((LocalDateTime) obj));                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 125 +        }                                                                                                         </span>
<span class="6899018813308939848" onmouseenter="enter('6899018813308939848');" onmouseout="out('6899018813308939848');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 126 +        return obj;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 127 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +                                                                                                                  </span>
<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 129      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 130          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131      }                                                                                                             </span>
<span  style=""> 132                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 133      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 134          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135      }                                                                                                             </span>
<span  style=""> 136                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 137      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 138          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 139      }                                                                                                             </span>
<span  style=""> 140                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -    protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>
<span class="5036161405790008892" onmouseenter="enter('5036161405790008892');" onmouseout="out('5036161405790008892');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 142 +    protected void dealMissKey(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){        </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 143          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 144              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 145              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -                Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -                resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>
<span class="-2643299628795503582" onmouseenter="enter('-2643299628795503582');" onmouseout="out('-2643299628795503582');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +                Row row = fillData(input.f1, null);                                                               </span>
<span class="-6519214573804802827" onmouseenter="enter('-6519214573804802827');" onmouseout="out('-6519214573804802827');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +                resultFuture.complete(Collections.singleton(new Tuple2&lt;&gt;(input.f0, row)));                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 150              } catch (Exception e) {                                                                               </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 151                  dealFillDataError(input, resultFuture, e);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 153          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 154              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156      }                                                                                                             </span>
<span  style=""> 157                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 158      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 159          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 160              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -    public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>
<span class="-1413928377855416956" onmouseenter="enter('-1413928377855416956');" onmouseout="out('-1413928377855416956');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 166 +    public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 166 +    public void timeout(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws ExceptioðŸ”µ</abbr></span>
<span  style=""> 167                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 168          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 169              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170          }                                                                                                         </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 171          timeOutNum ++;                                                                                            </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 172          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 173              resultFuture.complete(null);                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 174              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 176          if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                          </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 177              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 178              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 180          resultFuture.complete(null);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -    protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                        </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -        ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                                       </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -        cancelTimerWhenComplete(resultFuture, timeFuture);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -    @Override                                                                                                     </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -    public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                         </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -        CRow input = new CRow(Row.copy(row.row()), row.change());                                                 </span>
<span class="8126553163376563521" onmouseenter="enter('8126553163376563521');" onmouseout="out('8126553163376563521');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 191 +    protected void preInvoke(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)           </span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 192 +            throws InvocationTargetException, IllegalAccessException {                                            </span>
<span class="4387345248637534881" onmouseenter="enter('4387345248637534881');" onmouseout="out('4387345248637534881');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +        registerTimerAndAddToHandler(input, resultFuture);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 196 +    @Override                                                                                                     </span>
<span class="-2243275033089377514" onmouseenter="enter('-2243275033089377514');" onmouseout="out('-2243275033089377514');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 197 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception {"> 197 +    public void asyncInvoke(Tuple2&lt;Boolean,Row&gt; row, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws ExceptðŸ”µ</abbr></span>
<span class="9065096426058295166" onmouseenter="enter('9065096426058295166');" onmouseout="out('9065096426058295166');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +        Tuple2&lt;Boolean,Row&gt; input = Tuple2.of(row.f0, Row.copy(row.f1));                                          </span>
<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 199          preInvoke(input, resultFuture);                                                                           </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 200          Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                                 </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 201          if(MapUtils.isEmpty(inputParams)){                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 202              dealMissKey(input, resultFuture);                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 203              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204          }                                                                                                         </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 205          if(isUseCache(inputParams)){                                                                              </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 206              invokeWithCache(inputParams, input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 207              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 208          }                                                                                                         </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 209          handleAsyncInvoke(inputParams, input, resultFuture);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210      }                                                                                                             </span>
<span  style=""> 211                                                                                                                    </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -    private Map&lt;String, Object&gt; parseInputParam(CRow input){                                                      </span>
<span class="-9003909312035718914" onmouseenter="enter('-9003909312035718914');" onmouseout="out('-9003909312035718914');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 213 +    private Map&lt;String, Object&gt; parseInputParam(Tuple2&lt;Boolean,Row&gt; input){                                       </span>
<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 214          Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                                      </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 215          for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 216              Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -            Object equalObj = input.row().getField(conValIndex);                                                  </span>
<span class="6191100121973195799" onmouseenter="enter('6191100121973195799');" onmouseout="out('6191100121973195799');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 218 +            Object equalObj = input.f1.getField(conValIndex);                                                     </span>
<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 219              if(equalObj == null){                                                                                 </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 220                  return inputParams;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221              }                                                                                                     </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 222              String columnName = sideInfo.getEqualFieldList().get(i);                                              </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 223              inputParams.put(columnName, equalObj);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224          }                                                                                                         </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 225          return inputParams;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 226      }                                                                                                             </span>
<span  style=""> 227                                                                                                                    </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 228      protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                                </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 229          return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -    private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){   </span>
<span class="-7723747577752883478" onmouseenter="enter('-7723747577752883478');" onmouseout="out('-7723747577752883478');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 233 +    private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 233 +    private void invokeWithCache(Map&lt;String, Object&gt; inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;BðŸ”µ</abbr></span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 234          if (openCache()) {                                                                                        </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 235              CacheObj val = getFromCache(buildCacheKey(inputParams));                                              </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 236              if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 237                  if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 238                      dealMissKey(input, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 239                      return;                                                                                       </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 240                  }else if(ECacheContentType.SingleLine == val.getType()){                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 241                      try {                                                                                         </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -                        Row row = fillData(input.row(), val.getContent());                                        </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="8419751648379908906" onmouseenter="enter('8419751648379908906');" onmouseout="out('8419751648379908906');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 244 +                        Row row = fillData(input.f1, val.getContent());                                           </span>
<span class="3519738722574292955" onmouseenter="enter('3519738722574292955');" onmouseout="out('3519738722574292955');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 245 +                        resultFuture.complete(Collections.singleton(Tuple2.of(input.f0, row)));                   </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 246                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 247                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248                      }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 249                  } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 250                      try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                        List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>
<span class="763046399620908392" onmouseenter="enter('763046399620908392');" onmouseout="out('763046399620908392');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +                        List&lt;Tuple2&lt;Boolean,Row&gt;&gt; rowList = Lists.newArrayList();                                 </span>
<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 253                          for (Object one : (List) val.getContent()) {                                              </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -                            Row row = fillData(input.row(), one);                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -                            rowList.add(new CRow(row, input.change()));                                           </span>
<span class="-8913065612488796809" onmouseenter="enter('-8913065612488796809');" onmouseout="out('-8913065612488796809');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 256 +                            Row row = fillData(input.f1, one);                                                    </span>
<span class="-8285151347569160982" onmouseenter="enter('-8285151347569160982');" onmouseout="out('-8285151347569160982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 257 +                            rowList.add(Tuple2.of(input.f0, row));                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258                          }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 259                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 260                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 261                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 263                  } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 264                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 264                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.geðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 266                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269      }                                                                                                             </span>
<span  style=""> 270                                                                                                                    </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 271 -    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 271 -    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultðŸ”µ</abbr></span>
<span class="-898482693488436802" onmouseenter="enter('-898482693488436802');" onmouseout="out('-898482693488436802');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 272 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture) throws Exception;"> 272 +    public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, Tuple2&lt;Boolean,Row&gt; input, ResultFutuðŸ”µ</abbr></span>
<span  style=""> 273                                                                                                                    </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 274      public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                                        </span>
<span  style=""> 275                                                                                                                    </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 276      private ProcessingTimeService getProcessingTimeService(){                                                     </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 277          return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278      }                                                                                                             </span>
<span  style=""> 279                                                                                                                    </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -    protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                      </span>
<span class="-630611453970550853" onmouseenter="enter('-630611453970550853');" onmouseout="out('-630611453970550853');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 281 +    protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture){"> 281 +    protected ScheduledFuture&lt;?&gt; registerTimer(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultðŸ”µ</abbr></span>
<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 282          long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 282          long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrðŸ”µ</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 283          return getProcessingTimeService().registerTimer(                                                          </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 284                  timeoutTimestamp,                                                                                 </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 285                  new ProcessingTimeCallback() {                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 286                      @Override                                                                                     </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 287                      public void onProcessingTime(long timestamp) throws Exception {                               </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 288                          timeout(input, resultFuture);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 290                  });                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291      }                                                                                                             </span>
<span  style=""> 292                                                                                                                    </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -    protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){      </span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 294 -        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 294 -        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQuðŸ”µ</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -        if(resultFuture instanceof StreamRecordQueueEntry){                                                       </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -            StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;               </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -            streamRecordBufferEntry.onComplete((Object value) -&gt; {                                                </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -                timerFuture.cancel(true);                                                                         </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -            },executors);                                                                                         </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 301 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 302 -                                                                                                                  </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 303 -    protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {                  </span>
<span class="-280332981243741686" onmouseenter="enter('-280332981243741686');" onmouseout="out('-280332981243741686');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 304 +    protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture)"> 304 +    protected void registerTimerAndAddToHandler(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resulðŸ”µ</abbr></span>
<span class="1123544836616560736" onmouseenter="enter('1123544836616560736');" onmouseout="out('1123544836616560736');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 305 +            throws InvocationTargetException, IllegalAccessException {                                            </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 306 +        ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                                       </span>
<span class="-1697127321132349868" onmouseenter="enter('-1697127321132349868');" onmouseout="out('-1697127321132349868');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 307 +        // resultFuture æ˜¯ResultHandler çš„å®žä¾‹                                                                        </span>
<span class="-3856627095426761215" onmouseenter="enter('-3856627095426761215');" onmouseout="out('-3856627095426761215');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 308 +        Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, ScheduledFuture.class);"> 308 +        Method setTimeoutTimer = ReflectionUtils.getDeclaredMethod(resultFuture, &quot;setTimeoutTimer&quot;, ScheduledFuturðŸ”µ</abbr></span>
<span class="-2306705786868597281" onmouseenter="enter('-2306705786868597281');" onmouseout="out('-2306705786868597281');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 309 +        setTimeoutTimer.invoke(resultFuture, timeFuture);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 310 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 311 +                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 312 +                                                                                                                  </span>
<span class="-3547135807325970611" onmouseenter="enter('-3547135807325970611');" onmouseout="out('-3547135807325970611');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 313 +    protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, Throwable e) {"> 313 +    protected void dealFillDataError(Tuple2&lt;Boolean,Row&gt; input, ResultFuture&lt;Tuple2&lt;Boolean,Row&gt;&gt; resultFuture, ThðŸ”µ</abbr></span>
<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 314          parseErrorRecords.inc();                                                                                  </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""> 315          if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){        </span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 316              LOG.info(&quot;dealFillDataError&quot;, e);                                                                     </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 317              resultFuture.completeExceptionally(e);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 318          } else {                                                                                                  </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 319              dealMissKey(input, resultFuture);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321      }                                                                                                             </span>
<span  style=""> 322                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 323      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 324      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 325          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span  style="">  20                                                                                                                    </span>
<span class="2641237788859285263" onmouseenter="enter('2641237788859285263');" onmouseout="out('2641237788859285263');" style="">  21  package com.dtstack.flink.sql.side;                                                                               </span>
<span  style="">  22                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  23  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="8826438848011158297" onmouseenter="enter('8826438848011158297');" onmouseout="out('8826438848011158297');" style="">  24  import com.dtstack.flink.sql.enums.ECacheType;                                                                    </span>
<span class="9128825106411316982" onmouseenter="enter('9128825106411316982');" onmouseout="out('9128825106411316982');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.factory.DTThreadFactory;                                                             </span>
<span class="5359118447081401003" onmouseenter="enter('5359118447081401003');" onmouseout="out('5359118447081401003');" style="">  26  import com.dtstack.flink.sql.metric.MetricConstant;                                                               </span>
<span class="1678163714479594981" onmouseenter="enter('1678163714479594981');" onmouseout="out('1678163714479594981');" style="">  27  import com.dtstack.flink.sql.side.cache.AbstractSideCache;                                                        </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  28  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="3955915444936925884" onmouseenter="enter('3955915444936925884');" onmouseout="out('3955915444936925884');" style="">  29  import com.dtstack.flink.sql.side.cache.LRUSideCache;                                                             </span>

<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  30  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  31  import com.google.common.collect.Maps;                                                                            </span>
<span class="8584998077480306668" onmouseenter="enter('8584998077480306668');" onmouseout="out('8584998077480306668');" style="">  32  import org.apache.calcite.sql.JoinType;                                                                           </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  33  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="-4494328713862117703" onmouseenter="enter('-4494328713862117703');" onmouseout="out('-4494328713862117703');" style="">  34  import org.apache.flink.api.common.functions.RuntimeContext;                                                      </span>

<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  35  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="9075461173183292480" onmouseenter="enter('9075461173183292480');" onmouseout="out('9075461173183292480');" style="">  36  import org.apache.flink.metrics.Counter;                                                                          </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  37  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="7420023241803941071" onmouseenter="enter('7420023241803941071');" onmouseout="out('7420023241803941071');" style="">  38  import org.apache.flink.streaming.api.functions.async.RichAsyncFunction;                                          </span>
<span class="-1449798154476894332" onmouseenter="enter('-1449798154476894332');" onmouseout="out('-1449798154476894332');" style="">  39  import org.apache.flink.streaming.api.operators.StreamingRuntimeContext;                                          </span>
<span class="1740320806871794417" onmouseenter="enter('1740320806871794417');" onmouseout="out('1740320806871794417');" style="">  40  import org.apache.flink.streaming.api.operators.async.queue.StreamRecordQueueEntry;                               </span>

<span class="-2022345892978713419" onmouseenter="enter('-2022345892978713419');" onmouseout="out('-2022345892978713419');" style="">  41  import org.apache.flink.streaming.runtime.tasks.ProcessingTimeCallback;                                           </span>
<span class="8638145521045748245" onmouseenter="enter('8638145521045748245');" onmouseout="out('8638145521045748245');" style="">  42  import org.apache.flink.streaming.runtime.tasks.ProcessingTimeService;                                            </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  43  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>

<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  44  import org.apache.flink.types.Row;                                                                                </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  45  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  46  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  47                                                                                                                    </span>




<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  48  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  49  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  50  import java.util.Map;                                                                                             </span>
<span class="5052275383743182469" onmouseenter="enter('5052275383743182469');" onmouseout="out('5052275383743182469');" style="">  51  import java.util.concurrent.LinkedBlockingQueue;                                                                  </span>
<span class="-305598108755392570" onmouseenter="enter('-305598108755392570');" onmouseout="out('-305598108755392570');" style="">  52  import java.util.concurrent.ScheduledFuture;                                                                      </span>
<span class="8146438650974953238" onmouseenter="enter('8146438650974953238');" onmouseout="out('8146438650974953238');" style="">  53  import java.util.concurrent.ThreadPoolExecutor;                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  54  import java.util.concurrent.TimeUnit;                                                                             </span>
<span  style="">  55                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  56  /**                                                                                                               </span>
<span class="6063650271264649079" onmouseenter="enter('6063650271264649079');" onmouseout="out('6063650271264649079');" style="">  57   * All interfaces inherit naming rules: type + &quot;AsyncReqRow&quot; such as == &quot;MysqlAsyncReqRow                         </span>
<span class="2519821263143138280" onmouseenter="enter('2519821263143138280');" onmouseout="out('2519821263143138280');" style="">  58   * only support Left join / inner join(join),not support right join                                               </span>
<span class="685260098838419791" onmouseenter="enter('685260098838419791');" onmouseout="out('685260098838419791');" style="">  59   * Date: 2018/7/9                                                                                                 </span>
<span class="8814254840422205931" onmouseenter="enter('8814254840422205931');" onmouseout="out('8814254840422205931');" style="">  60   * Company: www.dtstack.com                                                                                       </span>
<span class="5932225095843400519" onmouseenter="enter('5932225095843400519');" onmouseout="out('5932225095843400519');" style="">  61   * @author xuchao                                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  62   */                                                                                                               </span>
<span  style="">  63                                                                                                                    </span>
<span class="4708568815554760955" onmouseenter="enter('4708568815554760955');" onmouseout="out('4708568815554760955');" style="">  64  public abstract class BaseAsyncReqRow extends RichAsyncFunction&lt;CRow, CRow&gt; implements ISideReqRow {              </span>

<span class="-4238682173983269843" onmouseenter="enter('-4238682173983269843');" onmouseout="out('-4238682173983269843');" style="">  65      private static final Logger LOG = LoggerFactory.getLogger(BaseAsyncReqRow.class);                             </span>
<span class="-4579521870319981636" onmouseenter="enter('-4579521870319981636');" onmouseout="out('-4579521870319981636');" style="">  66      private static final long serialVersionUID = 2098635244857937717L;                                            </span>
<span class="7345203391666548097" onmouseenter="enter('7345203391666548097');" onmouseout="out('7345203391666548097');" style="">  67      private RuntimeContext runtimeContext;                                                                        </span>
<span class="-8713230433377548045" onmouseenter="enter('-8713230433377548045');" onmouseout="out('-8713230433377548045');" style="">  68      private static int TIMEOUT_LOG_FLUSH_NUM = 10;                                                                </span>
<span class="-8348838838623205346" onmouseenter="enter('-8348838838623205346');" onmouseout="out('-8348838838623205346');" style="">  69      private int timeOutNum = 0;                                                                                   </span>
<span class="7855853597999694134" onmouseenter="enter('7855853597999694134');" onmouseout="out('7855853597999694134');" style="">  70      protected BaseSideInfo sideInfo;                                                                              </span>
<span class="3272151987714636976" onmouseenter="enter('3272151987714636976');" onmouseout="out('3272151987714636976');" style="">  71      protected transient Counter parseErrorRecords;                                                                </span>
<span class="-4235282784698995183" onmouseenter="enter('-4235282784698995183');" onmouseout="out('-4235282784698995183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  72 +    private transient ThreadPoolExecutor cancelExecutor;                                                          </span>
<span  style="">  73                                                                                                                    </span>
<span class="4654250711302850627" onmouseenter="enter('4654250711302850627');" onmouseout="out('4654250711302850627');" style="">  74      public BaseAsyncReqRow(BaseSideInfo sideInfo){                                                                </span>
<span class="5469877439413257307" onmouseenter="enter('5469877439413257307');" onmouseout="out('5469877439413257307');" style="">  75          this.sideInfo = sideInfo;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76      }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  77      @Override                                                                                                     </span>
<span class="-3340683564615291386" onmouseenter="enter('-3340683564615291386');" onmouseout="out('-3340683564615291386');" style="">  78      public void setRuntimeContext(RuntimeContext runtimeContext) {                                                </span>
<span class="6970875847293445144" onmouseenter="enter('6970875847293445144');" onmouseout="out('6970875847293445144');" style="">  79          super.setRuntimeContext(runtimeContext);                                                                  </span>
<span class="4468239621576057744" onmouseenter="enter('4468239621576057744');" onmouseout="out('4468239621576057744');" style="">  80          this.runtimeContext = runtimeContext;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81      }                                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  82      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  83      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  84          super.open(parameters);                                                                                   </span>
<span class="-8513347278389209370" onmouseenter="enter('-8513347278389209370');" onmouseout="out('-8513347278389209370');" style="">  85          initCache();                                                                                              </span>
<span class="7389701435636403373" onmouseenter="enter('7389701435636403373');" onmouseout="out('7389701435636403373');" style="">  86          initMetric();                                                                                             </span>
<span class="-5357350395681950564" onmouseenter="enter('-5357350395681950564');" onmouseout="out('-5357350395681950564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +        cancelExecutor = new ThreadPoolExecutor(1, 1, 0, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;&gt;(100000),</span>
<span class="-6973609401263910133" onmouseenter="enter('-6973609401263910133');" onmouseout="out('-6973609401263910133');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +                new DTThreadFactory(&quot;cancel-timer-executor&quot;));                                                    </span>
<span class="-2639429124980271724" onmouseenter="enter('-2639429124980271724');" onmouseout="out('-2639429124980271724');" style="">  89          LOG.info(&quot;async dim table config info: {} &quot;, sideInfo.getSideTableInfo().toString());                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="583026884693527088" onmouseenter="enter('583026884693527088');" onmouseout="out('583026884693527088');" style="">  92      private void initCache(){                                                                                     </span>
<span class="-6153197051693155267" onmouseenter="enter('-6153197051693155267');" onmouseout="out('-6153197051693155267');" style="">  93          AbstractSideTableInfo sideTableInfo = sideInfo.getSideTableInfo();                                        </span>
<span class="-1677170069465195982" onmouseenter="enter('-1677170069465195982');" onmouseout="out('-1677170069465195982');" style=""><abbr title="  94          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheType())){">  94          if(sideTableInfo.getCacheType() == null || ECacheType.NONE.name().equalsIgnoreCase(sideTableInfo.getCacheTðŸ”µ</abbr></span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="">  95              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96          }                                                                                                         </span>
<span  style="">  97                                                                                                                    </span>
<span class="2467441542409947824" onmouseenter="enter('2467441542409947824');" onmouseout="out('2467441542409947824');" style="">  98          AbstractSideCache sideCache;                                                                              </span>
<span class="-6372432294137054689" onmouseenter="enter('-6372432294137054689');" onmouseout="out('-6372432294137054689');" style="">  99          if(ECacheType.LRU.name().equalsIgnoreCase(sideTableInfo.getCacheType())){                                 </span>
<span class="6048352496981849451" onmouseenter="enter('6048352496981849451');" onmouseout="out('6048352496981849451');" style=""> 100              sideCache = new LRUSideCache(sideTableInfo);                                                          </span>
<span class="872859354343667954" onmouseenter="enter('872859354343667954');" onmouseout="out('872859354343667954');" style=""> 101              sideInfo.setSideCache(sideCache);                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 102          }else{                                                                                                    </span>
<span class="6631677953508698726" onmouseenter="enter('6631677953508698726');" onmouseout="out('6631677953508698726');" style=""> 103              throw new RuntimeException(&quot;not support side cache with type:&quot; + sideTableInfo.getCacheType());       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104          }                                                                                                         </span>

<span class="-1139260080588451907" onmouseenter="enter('-1139260080588451907');" onmouseout="out('-1139260080588451907');" style=""> 105          sideCache.initCache();                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106      }                                                                                                             </span>
<span  style=""> 107                                                                                                                    </span>
<span class="3806535762016579031" onmouseenter="enter('3806535762016579031');" onmouseout="out('3806535762016579031');" style=""> 108      private void initMetric() {                                                                                   </span>
<span class="8146365026850641885" onmouseenter="enter('8146365026850641885');" onmouseout="out('8146365026850641885');" style=""><abbr title=" 109          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_RECORDS);"> 109          parseErrorRecords = getRuntimeContext().getMetricGroup().counter(MetricConstant.DT_NUM_SIDE_PARSE_ERROR_REðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110      }                                                                                                             </span>
<span  style=""> 111                                                                                                                    </span>











<span class="8092937696842411951" onmouseenter="enter('8092937696842411951');" onmouseout="out('8092937696842411951');" style=""> 112      protected CacheObj getFromCache(String key){                                                                  </span>
<span class="2538020898047265698" onmouseenter="enter('2538020898047265698');" onmouseout="out('2538020898047265698');" style=""> 113          return sideInfo.getSideCache().getFromCache(key);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114      }                                                                                                             </span>
<span  style=""> 115                                                                                                                    </span>
<span class="-4321238960497222272" onmouseenter="enter('-4321238960497222272');" onmouseout="out('-4321238960497222272');" style=""> 116      protected void putCache(String key, CacheObj value){                                                          </span>
<span class="-7659775154828757059" onmouseenter="enter('-7659775154828757059');" onmouseout="out('-7659775154828757059');" style=""> 117          sideInfo.getSideCache().putCache(key, value);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118      }                                                                                                             </span>
<span  style=""> 119                                                                                                                    </span>
<span class="4999887173489248228" onmouseenter="enter('4999887173489248228');" onmouseout="out('4999887173489248228');" style=""> 120      protected boolean openCache(){                                                                                </span>
<span class="-6056706524605706393" onmouseenter="enter('-6056706524605706393');" onmouseout="out('-6056706524605706393');" style=""> 121          return sideInfo.getSideCache() != null;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122      }                                                                                                             </span>
<span  style=""> 123                                                                                                                    </span>
<span class="5722939887786035647" onmouseenter="enter('5722939887786035647');" onmouseout="out('5722939887786035647');" style=""> 124      protected void dealMissKey(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                      </span>

<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 125          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="4691005054327061226" onmouseenter="enter('4691005054327061226');" onmouseout="out('4691005054327061226');" style=""> 126              //Reserved left table data                                                                            </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 127              try {                                                                                                 </span>
<span class="5500326757636101813" onmouseenter="enter('5500326757636101813');" onmouseout="out('5500326757636101813');" style=""> 128                  Row row = fillData(input.row(), null);                                                            </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 129                  resultFuture.complete(Collections.singleton(new CRow(row, input.change())));                      </span>


<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 130              } catch (Exception e) {                                                                               </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 131                  dealFillDataError(input, resultFuture, e);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132              }                                                                                                     </span>
<span class="2918192000430827733" onmouseenter="enter('2918192000430827733');" onmouseout="out('2918192000430827733');" style=""> 133          }else{                                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 134              resultFuture.complete(null);                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136      }                                                                                                             </span>
<span  style=""> 137                                                                                                                    </span>
<span class="8266293131835154854" onmouseenter="enter('8266293131835154854');" onmouseout="out('8266293131835154854');" style=""> 138      protected void dealCacheData(String key, CacheObj missKeyObj) {                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 139          if (openCache()) {                                                                                        </span>
<span class="8704248475102894967" onmouseenter="enter('8704248475102894967');" onmouseout="out('8704248475102894967');" style=""> 140              putCache(key, missKeyObj);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142      }                                                                                                             </span>
<span  style=""> 143                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 144      @Override                                                                                                     </span>
<span class="-4154742635849940165" onmouseenter="enter('-4154742635849940165');" onmouseout="out('-4154742635849940165');" style=""> 145      public void timeout(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                           </span>

<span  style=""> 146                                                                                                                    </span>
<span class="-8785415268794772108" onmouseenter="enter('-8785415268794772108');" onmouseout="out('-8785415268794772108');" style=""> 147          if(timeOutNum % TIMEOUT_LOG_FLUSH_NUM == 0){                                                              </span>
<span class="3574712885854088497" onmouseenter="enter('3574712885854088497');" onmouseout="out('3574712885854088497');" style=""> 148              LOG.info(&quot;Async function call has timed out. input:{}, timeOutNum:{}&quot;,input.toString(), timeOutNum);  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149          }                                                                                                         </span>
<span class="-153001643180004445" onmouseenter="enter('-153001643180004445');" onmouseout="out('-153001643180004445');" style=""> 150          timeOutNum ++;                                                                                            </span>
<span class="-7689775219188827718" onmouseenter="enter('-7689775219188827718');" onmouseout="out('-7689775219188827718');" style=""> 151          if(sideInfo.getJoinType() == JoinType.LEFT){                                                              </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 152              resultFuture.complete(null);                                                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 153              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154          }                                                                                                         </span>
<span class="-1129416388715438602" onmouseenter="enter('-1129416388715438602');" onmouseout="out('-1129416388715438602');" style=""> 155          if(timeOutNum &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){                          </span>
<span class="-8709312937013281153" onmouseenter="enter('-8709312937013281153');" onmouseout="out('-8709312937013281153');" style=""> 156              resultFuture.completeExceptionally(new Exception(&quot;Async function call timedoutNum beyond limit.&quot;));   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 157              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158          }                                                                                                         </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 159          resultFuture.complete(null);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160      }                                                                                                             </span>
<span  style=""> 161                                                                                                                    </span>
<span class="1419183253103506261" onmouseenter="enter('1419183253103506261');" onmouseout="out('1419183253103506261');" style=""> 162      protected void preInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                                        </span>
<span class="-8236927235190360393" onmouseenter="enter('-8236927235190360393');" onmouseout="out('-8236927235190360393');" style=""> 163          ScheduledFuture&lt;?&gt; timeFuture = registerTimer(input, resultFuture);                                       </span>
<span class="6983598620778748672" onmouseenter="enter('6983598620778748672');" onmouseout="out('6983598620778748672');" style=""> 164          cancelTimerWhenComplete(resultFuture, timeFuture);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165      }                                                                                                             </span>
<span  style=""> 166                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 167      @Override                                                                                                     </span>
<span class="1335011072106940162" onmouseenter="enter('1335011072106940162');" onmouseout="out('1335011072106940162');" style=""> 168      public void asyncInvoke(CRow row, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                         </span>
<span class="2006546512082641187" onmouseenter="enter('2006546512082641187');" onmouseout="out('2006546512082641187');" style=""> 169          CRow input = new CRow(Row.copy(row.row()), row.change());                                                 </span>








<span class="-5251270273097721534" onmouseenter="enter('-5251270273097721534');" onmouseout="out('-5251270273097721534');" style=""> 170          preInvoke(input, resultFuture);                                                                           </span>
<span class="3304505190415843966" onmouseenter="enter('3304505190415843966');" onmouseout="out('3304505190415843966');" style=""> 171          Map&lt;String, Object&gt; inputParams = parseInputParam(input);                                                 </span>
<span class="-8986700609000248410" onmouseenter="enter('-8986700609000248410');" onmouseout="out('-8986700609000248410');" style=""> 172          if(MapUtils.isEmpty(inputParams)){                                                                        </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 173              dealMissKey(input, resultFuture);                                                                     </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 174              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175          }                                                                                                         </span>
<span class="7601971720076147769" onmouseenter="enter('7601971720076147769');" onmouseout="out('7601971720076147769');" style=""> 176          if(isUseCache(inputParams)){                                                                              </span>
<span class="1305486694099938882" onmouseenter="enter('1305486694099938882');" onmouseout="out('1305486694099938882');" style=""> 177              invokeWithCache(inputParams, input, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 178              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="-1915829701430082747" onmouseenter="enter('-1915829701430082747');" onmouseout="out('-1915829701430082747');" style=""> 180          handleAsyncInvoke(inputParams, input, resultFuture);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span class="-4658349935624557210" onmouseenter="enter('-4658349935624557210');" onmouseout="out('-4658349935624557210');" style=""> 183      private Map&lt;String, Object&gt; parseInputParam(CRow input){                                                      </span>

<span class="-8948763322070603511" onmouseenter="enter('-8948763322070603511');" onmouseout="out('-8948763322070603511');" style=""> 184          Map&lt;String, Object&gt; inputParams = Maps.newHashMap();                                                      </span>
<span class="1653020944744444363" onmouseenter="enter('1653020944744444363');" onmouseout="out('1653020944744444363');" style=""> 185          for (int i = 0; i &lt; sideInfo.getEqualValIndex().size(); i++) {                                            </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 186              Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-1571322702847153161" onmouseenter="enter('-1571322702847153161');" onmouseout="out('-1571322702847153161');" style=""> 187              Object equalObj = input.row().getField(conValIndex);                                                  </span>

<span class="-2472065522678882095" onmouseenter="enter('-2472065522678882095');" onmouseout="out('-2472065522678882095');" style=""> 188              if(equalObj == null){                                                                                 </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 189                  return inputParams;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190              }                                                                                                     </span>
<span class="-1936266470406934309" onmouseenter="enter('-1936266470406934309');" onmouseout="out('-1936266470406934309');" style=""> 191              String columnName = sideInfo.getEqualFieldList().get(i);                                              </span>
<span class="-2746365826745363676" onmouseenter="enter('-2746365826745363676');" onmouseout="out('-2746365826745363676');" style=""> 192              inputParams.put(columnName, equalObj);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193          }                                                                                                         </span>
<span class="-7168021780725546763" onmouseenter="enter('-7168021780725546763');" onmouseout="out('-7168021780725546763');" style=""> 194          return inputParams;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-8317585720111034848" onmouseenter="enter('-8317585720111034848');" onmouseout="out('-8317585720111034848');" style=""> 197      protected boolean isUseCache(Map&lt;String, Object&gt; inputParams){                                                </span>
<span class="6175609468139869947" onmouseenter="enter('6175609468139869947');" onmouseout="out('6175609468139869947');" style=""> 198          return openCache() &amp;&amp; getFromCache(buildCacheKey(inputParams)) != null;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199      }                                                                                                             </span>
<span  style=""> 200                                                                                                                    </span>
<span class="7995643958719871800" onmouseenter="enter('7995643958719871800');" onmouseout="out('7995643958719871800');" style=""> 201      private void invokeWithCache(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture){   </span>

<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 202          if (openCache()) {                                                                                        </span>
<span class="1442313916895893389" onmouseenter="enter('1442313916895893389');" onmouseout="out('1442313916895893389');" style=""> 203              CacheObj val = getFromCache(buildCacheKey(inputParams));                                              </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 204              if (val != null) {                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 205                  if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 206                      dealMissKey(input, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 207                      return;                                                                                       </span>
<span class="-2707830144731055547" onmouseenter="enter('-2707830144731055547');" onmouseout="out('-2707830144731055547');" style=""> 208                  }else if(ECacheContentType.SingleLine == val.getType()){                                          </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 209                      try {                                                                                         </span>
<span class="-8169914018722925403" onmouseenter="enter('-8169914018722925403');" onmouseout="out('-8169914018722925403');" style=""> 210                          Row row = fillData(input.row(), val.getContent());                                        </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 211                          resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>


<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 212                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 213                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214                      }                                                                                             </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 215                  } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 216                      try {                                                                                         </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 217                          List&lt;CRow&gt; rowList = Lists.newArrayList();                                                </span>

<span class="8785339114031821832" onmouseenter="enter('8785339114031821832');" onmouseout="out('8785339114031821832');" style=""> 218                          for (Object one : (List) val.getContent()) {                                              </span>
<span class="3678643963763019432" onmouseenter="enter('3678643963763019432');" onmouseout="out('3678643963763019432');" style=""> 219                              Row row = fillData(input.row(), one);                                                 </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 220                              rowList.add(new CRow(row, input.change()));                                           </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221                          }                                                                                         </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 222                          resultFuture.complete(rowList);                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 223                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 224                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 226                  } else {                                                                                          </span>
<span class="-9148605712470689730" onmouseenter="enter('-9148605712470689730');" onmouseout="out('-9148605712470689730');" style=""><abbr title=" 227                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.getType()));"> 227                      resultFuture.completeExceptionally(new RuntimeException(&quot;not support cache obj type &quot; + val.geðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 229                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 232      }                                                                                                             </span>
<span  style=""> 233                                                                                                                    </span>
<span class="-4517218295788622251" onmouseenter="enter('-4517218295788622251');" onmouseout="out('-4517218295788622251');" style=""><abbr title=" 234      public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception;"> 234      public abstract void handleAsyncInvoke(Map&lt;String, Object&gt;  inputParams, CRow input, ResultFuture&lt;CRow&gt; resultðŸ”µ</abbr></span>

<span  style=""> 235                                                                                                                    </span>
<span class="-1864151247272784464" onmouseenter="enter('-1864151247272784464');" onmouseout="out('-1864151247272784464');" style=""> 236      public abstract String buildCacheKey(Map&lt;String, Object&gt; inputParams);                                        </span>
<span  style=""> 237                                                                                                                    </span>
<span class="-4808731258623672477" onmouseenter="enter('-4808731258623672477');" onmouseout="out('-4808731258623672477');" style=""> 238      private ProcessingTimeService getProcessingTimeService(){                                                     </span>
<span class="2711243129708487656" onmouseenter="enter('2711243129708487656');" onmouseout="out('2711243129708487656');" style=""> 239          return ((StreamingRuntimeContext)this.runtimeContext).getProcessingTimeService();                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240      }                                                                                                             </span>
<span  style=""> 241                                                                                                                    </span>
<span class="7656264997648430753" onmouseenter="enter('7656264997648430753');" onmouseout="out('7656264997648430753');" style=""> 242      protected ScheduledFuture&lt;?&gt; registerTimer(CRow input, ResultFuture&lt;CRow&gt; resultFuture){                      </span>

<span class="934792473187718520" onmouseenter="enter('934792473187718520');" onmouseout="out('934792473187718520');" style=""><abbr title=" 243          long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrentProcessingTime();"> 243          long timeoutTimestamp = sideInfo.getSideTableInfo().getAsyncTimeout() + getProcessingTimeService().getCurrðŸ”µ</abbr></span>
<span class="-7770190625068861726" onmouseenter="enter('-7770190625068861726');" onmouseout="out('-7770190625068861726');" style=""> 244          return getProcessingTimeService().registerTimer(                                                          </span>
<span class="71077619232504594" onmouseenter="enter('71077619232504594');" onmouseout="out('71077619232504594');" style=""> 245                  timeoutTimestamp,                                                                                 </span>
<span class="-4515551418804696437" onmouseenter="enter('-4515551418804696437');" onmouseout="out('-4515551418804696437');" style=""> 246                  new ProcessingTimeCallback() {                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 247                      @Override                                                                                     </span>
<span class="4599848324577178940" onmouseenter="enter('4599848324577178940');" onmouseout="out('4599848324577178940');" style=""> 248                      public void onProcessingTime(long timestamp) throws Exception {                               </span>
<span class="-2455479749936117412" onmouseenter="enter('-2455479749936117412');" onmouseout="out('-2455479749936117412');" style=""> 249                          timeout(input, resultFuture);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 251                  });                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252      }                                                                                                             </span>
<span  style=""> 253                                                                                                                    </span>
<span class="2068928835095274142" onmouseenter="enter('2068928835095274142');" onmouseout="out('2068928835095274142');" style=""> 254      protected void cancelTimerWhenComplete(ResultFuture&lt;CRow&gt; resultFuture, ScheduledFuture&lt;?&gt; timerFuture){      </span>
<span class="-6043523922313575030" onmouseenter="enter('-6043523922313575030');" onmouseout="out('-6043523922313575030');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 255 -        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());"> 255 -        ThreadPoolExecutor executors = new ThreadPoolExecutor(1, 1,0L, TimeUnit.MILLISECONDS, new LinkedBlockingQuðŸ”µ</abbr></span>
<span class="6765710556046387891" onmouseenter="enter('6765710556046387891');" onmouseout="out('6765710556046387891');" style=""> 256          if(resultFuture instanceof StreamRecordQueueEntry){                                                       </span>
<span class="4742065774346819209" onmouseenter="enter('4742065774346819209');" onmouseout="out('4742065774346819209');" style=""> 257              StreamRecordQueueEntry streamRecordBufferEntry = (StreamRecordQueueEntry) resultFuture;               </span>
<span class="-2412956686348112725" onmouseenter="enter('-2412956686348112725');" onmouseout="out('-2412956686348112725');" style=""> 258              streamRecordBufferEntry.onComplete((Object value) -&gt; {                                                </span>
<span class="6463947537571799549" onmouseenter="enter('6463947537571799549');" onmouseout="out('6463947537571799549');" style=""> 259                  timerFuture.cancel(true);                                                                         </span>
<span class="-6998245280247289292" onmouseenter="enter('-6998245280247289292');" onmouseout="out('-6998245280247289292');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -            },executors);                                                                                         </span>
<span class="1131192414662341470" onmouseenter="enter('1131192414662341470');" onmouseout="out('1131192414662341470');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 261 +            }, cancelExecutor);                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263      }                                                                                                             </span>
<span  style=""> 264                                                                                                                    </span>
<span class="7832967143592441905" onmouseenter="enter('7832967143592441905');" onmouseout="out('7832967143592441905');" style=""> 265      protected void dealFillDataError(CRow input, ResultFuture&lt;CRow&gt; resultFuture, Throwable e) {                  </span>










<span class="-3162798492239337665" onmouseenter="enter('-3162798492239337665');" onmouseout="out('-3162798492239337665');" style=""> 266          parseErrorRecords.inc();                                                                                  </span>
<span class="4161313512666780706" onmouseenter="enter('4161313512666780706');" onmouseout="out('4161313512666780706');" style=""> 267          if(parseErrorRecords.getCount() &gt; sideInfo.getSideTableInfo().getAsyncFailMaxNum(Long.MAX_VALUE)){        </span>
<span class="-6335036338802812137" onmouseenter="enter('-6335036338802812137');" onmouseout="out('-6335036338802812137');" style=""> 268              LOG.info(&quot;dealFillDataError&quot;, e);                                                                     </span>
<span class="-6672795514670622393" onmouseenter="enter('-6672795514670622393');" onmouseout="out('-6672795514670622393');" style=""> 269              resultFuture.completeExceptionally(e);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 270          } else {                                                                                                  </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 271              dealMissKey(input, resultFuture);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273      }                                                                                                             </span>
<span  style=""> 274                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 275      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 276      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 277          super.close();                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            