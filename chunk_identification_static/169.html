<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>169</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    169
                    <a href="168.html">prev</a>
                    <a href="170.html">next</a>
                    <a href="169_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    CyanogenMod/android_packages_apps_Trebuchet_42d88768c528d0101b78426ba7bb82043576b15c_WallpaperPicker/src/com/android/gallery3d/common/BitmapUtils.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;42d88768c528d0101b78426ba7bb82043576b15c:WallpaperPicker/src/com/android/gallery3d/common/BitmapUtils.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;42d88768c528d0101b78426ba7bb82043576b15c^1:WallpaperPicker/src/com/android/gallery3d/common/BitmapUtils.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;42d88768c528d0101b78426ba7bb82043576b15c^2:WallpaperPicker/src/com/android/gallery3d/common/BitmapUtils.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\CyanogenMod\android_packages_apps_Trebuchet show &quot;249a510ab318db461ce1ac86baca01021fe41a2c:WallpaperPicker/src/com/android/gallery3d/common/BitmapUtils.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [j], [j]], subset: [[b], [bj], [b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="304880958838077089" onmouseenter="enter('304880958838077089');" onmouseout="out('304880958838077089');" style="">   2  * Copyright (C) 2010 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="-7465891333569825926" onmouseenter="enter('-7465891333569825926');" onmouseout="out('-7465891333569825926');" style="">  17 package com.android.gallery3d.common;                                                                    </span>
<span  style="">  18                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  19 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  20 import android.content.Context;                                                                          </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  21 import android.content.res.Resources;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  22 import android.net.Uri;                                                                                  </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  23 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-6379310173182770238" onmouseenter="enter('-6379310173182770238');" onmouseout="out('-6379310173182770238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  24 import android.graphics.Bitmap;                                                                          </span>
<span class="-9304522635682456" onmouseenter="enter('-9304522635682456');" onmouseout="out('-9304522635682456');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  25 import android.graphics.Bitmap.CompressFormat;                                                           </span>
<span class="-3019416561807484959" onmouseenter="enter('-3019416561807484959');" onmouseout="out('-3019416561807484959');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  26 import android.graphics.BitmapFactory;                                                                   </span>
<span class="-6358617885644310547" onmouseenter="enter('-6358617885644310547');" onmouseout="out('-6358617885644310547');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  27 import android.graphics.Canvas;                                                                          </span>
<span class="-2838211797420958568" onmouseenter="enter('-2838211797420958568');" onmouseout="out('-2838211797420958568');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  28 import android.graphics.Matrix;                                                                          </span>
<span class="-1586527322890291073" onmouseenter="enter('-1586527322890291073');" onmouseout="out('-1586527322890291073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  29 import android.graphics.Paint;                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  30 import android.os.Build;                                                                                 </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  31 =======                                                                                                  </span>
<span class="-6379310173182770238" onmouseenter="enter('-6379310173182770238');" onmouseout="out('-6379310173182770238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  32 import android.graphics.Bitmap;                                                                          </span>
<span class="-9304522635682456" onmouseenter="enter('-9304522635682456');" onmouseout="out('-9304522635682456');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  33 import android.graphics.Bitmap.CompressFormat;                                                           </span>
<span class="-3019416561807484959" onmouseenter="enter('-3019416561807484959');" onmouseout="out('-3019416561807484959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  34 import android.graphics.BitmapFactory;                                                                   </span>
<span class="-6358617885644310547" onmouseenter="enter('-6358617885644310547');" onmouseout="out('-6358617885644310547');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  35 import android.graphics.Canvas;                                                                          </span>
<span class="-2838211797420958568" onmouseenter="enter('-2838211797420958568');" onmouseout="out('-2838211797420958568');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  36 import android.graphics.Matrix;                                                                          </span>
<span class="-1586527322890291073" onmouseenter="enter('-1586527322890291073');" onmouseout="out('-1586527322890291073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  37 import android.graphics.Paint;                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  38 import android.os.Build;                                                                                 </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  39 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  40 import android.util.Log;                                                                                 </span>
<span  style="">  41                                                                                                          </span>
<span class="-1437136200372934815" onmouseenter="enter('-1437136200372934815');" onmouseout="out('-1437136200372934815');" style="">  42 import com.android.gallery3d.exif.ExifInterface;                                                         </span>
<span  style="">  43                                                                                                          </span>
<span class="-8084092933789958161" onmouseenter="enter('-8084092933789958161');" onmouseout="out('-8084092933789958161');" style="">  44 import java.io.BufferedInputStream;                                                                      </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  45 import java.io.IOException;                                                                              </span>
<span class="5631563232245871054" onmouseenter="enter('5631563232245871054');" onmouseout="out('5631563232245871054');" style="">  46 import java.io.InputStream;                                                                              </span>
<span  style="">  47                                                                                                          </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="">  48 public class BitmapUtils {                                                                               </span>
<span  style="">  49                                                                                                          </span>
<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="">  50     private static final String TAG = &quot;BitmapUtils&quot;;                                                     </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  51 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  52 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 public class BitmapUtils {                                                                               </span>
<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54     private static final String TAG = &quot;BitmapUtils&quot;;                                                     </span>
<span class="-8920313646798206541" onmouseenter="enter('-8920313646798206541');" onmouseout="out('-8920313646798206541');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55     private static final int DEFAULT_JPEG_QUALITY = 90;                                                  </span>
<span class="5925394665829483069" onmouseenter="enter('5925394665829483069');" onmouseout="out('5925394665829483069');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56     public static final int UNCONSTRAINED = -1;                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57                                                                                                          </span>
<span class="-7097481959834704461" onmouseenter="enter('-7097481959834704461');" onmouseout="out('-7097481959834704461');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58     private BitmapUtils(){}                                                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60     /*                                                                                                   </span>
<span class="1270168804143702943" onmouseenter="enter('1270168804143702943');" onmouseout="out('1270168804143702943');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61      * Compute the sample size as a function of minSideLength                                            </span>
<span class="5897256147978488688" onmouseenter="enter('5897256147978488688');" onmouseout="out('5897256147978488688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  62      * and maxNumOfPixels.                                                                               </span>
<span class="7072685536632461207" onmouseenter="enter('7072685536632461207');" onmouseout="out('7072685536632461207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  63      * minSideLength is used to specify that minimal width or height of a                                </span>
<span class="-3488479511976114383" onmouseenter="enter('-3488479511976114383');" onmouseout="out('-3488479511976114383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  64      * bitmap.                                                                                           </span>
<span class="161810603246613551" onmouseenter="enter('161810603246613551');" onmouseout="out('161810603246613551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  65      * maxNumOfPixels is used to specify the maximal size in pixels that is                              </span>
<span class="-4125933736109438763" onmouseenter="enter('-4125933736109438763');" onmouseout="out('-4125933736109438763');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  66      * tolerable in terms of memory usage.                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  67      *                                                                                                   </span>
<span class="-7061869334355419504" onmouseenter="enter('-7061869334355419504');" onmouseout="out('-7061869334355419504');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  68      * The function returns a sample size based on the constraints.                                      </span>
<span class="-7809175981849985557" onmouseenter="enter('-7809175981849985557');" onmouseout="out('-7809175981849985557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  69      * Both size and minSideLength can be passed in as UNCONSTRAINED,                                    </span>
<span class="-236506778142513186" onmouseenter="enter('-236506778142513186');" onmouseout="out('-236506778142513186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  70      * which indicates no care of the corresponding constraint.                                          </span>
<span class="-5130444168296571105" onmouseenter="enter('-5130444168296571105');" onmouseout="out('-5130444168296571105');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  71      * The functions prefers returning a sample size that                                                </span>
<span class="3970471092235412508" onmouseenter="enter('3970471092235412508');" onmouseout="out('3970471092235412508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  72      * generates a smaller bitmap, unless minSideLength = UNCONSTRAINED.                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  73      *                                                                                                   </span>
<span class="-2461183840707974014" onmouseenter="enter('-2461183840707974014');" onmouseout="out('-2461183840707974014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  74      * Also, the function rounds up the sample size to a power of 2 or multiple                          </span>
<span class="5388524243881858316" onmouseenter="enter('5388524243881858316');" onmouseout="out('5388524243881858316');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  75      * of 8 because BitmapFactory only honors sample size this way.                                      </span>
<span class="8154515727460110981" onmouseenter="enter('8154515727460110981');" onmouseout="out('8154515727460110981');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  76      * For example, BitmapFactory downsamples an image by 2 even though the                              </span>
<span class="-1699546258266074539" onmouseenter="enter('-1699546258266074539');" onmouseout="out('-1699546258266074539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  77      * request is 3. So we round up the sample size to avoid OOM.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  78      */                                                                                                  </span>
<span class="-6005902021650859259" onmouseenter="enter('-6005902021650859259');" onmouseout="out('-6005902021650859259');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  79     public static int computeSampleSize(int width, int height,                                           </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  80             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="-7592907632500137939" onmouseenter="enter('-7592907632500137939');" onmouseout="out('-7592907632500137939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  81         int initialSize = computeInitialSampleSize(                                                      </span>
<span class="-551502584830884140" onmouseenter="enter('-551502584830884140');" onmouseout="out('-551502584830884140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  82                 width, height, minSideLength, maxNumOfPixels);                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  83                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  84         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  85                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  86                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  87     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  88                                                                                                          </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  89     private static int computeInitialSampleSize(int w, int h,                                            </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  90             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  91         if (maxNumOfPixels == UNCONSTRAINED                                                              </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  92                 &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  93                                                                                                          </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  94         int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                         </span>
<span class="7740670432774910968" onmouseenter="enter('7740670432774910968');" onmouseout="out('7740670432774910968');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  95                 (int) FloatMath.ceil(FloatMath.sqrt((float) (w * h) / maxNumOfPixels));                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  96                                                                                                          </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  97         if (minSideLength == UNCONSTRAINED) {                                                            </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  98             return lowerBound;                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  99         } else {                                                                                         </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 100             int sampleSize = Math.min(w / minSideLength, h / minSideLength);                             </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 101             return Math.max(sampleSize, lowerBound);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 102         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 103     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 104                                                                                                          </span>
<span class="1227185696257393805" onmouseenter="enter('1227185696257393805');" onmouseout="out('1227185696257393805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 105     // This computes a sample size which makes the longer side at least                                  </span>
<span class="2751286357656229784" onmouseenter="enter('2751286357656229784');" onmouseout="out('2751286357656229784');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 106     // minSideLength long. If that&#x27;s not possible, return 1.                                             </span>
<span class="-601503493775244190" onmouseenter="enter('-601503493775244190');" onmouseout="out('-601503493775244190');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 107     public static int computeSampleSizeLarger(int w, int h,                                              </span>
<span class="-6821687715082164263" onmouseenter="enter('-6821687715082164263');" onmouseout="out('-6821687715082164263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 108             int minSideLength) {                                                                         </span>
<span class="-2047337129560331180" onmouseenter="enter('-2047337129560331180');" onmouseout="out('-2047337129560331180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 109         int initialSize = Math.max(w / minSideLength, h / minSideLength);                                </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 110         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 111                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 112         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 113                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 114                 : initialSize / 8 * 8;                                                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 115 =======                                                                                                  </span>
<span class="-8920313646798206541" onmouseenter="enter('-8920313646798206541');" onmouseout="out('-8920313646798206541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116     private static final int DEFAULT_JPEG_QUALITY = 90;                                                  </span>
<span class="5925394665829483069" onmouseenter="enter('5925394665829483069');" onmouseout="out('5925394665829483069');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117     public static final int UNCONSTRAINED = -1;                                                          </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 118                                                                                                          </span>
<span class="-7097481959834704461" onmouseenter="enter('-7097481959834704461');" onmouseout="out('-7097481959834704461');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 119     private BitmapUtils(){}                                                                              </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120                                                                                                          </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121     /*                                                                                                   </span>
<span class="1270168804143702943" onmouseenter="enter('1270168804143702943');" onmouseout="out('1270168804143702943');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122      * Compute the sample size as a function of minSideLength                                            </span>
<span class="5897256147978488688" onmouseenter="enter('5897256147978488688');" onmouseout="out('5897256147978488688');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 123      * and maxNumOfPixels.                                                                               </span>
<span class="7072685536632461207" onmouseenter="enter('7072685536632461207');" onmouseout="out('7072685536632461207');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124      * minSideLength is used to specify that minimal width or height of a                                </span>
<span class="-3488479511976114383" onmouseenter="enter('-3488479511976114383');" onmouseout="out('-3488479511976114383');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 125      * bitmap.                                                                                           </span>
<span class="161810603246613551" onmouseenter="enter('161810603246613551');" onmouseout="out('161810603246613551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126      * maxNumOfPixels is used to specify the maximal size in pixels that is                              </span>
<span class="-4125933736109438763" onmouseenter="enter('-4125933736109438763');" onmouseout="out('-4125933736109438763');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127      * tolerable in terms of memory usage.                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128      *                                                                                                   </span>
<span class="-7061869334355419504" onmouseenter="enter('-7061869334355419504');" onmouseout="out('-7061869334355419504');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129      * The function returns a sample size based on the constraints.                                      </span>
<span class="-7809175981849985557" onmouseenter="enter('-7809175981849985557');" onmouseout="out('-7809175981849985557');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130      * Both size and minSideLength can be passed in as UNCONSTRAINED,                                    </span>
<span class="-236506778142513186" onmouseenter="enter('-236506778142513186');" onmouseout="out('-236506778142513186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131      * which indicates no care of the corresponding constraint.                                          </span>
<span class="-5130444168296571105" onmouseenter="enter('-5130444168296571105');" onmouseout="out('-5130444168296571105');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132      * The functions prefers returning a sample size that                                                </span>
<span class="3970471092235412508" onmouseenter="enter('3970471092235412508');" onmouseout="out('3970471092235412508');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 133      * generates a smaller bitmap, unless minSideLength = UNCONSTRAINED.                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 134      *                                                                                                   </span>
<span class="-2461183840707974014" onmouseenter="enter('-2461183840707974014');" onmouseout="out('-2461183840707974014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135      * Also, the function rounds up the sample size to a power of 2 or multiple                          </span>
<span class="5388524243881858316" onmouseenter="enter('5388524243881858316');" onmouseout="out('5388524243881858316');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136      * of 8 because BitmapFactory only honors sample size this way.                                      </span>
<span class="8154515727460110981" onmouseenter="enter('8154515727460110981');" onmouseout="out('8154515727460110981');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137      * For example, BitmapFactory downsamples an image by 2 even though the                              </span>
<span class="-1699546258266074539" onmouseenter="enter('-1699546258266074539');" onmouseout="out('-1699546258266074539');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138      * request is 3. So we round up the sample size to avoid OOM.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139      */                                                                                                  </span>
<span class="-6005902021650859259" onmouseenter="enter('-6005902021650859259');" onmouseout="out('-6005902021650859259');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 140     public static int computeSampleSize(int width, int height,                                           </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 141             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="-7592907632500137939" onmouseenter="enter('-7592907632500137939');" onmouseout="out('-7592907632500137939');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 142         int initialSize = computeInitialSampleSize(                                                      </span>
<span class="-551502584830884140" onmouseenter="enter('-551502584830884140');" onmouseout="out('-551502584830884140');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 143                 width, height, minSideLength, maxNumOfPixels);                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 144                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 145         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 146                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 147                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 148     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 149                                                                                                          </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 150     private static int computeInitialSampleSize(int w, int h,                                            </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 151             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 152         if (maxNumOfPixels == UNCONSTRAINED                                                              </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                 &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                                                                                                          </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155         int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                         </span>
<span class="5369073419942975310" onmouseenter="enter('5369073419942975310');" onmouseout="out('5369073419942975310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                 (int) Math.ceil(Math.sqrt((float) (w * h) / maxNumOfPixels));                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 157                                                                                                          </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 158         if (minSideLength == UNCONSTRAINED) {                                                            </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 159             return lowerBound;                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 160         } else {                                                                                         </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 161             int sampleSize = Math.min(w / minSideLength, h / minSideLength);                             </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 162             return Math.max(sampleSize, lowerBound);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 163         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 164     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 165                                                                                                          </span>
<span class="1227185696257393805" onmouseenter="enter('1227185696257393805');" onmouseout="out('1227185696257393805');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 166     // This computes a sample size which makes the longer side at least                                  </span>
<span class="2751286357656229784" onmouseenter="enter('2751286357656229784');" onmouseout="out('2751286357656229784');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 167     // minSideLength long. If that&#x27;s not possible, return 1.                                             </span>
<span class="-601503493775244190" onmouseenter="enter('-601503493775244190');" onmouseout="out('-601503493775244190');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 168     public static int computeSampleSizeLarger(int w, int h,                                              </span>
<span class="-6821687715082164263" onmouseenter="enter('-6821687715082164263');" onmouseout="out('-6821687715082164263');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 169             int minSideLength) {                                                                         </span>
<span class="-2047337129560331180" onmouseenter="enter('-2047337129560331180');" onmouseout="out('-2047337129560331180');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 170         int initialSize = Math.max(w / minSideLength, h / minSideLength);                                </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 171         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 172                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 173         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 174                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 175                 : initialSize / 8 * 8;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 176     }                                                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 177 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 178                                                                                                          </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style=""> 179     // Find the min x that 1 / x &gt;= scale                                                                </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style=""> 180     public static int computeSampleSizeLarger(float scale) {                                             </span>
<span class="883892556015604724" onmouseenter="enter('883892556015604724');" onmouseout="out('883892556015604724');" style=""> 181         int initialSize = (int) Math.floor(1f / scale);                                                  </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style=""> 182         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style=""> 183                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style=""> 184         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style=""> 185                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style=""> 186                 : initialSize / 8 * 8;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187     }                                                                                                    </span>
<span  style=""> 188                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 189 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="863927649079425496" onmouseenter="enter('863927649079425496');" onmouseout="out('863927649079425496');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 190     public static int getRotationFromExif(Context context, Uri uri) {                                    </span>
<span class="-1829376402373340167" onmouseenter="enter('-1829376402373340167');" onmouseout="out('-1829376402373340167');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 191         return BitmapUtils.getRotationFromExifHelper(null, 0, context, uri);                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 192 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3488479511976114383" onmouseenter="enter('-3488479511976114383');" onmouseout="out('-3488479511976114383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193      * bitmap.                                                                                           </span>
<span class="161810603246613551" onmouseenter="enter('161810603246613551');" onmouseout="out('161810603246613551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194      * maxNumOfPixels is used to specify the maximal size in pixels that is                              </span>
<span class="-4125933736109438763" onmouseenter="enter('-4125933736109438763');" onmouseout="out('-4125933736109438763');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195      * tolerable in terms of memory usage.                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196      *                                                                                                   </span>
<span class="-7061869334355419504" onmouseenter="enter('-7061869334355419504');" onmouseout="out('-7061869334355419504');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197      * The function returns a sample size based on the constraints.                                      </span>
<span class="-7809175981849985557" onmouseenter="enter('-7809175981849985557');" onmouseout="out('-7809175981849985557');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198      * Both size and minSideLength can be passed in as UNCONSTRAINED,                                    </span>
<span class="-236506778142513186" onmouseenter="enter('-236506778142513186');" onmouseout="out('-236506778142513186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199      * which indicates no care of the corresponding constraint.                                          </span>
<span class="-5130444168296571105" onmouseenter="enter('-5130444168296571105');" onmouseout="out('-5130444168296571105');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200      * The functions prefers returning a sample size that                                                </span>
<span class="3970471092235412508" onmouseenter="enter('3970471092235412508');" onmouseout="out('3970471092235412508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201      * generates a smaller bitmap, unless minSideLength = UNCONSTRAINED.                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202      *                                                                                                   </span>
<span class="-2461183840707974014" onmouseenter="enter('-2461183840707974014');" onmouseout="out('-2461183840707974014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203      * Also, the function rounds up the sample size to a power of 2 or multiple                          </span>
<span class="5388524243881858316" onmouseenter="enter('5388524243881858316');" onmouseout="out('5388524243881858316');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204      * of 8 because BitmapFactory only honors sample size this way.                                      </span>
<span class="8154515727460110981" onmouseenter="enter('8154515727460110981');" onmouseout="out('8154515727460110981');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205      * For example, BitmapFactory downsamples an image by 2 even though the                              </span>
<span class="-1699546258266074539" onmouseenter="enter('-1699546258266074539');" onmouseout="out('-1699546258266074539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206      * request is 3. So we round up the sample size to avoid OOM.                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207      */                                                                                                  </span>
<span class="-6005902021650859259" onmouseenter="enter('-6005902021650859259');" onmouseout="out('-6005902021650859259');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208     public static int computeSampleSize(int width, int height,                                           </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="-7592907632500137939" onmouseenter="enter('-7592907632500137939');" onmouseout="out('-7592907632500137939');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210         int initialSize = computeInitialSampleSize(                                                      </span>
<span class="-551502584830884140" onmouseenter="enter('-551502584830884140');" onmouseout="out('-551502584830884140');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                 width, height, minSideLength, maxNumOfPixels);                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217                                                                                                          </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218     private static int computeInitialSampleSize(int w, int h,                                            </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220         if (maxNumOfPixels == UNCONSTRAINED                                                              </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221                 &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222                                                                                                          </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 223         int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                         </span>
<span class="7740670432774910968" onmouseenter="enter('7740670432774910968');" onmouseout="out('7740670432774910968');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 224                 (int) FloatMath.ceil(FloatMath.sqrt((float) (w * h) / maxNumOfPixels));                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 225                                                                                                          </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 226         if (minSideLength == UNCONSTRAINED) {                                                            </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 227             return lowerBound;                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 228         } else {                                                                                         </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 229             int sampleSize = Math.min(w / minSideLength, h / minSideLength);                             </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 230             return Math.max(sampleSize, lowerBound);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 231         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 232     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 233                                                                                                          </span>
<span class="1227185696257393805" onmouseenter="enter('1227185696257393805');" onmouseout="out('1227185696257393805');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 234     // This computes a sample size which makes the longer side at least                                  </span>
<span class="2751286357656229784" onmouseenter="enter('2751286357656229784');" onmouseout="out('2751286357656229784');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 235     // minSideLength long. If that&#x27;s not possible, return 1.                                             </span>
<span class="-601503493775244190" onmouseenter="enter('-601503493775244190');" onmouseout="out('-601503493775244190');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 236     public static int computeSampleSizeLarger(int w, int h,                                              </span>
<span class="-6821687715082164263" onmouseenter="enter('-6821687715082164263');" onmouseout="out('-6821687715082164263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 237             int minSideLength) {                                                                         </span>
<span class="-2047337129560331180" onmouseenter="enter('-2047337129560331180');" onmouseout="out('-2047337129560331180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 238         int initialSize = Math.max(w / minSideLength, h / minSideLength);                                </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 239         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 240                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 241         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 242                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 243                 : initialSize / 8 * 8;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 244     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245                                                                                                          </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246     // Find the min x that 1 / x &gt;= scale                                                                </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247     public static int computeSampleSizeLarger(float scale) {                                             </span>
<span class="2577377926519885209" onmouseenter="enter('2577377926519885209');" onmouseout="out('2577377926519885209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248         int initialSize = (int) FloatMath.floor(1f / scale);                                             </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253                 : initialSize / 8 * 8;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255                                                                                                          </span>
<span class="-6681098284378983876" onmouseenter="enter('-6681098284378983876');" onmouseout="out('-6681098284378983876');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256     // Find the max x that 1 / x &lt;= scale.                                                               </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257     public static int computeSampleSize(float scale) {                                                   </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258         Utils.assertTrue(scale &gt; 0);                                                                     </span>
<span class="-8752772725969860209" onmouseenter="enter('-8752772725969860209');" onmouseout="out('-8752772725969860209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259         int initialSize = Math.max(1, (int) FloatMath.ceil(1 / scale));                                  </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 262 =======                                                                                                  </span>
<span class="-6681098284378983876" onmouseenter="enter('-6681098284378983876');" onmouseout="out('-6681098284378983876');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 263     // Find the max x that 1 / x &lt;= scale.                                                               </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 264     public static int computeSampleSize(float scale) {                                                   </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 265         Utils.assertTrue(scale &gt; 0);                                                                     </span>
<span class="1387480855759456316" onmouseenter="enter('1387480855759456316');" onmouseout="out('1387480855759456316');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 266         int initialSize = Math.max(1, (int) Math.ceil(1 / scale));                                       </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 267         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 268                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 269                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 270 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="-8294240942762904550" onmouseenter="enter('-8294240942762904550');" onmouseout="out('-8294240942762904550');" style=""> 273     public static int getRotationFromExif(Resources res, int resId) {                                    </span>
<span class="5620893307345032967" onmouseenter="enter('5620893307345032967');" onmouseout="out('5620893307345032967');" style=""> 274         return BitmapUtils.getRotationFromExifHelper(res, resId, null, null);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275     }                                                                                                    </span>
<span  style=""> 276                                                                                                          </span>
<span class="5411585031145886947" onmouseenter="enter('5411585031145886947');" onmouseout="out('5411585031145886947');" style=""> 277     private static int getRotationFromExifHelper(Resources res, int resId, Context context, Uri uri) {   </span>
<span class="-8257955723818790927" onmouseenter="enter('-8257955723818790927');" onmouseout="out('-8257955723818790927');" style=""> 278         ExifInterface ei = new ExifInterface();                                                          </span>
<span class="7188824888882858175" onmouseenter="enter('7188824888882858175');" onmouseout="out('7188824888882858175');" style=""> 279         InputStream is = null;                                                                           </span>
<span class="-6897335633928745070" onmouseenter="enter('-6897335633928745070');" onmouseout="out('-6897335633928745070');" style=""> 280         BufferedInputStream bis = null;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 281         try {                                                                                            </span>
<span class="-6789028041247471756" onmouseenter="enter('-6789028041247471756');" onmouseout="out('-6789028041247471756');" style=""> 282             if (uri != null) {                                                                           </span>
<span class="7106114135868158194" onmouseenter="enter('7106114135868158194');" onmouseout="out('7106114135868158194');" style=""> 283                 is = context.getContentResolver().openInputStream(uri);                                  </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style=""> 284                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style=""> 285                 ei.readExif(bis);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 286             } else {                                                                                     </span>
<span class="5390757631558727338" onmouseenter="enter('5390757631558727338');" onmouseout="out('5390757631558727338');" style=""> 287                 is = res.openRawResource(resId);                                                         </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style=""> 288                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style=""> 289                 ei.readExif(bis);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290             }                                                                                            </span>
<span class="5371837386944258962" onmouseenter="enter('5371837386944258962');" onmouseout="out('5371837386944258962');" style=""> 291             Integer ori = ei.getTagIntValue(ExifInterface.TAG_ORIENTATION);                              </span>
<span class="-4531415176294548142" onmouseenter="enter('-4531415176294548142');" onmouseout="out('-4531415176294548142');" style=""> 292             if (ori != null) {                                                                           </span>
<span class="-1562166142727498533" onmouseenter="enter('-1562166142727498533');" onmouseout="out('-1562166142727498533');" style=""> 293                 return ExifInterface.getRotationForOrientationValue(ori.shortValue());                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294             }                                                                                            </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 295         } catch (IOException e) {                                                                        </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style=""> 296             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="664713866508780739" onmouseenter="enter('664713866508780739');" onmouseout="out('664713866508780739');" style=""> 297         } catch (NullPointerException e) {                                                               </span>
<span class="4763082681694720315" onmouseenter="enter('4763082681694720315');" onmouseout="out('4763082681694720315');" style=""> 298             // Sometimes the ExifInterface has an internal NPE if Exif data isn&#x27;t valid                  </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style=""> 299             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 300         } finally {                                                                                      </span>
<span class="707338895910965527" onmouseenter="enter('707338895910965527');" onmouseout="out('707338895910965527');" style=""> 301             Utils.closeSilently(bis);                                                                    </span>
<span class="-2053144528988334746" onmouseenter="enter('-2053144528988334746');" onmouseout="out('-2053144528988334746');" style=""> 302             Utils.closeSilently(is);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303         }                                                                                                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 304         return 0;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 305     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="304880958838077089" onmouseenter="enter('304880958838077089');" onmouseout="out('304880958838077089');" style="">   2  * Copyright (C) 2010 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span  style="">  16                                                                                                          </span>
<span class="-7465891333569825926" onmouseenter="enter('-7465891333569825926');" onmouseout="out('-7465891333569825926');" style="">  17 package com.android.gallery3d.common;                                                                    </span>
<span  style="">  18                                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  19 import android.content.Context;                                                                          </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  20 import android.content.res.Resources;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  21 import android.net.Uri;                                                                                  </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  22 import android.util.Log;                                                                                 </span>
<span  style="">  23                                                                                                          </span>
<span class="-1437136200372934815" onmouseenter="enter('-1437136200372934815');" onmouseout="out('-1437136200372934815');" style="">  24 import com.android.gallery3d.exif.ExifInterface;                                                         </span>
<span  style="">  25                                                                                                          </span>
<span class="-8084092933789958161" onmouseenter="enter('-8084092933789958161');" onmouseout="out('-8084092933789958161');" style="">  26 import java.io.BufferedInputStream;                                                                      </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  27 import java.io.IOException;                                                                              </span>
<span class="5631563232245871054" onmouseenter="enter('5631563232245871054');" onmouseout="out('5631563232245871054');" style="">  28 import java.io.InputStream;                                                                              </span>
<span  style="">  29                                                                                                          </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="">  30 public class BitmapUtils {                                                                               </span>
<span  style="">  31                                                                                                          </span>
<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="">  32     private static final String TAG = &quot;BitmapUtils&quot;;                                                     </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style="">  33 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style="">  34 ||||||| BASE                                                                                             </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  35 private static int computeInitialSampleSize(int w, int h,                                                </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  36             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  37         if (maxNumOfPixels == UNCONSTRAINED                                                              </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  38                 &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  39                                                                                                          </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40         int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                         </span>
<span class="7740670432774910968" onmouseenter="enter('7740670432774910968');" onmouseout="out('7740670432774910968');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41                 (int) FloatMath.ceil(FloatMath.sqrt((float) (w * h) / maxNumOfPixels));                  </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42                                                                                                          </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43         if (minSideLength == UNCONSTRAINED) {                                                            </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44             return lowerBound;                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  45         } else {                                                                                         </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  46             int sampleSize = Math.min(w / minSideLength, h / minSideLength);                             </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  47             return Math.max(sampleSize, lowerBound);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  50 =======                                                                                                  </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  51 private static int computeInitialSampleSize(int w, int h,                                                </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  52             int minSideLength, int maxNumOfPixels) {                                                     </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  53         if (maxNumOfPixels == UNCONSTRAINED                                                              </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  54                 &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                             </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  55                                                                                                          </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  56         int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                         </span>
<span class="5369073419942975310" onmouseenter="enter('5369073419942975310');" onmouseout="out('5369073419942975310');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  57                 (int) Math.ceil(Math.sqrt((float) (w * h) / maxNumOfPixels));                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  58                                                                                                          </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  59         if (minSideLength == UNCONSTRAINED) {                                                            </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  60             return lowerBound;                                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61         } else {                                                                                         </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62             int sampleSize = Math.min(w / minSideLength, h / minSideLength);                             </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63             return Math.max(sampleSize, lowerBound);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style="">  66 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style="">  67                                                                                                          </span>
<span  style="">  68                                                                                                          </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="">  69     // Find the min x that 1 / x &gt;= scale                                                                </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="">  70     public static int computeSampleSizeLarger(float scale) {                                             </span>
<span class="883892556015604724" onmouseenter="enter('883892556015604724');" onmouseout="out('883892556015604724');" style="">  71         int initialSize = (int) Math.floor(1f / scale);                                                  </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="">  72         if (initialSize &lt;= 1) return 1;                                                                  </span>
<span  style="">  73                                                                                                          </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="">  74         return initialSize &lt;= 8                                                                          </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="">  75                 ? Utils.prevPowerOf2(initialSize)                                                        </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="">  76                 : initialSize / 8 * 8;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span  style="">  78                                                                                                          </span>
<span class="863927649079425496" onmouseenter="enter('863927649079425496');" onmouseout="out('863927649079425496');" style="">  79     public static int getRotationFromExif(Context context, Uri uri) {                                    </span>
<span class="-1829376402373340167" onmouseenter="enter('-1829376402373340167');" onmouseout="out('-1829376402373340167');" style="">  80         return BitmapUtils.getRotationFromExifHelper(null, 0, context, uri);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  81     }                                                                                                    </span>
<span  style="">  82                                                                                                          </span>
<span class="-8294240942762904550" onmouseenter="enter('-8294240942762904550');" onmouseout="out('-8294240942762904550');" style="">  83     public static int getRotationFromExif(Resources res, int resId) {                                    </span>
<span class="5620893307345032967" onmouseenter="enter('5620893307345032967');" onmouseout="out('5620893307345032967');" style="">  84         return BitmapUtils.getRotationFromExifHelper(res, resId, null, null);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85     }                                                                                                    </span>
<span  style="">  86                                                                                                          </span>
<span class="5411585031145886947" onmouseenter="enter('5411585031145886947');" onmouseout="out('5411585031145886947');" style="">  87     private static int getRotationFromExifHelper(Resources res, int resId, Context context, Uri uri) {   </span>
<span class="-8257955723818790927" onmouseenter="enter('-8257955723818790927');" onmouseout="out('-8257955723818790927');" style="">  88         ExifInterface ei = new ExifInterface();                                                          </span>
<span class="7188824888882858175" onmouseenter="enter('7188824888882858175');" onmouseout="out('7188824888882858175');" style="">  89         InputStream is = null;                                                                           </span>
<span class="-6897335633928745070" onmouseenter="enter('-6897335633928745070');" onmouseout="out('-6897335633928745070');" style="">  90         BufferedInputStream bis = null;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  91         try {                                                                                            </span>
<span class="-6789028041247471756" onmouseenter="enter('-6789028041247471756');" onmouseout="out('-6789028041247471756');" style="">  92             if (uri != null) {                                                                           </span>
<span class="7106114135868158194" onmouseenter="enter('7106114135868158194');" onmouseout="out('7106114135868158194');" style="">  93                 is = context.getContentResolver().openInputStream(uri);                                  </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="">  94                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="">  95                 ei.readExif(bis);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  96             } else {                                                                                     </span>
<span class="5390757631558727338" onmouseenter="enter('5390757631558727338');" onmouseout="out('5390757631558727338');" style="">  97                 is = res.openRawResource(resId);                                                         </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="">  98                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="">  99                 ei.readExif(bis);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 100             }                                                                                            </span>
<span class="5371837386944258962" onmouseenter="enter('5371837386944258962');" onmouseout="out('5371837386944258962');" style=""> 101             Integer ori = ei.getTagIntValue(ExifInterface.TAG_ORIENTATION);                              </span>
<span class="-4531415176294548142" onmouseenter="enter('-4531415176294548142');" onmouseout="out('-4531415176294548142');" style=""> 102             if (ori != null) {                                                                           </span>
<span class="-1562166142727498533" onmouseenter="enter('-1562166142727498533');" onmouseout="out('-1562166142727498533');" style=""> 103                 return ExifInterface.getRotationForOrientationValue(ori.shortValue());                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 104             }                                                                                            </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style=""> 105         } catch (IOException e) {                                                                        </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style=""> 106             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="664713866508780739" onmouseenter="enter('664713866508780739');" onmouseout="out('664713866508780739');" style=""> 107         } catch (NullPointerException e) {                                                               </span>
<span class="4763082681694720315" onmouseenter="enter('4763082681694720315');" onmouseout="out('4763082681694720315');" style=""> 108             // Sometimes the ExifInterface has an internal NPE if Exif data isn&#x27;t valid                  </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style=""> 109             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 110         } finally {                                                                                      </span>
<span class="707338895910965527" onmouseenter="enter('707338895910965527');" onmouseout="out('707338895910965527');" style=""> 111             Utils.closeSilently(bis);                                                                    </span>
<span class="-2053144528988334746" onmouseenter="enter('-2053144528988334746');" onmouseout="out('-2053144528988334746');" style=""> 112             Utils.closeSilently(is);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113         }                                                                                                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style=""> 114         return 0;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 116 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 117 ||||||| BASE                                                                                             </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 118 public static int computeSampleSize(float scale) {                                                       </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 119         Utils.assertTrue(scale &gt; 0);                                                                     </span>
<span class="-8752772725969860209" onmouseenter="enter('-8752772725969860209');" onmouseout="out('-8752772725969860209');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 120         int initialSize = Math.max(1, (int) FloatMath.ceil(1 / scale));                                  </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 121         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 122                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 123                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 124     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 125 =======                                                                                                  </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126 public static int computeSampleSize(float scale) {                                                       </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127         Utils.assertTrue(scale &gt; 0);                                                                     </span>
<span class="1387480855759456316" onmouseenter="enter('1387480855759456316');" onmouseout="out('1387480855759456316');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128         int initialSize = Math.max(1, (int) Math.ceil(1 / scale));                                       </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129         return initialSize &lt;= 8                                                                          </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130                 ? Utils.nextPowerOf2(initialSize)                                                        </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131                 : (initialSize + 7) / 8 * 8;                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 133 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 134                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135 }                                                                                                        </span>









































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="304880958838077089" onmouseenter="enter('304880958838077089');" onmouseout="out('304880958838077089');" style="">   2  * Copyright (C) 2010 The Android Open Source Project                                                    </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3  *                                                                                                       </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4  * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                       </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5  * you may not use this file except in compliance with the License.                                      </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6  * You may obtain a copy of the License at                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7  *                                                                                                       </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8  *      http://www.apache.org/licenses/LICENSE-2.0                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15  */                                                                                                      </span>
<span class="-7465891333569825926" onmouseenter="enter('-7465891333569825926');" onmouseout="out('-7465891333569825926');" style="">  16 package com.android.gallery3d.common;                                                                    </span>
<span  style="">  17                                                                                                          </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  18 import android.content.Context;                                                                          </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  19 import android.content.res.Resources;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  20 import android.net.Uri;                                                                                  </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  21 import android.util.Log;                                                                                 </span>
<span class="-1437136200372934815" onmouseenter="enter('-1437136200372934815');" onmouseout="out('-1437136200372934815');" style="">  22 import com.android.gallery3d.exif.ExifInterface;                                                         </span>
<span class="-8084092933789958161" onmouseenter="enter('-8084092933789958161');" onmouseout="out('-8084092933789958161');" style="">  23 import java.io.BufferedInputStream;                                                                      </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  24 import java.io.IOException;                                                                              </span>
<span class="5631563232245871054" onmouseenter="enter('5631563232245871054');" onmouseout="out('5631563232245871054');" style="">  25 import java.io.InputStream;                                                                              </span>
<span  style="">  26                                                                                                          </span>
<span  style="">  27                                                                                                          </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="">  28 public class BitmapUtils {                                                                               </span>
<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="">  29     private static final String TAG = &quot;BitmapUtils&quot;;                                                     </span>
<span  style="">  30                                                                                                          </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="">  31     // Find the min x that 1 / x &gt;= scale                                                                </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="">  32     public static int computeSampleSizeLarger(float scale) {                                             </span>
<span class="-8382862618650772399" onmouseenter="enter('-8382862618650772399');" onmouseout="out('-8382862618650772399');" style="">  33         int initialSize = ((int) (Math.floor(1.0F / scale)));                                            </span>
<span class="-1944378695122217744" onmouseenter="enter('-1944378695122217744');" onmouseout="out('-1944378695122217744');" style="">  34         if (initialSize &lt;= 1) {                                                                          </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style="">  35             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  36         }                                                                                                </span>
<span class="8237183476647054073" onmouseenter="enter('8237183476647054073');" onmouseout="out('8237183476647054073');" style="">  37         return initialSize &lt;= 8 ? Utils.prevPowerOf2(initialSize) : (initialSize / 8) * 8;               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  38     }                                                                                                    </span>
<span  style="">  39                                                                                                          </span>
<span class="863927649079425496" onmouseenter="enter('863927649079425496');" onmouseout="out('863927649079425496');" style="">  40     public static int getRotationFromExif(Context context, Uri uri) {                                    </span>
<span class="-1829376402373340167" onmouseenter="enter('-1829376402373340167');" onmouseout="out('-1829376402373340167');" style="">  41         return BitmapUtils.getRotationFromExifHelper(null, 0, context, uri);                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  42     }                                                                                                    </span>
<span  style="">  43                                                                                                          </span>
<span class="-8294240942762904550" onmouseenter="enter('-8294240942762904550');" onmouseout="out('-8294240942762904550');" style="">  44     public static int getRotationFromExif(Resources res, int resId) {                                    </span>
<span class="5620893307345032967" onmouseenter="enter('5620893307345032967');" onmouseout="out('5620893307345032967');" style="">  45         return BitmapUtils.getRotationFromExifHelper(res, resId, null, null);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  46     }                                                                                                    </span>
<span  style="">  47                                                                                                          </span>
<span class="5411585031145886947" onmouseenter="enter('5411585031145886947');" onmouseout="out('5411585031145886947');" style="">  48     private static int getRotationFromExifHelper(Resources res, int resId, Context context, Uri uri) {   </span>
<span class="-8257955723818790927" onmouseenter="enter('-8257955723818790927');" onmouseout="out('-8257955723818790927');" style="">  49         ExifInterface ei = new ExifInterface();                                                          </span>
<span class="7188824888882858175" onmouseenter="enter('7188824888882858175');" onmouseout="out('7188824888882858175');" style="">  50         InputStream is = null;                                                                           </span>
<span class="-6897335633928745070" onmouseenter="enter('-6897335633928745070');" onmouseout="out('-6897335633928745070');" style="">  51         BufferedInputStream bis = null;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  52         try {                                                                                            </span>
<span class="-6789028041247471756" onmouseenter="enter('-6789028041247471756');" onmouseout="out('-6789028041247471756');" style="">  53             if (uri != null) {                                                                           </span>
<span class="7106114135868158194" onmouseenter="enter('7106114135868158194');" onmouseout="out('7106114135868158194');" style="">  54                 is = context.getContentResolver().openInputStream(uri);                                  </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="">  55                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="">  56                 ei.readExif(bis);                                                                        </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  57             } else {                                                                                     </span>
<span class="5390757631558727338" onmouseenter="enter('5390757631558727338');" onmouseout="out('5390757631558727338');" style="">  58                 is = res.openRawResource(resId);                                                         </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="">  59                 bis = new BufferedInputStream(is);                                                       </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="">  60                 ei.readExif(bis);                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  61             }                                                                                            </span>
<span class="5371837386944258962" onmouseenter="enter('5371837386944258962');" onmouseout="out('5371837386944258962');" style="">  62             Integer ori = ei.getTagIntValue(ExifInterface.TAG_ORIENTATION);                              </span>
<span class="-4531415176294548142" onmouseenter="enter('-4531415176294548142');" onmouseout="out('-4531415176294548142');" style="">  63             if (ori != null) {                                                                           </span>
<span class="-1562166142727498533" onmouseenter="enter('-1562166142727498533');" onmouseout="out('-1562166142727498533');" style="">  64                 return ExifInterface.getRotationForOrientationValue(ori.shortValue());                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  65             }                                                                                            </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="">  66         } catch (IOException e) {                                                                        </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style="">  67             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="4748428790187322284" onmouseenter="enter('4748428790187322284');" onmouseout="out('4748428790187322284');" style="">  68         } catch (java.lang.NullPointerException e) {                                                     </span>
<span class="4763082681694720315" onmouseenter="enter('4763082681694720315');" onmouseout="out('4763082681694720315');" style="">  69             // Sometimes the ExifInterface has an internal NPE if Exif data isn&#x27;t valid                  </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style="">  70             Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                   </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="">  71         } finally {                                                                                      </span>
<span class="707338895910965527" onmouseenter="enter('707338895910965527');" onmouseout="out('707338895910965527');" style="">  72             Utils.closeSilently(bis);                                                                    </span>
<span class="-2053144528988334746" onmouseenter="enter('-2053144528988334746');" onmouseout="out('-2053144528988334746');" style="">  73             Utils.closeSilently(is);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  74         }                                                                                                </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style="">  75         return 0;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  76     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77 }                                                                                                        </span>



































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="304880958838077089" onmouseenter="enter('304880958838077089');" onmouseout="out('304880958838077089');" style="">   2   * Copyright (C) 2010 The Android Open Source Project                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="-7465891333569825926" onmouseenter="enter('-7465891333569825926');" onmouseout="out('-7465891333569825926');" style="">  17  package com.android.gallery3d.common;                                                                             </span>
<span  style="">  18                                                                                                                    </span>
<span class="-6379310173182770238" onmouseenter="enter('-6379310173182770238');" onmouseout="out('-6379310173182770238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -import android.graphics.Bitmap;                                                                                   </span>
<span class="-9304522635682456" onmouseenter="enter('-9304522635682456');" onmouseout="out('-9304522635682456');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import android.graphics.Bitmap.CompressFormat;                                                                    </span>
<span class="-3019416561807484959" onmouseenter="enter('-3019416561807484959');" onmouseout="out('-3019416561807484959');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import android.graphics.BitmapFactory;                                                                            </span>
<span class="-6358617885644310547" onmouseenter="enter('-6358617885644310547');" onmouseout="out('-6358617885644310547');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import android.graphics.Canvas;                                                                                   </span>
<span class="-2838211797420958568" onmouseenter="enter('-2838211797420958568');" onmouseout="out('-2838211797420958568');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import android.graphics.Matrix;                                                                                   </span>
<span class="-1586527322890291073" onmouseenter="enter('-1586527322890291073');" onmouseout="out('-1586527322890291073');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import android.graphics.Paint;                                                                                    </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  25 -import android.os.Build;                                                                                          </span>
<span class="-7696654565541998833" onmouseenter="enter('-7696654565541998833');" onmouseout="out('-7696654565541998833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import android.util.FloatMath;                                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import android.content.Context;                                                                                   </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +import android.content.res.Resources;                                                                             </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  29 +import android.net.Uri;                                                                                           </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  30  import android.util.Log;                                                                                          </span>
<span  style="">  31                                                                                                                    </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import java.io.ByteArrayOutputStream;                                                                             </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  33 -import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  34 -import java.lang.reflect.Method;                                                                                  </span>
<span class="-1437136200372934815" onmouseenter="enter('-1437136200372934815');" onmouseout="out('-1437136200372934815');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  35 +import com.android.gallery3d.exif.ExifInterface;                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  36 +                                                                                                                  </span>
<span class="-8084092933789958161" onmouseenter="enter('-8084092933789958161');" onmouseout="out('-8084092933789958161');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  37 +import java.io.BufferedInputStream;                                                                               </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +import java.io.IOException;                                                                                       </span>
<span class="5631563232245871054" onmouseenter="enter('5631563232245871054');" onmouseout="out('5631563232245871054');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  39 +import java.io.InputStream;                                                                                       </span>
<span  style="">  40                                                                                                                    </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="">  41  public class BitmapUtils {                                                                                        </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  42 +                                                                                                                  </span>
<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="">  43      private static final String TAG = &quot;BitmapUtils&quot;;                                                              </span>
<span class="-8920313646798206541" onmouseenter="enter('-8920313646798206541');" onmouseout="out('-8920313646798206541');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  44 -    private static final int DEFAULT_JPEG_QUALITY = 90;                                                           </span>
<span class="5925394665829483069" onmouseenter="enter('5925394665829483069');" onmouseout="out('5925394665829483069');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  45 -    public static final int UNCONSTRAINED = -1;                                                                   </span>
<span  style="">  46                                                                                                                    </span>
<span class="-7097481959834704461" onmouseenter="enter('-7097481959834704461');" onmouseout="out('-7097481959834704461');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -    private BitmapUtils(){}                                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -                                                                                                                  </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -    /*                                                                                                            </span>
<span class="1270168804143702943" onmouseenter="enter('1270168804143702943');" onmouseout="out('1270168804143702943');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -     * Compute the sample size as a function of minSideLength                                                     </span>
<span class="5897256147978488688" onmouseenter="enter('5897256147978488688');" onmouseout="out('5897256147978488688');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  51 -     * and maxNumOfPixels.                                                                                        </span>
<span class="7072685536632461207" onmouseenter="enter('7072685536632461207');" onmouseout="out('7072685536632461207');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -     * minSideLength is used to specify that minimal width or height of a                                         </span>
<span class="-3488479511976114383" onmouseenter="enter('-3488479511976114383');" onmouseout="out('-3488479511976114383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -     * bitmap.                                                                                                    </span>
<span class="161810603246613551" onmouseenter="enter('161810603246613551');" onmouseout="out('161810603246613551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -     * maxNumOfPixels is used to specify the maximal size in pixels that is                                       </span>
<span class="-4125933736109438763" onmouseenter="enter('-4125933736109438763');" onmouseout="out('-4125933736109438763');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  55 -     * tolerable in terms of memory usage.                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  56 -     *                                                                                                            </span>
<span class="-7061869334355419504" onmouseenter="enter('-7061869334355419504');" onmouseout="out('-7061869334355419504');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  57 -     * The function returns a sample size based on the constraints.                                               </span>
<span class="-7809175981849985557" onmouseenter="enter('-7809175981849985557');" onmouseout="out('-7809175981849985557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  58 -     * Both size and minSideLength can be passed in as UNCONSTRAINED,                                             </span>
<span class="-236506778142513186" onmouseenter="enter('-236506778142513186');" onmouseout="out('-236506778142513186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  59 -     * which indicates no care of the corresponding constraint.                                                   </span>
<span class="-5130444168296571105" onmouseenter="enter('-5130444168296571105');" onmouseout="out('-5130444168296571105');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  60 -     * The functions prefers returning a sample size that                                                         </span>
<span class="3970471092235412508" onmouseenter="enter('3970471092235412508');" onmouseout="out('3970471092235412508');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  61 -     * generates a smaller bitmap, unless minSideLength = UNCONSTRAINED.                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  62 -     *                                                                                                            </span>
<span class="-2461183840707974014" onmouseenter="enter('-2461183840707974014');" onmouseout="out('-2461183840707974014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  63 -     * Also, the function rounds up the sample size to a power of 2 or multiple                                   </span>
<span class="5388524243881858316" onmouseenter="enter('5388524243881858316');" onmouseout="out('5388524243881858316');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  64 -     * of 8 because BitmapFactory only honors sample size this way.                                               </span>
<span class="8154515727460110981" onmouseenter="enter('8154515727460110981');" onmouseout="out('8154515727460110981');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -     * For example, BitmapFactory downsamples an image by 2 even though the                                       </span>
<span class="-1699546258266074539" onmouseenter="enter('-1699546258266074539');" onmouseout="out('-1699546258266074539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -     * request is 3. So we round up the sample size to avoid OOM.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  67 -     */                                                                                                           </span>
<span class="-6005902021650859259" onmouseenter="enter('-6005902021650859259');" onmouseout="out('-6005902021650859259');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  68 -    public static int computeSampleSize(int width, int height,                                                    </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  69 -            int minSideLength, int maxNumOfPixels) {                                                              </span>
<span class="-7592907632500137939" onmouseenter="enter('-7592907632500137939');" onmouseout="out('-7592907632500137939');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  70 -        int initialSize = computeInitialSampleSize(                                                               </span>
<span class="-551502584830884140" onmouseenter="enter('-551502584830884140');" onmouseout="out('-551502584830884140');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  71 -                width, height, minSideLength, maxNumOfPixels);                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  72 -                                                                                                                  </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  73 -        return initialSize &lt;= 8                                                                                   </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  74 -                ? Utils.nextPowerOf2(initialSize)                                                                 </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -                : (initialSize + 7) / 8 * 8;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  76 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  77 -                                                                                                                  </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  78 -    private static int computeInitialSampleSize(int w, int h,                                                     </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  79 -            int minSideLength, int maxNumOfPixels) {                                                              </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  80 -        if (maxNumOfPixels == UNCONSTRAINED                                                                       </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  81 -                &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                                      </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  82 -                                                                                                                  </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  83 -        int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                                  </span>
<span class="7740670432774910968" onmouseenter="enter('7740670432774910968');" onmouseout="out('7740670432774910968');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  84 -                (int) FloatMath.ceil(FloatMath.sqrt((float) (w * h) / maxNumOfPixels));                           </span>

<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  85 -                                                                                                                  </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  86 -        if (minSideLength == UNCONSTRAINED) {                                                                     </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  87 -            return lowerBound;                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  88 -        } else {                                                                                                  </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  89 -            int sampleSize = Math.min(w / minSideLength, h / minSideLength);                                      </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  90 -            return Math.max(sampleSize, lowerBound);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  91 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  92 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  93 -                                                                                                                  </span>
<span class="1227185696257393805" onmouseenter="enter('1227185696257393805');" onmouseout="out('1227185696257393805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  94 -    // This computes a sample size which makes the longer side at least                                           </span>
<span class="2751286357656229784" onmouseenter="enter('2751286357656229784');" onmouseout="out('2751286357656229784');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  95 -    // minSideLength long. If that&#x27;s not possible, return 1.                                                      </span>
<span class="-601503493775244190" onmouseenter="enter('-601503493775244190');" onmouseout="out('-601503493775244190');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  96 -    public static int computeSampleSizeLarger(int w, int h,                                                       </span>
<span class="-6821687715082164263" onmouseenter="enter('-6821687715082164263');" onmouseout="out('-6821687715082164263');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -            int minSideLength) {                                                                                  </span>
<span class="-2047337129560331180" onmouseenter="enter('-2047337129560331180');" onmouseout="out('-2047337129560331180');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -        int initialSize = Math.max(w / minSideLength, h / minSideLength);                                         </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  99 +    // Find the min x that 1 / x &gt;= scale                                                                         </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 100 +    public static int computeSampleSizeLarger(float scale) {                                                      </span>
<span class="883892556015604724" onmouseenter="enter('883892556015604724');" onmouseout="out('883892556015604724');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +        int initialSize = (int) Math.floor(1f / scale);                                                           </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style=""> 102          if (initialSize &lt;= 1) return 1;                                                                           </span>
<span  style=""> 103                                                                                                                    </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style=""> 104          return initialSize &lt;= 8                                                                                   </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style=""> 105                  ? Utils.prevPowerOf2(initialSize)                                                                 </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style=""> 106                  : initialSize / 8 * 8;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107      }                                                                                                             </span>
<span  style=""> 108                                                                                                                    </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -    // Find the min x that 1 / x &gt;= scale                                                                         </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 110 -    public static int computeSampleSizeLarger(float scale) {                                                      </span>
<span class="2577377926519885209" onmouseenter="enter('2577377926519885209');" onmouseout="out('2577377926519885209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 111 -        int initialSize = (int) FloatMath.floor(1f / scale);                                                      </span>

<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -        if (initialSize &lt;= 1) return 1;                                                                           </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 113 -                                                                                                                  </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 114 -        return initialSize &lt;= 8                                                                                   </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 115 -                ? Utils.prevPowerOf2(initialSize)                                                                 </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 116 -                : initialSize / 8 * 8;                                                                            </span>
<span class="863927649079425496" onmouseenter="enter('863927649079425496');" onmouseout="out('863927649079425496');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 117 +    public static int getRotationFromExif(Context context, Uri uri) {                                             </span>
<span class="-1829376402373340167" onmouseenter="enter('-1829376402373340167');" onmouseout="out('-1829376402373340167');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 118 +        return BitmapUtils.getRotationFromExifHelper(null, 0, context, uri);                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 119      }                                                                                                             </span>
<span  style=""> 120                                                                                                                    </span>
<span class="-6681098284378983876" onmouseenter="enter('-6681098284378983876');" onmouseout="out('-6681098284378983876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -    // Find the max x that 1 / x &lt;= scale.                                                                        </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -    public static int computeSampleSize(float scale) {                                                            </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -        Utils.assertTrue(scale &gt; 0);                                                                              </span>
<span class="-8752772725969860209" onmouseenter="enter('-8752772725969860209');" onmouseout="out('-8752772725969860209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -        int initialSize = Math.max(1, (int) FloatMath.ceil(1 / scale));                                           </span>

<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -        return initialSize &lt;= 8                                                                                   </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -                ? Utils.nextPowerOf2(initialSize)                                                                 </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -                : (initialSize + 7) / 8 * 8;                                                                      </span>
<span class="-8294240942762904550" onmouseenter="enter('-8294240942762904550');" onmouseout="out('-8294240942762904550');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 128 +    public static int getRotationFromExif(Resources res, int resId) {                                             </span>
<span class="5620893307345032967" onmouseenter="enter('5620893307345032967');" onmouseout="out('5620893307345032967');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 129 +        return BitmapUtils.getRotationFromExifHelper(res, resId, null, null);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130      }                                                                                                             </span>
<span  style=""> 131                                                                                                                    </span>
<span class="3091185289403374626" onmouseenter="enter('3091185289403374626');" onmouseout="out('3091185289403374626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -    public static Bitmap resizeBitmapByScale(                                                                     </span>
<span class="4831782962278267455" onmouseenter="enter('4831782962278267455');" onmouseout="out('4831782962278267455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -            Bitmap bitmap, float scale, boolean recycle) {                                                        </span>
<span class="-5756817497037142569" onmouseenter="enter('-5756817497037142569');" onmouseout="out('-5756817497037142569');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -        int width = Math.round(bitmap.getWidth() * scale);                                                        </span>
<span class="3419813210601508568" onmouseenter="enter('3419813210601508568');" onmouseout="out('3419813210601508568');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -        int height = Math.round(bitmap.getHeight() * scale);                                                      </span>
<span class="303533807179344519" onmouseenter="enter('303533807179344519');" onmouseout="out('303533807179344519');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -        if (width == bitmap.getWidth()                                                                            </span>
<span class="-3589445165592385210" onmouseenter="enter('-3589445165592385210');" onmouseout="out('-3589445165592385210');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -                &amp;&amp; height == bitmap.getHeight()) return bitmap;                                                   </span>
<span class="-7306674282947456904" onmouseenter="enter('-7306674282947456904');" onmouseout="out('-7306674282947456904');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 138 -        Bitmap target = Bitmap.createBitmap(width, height, getConfig(bitmap));                                    </span>
<span class="-3692150631639784625" onmouseenter="enter('-3692150631639784625');" onmouseout="out('-3692150631639784625');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 139 -        Canvas canvas = new Canvas(target);                                                                       </span>
<span class="3217099220325300661" onmouseenter="enter('3217099220325300661');" onmouseout="out('3217099220325300661');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 140 -        canvas.scale(scale, scale);                                                                               </span>
<span class="2013858014721095122" onmouseenter="enter('2013858014721095122');" onmouseout="out('2013858014721095122');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 141 -        Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG | Paint.DITHER_FLAG);                                    </span>
<span class="4288326217758543884" onmouseenter="enter('4288326217758543884');" onmouseout="out('4288326217758543884');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -        canvas.drawBitmap(bitmap, 0, 0, paint);                                                                   </span>
<span class="7474773097778997213" onmouseenter="enter('7474773097778997213');" onmouseout="out('7474773097778997213');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -        if (recycle) bitmap.recycle();                                                                            </span>
<span class="-2959814168001159603" onmouseenter="enter('-2959814168001159603');" onmouseout="out('-2959814168001159603');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -        return target;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -                                                                                                                  </span>
<span class="-2049346337119747307" onmouseenter="enter('-2049346337119747307');" onmouseout="out('-2049346337119747307');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -    private static Bitmap.Config getConfig(Bitmap bitmap) {                                                       </span>
<span class="3101150733112471087" onmouseenter="enter('3101150733112471087');" onmouseout="out('3101150733112471087');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -        Bitmap.Config config = bitmap.getConfig();                                                                </span>
<span class="-4614138539221537761" onmouseenter="enter('-4614138539221537761');" onmouseout="out('-4614138539221537761');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -        if (config == null) {                                                                                     </span>
<span class="2896443648738077651" onmouseenter="enter('2896443648738077651');" onmouseout="out('2896443648738077651');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -            config = Bitmap.Config.ARGB_8888;                                                                     </span>
<span class="5411585031145886947" onmouseenter="enter('5411585031145886947');" onmouseout="out('5411585031145886947');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +    private static int getRotationFromExifHelper(Resources res, int resId, Context context, Uri uri) {            </span>
<span class="-8257955723818790927" onmouseenter="enter('-8257955723818790927');" onmouseout="out('-8257955723818790927');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +        ExifInterface ei = new ExifInterface();                                                                   </span>
<span class="7188824888882858175" onmouseenter="enter('7188824888882858175');" onmouseout="out('7188824888882858175');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +        InputStream is = null;                                                                                    </span>
<span class="-6897335633928745070" onmouseenter="enter('-6897335633928745070');" onmouseout="out('-6897335633928745070');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +        BufferedInputStream bis = null;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +        try {                                                                                                     </span>
<span class="-6789028041247471756" onmouseenter="enter('-6789028041247471756');" onmouseout="out('-6789028041247471756');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +            if (uri != null) {                                                                                    </span>
<span class="7106114135868158194" onmouseenter="enter('7106114135868158194');" onmouseout="out('7106114135868158194');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +                is = context.getContentResolver().openInputStream(uri);                                           </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +                bis = new BufferedInputStream(is);                                                                </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +                ei.readExif(bis);                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +            } else {                                                                                              </span>
<span class="5390757631558727338" onmouseenter="enter('5390757631558727338');" onmouseout="out('5390757631558727338');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 161 +                is = res.openRawResource(resId);                                                                  </span>
<span class="3184258442490739649" onmouseenter="enter('3184258442490739649');" onmouseout="out('3184258442490739649');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 162 +                bis = new BufferedInputStream(is);                                                                </span>
<span class="-4766688947199838564" onmouseenter="enter('-4766688947199838564');" onmouseout="out('-4766688947199838564');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 163 +                ei.readExif(bis);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 164 +            }                                                                                                     </span>
<span class="5371837386944258962" onmouseenter="enter('5371837386944258962');" onmouseout="out('5371837386944258962');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 165 +            Integer ori = ei.getTagIntValue(ExifInterface.TAG_ORIENTATION);                                       </span>
<span class="-4531415176294548142" onmouseenter="enter('-4531415176294548142');" onmouseout="out('-4531415176294548142');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 166 +            if (ori != null) {                                                                                    </span>
<span class="-1562166142727498533" onmouseenter="enter('-1562166142727498533');" onmouseout="out('-1562166142727498533');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 167 +                return ExifInterface.getRotationForOrientationValue(ori.shortValue());                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 168 +            }                                                                                                     </span>
<span class="7080241092423381085" onmouseenter="enter('7080241092423381085');" onmouseout="out('7080241092423381085');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 169 +        } catch (IOException e) {                                                                                 </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 170 +            Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                            </span>
<span class="664713866508780739" onmouseenter="enter('664713866508780739');" onmouseout="out('664713866508780739');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 171 +        } catch (NullPointerException e) {                                                                        </span>
<span class="4763082681694720315" onmouseenter="enter('4763082681694720315');" onmouseout="out('4763082681694720315');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 172 +            // Sometimes the ExifInterface has an internal NPE if Exif data isn&#x27;t valid                           </span>
<span class="-3841262241410551631" onmouseenter="enter('-3841262241410551631');" onmouseout="out('-3841262241410551631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 173 +            Log.w(TAG, &quot;Getting exif data failed&quot;, e);                                                            </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 174 +        } finally {                                                                                               </span>
<span class="707338895910965527" onmouseenter="enter('707338895910965527');" onmouseout="out('707338895910965527');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 175 +            Utils.closeSilently(bis);                                                                             </span>
<span class="-2053144528988334746" onmouseenter="enter('-2053144528988334746');" onmouseout="out('-2053144528988334746');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 176 +            Utils.closeSilently(is);                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177          }                                                                                                         </span>
<span class="1511137489476012941" onmouseenter="enter('1511137489476012941');" onmouseout="out('1511137489476012941');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -        return config;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                                                                                                                  </span>
<span class="6753405047756417955" onmouseenter="enter('6753405047756417955');" onmouseout="out('6753405047756417955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -    public static Bitmap resizeDownBySideLength(                                                                  </span>
<span class="8112155692535193680" onmouseenter="enter('8112155692535193680');" onmouseout="out('8112155692535193680');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -            Bitmap bitmap, int maxLength, boolean recycle) {                                                      </span>
<span class="1236066190776078207" onmouseenter="enter('1236066190776078207');" onmouseout="out('1236066190776078207');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -        int srcWidth = bitmap.getWidth();                                                                         </span>
<span class="-8855508668956682981" onmouseenter="enter('-8855508668956682981');" onmouseout="out('-8855508668956682981');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -        int srcHeight = bitmap.getHeight();                                                                       </span>
<span class="4829228751871420725" onmouseenter="enter('4829228751871420725');" onmouseout="out('4829228751871420725');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -        float scale = Math.min(                                                                                   </span>
<span class="3785768231827879013" onmouseenter="enter('3785768231827879013');" onmouseout="out('3785768231827879013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -                (float) maxLength / srcWidth, (float) maxLength / srcHeight);                                     </span>
<span class="-1755224370009475234" onmouseenter="enter('-1755224370009475234');" onmouseout="out('-1755224370009475234');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -        if (scale &gt;= 1.0f) return bitmap;                                                                         </span>
<span class="9117340797061901273" onmouseenter="enter('9117340797061901273');" onmouseout="out('9117340797061901273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -        return resizeBitmapByScale(bitmap, scale, recycle);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 190 -                                                                                                                  </span>
<span class="-7702454016646558852" onmouseenter="enter('-7702454016646558852');" onmouseout="out('-7702454016646558852');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 191 -    public static Bitmap resizeAndCropCenter(Bitmap bitmap, int size, boolean recycle) {                          </span>
<span class="-2475479251052670336" onmouseenter="enter('-2475479251052670336');" onmouseout="out('-2475479251052670336');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 192 -        int w = bitmap.getWidth();                                                                                </span>
<span class="4864488801953676979" onmouseenter="enter('4864488801953676979');" onmouseout="out('4864488801953676979');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -        int h = bitmap.getHeight();                                                                               </span>
<span class="-8898883601662174720" onmouseenter="enter('-8898883601662174720');" onmouseout="out('-8898883601662174720');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -        if (w == size &amp;&amp; h == size) return bitmap;                                                                </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -                                                                                                                  </span>
<span class="1456858405684362729" onmouseenter="enter('1456858405684362729');" onmouseout="out('1456858405684362729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -        // scale the image so that the shorter side equals to the target;                                         </span>
<span class="-7442578123742108142" onmouseenter="enter('-7442578123742108142');" onmouseout="out('-7442578123742108142');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -        // the longer side will be center-cropped.                                                                </span>
<span class="7675276868082726676" onmouseenter="enter('7675276868082726676');" onmouseout="out('7675276868082726676');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -        float scale = (float) size / Math.min(w,  h);                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -                                                                                                                  </span>
<span class="-4965559157399986010" onmouseenter="enter('-4965559157399986010');" onmouseout="out('-4965559157399986010');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -        Bitmap target = Bitmap.createBitmap(size, size, getConfig(bitmap));                                       </span>
<span class="8870373666161503235" onmouseenter="enter('8870373666161503235');" onmouseout="out('8870373666161503235');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -        int width = Math.round(scale * bitmap.getWidth());                                                        </span>
<span class="2825422717690467926" onmouseenter="enter('2825422717690467926');" onmouseout="out('2825422717690467926');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -        int height = Math.round(scale * bitmap.getHeight());                                                      </span>
<span class="-3692150631639784625" onmouseenter="enter('-3692150631639784625');" onmouseout="out('-3692150631639784625');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -        Canvas canvas = new Canvas(target);                                                                       </span>
<span class="6225364946919426121" onmouseenter="enter('6225364946919426121');" onmouseout="out('6225364946919426121');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -        canvas.translate((size - width) / 2f, (size - height) / 2f);                                              </span>
<span class="3217099220325300661" onmouseenter="enter('3217099220325300661');" onmouseout="out('3217099220325300661');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -        canvas.scale(scale, scale);                                                                               </span>
<span class="2013858014721095122" onmouseenter="enter('2013858014721095122');" onmouseout="out('2013858014721095122');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -        Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG | Paint.DITHER_FLAG);                                    </span>
<span class="4288326217758543884" onmouseenter="enter('4288326217758543884');" onmouseout="out('4288326217758543884');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -        canvas.drawBitmap(bitmap, 0, 0, paint);                                                                   </span>
<span class="7474773097778997213" onmouseenter="enter('7474773097778997213');" onmouseout="out('7474773097778997213');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -        if (recycle) bitmap.recycle();                                                                            </span>
<span class="-2959814168001159603" onmouseenter="enter('-2959814168001159603');" onmouseout="out('-2959814168001159603');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -        return target;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                                                                                                                  </span>
<span class="8988468418297173665" onmouseenter="enter('8988468418297173665');" onmouseout="out('8988468418297173665');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -    public static void recycleSilently(Bitmap bitmap) {                                                           </span>
<span class="6414298760516754988" onmouseenter="enter('6414298760516754988');" onmouseout="out('6414298760516754988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -        if (bitmap == null) return;                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -        try {                                                                                                     </span>
<span class="-2094673185475372498" onmouseenter="enter('-2094673185475372498');" onmouseout="out('-2094673185475372498');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -            bitmap.recycle();                                                                                     </span>
<span class="-8603286158505252436" onmouseenter="enter('-8603286158505252436');" onmouseout="out('-8603286158505252436');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 216 -        } catch (Throwable t) {                                                                                   </span>
<span class="8927077538568292539" onmouseenter="enter('8927077538568292539');" onmouseout="out('8927077538568292539');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 217 -            Log.w(TAG, &quot;unable recycle bitmap&quot;, t);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 218 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -                                                                                                                  </span>
<span class="-218838256635917969" onmouseenter="enter('-218838256635917969');" onmouseout="out('-218838256635917969');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 221 -    public static Bitmap rotateBitmap(Bitmap source, int rotation, boolean recycle) {                             </span>
<span class="-6165464536073181139" onmouseenter="enter('-6165464536073181139');" onmouseout="out('-6165464536073181139');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 222 -        if (rotation == 0) return source;                                                                         </span>
<span class="1566843812967469550" onmouseenter="enter('1566843812967469550');" onmouseout="out('1566843812967469550');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 223 -        int w = source.getWidth();                                                                                </span>
<span class="7454284054558192870" onmouseenter="enter('7454284054558192870');" onmouseout="out('7454284054558192870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 224 -        int h = source.getHeight();                                                                               </span>
<span class="247367293182567826" onmouseenter="enter('247367293182567826');" onmouseout="out('247367293182567826');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 225 -        Matrix m = new Matrix();                                                                                  </span>
<span class="3139056768063005906" onmouseenter="enter('3139056768063005906');" onmouseout="out('3139056768063005906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 226 -        m.postRotate(rotation);                                                                                   </span>
<span class="1353388874546501571" onmouseenter="enter('1353388874546501571');" onmouseout="out('1353388874546501571');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 227 -        Bitmap bitmap = Bitmap.createBitmap(source, 0, 0, w, h, m, true);                                         </span>
<span class="-1908412012804651245" onmouseenter="enter('-1908412012804651245');" onmouseout="out('-1908412012804651245');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 228 -        if (recycle) source.recycle();                                                                            </span>
<span class="-2669835381987628663" onmouseenter="enter('-2669835381987628663');" onmouseout="out('-2669835381987628663');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 229 -        return bitmap;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 230 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 231 -                                                                                                                  </span>
<span class="-578628038334033218" onmouseenter="enter('-578628038334033218');" onmouseout="out('-578628038334033218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 232 -    public static Bitmap createVideoThumbnail(String filePath) {                                                  </span>
<span class="7922657396587633319" onmouseenter="enter('7922657396587633319');" onmouseout="out('7922657396587633319');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 233 -        // MediaMetadataRetriever is available on API Level 8                                                     </span>
<span class="-627976963858968214" onmouseenter="enter('-627976963858968214');" onmouseout="out('-627976963858968214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 234 -        // but is hidden until API Level 10                                                                       </span>
<span class="-6715415270183450311" onmouseenter="enter('-6715415270183450311');" onmouseout="out('-6715415270183450311');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 235 -        Class&lt;?&gt; clazz = null;                                                                                    </span>
<span class="7241294395934322955" onmouseenter="enter('7241294395934322955');" onmouseout="out('7241294395934322955');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 236 -        Object instance = null;                                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 237 -        try {                                                                                                     </span>
<span class="2213641619944118764" onmouseenter="enter('2213641619944118764');" onmouseout="out('2213641619944118764');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 238 -            clazz = Class.forName(&quot;android.media.MediaMetadataRetriever&quot;);                                        </span>
<span class="7375470152628205833" onmouseenter="enter('7375470152628205833');" onmouseout="out('7375470152628205833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 239 -            instance = clazz.newInstance();                                                                       </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 240 -                                                                                                                  </span>
<span class="-5271594396134918193" onmouseenter="enter('-5271594396134918193');" onmouseout="out('-5271594396134918193');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 241 -            Method method = clazz.getMethod(&quot;setDataSource&quot;, String.class);                                       </span>
<span class="-3293239081802691097" onmouseenter="enter('-3293239081802691097');" onmouseout="out('-3293239081802691097');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 242 -            method.invoke(instance, filePath);                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 243 -                                                                                                                  </span>
<span class="2264746674321546694" onmouseenter="enter('2264746674321546694');" onmouseout="out('2264746674321546694');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 244 -            // The method name changes between API Level 9 and 10.                                                </span>
<span class="-4862876494596076993" onmouseenter="enter('-4862876494596076993');" onmouseout="out('-4862876494596076993');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 245 -            if (Build.VERSION.SDK_INT &lt;= 9) {                                                                     </span>
<span class="-4497570131557843222" onmouseenter="enter('-4497570131557843222');" onmouseout="out('-4497570131557843222');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 246 -                return (Bitmap) clazz.getMethod(&quot;captureFrame&quot;).invoke(instance);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -            } else {                                                                                              </span>
<span class="5510576414050118008" onmouseenter="enter('5510576414050118008');" onmouseout="out('5510576414050118008');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 248 -                byte[] data = (byte[]) clazz.getMethod(&quot;getEmbeddedPicture&quot;).invoke(instance);                    </span>
<span class="8818251485791898564" onmouseenter="enter('8818251485791898564');" onmouseout="out('8818251485791898564');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 249 -                if (data != null) {                                                                               </span>
<span class="3742629447589554063" onmouseenter="enter('3742629447589554063');" onmouseout="out('3742629447589554063');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 250 -                    Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length);                          </span>
<span class="-371148499467227168" onmouseenter="enter('-371148499467227168');" onmouseout="out('-371148499467227168');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -                    if (bitmap != null) return bitmap;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                }                                                                                                 </span>
<span class="7649001076389340306" onmouseenter="enter('7649001076389340306');" onmouseout="out('7649001076389340306');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 253 -                return (Bitmap) clazz.getMethod(&quot;getFrameAtTime&quot;).invoke(instance);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 254 -            }                                                                                                     </span>
<span class="5301700888569482864" onmouseenter="enter('5301700888569482864');" onmouseout="out('5301700888569482864');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 255 -        } catch (IllegalArgumentException ex) {                                                                   </span>
<span class="-4680445030937730839" onmouseenter="enter('-4680445030937730839');" onmouseout="out('-4680445030937730839');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 256 -            // Assume this is a corrupt video file                                                                </span>
<span class="3255801419413274971" onmouseenter="enter('3255801419413274971');" onmouseout="out('3255801419413274971');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 257 -        } catch (RuntimeException ex) {                                                                           </span>
<span class="74521425252002816" onmouseenter="enter('74521425252002816');" onmouseout="out('74521425252002816');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 258 -            // Assume this is a corrupt video file.                                                               </span>
<span class="6243028624057522413" onmouseenter="enter('6243028624057522413');" onmouseout="out('6243028624057522413');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 259 -        } catch (InstantiationException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -            Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-291101072954915259" onmouseenter="enter('-291101072954915259');" onmouseout="out('-291101072954915259');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 261 -        } catch (InvocationTargetException e) {                                                                   </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 262 -            Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 263 -        } catch (ClassNotFoundException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 264 -            Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-4617077893838138158" onmouseenter="enter('-4617077893838138158');" onmouseout="out('-4617077893838138158');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 265 -        } catch (NoSuchMethodException e) {                                                                       </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 266 -            Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 267 -        } catch (IllegalAccessException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 268 -            Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -        } finally {                                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 270 -            try {                                                                                                 </span>
<span class="579147444735564891" onmouseenter="enter('579147444735564891');" onmouseout="out('579147444735564891');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 271 -                if (instance != null) {                                                                           </span>
<span class="-1978271112408209287" onmouseenter="enter('-1978271112408209287');" onmouseout="out('-1978271112408209287');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 272 -                    clazz.getMethod(&quot;release&quot;).invoke(instance);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                }                                                                                                 </span>
<span class="8538742657781196138" onmouseenter="enter('8538742657781196138');" onmouseout="out('8538742657781196138');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 274 -            } catch (Exception ignored) {                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 275 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 276 -        }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 277 -        return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 278 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 279 -                                                                                                                  </span>
<span class="-3037994906685046990" onmouseenter="enter('-3037994906685046990');" onmouseout="out('-3037994906685046990');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 280 -    public static byte[] compressToBytes(Bitmap bitmap) {                                                         </span>
<span class="8154759637764213993" onmouseenter="enter('8154759637764213993');" onmouseout="out('8154759637764213993');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 281 -        return compressToBytes(bitmap, DEFAULT_JPEG_QUALITY);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 282 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 283 -                                                                                                                  </span>
<span class="1030270861855538274" onmouseenter="enter('1030270861855538274');" onmouseout="out('1030270861855538274');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 284 -    public static byte[] compressToBytes(Bitmap bitmap, int quality) {                                            </span>
<span class="-7691639136163286190" onmouseenter="enter('-7691639136163286190');" onmouseout="out('-7691639136163286190');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 285 -        ByteArrayOutputStream baos = new ByteArrayOutputStream(65536);                                            </span>
<span class="-8799862925650220911" onmouseenter="enter('-8799862925650220911');" onmouseout="out('-8799862925650220911');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 286 -        bitmap.compress(CompressFormat.JPEG, quality, baos);                                                      </span>
<span class="-79689795365024547" onmouseenter="enter('-79689795365024547');" onmouseout="out('-79689795365024547');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 287 -        return baos.toByteArray();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 288 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 289 -                                                                                                                  </span>
<span class="-4883654258312344942" onmouseenter="enter('-4883654258312344942');" onmouseout="out('-4883654258312344942');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 290 -    public static boolean isSupportedByRegionDecoder(String mimeType) {                                           </span>
<span class="-5522020421405306924" onmouseenter="enter('-5522020421405306924');" onmouseout="out('-5522020421405306924');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 291 -        if (mimeType == null) return false;                                                                       </span>
<span class="2553519890327140378" onmouseenter="enter('2553519890327140378');" onmouseout="out('2553519890327140378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 292 -        mimeType = mimeType.toLowerCase();                                                                        </span>
<span class="-4756927242968839153" onmouseenter="enter('-4756927242968839153');" onmouseout="out('-4756927242968839153');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 293 -        return mimeType.startsWith(&quot;image/&quot;) &amp;&amp;                                                                   </span>
<span class="3826629459903750807" onmouseenter="enter('3826629459903750807');" onmouseout="out('3826629459903750807');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 294 -                (!mimeType.equals(&quot;image/gif&quot;) &amp;&amp; !mimeType.endsWith(&quot;bmp&quot;));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 295 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 296 -                                                                                                                  </span>
<span class="-4484782655407848181" onmouseenter="enter('-4484782655407848181');" onmouseout="out('-4484782655407848181');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 297 -    public static boolean isRotationSupported(String mimeType) {                                                  </span>
<span class="-5522020421405306924" onmouseenter="enter('-5522020421405306924');" onmouseout="out('-5522020421405306924');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 298 -        if (mimeType == null) return false;                                                                       </span>
<span class="2553519890327140378" onmouseenter="enter('2553519890327140378');" onmouseout="out('2553519890327140378');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 299 -        mimeType = mimeType.toLowerCase();                                                                        </span>
<span class="-8952449944828140254" onmouseenter="enter('-8952449944828140254');" onmouseout="out('-8952449944828140254');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 300 -        return mimeType.equals(&quot;image/jpeg&quot;);                                                                     </span>
<span class="-8269198090232257590" onmouseenter="enter('-8269198090232257590');" onmouseout="out('-8269198090232257590');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 301 +        return 0;                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 303  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="304880958838077089" onmouseenter="enter('304880958838077089');" onmouseout="out('304880958838077089');" style="">   2   * Copyright (C) 2010 The Android Open Source Project                                                             </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   3   *                                                                                                                </span>
<span class="-7144700690364548245" onmouseenter="enter('-7144700690364548245');" onmouseout="out('-7144700690364548245');" style="">   4   * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);                                                </span>
<span class="-6614298523444173250" onmouseenter="enter('-6614298523444173250');" onmouseout="out('-6614298523444173250');" style="">   5   * you may not use this file except in compliance with the License.                                               </span>
<span class="-4753901504248728101" onmouseenter="enter('-4753901504248728101');" onmouseout="out('-4753901504248728101');" style="">   6   * You may obtain a copy of the License at                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   7   *                                                                                                                </span>
<span class="-763207030729826407" onmouseenter="enter('-763207030729826407');" onmouseout="out('-763207030729826407');" style="">   8   *      http://www.apache.org/licenses/LICENSE-2.0                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  10   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  11   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  12   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  13   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  14   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  15   */                                                                                                               </span>
<span  style="">  16                                                                                                                    </span>
<span class="-7465891333569825926" onmouseenter="enter('-7465891333569825926');" onmouseout="out('-7465891333569825926');" style="">  17  package com.android.gallery3d.common;                                                                             </span>
<span  style="">  18                                                                                                                    </span>
<span class="-6379310173182770238" onmouseenter="enter('-6379310173182770238');" onmouseout="out('-6379310173182770238');" style="">  19  import android.graphics.Bitmap;                                                                                   </span>
<span class="-9304522635682456" onmouseenter="enter('-9304522635682456');" onmouseout="out('-9304522635682456');" style="">  20  import android.graphics.Bitmap.CompressFormat;                                                                    </span>
<span class="-3019416561807484959" onmouseenter="enter('-3019416561807484959');" onmouseout="out('-3019416561807484959');" style="">  21  import android.graphics.BitmapFactory;                                                                            </span>
<span class="-6358617885644310547" onmouseenter="enter('-6358617885644310547');" onmouseout="out('-6358617885644310547');" style="">  22  import android.graphics.Canvas;                                                                                   </span>
<span class="-2838211797420958568" onmouseenter="enter('-2838211797420958568');" onmouseout="out('-2838211797420958568');" style="">  23  import android.graphics.Matrix;                                                                                   </span>
<span class="-1586527322890291073" onmouseenter="enter('-1586527322890291073');" onmouseout="out('-1586527322890291073');" style="">  24  import android.graphics.Paint;                                                                                    </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  25  import android.os.Build;                                                                                          </span>
<span class="-7696654565541998833" onmouseenter="enter('-7696654565541998833');" onmouseout="out('-7696654565541998833');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  26 -import android.util.FloatMath;                                                                                    </span>



<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  27  import android.util.Log;                                                                                          </span>
<span  style="">  28                                                                                                                    </span>
<span class="9184227348967602043" onmouseenter="enter('9184227348967602043');" onmouseout="out('9184227348967602043');" style="">  29  import java.io.ByteArrayOutputStream;                                                                             </span>
<span class="5727252987923913" onmouseenter="enter('5727252987923913');" onmouseout="out('5727252987923913');" style="">  30  import java.lang.reflect.InvocationTargetException;                                                               </span>
<span class="3877996116863688216" onmouseenter="enter('3877996116863688216');" onmouseout="out('3877996116863688216');" style="">  31  import java.lang.reflect.Method;                                                                                  </span>





<span  style="">  32                                                                                                                    </span>
<span class="5600756542892592110" onmouseenter="enter('5600756542892592110');" onmouseout="out('5600756542892592110');" style="">  33  public class BitmapUtils {                                                                                        </span>

<span class="-6890858418739584671" onmouseenter="enter('-6890858418739584671');" onmouseout="out('-6890858418739584671');" style="">  34      private static final String TAG = &quot;BitmapUtils&quot;;                                                              </span>
<span class="-8920313646798206541" onmouseenter="enter('-8920313646798206541');" onmouseout="out('-8920313646798206541');" style="">  35      private static final int DEFAULT_JPEG_QUALITY = 90;                                                           </span>
<span class="5925394665829483069" onmouseenter="enter('5925394665829483069');" onmouseout="out('5925394665829483069');" style="">  36      public static final int UNCONSTRAINED = -1;                                                                   </span>
<span  style="">  37                                                                                                                    </span>
<span class="-7097481959834704461" onmouseenter="enter('-7097481959834704461');" onmouseout="out('-7097481959834704461');" style="">  38      private BitmapUtils(){}                                                                                       </span>
<span  style="">  39                                                                                                                    </span>
<span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">  40      /*                                                                                                            </span>
<span class="1270168804143702943" onmouseenter="enter('1270168804143702943');" onmouseout="out('1270168804143702943');" style="">  41       * Compute the sample size as a function of minSideLength                                                     </span>
<span class="5897256147978488688" onmouseenter="enter('5897256147978488688');" onmouseout="out('5897256147978488688');" style="">  42       * and maxNumOfPixels.                                                                                        </span>
<span class="7072685536632461207" onmouseenter="enter('7072685536632461207');" onmouseout="out('7072685536632461207');" style="">  43       * minSideLength is used to specify that minimal width or height of a                                         </span>
<span class="-3488479511976114383" onmouseenter="enter('-3488479511976114383');" onmouseout="out('-3488479511976114383');" style="">  44       * bitmap.                                                                                                    </span>
<span class="161810603246613551" onmouseenter="enter('161810603246613551');" onmouseout="out('161810603246613551');" style="">  45       * maxNumOfPixels is used to specify the maximal size in pixels that is                                       </span>
<span class="-4125933736109438763" onmouseenter="enter('-4125933736109438763');" onmouseout="out('-4125933736109438763');" style="">  46       * tolerable in terms of memory usage.                                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  47       *                                                                                                            </span>
<span class="-7061869334355419504" onmouseenter="enter('-7061869334355419504');" onmouseout="out('-7061869334355419504');" style="">  48       * The function returns a sample size based on the constraints.                                               </span>
<span class="-7809175981849985557" onmouseenter="enter('-7809175981849985557');" onmouseout="out('-7809175981849985557');" style="">  49       * Both size and minSideLength can be passed in as UNCONSTRAINED,                                             </span>
<span class="-236506778142513186" onmouseenter="enter('-236506778142513186');" onmouseout="out('-236506778142513186');" style="">  50       * which indicates no care of the corresponding constraint.                                                   </span>
<span class="-5130444168296571105" onmouseenter="enter('-5130444168296571105');" onmouseout="out('-5130444168296571105');" style="">  51       * The functions prefers returning a sample size that                                                         </span>
<span class="3970471092235412508" onmouseenter="enter('3970471092235412508');" onmouseout="out('3970471092235412508');" style="">  52       * generates a smaller bitmap, unless minSideLength = UNCONSTRAINED.                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  53       *                                                                                                            </span>
<span class="-2461183840707974014" onmouseenter="enter('-2461183840707974014');" onmouseout="out('-2461183840707974014');" style="">  54       * Also, the function rounds up the sample size to a power of 2 or multiple                                   </span>
<span class="5388524243881858316" onmouseenter="enter('5388524243881858316');" onmouseout="out('5388524243881858316');" style="">  55       * of 8 because BitmapFactory only honors sample size this way.                                               </span>
<span class="8154515727460110981" onmouseenter="enter('8154515727460110981');" onmouseout="out('8154515727460110981');" style="">  56       * For example, BitmapFactory downsamples an image by 2 even though the                                       </span>
<span class="-1699546258266074539" onmouseenter="enter('-1699546258266074539');" onmouseout="out('-1699546258266074539');" style="">  57       * request is 3. So we round up the sample size to avoid OOM.                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  58       */                                                                                                           </span>
<span class="-6005902021650859259" onmouseenter="enter('-6005902021650859259');" onmouseout="out('-6005902021650859259');" style="">  59      public static int computeSampleSize(int width, int height,                                                    </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="">  60              int minSideLength, int maxNumOfPixels) {                                                              </span>
<span class="-7592907632500137939" onmouseenter="enter('-7592907632500137939');" onmouseout="out('-7592907632500137939');" style="">  61          int initialSize = computeInitialSampleSize(                                                               </span>
<span class="-551502584830884140" onmouseenter="enter('-551502584830884140');" onmouseout="out('-551502584830884140');" style="">  62                  width, height, minSideLength, maxNumOfPixels);                                                    </span>
<span  style="">  63                                                                                                                    </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="">  64          return initialSize &lt;= 8                                                                                   </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style="">  65                  ? Utils.nextPowerOf2(initialSize)                                                                 </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style="">  66                  : (initialSize + 7) / 8 * 8;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  67      }                                                                                                             </span>
<span  style="">  68                                                                                                                    </span>
<span class="-7308308336690758365" onmouseenter="enter('-7308308336690758365');" onmouseout="out('-7308308336690758365');" style="">  69      private static int computeInitialSampleSize(int w, int h,                                                     </span>
<span class="5832120532577669649" onmouseenter="enter('5832120532577669649');" onmouseout="out('5832120532577669649');" style="">  70              int minSideLength, int maxNumOfPixels) {                                                              </span>
<span class="5216368653667987077" onmouseenter="enter('5216368653667987077');" onmouseout="out('5216368653667987077');" style="">  71          if (maxNumOfPixels == UNCONSTRAINED                                                                       </span>
<span class="-8863933291689247694" onmouseenter="enter('-8863933291689247694');" onmouseout="out('-8863933291689247694');" style="">  72                  &amp;&amp; minSideLength == UNCONSTRAINED) return 1;                                                      </span>
<span  style="">  73                                                                                                                    </span>
<span class="5328909061314280395" onmouseenter="enter('5328909061314280395');" onmouseout="out('5328909061314280395');" style="">  74          int lowerBound = (maxNumOfPixels == UNCONSTRAINED) ? 1 :                                                  </span>
<span class="7740670432774910968" onmouseenter="enter('7740670432774910968');" onmouseout="out('7740670432774910968');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  75 -                (int) FloatMath.ceil(FloatMath.sqrt((float) (w * h) / maxNumOfPixels));                           </span>
<span class="5369073419942975310" onmouseenter="enter('5369073419942975310');" onmouseout="out('5369073419942975310');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  76 +                (int) Math.ceil(Math.sqrt((float) (w * h) / maxNumOfPixels));                                     </span>
<span  style="">  77                                                                                                                    </span>
<span class="8767251621113958626" onmouseenter="enter('8767251621113958626');" onmouseout="out('8767251621113958626');" style="">  78          if (minSideLength == UNCONSTRAINED) {                                                                     </span>
<span class="-6037333050088793074" onmouseenter="enter('-6037333050088793074');" onmouseout="out('-6037333050088793074');" style="">  79              return lowerBound;                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  80          } else {                                                                                                  </span>
<span class="4561712483970511796" onmouseenter="enter('4561712483970511796');" onmouseout="out('4561712483970511796');" style="">  81              int sampleSize = Math.min(w / minSideLength, h / minSideLength);                                      </span>
<span class="8418581860043888199" onmouseenter="enter('8418581860043888199');" onmouseout="out('8418581860043888199');" style="">  82              return Math.max(sampleSize, lowerBound);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84      }                                                                                                             </span>
<span  style="">  85                                                                                                                    </span>
<span class="1227185696257393805" onmouseenter="enter('1227185696257393805');" onmouseout="out('1227185696257393805');" style="">  86      // This computes a sample size which makes the longer side at least                                           </span>
<span class="2751286357656229784" onmouseenter="enter('2751286357656229784');" onmouseout="out('2751286357656229784');" style="">  87      // minSideLength long. If that&#x27;s not possible, return 1.                                                      </span>
<span class="-601503493775244190" onmouseenter="enter('-601503493775244190');" onmouseout="out('-601503493775244190');" style="">  88      public static int computeSampleSizeLarger(int w, int h,                                                       </span>
<span class="-6821687715082164263" onmouseenter="enter('-6821687715082164263');" onmouseout="out('-6821687715082164263');" style="">  89              int minSideLength) {                                                                                  </span>
<span class="-2047337129560331180" onmouseenter="enter('-2047337129560331180');" onmouseout="out('-2047337129560331180');" style="">  90          int initialSize = Math.max(w / minSideLength, h / minSideLength);                                         </span>



<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style="">  91          if (initialSize &lt;= 1) return 1;                                                                           </span>
<span  style="">  92                                                                                                                    </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style="">  93          return initialSize &lt;= 8                                                                                   </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style="">  94                  ? Utils.prevPowerOf2(initialSize)                                                                 </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style="">  95                  : initialSize / 8 * 8;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="6239105433849215903" onmouseenter="enter('6239105433849215903');" onmouseout="out('6239105433849215903');" style="">  98      // Find the min x that 1 / x &gt;= scale                                                                         </span>
<span class="116580642837046126" onmouseenter="enter('116580642837046126');" onmouseout="out('116580642837046126');" style="">  99      public static int computeSampleSizeLarger(float scale) {                                                      </span>
<span class="2577377926519885209" onmouseenter="enter('2577377926519885209');" onmouseout="out('2577377926519885209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -        int initialSize = (int) FloatMath.floor(1f / scale);                                                      </span>
<span class="883892556015604724" onmouseenter="enter('883892556015604724');" onmouseout="out('883892556015604724');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 101 +        int initialSize = (int) Math.floor(1f / scale);                                                           </span>
<span class="-5986004106066303787" onmouseenter="enter('-5986004106066303787');" onmouseout="out('-5986004106066303787');" style=""> 102          if (initialSize &lt;= 1) return 1;                                                                           </span>
<span  style=""> 103                                                                                                                    </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style=""> 104          return initialSize &lt;= 8                                                                                   </span>
<span class="-437727556806033684" onmouseenter="enter('-437727556806033684');" onmouseout="out('-437727556806033684');" style=""> 105                  ? Utils.prevPowerOf2(initialSize)                                                                 </span>
<span class="7606210335178272112" onmouseenter="enter('7606210335178272112');" onmouseout="out('7606210335178272112');" style=""> 106                  : initialSize / 8 * 8;                                                                            </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107      }                                                                                                             </span>
<span  style=""> 108                                                                                                                    </span>
<span class="-6681098284378983876" onmouseenter="enter('-6681098284378983876');" onmouseout="out('-6681098284378983876');" style=""> 109      // Find the max x that 1 / x &lt;= scale.                                                                        </span>
<span class="4757052090045600871" onmouseenter="enter('4757052090045600871');" onmouseout="out('4757052090045600871');" style=""> 110      public static int computeSampleSize(float scale) {                                                            </span>
<span class="-328275309662330726" onmouseenter="enter('-328275309662330726');" onmouseout="out('-328275309662330726');" style=""> 111          Utils.assertTrue(scale &gt; 0);                                                                              </span>
<span class="-8752772725969860209" onmouseenter="enter('-8752772725969860209');" onmouseout="out('-8752772725969860209');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 112 -        int initialSize = Math.max(1, (int) FloatMath.ceil(1 / scale));                                           </span>
<span class="1387480855759456316" onmouseenter="enter('1387480855759456316');" onmouseout="out('1387480855759456316');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 113 +        int initialSize = Math.max(1, (int) Math.ceil(1 / scale));                                                </span>
<span class="3753303704396694530" onmouseenter="enter('3753303704396694530');" onmouseout="out('3753303704396694530');" style=""> 114          return initialSize &lt;= 8                                                                                   </span>
<span class="8465200720200813682" onmouseenter="enter('8465200720200813682');" onmouseout="out('8465200720200813682');" style=""> 115                  ? Utils.nextPowerOf2(initialSize)                                                                 </span>
<span class="5107087872846431273" onmouseenter="enter('5107087872846431273');" onmouseout="out('5107087872846431273');" style=""> 116                  : (initialSize + 7) / 8 * 8;                                                                      </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117      }                                                                                                             </span>
<span  style=""> 118                                                                                                                    </span>
<span class="3091185289403374626" onmouseenter="enter('3091185289403374626');" onmouseout="out('3091185289403374626');" style=""> 119      public static Bitmap resizeBitmapByScale(                                                                     </span>
<span class="4831782962278267455" onmouseenter="enter('4831782962278267455');" onmouseout="out('4831782962278267455');" style=""> 120              Bitmap bitmap, float scale, boolean recycle) {                                                        </span>
<span class="-5756817497037142569" onmouseenter="enter('-5756817497037142569');" onmouseout="out('-5756817497037142569');" style=""> 121          int width = Math.round(bitmap.getWidth() * scale);                                                        </span>
<span class="3419813210601508568" onmouseenter="enter('3419813210601508568');" onmouseout="out('3419813210601508568');" style=""> 122          int height = Math.round(bitmap.getHeight() * scale);                                                      </span>
<span class="303533807179344519" onmouseenter="enter('303533807179344519');" onmouseout="out('303533807179344519');" style=""> 123          if (width == bitmap.getWidth()                                                                            </span>
<span class="-3589445165592385210" onmouseenter="enter('-3589445165592385210');" onmouseout="out('-3589445165592385210');" style=""> 124                  &amp;&amp; height == bitmap.getHeight()) return bitmap;                                                   </span>
<span class="-7306674282947456904" onmouseenter="enter('-7306674282947456904');" onmouseout="out('-7306674282947456904');" style=""> 125          Bitmap target = Bitmap.createBitmap(width, height, getConfig(bitmap));                                    </span>
<span class="-3692150631639784625" onmouseenter="enter('-3692150631639784625');" onmouseout="out('-3692150631639784625');" style=""> 126          Canvas canvas = new Canvas(target);                                                                       </span>
<span class="3217099220325300661" onmouseenter="enter('3217099220325300661');" onmouseout="out('3217099220325300661');" style=""> 127          canvas.scale(scale, scale);                                                                               </span>
<span class="2013858014721095122" onmouseenter="enter('2013858014721095122');" onmouseout="out('2013858014721095122');" style=""> 128          Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG | Paint.DITHER_FLAG);                                    </span>
<span class="4288326217758543884" onmouseenter="enter('4288326217758543884');" onmouseout="out('4288326217758543884');" style=""> 129          canvas.drawBitmap(bitmap, 0, 0, paint);                                                                   </span>
<span class="7474773097778997213" onmouseenter="enter('7474773097778997213');" onmouseout="out('7474773097778997213');" style=""> 130          if (recycle) bitmap.recycle();                                                                            </span>
<span class="-2959814168001159603" onmouseenter="enter('-2959814168001159603');" onmouseout="out('-2959814168001159603');" style=""> 131          return target;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 132      }                                                                                                             </span>
<span  style=""> 133                                                                                                                    </span>
<span class="-2049346337119747307" onmouseenter="enter('-2049346337119747307');" onmouseout="out('-2049346337119747307');" style=""> 134      private static Bitmap.Config getConfig(Bitmap bitmap) {                                                       </span>
<span class="3101150733112471087" onmouseenter="enter('3101150733112471087');" onmouseout="out('3101150733112471087');" style=""> 135          Bitmap.Config config = bitmap.getConfig();                                                                </span>
<span class="-4614138539221537761" onmouseenter="enter('-4614138539221537761');" onmouseout="out('-4614138539221537761');" style=""> 136          if (config == null) {                                                                                     </span>
<span class="2896443648738077651" onmouseenter="enter('2896443648738077651');" onmouseout="out('2896443648738077651');" style=""> 137              config = Bitmap.Config.ARGB_8888;                                                                     </span>


























<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138          }                                                                                                         </span>
<span class="1511137489476012941" onmouseenter="enter('1511137489476012941');" onmouseout="out('1511137489476012941');" style=""> 139          return config;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 140      }                                                                                                             </span>
<span  style=""> 141                                                                                                                    </span>
<span class="6753405047756417955" onmouseenter="enter('6753405047756417955');" onmouseout="out('6753405047756417955');" style=""> 142      public static Bitmap resizeDownBySideLength(                                                                  </span>
<span class="8112155692535193680" onmouseenter="enter('8112155692535193680');" onmouseout="out('8112155692535193680');" style=""> 143              Bitmap bitmap, int maxLength, boolean recycle) {                                                      </span>
<span class="1236066190776078207" onmouseenter="enter('1236066190776078207');" onmouseout="out('1236066190776078207');" style=""> 144          int srcWidth = bitmap.getWidth();                                                                         </span>
<span class="-8855508668956682981" onmouseenter="enter('-8855508668956682981');" onmouseout="out('-8855508668956682981');" style=""> 145          int srcHeight = bitmap.getHeight();                                                                       </span>
<span class="4829228751871420725" onmouseenter="enter('4829228751871420725');" onmouseout="out('4829228751871420725');" style=""> 146          float scale = Math.min(                                                                                   </span>
<span class="3785768231827879013" onmouseenter="enter('3785768231827879013');" onmouseout="out('3785768231827879013');" style=""> 147                  (float) maxLength / srcWidth, (float) maxLength / srcHeight);                                     </span>
<span class="-1755224370009475234" onmouseenter="enter('-1755224370009475234');" onmouseout="out('-1755224370009475234');" style=""> 148          if (scale &gt;= 1.0f) return bitmap;                                                                         </span>
<span class="9117340797061901273" onmouseenter="enter('9117340797061901273');" onmouseout="out('9117340797061901273');" style=""> 149          return resizeBitmapByScale(bitmap, scale, recycle);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 150      }                                                                                                             </span>
<span  style=""> 151                                                                                                                    </span>
<span class="-7702454016646558852" onmouseenter="enter('-7702454016646558852');" onmouseout="out('-7702454016646558852');" style=""> 152      public static Bitmap resizeAndCropCenter(Bitmap bitmap, int size, boolean recycle) {                          </span>
<span class="-2475479251052670336" onmouseenter="enter('-2475479251052670336');" onmouseout="out('-2475479251052670336');" style=""> 153          int w = bitmap.getWidth();                                                                                </span>
<span class="4864488801953676979" onmouseenter="enter('4864488801953676979');" onmouseout="out('4864488801953676979');" style=""> 154          int h = bitmap.getHeight();                                                                               </span>
<span class="-8898883601662174720" onmouseenter="enter('-8898883601662174720');" onmouseout="out('-8898883601662174720');" style=""> 155          if (w == size &amp;&amp; h == size) return bitmap;                                                                </span>
<span  style=""> 156                                                                                                                    </span>
<span class="1456858405684362729" onmouseenter="enter('1456858405684362729');" onmouseout="out('1456858405684362729');" style=""> 157          // scale the image so that the shorter side equals to the target;                                         </span>
<span class="-7442578123742108142" onmouseenter="enter('-7442578123742108142');" onmouseout="out('-7442578123742108142');" style=""> 158          // the longer side will be center-cropped.                                                                </span>
<span class="7675276868082726676" onmouseenter="enter('7675276868082726676');" onmouseout="out('7675276868082726676');" style=""> 159          float scale = (float) size / Math.min(w,  h);                                                             </span>
<span  style=""> 160                                                                                                                    </span>
<span class="-4965559157399986010" onmouseenter="enter('-4965559157399986010');" onmouseout="out('-4965559157399986010');" style=""> 161          Bitmap target = Bitmap.createBitmap(size, size, getConfig(bitmap));                                       </span>
<span class="8870373666161503235" onmouseenter="enter('8870373666161503235');" onmouseout="out('8870373666161503235');" style=""> 162          int width = Math.round(scale * bitmap.getWidth());                                                        </span>
<span class="2825422717690467926" onmouseenter="enter('2825422717690467926');" onmouseout="out('2825422717690467926');" style=""> 163          int height = Math.round(scale * bitmap.getHeight());                                                      </span>
<span class="-3692150631639784625" onmouseenter="enter('-3692150631639784625');" onmouseout="out('-3692150631639784625');" style=""> 164          Canvas canvas = new Canvas(target);                                                                       </span>
<span class="6225364946919426121" onmouseenter="enter('6225364946919426121');" onmouseout="out('6225364946919426121');" style=""> 165          canvas.translate((size - width) / 2f, (size - height) / 2f);                                              </span>
<span class="3217099220325300661" onmouseenter="enter('3217099220325300661');" onmouseout="out('3217099220325300661');" style=""> 166          canvas.scale(scale, scale);                                                                               </span>
<span class="2013858014721095122" onmouseenter="enter('2013858014721095122');" onmouseout="out('2013858014721095122');" style=""> 167          Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG | Paint.DITHER_FLAG);                                    </span>
<span class="4288326217758543884" onmouseenter="enter('4288326217758543884');" onmouseout="out('4288326217758543884');" style=""> 168          canvas.drawBitmap(bitmap, 0, 0, paint);                                                                   </span>
<span class="7474773097778997213" onmouseenter="enter('7474773097778997213');" onmouseout="out('7474773097778997213');" style=""> 169          if (recycle) bitmap.recycle();                                                                            </span>
<span class="-2959814168001159603" onmouseenter="enter('-2959814168001159603');" onmouseout="out('-2959814168001159603');" style=""> 170          return target;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171      }                                                                                                             </span>
<span  style=""> 172                                                                                                                    </span>
<span class="8988468418297173665" onmouseenter="enter('8988468418297173665');" onmouseout="out('8988468418297173665');" style=""> 173      public static void recycleSilently(Bitmap bitmap) {                                                           </span>
<span class="6414298760516754988" onmouseenter="enter('6414298760516754988');" onmouseout="out('6414298760516754988');" style=""> 174          if (bitmap == null) return;                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 175          try {                                                                                                     </span>
<span class="-2094673185475372498" onmouseenter="enter('-2094673185475372498');" onmouseout="out('-2094673185475372498');" style=""> 176              bitmap.recycle();                                                                                     </span>
<span class="-8603286158505252436" onmouseenter="enter('-8603286158505252436');" onmouseout="out('-8603286158505252436');" style=""> 177          } catch (Throwable t) {                                                                                   </span>
<span class="8927077538568292539" onmouseenter="enter('8927077538568292539');" onmouseout="out('8927077538568292539');" style=""> 178              Log.w(TAG, &quot;unable recycle bitmap&quot;, t);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180      }                                                                                                             </span>
<span  style=""> 181                                                                                                                    </span>
<span class="-218838256635917969" onmouseenter="enter('-218838256635917969');" onmouseout="out('-218838256635917969');" style=""> 182      public static Bitmap rotateBitmap(Bitmap source, int rotation, boolean recycle) {                             </span>
<span class="-6165464536073181139" onmouseenter="enter('-6165464536073181139');" onmouseout="out('-6165464536073181139');" style=""> 183          if (rotation == 0) return source;                                                                         </span>
<span class="1566843812967469550" onmouseenter="enter('1566843812967469550');" onmouseout="out('1566843812967469550');" style=""> 184          int w = source.getWidth();                                                                                </span>
<span class="7454284054558192870" onmouseenter="enter('7454284054558192870');" onmouseout="out('7454284054558192870');" style=""> 185          int h = source.getHeight();                                                                               </span>
<span class="247367293182567826" onmouseenter="enter('247367293182567826');" onmouseout="out('247367293182567826');" style=""> 186          Matrix m = new Matrix();                                                                                  </span>
<span class="3139056768063005906" onmouseenter="enter('3139056768063005906');" onmouseout="out('3139056768063005906');" style=""> 187          m.postRotate(rotation);                                                                                   </span>
<span class="1353388874546501571" onmouseenter="enter('1353388874546501571');" onmouseout="out('1353388874546501571');" style=""> 188          Bitmap bitmap = Bitmap.createBitmap(source, 0, 0, w, h, m, true);                                         </span>
<span class="-1908412012804651245" onmouseenter="enter('-1908412012804651245');" onmouseout="out('-1908412012804651245');" style=""> 189          if (recycle) source.recycle();                                                                            </span>
<span class="-2669835381987628663" onmouseenter="enter('-2669835381987628663');" onmouseout="out('-2669835381987628663');" style=""> 190          return bitmap;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191      }                                                                                                             </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-578628038334033218" onmouseenter="enter('-578628038334033218');" onmouseout="out('-578628038334033218');" style=""> 193      public static Bitmap createVideoThumbnail(String filePath) {                                                  </span>
<span class="7922657396587633319" onmouseenter="enter('7922657396587633319');" onmouseout="out('7922657396587633319');" style=""> 194          // MediaMetadataRetriever is available on API Level 8                                                     </span>
<span class="-627976963858968214" onmouseenter="enter('-627976963858968214');" onmouseout="out('-627976963858968214');" style=""> 195          // but is hidden until API Level 10                                                                       </span>
<span class="-6715415270183450311" onmouseenter="enter('-6715415270183450311');" onmouseout="out('-6715415270183450311');" style=""> 196          Class&lt;?&gt; clazz = null;                                                                                    </span>
<span class="7241294395934322955" onmouseenter="enter('7241294395934322955');" onmouseout="out('7241294395934322955');" style=""> 197          Object instance = null;                                                                                   </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 198          try {                                                                                                     </span>
<span class="2213641619944118764" onmouseenter="enter('2213641619944118764');" onmouseout="out('2213641619944118764');" style=""> 199              clazz = Class.forName(&quot;android.media.MediaMetadataRetriever&quot;);                                        </span>
<span class="7375470152628205833" onmouseenter="enter('7375470152628205833');" onmouseout="out('7375470152628205833');" style=""> 200              instance = clazz.newInstance();                                                                       </span>
<span  style=""> 201                                                                                                                    </span>
<span class="-5271594396134918193" onmouseenter="enter('-5271594396134918193');" onmouseout="out('-5271594396134918193');" style=""> 202              Method method = clazz.getMethod(&quot;setDataSource&quot;, String.class);                                       </span>
<span class="-3293239081802691097" onmouseenter="enter('-3293239081802691097');" onmouseout="out('-3293239081802691097');" style=""> 203              method.invoke(instance, filePath);                                                                    </span>
<span  style=""> 204                                                                                                                    </span>
<span class="2264746674321546694" onmouseenter="enter('2264746674321546694');" onmouseout="out('2264746674321546694');" style=""> 205              // The method name changes between API Level 9 and 10.                                                </span>
<span class="-4862876494596076993" onmouseenter="enter('-4862876494596076993');" onmouseout="out('-4862876494596076993');" style=""> 206              if (Build.VERSION.SDK_INT &lt;= 9) {                                                                     </span>
<span class="-4497570131557843222" onmouseenter="enter('-4497570131557843222');" onmouseout="out('-4497570131557843222');" style=""> 207                  return (Bitmap) clazz.getMethod(&quot;captureFrame&quot;).invoke(instance);                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 208              } else {                                                                                              </span>
<span class="5510576414050118008" onmouseenter="enter('5510576414050118008');" onmouseout="out('5510576414050118008');" style=""> 209                  byte[] data = (byte[]) clazz.getMethod(&quot;getEmbeddedPicture&quot;).invoke(instance);                    </span>
<span class="8818251485791898564" onmouseenter="enter('8818251485791898564');" onmouseout="out('8818251485791898564');" style=""> 210                  if (data != null) {                                                                               </span>
<span class="3742629447589554063" onmouseenter="enter('3742629447589554063');" onmouseout="out('3742629447589554063');" style=""> 211                      Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length);                          </span>
<span class="-371148499467227168" onmouseenter="enter('-371148499467227168');" onmouseout="out('-371148499467227168');" style=""> 212                      if (bitmap != null) return bitmap;                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213                  }                                                                                                 </span>
<span class="7649001076389340306" onmouseenter="enter('7649001076389340306');" onmouseout="out('7649001076389340306');" style=""> 214                  return (Bitmap) clazz.getMethod(&quot;getFrameAtTime&quot;).invoke(instance);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215              }                                                                                                     </span>
<span class="5301700888569482864" onmouseenter="enter('5301700888569482864');" onmouseout="out('5301700888569482864');" style=""> 216          } catch (IllegalArgumentException ex) {                                                                   </span>
<span class="-4680445030937730839" onmouseenter="enter('-4680445030937730839');" onmouseout="out('-4680445030937730839');" style=""> 217              // Assume this is a corrupt video file                                                                </span>
<span class="3255801419413274971" onmouseenter="enter('3255801419413274971');" onmouseout="out('3255801419413274971');" style=""> 218          } catch (RuntimeException ex) {                                                                           </span>
<span class="74521425252002816" onmouseenter="enter('74521425252002816');" onmouseout="out('74521425252002816');" style=""> 219              // Assume this is a corrupt video file.                                                               </span>
<span class="6243028624057522413" onmouseenter="enter('6243028624057522413');" onmouseout="out('6243028624057522413');" style=""> 220          } catch (InstantiationException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style=""> 221              Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-291101072954915259" onmouseenter="enter('-291101072954915259');" onmouseout="out('-291101072954915259');" style=""> 222          } catch (InvocationTargetException e) {                                                                   </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style=""> 223              Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="1054888787890391626" onmouseenter="enter('1054888787890391626');" onmouseout="out('1054888787890391626');" style=""> 224          } catch (ClassNotFoundException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style=""> 225              Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-4617077893838138158" onmouseenter="enter('-4617077893838138158');" onmouseout="out('-4617077893838138158');" style=""> 226          } catch (NoSuchMethodException e) {                                                                       </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style=""> 227              Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="-4283655124212124805" onmouseenter="enter('-4283655124212124805');" onmouseout="out('-4283655124212124805');" style=""> 228          } catch (IllegalAccessException e) {                                                                      </span>
<span class="665212567098608878" onmouseenter="enter('665212567098608878');" onmouseout="out('665212567098608878');" style=""> 229              Log.e(TAG, &quot;createVideoThumbnail&quot;, e);                                                                </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 230          } finally {                                                                                               </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 231              try {                                                                                                 </span>
<span class="579147444735564891" onmouseenter="enter('579147444735564891');" onmouseout="out('579147444735564891');" style=""> 232                  if (instance != null) {                                                                           </span>
<span class="-1978271112408209287" onmouseenter="enter('-1978271112408209287');" onmouseout="out('-1978271112408209287');" style=""> 233                      clazz.getMethod(&quot;release&quot;).invoke(instance);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 234                  }                                                                                                 </span>
<span class="8538742657781196138" onmouseenter="enter('8538742657781196138');" onmouseout="out('8538742657781196138');" style=""> 235              } catch (Exception ignored) {                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237          }                                                                                                         </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 238          return null;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239      }                                                                                                             </span>
<span  style=""> 240                                                                                                                    </span>
<span class="-3037994906685046990" onmouseenter="enter('-3037994906685046990');" onmouseout="out('-3037994906685046990');" style=""> 241      public static byte[] compressToBytes(Bitmap bitmap) {                                                         </span>
<span class="8154759637764213993" onmouseenter="enter('8154759637764213993');" onmouseout="out('8154759637764213993');" style=""> 242          return compressToBytes(bitmap, DEFAULT_JPEG_QUALITY);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243      }                                                                                                             </span>
<span  style=""> 244                                                                                                                    </span>
<span class="1030270861855538274" onmouseenter="enter('1030270861855538274');" onmouseout="out('1030270861855538274');" style=""> 245      public static byte[] compressToBytes(Bitmap bitmap, int quality) {                                            </span>
<span class="-7691639136163286190" onmouseenter="enter('-7691639136163286190');" onmouseout="out('-7691639136163286190');" style=""> 246          ByteArrayOutputStream baos = new ByteArrayOutputStream(65536);                                            </span>
<span class="-8799862925650220911" onmouseenter="enter('-8799862925650220911');" onmouseout="out('-8799862925650220911');" style=""> 247          bitmap.compress(CompressFormat.JPEG, quality, baos);                                                      </span>
<span class="-79689795365024547" onmouseenter="enter('-79689795365024547');" onmouseout="out('-79689795365024547');" style=""> 248          return baos.toByteArray();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249      }                                                                                                             </span>
<span  style=""> 250                                                                                                                    </span>
<span class="-4883654258312344942" onmouseenter="enter('-4883654258312344942');" onmouseout="out('-4883654258312344942');" style=""> 251      public static boolean isSupportedByRegionDecoder(String mimeType) {                                           </span>
<span class="-5522020421405306924" onmouseenter="enter('-5522020421405306924');" onmouseout="out('-5522020421405306924');" style=""> 252          if (mimeType == null) return false;                                                                       </span>
<span class="2553519890327140378" onmouseenter="enter('2553519890327140378');" onmouseout="out('2553519890327140378');" style=""> 253          mimeType = mimeType.toLowerCase();                                                                        </span>
<span class="-4756927242968839153" onmouseenter="enter('-4756927242968839153');" onmouseout="out('-4756927242968839153');" style=""> 254          return mimeType.startsWith(&quot;image/&quot;) &amp;&amp;                                                                   </span>
<span class="3826629459903750807" onmouseenter="enter('3826629459903750807');" onmouseout="out('3826629459903750807');" style=""> 255                  (!mimeType.equals(&quot;image/gif&quot;) &amp;&amp; !mimeType.endsWith(&quot;bmp&quot;));                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256      }                                                                                                             </span>
<span  style=""> 257                                                                                                                    </span>
<span class="-4484782655407848181" onmouseenter="enter('-4484782655407848181');" onmouseout="out('-4484782655407848181');" style=""> 258      public static boolean isRotationSupported(String mimeType) {                                                  </span>
<span class="-5522020421405306924" onmouseenter="enter('-5522020421405306924');" onmouseout="out('-5522020421405306924');" style=""> 259          if (mimeType == null) return false;                                                                       </span>
<span class="2553519890327140378" onmouseenter="enter('2553519890327140378');" onmouseout="out('2553519890327140378');" style=""> 260          mimeType = mimeType.toLowerCase();                                                                        </span>
<span class="-8952449944828140254" onmouseenter="enter('-8952449944828140254');" onmouseout="out('-8952449944828140254');" style=""> 261          return mimeType.equals(&quot;image/jpeg&quot;);                                                                     </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            