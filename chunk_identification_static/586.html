<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>586</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    586
                    <a href="585.html">prev</a>
                    <a href="587.html">next</a>
                    <a href="586_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_f05e92b15d5e4c94442e53a9f83e2659c369aa5e_cassandra/cassandra-side/cassandra-async-side/src/main/java/com/dtstack/flink/sql/side/cassandra/CassandraAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e:cassandra/cassandra-side/cassandra-async-side/src/main/java/com/dtstack/flink/sql/side/cassandra/CassandraAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^1:cassandra/cassandra-side/cassandra-async-side/src/main/java/com/dtstack/flink/sql/side/cassandra/CassandraAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;f05e92b15d5e4c94442e53a9f83e2659c369aa5e^2:cassandra/cassandra-side/cassandra-async-side/src/main/java/com/dtstack/flink/sql/side/cassandra/CassandraAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;14446f4dd844b1bb9da6c412e3556e135bafcba4:cassandra/cassandra-side/cassandra-async-side/src/main/java/com/dtstack/flink/sql/side/cassandra/CassandraAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [j]], subset: [[b], [j]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-167599954638689123" onmouseenter="enter('-167599954638689123');" onmouseout="out('-167599954638689123');" style="">  20 package com.dtstack.flink.sql.side.cassandra;                                                            </span>
<span  style="">  21                                                                                                          </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  25 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  26 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  28                                                                                                          </span>
<span class="-4674624431842718354" onmouseenter="enter('-4674624431842718354');" onmouseout="out('-4674624431842718354');" style="">  29 import com.datastax.driver.core.Cluster;                                                                 </span>
<span class="4630389600773953361" onmouseenter="enter('4630389600773953361');" onmouseout="out('4630389600773953361');" style="">  30 import com.datastax.driver.core.ConsistencyLevel;                                                        </span>
<span class="-5077913371267042181" onmouseenter="enter('-5077913371267042181');" onmouseout="out('-5077913371267042181');" style="">  31 import com.datastax.driver.core.HostDistance;                                                            </span>
<span class="-8460078615292194921" onmouseenter="enter('-8460078615292194921');" onmouseout="out('-8460078615292194921');" style="">  32 import com.datastax.driver.core.PoolingOptions;                                                          </span>
<span class="3500480560938999402" onmouseenter="enter('3500480560938999402');" onmouseout="out('3500480560938999402');" style="">  33 import com.datastax.driver.core.QueryOptions;                                                            </span>
<span class="1295458347604392536" onmouseenter="enter('1295458347604392536');" onmouseout="out('1295458347604392536');" style="">  34 import com.datastax.driver.core.ResultSet;                                                               </span>
<span class="-2921924295373051715" onmouseenter="enter('-2921924295373051715');" onmouseout="out('-2921924295373051715');" style="">  35 import com.datastax.driver.core.Session;                                                                 </span>
<span class="7536185860942072783" onmouseenter="enter('7536185860942072783');" onmouseout="out('7536185860942072783');" style="">  36 import com.datastax.driver.core.SocketOptions;                                                           </span>
<span class="102554056665873953" onmouseenter="enter('102554056665873953');" onmouseout="out('102554056665873953');" style="">  37 import com.datastax.driver.core.policies.DowngradingConsistencyRetryPolicy;                              </span>
<span class="384780421342561763" onmouseenter="enter('384780421342561763');" onmouseout="out('384780421342561763');" style="">  38 import com.datastax.driver.core.policies.RetryPolicy;                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  39 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  40 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  41 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  42 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  43 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  44 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  45 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="1325017007675469198" onmouseenter="enter('1325017007675469198');" onmouseout="out('1325017007675469198');" style="">  46 import com.dtstack.flink.sql.side.cassandra.table.CassandraSideTableInfo;                                </span>
<span class="-8710273414755433249" onmouseenter="enter('-8710273414755433249');" onmouseout="out('-8710273414755433249');" style="">  47 import com.google.common.base.Function;                                                                  </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  48 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4265236954961374581" onmouseenter="enter('-4265236954961374581');" onmouseout="out('-4265236954961374581');" style="">  49 import com.google.common.util.concurrent.AsyncFunction;                                                  </span>
<span class="3392144801777607486" onmouseenter="enter('3392144801777607486');" onmouseout="out('3392144801777607486');" style="">  50 import com.google.common.util.concurrent.FutureCallback;                                                 </span>
<span class="-3207866063314364212" onmouseenter="enter('-3207866063314364212');" onmouseout="out('-3207866063314364212');" style="">  51 import com.google.common.util.concurrent.Futures;                                                        </span>
<span class="2803111898123627106" onmouseenter="enter('2803111898123627106');" onmouseout="out('2803111898123627106');" style="">  52 import com.google.common.util.concurrent.ListenableFuture;                                               </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  53 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  54 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  57                                                                                                          </span>
<span class="-5790770097715703577" onmouseenter="enter('-5790770097715703577');" onmouseout="out('-5790770097715703577');" style="">  58 import java.net.InetAddress;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  59 import java.sql.Timestamp;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60 import java.util.ArrayList;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  61 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  62 import java.util.Map;                                                                                    </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  65  * Reason:                                                                                               </span>
<span class="-6869475929847104911" onmouseenter="enter('-6869475929847104911');" onmouseout="out('-6869475929847104911');" style="">  66  * Date: 2018/11/22                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67  *                                                                                                       </span>
<span class="-3762428130562648" onmouseenter="enter('-3762428130562648');" onmouseout="out('-3762428130562648');" style="">  68  * @author xuqianjin                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69  */                                                                                                      </span>
<span class="-137893776588311003" onmouseenter="enter('-137893776588311003');" onmouseout="out('-137893776588311003');" style="">  70 public class CassandraAsyncReqRow extends BaseAsyncReqRow {                                              </span>
<span  style="">  71                                                                                                          </span>
<span class="-474972292974325668" onmouseenter="enter('-474972292974325668');" onmouseout="out('-474972292974325668');" style="">  72     private static final long serialVersionUID = 6631584128079864735L;                                   </span>
<span  style="">  73                                                                                                          </span>
<span class="-8305758559523834163" onmouseenter="enter('-8305758559523834163');" onmouseout="out('-8305758559523834163');" style="">  74     private static final Logger LOG = LoggerFactory.getLogger(CassandraAsyncReqRow.class);               </span>
<span  style="">  75                                                                                                          </span>
<span class="-4149057034501610834" onmouseenter="enter('-4149057034501610834');" onmouseout="out('-4149057034501610834');" style="">  76     private final static int DEFAULT_VERTX_EVENT_LOOP_POOL_SIZE = 10;                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="-4781889690315923879" onmouseenter="enter('-4781889690315923879');" onmouseout="out('-4781889690315923879');" style="">  78     private final static int DEFAULT_VERTX_WORKER_POOL_SIZE = 20;                                        </span>
<span  style="">  79                                                                                                          </span>
<span class="8731062638120855225" onmouseenter="enter('8731062638120855225');" onmouseout="out('8731062638120855225');" style="">  80     private final static int DEFAULT_MAX_DB_CONN_POOL_SIZE = 20;                                         </span>
<span  style="">  81                                                                                                          </span>
<span class="-5403177446568963001" onmouseenter="enter('-5403177446568963001');" onmouseout="out('-5403177446568963001');" style="">  82     private transient Cluster cluster;                                                                   </span>
<span class="-8047386482861852310" onmouseenter="enter('-8047386482861852310');" onmouseout="out('-8047386482861852310');" style="">  83     private transient ListenableFuture session;                                                          </span>
<span class="-1659440015873934350" onmouseenter="enter('-1659440015873934350');" onmouseout="out('-1659440015873934350');" style="">  84     private transient CassandraSideTableInfo cassandraSideTableInfo;                                     </span>
<span  style="">  85                                                                                                          </span>
<span class="8250235661803572167" onmouseenter="enter('8250235661803572167');" onmouseout="out('8250235661803572167');" style=""><abbr title="  86     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  86     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoL🔵</abbr></span>
<span class="2131899768365277438" onmouseenter="enter('2131899768365277438');" onmouseout="out('2131899768365277438');" style=""><abbr title="  87         super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));">  87         super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outF🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88     }                                                                                                    </span>
<span  style="">  89                                                                                                          </span>
<span  style="">  90                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  92     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  93         super.open(parameters);                                                                          </span>
<span class="-5020317085273715278" onmouseenter="enter('-5020317085273715278');" onmouseout="out('-5020317085273715278');" style="">  94         cassandraSideTableInfo = (CassandraSideTableInfo) sideInfo.getSideTableInfo();                   </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="">  95         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="2688225595233570188" onmouseenter="enter('2688225595233570188');" onmouseout="out('2688225595233570188');" style="">  98     private void connCassandraDB(CassandraSideTableInfo tableInfo) {                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  99         try {                                                                                            </span>
<span class="417819926325380348" onmouseenter="enter('417819926325380348');" onmouseout="out('417819926325380348');" style=""> 100             if (session == null) {                                                                       </span>
<span class="-3605639280329188999" onmouseenter="enter('-3605639280329188999');" onmouseout="out('-3605639280329188999');" style=""> 101                 QueryOptions queryOptions = new QueryOptions();                                          </span>
<span class="5842973418300621663" onmouseenter="enter('5842973418300621663');" onmouseout="out('5842973418300621663');" style=""> 102                 //The default consistency level for queries: ConsistencyLevel.TWO.                       </span>
<span class="76010926262385906" onmouseenter="enter('76010926262385906');" onmouseout="out('76010926262385906');" style=""> 103                 queryOptions.setConsistencyLevel(ConsistencyLevel.QUORUM);                               </span>
<span class="-4388406259332422062" onmouseenter="enter('-4388406259332422062');" onmouseout="out('-4388406259332422062');" style=""><abbr title=" 104                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo.getMaxRequestsPerConnection();"> 104                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : 🔵</abbr></span>
<span class="-6698153752588261803" onmouseenter="enter('-6698153752588261803');" onmouseout="out('-6698153752588261803');" style=""><abbr title=" 105                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.getCoreConnectionsPerHost();"> 105                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tabl🔵</abbr></span>
<span class="3809961524454958986" onmouseenter="enter('3809961524454958986');" onmouseout="out('3809961524454958986');" style=""><abbr title=" 106                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.getMaxConnectionsPerHost();"> 106                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : ta🔵</abbr></span>
<span class="-3297929912963114654" onmouseenter="enter('-3297929912963114654');" onmouseout="out('-3297929912963114654');" style=""><abbr title=" 107                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQueueSize();"> 107                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQue🔵</abbr></span>
<span class="-1822015680936096661" onmouseenter="enter('-1822015680936096661');" onmouseout="out('-1822015680936096661');" style=""><abbr title=" 108                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTimeoutMillis();"> 108                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="5588349030185896717" onmouseenter="enter('5588349030185896717');" onmouseout="out('5588349030185896717');" style=""><abbr title=" 109                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.getConnectTimeoutMillis();"> 109                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tabl🔵</abbr></span>
<span class="5493190487826327243" onmouseenter="enter('5493190487826327243');" onmouseout="out('5493190487826327243');" style=""><abbr title=" 110                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTimeoutMillis();"> 110                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="-5259680847618191912" onmouseenter="enter('-5259680847618191912');" onmouseout="out('-5259680847618191912');" style=""> 111                 Integer cassandraPort = 0;                                                               </span>
<span class="-8848193911625825371" onmouseenter="enter('-8848193911625825371');" onmouseout="out('-8848193911625825371');" style=""> 112                 String address = tableInfo.getAddress();                                                 </span>
<span class="2950506038619853549" onmouseenter="enter('2950506038619853549');" onmouseout="out('2950506038619853549');" style=""> 113                 String userName = tableInfo.getUserName();                                               </span>
<span class="-4521409941966564293" onmouseenter="enter('-4521409941966564293');" onmouseout="out('-4521409941966564293');" style=""> 114                 String password = tableInfo.getPassword();                                               </span>
<span class="-6108815609943098672" onmouseenter="enter('-6108815609943098672');" onmouseout="out('-6108815609943098672');" style=""> 115                 String database = tableInfo.getDatabase();                                               </span>
<span  style=""> 116                                                                                                          </span>
<span class="6493913905304408918" onmouseenter="enter('6493913905304408918');" onmouseout="out('6493913905304408918');" style=""> 117                 ArrayList serversList = new ArrayList();                                                 </span>
<span class="5423738273364037419" onmouseenter="enter('5423738273364037419');" onmouseout="out('5423738273364037419');" style=""> 118                 //Read timeout or connection timeout Settings                                            </span>
<span class="-1651403584650918350" onmouseenter="enter('-1651403584650918350');" onmouseout="out('-1651403584650918350');" style=""> 119                 SocketOptions so = new SocketOptions()                                                   </span>
<span class="-6143815205992723671" onmouseenter="enter('-6143815205992723671');" onmouseout="out('-6143815205992723671');" style=""> 120                         .setReadTimeoutMillis(readTimeoutMillis)                                         </span>
<span class="-7477024419561329894" onmouseenter="enter('-7477024419561329894');" onmouseout="out('-7477024419561329894');" style=""> 121                         .setConnectTimeoutMillis(connectTimeoutMillis);                                  </span>
<span  style=""> 122                                                                                                          </span>
<span class="36776837264098679" onmouseenter="enter('36776837264098679');" onmouseout="out('36776837264098679');" style=""> 123                 //The cluster USES hostdistance.local in the same machine room                           </span>
<span class="-4067753854505755618" onmouseenter="enter('-4067753854505755618');" onmouseout="out('-4067753854505755618');" style=""> 124                 //Hostdistance. REMOTE is used for different machine rooms                               </span>
<span class="-1239540897477970915" onmouseenter="enter('-1239540897477970915');" onmouseout="out('-1239540897477970915');" style=""> 125                 //Ignore use HostDistance. IGNORED                                                       </span>
<span class="7507936330523201209" onmouseenter="enter('7507936330523201209');" onmouseout="out('7507936330523201209');" style=""> 126                 PoolingOptions poolingOptions = new PoolingOptions()                                     </span>
<span class="4173548347137079648" onmouseenter="enter('4173548347137079648');" onmouseout="out('4173548347137079648');" style=""> 127                         //Each connection allows a maximum of 64 concurrent requests                     </span>
<span class="6109267905237967219" onmouseenter="enter('6109267905237967219');" onmouseout="out('6109267905237967219');" style=""> 128                         .setMaxRequestsPerConnection(HostDistance.LOCAL, maxRequestsPerConnection)       </span>
<span class="-8245292782127165862" onmouseenter="enter('-8245292782127165862');" onmouseout="out('-8245292782127165862');" style=""> 129                         //Have at least two connections to each machine in the cluster                   </span>
<span class="7216166406224594146" onmouseenter="enter('7216166406224594146');" onmouseout="out('7216166406224594146');" style=""> 130                         .setCoreConnectionsPerHost(HostDistance.LOCAL, coreConnectionsPerHost)           </span>
<span class="-1358272374234048070" onmouseenter="enter('-1358272374234048070');" onmouseout="out('-1358272374234048070');" style=""> 131                         //There are up to eight connections to each machine in the cluster               </span>
<span class="-1698869078338541686" onmouseenter="enter('-1698869078338541686');" onmouseout="out('-1698869078338541686');" style=""> 132                         .setMaxConnectionsPerHost(HostDistance.LOCAL, maxConnectionsPerHost)             </span>
<span class="1548703418514968406" onmouseenter="enter('1548703418514968406');" onmouseout="out('1548703418514968406');" style=""> 133                         .setMaxQueueSize(maxQueueSize)                                                   </span>
<span class="3524981482635418824" onmouseenter="enter('3524981482635418824');" onmouseout="out('3524981482635418824');" style=""> 134                         .setPoolTimeoutMillis(poolTimeoutMillis);                                        </span>
<span class="-3027653360277295120" onmouseenter="enter('-3027653360277295120');" onmouseout="out('-3027653360277295120');" style=""> 135                 //重试策略                                                                                   </span>
<span class="-2500245183701794239" onmouseenter="enter('-2500245183701794239');" onmouseout="out('-2500245183701794239');" style=""> 136                 RetryPolicy retryPolicy = DowngradingConsistencyRetryPolicy.INSTANCE;                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="6634426984636856768" onmouseenter="enter('6634426984636856768');" onmouseout="out('6634426984636856768');" style=""> 138                 for (String server : StringUtils.split(address, &quot;,&quot;)) {                                  </span>
<span class="-4294448682063399613" onmouseenter="enter('-4294448682063399613');" onmouseout="out('-4294448682063399613');" style=""> 139                     cassandraPort = Integer.parseInt(StringUtils.split(server, &quot;:&quot;)[1]);                 </span>
<span class="7751295421103553875" onmouseenter="enter('7751295421103553875');" onmouseout="out('7751295421103553875');" style=""> 140                     serversList.add(InetAddress.getByName(StringUtils.split(server, &quot;:&quot;)[0]));           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141                 }                                                                                        </span>
<span  style=""> 142                                                                                                          </span>
<span class="3673717518338030181" onmouseenter="enter('3673717518338030181');" onmouseout="out('3673717518338030181');" style=""> 143                 if (userName == null || userName.isEmpty() || password == null || password.isEmpty()) {  </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 144                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 144                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 145                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 146                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 147                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 148                 } else {                                                                                 </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 149                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 149                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 150                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 151                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="-5038512354126172278" onmouseenter="enter('-5038512354126172278');" onmouseout="out('-5038512354126172278');" style=""> 152                             .withCredentials(userName, password)                                         </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 153                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                 }                                                                                        </span>
<span class="765464969334355038" onmouseenter="enter('765464969334355038');" onmouseout="out('765464969334355038');" style=""> 155                 // 建立连接 连接已存在的键空间                                                                        </span>
<span class="-6325263381803948308" onmouseenter="enter('-6325263381803948308');" onmouseout="out('-6325263381803948308');" style=""> 156                 session = cluster.connectAsync(database);                                                </span>
<span class="8518739044679915590" onmouseenter="enter('8518739044679915590');" onmouseout="out('8518739044679915590');" style=""> 157                 LOG.info(&quot;connect cassandra is successed!&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 159         } catch (Exception e) {                                                                          </span>
<span class="7191685386448857101" onmouseenter="enter('7191685386448857101');" onmouseout="out('7191685386448857101');" style=""> 160             LOG.error(&quot;connect cassandra is error:&quot; + e.getMessage());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 165     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 165     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span  style=""> 166                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 167         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style=""> 168         //connect Cassandra                                                                              </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style=""> 169         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span  style=""> 170                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 171 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="8882875172916837309" onmouseenter="enter('8882875172916837309');" onmouseout="out('8882875172916837309');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"><abbr title=" 172         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  ALLOW FILTERING &quot;;"> 172         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  AL🔵</abbr></span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 173 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-8402687189436648246" onmouseenter="enter('-8402687189436648246');" onmouseout="out('-8402687189436648246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174         for (int i = 0; i &lt; sideInfo.getEqualFieldList().size(); i++) {                                  </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176             Object equalObj = inputCopy.row().getField(conValIndex);                                     </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 178                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 179                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 180             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 181             inputParams.add(equalObj);                                                                   </span>
<span class="6844316250995394013" onmouseenter="enter('6844316250995394013');" onmouseout="out('6844316250995394013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 182             StringBuffer sqlTemp = stringBuffer.append(sideInfo.getEqualFieldList().get(i))              </span>
<span class="4506040730369527852" onmouseenter="enter('4506040730369527852');" onmouseout="out('4506040730369527852');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 183                     .append(&quot; = &quot;);                                                                      </span>
<span class="6706079886736437259" onmouseenter="enter('6706079886736437259');" onmouseout="out('6706079886736437259');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 184             if (equalObj instanceof String) {                                                            </span>
<span class="147067916336825508" onmouseenter="enter('147067916336825508');" onmouseout="out('147067916336825508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 185                 sqlTemp.append(&quot;&#x27;&quot; + equalObj + &quot;&#x27;&quot;)                                                     </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 186                         .append(&quot; and &quot;);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 187             } else {                                                                                     </span>
<span class="-2928507733810337143" onmouseenter="enter('-2928507733810337143');" onmouseout="out('-2928507733810337143');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 188                 sqlTemp.append(equalObj)                                                                 </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 189                         .append(&quot; and &quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 190             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 191                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 192         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 193                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 194         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-7558523756689931178" onmouseenter="enter('-7558523756689931178');" onmouseout="out('-7558523756689931178');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 195         sqlWhere = sqlWhere + stringBuffer.toString().substring(0, stringBuffer.lastIndexOf(&quot; and &quot;));   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 196                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 197         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 198             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 199             if (val != null) {                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 200                                                                                                          </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 201                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 202                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 203                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 204                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 205                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 206                     for (Object jsonArray : (List) val.getContent()) {                                   </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 207                         Row row = fillData(inputCopy.row(), jsonArray);                                  </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 208                         rowList.add(new CRow(row, inputCopy.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 209                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 210                     resultFuture.complete(rowList);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 211                 } else {                                                                                 </span>
<span class="-1323059185501153522" onmouseenter="enter('-1323059185501153522');" onmouseout="out('-1323059185501153522');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 212                     throw new RuntimeException(&quot;not support cache obj type &quot; + val.getType());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 213                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 214                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 215             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 216         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 217                                                                                                          </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 218         //connect Cassandra                                                                              </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 219         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 220                                                                                                          </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 221         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;        </span>
<span class="2890792881476289631" onmouseenter="enter('2890792881476289631');" onmouseout="out('2890792881476289631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 222         System.out.println(&quot;sqlCondition:&quot; + sqlCondition);                                              </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 223 =======                                                                                                  </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 224         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;        </span>
<span class="7235570087826307362" onmouseenter="enter('7235570087826307362');" onmouseout="out('7235570087826307362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 225         LOG.info(&quot;sqlCondition:{}&quot; + sqlCondition);                                                      </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 226 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 227                                                                                                          </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style=""> 228         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                          </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style=""> 229                 new AsyncFunction&lt;Session, ResultSet&gt;() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 230                     @Override                                                                            </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style=""> 231                     public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {         </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style=""> 232                         return session.executeAsync(sqlCondition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 234                 });                                                                                      </span>
<span  style=""> 235                                                                                                          </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style=""> 236         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,         </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style=""> 237                 new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 238                     @Override                                                                            </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style=""> 239                     public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                      </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style=""> 240                         return rs.all();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 242                 });                                                                                      </span>
<span  style=""> 243                                                                                                          </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style=""> 244         Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 245             @Override                                                                                    </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style=""> 246             public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 247                 cluster.closeAsync();                                                                    </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style=""> 248                 if (rows.size() &gt; 0) {                                                                   </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style=""> 249                     List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();              </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 250                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style=""> 251                     for (com.datastax.driver.core.Row line : rows) {                                     </span>
<span class="5316099920929274958" onmouseenter="enter('5316099920929274958');" onmouseout="out('5316099920929274958');" style=""> 252                         Row row = fillData(input.row(), line);                                           </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 253                         if (openCache()) {                                                               </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 254                             cacheContent.add(line);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                         }                                                                                </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 256                         rowList.add(new CRow(row, input.change()));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 258                     resultFuture.complete(rowList);                                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 259                     if (openCache()) {                                                                   </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 260                         putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 262                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 263                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 264                     if (openCache()) {                                                                   </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 265                         putCache(key, CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266                     }                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 267                     resultFuture.complete(null);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269             }                                                                                            </span>
<span  style=""> 270                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 271             @Override                                                                                    </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style=""> 272             public void onFailure(Throwable t) {                                                         </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style=""> 273                 LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                           </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style=""> 274                         t.getMessage());                                                                 </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 275                 cluster.closeAsync();                                                                    </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style=""> 276                 resultFuture.completeExceptionally(t);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 277             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 278         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 281     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 282     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 283         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 284         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style=""> 285             sb.append(ele.toString()).append(&quot;_&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 287         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288     }                                                                                                    </span>
<span  style=""> 289                                                                                                          </span>
<span class="-1821575284166957660" onmouseenter="enter('-1821575284166957660');" onmouseout="out('-1821575284166957660');" style=""> 290     private String buildWhereCondition(Map&lt;String, Object&gt; inputParams){                                 </span>
<span class="5090364847803370614" onmouseenter="enter('5090364847803370614');" onmouseout="out('5090364847803370614');" style=""> 291         StringBuilder sb = new StringBuilder(&quot; where &quot;);                                                 </span>
<span class="-7053571210782116126" onmouseenter="enter('-7053571210782116126');" onmouseout="out('-7053571210782116126');" style=""> 292         for(Map.Entry&lt;String, Object&gt; entry : inputParams.entrySet()){                                   </span>
<span class="-3077711825568802702" onmouseenter="enter('-3077711825568802702');" onmouseout="out('-3077711825568802702');" style=""><abbr title=" 293             Object value = entry.getValue() instanceof String ? &quot;&#x27;&quot; + entry.getValue() + &quot;&#x27;&quot; : entry.getValue();"> 293             Object value = entry.getValue() instanceof String ? &quot;&#x27;&quot; + entry.getValue() + &quot;&#x27;&quot; : entry.getV🔵</abbr></span>
<span class="-2126749103831887182" onmouseenter="enter('-2126749103831887182');" onmouseout="out('-2126749103831887182');" style=""> 294             sb.append(String.format(&quot;%s = %s&quot;, entry.getKey(), value));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 296         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297     }                                                                                                    </span>
<span  style=""> 298                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 299     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 300     public Row fillData(Row input, Object line) {                                                        </span>
<span class="-1556735922244622351" onmouseenter="enter('-1556735922244622351');" onmouseout="out('-1556735922244622351');" style=""> 301         com.datastax.driver.core.Row rowArray = (com.datastax.driver.core.Row) line;                     </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 302         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 303         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 304             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 305             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 305             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span  style=""> 306                                                                                                          </span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 307             if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 308                 obj = ((Timestamp) obj).getTime();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309             }                                                                                            </span>
<span  style=""> 310                                                                                                          </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 311             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312         }                                                                                                </span>
<span  style=""> 313                                                                                                          </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 314         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-844467095686898872" onmouseenter="enter('-844467095686898872');" onmouseout="out('-844467095686898872');" style=""> 315             if (rowArray == null) {                                                                      </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 316                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 317             } else {                                                                                     </span>
<span class="-7910331794290062112" onmouseenter="enter('-7910331794290062112');" onmouseout="out('-7910331794290062112');" style=""> 318                 row.setField(entry.getKey(), rowArray.getObject(entry.getValue()));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320         }                                                                                                </span>
<span  style=""> 321                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 322         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323     }                                                                                                    </span>
<span  style=""> 324                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 325     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 326     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 327         super.close();                                                                                   </span>
<span class="7236775322084046720" onmouseenter="enter('7236775322084046720');" onmouseout="out('7236775322084046720');" style=""> 328         if (cluster != null) {                                                                           </span>
<span class="-7802554339096083826" onmouseenter="enter('-7802554339096083826');" onmouseout="out('-7802554339096083826');" style=""> 329             cluster.close();                                                                             </span>
<span class="-8433337576020477133" onmouseenter="enter('-8433337576020477133');" onmouseout="out('-8433337576020477133');" style=""> 330             cluster = null;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333 }                                                                                                        </span>







































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span  style="">  19                                                                                                          </span>
<span class="-167599954638689123" onmouseenter="enter('-167599954638689123');" onmouseout="out('-167599954638689123');" style="">  20 package com.dtstack.flink.sql.side.cassandra;                                                            </span>
<span  style="">  21                                                                                                          </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  25 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  26 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  28                                                                                                          </span>
<span class="-4674624431842718354" onmouseenter="enter('-4674624431842718354');" onmouseout="out('-4674624431842718354');" style="">  29 import com.datastax.driver.core.Cluster;                                                                 </span>
<span class="4630389600773953361" onmouseenter="enter('4630389600773953361');" onmouseout="out('4630389600773953361');" style="">  30 import com.datastax.driver.core.ConsistencyLevel;                                                        </span>
<span class="-5077913371267042181" onmouseenter="enter('-5077913371267042181');" onmouseout="out('-5077913371267042181');" style="">  31 import com.datastax.driver.core.HostDistance;                                                            </span>
<span class="-8460078615292194921" onmouseenter="enter('-8460078615292194921');" onmouseout="out('-8460078615292194921');" style="">  32 import com.datastax.driver.core.PoolingOptions;                                                          </span>
<span class="3500480560938999402" onmouseenter="enter('3500480560938999402');" onmouseout="out('3500480560938999402');" style="">  33 import com.datastax.driver.core.QueryOptions;                                                            </span>
<span class="1295458347604392536" onmouseenter="enter('1295458347604392536');" onmouseout="out('1295458347604392536');" style="">  34 import com.datastax.driver.core.ResultSet;                                                               </span>
<span class="-2921924295373051715" onmouseenter="enter('-2921924295373051715');" onmouseout="out('-2921924295373051715');" style="">  35 import com.datastax.driver.core.Session;                                                                 </span>
<span class="7536185860942072783" onmouseenter="enter('7536185860942072783');" onmouseout="out('7536185860942072783');" style="">  36 import com.datastax.driver.core.SocketOptions;                                                           </span>
<span class="102554056665873953" onmouseenter="enter('102554056665873953');" onmouseout="out('102554056665873953');" style="">  37 import com.datastax.driver.core.policies.DowngradingConsistencyRetryPolicy;                              </span>
<span class="384780421342561763" onmouseenter="enter('384780421342561763');" onmouseout="out('384780421342561763');" style="">  38 import com.datastax.driver.core.policies.RetryPolicy;                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  39 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  40 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  41 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  42 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  43 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  44 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  45 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="1325017007675469198" onmouseenter="enter('1325017007675469198');" onmouseout="out('1325017007675469198');" style="">  46 import com.dtstack.flink.sql.side.cassandra.table.CassandraSideTableInfo;                                </span>
<span class="-8710273414755433249" onmouseenter="enter('-8710273414755433249');" onmouseout="out('-8710273414755433249');" style="">  47 import com.google.common.base.Function;                                                                  </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  48 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4265236954961374581" onmouseenter="enter('-4265236954961374581');" onmouseout="out('-4265236954961374581');" style="">  49 import com.google.common.util.concurrent.AsyncFunction;                                                  </span>
<span class="3392144801777607486" onmouseenter="enter('3392144801777607486');" onmouseout="out('3392144801777607486');" style="">  50 import com.google.common.util.concurrent.FutureCallback;                                                 </span>
<span class="-3207866063314364212" onmouseenter="enter('-3207866063314364212');" onmouseout="out('-3207866063314364212');" style="">  51 import com.google.common.util.concurrent.Futures;                                                        </span>
<span class="2803111898123627106" onmouseenter="enter('2803111898123627106');" onmouseout="out('2803111898123627106');" style="">  52 import com.google.common.util.concurrent.ListenableFuture;                                               </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  53 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  54 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  57                                                                                                          </span>
<span class="-5790770097715703577" onmouseenter="enter('-5790770097715703577');" onmouseout="out('-5790770097715703577');" style="">  58 import java.net.InetAddress;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  59 import java.sql.Timestamp;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60 import java.util.ArrayList;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  61 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  62 import java.util.Map;                                                                                    </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  65  * Reason:                                                                                               </span>
<span class="-6869475929847104911" onmouseenter="enter('-6869475929847104911');" onmouseout="out('-6869475929847104911');" style="">  66  * Date: 2018/11/22                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67  *                                                                                                       </span>
<span class="-3762428130562648" onmouseenter="enter('-3762428130562648');" onmouseout="out('-3762428130562648');" style="">  68  * @author xuqianjin                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69  */                                                                                                      </span>
<span class="-137893776588311003" onmouseenter="enter('-137893776588311003');" onmouseout="out('-137893776588311003');" style="">  70 public class CassandraAsyncReqRow extends BaseAsyncReqRow {                                              </span>
<span  style="">  71                                                                                                          </span>
<span class="-474972292974325668" onmouseenter="enter('-474972292974325668');" onmouseout="out('-474972292974325668');" style="">  72     private static final long serialVersionUID = 6631584128079864735L;                                   </span>
<span  style="">  73                                                                                                          </span>
<span class="-8305758559523834163" onmouseenter="enter('-8305758559523834163');" onmouseout="out('-8305758559523834163');" style="">  74     private static final Logger LOG = LoggerFactory.getLogger(CassandraAsyncReqRow.class);               </span>
<span  style="">  75                                                                                                          </span>
<span class="-4149057034501610834" onmouseenter="enter('-4149057034501610834');" onmouseout="out('-4149057034501610834');" style="">  76     private final static int DEFAULT_VERTX_EVENT_LOOP_POOL_SIZE = 10;                                    </span>
<span  style="">  77                                                                                                          </span>
<span class="-4781889690315923879" onmouseenter="enter('-4781889690315923879');" onmouseout="out('-4781889690315923879');" style="">  78     private final static int DEFAULT_VERTX_WORKER_POOL_SIZE = 20;                                        </span>
<span  style="">  79                                                                                                          </span>
<span class="8731062638120855225" onmouseenter="enter('8731062638120855225');" onmouseout="out('8731062638120855225');" style="">  80     private final static int DEFAULT_MAX_DB_CONN_POOL_SIZE = 20;                                         </span>
<span  style="">  81                                                                                                          </span>
<span class="-5403177446568963001" onmouseenter="enter('-5403177446568963001');" onmouseout="out('-5403177446568963001');" style="">  82     private transient Cluster cluster;                                                                   </span>
<span class="-8047386482861852310" onmouseenter="enter('-8047386482861852310');" onmouseout="out('-8047386482861852310');" style="">  83     private transient ListenableFuture session;                                                          </span>
<span class="-1659440015873934350" onmouseenter="enter('-1659440015873934350');" onmouseout="out('-1659440015873934350');" style="">  84     private transient CassandraSideTableInfo cassandraSideTableInfo;                                     </span>
<span  style="">  85                                                                                                          </span>
<span class="8250235661803572167" onmouseenter="enter('8250235661803572167');" onmouseout="out('8250235661803572167');" style=""><abbr title="  86     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  86     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoL🔵</abbr></span>
<span class="2131899768365277438" onmouseenter="enter('2131899768365277438');" onmouseout="out('2131899768365277438');" style=""><abbr title="  87         super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));">  87         super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outF🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88     }                                                                                                    </span>
<span  style="">  89                                                                                                          </span>
<span  style="">  90                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  92     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  93         super.open(parameters);                                                                          </span>
<span class="-5020317085273715278" onmouseenter="enter('-5020317085273715278');" onmouseout="out('-5020317085273715278');" style="">  94         cassandraSideTableInfo = (CassandraSideTableInfo) sideInfo.getSideTableInfo();                   </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="">  95         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96     }                                                                                                    </span>
<span  style="">  97                                                                                                          </span>
<span class="2688225595233570188" onmouseenter="enter('2688225595233570188');" onmouseout="out('2688225595233570188');" style="">  98     private void connCassandraDB(CassandraSideTableInfo tableInfo) {                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  99         try {                                                                                            </span>
<span class="417819926325380348" onmouseenter="enter('417819926325380348');" onmouseout="out('417819926325380348');" style=""> 100             if (session == null) {                                                                       </span>
<span class="-3605639280329188999" onmouseenter="enter('-3605639280329188999');" onmouseout="out('-3605639280329188999');" style=""> 101                 QueryOptions queryOptions = new QueryOptions();                                          </span>
<span class="5842973418300621663" onmouseenter="enter('5842973418300621663');" onmouseout="out('5842973418300621663');" style=""> 102                 //The default consistency level for queries: ConsistencyLevel.TWO.                       </span>
<span class="76010926262385906" onmouseenter="enter('76010926262385906');" onmouseout="out('76010926262385906');" style=""> 103                 queryOptions.setConsistencyLevel(ConsistencyLevel.QUORUM);                               </span>
<span class="-4388406259332422062" onmouseenter="enter('-4388406259332422062');" onmouseout="out('-4388406259332422062');" style=""><abbr title=" 104                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo.getMaxRequestsPerConnection();"> 104                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : 🔵</abbr></span>
<span class="-6698153752588261803" onmouseenter="enter('-6698153752588261803');" onmouseout="out('-6698153752588261803');" style=""><abbr title=" 105                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.getCoreConnectionsPerHost();"> 105                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tabl🔵</abbr></span>
<span class="3809961524454958986" onmouseenter="enter('3809961524454958986');" onmouseout="out('3809961524454958986');" style=""><abbr title=" 106                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.getMaxConnectionsPerHost();"> 106                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : ta🔵</abbr></span>
<span class="-3297929912963114654" onmouseenter="enter('-3297929912963114654');" onmouseout="out('-3297929912963114654');" style=""><abbr title=" 107                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQueueSize();"> 107                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQue🔵</abbr></span>
<span class="-1822015680936096661" onmouseenter="enter('-1822015680936096661');" onmouseout="out('-1822015680936096661');" style=""><abbr title=" 108                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTimeoutMillis();"> 108                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="5588349030185896717" onmouseenter="enter('5588349030185896717');" onmouseout="out('5588349030185896717');" style=""><abbr title=" 109                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.getConnectTimeoutMillis();"> 109                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tabl🔵</abbr></span>
<span class="5493190487826327243" onmouseenter="enter('5493190487826327243');" onmouseout="out('5493190487826327243');" style=""><abbr title=" 110                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTimeoutMillis();"> 110                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="-5259680847618191912" onmouseenter="enter('-5259680847618191912');" onmouseout="out('-5259680847618191912');" style=""> 111                 Integer cassandraPort = 0;                                                               </span>
<span class="-8848193911625825371" onmouseenter="enter('-8848193911625825371');" onmouseout="out('-8848193911625825371');" style=""> 112                 String address = tableInfo.getAddress();                                                 </span>
<span class="2950506038619853549" onmouseenter="enter('2950506038619853549');" onmouseout="out('2950506038619853549');" style=""> 113                 String userName = tableInfo.getUserName();                                               </span>
<span class="-4521409941966564293" onmouseenter="enter('-4521409941966564293');" onmouseout="out('-4521409941966564293');" style=""> 114                 String password = tableInfo.getPassword();                                               </span>
<span class="-6108815609943098672" onmouseenter="enter('-6108815609943098672');" onmouseout="out('-6108815609943098672');" style=""> 115                 String database = tableInfo.getDatabase();                                               </span>
<span  style=""> 116                                                                                                          </span>
<span class="6493913905304408918" onmouseenter="enter('6493913905304408918');" onmouseout="out('6493913905304408918');" style=""> 117                 ArrayList serversList = new ArrayList();                                                 </span>
<span class="5423738273364037419" onmouseenter="enter('5423738273364037419');" onmouseout="out('5423738273364037419');" style=""> 118                 //Read timeout or connection timeout Settings                                            </span>
<span class="-1651403584650918350" onmouseenter="enter('-1651403584650918350');" onmouseout="out('-1651403584650918350');" style=""> 119                 SocketOptions so = new SocketOptions()                                                   </span>
<span class="-6143815205992723671" onmouseenter="enter('-6143815205992723671');" onmouseout="out('-6143815205992723671');" style=""> 120                         .setReadTimeoutMillis(readTimeoutMillis)                                         </span>
<span class="-7477024419561329894" onmouseenter="enter('-7477024419561329894');" onmouseout="out('-7477024419561329894');" style=""> 121                         .setConnectTimeoutMillis(connectTimeoutMillis);                                  </span>
<span  style=""> 122                                                                                                          </span>
<span class="36776837264098679" onmouseenter="enter('36776837264098679');" onmouseout="out('36776837264098679');" style=""> 123                 //The cluster USES hostdistance.local in the same machine room                           </span>
<span class="-4067753854505755618" onmouseenter="enter('-4067753854505755618');" onmouseout="out('-4067753854505755618');" style=""> 124                 //Hostdistance. REMOTE is used for different machine rooms                               </span>
<span class="-1239540897477970915" onmouseenter="enter('-1239540897477970915');" onmouseout="out('-1239540897477970915');" style=""> 125                 //Ignore use HostDistance. IGNORED                                                       </span>
<span class="7507936330523201209" onmouseenter="enter('7507936330523201209');" onmouseout="out('7507936330523201209');" style=""> 126                 PoolingOptions poolingOptions = new PoolingOptions()                                     </span>
<span class="4173548347137079648" onmouseenter="enter('4173548347137079648');" onmouseout="out('4173548347137079648');" style=""> 127                         //Each connection allows a maximum of 64 concurrent requests                     </span>
<span class="6109267905237967219" onmouseenter="enter('6109267905237967219');" onmouseout="out('6109267905237967219');" style=""> 128                         .setMaxRequestsPerConnection(HostDistance.LOCAL, maxRequestsPerConnection)       </span>
<span class="-8245292782127165862" onmouseenter="enter('-8245292782127165862');" onmouseout="out('-8245292782127165862');" style=""> 129                         //Have at least two connections to each machine in the cluster                   </span>
<span class="7216166406224594146" onmouseenter="enter('7216166406224594146');" onmouseout="out('7216166406224594146');" style=""> 130                         .setCoreConnectionsPerHost(HostDistance.LOCAL, coreConnectionsPerHost)           </span>
<span class="-1358272374234048070" onmouseenter="enter('-1358272374234048070');" onmouseout="out('-1358272374234048070');" style=""> 131                         //There are up to eight connections to each machine in the cluster               </span>
<span class="-1698869078338541686" onmouseenter="enter('-1698869078338541686');" onmouseout="out('-1698869078338541686');" style=""> 132                         .setMaxConnectionsPerHost(HostDistance.LOCAL, maxConnectionsPerHost)             </span>
<span class="1548703418514968406" onmouseenter="enter('1548703418514968406');" onmouseout="out('1548703418514968406');" style=""> 133                         .setMaxQueueSize(maxQueueSize)                                                   </span>
<span class="3524981482635418824" onmouseenter="enter('3524981482635418824');" onmouseout="out('3524981482635418824');" style=""> 134                         .setPoolTimeoutMillis(poolTimeoutMillis);                                        </span>
<span class="-3027653360277295120" onmouseenter="enter('-3027653360277295120');" onmouseout="out('-3027653360277295120');" style=""> 135                 //重试策略                                                                                   </span>
<span class="-2500245183701794239" onmouseenter="enter('-2500245183701794239');" onmouseout="out('-2500245183701794239');" style=""> 136                 RetryPolicy retryPolicy = DowngradingConsistencyRetryPolicy.INSTANCE;                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="6634426984636856768" onmouseenter="enter('6634426984636856768');" onmouseout="out('6634426984636856768');" style=""> 138                 for (String server : StringUtils.split(address, &quot;,&quot;)) {                                  </span>
<span class="-4294448682063399613" onmouseenter="enter('-4294448682063399613');" onmouseout="out('-4294448682063399613');" style=""> 139                     cassandraPort = Integer.parseInt(StringUtils.split(server, &quot;:&quot;)[1]);                 </span>
<span class="7751295421103553875" onmouseenter="enter('7751295421103553875');" onmouseout="out('7751295421103553875');" style=""> 140                     serversList.add(InetAddress.getByName(StringUtils.split(server, &quot;:&quot;)[0]));           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141                 }                                                                                        </span>
<span  style=""> 142                                                                                                          </span>
<span class="3673717518338030181" onmouseenter="enter('3673717518338030181');" onmouseout="out('3673717518338030181');" style=""> 143                 if (userName == null || userName.isEmpty() || password == null || password.isEmpty()) {  </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 144                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 144                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 145                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 146                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 147                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 148                 } else {                                                                                 </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 149                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 149                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 150                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 151                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="-5038512354126172278" onmouseenter="enter('-5038512354126172278');" onmouseout="out('-5038512354126172278');" style=""> 152                             .withCredentials(userName, password)                                         </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 153                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                 }                                                                                        </span>
<span class="765464969334355038" onmouseenter="enter('765464969334355038');" onmouseout="out('765464969334355038');" style=""> 155                 // 建立连接 连接已存在的键空间                                                                        </span>
<span class="-6325263381803948308" onmouseenter="enter('-6325263381803948308');" onmouseout="out('-6325263381803948308');" style=""> 156                 session = cluster.connectAsync(database);                                                </span>
<span class="8518739044679915590" onmouseenter="enter('8518739044679915590');" onmouseout="out('8518739044679915590');" style=""> 157                 LOG.info(&quot;connect cassandra is successed!&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 159         } catch (Exception e) {                                                                          </span>
<span class="7191685386448857101" onmouseenter="enter('7191685386448857101');" onmouseout="out('7191685386448857101');" style=""> 160             LOG.error(&quot;connect cassandra is error:&quot; + e.getMessage());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 165     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 165     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span  style=""> 166                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 167         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style=""> 168         //connect Cassandra                                                                              </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style=""> 169         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span  style=""> 170                                                                                                          </span>
<span class="8882875172916837309" onmouseenter="enter('8882875172916837309');" onmouseout="out('8882875172916837309');" style=""><abbr title=" 171         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  ALLOW FILTERING &quot;;"> 171         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  AL🔵</abbr></span>
<span  style=""> 172                                                                                                          </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style=""> 173         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                          </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style=""> 174                 new AsyncFunction&lt;Session, ResultSet&gt;() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 175                     @Override                                                                            </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style=""> 176                     public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {         </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style=""> 177                         return session.executeAsync(sqlCondition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 179                 });                                                                                      </span>
<span  style=""> 180                                                                                                          </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style=""> 181         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,         </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style=""> 182                 new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 183                     @Override                                                                            </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style=""> 184                     public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                      </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style=""> 185                         return rs.all();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 187                 });                                                                                      </span>
<span  style=""> 188                                                                                                          </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style=""> 189         Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 190             @Override                                                                                    </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style=""> 191             public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 192                 cluster.closeAsync();                                                                    </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style=""> 193                 if (rows.size() &gt; 0) {                                                                   </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style=""> 194                     List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();              </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 195                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style=""> 196                     for (com.datastax.driver.core.Row line : rows) {                                     </span>
<span class="5316099920929274958" onmouseenter="enter('5316099920929274958');" onmouseout="out('5316099920929274958');" style=""> 197                         Row row = fillData(input.row(), line);                                           </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 198                         if (openCache()) {                                                               </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 199                             cacheContent.add(line);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200                         }                                                                                </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 201                         rowList.add(new CRow(row, input.change()));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 203                     resultFuture.complete(rowList);                                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 204                     if (openCache()) {                                                                   </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 205                         putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 207                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 208                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 209                     if (openCache()) {                                                                   </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 210                         putCache(key, CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211                     }                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 212                     resultFuture.complete(null);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214             }                                                                                            </span>
<span  style=""> 215                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216             @Override                                                                                    </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style=""> 217             public void onFailure(Throwable t) {                                                         </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style=""> 218                 LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                           </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style=""> 219                         t.getMessage());                                                                 </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 220                 cluster.closeAsync();                                                                    </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style=""> 221                 resultFuture.completeExceptionally(t);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 223         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 224     }                                                                                                    </span>
<span  style=""> 225                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 226     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 227     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 228         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 229         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style=""> 230             sb.append(ele.toString()).append(&quot;_&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 232         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233     }                                                                                                    </span>
<span  style=""> 234                                                                                                          </span>
<span class="-1821575284166957660" onmouseenter="enter('-1821575284166957660');" onmouseout="out('-1821575284166957660');" style=""> 235     private String buildWhereCondition(Map&lt;String, Object&gt; inputParams){                                 </span>
<span class="5090364847803370614" onmouseenter="enter('5090364847803370614');" onmouseout="out('5090364847803370614');" style=""> 236         StringBuilder sb = new StringBuilder(&quot; where &quot;);                                                 </span>
<span class="-7053571210782116126" onmouseenter="enter('-7053571210782116126');" onmouseout="out('-7053571210782116126');" style=""> 237         for(Map.Entry&lt;String, Object&gt; entry : inputParams.entrySet()){                                   </span>
<span class="-3077711825568802702" onmouseenter="enter('-3077711825568802702');" onmouseout="out('-3077711825568802702');" style=""><abbr title=" 238             Object value = entry.getValue() instanceof String ? &quot;&#x27;&quot; + entry.getValue() + &quot;&#x27;&quot; : entry.getValue();"> 238             Object value = entry.getValue() instanceof String ? &quot;&#x27;&quot; + entry.getValue() + &quot;&#x27;&quot; : entry.getV🔵</abbr></span>
<span class="-2126749103831887182" onmouseenter="enter('-2126749103831887182');" onmouseout="out('-2126749103831887182');" style=""> 239             sb.append(String.format(&quot;%s = %s&quot;, entry.getKey(), value));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 241         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242     }                                                                                                    </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 243 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 244 ||||||| BASE                                                                                             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 245 @Override                                                                                                </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 246     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 247         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 248         JsonArray inputParams = new JsonArray();                                                         </span>
<span class="7298653858488117630" onmouseenter="enter('7298653858488117630');" onmouseout="out('7298653858488117630');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 249         StringBuffer stringBuffer = new StringBuffer();                                                  </span>
<span class="-4783111457257452314" onmouseenter="enter('-4783111457257452314');" onmouseout="out('-4783111457257452314');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 250         String sqlWhere = &quot; where &quot;;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 251                                                                                                          </span>
<span class="-8402687189436648246" onmouseenter="enter('-8402687189436648246');" onmouseout="out('-8402687189436648246');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 252         for (int i = 0; i &lt; sideInfo.getEqualFieldList().size(); i++) {                                  </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 253             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 254             Object equalObj = inputCopy.row().getField(conValIndex);                                     </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 255             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 256                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 257                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 258             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 259             inputParams.add(equalObj);                                                                   </span>
<span class="6844316250995394013" onmouseenter="enter('6844316250995394013');" onmouseout="out('6844316250995394013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 260             StringBuffer sqlTemp = stringBuffer.append(sideInfo.getEqualFieldList().get(i))              </span>
<span class="4506040730369527852" onmouseenter="enter('4506040730369527852');" onmouseout="out('4506040730369527852');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 261                     .append(&quot; = &quot;);                                                                      </span>
<span class="6706079886736437259" onmouseenter="enter('6706079886736437259');" onmouseout="out('6706079886736437259');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 262             if (equalObj instanceof String) {                                                            </span>
<span class="147067916336825508" onmouseenter="enter('147067916336825508');" onmouseout="out('147067916336825508');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 263                 sqlTemp.append(&quot;&#x27;&quot; + equalObj + &quot;&#x27;&quot;)                                                     </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 264                         .append(&quot; and &quot;);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 265             } else {                                                                                     </span>
<span class="-2928507733810337143" onmouseenter="enter('-2928507733810337143');" onmouseout="out('-2928507733810337143');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 266                 sqlTemp.append(equalObj)                                                                 </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 267                         .append(&quot; and &quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 268             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 269                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 270         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 271                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 272         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-7558523756689931178" onmouseenter="enter('-7558523756689931178');" onmouseout="out('-7558523756689931178');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 273         sqlWhere = sqlWhere + stringBuffer.toString().substring(0, stringBuffer.lastIndexOf(&quot; and &quot;));   </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 274                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 275         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 276             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 277             if (val != null) {                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 278                                                                                                          </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 279                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 280                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 281                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 282                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 283                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 284                     for (Object jsonArray : (List) val.getContent()) {                                   </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 285                         Row row = fillData(inputCopy.row(), jsonArray);                                  </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 286                         rowList.add(new CRow(row, inputCopy.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 287                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 288                     resultFuture.complete(rowList);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 289                 } else {                                                                                 </span>
<span class="-1323059185501153522" onmouseenter="enter('-1323059185501153522');" onmouseout="out('-1323059185501153522');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 290                     throw new RuntimeException(&quot;not support cache obj type &quot; + val.getType());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 291                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 292                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 293             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 294         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 295                                                                                                          </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 296         //connect Cassandra                                                                              </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 297         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 298                                                                                                          </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 299         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;        </span>
<span class="2890792881476289631" onmouseenter="enter('2890792881476289631');" onmouseout="out('2890792881476289631');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 300         System.out.println(&quot;sqlCondition:&quot; + sqlCondition);                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 301                                                                                                          </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 302         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                          </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 303                 new AsyncFunction&lt;Session, ResultSet&gt;() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 304                     @Override                                                                            </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 305                     public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {         </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 306                         return session.executeAsync(sqlCondition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 307                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 308                 });                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 309                                                                                                          </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 310         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,         </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 311                 new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 312                     @Override                                                                            </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 313                     public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                      </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 314                         return rs.all();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 315                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 316                 });                                                                                      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 317                                                                                                          </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 318         Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 319             @Override                                                                                    </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 320             public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 321                 cluster.closeAsync();                                                                    </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 322                 if (rows.size() &gt; 0) {                                                                   </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 323                     List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();              </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 324                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 325                     for (com.datastax.driver.core.Row line : rows) {                                     </span>
<span class="4836418702808839962" onmouseenter="enter('4836418702808839962');" onmouseout="out('4836418702808839962');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 326                         Row row = fillData(inputCopy.row(), line);                                       </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 327                         if (openCache()) {                                                               </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 328                             cacheContent.add(line);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 329                         }                                                                                </span>
<span class="-1174022488282524551" onmouseenter="enter('-1174022488282524551');" onmouseout="out('-1174022488282524551');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 330                         rowList.add(new CRow(row,inputCopy.change()));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 331                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 332                     resultFuture.complete(rowList);                                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 333                     if (openCache()) {                                                                   </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 334                         putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 335                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 336                 } else {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 337                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 338                     if (openCache()) {                                                                   </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 339                         putCache(key, CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 340                     }                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 341                     resultFuture.complete(null);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 342                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 343             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 344                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 345             @Override                                                                                    </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 346             public void onFailure(Throwable t) {                                                         </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 347                 LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                           </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 348                         t.getMessage());                                                                 </span>
<span class="6562988686685479683" onmouseenter="enter('6562988686685479683');" onmouseout="out('6562988686685479683');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 349                 System.out.println(&quot;Failed to retrieve the data: &quot; + t.getMessage());                    </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 350                 cluster.closeAsync();                                                                    </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 351                 resultFuture.completeExceptionally(t);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 352             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 353         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 354     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 355 =======                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 356 @Override                                                                                                </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 357     public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {              </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 358         CRow inputCopy = new CRow(input.row(), input.change());                                          </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 359         JsonArray inputParams = new JsonArray();                                                         </span>
<span class="7298653858488117630" onmouseenter="enter('7298653858488117630');" onmouseout="out('7298653858488117630');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 360         StringBuffer stringBuffer = new StringBuffer();                                                  </span>
<span class="-4783111457257452314" onmouseenter="enter('-4783111457257452314');" onmouseout="out('-4783111457257452314');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 361         String sqlWhere = &quot; where &quot;;                                                                     </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 362                                                                                                          </span>
<span class="-8402687189436648246" onmouseenter="enter('-8402687189436648246');" onmouseout="out('-8402687189436648246');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 363         for (int i = 0; i &lt; sideInfo.getEqualFieldList().size(); i++) {                                  </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 364             Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                    </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 365             Object equalObj = inputCopy.row().getField(conValIndex);                                     </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 366             if (equalObj == null) {                                                                      </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 367                 dealMissKey(inputCopy, resultFuture);                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 368                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 369             }                                                                                            </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 370             inputParams.add(equalObj);                                                                   </span>
<span class="6844316250995394013" onmouseenter="enter('6844316250995394013');" onmouseout="out('6844316250995394013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 371             StringBuffer sqlTemp = stringBuffer.append(sideInfo.getEqualFieldList().get(i))              </span>
<span class="4506040730369527852" onmouseenter="enter('4506040730369527852');" onmouseout="out('4506040730369527852');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 372                     .append(&quot; = &quot;);                                                                      </span>
<span class="6706079886736437259" onmouseenter="enter('6706079886736437259');" onmouseout="out('6706079886736437259');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 373             if (equalObj instanceof String) {                                                            </span>
<span class="147067916336825508" onmouseenter="enter('147067916336825508');" onmouseout="out('147067916336825508');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 374                 sqlTemp.append(&quot;&#x27;&quot; + equalObj + &quot;&#x27;&quot;)                                                     </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 375                         .append(&quot; and &quot;);                                                                </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 376             } else {                                                                                     </span>
<span class="-2928507733810337143" onmouseenter="enter('-2928507733810337143');" onmouseout="out('-2928507733810337143');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 377                 sqlTemp.append(equalObj)                                                                 </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 378                         .append(&quot; and &quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 379             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 380                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 381         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 382                                                                                                          </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 383         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-7558523756689931178" onmouseenter="enter('-7558523756689931178');" onmouseout="out('-7558523756689931178');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 384         sqlWhere = sqlWhere + stringBuffer.toString().substring(0, stringBuffer.lastIndexOf(&quot; and &quot;));   </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 385                                                                                                          </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 386         if (openCache()) {                                                                               </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 387             CacheObj val = getFromCache(key);                                                            </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 388             if (val != null) {                                                                           </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 389                                                                                                          </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 390                 if (ECacheContentType.MissVal == val.getType()) {                                        </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 391                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 392                     return;                                                                              </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 393                 } else if (ECacheContentType.MultiLine == val.getType()) {                               </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 394                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 395                     for (Object jsonArray : (List) val.getContent()) {                                   </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 396                         Row row = fillData(inputCopy.row(), jsonArray);                                  </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 397                         rowList.add(new CRow(row, inputCopy.change()));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 398                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 399                     resultFuture.complete(rowList);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 400                 } else {                                                                                 </span>
<span class="-1323059185501153522" onmouseenter="enter('-1323059185501153522');" onmouseout="out('-1323059185501153522');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 401                     throw new RuntimeException(&quot;not support cache obj type &quot; + val.getType());           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 402                 }                                                                                        </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 403                 return;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 404             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 405         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 406                                                                                                          </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 407         //connect Cassandra                                                                              </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 408         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 409                                                                                                          </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 410         String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;        </span>
<span class="7235570087826307362" onmouseenter="enter('7235570087826307362');" onmouseout="out('7235570087826307362');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 411         LOG.info(&quot;sqlCondition:{}&quot; + sqlCondition);                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 412                                                                                                          </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 413         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                          </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 414                 new AsyncFunction&lt;Session, ResultSet&gt;() {                                                </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 415                     @Override                                                                            </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 416                     public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {         </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 417                         return session.executeAsync(sqlCondition);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 418                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 419                 });                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 420                                                                                                          </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 421         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,         </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 422                 new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 423                     @Override                                                                            </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 424                     public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                      </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 425                         return rs.all();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 426                     }                                                                                    </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 427                 });                                                                                      </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 428                                                                                                          </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 429         Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 430             @Override                                                                                    </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 431             public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 432                 cluster.closeAsync();                                                                    </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 433                 if (rows.size() &gt; 0) {                                                                   </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 434                     List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();              </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 435                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 436                     for (com.datastax.driver.core.Row line : rows) {                                     </span>
<span class="4836418702808839962" onmouseenter="enter('4836418702808839962');" onmouseout="out('4836418702808839962');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 437                         Row row = fillData(inputCopy.row(), line);                                       </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 438                         if (openCache()) {                                                               </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 439                             cacheContent.add(line);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 440                         }                                                                                </span>
<span class="-1174022488282524551" onmouseenter="enter('-1174022488282524551');" onmouseout="out('-1174022488282524551');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 441                         rowList.add(new CRow(row,inputCopy.change()));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 442                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 443                     resultFuture.complete(rowList);                                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 444                     if (openCache()) {                                                                   </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 445                         putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 446                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 447                 } else {                                                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 448                     dealMissKey(inputCopy, resultFuture);                                                </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 449                     if (openCache()) {                                                                   </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 450                         putCache(key, CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 451                     }                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 452                     resultFuture.complete(null);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 453                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 454             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 455                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 456             @Override                                                                                    </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 457             public void onFailure(Throwable t) {                                                         </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 458                 LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                           </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 459                         t.getMessage());                                                                 </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 460                 cluster.closeAsync();                                                                    </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 461                 resultFuture.completeExceptionally(t);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 462             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 463         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 464     }                                                                                                    </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 465 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span  style=""> 466                                                                                                          </span>
<span  style=""> 467                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 468     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 469     public Row fillData(Row input, Object line) {                                                        </span>
<span class="-1556735922244622351" onmouseenter="enter('-1556735922244622351');" onmouseout="out('-1556735922244622351');" style=""> 470         com.datastax.driver.core.Row rowArray = (com.datastax.driver.core.Row) line;                     </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 471         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 472         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 473             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 474             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 474             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span  style=""> 475                                                                                                          </span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 476             if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 477                 obj = ((Timestamp) obj).getTime();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478             }                                                                                            </span>
<span  style=""> 479                                                                                                          </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 480             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481         }                                                                                                </span>
<span  style=""> 482                                                                                                          </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 483         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-844467095686898872" onmouseenter="enter('-844467095686898872');" onmouseout="out('-844467095686898872');" style=""> 484             if (rowArray == null) {                                                                      </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 485                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 486             } else {                                                                                     </span>
<span class="-7910331794290062112" onmouseenter="enter('-7910331794290062112');" onmouseout="out('-7910331794290062112');" style=""> 487                 row.setField(entry.getKey(), rowArray.getObject(entry.getValue()));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 488             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 489         }                                                                                                </span>
<span  style=""> 490                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 491         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492     }                                                                                                    </span>
<span  style=""> 493                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 494     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 495     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 496         super.close();                                                                                   </span>
<span class="7236775322084046720" onmouseenter="enter('7236775322084046720');" onmouseout="out('7236775322084046720');" style=""> 497         if (cluster != null) {                                                                           </span>
<span class="-7802554339096083826" onmouseenter="enter('-7802554339096083826');" onmouseout="out('-7802554339096083826');" style=""> 498             cluster.close();                                                                             </span>
<span class="-8433337576020477133" onmouseenter="enter('-8433337576020477133');" onmouseout="out('-8433337576020477133');" style=""> 499             cluster = null;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-167599954638689123" onmouseenter="enter('-167599954638689123');" onmouseout="out('-167599954638689123');" style="">  18 package com.dtstack.flink.sql.side.cassandra;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-4674624431842718354" onmouseenter="enter('-4674624431842718354');" onmouseout="out('-4674624431842718354');" style="">  20 import com.datastax.driver.core.Cluster;                                                                 </span>
<span class="4630389600773953361" onmouseenter="enter('4630389600773953361');" onmouseout="out('4630389600773953361');" style="">  21 import com.datastax.driver.core.ConsistencyLevel;                                                        </span>
<span class="-5077913371267042181" onmouseenter="enter('-5077913371267042181');" onmouseout="out('-5077913371267042181');" style="">  22 import com.datastax.driver.core.HostDistance;                                                            </span>
<span class="-8460078615292194921" onmouseenter="enter('-8460078615292194921');" onmouseout="out('-8460078615292194921');" style="">  23 import com.datastax.driver.core.PoolingOptions;                                                          </span>
<span class="3500480560938999402" onmouseenter="enter('3500480560938999402');" onmouseout="out('3500480560938999402');" style="">  24 import com.datastax.driver.core.QueryOptions;                                                            </span>
<span class="1295458347604392536" onmouseenter="enter('1295458347604392536');" onmouseout="out('1295458347604392536');" style="">  25 import com.datastax.driver.core.ResultSet;                                                               </span>
<span class="-2921924295373051715" onmouseenter="enter('-2921924295373051715');" onmouseout="out('-2921924295373051715');" style="">  26 import com.datastax.driver.core.Session;                                                                 </span>
<span class="7536185860942072783" onmouseenter="enter('7536185860942072783');" onmouseout="out('7536185860942072783');" style="">  27 import com.datastax.driver.core.SocketOptions;                                                           </span>
<span class="102554056665873953" onmouseenter="enter('102554056665873953');" onmouseout="out('102554056665873953');" style="">  28 import com.datastax.driver.core.policies.DowngradingConsistencyRetryPolicy;                              </span>
<span class="384780421342561763" onmouseenter="enter('384780421342561763');" onmouseout="out('384780421342561763');" style="">  29 import com.datastax.driver.core.policies.RetryPolicy;                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  30 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  31 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  32 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  33 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  34 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  35 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  36 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="1325017007675469198" onmouseenter="enter('1325017007675469198');" onmouseout="out('1325017007675469198');" style="">  37 import com.dtstack.flink.sql.side.cassandra.table.CassandraSideTableInfo;                                </span>
<span class="-8710273414755433249" onmouseenter="enter('-8710273414755433249');" onmouseout="out('-8710273414755433249');" style="">  38 import com.google.common.base.Function;                                                                  </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  39 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4265236954961374581" onmouseenter="enter('-4265236954961374581');" onmouseout="out('-4265236954961374581');" style="">  40 import com.google.common.util.concurrent.AsyncFunction;                                                  </span>
<span class="3392144801777607486" onmouseenter="enter('3392144801777607486');" onmouseout="out('3392144801777607486');" style="">  41 import com.google.common.util.concurrent.FutureCallback;                                                 </span>
<span class="-3207866063314364212" onmouseenter="enter('-3207866063314364212');" onmouseout="out('-3207866063314364212');" style="">  42 import com.google.common.util.concurrent.Futures;                                                        </span>
<span class="2803111898123627106" onmouseenter="enter('2803111898123627106');" onmouseout="out('2803111898123627106');" style="">  43 import com.google.common.util.concurrent.ListenableFuture;                                               </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  44 import io.vertx.core.json.JsonArray;                                                                     </span>
<span class="-5790770097715703577" onmouseenter="enter('-5790770097715703577');" onmouseout="out('-5790770097715703577');" style="">  45 import java.net.InetAddress;                                                                             </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  46 import java.sql.Timestamp;                                                                               </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  47 import java.util.ArrayList;                                                                              </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  48 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  49 import java.util.Map;                                                                                    </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  50 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  51 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  52 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  53 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  54 import org.apache.flink.table.runtime.types.CRow;                                                        </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  55 import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                           </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  56 import org.apache.flink.types.Row;                                                                       </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  57 import org.slf4j.Logger;                                                                                 </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  58 import org.slf4j.LoggerFactory;                                                                          </span>
<span  style="">  59                                                                                                          </span>
<span  style="">  60                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  61 /**                                                                                                      </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  62  * Reason:                                                                                               </span>
<span class="-6869475929847104911" onmouseenter="enter('-6869475929847104911');" onmouseout="out('-6869475929847104911');" style="">  63  * Date: 2018/11/22                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  64  *                                                                                                       </span>
<span class="-3762428130562648" onmouseenter="enter('-3762428130562648');" onmouseout="out('-3762428130562648');" style="">  65  * @author xuqianjin                                                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66  */                                                                                                      </span>
<span class="-137893776588311003" onmouseenter="enter('-137893776588311003');" onmouseout="out('-137893776588311003');" style="">  67 public class CassandraAsyncReqRow extends BaseAsyncReqRow {                                              </span>
<span class="-474972292974325668" onmouseenter="enter('-474972292974325668');" onmouseout="out('-474972292974325668');" style="">  68     private static final long serialVersionUID = 6631584128079864735L;                                   </span>
<span  style="">  69                                                                                                          </span>
<span class="-8305758559523834163" onmouseenter="enter('-8305758559523834163');" onmouseout="out('-8305758559523834163');" style="">  70     private static final Logger LOG = LoggerFactory.getLogger(CassandraAsyncReqRow.class);               </span>
<span  style="">  71                                                                                                          </span>
<span class="-4149057034501610834" onmouseenter="enter('-4149057034501610834');" onmouseout="out('-4149057034501610834');" style="">  72     private final static int DEFAULT_VERTX_EVENT_LOOP_POOL_SIZE = 10;                                    </span>
<span  style="">  73                                                                                                          </span>
<span class="-4781889690315923879" onmouseenter="enter('-4781889690315923879');" onmouseout="out('-4781889690315923879');" style="">  74     private final static int DEFAULT_VERTX_WORKER_POOL_SIZE = 20;                                        </span>
<span  style="">  75                                                                                                          </span>
<span class="8731062638120855225" onmouseenter="enter('8731062638120855225');" onmouseout="out('8731062638120855225');" style="">  76     private final static int DEFAULT_MAX_DB_CONN_POOL_SIZE = 20;                                         </span>
<span  style="">  77                                                                                                          </span>
<span class="-5403177446568963001" onmouseenter="enter('-5403177446568963001');" onmouseout="out('-5403177446568963001');" style="">  78     private transient Cluster cluster;                                                                   </span>
<span  style="">  79                                                                                                          </span>
<span class="-8047386482861852310" onmouseenter="enter('-8047386482861852310');" onmouseout="out('-8047386482861852310');" style="">  80     private transient ListenableFuture session;                                                          </span>
<span  style="">  81                                                                                                          </span>
<span class="-1659440015873934350" onmouseenter="enter('-1659440015873934350');" onmouseout="out('-1659440015873934350');" style="">  82     private transient CassandraSideTableInfo cassandraSideTableInfo;                                     </span>
<span  style="">  83                                                                                                          </span>
<span class="8250235661803572167" onmouseenter="enter('8250235661803572167');" onmouseout="out('8250235661803572167');" style=""><abbr title="  84     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  84     public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoL🔵</abbr></span>
<span class="779721780244651642" onmouseenter="enter('779721780244651642');" onmouseout="out('779721780244651642');" style="">  85         super(new CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86     }                                                                                                    </span>
<span  style="">  87                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  88     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  89     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  90         super.open(parameters);                                                                          </span>
<span class="-5020317085273715278" onmouseenter="enter('-5020317085273715278');" onmouseout="out('-5020317085273715278');" style="">  91         cassandraSideTableInfo = (CassandraSideTableInfo) sideInfo.getSideTableInfo();                   </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="">  92         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93     }                                                                                                    </span>
<span  style="">  94                                                                                                          </span>
<span class="2688225595233570188" onmouseenter="enter('2688225595233570188');" onmouseout="out('2688225595233570188');" style="">  95     private void connCassandraDB(CassandraSideTableInfo tableInfo) {                                     </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  96         try {                                                                                            </span>
<span class="417819926325380348" onmouseenter="enter('417819926325380348');" onmouseout="out('417819926325380348');" style="">  97             if (session == null) {                                                                       </span>
<span class="-3605639280329188999" onmouseenter="enter('-3605639280329188999');" onmouseout="out('-3605639280329188999');" style="">  98                 QueryOptions queryOptions = new QueryOptions();                                          </span>
<span class="5842973418300621663" onmouseenter="enter('5842973418300621663');" onmouseout="out('5842973418300621663');" style="">  99                 //The default consistency level for queries: ConsistencyLevel.TWO.                       </span>
<span class="76010926262385906" onmouseenter="enter('76010926262385906');" onmouseout="out('76010926262385906');" style=""> 100                 queryOptions.setConsistencyLevel(ConsistencyLevel.QUORUM);                               </span>
<span class="-4388406259332422062" onmouseenter="enter('-4388406259332422062');" onmouseout="out('-4388406259332422062');" style=""><abbr title=" 101                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo.getMaxRequestsPerConnection();"> 101                 Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : 🔵</abbr></span>
<span class="-6698153752588261803" onmouseenter="enter('-6698153752588261803');" onmouseout="out('-6698153752588261803');" style=""><abbr title=" 102                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.getCoreConnectionsPerHost();"> 102                 Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tabl🔵</abbr></span>
<span class="3809961524454958986" onmouseenter="enter('3809961524454958986');" onmouseout="out('3809961524454958986');" style=""><abbr title=" 103                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.getMaxConnectionsPerHost();"> 103                 Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : ta🔵</abbr></span>
<span class="-3297929912963114654" onmouseenter="enter('-3297929912963114654');" onmouseout="out('-3297929912963114654');" style=""><abbr title=" 104                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQueueSize();"> 104                 Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQue🔵</abbr></span>
<span class="-1822015680936096661" onmouseenter="enter('-1822015680936096661');" onmouseout="out('-1822015680936096661');" style=""><abbr title=" 105                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTimeoutMillis();"> 105                 Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="5588349030185896717" onmouseenter="enter('5588349030185896717');" onmouseout="out('5588349030185896717');" style=""><abbr title=" 106                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.getConnectTimeoutMillis();"> 106                 Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tabl🔵</abbr></span>
<span class="5493190487826327243" onmouseenter="enter('5493190487826327243');" onmouseout="out('5493190487826327243');" style=""><abbr title=" 107                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTimeoutMillis();"> 107                 Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.🔵</abbr></span>
<span class="-5259680847618191912" onmouseenter="enter('-5259680847618191912');" onmouseout="out('-5259680847618191912');" style=""> 108                 Integer cassandraPort = 0;                                                               </span>
<span class="-8848193911625825371" onmouseenter="enter('-8848193911625825371');" onmouseout="out('-8848193911625825371');" style=""> 109                 String address = tableInfo.getAddress();                                                 </span>
<span class="2950506038619853549" onmouseenter="enter('2950506038619853549');" onmouseout="out('2950506038619853549');" style=""> 110                 String userName = tableInfo.getUserName();                                               </span>
<span class="-4521409941966564293" onmouseenter="enter('-4521409941966564293');" onmouseout="out('-4521409941966564293');" style=""> 111                 String password = tableInfo.getPassword();                                               </span>
<span class="-6108815609943098672" onmouseenter="enter('-6108815609943098672');" onmouseout="out('-6108815609943098672');" style=""> 112                 String database = tableInfo.getDatabase();                                               </span>
<span  style=""> 113                                                                                                          </span>
<span class="6493913905304408918" onmouseenter="enter('6493913905304408918');" onmouseout="out('6493913905304408918');" style=""> 114                 ArrayList serversList = new ArrayList();                                                 </span>
<span class="5423738273364037419" onmouseenter="enter('5423738273364037419');" onmouseout="out('5423738273364037419');" style=""> 115                 //Read timeout or connection timeout Settings                                            </span>
<span class="-1651403584650918350" onmouseenter="enter('-1651403584650918350');" onmouseout="out('-1651403584650918350');" style=""> 116                 SocketOptions so = new SocketOptions()                                                   </span>
<span class="-6143815205992723671" onmouseenter="enter('-6143815205992723671');" onmouseout="out('-6143815205992723671');" style=""> 117                         .setReadTimeoutMillis(readTimeoutMillis)                                         </span>
<span class="-7477024419561329894" onmouseenter="enter('-7477024419561329894');" onmouseout="out('-7477024419561329894');" style=""> 118                         .setConnectTimeoutMillis(connectTimeoutMillis);                                  </span>
<span  style=""> 119                                                                                                          </span>
<span class="36776837264098679" onmouseenter="enter('36776837264098679');" onmouseout="out('36776837264098679');" style=""> 120                 //The cluster USES hostdistance.local in the same machine room                           </span>
<span class="-4067753854505755618" onmouseenter="enter('-4067753854505755618');" onmouseout="out('-4067753854505755618');" style=""> 121                 //Hostdistance. REMOTE is used for different machine rooms                               </span>
<span class="-1239540897477970915" onmouseenter="enter('-1239540897477970915');" onmouseout="out('-1239540897477970915');" style=""> 122                 //Ignore use HostDistance. IGNORED                                                       </span>
<span class="7507936330523201209" onmouseenter="enter('7507936330523201209');" onmouseout="out('7507936330523201209');" style=""> 123                 PoolingOptions poolingOptions = new PoolingOptions()                                     </span>
<span class="4173548347137079648" onmouseenter="enter('4173548347137079648');" onmouseout="out('4173548347137079648');" style=""> 124                         //Each connection allows a maximum of 64 concurrent requests                     </span>
<span class="6109267905237967219" onmouseenter="enter('6109267905237967219');" onmouseout="out('6109267905237967219');" style=""> 125                         .setMaxRequestsPerConnection(HostDistance.LOCAL, maxRequestsPerConnection)       </span>
<span class="-8245292782127165862" onmouseenter="enter('-8245292782127165862');" onmouseout="out('-8245292782127165862');" style=""> 126                         //Have at least two connections to each machine in the cluster                   </span>
<span class="7216166406224594146" onmouseenter="enter('7216166406224594146');" onmouseout="out('7216166406224594146');" style=""> 127                         .setCoreConnectionsPerHost(HostDistance.LOCAL, coreConnectionsPerHost)           </span>
<span class="-1358272374234048070" onmouseenter="enter('-1358272374234048070');" onmouseout="out('-1358272374234048070');" style=""> 128                         //There are up to eight connections to each machine in the cluster               </span>
<span class="-1698869078338541686" onmouseenter="enter('-1698869078338541686');" onmouseout="out('-1698869078338541686');" style=""> 129                         .setMaxConnectionsPerHost(HostDistance.LOCAL, maxConnectionsPerHost)             </span>
<span class="1548703418514968406" onmouseenter="enter('1548703418514968406');" onmouseout="out('1548703418514968406');" style=""> 130                         .setMaxQueueSize(maxQueueSize)                                                   </span>
<span class="3524981482635418824" onmouseenter="enter('3524981482635418824');" onmouseout="out('3524981482635418824');" style=""> 131                         .setPoolTimeoutMillis(poolTimeoutMillis);                                        </span>
<span class="-3027653360277295120" onmouseenter="enter('-3027653360277295120');" onmouseout="out('-3027653360277295120');" style=""> 132                 //重试策略                                                                                   </span>
<span class="-2500245183701794239" onmouseenter="enter('-2500245183701794239');" onmouseout="out('-2500245183701794239');" style=""> 133                 RetryPolicy retryPolicy = DowngradingConsistencyRetryPolicy.INSTANCE;                    </span>
<span  style=""> 134                                                                                                          </span>
<span class="6634426984636856768" onmouseenter="enter('6634426984636856768');" onmouseout="out('6634426984636856768');" style=""> 135                 for (String server : StringUtils.split(address, &quot;,&quot;)) {                                  </span>
<span class="-4294448682063399613" onmouseenter="enter('-4294448682063399613');" onmouseout="out('-4294448682063399613');" style=""> 136                     cassandraPort = Integer.parseInt(StringUtils.split(server, &quot;:&quot;)[1]);                 </span>
<span class="7751295421103553875" onmouseenter="enter('7751295421103553875');" onmouseout="out('7751295421103553875');" style=""> 137                     serversList.add(InetAddress.getByName(StringUtils.split(server, &quot;:&quot;)[0]));           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 138                 }                                                                                        </span>
<span  style=""> 139                                                                                                          </span>
<span class="3673717518338030181" onmouseenter="enter('3673717518338030181');" onmouseout="out('3673717518338030181');" style=""> 140                 if (userName == null || userName.isEmpty() || password == null || password.isEmpty()) {  </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 141                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 141                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 142                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 143                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 144                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 145                 } else {                                                                                 </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""><abbr title=" 146                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)"> 146                     cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy🔵</abbr></span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 147                             .withPort(cassandraPort)                                                     </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 148                             .withPoolingOptions(poolingOptions).withSocketOptions(so)                    </span>
<span class="-5038512354126172278" onmouseenter="enter('-5038512354126172278');" onmouseout="out('-5038512354126172278');" style=""> 149                             .withCredentials(userName, password)                                         </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 150                             .withQueryOptions(queryOptions).build();                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151                 }                                                                                        </span>
<span class="765464969334355038" onmouseenter="enter('765464969334355038');" onmouseout="out('765464969334355038');" style=""> 152                 // 建立连接 连接已存在的键空间                                                                        </span>
<span class="-6325263381803948308" onmouseenter="enter('-6325263381803948308');" onmouseout="out('-6325263381803948308');" style=""> 153                 session = cluster.connectAsync(database);                                                </span>
<span class="8518739044679915590" onmouseenter="enter('8518739044679915590');" onmouseout="out('8518739044679915590');" style=""> 154                 LOG.info(&quot;connect cassandra is successed!&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155             }                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 156         } catch (Exception e) {                                                                          </span>
<span class="7191685386448857101" onmouseenter="enter('7191685386448857101');" onmouseout="out('7191685386448857101');" style=""> 157             LOG.error(&quot;connect cassandra is error:&quot; + e.getMessage());                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159     }                                                                                                    </span>
<span  style=""> 160                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 161     @Override                                                                                            </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 162     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 162     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultF🔵</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 163         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-7543481252963867116" onmouseenter="enter('-7543481252963867116');" onmouseout="out('-7543481252963867116');" style=""> 164         // connect Cassandra                                                                             </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style=""> 165         connCassandraDB(cassandraSideTableInfo);                                                         </span>
<span class="8684725255804702151" onmouseenter="enter('8684725255804702151');" onmouseout="out('8684725255804702151');" style=""><abbr title=" 166         String sqlCondition = ((sideInfo.getSqlCondition() + &quot; &quot;) + buildWhereCondition(inputParams)) + &quot;  ALLOW FILTERING &quot;;"> 166         String sqlCondition = ((sideInfo.getSqlCondition() + &quot; &quot;) + buildWhereCondition(inputParams)) + &quot;🔵</abbr></span>
<span class="7534463150884306489" onmouseenter="enter('7534463150884306489');" onmouseout="out('7534463150884306489');" style=""><abbr title=" 167         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session, new AsyncFunction&lt;Session, ResultSet&gt;() {"> 167         ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session, new AsyncFunction&lt;Session🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 168             @Override                                                                                    </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style=""> 169             public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {                 </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style=""> 170                 return session.executeAsync(sqlCondition);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 172         });                                                                                              </span>
<span class="4580799114599098515" onmouseenter="enter('4580799114599098515');" onmouseout="out('4580799114599098515');" style=""><abbr title=" 173         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet, new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {"> 173         ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet, new Func🔵</abbr></span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 174             @Override                                                                                    </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style=""> 175             public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                              </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style=""> 176                 return rs.all();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 178         });                                                                                              </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style=""> 179         Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {             </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 180             @Override                                                                                    </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style=""> 181             public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 182                 cluster.closeAsync();                                                                    </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style=""> 183                 if (rows.size() &gt; 0) {                                                                   </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style=""> 184                     List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();              </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 185                     List&lt;CRow&gt; rowList = Lists.newArrayList();                                           </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style=""> 186                     for (com.datastax.driver.core.Row line : rows) {                                     </span>
<span class="5316099920929274958" onmouseenter="enter('5316099920929274958');" onmouseout="out('5316099920929274958');" style=""> 187                         Row row = fillData(input.row(), line);                                           </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 188                         if (openCache()) {                                                               </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 189                             cacheContent.add(line);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190                         }                                                                                </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style=""> 191                         rowList.add(new CRow(row, input.change()));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192                     }                                                                                    </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 193                     resultFuture.complete(rowList);                                                      </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 194                     if (openCache()) {                                                                   </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 195                         putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));</span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 197                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 198                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 199                     if (openCache()) {                                                                   </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 200                         putCache(key, CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201                     }                                                                                    </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 202                     resultFuture.complete(null);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204             }                                                                                            </span>
<span  style=""> 205                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206             @Override                                                                                    </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style=""> 207             public void onFailure(Throwable t) {                                                         </span>
<span class="3913011627542202734" onmouseenter="enter('3913011627542202734');" onmouseout="out('3913011627542202734');" style=""> 208                 LOG.error(&quot;Failed to retrieve the data: %s%n&quot;, t.getMessage());                          </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 209                 cluster.closeAsync();                                                                    </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style=""> 210                 resultFuture.completeExceptionally(t);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 212         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 215     @Override                                                                                            </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style=""> 216     public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                       </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 217         StringBuilder sb = new StringBuilder();                                                          </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style=""> 218         for (Object ele : inputParams.values()) {                                                        </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style=""> 219             sb.append(ele.toString()).append(&quot;_&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 220         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 221         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222     }                                                                                                    </span>
<span  style=""> 223                                                                                                          </span>
<span class="2426544394581746935" onmouseenter="enter('2426544394581746935');" onmouseout="out('2426544394581746935');" style=""> 224     private String buildWhereCondition(Map&lt;String, Object&gt; inputParams) {                                </span>
<span class="5090364847803370614" onmouseenter="enter('5090364847803370614');" onmouseout="out('5090364847803370614');" style=""> 225         StringBuilder sb = new StringBuilder(&quot; where &quot;);                                                 </span>
<span class="8472873096625691971" onmouseenter="enter('8472873096625691971');" onmouseout="out('8472873096625691971');" style=""> 226         for (Map.Entry&lt;String, Object&gt; entry : inputParams.entrySet()) {                                 </span>
<span class="3418591347883746922" onmouseenter="enter('3418591347883746922');" onmouseout="out('3418591347883746922');" style=""><abbr title=" 227             Object value = (entry.getValue() instanceof String) ? (&quot;&#x27;&quot; + entry.getValue()) + &quot;&#x27;&quot; : entry.getValue();"> 227             Object value = (entry.getValue() instanceof String) ? (&quot;&#x27;&quot; + entry.getValue()) + &quot;&#x27;&quot; : entry.🔵</abbr></span>
<span class="-2126749103831887182" onmouseenter="enter('-2126749103831887182');" onmouseout="out('-2126749103831887182');" style=""> 228             sb.append(String.format(&quot;%s = %s&quot;, entry.getKey(), value));                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 229         }                                                                                                </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 230         return sb.toString();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231     }                                                                                                    </span>
<span  style=""> 232                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 233     @Override                                                                                            </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 234     public Row fillData(Row input, Object line) {                                                        </span>
<span class="-1556735922244622351" onmouseenter="enter('-1556735922244622351');" onmouseout="out('-1556735922244622351');" style=""> 235         com.datastax.driver.core.Row rowArray = (com.datastax.driver.core.Row) line;                     </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 236         Row row = new Row(sideInfo.getOutFieldInfoList().size());                                        </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 237         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 238             Object obj = input.getField(entry.getValue());                                               </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 239             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 239             boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRo🔵</abbr></span>
<span  style=""> 240                                                                                                          </span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 241             if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                   </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 242                 obj = ((Timestamp) obj).getTime();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243             }                                                                                            </span>
<span  style=""> 244                                                                                                          </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 245             row.setField(entry.getKey(), obj);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246         }                                                                                                </span>
<span  style=""> 247                                                                                                          </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 248         for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {              </span>
<span class="-844467095686898872" onmouseenter="enter('-844467095686898872');" onmouseout="out('-844467095686898872');" style=""> 249             if (rowArray == null) {                                                                      </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 250                 row.setField(entry.getKey(), null);                                                      </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 251             } else {                                                                                     </span>
<span class="-7910331794290062112" onmouseenter="enter('-7910331794290062112');" onmouseout="out('-7910331794290062112');" style=""> 252                 row.setField(entry.getKey(), rowArray.getObject(entry.getValue()));                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254         }                                                                                                </span>
<span  style=""> 255                                                                                                          </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 256         return row;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257     }                                                                                                    </span>
<span  style=""> 258                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 259     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 260     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 261         super.close();                                                                                   </span>
<span class="7236775322084046720" onmouseenter="enter('7236775322084046720');" onmouseout="out('7236775322084046720');" style=""> 262         if (cluster != null) {                                                                           </span>
<span class="-7802554339096083826" onmouseenter="enter('-7802554339096083826');" onmouseout="out('-7802554339096083826');" style=""> 263             cluster.close();                                                                             </span>
<span class="-8433337576020477133" onmouseenter="enter('-8433337576020477133');" onmouseout="out('-8433337576020477133');" style=""> 264             cluster = null;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267 }                                                                                                        </span>









































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-167599954638689123" onmouseenter="enter('-167599954638689123');" onmouseout="out('-167599954638689123');" style="">  20  package com.dtstack.flink.sql.side.cassandra;                                                                     </span>
<span  style="">  21                                                                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  25  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  26  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  28                                                                                                                    </span>
<span class="-4674624431842718354" onmouseenter="enter('-4674624431842718354');" onmouseout="out('-4674624431842718354');" style="">  29  import com.datastax.driver.core.Cluster;                                                                          </span>
<span class="4630389600773953361" onmouseenter="enter('4630389600773953361');" onmouseout="out('4630389600773953361');" style="">  30  import com.datastax.driver.core.ConsistencyLevel;                                                                 </span>
<span class="-5077913371267042181" onmouseenter="enter('-5077913371267042181');" onmouseout="out('-5077913371267042181');" style="">  31  import com.datastax.driver.core.HostDistance;                                                                     </span>
<span class="-8460078615292194921" onmouseenter="enter('-8460078615292194921');" onmouseout="out('-8460078615292194921');" style="">  32  import com.datastax.driver.core.PoolingOptions;                                                                   </span>
<span class="3500480560938999402" onmouseenter="enter('3500480560938999402');" onmouseout="out('3500480560938999402');" style="">  33  import com.datastax.driver.core.QueryOptions;                                                                     </span>
<span class="1295458347604392536" onmouseenter="enter('1295458347604392536');" onmouseout="out('1295458347604392536');" style="">  34  import com.datastax.driver.core.ResultSet;                                                                        </span>
<span class="-2921924295373051715" onmouseenter="enter('-2921924295373051715');" onmouseout="out('-2921924295373051715');" style="">  35  import com.datastax.driver.core.Session;                                                                          </span>
<span class="7536185860942072783" onmouseenter="enter('7536185860942072783');" onmouseout="out('7536185860942072783');" style="">  36  import com.datastax.driver.core.SocketOptions;                                                                    </span>
<span class="102554056665873953" onmouseenter="enter('102554056665873953');" onmouseout="out('102554056665873953');" style="">  37  import com.datastax.driver.core.policies.DowngradingConsistencyRetryPolicy;                                       </span>
<span class="384780421342561763" onmouseenter="enter('384780421342561763');" onmouseout="out('384780421342561763');" style="">  38  import com.datastax.driver.core.policies.RetryPolicy;                                                             </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  39  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  40  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  41  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  42  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  43  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  44  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  45  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="1325017007675469198" onmouseenter="enter('1325017007675469198');" onmouseout="out('1325017007675469198');" style="">  46  import com.dtstack.flink.sql.side.cassandra.table.CassandraSideTableInfo;                                         </span>
<span class="-8710273414755433249" onmouseenter="enter('-8710273414755433249');" onmouseout="out('-8710273414755433249');" style="">  47  import com.google.common.base.Function;                                                                           </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  48  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4265236954961374581" onmouseenter="enter('-4265236954961374581');" onmouseout="out('-4265236954961374581');" style="">  49  import com.google.common.util.concurrent.AsyncFunction;                                                           </span>
<span class="3392144801777607486" onmouseenter="enter('3392144801777607486');" onmouseout="out('3392144801777607486');" style="">  50  import com.google.common.util.concurrent.FutureCallback;                                                          </span>
<span class="-3207866063314364212" onmouseenter="enter('-3207866063314364212');" onmouseout="out('-3207866063314364212');" style="">  51  import com.google.common.util.concurrent.Futures;                                                                 </span>
<span class="2803111898123627106" onmouseenter="enter('2803111898123627106');" onmouseout="out('2803111898123627106');" style="">  52  import com.google.common.util.concurrent.ListenableFuture;                                                        </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  53  import io.vertx.core.json.JsonArray;                                                                              </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  54  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  57                                                                                                                    </span>
<span class="-5790770097715703577" onmouseenter="enter('-5790770097715703577');" onmouseout="out('-5790770097715703577');" style="">  58  import java.net.InetAddress;                                                                                      </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  59  import java.sql.Timestamp;                                                                                        </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60  import java.util.ArrayList;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  61  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  62  import java.util.Map;                                                                                             </span>
<span  style="">  63                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  65   * Reason:                                                                                                        </span>
<span class="-6869475929847104911" onmouseenter="enter('-6869475929847104911');" onmouseout="out('-6869475929847104911');" style="">  66   * Date: 2018/11/22                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67   *                                                                                                                </span>
<span class="-3762428130562648" onmouseenter="enter('-3762428130562648');" onmouseout="out('-3762428130562648');" style="">  68   * @author xuqianjin                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69   */                                                                                                               </span>
<span class="-137893776588311003" onmouseenter="enter('-137893776588311003');" onmouseout="out('-137893776588311003');" style="">  70  public class CassandraAsyncReqRow extends BaseAsyncReqRow {                                                       </span>
<span  style="">  71                                                                                                                    </span>
<span class="-474972292974325668" onmouseenter="enter('-474972292974325668');" onmouseout="out('-474972292974325668');" style="">  72      private static final long serialVersionUID = 6631584128079864735L;                                            </span>
<span  style="">  73                                                                                                                    </span>
<span class="-8305758559523834163" onmouseenter="enter('-8305758559523834163');" onmouseout="out('-8305758559523834163');" style="">  74      private static final Logger LOG = LoggerFactory.getLogger(CassandraAsyncReqRow.class);                        </span>
<span  style="">  75                                                                                                                    </span>
<span class="-4149057034501610834" onmouseenter="enter('-4149057034501610834');" onmouseout="out('-4149057034501610834');" style="">  76      private final static int DEFAULT_VERTX_EVENT_LOOP_POOL_SIZE = 10;                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="-4781889690315923879" onmouseenter="enter('-4781889690315923879');" onmouseout="out('-4781889690315923879');" style="">  78      private final static int DEFAULT_VERTX_WORKER_POOL_SIZE = 20;                                                 </span>
<span  style="">  79                                                                                                                    </span>
<span class="8731062638120855225" onmouseenter="enter('8731062638120855225');" onmouseout="out('8731062638120855225');" style="">  80      private final static int DEFAULT_MAX_DB_CONN_POOL_SIZE = 20;                                                  </span>
<span  style="">  81                                                                                                                    </span>
<span class="-5403177446568963001" onmouseenter="enter('-5403177446568963001');" onmouseout="out('-5403177446568963001');" style="">  82      private transient Cluster cluster;                                                                            </span>
<span class="-8047386482861852310" onmouseenter="enter('-8047386482861852310');" onmouseout="out('-8047386482861852310');" style="">  83      private transient ListenableFuture session;                                                                   </span>
<span class="-1659440015873934350" onmouseenter="enter('-1659440015873934350');" onmouseout="out('-1659440015873934350');" style="">  84      private transient CassandraSideTableInfo cassandraSideTableInfo;                                              </span>
<span  style="">  85                                                                                                                    </span>
<span class="8250235661803572167" onmouseenter="enter('8250235661803572167');" onmouseout="out('8250235661803572167');" style=""><abbr title="  86      public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  86      public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, Abst🔵</abbr></span>
<span class="2131899768365277438" onmouseenter="enter('2131899768365277438');" onmouseout="out('2131899768365277438');" style=""><abbr title="  87          super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));">  87          super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoL🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88      }                                                                                                             </span>
<span  style="">  89                                                                                                                    </span>
<span  style="">  90                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  92      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  93          super.open(parameters);                                                                                   </span>
<span class="-5020317085273715278" onmouseenter="enter('-5020317085273715278');" onmouseout="out('-5020317085273715278');" style="">  94          cassandraSideTableInfo = (CassandraSideTableInfo) sideInfo.getSideTableInfo();                            </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="">  95          connCassandraDB(cassandraSideTableInfo);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="2688225595233570188" onmouseenter="enter('2688225595233570188');" onmouseout="out('2688225595233570188');" style="">  98      private void connCassandraDB(CassandraSideTableInfo tableInfo) {                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  99          try {                                                                                                     </span>
<span class="417819926325380348" onmouseenter="enter('417819926325380348');" onmouseout="out('417819926325380348');" style=""> 100              if (session == null) {                                                                                </span>
<span class="-3605639280329188999" onmouseenter="enter('-3605639280329188999');" onmouseout="out('-3605639280329188999');" style=""> 101                  QueryOptions queryOptions = new QueryOptions();                                                   </span>
<span class="5842973418300621663" onmouseenter="enter('5842973418300621663');" onmouseout="out('5842973418300621663');" style=""> 102                  //The default consistency level for queries: ConsistencyLevel.TWO.                                </span>
<span class="76010926262385906" onmouseenter="enter('76010926262385906');" onmouseout="out('76010926262385906');" style=""> 103                  queryOptions.setConsistencyLevel(ConsistencyLevel.QUORUM);                                        </span>
<span class="-4388406259332422062" onmouseenter="enter('-4388406259332422062');" onmouseout="out('-4388406259332422062');" style=""><abbr title=" 104                  Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo.getMaxRequestsPerConnection();"> 104                  Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo🔵</abbr></span>
<span class="-6698153752588261803" onmouseenter="enter('-6698153752588261803');" onmouseout="out('-6698153752588261803');" style=""><abbr title=" 105                  Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.getCoreConnectionsPerHost();"> 105                  Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.get🔵</abbr></span>
<span class="3809961524454958986" onmouseenter="enter('3809961524454958986');" onmouseout="out('3809961524454958986');" style=""><abbr title=" 106                  Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.getMaxConnectionsPerHost();"> 106                  Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.g🔵</abbr></span>
<span class="-3297929912963114654" onmouseenter="enter('-3297929912963114654');" onmouseout="out('-3297929912963114654');" style=""> 107                  Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQueueSize();</span>
<span class="-1822015680936096661" onmouseenter="enter('-1822015680936096661');" onmouseout="out('-1822015680936096661');" style=""><abbr title=" 108                  Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTimeoutMillis();"> 108                  Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTi🔵</abbr></span>
<span class="5588349030185896717" onmouseenter="enter('5588349030185896717');" onmouseout="out('5588349030185896717');" style=""><abbr title=" 109                  Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.getConnectTimeoutMillis();"> 109                  Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.get🔵</abbr></span>
<span class="5493190487826327243" onmouseenter="enter('5493190487826327243');" onmouseout="out('5493190487826327243');" style=""><abbr title=" 110                  Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTimeoutMillis();"> 110                  Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTi🔵</abbr></span>
<span class="-5259680847618191912" onmouseenter="enter('-5259680847618191912');" onmouseout="out('-5259680847618191912');" style=""> 111                  Integer cassandraPort = 0;                                                                        </span>
<span class="-8848193911625825371" onmouseenter="enter('-8848193911625825371');" onmouseout="out('-8848193911625825371');" style=""> 112                  String address = tableInfo.getAddress();                                                          </span>
<span class="2950506038619853549" onmouseenter="enter('2950506038619853549');" onmouseout="out('2950506038619853549');" style=""> 113                  String userName = tableInfo.getUserName();                                                        </span>
<span class="-4521409941966564293" onmouseenter="enter('-4521409941966564293');" onmouseout="out('-4521409941966564293');" style=""> 114                  String password = tableInfo.getPassword();                                                        </span>
<span class="-6108815609943098672" onmouseenter="enter('-6108815609943098672');" onmouseout="out('-6108815609943098672');" style=""> 115                  String database = tableInfo.getDatabase();                                                        </span>
<span  style=""> 116                                                                                                                    </span>
<span class="6493913905304408918" onmouseenter="enter('6493913905304408918');" onmouseout="out('6493913905304408918');" style=""> 117                  ArrayList serversList = new ArrayList();                                                          </span>
<span class="5423738273364037419" onmouseenter="enter('5423738273364037419');" onmouseout="out('5423738273364037419');" style=""> 118                  //Read timeout or connection timeout Settings                                                     </span>
<span class="-1651403584650918350" onmouseenter="enter('-1651403584650918350');" onmouseout="out('-1651403584650918350');" style=""> 119                  SocketOptions so = new SocketOptions()                                                            </span>
<span class="-6143815205992723671" onmouseenter="enter('-6143815205992723671');" onmouseout="out('-6143815205992723671');" style=""> 120                          .setReadTimeoutMillis(readTimeoutMillis)                                                  </span>
<span class="-7477024419561329894" onmouseenter="enter('-7477024419561329894');" onmouseout="out('-7477024419561329894');" style=""> 121                          .setConnectTimeoutMillis(connectTimeoutMillis);                                           </span>
<span  style=""> 122                                                                                                                    </span>
<span class="36776837264098679" onmouseenter="enter('36776837264098679');" onmouseout="out('36776837264098679');" style=""> 123                  //The cluster USES hostdistance.local in the same machine room                                    </span>
<span class="-4067753854505755618" onmouseenter="enter('-4067753854505755618');" onmouseout="out('-4067753854505755618');" style=""> 124                  //Hostdistance. REMOTE is used for different machine rooms                                        </span>
<span class="-1239540897477970915" onmouseenter="enter('-1239540897477970915');" onmouseout="out('-1239540897477970915');" style=""> 125                  //Ignore use HostDistance. IGNORED                                                                </span>
<span class="7507936330523201209" onmouseenter="enter('7507936330523201209');" onmouseout="out('7507936330523201209');" style=""> 126                  PoolingOptions poolingOptions = new PoolingOptions()                                              </span>
<span class="4173548347137079648" onmouseenter="enter('4173548347137079648');" onmouseout="out('4173548347137079648');" style=""> 127                          //Each connection allows a maximum of 64 concurrent requests                              </span>
<span class="6109267905237967219" onmouseenter="enter('6109267905237967219');" onmouseout="out('6109267905237967219');" style=""> 128                          .setMaxRequestsPerConnection(HostDistance.LOCAL, maxRequestsPerConnection)                </span>
<span class="-8245292782127165862" onmouseenter="enter('-8245292782127165862');" onmouseout="out('-8245292782127165862');" style=""> 129                          //Have at least two connections to each machine in the cluster                            </span>
<span class="7216166406224594146" onmouseenter="enter('7216166406224594146');" onmouseout="out('7216166406224594146');" style=""> 130                          .setCoreConnectionsPerHost(HostDistance.LOCAL, coreConnectionsPerHost)                    </span>
<span class="-1358272374234048070" onmouseenter="enter('-1358272374234048070');" onmouseout="out('-1358272374234048070');" style=""> 131                          //There are up to eight connections to each machine in the cluster                        </span>
<span class="-1698869078338541686" onmouseenter="enter('-1698869078338541686');" onmouseout="out('-1698869078338541686');" style=""> 132                          .setMaxConnectionsPerHost(HostDistance.LOCAL, maxConnectionsPerHost)                      </span>
<span class="1548703418514968406" onmouseenter="enter('1548703418514968406');" onmouseout="out('1548703418514968406');" style=""> 133                          .setMaxQueueSize(maxQueueSize)                                                            </span>
<span class="3524981482635418824" onmouseenter="enter('3524981482635418824');" onmouseout="out('3524981482635418824');" style=""> 134                          .setPoolTimeoutMillis(poolTimeoutMillis);                                                 </span>
<span class="-3027653360277295120" onmouseenter="enter('-3027653360277295120');" onmouseout="out('-3027653360277295120');" style=""> 135                  //重试策略                                                                                            </span>
<span class="-2500245183701794239" onmouseenter="enter('-2500245183701794239');" onmouseout="out('-2500245183701794239');" style=""> 136                  RetryPolicy retryPolicy = DowngradingConsistencyRetryPolicy.INSTANCE;                             </span>
<span  style=""> 137                                                                                                                    </span>
<span class="6634426984636856768" onmouseenter="enter('6634426984636856768');" onmouseout="out('6634426984636856768');" style=""> 138                  for (String server : StringUtils.split(address, &quot;,&quot;)) {                                           </span>
<span class="-4294448682063399613" onmouseenter="enter('-4294448682063399613');" onmouseout="out('-4294448682063399613');" style=""> 139                      cassandraPort = Integer.parseInt(StringUtils.split(server, &quot;:&quot;)[1]);                          </span>
<span class="7751295421103553875" onmouseenter="enter('7751295421103553875');" onmouseout="out('7751295421103553875');" style=""> 140                      serversList.add(InetAddress.getByName(StringUtils.split(server, &quot;:&quot;)[0]));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141                  }                                                                                                 </span>
<span  style=""> 142                                                                                                                    </span>
<span class="3673717518338030181" onmouseenter="enter('3673717518338030181');" onmouseout="out('3673717518338030181');" style=""> 143                  if (userName == null || userName.isEmpty() || password == null || password.isEmpty()) {           </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""> 144                      cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)        </span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 145                              .withPort(cassandraPort)                                                              </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 146                              .withPoolingOptions(poolingOptions).withSocketOptions(so)                             </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 147                              .withQueryOptions(queryOptions).build();                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 148                  } else {                                                                                          </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""> 149                      cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)        </span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 150                              .withPort(cassandraPort)                                                              </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 151                              .withPoolingOptions(poolingOptions).withSocketOptions(so)                             </span>
<span class="-5038512354126172278" onmouseenter="enter('-5038512354126172278');" onmouseout="out('-5038512354126172278');" style=""> 152                              .withCredentials(userName, password)                                                  </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 153                              .withQueryOptions(queryOptions).build();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                  }                                                                                                 </span>
<span class="765464969334355038" onmouseenter="enter('765464969334355038');" onmouseout="out('765464969334355038');" style=""> 155                  // 建立连接 连接已存在的键空间                                                                                 </span>
<span class="-6325263381803948308" onmouseenter="enter('-6325263381803948308');" onmouseout="out('-6325263381803948308');" style=""> 156                  session = cluster.connectAsync(database);                                                         </span>
<span class="8518739044679915590" onmouseenter="enter('8518739044679915590');" onmouseout="out('8518739044679915590');" style=""> 157                  LOG.info(&quot;connect cassandra is successed!&quot;);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158              }                                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 159          } catch (Exception e) {                                                                                   </span>
<span class="7191685386448857101" onmouseenter="enter('7191685386448857101');" onmouseout="out('7191685386448857101');" style=""> 160              LOG.error(&quot;connect cassandra is error:&quot; + e.getMessage());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 165 -    public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 166 -        CRow inputCopy = new CRow(input.row(), input.change());                                                   </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -        JsonArray inputParams = new JsonArray();                                                                  </span>
<span class="7298653858488117630" onmouseenter="enter('7298653858488117630');" onmouseout="out('7298653858488117630');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -        StringBuffer stringBuffer = new StringBuffer();                                                           </span>
<span class="-4783111457257452314" onmouseenter="enter('-4783111457257452314');" onmouseout="out('-4783111457257452314');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -        String sqlWhere = &quot; where &quot;;                                                                              </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -                                                                                                                  </span>
<span class="-8402687189436648246" onmouseenter="enter('-8402687189436648246');" onmouseout="out('-8402687189436648246');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 171 -        for (int i = 0; i &lt; sideInfo.getEqualFieldList().size(); i++) {                                           </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 172 -            Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 173 -            Object equalObj = inputCopy.row().getField(conValIndex);                                              </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 174 -            if (equalObj == null) {                                                                               </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 175 -                dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 176 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 177 -            }                                                                                                     </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 178 -            inputParams.add(equalObj);                                                                            </span>
<span class="6844316250995394013" onmouseenter="enter('6844316250995394013');" onmouseout="out('6844316250995394013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 179 -            StringBuffer sqlTemp = stringBuffer.append(sideInfo.getEqualFieldList().get(i))                       </span>
<span class="4506040730369527852" onmouseenter="enter('4506040730369527852');" onmouseout="out('4506040730369527852');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 180 -                    .append(&quot; = &quot;);                                                                               </span>
<span class="6706079886736437259" onmouseenter="enter('6706079886736437259');" onmouseout="out('6706079886736437259');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 181 -            if (equalObj instanceof String) {                                                                     </span>
<span class="147067916336825508" onmouseenter="enter('147067916336825508');" onmouseout="out('147067916336825508');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 182 -                sqlTemp.append(&quot;&#x27;&quot; + equalObj + &quot;&#x27;&quot;)                                                              </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 183 -                        .append(&quot; and &quot;);                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 184 -            } else {                                                                                              </span>
<span class="-2928507733810337143" onmouseenter="enter('-2928507733810337143');" onmouseout="out('-2928507733810337143');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 185 -                sqlTemp.append(equalObj)                                                                          </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 186 -                        .append(&quot; and &quot;);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 187 -            }                                                                                                     </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 188 -                                                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 189 -        }                                                                                                         </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 190 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 190 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) th🔵</abbr></span>
<span  style=""> 191                                                                                                                    </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 192          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-7558523756689931178" onmouseenter="enter('-7558523756689931178');" onmouseout="out('-7558523756689931178');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 193 -        sqlWhere = sqlWhere + stringBuffer.toString().substring(0, stringBuffer.lastIndexOf(&quot; and &quot;));            </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 194 -                                                                                                                  </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 195 -        if (openCache()) {                                                                                        </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 196 -            CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 197 -            if (val != null) {                                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 198 -                                                                                                                  </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 199 -                if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 200 -                    dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 201 -                    return;                                                                                       </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 202 -                } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 203 -                    List&lt;CRow&gt; rowList = Lists.newArrayList();                                                    </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 204 -                    for (Object jsonArray : (List) val.getContent()) {                                            </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 205 -                        Row row = fillData(inputCopy.row(), jsonArray);                                           </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 206 -                        rowList.add(new CRow(row, inputCopy.change()));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 207 -                    }                                                                                             </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 208 -                    resultFuture.complete(rowList);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 209 -                } else {                                                                                          </span>
<span class="-1323059185501153522" onmouseenter="enter('-1323059185501153522');" onmouseout="out('-1323059185501153522');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 210 -                    throw new RuntimeException(&quot;not support cache obj type &quot; + val.getType());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 211 -                }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 212 -                return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 213 -            }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 214 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 215 -                                                                                                                  </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style=""> 216          //connect Cassandra                                                                                       </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style=""> 217          connCassandraDB(cassandraSideTableInfo);                                                                  </span>
<span  style=""> 218                                                                                                                    </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -        String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;                 </span>
<span class="2890792881476289631" onmouseenter="enter('2890792881476289631');" onmouseout="out('2890792881476289631');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 220 -        System.out.println(&quot;sqlCondition:&quot; + sqlCondition);                                                       </span>
<span class="8882875172916837309" onmouseenter="enter('8882875172916837309');" onmouseout="out('8882875172916837309');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 221 +        String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  ALLOW FILTERING &quot;;"> 221 +        String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + buildWhereCondition(inputParams) + &quot;  ALLOW FILTE🔵</abbr></span>
<span  style=""> 222                                                                                                                    </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style=""> 223          ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                                   </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style=""> 224                  new AsyncFunction&lt;Session, ResultSet&gt;() {                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 225                      @Override                                                                                     </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style=""> 226                      public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {                  </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style=""> 227                          return session.executeAsync(sqlCondition);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 229                  });                                                                                               </span>
<span  style=""> 230                                                                                                                    </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style=""> 231          ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,                  </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style=""> 232                  new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 233                      @Override                                                                                     </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style=""> 234                      public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                               </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style=""> 235                          return rs.all();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 236                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 237                  });                                                                                               </span>
<span  style=""> 238                                                                                                                    </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style=""> 239          Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 240              @Override                                                                                             </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style=""> 241              public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                                      </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 242                  cluster.closeAsync();                                                                             </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style=""> 243                  if (rows.size() &gt; 0) {                                                                            </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style=""> 244                      List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();                       </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 245                      List&lt;CRow&gt; rowList = Lists.newArrayList();                                                    </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style=""> 246                      for (com.datastax.driver.core.Row line : rows) {                                              </span>
<span class="4836418702808839962" onmouseenter="enter('4836418702808839962');" onmouseout="out('4836418702808839962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 247 -                        Row row = fillData(inputCopy.row(), line);                                                </span>
<span class="5316099920929274958" onmouseenter="enter('5316099920929274958');" onmouseout="out('5316099920929274958');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 248 +                        Row row = fillData(input.row(), line);                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 249                          if (openCache()) {                                                                        </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 250                              cacheContent.add(line);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                          }                                                                                         </span>
<span class="-1174022488282524551" onmouseenter="enter('-1174022488282524551');" onmouseout="out('-1174022488282524551');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 252 -                        rowList.add(new CRow(row,inputCopy.change()));                                            </span>
<span class="5232888746699619450" onmouseenter="enter('5232888746699619450');" onmouseout="out('5232888746699619450');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 253 +                        rowList.add(new CRow(row, input.change()));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 254                      }                                                                                             </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 255                      resultFuture.complete(rowList);                                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 256                      if (openCache()) {                                                                            </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 257                          putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 259                  } else {                                                                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 260 -                    dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 261 +                    dealMissKey(input, resultFuture);                                                             </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 262                      if (openCache()) {                                                                            </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 263                          putCache(key, CacheMissVal.getMissKeyObj());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264                      }                                                                                             </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 265                      resultFuture.complete(null);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267              }                                                                                                     </span>
<span  style=""> 268                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 269              @Override                                                                                             </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style=""> 270              public void onFailure(Throwable t) {                                                                  </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style=""> 271                  LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                                    </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style=""> 272                          t.getMessage());                                                                          </span>
<span class="6562988686685479683" onmouseenter="enter('6562988686685479683');" onmouseout="out('6562988686685479683');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 273 -                System.out.println(&quot;Failed to retrieve the data: &quot; + t.getMessage());                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 274                  cluster.closeAsync();                                                                             </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style=""> 275                  resultFuture.completeExceptionally(t);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 277          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 278 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 279 +                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 280 +    @Override                                                                                                     </span>
<span class="6374398777166986707" onmouseenter="enter('6374398777166986707');" onmouseout="out('6374398777166986707');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 281 +    public String buildCacheKey(Map&lt;String, Object&gt; inputParams) {                                                </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 282 +        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="-3940662932484837264" onmouseenter="enter('-3940662932484837264');" onmouseout="out('-3940662932484837264');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 283 +        for (Object ele : inputParams.values()) {                                                                 </span>
<span class="-2299905763852680760" onmouseenter="enter('-2299905763852680760');" onmouseout="out('-2299905763852680760');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 284 +            sb.append(ele.toString()).append(&quot;_&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 285 +        }                                                                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 286 +        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 287 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 288 +                                                                                                                  </span>
<span class="-1821575284166957660" onmouseenter="enter('-1821575284166957660');" onmouseout="out('-1821575284166957660');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 289 +    private String buildWhereCondition(Map&lt;String, Object&gt; inputParams){                                          </span>
<span class="5090364847803370614" onmouseenter="enter('5090364847803370614');" onmouseout="out('5090364847803370614');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 290 +        StringBuilder sb = new StringBuilder(&quot; where &quot;);                                                          </span>
<span class="-7053571210782116126" onmouseenter="enter('-7053571210782116126');" onmouseout="out('-7053571210782116126');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 291 +        for(Map.Entry&lt;String, Object&gt; entry : inputParams.entrySet()){                                            </span>
<span class="-3077711825568802702" onmouseenter="enter('-3077711825568802702');" onmouseout="out('-3077711825568802702');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 292 +            Object value = entry.getValue() instanceof String ? &quot;&#x27;&quot; + entry.getValue() + &quot;&#x27;&quot; : entry.getValue();  </span>
<span class="-2126749103831887182" onmouseenter="enter('-2126749103831887182');" onmouseout="out('-2126749103831887182');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 293 +            sb.append(String.format(&quot;%s = %s&quot;, entry.getKey(), value));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 294 +        }                                                                                                         </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 295 +        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296      }                                                                                                             </span>
<span  style=""> 297                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 298      @Override                                                                                                     </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 299      public Row fillData(Row input, Object line) {                                                                 </span>
<span class="-1556735922244622351" onmouseenter="enter('-1556735922244622351');" onmouseout="out('-1556735922244622351');" style=""> 300          com.datastax.driver.core.Row rowArray = (com.datastax.driver.core.Row) line;                              </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 301          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 302          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 303              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 304              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 304              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span  style=""> 305                                                                                                                    </span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 306              if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 307                  obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308              }                                                                                                     </span>
<span  style=""> 309                                                                                                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 310              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311          }                                                                                                         </span>
<span  style=""> 312                                                                                                                    </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 313          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {                       </span>
<span class="-844467095686898872" onmouseenter="enter('-844467095686898872');" onmouseout="out('-844467095686898872');" style=""> 314              if (rowArray == null) {                                                                               </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 315                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 316              } else {                                                                                              </span>
<span class="-7910331794290062112" onmouseenter="enter('-7910331794290062112');" onmouseout="out('-7910331794290062112');" style=""> 317                  row.setField(entry.getKey(), rowArray.getObject(entry.getValue()));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 318              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319          }                                                                                                         </span>
<span  style=""> 320                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 321          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322      }                                                                                                             </span>
<span  style=""> 323                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 324      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 325      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 326          super.close();                                                                                            </span>
<span class="7236775322084046720" onmouseenter="enter('7236775322084046720');" onmouseout="out('7236775322084046720');" style=""> 327          if (cluster != null) {                                                                                    </span>
<span class="-7802554339096083826" onmouseenter="enter('-7802554339096083826');" onmouseout="out('-7802554339096083826');" style=""> 328              cluster.close();                                                                                      </span>
<span class="-8433337576020477133" onmouseenter="enter('-8433337576020477133');" onmouseout="out('-8433337576020477133');" style=""> 329              cluster = null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331      }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 332 -                                                                                                                  </span>
<span class="-3405798300685646496" onmouseenter="enter('-3405798300685646496');" onmouseout="out('-3405798300685646496');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 333 -    public String buildCacheKey(JsonArray jsonArray) {                                                            </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 334 -        StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="5542959958101405176" onmouseenter="enter('5542959958101405176');" onmouseout="out('5542959958101405176');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 335 -        for (Object ele : jsonArray.getList()) {                                                                  </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 336 -            sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 337 -                    .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 338 -        }                                                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 339 -                                                                                                                  </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 340 -        return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 341 -    }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span  style="">  19                                                                                                                    </span>
<span class="-167599954638689123" onmouseenter="enter('-167599954638689123');" onmouseout="out('-167599954638689123');" style="">  20  package com.dtstack.flink.sql.side.cassandra;                                                                     </span>
<span  style="">  21                                                                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  22  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  23  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  24  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  25  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="7274147440675030535" onmouseenter="enter('7274147440675030535');" onmouseout="out('7274147440675030535');" style="">  26  import org.apache.flink.table.typeutils.TimeIndicatorTypeInfo;                                                    </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  27  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  28                                                                                                                    </span>
<span class="-4674624431842718354" onmouseenter="enter('-4674624431842718354');" onmouseout="out('-4674624431842718354');" style="">  29  import com.datastax.driver.core.Cluster;                                                                          </span>
<span class="4630389600773953361" onmouseenter="enter('4630389600773953361');" onmouseout="out('4630389600773953361');" style="">  30  import com.datastax.driver.core.ConsistencyLevel;                                                                 </span>
<span class="-5077913371267042181" onmouseenter="enter('-5077913371267042181');" onmouseout="out('-5077913371267042181');" style="">  31  import com.datastax.driver.core.HostDistance;                                                                     </span>
<span class="-8460078615292194921" onmouseenter="enter('-8460078615292194921');" onmouseout="out('-8460078615292194921');" style="">  32  import com.datastax.driver.core.PoolingOptions;                                                                   </span>
<span class="3500480560938999402" onmouseenter="enter('3500480560938999402');" onmouseout="out('3500480560938999402');" style="">  33  import com.datastax.driver.core.QueryOptions;                                                                     </span>
<span class="1295458347604392536" onmouseenter="enter('1295458347604392536');" onmouseout="out('1295458347604392536');" style="">  34  import com.datastax.driver.core.ResultSet;                                                                        </span>
<span class="-2921924295373051715" onmouseenter="enter('-2921924295373051715');" onmouseout="out('-2921924295373051715');" style="">  35  import com.datastax.driver.core.Session;                                                                          </span>
<span class="7536185860942072783" onmouseenter="enter('7536185860942072783');" onmouseout="out('7536185860942072783');" style="">  36  import com.datastax.driver.core.SocketOptions;                                                                    </span>
<span class="102554056665873953" onmouseenter="enter('102554056665873953');" onmouseout="out('102554056665873953');" style="">  37  import com.datastax.driver.core.policies.DowngradingConsistencyRetryPolicy;                                       </span>
<span class="384780421342561763" onmouseenter="enter('384780421342561763');" onmouseout="out('384780421342561763');" style="">  38  import com.datastax.driver.core.policies.RetryPolicy;                                                             </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  39  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  40  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  41  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  42  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  43  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  44  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  45  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="1325017007675469198" onmouseenter="enter('1325017007675469198');" onmouseout="out('1325017007675469198');" style="">  46  import com.dtstack.flink.sql.side.cassandra.table.CassandraSideTableInfo;                                         </span>
<span class="-8710273414755433249" onmouseenter="enter('-8710273414755433249');" onmouseout="out('-8710273414755433249');" style="">  47  import com.google.common.base.Function;                                                                           </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  48  import com.google.common.collect.Lists;                                                                           </span>
<span class="-4265236954961374581" onmouseenter="enter('-4265236954961374581');" onmouseout="out('-4265236954961374581');" style="">  49  import com.google.common.util.concurrent.AsyncFunction;                                                           </span>
<span class="3392144801777607486" onmouseenter="enter('3392144801777607486');" onmouseout="out('3392144801777607486');" style="">  50  import com.google.common.util.concurrent.FutureCallback;                                                          </span>
<span class="-3207866063314364212" onmouseenter="enter('-3207866063314364212');" onmouseout="out('-3207866063314364212');" style="">  51  import com.google.common.util.concurrent.Futures;                                                                 </span>
<span class="2803111898123627106" onmouseenter="enter('2803111898123627106');" onmouseout="out('2803111898123627106');" style="">  52  import com.google.common.util.concurrent.ListenableFuture;                                                        </span>
<span class="-8491175051504538735" onmouseenter="enter('-8491175051504538735');" onmouseout="out('-8491175051504538735');" style="">  53  import io.vertx.core.json.JsonArray;                                                                              </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  54  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="9072327285961251154" onmouseenter="enter('9072327285961251154');" onmouseout="out('9072327285961251154');" style="">  55  import org.slf4j.Logger;                                                                                          </span>
<span class="697043352225962606" onmouseenter="enter('697043352225962606');" onmouseout="out('697043352225962606');" style="">  56  import org.slf4j.LoggerFactory;                                                                                   </span>
<span  style="">  57                                                                                                                    </span>
<span class="-5790770097715703577" onmouseenter="enter('-5790770097715703577');" onmouseout="out('-5790770097715703577');" style="">  58  import java.net.InetAddress;                                                                                      </span>
<span class="-8993555010225969077" onmouseenter="enter('-8993555010225969077');" onmouseout="out('-8993555010225969077');" style="">  59  import java.sql.Timestamp;                                                                                        </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60  import java.util.ArrayList;                                                                                       </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  61  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  62  import java.util.Map;                                                                                             </span>
<span  style="">  63                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64  /**                                                                                                               </span>
<span class="-8405822225249706226" onmouseenter="enter('-8405822225249706226');" onmouseout="out('-8405822225249706226');" style="">  65   * Reason:                                                                                                        </span>
<span class="-6869475929847104911" onmouseenter="enter('-6869475929847104911');" onmouseout="out('-6869475929847104911');" style="">  66   * Date: 2018/11/22                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67   *                                                                                                                </span>
<span class="-3762428130562648" onmouseenter="enter('-3762428130562648');" onmouseout="out('-3762428130562648');" style="">  68   * @author xuqianjin                                                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  69   */                                                                                                               </span>
<span class="-137893776588311003" onmouseenter="enter('-137893776588311003');" onmouseout="out('-137893776588311003');" style="">  70  public class CassandraAsyncReqRow extends BaseAsyncReqRow {                                                       </span>
<span  style="">  71                                                                                                                    </span>
<span class="-474972292974325668" onmouseenter="enter('-474972292974325668');" onmouseout="out('-474972292974325668');" style="">  72      private static final long serialVersionUID = 6631584128079864735L;                                            </span>
<span  style="">  73                                                                                                                    </span>
<span class="-8305758559523834163" onmouseenter="enter('-8305758559523834163');" onmouseout="out('-8305758559523834163');" style="">  74      private static final Logger LOG = LoggerFactory.getLogger(CassandraAsyncReqRow.class);                        </span>
<span  style="">  75                                                                                                                    </span>
<span class="-4149057034501610834" onmouseenter="enter('-4149057034501610834');" onmouseout="out('-4149057034501610834');" style="">  76      private final static int DEFAULT_VERTX_EVENT_LOOP_POOL_SIZE = 10;                                             </span>
<span  style="">  77                                                                                                                    </span>
<span class="-4781889690315923879" onmouseenter="enter('-4781889690315923879');" onmouseout="out('-4781889690315923879');" style="">  78      private final static int DEFAULT_VERTX_WORKER_POOL_SIZE = 20;                                                 </span>
<span  style="">  79                                                                                                                    </span>
<span class="8731062638120855225" onmouseenter="enter('8731062638120855225');" onmouseout="out('8731062638120855225');" style="">  80      private final static int DEFAULT_MAX_DB_CONN_POOL_SIZE = 20;                                                  </span>
<span  style="">  81                                                                                                                    </span>
<span class="-5403177446568963001" onmouseenter="enter('-5403177446568963001');" onmouseout="out('-5403177446568963001');" style="">  82      private transient Cluster cluster;                                                                            </span>
<span class="-8047386482861852310" onmouseenter="enter('-8047386482861852310');" onmouseout="out('-8047386482861852310');" style="">  83      private transient ListenableFuture session;                                                                   </span>
<span class="-1659440015873934350" onmouseenter="enter('-1659440015873934350');" onmouseout="out('-1659440015873934350');" style="">  84      private transient CassandraSideTableInfo cassandraSideTableInfo;                                              </span>
<span  style="">  85                                                                                                                    </span>
<span class="8250235661803572167" onmouseenter="enter('8250235661803572167');" onmouseout="out('8250235661803572167');" style=""><abbr title="  86      public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  86      public CassandraAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, Abst🔵</abbr></span>
<span class="2131899768365277438" onmouseenter="enter('2131899768365277438');" onmouseout="out('2131899768365277438');" style=""><abbr title="  87          super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));">  87          super(new com.dtstack.flink.sql.side.cassandra.CassandraAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoL🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  88      }                                                                                                             </span>
<span  style="">  89                                                                                                                    </span>
<span  style="">  90                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  92      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  93          super.open(parameters);                                                                                   </span>
<span class="-5020317085273715278" onmouseenter="enter('-5020317085273715278');" onmouseout="out('-5020317085273715278');" style="">  94          cassandraSideTableInfo = (CassandraSideTableInfo) sideInfo.getSideTableInfo();                            </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style="">  95          connCassandraDB(cassandraSideTableInfo);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96      }                                                                                                             </span>
<span  style="">  97                                                                                                                    </span>
<span class="2688225595233570188" onmouseenter="enter('2688225595233570188');" onmouseout="out('2688225595233570188');" style="">  98      private void connCassandraDB(CassandraSideTableInfo tableInfo) {                                              </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style="">  99          try {                                                                                                     </span>
<span class="417819926325380348" onmouseenter="enter('417819926325380348');" onmouseout="out('417819926325380348');" style=""> 100              if (session == null) {                                                                                </span>
<span class="-3605639280329188999" onmouseenter="enter('-3605639280329188999');" onmouseout="out('-3605639280329188999');" style=""> 101                  QueryOptions queryOptions = new QueryOptions();                                                   </span>
<span class="5842973418300621663" onmouseenter="enter('5842973418300621663');" onmouseout="out('5842973418300621663');" style=""> 102                  //The default consistency level for queries: ConsistencyLevel.TWO.                                </span>
<span class="76010926262385906" onmouseenter="enter('76010926262385906');" onmouseout="out('76010926262385906');" style=""> 103                  queryOptions.setConsistencyLevel(ConsistencyLevel.QUORUM);                                        </span>
<span class="-4388406259332422062" onmouseenter="enter('-4388406259332422062');" onmouseout="out('-4388406259332422062');" style=""><abbr title=" 104                  Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo.getMaxRequestsPerConnection();"> 104                  Integer maxRequestsPerConnection = tableInfo.getMaxRequestsPerConnection() == null ? 1 : tableInfo🔵</abbr></span>
<span class="-6698153752588261803" onmouseenter="enter('-6698153752588261803');" onmouseout="out('-6698153752588261803');" style=""><abbr title=" 105                  Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.getCoreConnectionsPerHost();"> 105                  Integer coreConnectionsPerHost = tableInfo.getCoreConnectionsPerHost() == null ? 8 : tableInfo.get🔵</abbr></span>
<span class="3809961524454958986" onmouseenter="enter('3809961524454958986');" onmouseout="out('3809961524454958986');" style=""><abbr title=" 106                  Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.getMaxConnectionsPerHost();"> 106                  Integer maxConnectionsPerHost = tableInfo.getMaxConnectionsPerHost() == null ? 32768 : tableInfo.g🔵</abbr></span>
<span class="-3297929912963114654" onmouseenter="enter('-3297929912963114654');" onmouseout="out('-3297929912963114654');" style=""> 107                  Integer maxQueueSize = tableInfo.getMaxQueueSize() == null ? 100000 : tableInfo.getMaxQueueSize();</span>
<span class="-1822015680936096661" onmouseenter="enter('-1822015680936096661');" onmouseout="out('-1822015680936096661');" style=""><abbr title=" 108                  Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTimeoutMillis();"> 108                  Integer readTimeoutMillis = tableInfo.getReadTimeoutMillis() == null ? 60000 : tableInfo.getReadTi🔵</abbr></span>
<span class="5588349030185896717" onmouseenter="enter('5588349030185896717');" onmouseout="out('5588349030185896717');" style=""><abbr title=" 109                  Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.getConnectTimeoutMillis();"> 109                  Integer connectTimeoutMillis = tableInfo.getConnectTimeoutMillis() == null ? 60000 : tableInfo.get🔵</abbr></span>
<span class="5493190487826327243" onmouseenter="enter('5493190487826327243');" onmouseout="out('5493190487826327243');" style=""><abbr title=" 110                  Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTimeoutMillis();"> 110                  Integer poolTimeoutMillis = tableInfo.getPoolTimeoutMillis() == null ? 60000 : tableInfo.getPoolTi🔵</abbr></span>
<span class="-5259680847618191912" onmouseenter="enter('-5259680847618191912');" onmouseout="out('-5259680847618191912');" style=""> 111                  Integer cassandraPort = 0;                                                                        </span>
<span class="-8848193911625825371" onmouseenter="enter('-8848193911625825371');" onmouseout="out('-8848193911625825371');" style=""> 112                  String address = tableInfo.getAddress();                                                          </span>
<span class="2950506038619853549" onmouseenter="enter('2950506038619853549');" onmouseout="out('2950506038619853549');" style=""> 113                  String userName = tableInfo.getUserName();                                                        </span>
<span class="-4521409941966564293" onmouseenter="enter('-4521409941966564293');" onmouseout="out('-4521409941966564293');" style=""> 114                  String password = tableInfo.getPassword();                                                        </span>
<span class="-6108815609943098672" onmouseenter="enter('-6108815609943098672');" onmouseout="out('-6108815609943098672');" style=""> 115                  String database = tableInfo.getDatabase();                                                        </span>
<span  style=""> 116                                                                                                                    </span>
<span class="6493913905304408918" onmouseenter="enter('6493913905304408918');" onmouseout="out('6493913905304408918');" style=""> 117                  ArrayList serversList = new ArrayList();                                                          </span>
<span class="5423738273364037419" onmouseenter="enter('5423738273364037419');" onmouseout="out('5423738273364037419');" style=""> 118                  //Read timeout or connection timeout Settings                                                     </span>
<span class="-1651403584650918350" onmouseenter="enter('-1651403584650918350');" onmouseout="out('-1651403584650918350');" style=""> 119                  SocketOptions so = new SocketOptions()                                                            </span>
<span class="-6143815205992723671" onmouseenter="enter('-6143815205992723671');" onmouseout="out('-6143815205992723671');" style=""> 120                          .setReadTimeoutMillis(readTimeoutMillis)                                                  </span>
<span class="-7477024419561329894" onmouseenter="enter('-7477024419561329894');" onmouseout="out('-7477024419561329894');" style=""> 121                          .setConnectTimeoutMillis(connectTimeoutMillis);                                           </span>
<span  style=""> 122                                                                                                                    </span>
<span class="36776837264098679" onmouseenter="enter('36776837264098679');" onmouseout="out('36776837264098679');" style=""> 123                  //The cluster USES hostdistance.local in the same machine room                                    </span>
<span class="-4067753854505755618" onmouseenter="enter('-4067753854505755618');" onmouseout="out('-4067753854505755618');" style=""> 124                  //Hostdistance. REMOTE is used for different machine rooms                                        </span>
<span class="-1239540897477970915" onmouseenter="enter('-1239540897477970915');" onmouseout="out('-1239540897477970915');" style=""> 125                  //Ignore use HostDistance. IGNORED                                                                </span>
<span class="7507936330523201209" onmouseenter="enter('7507936330523201209');" onmouseout="out('7507936330523201209');" style=""> 126                  PoolingOptions poolingOptions = new PoolingOptions()                                              </span>
<span class="4173548347137079648" onmouseenter="enter('4173548347137079648');" onmouseout="out('4173548347137079648');" style=""> 127                          //Each connection allows a maximum of 64 concurrent requests                              </span>
<span class="6109267905237967219" onmouseenter="enter('6109267905237967219');" onmouseout="out('6109267905237967219');" style=""> 128                          .setMaxRequestsPerConnection(HostDistance.LOCAL, maxRequestsPerConnection)                </span>
<span class="-8245292782127165862" onmouseenter="enter('-8245292782127165862');" onmouseout="out('-8245292782127165862');" style=""> 129                          //Have at least two connections to each machine in the cluster                            </span>
<span class="7216166406224594146" onmouseenter="enter('7216166406224594146');" onmouseout="out('7216166406224594146');" style=""> 130                          .setCoreConnectionsPerHost(HostDistance.LOCAL, coreConnectionsPerHost)                    </span>
<span class="-1358272374234048070" onmouseenter="enter('-1358272374234048070');" onmouseout="out('-1358272374234048070');" style=""> 131                          //There are up to eight connections to each machine in the cluster                        </span>
<span class="-1698869078338541686" onmouseenter="enter('-1698869078338541686');" onmouseout="out('-1698869078338541686');" style=""> 132                          .setMaxConnectionsPerHost(HostDistance.LOCAL, maxConnectionsPerHost)                      </span>
<span class="1548703418514968406" onmouseenter="enter('1548703418514968406');" onmouseout="out('1548703418514968406');" style=""> 133                          .setMaxQueueSize(maxQueueSize)                                                            </span>
<span class="3524981482635418824" onmouseenter="enter('3524981482635418824');" onmouseout="out('3524981482635418824');" style=""> 134                          .setPoolTimeoutMillis(poolTimeoutMillis);                                                 </span>
<span class="-3027653360277295120" onmouseenter="enter('-3027653360277295120');" onmouseout="out('-3027653360277295120');" style=""> 135                  //重试策略                                                                                            </span>
<span class="-2500245183701794239" onmouseenter="enter('-2500245183701794239');" onmouseout="out('-2500245183701794239');" style=""> 136                  RetryPolicy retryPolicy = DowngradingConsistencyRetryPolicy.INSTANCE;                             </span>
<span  style=""> 137                                                                                                                    </span>
<span class="6634426984636856768" onmouseenter="enter('6634426984636856768');" onmouseout="out('6634426984636856768');" style=""> 138                  for (String server : StringUtils.split(address, &quot;,&quot;)) {                                           </span>
<span class="-4294448682063399613" onmouseenter="enter('-4294448682063399613');" onmouseout="out('-4294448682063399613');" style=""> 139                      cassandraPort = Integer.parseInt(StringUtils.split(server, &quot;:&quot;)[1]);                          </span>
<span class="7751295421103553875" onmouseenter="enter('7751295421103553875');" onmouseout="out('7751295421103553875');" style=""> 140                      serversList.add(InetAddress.getByName(StringUtils.split(server, &quot;:&quot;)[0]));                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141                  }                                                                                                 </span>
<span  style=""> 142                                                                                                                    </span>
<span class="3673717518338030181" onmouseenter="enter('3673717518338030181');" onmouseout="out('3673717518338030181');" style=""> 143                  if (userName == null || userName.isEmpty() || password == null || password.isEmpty()) {           </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""> 144                      cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)        </span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 145                              .withPort(cassandraPort)                                                              </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 146                              .withPoolingOptions(poolingOptions).withSocketOptions(so)                             </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 147                              .withQueryOptions(queryOptions).build();                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 148                  } else {                                                                                          </span>
<span class="5486080567663732369" onmouseenter="enter('5486080567663732369');" onmouseout="out('5486080567663732369');" style=""> 149                      cluster = Cluster.builder().addContactPoints(serversList).withRetryPolicy(retryPolicy)        </span>
<span class="-6421464908155171330" onmouseenter="enter('-6421464908155171330');" onmouseout="out('-6421464908155171330');" style=""> 150                              .withPort(cassandraPort)                                                              </span>
<span class="-2049534510411973309" onmouseenter="enter('-2049534510411973309');" onmouseout="out('-2049534510411973309');" style=""> 151                              .withPoolingOptions(poolingOptions).withSocketOptions(so)                             </span>
<span class="-5038512354126172278" onmouseenter="enter('-5038512354126172278');" onmouseout="out('-5038512354126172278');" style=""> 152                              .withCredentials(userName, password)                                                  </span>
<span class="8900053983828360449" onmouseenter="enter('8900053983828360449');" onmouseout="out('8900053983828360449');" style=""> 153                              .withQueryOptions(queryOptions).build();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154                  }                                                                                                 </span>
<span class="765464969334355038" onmouseenter="enter('765464969334355038');" onmouseout="out('765464969334355038');" style=""> 155                  // 建立连接 连接已存在的键空间                                                                                 </span>
<span class="-6325263381803948308" onmouseenter="enter('-6325263381803948308');" onmouseout="out('-6325263381803948308');" style=""> 156                  session = cluster.connectAsync(database);                                                         </span>
<span class="8518739044679915590" onmouseenter="enter('8518739044679915590');" onmouseout="out('8518739044679915590');" style=""> 157                  LOG.info(&quot;connect cassandra is successed!&quot;);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 158              }                                                                                                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 159          } catch (Exception e) {                                                                                   </span>
<span class="7191685386448857101" onmouseenter="enter('7191685386448857101');" onmouseout="out('7191685386448857101');" style=""> 160              LOG.error(&quot;connect cassandra is error:&quot; + e.getMessage());                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="8269740335530788238" onmouseenter="enter('8269740335530788238');" onmouseout="out('8269740335530788238');" style=""> 165      public void asyncInvoke(CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {                       </span>
<span class="1202395436001278606" onmouseenter="enter('1202395436001278606');" onmouseout="out('1202395436001278606');" style=""> 166          CRow inputCopy = new CRow(input.row(), input.change());                                                   </span>
<span class="-1931516301554097978" onmouseenter="enter('-1931516301554097978');" onmouseout="out('-1931516301554097978');" style=""> 167          JsonArray inputParams = new JsonArray();                                                                  </span>
<span class="7298653858488117630" onmouseenter="enter('7298653858488117630');" onmouseout="out('7298653858488117630');" style=""> 168          StringBuffer stringBuffer = new StringBuffer();                                                           </span>
<span class="-4783111457257452314" onmouseenter="enter('-4783111457257452314');" onmouseout="out('-4783111457257452314');" style=""> 169          String sqlWhere = &quot; where &quot;;                                                                              </span>
<span  style=""> 170                                                                                                                    </span>
<span class="-8402687189436648246" onmouseenter="enter('-8402687189436648246');" onmouseout="out('-8402687189436648246');" style=""> 171          for (int i = 0; i &lt; sideInfo.getEqualFieldList().size(); i++) {                                           </span>
<span class="-3840296209619294586" onmouseenter="enter('-3840296209619294586');" onmouseout="out('-3840296209619294586');" style=""> 172              Integer conValIndex = sideInfo.getEqualValIndex().get(i);                                             </span>
<span class="-4695026939557491455" onmouseenter="enter('-4695026939557491455');" onmouseout="out('-4695026939557491455');" style=""> 173              Object equalObj = inputCopy.row().getField(conValIndex);                                              </span>
<span class="5023013325339684340" onmouseenter="enter('5023013325339684340');" onmouseout="out('5023013325339684340');" style=""> 174              if (equalObj == null) {                                                                               </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 175                  dealMissKey(inputCopy, resultFuture);                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 176                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177              }                                                                                                     </span>
<span class="5224882790029280870" onmouseenter="enter('5224882790029280870');" onmouseout="out('5224882790029280870');" style=""> 178              inputParams.add(equalObj);                                                                            </span>
<span class="6844316250995394013" onmouseenter="enter('6844316250995394013');" onmouseout="out('6844316250995394013');" style=""> 179              StringBuffer sqlTemp = stringBuffer.append(sideInfo.getEqualFieldList().get(i))                       </span>
<span class="4506040730369527852" onmouseenter="enter('4506040730369527852');" onmouseout="out('4506040730369527852');" style=""> 180                      .append(&quot; = &quot;);                                                                               </span>
<span class="6706079886736437259" onmouseenter="enter('6706079886736437259');" onmouseout="out('6706079886736437259');" style=""> 181              if (equalObj instanceof String) {                                                                     </span>
<span class="147067916336825508" onmouseenter="enter('147067916336825508');" onmouseout="out('147067916336825508');" style=""> 182                  sqlTemp.append(&quot;&#x27;&quot; + equalObj + &quot;&#x27;&quot;)                                                              </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style=""> 183                          .append(&quot; and &quot;);                                                                         </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 184              } else {                                                                                              </span>
<span class="-2928507733810337143" onmouseenter="enter('-2928507733810337143');" onmouseout="out('-2928507733810337143');" style=""> 185                  sqlTemp.append(equalObj)                                                                          </span>
<span class="-4522415391881099186" onmouseenter="enter('-4522415391881099186');" onmouseout="out('-4522415391881099186');" style=""> 186                          .append(&quot; and &quot;);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187              }                                                                                                     </span>
<span  style=""> 188                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189          }                                                                                                         </span>

<span  style=""> 190                                                                                                                    </span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 191          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-7558523756689931178" onmouseenter="enter('-7558523756689931178');" onmouseout="out('-7558523756689931178');" style=""> 192          sqlWhere = sqlWhere + stringBuffer.toString().substring(0, stringBuffer.lastIndexOf(&quot; and &quot;));            </span>
<span  style=""> 193                                                                                                                    </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 194          if (openCache()) {                                                                                        </span>
<span class="4018485734053385031" onmouseenter="enter('4018485734053385031');" onmouseout="out('4018485734053385031');" style=""> 195              CacheObj val = getFromCache(key);                                                                     </span>
<span class="-6819343431453153595" onmouseenter="enter('-6819343431453153595');" onmouseout="out('-6819343431453153595');" style=""> 196              if (val != null) {                                                                                    </span>
<span  style=""> 197                                                                                                                    </span>
<span class="584449399818260060" onmouseenter="enter('584449399818260060');" onmouseout="out('584449399818260060');" style=""> 198                  if (ECacheContentType.MissVal == val.getType()) {                                                 </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 199                      dealMissKey(inputCopy, resultFuture);                                                         </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 200                      return;                                                                                       </span>
<span class="6195830740311694013" onmouseenter="enter('6195830740311694013');" onmouseout="out('6195830740311694013');" style=""> 201                  } else if (ECacheContentType.MultiLine == val.getType()) {                                        </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 202                      List&lt;CRow&gt; rowList = Lists.newArrayList();                                                    </span>
<span class="-2487553836950339417" onmouseenter="enter('-2487553836950339417');" onmouseout="out('-2487553836950339417');" style=""> 203                      for (Object jsonArray : (List) val.getContent()) {                                            </span>
<span class="6971295915772610856" onmouseenter="enter('6971295915772610856');" onmouseout="out('6971295915772610856');" style=""> 204                          Row row = fillData(inputCopy.row(), jsonArray);                                           </span>
<span class="905679283920640948" onmouseenter="enter('905679283920640948');" onmouseout="out('905679283920640948');" style=""> 205                          rowList.add(new CRow(row, inputCopy.change()));                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 206                      }                                                                                             </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 207                      resultFuture.complete(rowList);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 208                  } else {                                                                                          </span>
<span class="-1323059185501153522" onmouseenter="enter('-1323059185501153522');" onmouseout="out('-1323059185501153522');" style=""> 209                      throw new RuntimeException(&quot;not support cache obj type &quot; + val.getType());                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 210                  }                                                                                                 </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 211                  return;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213          }                                                                                                         </span>
<span  style=""> 214                                                                                                                    </span>
<span class="-3943135781211957390" onmouseenter="enter('-3943135781211957390');" onmouseout="out('-3943135781211957390');" style=""> 215          //connect Cassandra                                                                                       </span>
<span class="-7529848090326611941" onmouseenter="enter('-7529848090326611941');" onmouseout="out('-7529848090326611941');" style=""> 216          connCassandraDB(cassandraSideTableInfo);                                                                  </span>
<span  style=""> 217                                                                                                                    </span>
<span class="-1009818159771501050" onmouseenter="enter('-1009818159771501050');" onmouseout="out('-1009818159771501050');" style=""> 218          String sqlCondition = sideInfo.getSqlCondition() + &quot; &quot; + sqlWhere + &quot;  ALLOW FILTERING &quot;;                 </span>
<span class="2890792881476289631" onmouseenter="enter('2890792881476289631');" onmouseout="out('2890792881476289631');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 219 -        System.out.println(&quot;sqlCondition:&quot; + sqlCondition);                                                       </span>
<span class="7235570087826307362" onmouseenter="enter('7235570087826307362');" onmouseout="out('7235570087826307362');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 220 +        LOG.info(&quot;sqlCondition:{}&quot; + sqlCondition);                                                               </span>
<span  style=""> 221                                                                                                                    </span>
<span class="-4677553123577559654" onmouseenter="enter('-4677553123577559654');" onmouseout="out('-4677553123577559654');" style=""> 222          ListenableFuture&lt;ResultSet&gt; resultSet = Futures.transformAsync(session,                                   </span>
<span class="-8970210976886405807" onmouseenter="enter('-8970210976886405807');" onmouseout="out('-8970210976886405807');" style=""> 223                  new AsyncFunction&lt;Session, ResultSet&gt;() {                                                         </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224                      @Override                                                                                     </span>
<span class="7229846643571334073" onmouseenter="enter('7229846643571334073');" onmouseout="out('7229846643571334073');" style=""> 225                      public ListenableFuture&lt;ResultSet&gt; apply(Session session) throws Exception {                  </span>
<span class="2429380307619353" onmouseenter="enter('2429380307619353');" onmouseout="out('2429380307619353');" style=""> 226                          return session.executeAsync(sqlCondition);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 228                  });                                                                                               </span>
<span  style=""> 229                                                                                                                    </span>
<span class="-2519838970460094251" onmouseenter="enter('-2519838970460094251');" onmouseout="out('-2519838970460094251');" style=""> 230          ListenableFuture&lt;List&lt;com.datastax.driver.core.Row&gt;&gt; data = Futures.transform(resultSet,                  </span>
<span class="3568556365730474127" onmouseenter="enter('3568556365730474127');" onmouseout="out('3568556365730474127');" style=""> 231                  new Function&lt;ResultSet, List&lt;com.datastax.driver.core.Row&gt;&gt;() {                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 232                      @Override                                                                                     </span>
<span class="7863554394934287512" onmouseenter="enter('7863554394934287512');" onmouseout="out('7863554394934287512');" style=""> 233                      public List&lt;com.datastax.driver.core.Row&gt; apply(ResultSet rs) {                               </span>
<span class="-6387242574642327798" onmouseenter="enter('-6387242574642327798');" onmouseout="out('-6387242574642327798');" style=""> 234                          return rs.all();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235                      }                                                                                             </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 236                  });                                                                                               </span>
<span  style=""> 237                                                                                                                    </span>
<span class="8124054865584677185" onmouseenter="enter('8124054865584677185');" onmouseout="out('8124054865584677185');" style=""> 238          Futures.addCallback(data, new FutureCallback&lt;List&lt;com.datastax.driver.core.Row&gt;&gt;() {                      </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 239              @Override                                                                                             </span>
<span class="-7968962151066113330" onmouseenter="enter('-7968962151066113330');" onmouseout="out('-7968962151066113330');" style=""> 240              public void onSuccess(List&lt;com.datastax.driver.core.Row&gt; rows) {                                      </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 241                  cluster.closeAsync();                                                                             </span>
<span class="347035494226818967" onmouseenter="enter('347035494226818967');" onmouseout="out('347035494226818967');" style=""> 242                  if (rows.size() &gt; 0) {                                                                            </span>
<span class="7732099395665198389" onmouseenter="enter('7732099395665198389');" onmouseout="out('7732099395665198389');" style=""> 243                      List&lt;com.datastax.driver.core.Row&gt; cacheContent = Lists.newArrayList();                       </span>
<span class="-3770803949601695435" onmouseenter="enter('-3770803949601695435');" onmouseout="out('-3770803949601695435');" style=""> 244                      List&lt;CRow&gt; rowList = Lists.newArrayList();                                                    </span>
<span class="3453890066790785332" onmouseenter="enter('3453890066790785332');" onmouseout="out('3453890066790785332');" style=""> 245                      for (com.datastax.driver.core.Row line : rows) {                                              </span>
<span class="4836418702808839962" onmouseenter="enter('4836418702808839962');" onmouseout="out('4836418702808839962');" style=""> 246                          Row row = fillData(inputCopy.row(), line);                                                </span>

<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 247                          if (openCache()) {                                                                        </span>
<span class="7674485238819480651" onmouseenter="enter('7674485238819480651');" onmouseout="out('7674485238819480651');" style=""> 248                              cacheContent.add(line);                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249                          }                                                                                         </span>
<span class="-1174022488282524551" onmouseenter="enter('-1174022488282524551');" onmouseout="out('-1174022488282524551');" style=""> 250                          rowList.add(new CRow(row,inputCopy.change()));                                            </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 251                      }                                                                                             </span>
<span class="510192174520611392" onmouseenter="enter('510192174520611392');" onmouseout="out('510192174520611392');" style=""> 252                      resultFuture.complete(rowList);                                                               </span>
<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 253                      if (openCache()) {                                                                            </span>
<span class="-1330765095474862231" onmouseenter="enter('-1330765095474862231');" onmouseout="out('-1330765095474862231');" style=""> 254                          putCache(key, CacheObj.buildCacheObj(ECacheContentType.MultiLine, cacheContent));         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 256                  } else {                                                                                          </span>
<span class="5048286248301437368" onmouseenter="enter('5048286248301437368');" onmouseout="out('5048286248301437368');" style=""> 257                      dealMissKey(inputCopy, resultFuture);                                                         </span>

<span class="-4036333604028613811" onmouseenter="enter('-4036333604028613811');" onmouseout="out('-4036333604028613811');" style=""> 258                      if (openCache()) {                                                                            </span>
<span class="-5736723344410400278" onmouseenter="enter('-5736723344410400278');" onmouseout="out('-5736723344410400278');" style=""> 259                          putCache(key, CacheMissVal.getMissKeyObj());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260                      }                                                                                             </span>
<span class="8035528279988960609" onmouseenter="enter('8035528279988960609');" onmouseout="out('8035528279988960609');" style=""> 261                      resultFuture.complete(null);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263              }                                                                                                     </span>
<span  style=""> 264                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265              @Override                                                                                             </span>
<span class="-728167789593706694" onmouseenter="enter('-728167789593706694');" onmouseout="out('-728167789593706694');" style=""> 266              public void onFailure(Throwable t) {                                                                  </span>
<span class="5577700706288044893" onmouseenter="enter('5577700706288044893');" onmouseout="out('5577700706288044893');" style=""> 267                  LOG.error(&quot;Failed to retrieve the data: %s%n&quot;,                                                    </span>
<span class="2555455608745013339" onmouseenter="enter('2555455608745013339');" onmouseout="out('2555455608745013339');" style=""> 268                          t.getMessage());                                                                          </span>
<span class="6562988686685479683" onmouseenter="enter('6562988686685479683');" onmouseout="out('6562988686685479683');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 269 -                System.out.println(&quot;Failed to retrieve the data: &quot; + t.getMessage());                             </span>
<span class="-2792394742141522863" onmouseenter="enter('-2792394742141522863');" onmouseout="out('-2792394742141522863');" style=""> 270                  cluster.closeAsync();                                                                             </span>
<span class="1780061706453512804" onmouseenter="enter('1780061706453512804');" onmouseout="out('1780061706453512804');" style=""> 271                  resultFuture.completeExceptionally(t);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 273          });                                                                                                       </span>


















<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 274      }                                                                                                             </span>
<span  style=""> 275                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 276      @Override                                                                                                     </span>
<span class="6361661721548771002" onmouseenter="enter('6361661721548771002');" onmouseout="out('6361661721548771002');" style=""> 277      public Row fillData(Row input, Object line) {                                                                 </span>
<span class="-1556735922244622351" onmouseenter="enter('-1556735922244622351');" onmouseout="out('-1556735922244622351');" style=""> 278          com.datastax.driver.core.Row rowArray = (com.datastax.driver.core.Row) line;                              </span>
<span class="-1702812097453380901" onmouseenter="enter('-1702812097453380901');" onmouseout="out('-1702812097453380901');" style=""> 279          Row row = new Row(sideInfo.getOutFieldInfoList().size());                                                 </span>
<span class="-8193044176423310947" onmouseenter="enter('-8193044176423310947');" onmouseout="out('-8193044176423310947');" style=""> 280          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getInFieldIndex().entrySet()) {                         </span>
<span class="-7924116429603597548" onmouseenter="enter('-7924116429603597548');" onmouseout="out('-7924116429603597548');" style=""> 281              Object obj = input.getField(entry.getValue());                                                        </span>
<span class="1294569248385804264" onmouseenter="enter('1294569248385804264');" onmouseout="out('1294569248385804264');" style=""><abbr title=" 282              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo().getTypeAt(entry.getValue()).getClass());"> 282              boolean isTimeIndicatorTypeInfo = TimeIndicatorTypeInfo.class.isAssignableFrom(sideInfo.getRowTypeInfo🔵</abbr></span>
<span  style=""> 283                                                                                                                    </span>
<span class="-1760550867550091637" onmouseenter="enter('-1760550867550091637');" onmouseout="out('-1760550867550091637');" style=""> 284              if (obj instanceof Timestamp &amp;&amp; isTimeIndicatorTypeInfo) {                                            </span>
<span class="-7982351818108202915" onmouseenter="enter('-7982351818108202915');" onmouseout="out('-7982351818108202915');" style=""> 285                  obj = ((Timestamp) obj).getTime();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286              }                                                                                                     </span>
<span  style=""> 287                                                                                                                    </span>
<span class="1088133213948185292" onmouseenter="enter('1088133213948185292');" onmouseout="out('1088133213948185292');" style=""> 288              row.setField(entry.getKey(), obj);                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289          }                                                                                                         </span>
<span  style=""> 290                                                                                                                    </span>
<span class="7381526363521034737" onmouseenter="enter('7381526363521034737');" onmouseout="out('7381526363521034737');" style=""> 291          for (Map.Entry&lt;Integer, Integer&gt; entry : sideInfo.getSideFieldIndex().entrySet()) {                       </span>
<span class="-844467095686898872" onmouseenter="enter('-844467095686898872');" onmouseout="out('-844467095686898872');" style=""> 292              if (rowArray == null) {                                                                               </span>
<span class="5616946410045751481" onmouseenter="enter('5616946410045751481');" onmouseout="out('5616946410045751481');" style=""> 293                  row.setField(entry.getKey(), null);                                                               </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 294              } else {                                                                                              </span>
<span class="-7910331794290062112" onmouseenter="enter('-7910331794290062112');" onmouseout="out('-7910331794290062112');" style=""> 295                  row.setField(entry.getKey(), rowArray.getObject(entry.getValue()));                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span  style=""> 298                                                                                                                    </span>
<span class="-5244399426660521116" onmouseenter="enter('-5244399426660521116');" onmouseout="out('-5244399426660521116');" style=""> 299          return row;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300      }                                                                                                             </span>
<span  style=""> 301                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 302      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 303      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 304          super.close();                                                                                            </span>
<span class="7236775322084046720" onmouseenter="enter('7236775322084046720');" onmouseout="out('7236775322084046720');" style=""> 305          if (cluster != null) {                                                                                    </span>
<span class="-7802554339096083826" onmouseenter="enter('-7802554339096083826');" onmouseout="out('-7802554339096083826');" style=""> 306              cluster.close();                                                                                      </span>
<span class="-8433337576020477133" onmouseenter="enter('-8433337576020477133');" onmouseout="out('-8433337576020477133');" style=""> 307              cluster = null;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309      }                                                                                                             </span>
<span  style=""> 310                                                                                                                    </span>
<span class="-3405798300685646496" onmouseenter="enter('-3405798300685646496');" onmouseout="out('-3405798300685646496');" style=""> 311      public String buildCacheKey(JsonArray jsonArray) {                                                            </span>
<span class="-8642289478502472483" onmouseenter="enter('-8642289478502472483');" onmouseout="out('-8642289478502472483');" style=""> 312          StringBuilder sb = new StringBuilder();                                                                   </span>
<span class="5542959958101405176" onmouseenter="enter('5542959958101405176');" onmouseout="out('5542959958101405176');" style=""> 313          for (Object ele : jsonArray.getList()) {                                                                  </span>
<span class="-9219177986461641503" onmouseenter="enter('-9219177986461641503');" onmouseout="out('-9219177986461641503');" style=""> 314              sb.append(ele.toString())                                                                             </span>
<span class="-7037257933228320495" onmouseenter="enter('-7037257933228320495');" onmouseout="out('-7037257933228320495');" style=""> 315                      .append(&quot;_&quot;);                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316          }                                                                                                         </span>
<span  style=""> 317                                                                                                                    </span>
<span class="-6276773404435993532" onmouseenter="enter('-6276773404435993532');" onmouseout="out('-6276773404435993532');" style=""> 318          return sb.toString();                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            