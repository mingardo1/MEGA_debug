<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>305</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    305
                    <a href="304.html">prev</a>
                    <a href="306.html">next</a>
                    <a href="305_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    BroadleafCommerce/BroadleafCommerce_cd7cff12a798c3a68943ad44552e25fb0f98f8d1_admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1^1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;cd7cff12a798c3a68943ad44552e25fb0f98f8d1^2:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\BroadleafCommerce\BroadleafCommerce show &quot;556ac57d12139326e76b29db4638956d93283fb1:admin/broadleaf-open-admin-platform/src/main/java/org/broadleafcommerce/openadmin/server/security/service/AdminSecurityServiceImpl.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b], [b], [b], [b], [bs], [s]], subset: [[b], [b], [b], [b], [bs], [s]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  20 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  21 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  22 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  23 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  24 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  25 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  26 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="">  27 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  28 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  29 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  30 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  31 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  32 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  33 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  34 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  35 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  36 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  37 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  38 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  39 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  40 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  41 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  42 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="">  43 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="">  44 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  45 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  46 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  47 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  48 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  49 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  50 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  51 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  52 import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                    </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  53 import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                  </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  54 import org.springframework.beans.factory.annotation.Autowired;                                           </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  55 import org.springframework.beans.factory.annotation.Qualifier;                                           </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  56 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  57 import org.springframework.security.authentication.dao.SaltSource;                                       </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  58 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  59 import org.springframework.security.core.GrantedAuthority;                                               </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  60 =======                                                                                                  </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  61 import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                    </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  62 import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                  </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63 import org.springframework.beans.factory.annotation.Autowired;                                           </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  64 import org.springframework.beans.factory.annotation.Qualifier;                                           </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  65 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  66 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  67 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  68 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  69 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  70 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  71 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  72 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  73                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  74 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  75 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  76 import java.util.List;                                                                                   </span>
<span  style="">  77                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  78 import javax.annotation.Resource;                                                                        </span>
<span  style="">  79                                                                                                          </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  80 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  81 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  82 import net.sf.ehcache.Element;                                                                           </span>
<span  style="">  83                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  85  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  86  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  87  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  88  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  89 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  90 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  91                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  92     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  93                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  94     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  95     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  96                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  97     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  98     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  99     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style=""> 100                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style=""> 101     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style=""> 102     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style=""> 103                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style=""> 104     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style=""> 105     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style=""> 106                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style=""> 107     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style=""> 108     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style=""> 109                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style=""> 110     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style=""> 111     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style=""> 112                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 113     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 114     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 115     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style=""> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 117     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 118      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 118      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 119      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 119      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 120      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 121     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 122     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 123                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 124 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 125     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 126     protected EmailService emailService;                                                                 </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 127                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 128     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 129     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 130                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 131     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 132     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 133 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 134      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 135     @Deprecated                                                                                          </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 136     protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;      </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 137                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 138     /**                                                                                                  </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 139      * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version."> 139      * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new versioðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 140      */                                                                                                  </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 141     protected PasswordEncoder passwordEncoderNew;                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 142                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 143     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 144     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 145     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 146                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 147     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 148      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 148      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 149      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 149      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152     protected Object passwordEncoderBean;                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 153                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 154     /**                                                                                                  </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 155      * Optional password salt to be used with the passwordEncoder                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 156      *                                                                                                   </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 157      * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 158      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 159     @Deprecated                                                                                          </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 160     protected String salt;                                                                               </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 161                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 162     /**                                                                                                  </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 163      * Use a Salt Source ONLY if there&#x27;s one configured                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 164      *                                                                                                   </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 165      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2"> 165      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 166      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 167     @Deprecated                                                                                          </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 168     @Autowired(required=false)                                                                           </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 169     @Qualifier(&quot;blAdminSaltSource&quot;)                                                                      </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 170     protected SaltSource saltSource;                                                                     </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 171                                                                                                          </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 172     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 173     protected EmailService emailService;                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 174                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 175     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 176     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 177                                                                                                          </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 178 =======                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 179     /**                                                                                                  </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 180      * Optional password salt to be used with the passwordEncoder                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 181      *                                                                                                   </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 182      * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 183      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 184     @Deprecated                                                                                          </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 185     protected String salt;                                                                               </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 186                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 187     /**                                                                                                  </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 188      * Use a Salt Source ONLY if there&#x27;s one configured                                                  </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 189      *                                                                                                   </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 190      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2"> 190      * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 191      */                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 192     @Deprecated                                                                                          </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 193     @Autowired(required=false)                                                                           </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 194     @Qualifier(&quot;blAdminSaltSource&quot;)                                                                      </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 195     protected SaltSource saltSource;                                                                     </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 196 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span  style=""> 197                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 198     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 199         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 202     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 203         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204     }                                                                                                    </span>
<span  style=""> 205                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 207     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 208     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 209         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 210         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211     }                                                                                                    </span>
<span  style=""> 212                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 213     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 214     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 215     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 216         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 217         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218     }                                                                                                    </span>
<span  style=""> 219                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 220     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 221     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 222     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 223         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 224         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225     }                                                                                                    </span>
<span  style=""> 226                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 227     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 228     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 229         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230     }                                                                                                    </span>
<span  style=""> 231                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 232     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 233     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 234         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235     }                                                                                                    </span>
<span  style=""> 236                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 237     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 238     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 239         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 240     }                                                                                                    </span>
<span  style=""> 241                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 242     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 243     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 244     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 245         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 246         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 247         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 248     }                                                                                                    </span>
<span  style=""> 249                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 250     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 251     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 252     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 253         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 254         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 255         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256     }                                                                                                    </span>
<span  style=""> 257                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 258     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 259     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 260     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 261         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 262         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 263                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 264         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 265             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 266             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 267         }                                                                                                </span>
<span  style=""> 268                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 269         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 270         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 271             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272         }                                                                                                </span>
<span  style=""> 273                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 274         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 275                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 276         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 277             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278         }                                                                                                </span>
<span  style=""> 279                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 280         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 281         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 282         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 286     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 287         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 288             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 290         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 293     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 294         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295     }                                                                                                    </span>
<span  style=""> 296                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 297     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 298     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 299     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 300         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 301         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 302         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 303         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 304         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 304         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 305         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 306         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 307         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308     }                                                                                                    </span>
<span  style=""> 309                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 310     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 311     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 311     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 312         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 313         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 314         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 315                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 316         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 317             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 318                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 319             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 320                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322         }                                                                                                </span>
<span  style=""> 323                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 324         if (response == null) {                                                                          </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 325             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 325             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissioðŸ”µ</abbr></span>
<span  style=""> 326                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 327             if (!response) {                                                                             </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 328                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 328                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329             }                                                                                            </span>
<span  style=""> 330                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 331             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 332             cache.put(cacheElement);                                                                     </span>
<span  style=""> 333                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 334             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 335                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 336             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337         }                                                                                                </span>
<span  style=""> 338                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 339         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340     }                                                                                                    </span>
<span  style=""> 341                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 342     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 342     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 343         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 344                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 345                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 346                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 349     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 350     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 350     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 351         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 351         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352     }                                                                                                    </span>
<span  style=""> 353                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 354     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 355     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 356         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 359     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 360     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 361         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 362     }                                                                                                    </span>
<span  style=""> 363                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 364     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 365     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 366         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 367     }                                                                                                    </span>
<span  style=""> 368                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 369     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 370     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 371         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372     }                                                                                                    </span>
<span  style=""> 373                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 374     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 375     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 376         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 377     }                                                                                                    </span>
<span  style=""> 378                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 379     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 380     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 381     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 382         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 383         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 384         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 385             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 387         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 388             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 389         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 390             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 391             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 392                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 393                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395             }                                                                                            </span>
<span  style=""> 396                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 397             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 398                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 398                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 399             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 400                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 401                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 402             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 403         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 404         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405     }                                                                                                    </span>
<span  style=""> 406                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 407     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 408     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 409     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 410         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 411         AdminUser user = null;                                                                           </span>
<span  style=""> 412                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 413         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 414             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415         }                                                                                                </span>
<span  style=""> 416                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 417         checkUser(user,response);                                                                        </span>
<span  style=""> 418                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 419         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 420             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 421             token = token.toLowerCase();                                                                 </span>
<span  style=""> 422                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 423             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 424             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 425             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 426             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 427             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 428                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 429 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 430             HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 431             vars.put(&quot;token&quot;, token);                                                                    </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 432 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 433     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 434         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 435     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 436                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 437     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 438     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 439         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 440     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 441                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 442     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 443     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 444     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 445         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 446         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 447         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 448             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 449         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 450         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 451             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 452         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 453             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 454             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 455                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 456                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 457                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 458             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 459                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 460             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 461                 HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                            </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 462                 vars.put(&quot;accountNames&quot;, activeUsernames);                                               </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 463                 emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 464             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 465                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 466                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 467             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 468         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 469         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 470     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 471                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 472     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 473     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 474     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 475         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 476         AdminUser user = null;                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 477                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 478         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 479             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 480         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 481                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 482         checkUser(user,response);                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 483                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 484         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 485             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 486             token = token.toLowerCase();                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 487                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 488             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 489             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 490 =======                                                                                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 491 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 492             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 493             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 494                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 495                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 496                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 497                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 498                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499             }                                                                                            </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 500 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 501             vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                              </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 502             emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 503                                                                                                          </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 504 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 505     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 506     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 507         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 508         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 509         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 510             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 511         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 512         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 513             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 514         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 515             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 516             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 517                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 518                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 519                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 520             }                                                                                            </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 521                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 522             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 523                 HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                            </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 524                 vars.put(&quot;accountNames&quot;, activeUsernames);                                               </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 525                 emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 526             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 527                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 528                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 529             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 530         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 531         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 532     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 533                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 534     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 535     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 536     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 537         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 538         AdminUser user = null;                                                                           </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 539                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 540         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 541             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 542         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 543                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 544         checkUser(user,response);                                                                        </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 545                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 546         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 547             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 548             token = token.toLowerCase();                                                                 </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 549                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 550             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 551             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 552             fpst.setToken(encodePassword(token, null));                                                  </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 553             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 554             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 555                                                                                                          </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 556             HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 557             vars.put(&quot;token&quot;, token);                                                                    </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 558             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 559             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 560                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 561                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 562 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 563                                                                                                          </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 564             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 564             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 565 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 566         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 567         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 568     }                                                                                                    </span>
<span  style=""> 569                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 570     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 571     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 572     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 572     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 573         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 574         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 575         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 576             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 577         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 578         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 579         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 580         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 581             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 582         }                                                                                                </span>
<span  style=""> 583                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 584         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 585         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 586             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 587             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 587             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 588             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 589                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 590                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 591                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 592                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 593             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 594             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 595                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 596             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 597                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 598             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 599                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 600             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601         }                                                                                                </span>
<span  style=""> 602                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 603         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 604             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 605                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 606                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 606                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 607                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 608                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 609             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 610         }                                                                                                </span>
<span  style=""> 611                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 612         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 613             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 614             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 615             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 616         }                                                                                                </span>
<span  style=""> 617                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 618         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 619     }                                                                                                    </span>
<span  style=""> 620                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 621     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 622         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 622         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 623         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 624             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 625             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 626         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 627     }                                                                                                    </span>
<span  style=""> 628                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 629     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 630         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 631             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 632         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 633             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 634         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 635             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 636         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 637     }                                                                                                    </span>
<span  style=""> 638                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 639     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 640         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 641             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 642         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 643             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 644         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 645     }                                                                                                    </span>
<span  style=""> 646                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 647     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 647     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 648         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 649             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 650         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 651     }                                                                                                    </span>
<span  style=""> 652                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 653     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 654         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 655         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 656         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 657         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 658         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 659     }                                                                                                    </span>
<span  style=""> 660                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 661     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 662         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663     }                                                                                                    </span>
<span  style=""> 664                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 665     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 666         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 667     }                                                                                                    </span>
<span  style=""> 668                                                                                                          </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 669 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 670     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 671         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 672     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 673                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 674     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 675         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 676     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 677                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 678     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 679         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 680     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 681                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 682     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 683         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 684 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 685                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 686             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 687         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 688                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 689         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 690             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 691             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 692             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 693         }                                                                                                </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 694                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 695         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 696     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 697                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 698     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 699         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 699         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 700         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 701             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 702             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 703         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 704     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 705                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 706     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 707         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 708             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 709         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 710             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 711         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 712             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 713         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 714     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 715                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 716     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 717         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 718             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 719         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 720             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 721         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 722     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 723                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 724     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 724     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 725         if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) { </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 726             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 727         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 728     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 729                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 730     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 731         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 732         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 733         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 734         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 735         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 736     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 737                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 738     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 739         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 740     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 741                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 742     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 743         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 744     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 745                                                                                                          </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 746     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 747         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 748     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 749                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 750     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 751         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 752     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 753                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 754     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 755         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 756     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 757                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 758     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 759         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 760     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 761                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 762     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 763     @Override                                                                                            </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 764     public Object getSalt(AdminUser user, String unencodedPassword) {                                    </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 765         Object salt = null;                                                                              </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 766         if (saltSource != null) {                                                                        </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 767             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 767             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPasswoðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 768         }                                                                                                </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 769         return salt;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 770     }                                                                                                    </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 771 =======                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 772     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 773     @Override                                                                                            </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 774     public Object getSalt(AdminUser user, String unencodedPassword) {                                    </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 775         Object salt = null;                                                                              </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 776         if (saltSource != null) {                                                                        </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 777             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 777             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPasswoðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 778         }                                                                                                </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 779         return salt;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 780     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 781                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 782     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 783     @Override                                                                                            </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 784     public String getSalt() {                                                                            </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 785         return salt;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 786     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 787                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 788     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 789     @Override                                                                                            </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 790     public void setSalt(String salt) {                                                                   </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 791         this.salt = salt;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 792     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 793                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 794     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 795     @Override                                                                                            </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 796     public SaltSource getSaltSource() {                                                                  </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 797         return saltSource;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 798     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 799                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 800     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 801     @Override                                                                                            </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 802     public void setSaltSource(SaltSource saltSource) {                                                   </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 803         this.saltSource = saltSource;                                                                    </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 804 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 805     }                                                                                                    </span>
<span  style=""> 806                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 807     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 808     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 809     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 810             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 811         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 812         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 813         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 814             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 815         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 816         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 817         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 818                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 819         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 820             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 821         }                                                                                                </span>
<span  style=""> 822                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 823         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 824             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 825             saveAdminUser(user);                                                                         </span>
<span  style=""> 826                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 827         }                                                                                                </span>
<span  style=""> 828                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 829         return response;                                                                                 </span>
<span  style=""> 830                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 831     }                                                                                                    </span>
<span  style=""> 832                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 833     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 834      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 834      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 835      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 836      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 836      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 837      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 837      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 838      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 839      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 840      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 841      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 842      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 843     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 844         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 845     }                                                                                                    </span>
<span  style=""> 846                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 847     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 848      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 849      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 850      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 850      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 851      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 851      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 852      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 852      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 853      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 854      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 855      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 856      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 857      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 858     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 859         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 860     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 861 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  20 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  21 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  22 import net.sf.ehcache.Element;                                                                           </span>
<span  style="">  23                                                                                                          </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="">  31 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  32 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  33 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  34 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  35 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  36 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  37 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  38 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  39 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  40 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  41 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  42 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  43 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  44 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  45 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  46 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="">  47 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="">  48 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="">  50 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  51 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  52 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  53 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  54 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  55 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  56 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  57                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  58 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  59 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  60 import java.util.List;                                                                                   </span>
<span  style="">  61                                                                                                          </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  62 import javax.annotation.Resource;                                                                        </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  66  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  67  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  69 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  70 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  71                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  72     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  73                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  74     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  75     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  76                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  77     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  78     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  79     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style="">  80                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  81     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  82     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  83                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  84     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  85     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  86                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  87     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  88     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  89                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  90     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  91     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  92                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  93     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  94     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="">  95     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="">  96                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  97     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title="  98      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the">  98      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title="  99      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}">  99      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 100      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 101     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 102     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 103                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 104     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 105         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106     }                                                                                                    </span>
<span  style=""> 107                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 108     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 109         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110     }                                                                                                    </span>
<span  style=""> 111                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 112     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 113     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 114     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 115         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 116         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 117     }                                                                                                    </span>
<span  style=""> 118                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 119     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 120     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 121     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 122         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 123         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124     }                                                                                                    </span>
<span  style=""> 125                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 126     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 127     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 128     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 129         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 130         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131     }                                                                                                    </span>
<span  style=""> 132                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 133     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 134     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 135         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136     }                                                                                                    </span>
<span  style=""> 137                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 139     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 140         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 141     }                                                                                                    </span>
<span  style=""> 142                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 143     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 144     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 145         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 146     }                                                                                                    </span>
<span  style=""> 147                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 148     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 149     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 150     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 151         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 152         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 153         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154     }                                                                                                    </span>
<span  style=""> 155                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 156     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 157     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 158     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 159         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 160         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 161         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 165     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 166     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 167         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 168         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 169                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 170         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 171             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 172             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173         }                                                                                                </span>
<span  style=""> 174                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 175         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 176         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 177             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178         }                                                                                                </span>
<span  style=""> 179                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 180         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 181                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 182         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 183             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184         }                                                                                                </span>
<span  style=""> 185                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 186         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 187         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 188         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189     }                                                                                                    </span>
<span  style=""> 190                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 191     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 192     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 193         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 194             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 196         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197     }                                                                                                    </span>
<span  style=""> 198                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 199     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 200         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 201     }                                                                                                    </span>
<span  style=""> 202                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 203     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 204     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 205     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 206         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 207         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 208         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 209         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 210         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 210         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 211         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 212         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 213         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214     }                                                                                                    </span>
<span  style=""> 215                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 217     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 217     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 218         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 219         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 220         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 221                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 222         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 223             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 224                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 225             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 226                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228         }                                                                                                </span>
<span  style=""> 229                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 230         if (response == null) {                                                                          </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 231             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 231             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissioðŸ”µ</abbr></span>
<span  style=""> 232                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 233             if (!response) {                                                                             </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 234                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 234                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235             }                                                                                            </span>
<span  style=""> 236                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 237             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 238             cache.put(cacheElement);                                                                     </span>
<span  style=""> 239                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 240             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 241                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 242             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243         }                                                                                                </span>
<span  style=""> 244                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 245         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246     }                                                                                                    </span>
<span  style=""> 247                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 248     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 248     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 249         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 250                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 251                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 252                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253     }                                                                                                    </span>
<span  style=""> 254                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 255     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 256     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 256     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 257         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 257         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258     }                                                                                                    </span>
<span  style=""> 259                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 260     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 261     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 262         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 263     }                                                                                                    </span>
<span  style=""> 264                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 265     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 266     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 267         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268     }                                                                                                    </span>
<span  style=""> 269                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 270     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 271     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 272         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 275     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 276     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 277         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 278     }                                                                                                    </span>
<span  style=""> 279                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 280     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 281     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 282         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283     }                                                                                                    </span>
<span  style=""> 284                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 286     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 287     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 288         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 289         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 290         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 291             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 293         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 294             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 295         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 296             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 297             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 298                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 299                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301             }                                                                                            </span>
<span  style=""> 302                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 303             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 304                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 304                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 305             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 306                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 307                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 308             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 310         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 313     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 314     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 315     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 316         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 317         AdminUser user = null;                                                                           </span>
<span  style=""> 318                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 319         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 320             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321         }                                                                                                </span>
<span  style=""> 322                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 323         checkUser(user,response);                                                                        </span>
<span  style=""> 324                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 325         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 326             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 327             token = token.toLowerCase();                                                                 </span>
<span  style=""> 328                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 329             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 330             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 331             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 332             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 333             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 334                                                                                                          </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 335             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 336             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 337                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 338                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 339                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 340                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342             }                                                                                            </span>
<span  style=""> 343                                                                                                          </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style=""><abbr title=" 344             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 344             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 346         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347     }                                                                                                    </span>
<span  style=""> 348                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 349     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 350     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 351     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 351     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 352         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 353         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 354         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 355             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 357         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 358         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 359         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 360             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361         }                                                                                                </span>
<span  style=""> 362                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 363         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 364         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 365             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 366             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 366             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 367             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 368                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 369                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 370                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 373             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 374                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 375             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 376                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 377             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 378                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380         }                                                                                                </span>
<span  style=""> 381                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 382         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 383             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 384                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 385                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 385                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 387                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 388             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 389         }                                                                                                </span>
<span  style=""> 390                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 391         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 392             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 393             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 394             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395         }                                                                                                </span>
<span  style=""> 396                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 397         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 398     }                                                                                                    </span>
<span  style=""> 399                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 400     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 401         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 401         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 402         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 403             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 404             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406     }                                                                                                    </span>
<span  style=""> 407                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 408     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 409         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 410             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 411         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 412             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 413         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 414             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416     }                                                                                                    </span>
<span  style=""> 417                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 418     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 419         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 420             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 421         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 422             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424     }                                                                                                    </span>
<span  style=""> 425                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 426     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 426     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 427         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 428             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 429         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430     }                                                                                                    </span>
<span  style=""> 431                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 432     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 433         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 434         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 435         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 436         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 437         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438     }                                                                                                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 440     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 441         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 444     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 445         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446     }                                                                                                    </span>
<span  style=""> 447                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 448     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 449     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 450     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 451             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 452         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 453         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 454         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 455             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 457         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 458         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 459                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 460         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 461             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462         }                                                                                                </span>
<span  style=""> 463                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 464         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 465             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 466             saveAdminUser(user);                                                                         </span>
<span  style=""> 467                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468         }                                                                                                </span>
<span  style=""> 469                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 470         return response;                                                                                 </span>
<span  style=""> 471                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span  style=""> 473                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 474     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 475      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 475      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 476      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 477      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 477      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 478      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 478      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 479      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 480      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 481      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 482      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 483      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 484     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 485         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 486     }                                                                                                    </span>
<span  style=""> 487                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 488     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 489      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 490      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 491      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 491      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 492      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 492      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 493      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 493      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 494      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 495      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 496      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 497      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 498      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 499     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 500         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 501     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502 }                                                                                                        </span>





































































































































































































































































































































































</pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2  * #%L                                                                                                   </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3  * BroadleafCommerce Open Admin Platform                                                                 </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4  * %%                                                                                                    </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5  * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6  * %%                                                                                                    </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7  * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                  </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8  * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)    </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9  * unless the restrictions on use therein are violated and require payment to Broadleaf in which case    </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10  * the Broadleaf End User License Agreement (EULA), Version 1.1                                          </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11  * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt) </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12  * shall apply.                                                                                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13  *                                                                                                       </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14  * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;CustomðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style=""><abbr title="  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.">  15  * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicableðŸ”µ</abbr></span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16  * #L%                                                                                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18 package org.broadleafcommerce.openadmin.server.security.service;                                         </span>
<span  style="">  19                                                                                                          </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  20 import java.util.ArrayList;                                                                              </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  21 import java.util.Date;                                                                                   </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  22 import java.util.List;                                                                                   </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  23 import javax.annotation.Resource;                                                                        </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  24 import net.sf.ehcache.Cache;                                                                             </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  25 import net.sf.ehcache.CacheManager;                                                                      </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  26 import net.sf.ehcache.Element;                                                                           </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  27 import org.apache.commons.collections4.CollectionUtils;                                                  </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  28 import org.apache.commons.lang3.BooleanUtils;                                                            </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  29 import org.apache.commons.lang3.StringUtils;                                                             </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  30 import org.apache.commons.logging.Log;                                                                   </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  31 import org.apache.commons.logging.LogFactory;                                                            </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  32 import org.broadleafcommerce.common.email.service.EmailService;                                          </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  33 import org.broadleafcommerce.common.email.service.info.EmailInfo;                                        </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="">  34 import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                            </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  35 import org.broadleafcommerce.common.security.util.PasswordChange;                                        </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  36 import org.broadleafcommerce.common.security.util.PasswordUtils;                                         </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  37 import org.broadleafcommerce.common.service.GenericResponse;                                             </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  38 import org.broadleafcommerce.common.time.SystemTime;                                                     </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  39 import org.broadleafcommerce.common.util.BLCSystemProperty;                                              </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  40 import org.broadleafcommerce.common.util.StringUtil;                                                     </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  41 import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                           </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  42 import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                 </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  43 import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                 </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  44 import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;               </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  45 import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                           </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  46 import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                 </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  47 import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                 </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  48 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;               </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  49 import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;           </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="">  50 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                   </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="">  51 import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                   </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  52 import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                      </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="">  53 import org.springframework.context.ApplicationContext;                                                   </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  54 import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                  </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  55 import org.springframework.security.core.Authentication;                                                 </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  56 import org.springframework.security.core.context.SecurityContextHolder;                                  </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  57 import org.springframework.security.crypto.password.PasswordEncoder;                                     </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  58 import org.springframework.stereotype.Service;                                                           </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  59 import org.springframework.transaction.annotation.Transactional;                                         </span>
<span  style="">  60                                                                                                          </span>
<span  style="">  61                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  62 /**                                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  63  *                                                                                                       </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  64  * @author jfischer                                                                                      </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  65  *                                                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66  */                                                                                                      </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  67 @Service(&quot;blAdminSecurityService&quot;)                                                                       </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  68 public class AdminSecurityServiceImpl implements AdminSecurityService {                                  </span>
<span  style="">  69                                                                                                          </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  70     private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                    </span>
<span  style="">  71                                                                                                          </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  72     private static int TEMP_PASSWORD_LENGTH = 12;                                                        </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  73     private static final int FULL_PASSWORD_LENGTH = 16;                                                  </span>
<span  style="">  74                                                                                                          </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="">  75     @Autowired                                                                                           </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="">  76     @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                            </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="">  77     protected BroadleafApplicationEventPublisher eventPublisher;                                         </span>
<span  style="">  78                                                                                                          </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  79     @Resource(name = &quot;blAdminRoleDao&quot;)                                                                   </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  80     protected AdminRoleDao adminRoleDao;                                                                 </span>
<span  style="">  81                                                                                                          </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  82     @Resource(name = &quot;blAdminUserDao&quot;)                                                                   </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  83     protected AdminUserDao adminUserDao;                                                                 </span>
<span  style="">  84                                                                                                          </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  85     @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                 </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  86     protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                             </span>
<span  style="">  87                                                                                                          </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  88     @Resource(name = &quot;blAdminPermissionDao&quot;)                                                             </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  89     protected AdminPermissionDao adminPermissionDao;                                                     </span>
<span  style="">  90                                                                                                          </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style="">  91     protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                           </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style="">  92     protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                              </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style="">  93     protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                             </span>
<span  style="">  94                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95     /**                                                                                                  </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title="  96      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the">  96      * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;rðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title="  97      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}">  97      * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.eðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  98      */                                                                                                  </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style="">  99     @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                             </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style=""> 100     protected PasswordEncoder passwordEncoderBean;                                                       </span>
<span  style=""> 101                                                                                                          </span>
<span  style=""> 102                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 103 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 104     @Resource(name=&quot;blEmailService&quot;)                                                                     </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 105     protected EmailService emailService;                                                                 </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 106                                                                                                          </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 107     @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                      </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 108     protected EmailInfo resetPasswordEmailInfo;                                                          </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 109                                                                                                          </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 110     @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                       </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 111     protected EmailInfo sendUsernameEmailInfo;                                                           </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 112                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 113 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 114 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 114 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 115 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 116                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 117     /**                                                                                                  </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 118      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 118      * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@linkðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 119      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 119      * in order to provide bean configuration backwards compatibility with the deprecated {@link org.spriðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 120      *                                                                                                   </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 121      * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 122      *                                                                                                   </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 123      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 123      * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which isðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 124      *                                                                                                   </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 125      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 125      * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance oðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 126      */                                                                                                  </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 127     @PostConstruct                                                                                       </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 128     protected void setupPasswordEncoder() {                                                              </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 129         passwordEncoderNew = null;                                                                       </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 130         passwordEncoder = null;                                                                          </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 131         if (passwordEncoderBean instanceof PasswordEncoder) {                                            </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 132             passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                  </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 133         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 133         } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PaðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 134             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 134             passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 135         } else {                                                                                         </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 136             throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 137         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 138     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 139                                                                                                          </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 140 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span  style=""> 141                                                                                                          </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 142     protected int getTokenExpiredMinutes() {                                                             </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 143         return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144     }                                                                                                    </span>
<span  style=""> 145                                                                                                          </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 146     protected String getResetPasswordURL() {                                                             </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 147         return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 148     }                                                                                                    </span>
<span  style=""> 149                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 150     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 151     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 152     public void deleteAdminPermission(AdminPermission permission) {                                      </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 153         adminPermissionDao.deleteAdminPermission(permission);                                            </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 154         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 155     }                                                                                                    </span>
<span  style=""> 156                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 157     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 158     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 159     public void deleteAdminRole(AdminRole role) {                                                        </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 160         adminRoleDao.deleteAdminRole(role);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 161         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162     }                                                                                                    </span>
<span  style=""> 163                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 165     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 166     public void deleteAdminUser(AdminUser user) {                                                        </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 167         adminUserDao.deleteAdminUser(user);                                                              </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 168         clearAdminSecurityCache();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169     }                                                                                                    </span>
<span  style=""> 170                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171     @Override                                                                                            </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 172     public AdminPermission readAdminPermissionById(Long id) {                                            </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 173         return adminPermissionDao.readAdminPermissionById(id);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174     }                                                                                                    </span>
<span  style=""> 175                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 176     @Override                                                                                            </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 177     public AdminRole readAdminRoleById(Long id) {                                                        </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 178         return adminRoleDao.readAdminRoleById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181     @Override                                                                                            </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 182     public AdminUser readAdminUserById(Long id) {                                                        </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 183         return adminUserDao.readAdminUserById(id);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span  style=""> 185                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 186     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 187     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 188     public AdminPermission saveAdminPermission(AdminPermission permission) {                             </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 189         permission = adminPermissionDao.saveAdminPermission(permission);                                 </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 190         clearAdminSecurityCache();                                                                       </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 191         return permission;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192     }                                                                                                    </span>
<span  style=""> 193                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 195     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 196     public AdminRole saveAdminRole(AdminRole role) {                                                     </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 197         role = adminRoleDao.saveAdminRole(role);                                                         </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 198         clearAdminSecurityCache();                                                                       </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 199         return role;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 202     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 203     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 204     public AdminUser saveAdminUser(AdminUser user) {                                                     </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 205         boolean encodePasswordNeeded = false;                                                            </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 206         String unencodedPassword = user.getUnencodedPassword();                                          </span>
<span  style=""> 207                                                                                                          </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 208         if (user.getUnencodedPassword() != null) {                                                       </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 209             encodePasswordNeeded = true;                                                                 </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 210             user.setPassword(unencodedPassword);                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 211         }                                                                                                </span>
<span  style=""> 212                                                                                                          </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 213         // If no password is set, default to a secure password.                                          </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 214         if (user.getPassword() == null) {                                                                </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 215             user.setPassword(generateSecurePassword());                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 216         }                                                                                                </span>
<span  style=""> 217                                                                                                          </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 218         AdminUser returnUser = adminUserDao.saveAdminUser(user);                                         </span>
<span  style=""> 219                                                                                                          </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 220         if (encodePasswordNeeded) {                                                                      </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style=""> 221             returnUser.setPassword(encodePassword(unencodedPassword));                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222         }                                                                                                </span>
<span  style=""> 223                                                                                                          </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 224         returnUser = adminUserDao.saveAdminUser(returnUser);                                             </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 225         clearAdminSecurityCache();                                                                       </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 226         return returnUser;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 229     @Override                                                                                            </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 230     public void clearAdminSecurityCache() {                                                              </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 231         if (LOG.isTraceEnabled()) {                                                                      </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 232             LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233         }                                                                                                </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 234         cache.removeAll();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 235     }                                                                                                    </span>
<span  style=""> 236                                                                                                          </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 237     protected String generateSecurePassword() {                                                          </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 238         return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 239     }                                                                                                    </span>
<span  style=""> 240                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 241     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 242     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 243     public AdminUser changePassword(PasswordChange passwordChange) {                                     </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 244         AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                          </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 245         user.setUnencodedPassword(passwordChange.getNewPassword());                                      </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 246         user = saveAdminUser(user);                                                                      </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 247         Authentication auth = SecurityContextHolder.getContext().getAuthentication();                    </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 248         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 248         UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passworðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 249         SecurityContextHolder.getContext().setAuthentication(authRequest);                               </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 250         auth.setAuthenticated(false);                                                                    </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 251         return user;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252     }                                                                                                    </span>
<span  style=""> 253                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 254     @Override                                                                                            </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 255     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 255     public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 256         Boolean response = null;                                                                         </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 257         String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);     </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 258         Element cacheElement = cache.get(cacheKey);                                                      </span>
<span  style=""> 259                                                                                                          </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 260         if (cacheElement != null) {                                                                      </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 261             response = (Boolean) cacheElement.getObjectValue();                                          </span>
<span  style=""> 262                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 263             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 264                 LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266         }                                                                                                </span>
<span  style=""> 267                                                                                                          </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 268         if (response == null) {                                                                          </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 269             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 269             response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissioðŸ”µ</abbr></span>
<span  style=""> 270                                                                                                          </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 271             if (!response) {                                                                             </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 272                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 272                 response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273             }                                                                                            </span>
<span  style=""> 274                                                                                                          </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 275             cacheElement = new Element(cacheKey, response);                                              </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 276             cache.put(cacheElement);                                                                     </span>
<span  style=""> 277                                                                                                          </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 278             if (LOG.isTraceEnabled()) {                                                                  </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 279                 LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281         }                                                                                                </span>
<span  style=""> 282                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 283         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 284     }                                                                                                    </span>
<span  style=""> 285                                                                                                          </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 286     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 286     protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntiðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 287         return CACHE_KEY_PREFIX                                                                          </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 288                + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                       </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 289                + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                    </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 290                + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 291     }                                                                                                    </span>
<span  style=""> 292                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 293     @Override                                                                                            </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 294     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 294     public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 295         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 295         return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296     }                                                                                                    </span>
<span  style=""> 297                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 298     @Override                                                                                            </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 299     public AdminUser readAdminUserByUserName(String userName) {                                          </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 300         return adminUserDao.readAdminUserByUserName(userName);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 303     @Override                                                                                            </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 304     public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                         </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 305         return adminUserDao.readAdminUserByEmail(email);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306     }                                                                                                    </span>
<span  style=""> 307                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 308     @Override                                                                                            </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 309     public List&lt;AdminUser&gt; readAllAdminUsers() {                                                         </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 310         return adminUserDao.readAllAdminUsers();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311     }                                                                                                    </span>
<span  style=""> 312                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 313     @Override                                                                                            </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 314     public List&lt;AdminRole&gt; readAllAdminRoles() {                                                         </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 315         return adminRoleDao.readAllAdminRoles();                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 318     @Override                                                                                            </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 319     public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                             </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 320         return adminPermissionDao.readAllAdminPermissions();                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321     }                                                                                                    </span>
<span  style=""> 322                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 323     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 324     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 325     public GenericResponse sendForgotUsernameNotification(String emailAddress) {                         </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 326         GenericResponse response = new GenericResponse();                                                </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 327         List&lt;AdminUser&gt; users = null;                                                                    </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 328         if (emailAddress != null) {                                                                      </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 329             users = adminUserDao.readAdminUserByEmail(emailAddress);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 331         if (CollectionUtils.isEmpty(users)) {                                                            </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 332             response.addErrorCode(&quot;notFound&quot;);                                                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 333         } else {                                                                                         </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 334             List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                      </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 335             for (AdminUser user : users) {                                                               </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 336                 if (user.getActiveStatusFlag()) {                                                        </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 337                     activeUsernames.add(user.getLogin());                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 338                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339             }                                                                                            </span>
<span  style=""> 340                                                                                                          </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 341             if (activeUsernames.size() &gt; 0) {                                                            </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style=""><abbr title=" 342                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 342                 eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 343             } else {                                                                                     </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 344                 // send inactive username found email.                                                   </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 345                 response.addErrorCode(&quot;inactiveUser&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 346             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 348         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349     }                                                                                                    </span>
<span  style=""> 350                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 351     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 352     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 353     public GenericResponse sendResetPasswordNotification(String username) {                              </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 354         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 355         AdminUser user = null;                                                                           </span>
<span  style=""> 356                                                                                                          </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 357         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 358             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 359         }                                                                                                </span>
<span  style=""> 360                                                                                                          </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 361         checkUser(user,response);                                                                        </span>
<span  style=""> 362                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 363         if (! response.getHasErrors()) {                                                                 </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 364             String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                   </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 365             token = token.toLowerCase();                                                                 </span>
<span  style=""> 366                                                                                                          </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 367             ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                    </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 368             fpst.setAdminUserId(user.getId());                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style=""> 369             fpst.setToken(encodePassword(token));                                                        </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 370             fpst.setCreateDate(SystemTime.asDate());                                                     </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 371             forgotPasswordSecurityTokenDao.saveToken(fpst);                                              </span>
<span  style=""> 372                                                                                                          </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 373             String resetPasswordUrl = getResetPasswordURL();                                             </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 374             if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 375                 if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                    </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 376                     resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 377                 } else {                                                                                 </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 378                     resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380             }                                                                                            </span>
<span  style=""> 381                                                                                                          </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style=""><abbr title=" 382             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 382             eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPassðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383         }                                                                                                </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 384         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385     }                                                                                                    </span>
<span  style=""> 386                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 388     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 389     public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 389     public GenericResponse resetPasswordUsingToken(String username, String token, String password, StringðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 390         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 391         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 392         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 393             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 395         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 396         checkPassword(password, confirmPassword, response);                                              </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 397         if (StringUtils.isBlank(token)) {                                                                </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 398             response.addErrorCode(&quot;invalidToken&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 399         }                                                                                                </span>
<span  style=""> 400                                                                                                          </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 401         ForgotPasswordSecurityToken fpst = null;                                                         </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 402         if (! response.getHasErrors()) {                                                                 </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 403             token = token.toLowerCase();                                                                 </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 404             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 404             List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 405             for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                         </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style=""> 406                 if (isPasswordValid(fpstok.getToken(), token)) {                                         </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 407                     fpst = fpstok;                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 408                     break;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410             }                                                                                            </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 411             if (fpst == null) {                                                                          </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 412                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 413             } else if (fpst.isTokenUsedFlag()) {                                                         </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 414                 response.addErrorCode(&quot;tokenUsed&quot;);                                                      </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 415             } else if (isTokenExpired(fpst)) {                                                           </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 416                 response.addErrorCode(&quot;tokenExpired&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418         }                                                                                                </span>
<span  style=""> 419                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 420         if (! response.getHasErrors()) {                                                                 </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 421             if (! user.getId().equals(fpst.getAdminUserId())) {                                          </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 422                 if (LOG.isWarnEnabled()) {                                                               </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 423                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 423                     LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId(ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424                 }                                                                                        </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 425                 response.addErrorCode(&quot;invalidToken&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427         }                                                                                                </span>
<span  style=""> 428                                                                                                          </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 429         if (! response.getHasErrors()) {                                                                 </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 430             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 431             saveAdminUser(user);                                                                         </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 432             invalidateAllTokensForAdminUser(user);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433         }                                                                                                </span>
<span  style=""> 434                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 435         return response;                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436     }                                                                                                    </span>
<span  style=""> 437                                                                                                          </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 438     protected void invalidateAllTokensForAdminUser(AdminUser user) {                                     </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 439         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 439         List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 440         for (ForgotPasswordSecurityToken token : tokens) {                                               </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 441             token.setTokenUsedFlag(true);                                                                </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 442             forgotPasswordSecurityTokenDao.saveToken(token);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444     }                                                                                                    </span>
<span  style=""> 445                                                                                                          </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 446     protected void checkUser(AdminUser user, GenericResponse response) {                                 </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 447         if (user == null) {                                                                              </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 448             response.addErrorCode(&quot;invalidUser&quot;);                                                        </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 449         } else if (StringUtils.isBlank(user.getEmail())) {                                               </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 450             response.addErrorCode(&quot;emailNotFound&quot;);                                                      </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 451         } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                 </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 452             response.addErrorCode(&quot;inactiveUser&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 454     }                                                                                                    </span>
<span  style=""> 455                                                                                                          </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 456     protected void checkPassword(String password, String confirmPassword, GenericResponse response) {    </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 457         if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                     </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 458             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 459         } else if (! password.equals(confirmPassword)) {                                                 </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 460             response.addErrorCode(&quot;passwordMismatch&quot;);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462     }                                                                                                    </span>
<span  style=""> 463                                                                                                          </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""><abbr title=" 464     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {"> 464     protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse responðŸ”µ</abbr></span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style=""> 465         if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                   </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 466             response.addErrorCode(&quot;invalidPassword&quot;);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 470     protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                 </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 471         Date now = SystemTime.asDate();                                                                  </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 472         long currentTimeInMillis = now.getTime();                                                        </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 473         long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                     </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 474         long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                     </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 475         return minutesSinceSave &gt; getTokenExpiredMinutes();                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 476     }                                                                                                    </span>
<span  style=""> 477                                                                                                          </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 478     public static int getPASSWORD_TOKEN_LENGTH() {                                                       </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 479         return TEMP_PASSWORD_LENGTH;                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 480     }                                                                                                    </span>
<span  style=""> 481                                                                                                          </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 482     public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                             </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 483         AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484     }                                                                                                    </span>
<span  style=""> 485                                                                                                          </span>
<span  style=""> 486                                                                                                          </span>
<span class="-6681681893462133916" onmouseenter="enter('-6681681893462133916');" onmouseout="out('-6681681893462133916');" style=""> 487 &lt;&lt;&lt;&lt;&lt;&lt;&lt; LEFT                                                                                             </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 488     public EmailInfo getSendUsernameEmailInfo() {                                                        </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 489         return sendUsernameEmailInfo;                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 490     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 491                                                                                                          </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 492     public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                              </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 493         this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 494     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 495                                                                                                          </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 496     public EmailInfo getResetPasswordEmailInfo() {                                                       </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 497         return resetPasswordEmailInfo;                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 498     }                                                                                                    </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 499                                                                                                          </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 500     public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                            </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 501         this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                            </span>
<span  style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 502                                                                                                          </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 503 ||||||| BASE                                                                                             </span>
<span class="-3639349873877828882" onmouseenter="enter('-3639349873877828882');" onmouseout="out('-3639349873877828882');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"><abbr title=" 504 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwohrp23k5b6vdk93d3r*/"> 504 /*d94z9sk0k4hf9j3ijd - note the base isn&#x27;t actually empty, spork simply doesn&#x27;t generate a base - gd930kwðŸ”µ</abbr></span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 505 =======                                                                                                  </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 506                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 507     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 508     @Override                                                                                            </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 509     public Object getSalt(AdminUser user, String unencodedPassword) {                                    </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 510         Object salt = null;                                                                              </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 511         if (saltSource != null) {                                                                        </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"><abbr title=" 512             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 512             salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPasswoðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 513         }                                                                                                </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 514         return salt;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 515     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 516                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 517     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 518     @Override                                                                                            </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 519     public String getSalt() {                                                                            </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 520         return salt;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 521     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 522                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 523     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 524     @Override                                                                                            </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 525     public void setSalt(String salt) {                                                                   </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 526         this.salt = salt;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 527     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 528                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 529     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 530     @Override                                                                                            </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 531     public SaltSource getSaltSource() {                                                                  </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 532         return saltSource;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 533     }                                                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 534                                                                                                          </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 535     @Deprecated                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 536     @Override                                                                                            </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 537     public void setSaltSource(SaltSource saltSource) {                                                   </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 538         this.saltSource = saltSource;                                                                    </span>
<span  style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 539                                                                                                          </span>
<span class="-1814092468913316143" onmouseenter="enter('-1814092468913316143');" onmouseout="out('-1814092468913316143');" style=""> 540 &gt;&gt;&gt;&gt;&gt;&gt;&gt; RIGHT                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 541     }                                                                                                    </span>
<span  style=""> 542                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 543     @Override                                                                                            </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 544     @Transactional(&quot;blTransactionManager&quot;)                                                               </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 545     public GenericResponse changePassword(String username,                                               </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 546             String oldPassword, String password, String confirmPassword) {                               </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 547         GenericResponse response = new GenericResponse();                                                </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 548         AdminUser user = null;                                                                           </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 549         if (username != null) {                                                                          </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 550             user = adminUserDao.readAdminUserByUserName(username);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 551         }                                                                                                </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 552         checkUser(user, response);                                                                       </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 553         checkPassword(password, confirmPassword, response);                                              </span>
<span  style=""> 554                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 555         if (!response.getHasErrors()) {                                                                  </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 556             checkExistingPassword(oldPassword, user, response);                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557         }                                                                                                </span>
<span  style=""> 558                                                                                                          </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 559         if (!response.getHasErrors()) {                                                                  </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 560             user.setUnencodedPassword(password);                                                         </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 561             saveAdminUser(user);                                                                         </span>
<span  style=""> 562                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563         }                                                                                                </span>
<span  style=""> 564                                                                                                          </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 565         return response;                                                                                 </span>
<span  style=""> 566                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 567     }                                                                                                    </span>
<span  style=""> 568                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 569     /**                                                                                                  </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 570      * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 570      * Determines if a password is valid by comparing it to the encoded string, salting is handled internðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 571      * &lt;p&gt;                                                                                               </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 572      * This method must always be called to verify if a password is valid after the original encoded password is generated"> 572      * This method must always be called to verify if a password is valid after the original encoded passðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 573      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 573      * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resuðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 574      *                                                                                                   </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 575      * @param encodedPassword the encoded password                                                       </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 576      * @param rawPassword the raw password to check against the encoded password                         </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 577      * @return true if rawPassword matches the encodedPassword, false otherwise                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 578      */                                                                                                  </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 579     protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                      </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style=""> 580         return passwordEncoderBean.matches(rawPassword, encodedPassword);                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 581     }                                                                                                    </span>
<span  style=""> 582                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 583     /**                                                                                                  </span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style=""> 584      * Generate an encoded password from a raw password                                                  </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 585      * &lt;p&gt;                                                                                               </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 586      * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 586      * This method can only be called once per password. The salt is randomly generated internally in theðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 587      * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 587      * and appended to the hash to provide the resulting encoded password. Once this has been called on aðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 588      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 588      * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)}ðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 589      * same password twice will result in different encoded passwords.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 590      *                                                                                                   </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 591      * @param rawPassword the unencoded password to encode                                               </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 592      * @return the encoded password                                                                      </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 593      */                                                                                                  </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 594     protected String encodePassword(String rawPassword) {                                                </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style=""> 595         return passwordEncoderBean.encode(rawPassword);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 596     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597 }                                                                                                        </span>






































































































































































































































































</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  19 -                                                                                                                  </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  20 -import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  21 -import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  22 -import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  23                                                                                                                    </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>

<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  31  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  32  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  33  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  34  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  35  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  36  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  37  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  38  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  41  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  42  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>


<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  46  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  47 -import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  48 -import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  49 -import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  50 -import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>

<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  51  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  52 -import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  53  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  54 -import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  55  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  56  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  57  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  58  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  59                                                                                                                    </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  60  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  61  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="">  62  import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  63  import java.util.List;                                                                                            </span>
<span  style="">  64                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  65 -import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  66  import javax.annotation.Resource;                                                                                 </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  67 +                                                                                                                  </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  68 +import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  69 +import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  70 +import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  71                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  72  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  74   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  75   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  76   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  77  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  78  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  79                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  80      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  81                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  82      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  83      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  84                                                                                                                    </span>




<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  85      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  86      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  87                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  88      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  89      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  90                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  91      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  92      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style="">  93                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  94      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  95      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style="">  96                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  97 -    /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  98 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  99 -     *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 100 -     * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 101 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 102 -    @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 103 -    protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 104 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 105 -    /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 106 -     * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 107 -     */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 108 -    protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 109 -                                                                                                                  </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 110      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 111      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 112      protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>
<span  style=""> 113                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 114      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 115       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 115       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 116       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 116       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 117       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 118      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 119 -    protected Object passwordEncoderBean;                                                                         </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 120 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 121 -    /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 122 -     * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 123 -     *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 124 -     * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 125 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 126 -    @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 127 -    protected String salt;                                                                                        </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 128 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 129 -    /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 130 -     * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 131 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 132 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 133 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 134 -    @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 135 -    @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 136 -    @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 137 -    protected SaltSource saltSource;                                                                              </span>
<span class="-2329929589298188398" onmouseenter="enter('-2329929589298188398');" onmouseout="out('-2329929589298188398');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 138 +    protected PasswordEncoder passwordEncoderBean;                                                                </span>
<span  style=""> 139                                                                                                                    </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style=""> 140      @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style=""> 141      protected EmailService emailService;                                                                          </span>
<span  style=""> 142                                                                                                                    </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style=""> 143      @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style=""> 144      protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style=""> 145                                                                                                                    </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style=""> 146      @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style=""> 147      protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -    /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 150 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 150 -     * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 151 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 151 -     * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -     *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 153 -     * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 154 -     *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 155 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 155 -     * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 156 -     *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 157 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 157 -     * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 158 -     */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 159 -    @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 160 -    protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 161 -        passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 162 -        passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 163 -        if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 164 -            passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 165 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 165 -        } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 166 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 166 -            passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 167 -        } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 168 -            throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 169 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 170 -    }                                                                                                             </span>
<span  style=""> 171                                                                                                                    </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 172      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 173          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174      }                                                                                                             </span>
<span  style=""> 175                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 176      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 177          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178      }                                                                                                             </span>
<span  style=""> 179                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 180      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 181      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 182      public void deleteAdminPermission(AdminPermission permission) {                                               </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 183          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 184          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185      }                                                                                                             </span>
<span  style=""> 186                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 187      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 188      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 189      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 190          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 191          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192      }                                                                                                             </span>
<span  style=""> 193                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 194      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 195      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 196      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 197          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 198          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199      }                                                                                                             </span>
<span  style=""> 200                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 201      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 202      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 203          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 206      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 207      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 208          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209      }                                                                                                             </span>
<span  style=""> 210                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 211      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 212      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 213          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 216      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 217      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 218      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 219          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 220          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 221          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 222      }                                                                                                             </span>
<span  style=""> 223                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 224      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 225      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 226      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 227          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 228          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 229          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 230      }                                                                                                             </span>
<span  style=""> 231                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 232      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 233      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 234      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 235          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 236          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 237                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 238          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 239              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 240              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span  style=""> 242                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 243          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 244          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 245              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 246          }                                                                                                         </span>
<span  style=""> 247                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 248          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 249                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 250          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 251 -            returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>
<span class="6936247183272599459" onmouseenter="enter('6936247183272599459');" onmouseout="out('6936247183272599459');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 252 +            returnUser.setPassword(encodePassword(unencodedPassword));                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253          }                                                                                                         </span>
<span  style=""> 254                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 255          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 256          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 257          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 258      }                                                                                                             </span>
<span  style=""> 259                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 260      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 261      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 262          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 263              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 264          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 265          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266      }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 268      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 269          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270      }                                                                                                             </span>
<span  style=""> 271                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 272      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 273      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 274      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 275          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 276          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 277          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 278          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 279          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 280          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 281          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 282          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 283      }                                                                                                             </span>
<span  style=""> 284                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 285      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 286      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 287          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 288          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 289          Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style=""> 290                                                                                                                    </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 291          if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 292              response = (Boolean) cacheElement.getObjectValue();                                                   </span>
<span  style=""> 293                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 294              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 295                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 296              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span  style=""> 298                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 299          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 300              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 300              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style=""> 301                                                                                                                    </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 302              if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 303                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 303                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304              }                                                                                                     </span>
<span  style=""> 305                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 306              cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 307              cache.put(cacheElement);                                                                              </span>
<span  style=""> 308                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 309              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 310                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312          }                                                                                                         </span>
<span  style=""> 313                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 314          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315      }                                                                                                             </span>
<span  style=""> 316                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 317      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 317      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 318          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 319                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 320                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 321                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322      }                                                                                                             </span>
<span  style=""> 323                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 324      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 325      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 325      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 326          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 326          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 327      }                                                                                                             </span>
<span  style=""> 328                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 329      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 330      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 331          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 334      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 335      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 336          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 337      }                                                                                                             </span>
<span  style=""> 338                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 339      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 340      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 341          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342      }                                                                                                             </span>
<span  style=""> 343                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 344      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 345      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 346          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 347      }                                                                                                             </span>
<span  style=""> 348                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 349      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 350      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 351          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352      }                                                                                                             </span>
<span  style=""> 353                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 354      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 355      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 356      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 357          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 358          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 359          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 360              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 361          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 362          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 363              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 364          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 365              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 366              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 367                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 368                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 370              }                                                                                                     </span>
<span  style=""> 371                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 372              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 373                  HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style=""> 374                  vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style=""> 375                  emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>

<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 376              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 377                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 378                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 379              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 380          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 381          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382      }                                                                                                             </span>
<span  style=""> 383                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 384      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 385      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 386      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 387          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 388          AdminUser user = null;                                                                                    </span>
<span  style=""> 389                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 390          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 391              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392          }                                                                                                         </span>
<span  style=""> 393                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 394          checkUser(user,response);                                                                                 </span>
<span  style=""> 395                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 396          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 397              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 398              token = token.toLowerCase();                                                                          </span>
<span  style=""> 399                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 400              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 401              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 402 -            fpst.setToken(encodePassword(token, null));                                                           </span>
<span class="-1250878182907610155" onmouseenter="enter('-1250878182907610155');" onmouseout="out('-1250878182907610155');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 403 +            fpst.setToken(encodePassword(token));                                                                 </span>
<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 404              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 405              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 406                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style=""> 407              HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style=""> 408              vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 409              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 410              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 411                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 412                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 413                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 414                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 416              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style=""> 417              vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style=""> 418              emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style=""> 419                                                                                                                    </span>


<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 420          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 421          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 422      }                                                                                                             </span>
<span  style=""> 423                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 424      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 425      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 426      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 426      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 427          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 428          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 429          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 430              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 432          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 433          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 434          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 435              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436          }                                                                                                         </span>
<span  style=""> 437                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 438          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 439          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 440              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 441              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 441              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 442              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 443 -                if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>
<span class="-1464198975962099041" onmouseenter="enter('-1464198975962099041');" onmouseout="out('-1464198975962099041');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 444 +                if (isPasswordValid(fpstok.getToken(), token)) {                                                  </span>
<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 445                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 446                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 447                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 449              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 450                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 451              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 452                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 453              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 454                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 455              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456          }                                                                                                         </span>
<span  style=""> 457                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 458          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 459              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 460                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 461                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 461                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 462                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 463                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465          }                                                                                                         </span>
<span  style=""> 466                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 467          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 468              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 469              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 470              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 471          }                                                                                                         </span>
<span  style=""> 472                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 473          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474      }                                                                                                             </span>
<span  style=""> 475                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 476      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 477          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 477          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 478          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 479              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 480              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 481          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 482      }                                                                                                             </span>
<span  style=""> 483                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 484      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 485          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 486              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 487          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 488              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 489          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 490              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 491          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 492      }                                                                                                             </span>
<span  style=""> 493                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 494      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 495          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 496              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 497          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 498              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 499          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 500      }                                                                                                             </span>
<span  style=""> 501                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 502      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 503 -        if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>
<span class="-1934295941877646517" onmouseenter="enter('-1934295941877646517');" onmouseout="out('-1934295941877646517');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 504 +        if (!isPasswordValid(user.getPassword(), unencodedPassword)) {                                            </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 505              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 506          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 507      }                                                                                                             </span>
<span  style=""> 508                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 509      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 510          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 511          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 512          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 513          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 514          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 515      }                                                                                                             </span>
<span  style=""> 516                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 517      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 518          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 519      }                                                                                                             </span>
<span  style=""> 520                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 521      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 522          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 523      }                                                                                                             </span>
<span  style=""> 524                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style=""> 525      public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style=""> 526          return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 527      }                                                                                                             </span>
<span  style=""> 528                                                                                                                    </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style=""> 529      public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style=""> 530          this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 531      }                                                                                                             </span>
<span  style=""> 532                                                                                                                    </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style=""> 533      public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style=""> 534          return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 535      }                                                                                                             </span>
<span  style=""> 536                                                                                                                    </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style=""> 537      public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style=""> 538          this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 539      }                                                                                                             </span>
<span  style=""> 540                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 541 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 542 -    @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 543 -    public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 544 -        Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 545 -        if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 546 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 546 -            salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 547 -        }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 548 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 549 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 550 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 551 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 552 -    @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 553 -    public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 554 -        return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 555 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 556 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 557 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 558 -    @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 559 -    public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 560 -        this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 561 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 562 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 563 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 564 -    @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 565 -    public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 566 -        return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 567 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 568 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 569 -    @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 570 -    @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 571 -    public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 572 -        this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 573 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 574 -                                                                                                                  </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 575      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 576      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 577      public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 578              String oldPassword, String password, String confirmPassword) {                                        </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 579          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 580          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 581          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 582              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 583          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 584          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 585          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 586                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 587          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 588              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 589          }                                                                                                         </span>
<span  style=""> 590                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 591          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 592              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 593              saveAdminUser(user);                                                                                  </span>
<span  style=""> 594                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 595          }                                                                                                         </span>
<span  style=""> 596                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 597          return response;                                                                                          </span>
<span  style=""> 598                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 599 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 600 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 601 -    /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 602 -     * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 603 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 604 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 604 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 605 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 605 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 606 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 606 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 607 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 607 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 608 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 608 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 609 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 610 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 611 -     *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 612 -     * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 613 -     * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 614 -     * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 615 -     * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 616 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 617 -    @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 618 -    protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 619 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 620 -            return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 621 -        } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 622 -            return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 623 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 624      }                                                                                                             </span>
<span  style=""> 625                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 626      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 627       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 627       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 628       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 629       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 629       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 630       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 630       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 631       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 632       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 633       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 634       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 635       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 636      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 637 -        return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>
<span class="5053852377821437125" onmouseenter="enter('5053852377821437125');" onmouseout="out('5053852377821437125');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 638 +        return passwordEncoderBean.matches(rawPassword, encodedPassword);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 639      }                                                                                                             </span>
<span  style=""> 640                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 641      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 642 -     * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 643 -     * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 644 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 644 -     * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 645 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 645 -     * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 646 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 646 -     * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 647 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 647 -     * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 648 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 648 -     * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 649 -     *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 650 -     * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 651 -     *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 652 -     * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 653 -     * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 654 -     * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 655 -     */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 656 -    @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 657 -    protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 658 -        if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 659 -            return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 660 -        } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 661 -            return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 662 -        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 663 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 664 -                                                                                                                  </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 665 -    /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 666 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 666 -     * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>
<span class="6111425902328738631" onmouseenter="enter('6111425902328738631');" onmouseout="out('6111425902328738631');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 667 +     * Generate an encoded password from a raw password                                                           </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 668       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 672       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 673       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 674       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 675       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 676       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 677      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 678 -        return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 679 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 680 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 681 -    @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 682 -    protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 683 -        return passwordEncoder != null;                                                                           </span>
<span class="-3121342566836529697" onmouseenter="enter('-3121342566836529697');" onmouseout="out('-3121342566836529697');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 684 +        return passwordEncoderBean.encode(rawPassword);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 686  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="7283730021202772321" onmouseenter="enter('7283730021202772321');" onmouseout="out('7283730021202772321');" style="">   2   * #%L                                                                                                            </span>
<span class="-3339060969767811416" onmouseenter="enter('-3339060969767811416');" onmouseout="out('-3339060969767811416');" style="">   3   * BroadleafCommerce Open Admin Platform                                                                          </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   4   * %%                                                                                                             </span>
<span class="1978304592184257722" onmouseenter="enter('1978304592184257722');" onmouseout="out('1978304592184257722');" style="">   5   * Copyright (C) 2009 - 2016 Broadleaf Commerce                                                                   </span>
<span class="305149960078729975" onmouseenter="enter('305149960078729975');" onmouseout="out('305149960078729975');" style="">   6   * %%                                                                                                             </span>
<span class="4430451662992926684" onmouseenter="enter('4430451662992926684');" onmouseout="out('4430451662992926684');" style="">   7   * Licensed under the Broadleaf Fair Use License Agreement, Version 1.0                                           </span>
<span class="8206099442596739681" onmouseenter="enter('8206099442596739681');" onmouseout="out('8206099442596739681');" style="">   8   * (the &quot;Fair Use License&quot; located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)             </span>
<span class="-4338570431005413339" onmouseenter="enter('-4338570431005413339');" onmouseout="out('-4338570431005413339');" style="">   9   * unless the restrictions on use therein are violated and require payment to Broadleaf in which case             </span>
<span class="-5739615313038505012" onmouseenter="enter('-5739615313038505012');" onmouseout="out('-5739615313038505012');" style="">  10   * the Broadleaf End User License Agreement (EULA), Version 1.1                                                   </span>
<span class="-196756316119086558" onmouseenter="enter('-196756316119086558');" onmouseout="out('-196756316119086558');" style="">  11   * (the &quot;Commercial License&quot; located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)          </span>
<span class="-3691518077331372763" onmouseenter="enter('-3691518077331372763');" onmouseout="out('-3691518077331372763');" style="">  12   * shall apply.                                                                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  13   *                                                                                                                </span>
<span class="-3333434530440420199" onmouseenter="enter('-3333434530440420199');" onmouseout="out('-3333434530440420199');" style=""><abbr title="  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;)">  14   * Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the &quot;Custom License&quot;ðŸ”µ</abbr></span>
<span class="-2556272520656899284" onmouseenter="enter('-2556272520656899284');" onmouseout="out('-2556272520656899284');" style="">  15   * between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.</span>
<span class="3739716589509259313" onmouseenter="enter('3739716589509259313');" onmouseout="out('3739716589509259313');" style="">  16   * #L%                                                                                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span class="-5890371413541186026" onmouseenter="enter('-5890371413541186026');" onmouseout="out('-5890371413541186026');" style="">  18  package org.broadleafcommerce.openadmin.server.security.service;                                                  </span>
<span  style="">  19                                                                                                                    </span>
<span class="5660945883633846598" onmouseenter="enter('5660945883633846598');" onmouseout="out('5660945883633846598');" style="">  20  import net.sf.ehcache.Cache;                                                                                      </span>
<span class="-6192515751407234406" onmouseenter="enter('-6192515751407234406');" onmouseout="out('-6192515751407234406');" style="">  21  import net.sf.ehcache.CacheManager;                                                                               </span>
<span class="-1244052365063943729" onmouseenter="enter('-1244052365063943729');" onmouseout="out('-1244052365063943729');" style="">  22  import net.sf.ehcache.Element;                                                                                    </span>
<span  style="">  23                                                                                                                    </span>
<span class="-4900305655545834342" onmouseenter="enter('-4900305655545834342');" onmouseout="out('-4900305655545834342');" style="">  24  import org.apache.commons.collections4.CollectionUtils;                                                           </span>
<span class="-4811768396919678325" onmouseenter="enter('-4811768396919678325');" onmouseout="out('-4811768396919678325');" style="">  25  import org.apache.commons.lang3.BooleanUtils;                                                                     </span>
<span class="-8105670274694144339" onmouseenter="enter('-8105670274694144339');" onmouseout="out('-8105670274694144339');" style="">  26  import org.apache.commons.lang3.StringUtils;                                                                      </span>
<span class="494203924075255110" onmouseenter="enter('494203924075255110');" onmouseout="out('494203924075255110');" style="">  27  import org.apache.commons.logging.Log;                                                                            </span>
<span class="-8227491862907452788" onmouseenter="enter('-8227491862907452788');" onmouseout="out('-8227491862907452788');" style="">  28  import org.apache.commons.logging.LogFactory;                                                                     </span>
<span class="9149575778472736151" onmouseenter="enter('9149575778472736151');" onmouseout="out('9149575778472736151');" style="">  29  import org.broadleafcommerce.common.email.service.EmailService;                                                   </span>
<span class="-6139442722863763787" onmouseenter="enter('-6139442722863763787');" onmouseout="out('-6139442722863763787');" style="">  30  import org.broadleafcommerce.common.email.service.info.EmailInfo;                                                 </span>
<span class="6519729880675887369" onmouseenter="enter('6519729880675887369');" onmouseout="out('6519729880675887369');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  31 +import org.broadleafcommerce.common.event.BroadleafApplicationEventPublisher;                                     </span>
<span class="-2635683203763841416" onmouseenter="enter('-2635683203763841416');" onmouseout="out('-2635683203763841416');" style="">  32  import org.broadleafcommerce.common.security.util.PasswordChange;                                                 </span>
<span class="6413981270350028954" onmouseenter="enter('6413981270350028954');" onmouseout="out('6413981270350028954');" style="">  33  import org.broadleafcommerce.common.security.util.PasswordUtils;                                                  </span>
<span class="-3956591208111981988" onmouseenter="enter('-3956591208111981988');" onmouseout="out('-3956591208111981988');" style="">  34  import org.broadleafcommerce.common.service.GenericResponse;                                                      </span>
<span class="1373992879208813777" onmouseenter="enter('1373992879208813777');" onmouseout="out('1373992879208813777');" style="">  35  import org.broadleafcommerce.common.time.SystemTime;                                                              </span>
<span class="4862799527593989873" onmouseenter="enter('4862799527593989873');" onmouseout="out('4862799527593989873');" style="">  36  import org.broadleafcommerce.common.util.BLCSystemProperty;                                                       </span>
<span class="-3347161074136237116" onmouseenter="enter('-3347161074136237116');" onmouseout="out('-3347161074136237116');" style="">  37  import org.broadleafcommerce.common.util.StringUtil;                                                              </span>
<span class="4400282498813915003" onmouseenter="enter('4400282498813915003');" onmouseout="out('4400282498813915003');" style="">  38  import org.broadleafcommerce.openadmin.server.security.dao.AdminPermissionDao;                                    </span>
<span class="271226912106531007" onmouseenter="enter('271226912106531007');" onmouseout="out('271226912106531007');" style="">  39  import org.broadleafcommerce.openadmin.server.security.dao.AdminRoleDao;                                          </span>
<span class="2120683388748052627" onmouseenter="enter('2120683388748052627');" onmouseout="out('2120683388748052627');" style="">  40  import org.broadleafcommerce.openadmin.server.security.dao.AdminUserDao;                                          </span>
<span class="-734701965990367156" onmouseenter="enter('-734701965990367156');" onmouseout="out('-734701965990367156');" style="">  41  import org.broadleafcommerce.openadmin.server.security.dao.ForgotPasswordSecurityTokenDao;                        </span>
<span class="-721085571073784419" onmouseenter="enter('-721085571073784419');" onmouseout="out('-721085571073784419');" style="">  42  import org.broadleafcommerce.openadmin.server.security.domain.AdminPermission;                                    </span>
<span class="-397388249146088998" onmouseenter="enter('-397388249146088998');" onmouseout="out('-397388249146088998');" style="">  43  import org.broadleafcommerce.openadmin.server.security.domain.AdminRole;                                          </span>
<span class="-6571883875867969954" onmouseenter="enter('-6571883875867969954');" onmouseout="out('-6571883875867969954');" style="">  44  import org.broadleafcommerce.openadmin.server.security.domain.AdminUser;                                          </span>
<span class="-3613743388291199846" onmouseenter="enter('-3613743388291199846');" onmouseout="out('-3613743388291199846');" style="">  45  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityToken;                        </span>
<span class="-51929630618099815" onmouseenter="enter('-51929630618099815');" onmouseout="out('-51929630618099815');" style="">  46  import org.broadleafcommerce.openadmin.server.security.domain.ForgotPasswordSecurityTokenImpl;                    </span>
<span class="6252258873616606326" onmouseenter="enter('6252258873616606326');" onmouseout="out('6252258873616606326');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import org.broadleafcommerce.openadmin.server.security.event.AdminForgotPasswordEvent;                            </span>
<span class="4966002962586824949" onmouseenter="enter('4966002962586824949');" onmouseout="out('4966002962586824949');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  48 +import org.broadleafcommerce.openadmin.server.security.event.AdminForgotUsernameEvent;                            </span>
<span class="2985449391942097556" onmouseenter="enter('2985449391942097556');" onmouseout="out('2985449391942097556');" style="">  49  import org.broadleafcommerce.openadmin.server.security.service.type.PermissionType;                               </span>
<span class="-1292445773927620958" onmouseenter="enter('-1292445773927620958');" onmouseout="out('-1292445773927620958');" style="">  50  import org.broadleafcommerce.openadmin.server.security.service.user.AdminUserDetails;                             </span>
<span class="4412650647810815777" onmouseenter="enter('4412650647810815777');" onmouseout="out('4412650647810815777');" style="">  51  import org.springframework.beans.factory.NoSuchBeanDefinitionException;                                           </span>
<span class="-6148326362900055524" onmouseenter="enter('-6148326362900055524');" onmouseout="out('-6148326362900055524');" style="">  52  import org.springframework.beans.factory.annotation.Autowired;                                                    </span>
<span class="-4664978283136443479" onmouseenter="enter('-4664978283136443479');" onmouseout="out('-4664978283136443479');" style="">  53  import org.springframework.beans.factory.annotation.Qualifier;                                                    </span>
<span class="1015650858128177541" onmouseenter="enter('1015650858128177541');" onmouseout="out('1015650858128177541');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  54 +import org.springframework.context.ApplicationContext;                                                            </span>
<span class="-7471998381582359273" onmouseenter="enter('-7471998381582359273');" onmouseout="out('-7471998381582359273');" style="">  55  import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;                           </span>
<span class="443255988526129671" onmouseenter="enter('443255988526129671');" onmouseout="out('443255988526129671');" style="">  56  import org.springframework.security.authentication.dao.SaltSource;                                                </span>
<span class="3318257588281594272" onmouseenter="enter('3318257588281594272');" onmouseout="out('3318257588281594272');" style="">  57  import org.springframework.security.core.Authentication;                                                          </span>
<span class="6507752321844884693" onmouseenter="enter('6507752321844884693');" onmouseout="out('6507752321844884693');" style="">  58  import org.springframework.security.core.GrantedAuthority;                                                        </span>
<span class="6340115210452822114" onmouseenter="enter('6340115210452822114');" onmouseout="out('6340115210452822114');" style="">  59  import org.springframework.security.core.context.SecurityContextHolder;                                           </span>
<span class="2075826732928208126" onmouseenter="enter('2075826732928208126');" onmouseout="out('2075826732928208126');" style="">  60  import org.springframework.security.crypto.password.PasswordEncoder;                                              </span>
<span class="-5275076188864034753" onmouseenter="enter('-5275076188864034753');" onmouseout="out('-5275076188864034753');" style="">  61  import org.springframework.stereotype.Service;                                                                    </span>
<span class="4419089678332371422" onmouseenter="enter('4419089678332371422');" onmouseout="out('4419089678332371422');" style="">  62  import org.springframework.transaction.annotation.Transactional;                                                  </span>
<span  style="">  63                                                                                                                    </span>
<span class="9191247685397773893" onmouseenter="enter('9191247685397773893');" onmouseout="out('9191247685397773893');" style="">  64  import java.util.ArrayList;                                                                                       </span>
<span class="1748005127055838442" onmouseenter="enter('1748005127055838442');" onmouseout="out('1748005127055838442');" style="">  65  import java.util.Date;                                                                                            </span>
<span class="4169599896190320038" onmouseenter="enter('4169599896190320038');" onmouseout="out('4169599896190320038');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  66 -import java.util.HashMap;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  67  import java.util.List;                                                                                            </span>
<span  style="">  68                                                                                                                    </span>
<span class="-1842700952879713169" onmouseenter="enter('-1842700952879713169');" onmouseout="out('-1842700952879713169');" style="">  69  import javax.annotation.PostConstruct;                                                                            </span>
<span class="-5292076237369528758" onmouseenter="enter('-5292076237369528758');" onmouseout="out('-5292076237369528758');" style="">  70  import javax.annotation.Resource;                                                                                 </span>




<span  style="">  71                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  72  /**                                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  73   *                                                                                                                </span>
<span class="3104529581940833663" onmouseenter="enter('3104529581940833663');" onmouseout="out('3104529581940833663');" style="">  74   * @author jfischer                                                                                               </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  75   *                                                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  76   */                                                                                                               </span>
<span class="7151119262986546403" onmouseenter="enter('7151119262986546403');" onmouseout="out('7151119262986546403');" style="">  77  @Service(&quot;blAdminSecurityService&quot;)                                                                                </span>
<span class="1559722564766242702" onmouseenter="enter('1559722564766242702');" onmouseout="out('1559722564766242702');" style="">  78  public class AdminSecurityServiceImpl implements AdminSecurityService {                                           </span>
<span  style="">  79                                                                                                                    </span>
<span class="2841261057135335523" onmouseenter="enter('2841261057135335523');" onmouseout="out('2841261057135335523');" style="">  80      private static final Log LOG = LogFactory.getLog(AdminSecurityServiceImpl.class);                             </span>
<span  style="">  81                                                                                                                    </span>
<span class="-7614584946038225120" onmouseenter="enter('-7614584946038225120');" onmouseout="out('-7614584946038225120');" style="">  82      private static int TEMP_PASSWORD_LENGTH = 12;                                                                 </span>
<span class="7130616256770659284" onmouseenter="enter('7130616256770659284');" onmouseout="out('7130616256770659284');" style="">  83      private static final int FULL_PASSWORD_LENGTH = 16;                                                           </span>
<span  style="">  84                                                                                                                    </span>
<span class="5554564923016007608" onmouseenter="enter('5554564923016007608');" onmouseout="out('5554564923016007608');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  85 +    @Autowired                                                                                                    </span>
<span class="-7224044524343370301" onmouseenter="enter('-7224044524343370301');" onmouseout="out('-7224044524343370301');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  86 +    @Qualifier(&quot;blApplicationEventPublisher&quot;)                                                                     </span>
<span class="-5629661248749562711" onmouseenter="enter('-5629661248749562711');" onmouseout="out('-5629661248749562711');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  87 +    protected BroadleafApplicationEventPublisher eventPublisher;                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  88 +                                                                                                                  </span>
<span class="1143802594828596065" onmouseenter="enter('1143802594828596065');" onmouseout="out('1143802594828596065');" style="">  89      @Resource(name = &quot;blAdminRoleDao&quot;)                                                                            </span>
<span class="1727807961726127544" onmouseenter="enter('1727807961726127544');" onmouseout="out('1727807961726127544');" style="">  90      protected AdminRoleDao adminRoleDao;                                                                          </span>
<span  style="">  91                                                                                                                    </span>
<span class="-5193304577016957246" onmouseenter="enter('-5193304577016957246');" onmouseout="out('-5193304577016957246');" style="">  92      @Resource(name = &quot;blAdminUserDao&quot;)                                                                            </span>
<span class="-2542536430165066610" onmouseenter="enter('-2542536430165066610');" onmouseout="out('-2542536430165066610');" style="">  93      protected AdminUserDao adminUserDao;                                                                          </span>
<span  style="">  94                                                                                                                    </span>
<span class="4687418386641500428" onmouseenter="enter('4687418386641500428');" onmouseout="out('4687418386641500428');" style="">  95      @Resource(name = &quot;blForgotPasswordSecurityTokenDao&quot;)                                                          </span>
<span class="3864246860624667148" onmouseenter="enter('3864246860624667148');" onmouseout="out('3864246860624667148');" style="">  96      protected ForgotPasswordSecurityTokenDao forgotPasswordSecurityTokenDao;                                      </span>
<span  style="">  97                                                                                                                    </span>
<span class="5190939465043726651" onmouseenter="enter('5190939465043726651');" onmouseout="out('5190939465043726651');" style="">  98      @Resource(name = &quot;blAdminPermissionDao&quot;)                                                                      </span>
<span class="551734414113734813" onmouseenter="enter('551734414113734813');" onmouseout="out('551734414113734813');" style="">  99      protected AdminPermissionDao adminPermissionDao;                                                              </span>
<span  style=""> 100                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 101      /**                                                                                                           </span>
<span class="-9011162707134809495" onmouseenter="enter('-9011162707134809495');" onmouseout="out('-9011162707134809495');" style=""> 102       * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the deprecated version.</span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 103       *                                                                                                            </span>
<span class="2452173250496209218" onmouseenter="enter('2452173250496209218');" onmouseout="out('2452173250496209218');" style=""> 104       * @deprecated Spring Security has deprecated this encoder interface, this will be removed in 4.2             </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 105       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 106      @Deprecated                                                                                                   </span>
<span class="7564109825156072680" onmouseenter="enter('7564109825156072680');" onmouseout="out('7564109825156072680');" style=""> 107      protected org.springframework.security.authentication.encoding.PasswordEncoder passwordEncoder;               </span>
<span  style=""> 108                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 109      /**                                                                                                           </span>
<span class="-5116861287321393394" onmouseenter="enter('-5116861287321393394');" onmouseout="out('-5116861287321393394');" style=""> 110       * &lt;p&gt;Set by {@link #setupPasswordEncoder()} if the blPasswordEncoder bean provided is the new version.       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 111       */                                                                                                           </span>
<span class="1701368210273381595" onmouseenter="enter('1701368210273381595');" onmouseout="out('1701368210273381595');" style=""> 112      protected PasswordEncoder passwordEncoderNew;                                                                 </span>
<span  style=""> 113                                                                                                                    </span>
<span class="1555163514240921615" onmouseenter="enter('1555163514240921615');" onmouseout="out('1555163514240921615');" style=""> 114      protected static String CACHE_NAME = &quot;blSecurityElements&quot;;                                                    </span>
<span class="-6681078429984220726" onmouseenter="enter('-6681078429984220726');" onmouseout="out('-6681078429984220726');" style=""> 115      protected static String CACHE_KEY_PREFIX = &quot;security:&quot;;                                                       </span>
<span class="9194662698558551337" onmouseenter="enter('9194662698558551337');" onmouseout="out('9194662698558551337');" style=""> 116      protected Cache cache = CacheManager.getInstance().getCache(CACHE_NAME);                                      </span>
<span  style=""> 117                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 118      /**                                                                                                           </span>
<span class="6298544191369985956" onmouseenter="enter('6298544191369985956');" onmouseout="out('6298544191369985956');" style=""><abbr title=" 119       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using the"> 119       * &lt;p&gt;This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we&#x27;re using tðŸ”µ</abbr></span>
<span class="897245791379814301" onmouseenter="enter('897245791379814301');" onmouseout="out('897245791379814301');" style=""><abbr title=" 120       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}"> 120       * new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 121       */                                                                                                           </span>
<span class="5568121926700365365" onmouseenter="enter('5568121926700365365');" onmouseout="out('5568121926700365365');" style=""> 122      @Resource(name=&quot;blAdminPasswordEncoder&quot;)                                                                      </span>
<span class="6445807734700841407" onmouseenter="enter('6445807734700841407');" onmouseout="out('6445807734700841407');" style=""> 123      protected Object passwordEncoderBean;                                                                         </span>
<span  style=""> 124                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 125      /**                                                                                                           </span>
<span class="3279032571910866698" onmouseenter="enter('3279032571910866698');" onmouseout="out('3279032571910866698');" style=""> 126       * Optional password salt to be used with the passwordEncoder                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 127       *                                                                                                            </span>
<span class="28005897615005200" onmouseenter="enter('28005897615005200');" onmouseout="out('28005897615005200');" style=""> 128       * @deprecated use {@link #saltSource} instead, this will be removed in 4.2                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 129       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 130      @Deprecated                                                                                                   </span>
<span class="8995389235954487612" onmouseenter="enter('8995389235954487612');" onmouseout="out('8995389235954487612');" style=""> 131      protected String salt;                                                                                        </span>
<span  style=""> 132                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 133      /**                                                                                                           </span>
<span class="7160577035329884491" onmouseenter="enter('7160577035329884491');" onmouseout="out('7160577035329884491');" style=""> 134       * Use a Salt Source ONLY if there&#x27;s one configured                                                           </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 135       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 136       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 137       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 138      @Deprecated                                                                                                   </span>
<span class="5439639527514771127" onmouseenter="enter('5439639527514771127');" onmouseout="out('5439639527514771127');" style=""> 139      @Autowired(required=false)                                                                                    </span>
<span class="3235804255885885281" onmouseenter="enter('3235804255885885281');" onmouseout="out('3235804255885885281');" style=""> 140      @Qualifier(&quot;blAdminSaltSource&quot;)                                                                               </span>
<span class="-1458682478412193164" onmouseenter="enter('-1458682478412193164');" onmouseout="out('-1458682478412193164');" style=""> 141      protected SaltSource saltSource;                                                                              </span>

<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 142 -                                                                                                                  </span>
<span class="6713535142503626257" onmouseenter="enter('6713535142503626257');" onmouseout="out('6713535142503626257');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 143 -    @Resource(name=&quot;blEmailService&quot;)                                                                              </span>
<span class="3549223300613749719" onmouseenter="enter('3549223300613749719');" onmouseout="out('3549223300613749719');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -    protected EmailService emailService;                                                                          </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 145 -                                                                                                                  </span>
<span class="-5664681169717006687" onmouseenter="enter('-5664681169717006687');" onmouseout="out('-5664681169717006687');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 146 -    @Resource(name=&quot;blSendAdminResetPasswordEmail&quot;)                                                               </span>
<span class="-2122836053276895927" onmouseenter="enter('-2122836053276895927');" onmouseout="out('-2122836053276895927');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 147 -    protected EmailInfo resetPasswordEmailInfo;                                                                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 148 -                                                                                                                  </span>
<span class="-1973980982701755932" onmouseenter="enter('-1973980982701755932');" onmouseout="out('-1973980982701755932');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -    @Resource(name=&quot;blSendAdminUsernameEmailInfo&quot;)                                                                </span>
<span class="3587440193220569387" onmouseenter="enter('3587440193220569387');" onmouseout="out('3587440193220569387');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 150 -    protected EmailInfo sendUsernameEmailInfo;                                                                    </span>
<span  style=""> 151                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 152      /**                                                                                                           </span>
<span class="-4407931552763383858" onmouseenter="enter('-4407931552763383858');" onmouseout="out('-4407931552763383858');" style=""><abbr title=" 153       * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passwordEncoderBean}"> 153       * &lt;p&gt;Sets either {@link #passwordEncoder} or {@link #passwordEncoderNew} based on the type of {@link #passworðŸ”µ</abbr></span>
<span class="-1649014883369305760" onmouseenter="enter('-1649014883369305760');" onmouseout="out('-1649014883369305760');" style=""><abbr title=" 154       * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} bean."> 154       * in order to provide bean configuration backwards compatibility with the deprecated {@link org.springframewoðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 155       *                                                                                                            </span>
<span class="-4354035044309274291" onmouseenter="enter('-4354035044309274291');" onmouseout="out('-4354035044309274291');" style=""> 156       * &lt;p&gt;{@link #passwordEncoderBean} is set by the bean defined as &quot;blPasswordEncoder&quot;.                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 157       *                                                                                                            </span>
<span class="5394505181252316608" onmouseenter="enter('5394505181252316608');" onmouseout="out('5394505181252316608');" style=""><abbr title=" 158       * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not null."> 158       * &lt;p&gt;This class will utilize either the new or deprecated PasswordEncoder type depending on which is not nullðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 159       *                                                                                                            </span>
<span class="6775226299117941025" onmouseenter="enter('6775226299117941025');" onmouseout="out('6775226299117941025');" style=""><abbr title=" 160       * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either PasswordEncoder"> 160       * @throws NoSuchBeanDefinitionException if {@link #passwordEncoderBean} is null or not an instance of either ðŸ”µ</abbr></span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 161       */                                                                                                           </span>
<span class="-5680397040643859011" onmouseenter="enter('-5680397040643859011');" onmouseout="out('-5680397040643859011');" style=""> 162      @PostConstruct                                                                                                </span>
<span class="-9033819671974505465" onmouseenter="enter('-9033819671974505465');" onmouseout="out('-9033819671974505465');" style=""> 163      protected void setupPasswordEncoder() {                                                                       </span>
<span class="5660332138432044988" onmouseenter="enter('5660332138432044988');" onmouseout="out('5660332138432044988');" style=""> 164          passwordEncoderNew = null;                                                                                </span>
<span class="-655330175315724162" onmouseenter="enter('-655330175315724162');" onmouseout="out('-655330175315724162');" style=""> 165          passwordEncoder = null;                                                                                   </span>
<span class="-5456593704911205290" onmouseenter="enter('-5456593704911205290');" onmouseout="out('-5456593704911205290');" style=""> 166          if (passwordEncoderBean instanceof PasswordEncoder) {                                                     </span>
<span class="-3528230463178033621" onmouseenter="enter('-3528230463178033621');" onmouseout="out('-3528230463178033621');" style=""> 167              passwordEncoderNew = (PasswordEncoder) passwordEncoderBean;                                           </span>
<span class="4365730940590148824" onmouseenter="enter('4365730940590148824');" onmouseout="out('4365730940590148824');" style=""><abbr title=" 168          } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncoder) {"> 168          } else if (passwordEncoderBean instanceof org.springframework.security.authentication.encoding.PasswordEncðŸ”µ</abbr></span>
<span class="5435318175073096814" onmouseenter="enter('5435318175073096814');" onmouseout="out('5435318175073096814');" style=""><abbr title=" 169              passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncoderBean;"> 169              passwordEncoder = (org.springframework.security.authentication.encoding.PasswordEncoder) passwordEncodðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 170          } else {                                                                                                  </span>
<span class="-302697915557926133" onmouseenter="enter('-302697915557926133');" onmouseout="out('-302697915557926133');" style=""> 171              throw new NoSuchBeanDefinitionException(&quot;No PasswordEncoder bean is defined&quot;);                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173      }                                                                                                             </span>
<span  style=""> 174                                                                                                                    </span>
<span class="-7464048153853552761" onmouseenter="enter('-7464048153853552761');" onmouseout="out('-7464048153853552761');" style=""> 175      protected int getTokenExpiredMinutes() {                                                                      </span>
<span class="-2500044001911477981" onmouseenter="enter('-2500044001911477981');" onmouseout="out('-2500044001911477981');" style=""> 176          return BLCSystemProperty.resolveIntSystemProperty(&quot;tokenExpiredMinutes&quot;);                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177      }                                                                                                             </span>
<span  style=""> 178                                                                                                                    </span>
<span class="1558755609766654707" onmouseenter="enter('1558755609766654707');" onmouseout="out('1558755609766654707');" style=""> 179      protected String getResetPasswordURL() {                                                                      </span>
<span class="20463223533840587" onmouseenter="enter('20463223533840587');" onmouseout="out('20463223533840587');" style=""> 180          return BLCSystemProperty.resolveSystemProperty(&quot;resetPasswordURL&quot;);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181      }                                                                                                             </span>
<span  style=""> 182                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 183      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 184      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="6002452148139883097" onmouseenter="enter('6002452148139883097');" onmouseout="out('6002452148139883097');" style=""> 185      public void deleteAdminPermission(AdminPermission permission) {                                               </span>
<span class="-836036669979895769" onmouseenter="enter('-836036669979895769');" onmouseout="out('-836036669979895769');" style=""> 186          adminPermissionDao.deleteAdminPermission(permission);                                                     </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 187          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188      }                                                                                                             </span>
<span  style=""> 189                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 190      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 191      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2259817234586186008" onmouseenter="enter('2259817234586186008');" onmouseout="out('2259817234586186008');" style=""> 192      public void deleteAdminRole(AdminRole role) {                                                                 </span>
<span class="3564748768251237486" onmouseenter="enter('3564748768251237486');" onmouseout="out('3564748768251237486');" style=""> 193          adminRoleDao.deleteAdminRole(role);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 194          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 197      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 198      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5134347990884724003" onmouseenter="enter('-5134347990884724003');" onmouseout="out('-5134347990884724003');" style=""> 199      public void deleteAdminUser(AdminUser user) {                                                                 </span>
<span class="7394574297458352839" onmouseenter="enter('7394574297458352839');" onmouseout="out('7394574297458352839');" style=""> 200          adminUserDao.deleteAdminUser(user);                                                                       </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 201          clearAdminSecurityCache();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 202      }                                                                                                             </span>
<span  style=""> 203                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 204      @Override                                                                                                     </span>
<span class="2876732166932289600" onmouseenter="enter('2876732166932289600');" onmouseout="out('2876732166932289600');" style=""> 205      public AdminPermission readAdminPermissionById(Long id) {                                                     </span>
<span class="-7396373372513311285" onmouseenter="enter('-7396373372513311285');" onmouseout="out('-7396373372513311285');" style=""> 206          return adminPermissionDao.readAdminPermissionById(id);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207      }                                                                                                             </span>
<span  style=""> 208                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 209      @Override                                                                                                     </span>
<span class="-4891406139654812710" onmouseenter="enter('-4891406139654812710');" onmouseout="out('-4891406139654812710');" style=""> 210      public AdminRole readAdminRoleById(Long id) {                                                                 </span>
<span class="-4288599006427145516" onmouseenter="enter('-4288599006427145516');" onmouseout="out('-4288599006427145516');" style=""> 211          return adminRoleDao.readAdminRoleById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212      }                                                                                                             </span>
<span  style=""> 213                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 214      @Override                                                                                                     </span>
<span class="-6496089292823215471" onmouseenter="enter('-6496089292823215471');" onmouseout="out('-6496089292823215471');" style=""> 215      public AdminUser readAdminUserById(Long id) {                                                                 </span>
<span class="7261399603659183739" onmouseenter="enter('7261399603659183739');" onmouseout="out('7261399603659183739');" style=""> 216          return adminUserDao.readAdminUserById(id);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217      }                                                                                                             </span>
<span  style=""> 218                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 219      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 220      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-6500487620965710362" onmouseenter="enter('-6500487620965710362');" onmouseout="out('-6500487620965710362');" style=""> 221      public AdminPermission saveAdminPermission(AdminPermission permission) {                                      </span>
<span class="7732122916939007867" onmouseenter="enter('7732122916939007867');" onmouseout="out('7732122916939007867');" style=""> 222          permission = adminPermissionDao.saveAdminPermission(permission);                                          </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 223          clearAdminSecurityCache();                                                                                </span>
<span class="-1795112372474651525" onmouseenter="enter('-1795112372474651525');" onmouseout="out('-1795112372474651525');" style=""> 224          return permission;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 225      }                                                                                                             </span>
<span  style=""> 226                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 227      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 228      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-379846028640288315" onmouseenter="enter('-379846028640288315');" onmouseout="out('-379846028640288315');" style=""> 229      public AdminRole saveAdminRole(AdminRole role) {                                                              </span>
<span class="4267676691194941167" onmouseenter="enter('4267676691194941167');" onmouseout="out('4267676691194941167');" style=""> 230          role = adminRoleDao.saveAdminRole(role);                                                                  </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 231          clearAdminSecurityCache();                                                                                </span>
<span class="-928790189901997678" onmouseenter="enter('-928790189901997678');" onmouseout="out('-928790189901997678');" style=""> 232          return role;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 233      }                                                                                                             </span>
<span  style=""> 234                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 235      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 236      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5695794881039930215" onmouseenter="enter('-5695794881039930215');" onmouseout="out('-5695794881039930215');" style=""> 237      public AdminUser saveAdminUser(AdminUser user) {                                                              </span>
<span class="1352483133022340" onmouseenter="enter('1352483133022340');" onmouseout="out('1352483133022340');" style=""> 238          boolean encodePasswordNeeded = false;                                                                     </span>
<span class="-5887148214159456666" onmouseenter="enter('-5887148214159456666');" onmouseout="out('-5887148214159456666');" style=""> 239          String unencodedPassword = user.getUnencodedPassword();                                                   </span>
<span  style=""> 240                                                                                                                    </span>
<span class="768914961744338504" onmouseenter="enter('768914961744338504');" onmouseout="out('768914961744338504');" style=""> 241          if (user.getUnencodedPassword() != null) {                                                                </span>
<span class="-3339615096834726892" onmouseenter="enter('-3339615096834726892');" onmouseout="out('-3339615096834726892');" style=""> 242              encodePasswordNeeded = true;                                                                          </span>
<span class="-2542183457546489513" onmouseenter="enter('-2542183457546489513');" onmouseout="out('-2542183457546489513');" style=""> 243              user.setPassword(unencodedPassword);                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 244          }                                                                                                         </span>
<span  style=""> 245                                                                                                                    </span>
<span class="5171623643005293397" onmouseenter="enter('5171623643005293397');" onmouseout="out('5171623643005293397');" style=""> 246          // If no password is set, default to a secure password.                                                   </span>
<span class="-6552543170532253617" onmouseenter="enter('-6552543170532253617');" onmouseout="out('-6552543170532253617');" style=""> 247          if (user.getPassword() == null) {                                                                         </span>
<span class="-7598030564941334444" onmouseenter="enter('-7598030564941334444');" onmouseout="out('-7598030564941334444');" style=""> 248              user.setPassword(generateSecurePassword());                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 249          }                                                                                                         </span>
<span  style=""> 250                                                                                                                    </span>
<span class="-5546991018398889796" onmouseenter="enter('-5546991018398889796');" onmouseout="out('-5546991018398889796');" style=""> 251          AdminUser returnUser = adminUserDao.saveAdminUser(user);                                                  </span>
<span  style=""> 252                                                                                                                    </span>
<span class="8081333321322493" onmouseenter="enter('8081333321322493');" onmouseout="out('8081333321322493');" style=""> 253          if (encodePasswordNeeded) {                                                                               </span>
<span class="-833007171888717648" onmouseenter="enter('-833007171888717648');" onmouseout="out('-833007171888717648');" style=""> 254              returnUser.setPassword(encodePassword(unencodedPassword, getSalt(returnUser, unencodedPassword)));    </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255          }                                                                                                         </span>
<span  style=""> 256                                                                                                                    </span>
<span class="-4692526676361330947" onmouseenter="enter('-4692526676361330947');" onmouseout="out('-4692526676361330947');" style=""> 257          returnUser = adminUserDao.saveAdminUser(returnUser);                                                      </span>
<span class="-7308243043607284812" onmouseenter="enter('-7308243043607284812');" onmouseout="out('-7308243043607284812');" style=""> 258          clearAdminSecurityCache();                                                                                </span>
<span class="2085654163514393195" onmouseenter="enter('2085654163514393195');" onmouseout="out('2085654163514393195');" style=""> 259          return returnUser;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 260      }                                                                                                             </span>
<span  style=""> 261                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 262      @Override                                                                                                     </span>
<span class="2438008389439781940" onmouseenter="enter('2438008389439781940');" onmouseout="out('2438008389439781940');" style=""> 263      public void clearAdminSecurityCache() {                                                                       </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 264          if (LOG.isTraceEnabled()) {                                                                               </span>
<span class="5634633257360046688" onmouseenter="enter('5634633257360046688');" onmouseout="out('5634633257360046688');" style=""> 265              LOG.trace(&quot;Admin Security Cache DELETE&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266          }                                                                                                         </span>
<span class="3679497175350024241" onmouseenter="enter('3679497175350024241');" onmouseout="out('3679497175350024241');" style=""> 267          cache.removeAll();                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 268      }                                                                                                             </span>
<span  style=""> 269                                                                                                                    </span>
<span class="-137997900411835717" onmouseenter="enter('-137997900411835717');" onmouseout="out('-137997900411835717');" style=""> 270      protected String generateSecurePassword() {                                                                   </span>
<span class="-4630505355758837739" onmouseenter="enter('-4630505355758837739');" onmouseout="out('-4630505355758837739');" style=""> 271          return PasswordUtils.generateSecurePassword(FULL_PASSWORD_LENGTH);                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 272      }                                                                                                             </span>
<span  style=""> 273                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 274      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 275      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="2915310181219521321" onmouseenter="enter('2915310181219521321');" onmouseout="out('2915310181219521321');" style=""> 276      public AdminUser changePassword(PasswordChange passwordChange) {                                              </span>
<span class="2884656639819927588" onmouseenter="enter('2884656639819927588');" onmouseout="out('2884656639819927588');" style=""> 277          AdminUser user = readAdminUserByUserName(passwordChange.getUsername());                                   </span>
<span class="1884668291570275451" onmouseenter="enter('1884668291570275451');" onmouseout="out('1884668291570275451');" style=""> 278          user.setUnencodedPassword(passwordChange.getNewPassword());                                               </span>
<span class="5011076139981060" onmouseenter="enter('5011076139981060');" onmouseout="out('5011076139981060');" style=""> 279          user = saveAdminUser(user);                                                                               </span>
<span class="3653721778712492331" onmouseenter="enter('3653721778712492331');" onmouseout="out('3653721778712492331');" style=""> 280          Authentication auth = SecurityContextHolder.getContext().getAuthentication();                             </span>
<span class="467883154569136363" onmouseenter="enter('467883154569136363');" onmouseout="out('467883154569136363');" style=""><abbr title=" 281          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.getUsername(), passwordChange.getNewPassword(), auth.getAuthorities());"> 281          UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(passwordChange.gðŸ”µ</abbr></span>
<span class="-7660250707767616045" onmouseenter="enter('-7660250707767616045');" onmouseout="out('-7660250707767616045');" style=""> 282          SecurityContextHolder.getContext().setAuthentication(authRequest);                                        </span>
<span class="3717096975630690041" onmouseenter="enter('3717096975630690041');" onmouseout="out('3717096975630690041');" style=""> 283          auth.setAuthenticated(false);                                                                             </span>
<span class="3232563507135796529" onmouseenter="enter('3232563507135796529');" onmouseout="out('3232563507135796529');" style=""> 284          return user;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285      }                                                                                                             </span>
<span  style=""> 286                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 287      @Override                                                                                                     </span>
<span class="-4416135185028203365" onmouseenter="enter('-4416135185028203365');" onmouseout="out('-4416135185028203365');" style=""><abbr title=" 288      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 288      public boolean isUserQualifiedForOperationOnCeilingEntity(AdminUser adminUser, PermissionType permissionType, ðŸ”µ</abbr></span>
<span class="8194417038843189593" onmouseenter="enter('8194417038843189593');" onmouseout="out('8194417038843189593');" style=""> 289          Boolean response = null;                                                                                  </span>
<span class="-438169390329305990" onmouseenter="enter('-438169390329305990');" onmouseout="out('-438169390329305990');" style=""> 290          String cacheKey = buildCacheKey(adminUser, permissionType, ceilingEntityFullyQualifiedName);              </span>
<span class="8800985236379074455" onmouseenter="enter('8800985236379074455');" onmouseout="out('8800985236379074455');" style=""> 291          Element cacheElement = cache.get(cacheKey);                                                               </span>
<span  style=""> 292                                                                                                                    </span>
<span class="3455974125556451331" onmouseenter="enter('3455974125556451331');" onmouseout="out('3455974125556451331');" style=""> 293          if (cacheElement != null) {                                                                               </span>
<span class="-2369107400911604595" onmouseenter="enter('-2369107400911604595');" onmouseout="out('-2369107400911604595');" style=""> 294              response = (Boolean) cacheElement.getObjectValue();                                                   </span>
<span  style=""> 295                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 296              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="7249477910971818064" onmouseenter="enter('7249477910971818064');" onmouseout="out('7249477910971818064');" style=""> 297                  LOG.trace(&quot;Admin Security Cache GET For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299          }                                                                                                         </span>
<span  style=""> 300                                                                                                                    </span>
<span class="120466506035636969" onmouseenter="enter('120466506035636969');" onmouseout="out('120466506035636969');" style=""> 301          if (response == null) {                                                                                   </span>
<span class="7748088269923038539" onmouseenter="enter('7748088269923038539');" onmouseout="out('7748088269923038539');" style=""><abbr title=" 302              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceilingEntityFullyQualifiedName);"> 302              response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntity(adminUser, permissionType, ceðŸ”µ</abbr></span>
<span  style=""> 303                                                                                                                    </span>
<span class="4207494378623907057" onmouseenter="enter('4207494378623907057');" onmouseout="out('4207494378623907057');" style=""> 304              if (!response) {                                                                                      </span>
<span class="-3313663544117970313" onmouseenter="enter('-3313663544117970313');" onmouseout="out('-3313663544117970313');" style=""><abbr title=" 305                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilingEntityFullyQualifiedName);"> 305                  response = adminPermissionDao.isUserQualifiedForOperationOnCeilingEntityViaDefaultPermissions(ceilðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306              }                                                                                                     </span>
<span  style=""> 307                                                                                                                    </span>
<span class="-2010238951768206880" onmouseenter="enter('-2010238951768206880');" onmouseout="out('-2010238951768206880');" style=""> 308              cacheElement = new Element(cacheKey, response);                                                       </span>
<span class="-7435906473310623105" onmouseenter="enter('-7435906473310623105');" onmouseout="out('-7435906473310623105');" style=""> 309              cache.put(cacheElement);                                                                              </span>
<span  style=""> 310                                                                                                                    </span>
<span class="1446253227197554536" onmouseenter="enter('1446253227197554536');" onmouseout="out('1446253227197554536');" style=""> 311              if (LOG.isTraceEnabled()) {                                                                           </span>
<span class="-2058848422132422597" onmouseenter="enter('-2058848422132422597');" onmouseout="out('-2058848422132422597');" style=""> 312                  LOG.trace(&quot;Admin Security Cache PUT For: \&quot;&quot; + cacheKey + &quot;\&quot; = &quot; + response);                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314          }                                                                                                         </span>
<span  style=""> 315                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 316          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 317      }                                                                                                             </span>
<span  style=""> 318                                                                                                                    </span>
<span class="8480535886882957742" onmouseenter="enter('8480535886882957742');" onmouseout="out('8480535886882957742');" style=""><abbr title=" 319      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 319      protected String buildCacheKey(AdminUser adminUser, PermissionType permissionType, String ceilingEntityFullyQuðŸ”µ</abbr></span>
<span class="1530874609277631456" onmouseenter="enter('1530874609277631456');" onmouseout="out('1530874609277631456');" style=""> 320          return CACHE_KEY_PREFIX                                                                                   </span>
<span class="6061330923762874566" onmouseenter="enter('6061330923762874566');" onmouseout="out('6061330923762874566');" style=""> 321                 + &quot;user:&quot; + adminUser.getId() + &quot;,&quot;                                                                </span>
<span class="-1212825866363705613" onmouseenter="enter('-1212825866363705613');" onmouseout="out('-1212825866363705613');" style=""> 322                 + &quot;permType:&quot; + permissionType.getFriendlyType() + &quot;,&quot;                                             </span>
<span class="7637196071014663081" onmouseenter="enter('7637196071014663081');" onmouseout="out('7637196071014663081');" style=""> 323                 + &quot;ceiling:&quot; + ceilingEntityFullyQualifiedName;                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324      }                                                                                                             </span>
<span  style=""> 325                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 326      @Override                                                                                                     </span>
<span class="-4091736390204824634" onmouseenter="enter('-4091736390204824634');" onmouseout="out('-4091736390204824634');" style=""><abbr title=" 327      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualifiedName) {"> 327      public boolean doesOperationExistForCeilingEntity(PermissionType permissionType, String ceilingEntityFullyQualðŸ”µ</abbr></span>
<span class="8791868970355325747" onmouseenter="enter('8791868970355325747');" onmouseout="out('8791868970355325747');" style=""><abbr title=" 328          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedName);"> 328          return adminPermissionDao.doesOperationExistForCeilingEntity(permissionType, ceilingEntityFullyQualifiedNaðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329      }                                                                                                             </span>
<span  style=""> 330                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 331      @Override                                                                                                     </span>
<span class="3035678345813556674" onmouseenter="enter('3035678345813556674');" onmouseout="out('3035678345813556674');" style=""> 332      public AdminUser readAdminUserByUserName(String userName) {                                                   </span>
<span class="-5007559591834957914" onmouseenter="enter('-5007559591834957914');" onmouseout="out('-5007559591834957914');" style=""> 333          return adminUserDao.readAdminUserByUserName(userName);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334      }                                                                                                             </span>
<span  style=""> 335                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 336      @Override                                                                                                     </span>
<span class="2971656881994896064" onmouseenter="enter('2971656881994896064');" onmouseout="out('2971656881994896064');" style=""> 337      public List&lt;AdminUser&gt; readAdminUsersByEmail(String email) {                                                  </span>
<span class="2059776610700867482" onmouseenter="enter('2059776610700867482');" onmouseout="out('2059776610700867482');" style=""> 338          return adminUserDao.readAdminUserByEmail(email);                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339      }                                                                                                             </span>
<span  style=""> 340                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 341      @Override                                                                                                     </span>
<span class="9181233651451794115" onmouseenter="enter('9181233651451794115');" onmouseout="out('9181233651451794115');" style=""> 342      public List&lt;AdminUser&gt; readAllAdminUsers() {                                                                  </span>
<span class="-680128824690855741" onmouseenter="enter('-680128824690855741');" onmouseout="out('-680128824690855741');" style=""> 343          return adminUserDao.readAllAdminUsers();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 344      }                                                                                                             </span>
<span  style=""> 345                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 346      @Override                                                                                                     </span>
<span class="-852683282200494607" onmouseenter="enter('-852683282200494607');" onmouseout="out('-852683282200494607');" style=""> 347      public List&lt;AdminRole&gt; readAllAdminRoles() {                                                                  </span>
<span class="7077064002009526899" onmouseenter="enter('7077064002009526899');" onmouseout="out('7077064002009526899');" style=""> 348          return adminRoleDao.readAllAdminRoles();                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349      }                                                                                                             </span>
<span  style=""> 350                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 351      @Override                                                                                                     </span>
<span class="-5231553699627621367" onmouseenter="enter('-5231553699627621367');" onmouseout="out('-5231553699627621367');" style=""> 352      public List&lt;AdminPermission&gt; readAllAdminPermissions() {                                                      </span>
<span class="-6966703415999395764" onmouseenter="enter('-6966703415999395764');" onmouseout="out('-6966703415999395764');" style=""> 353          return adminPermissionDao.readAllAdminPermissions();                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354      }                                                                                                             </span>
<span  style=""> 355                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 356      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 357      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-5238259893338926366" onmouseenter="enter('-5238259893338926366');" onmouseout="out('-5238259893338926366');" style=""> 358      public GenericResponse sendForgotUsernameNotification(String emailAddress) {                                  </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 359          GenericResponse response = new GenericResponse();                                                         </span>
<span class="-3177565595880943933" onmouseenter="enter('-3177565595880943933');" onmouseout="out('-3177565595880943933');" style=""> 360          List&lt;AdminUser&gt; users = null;                                                                             </span>
<span class="-8702812354445074278" onmouseenter="enter('-8702812354445074278');" onmouseout="out('-8702812354445074278');" style=""> 361          if (emailAddress != null) {                                                                               </span>
<span class="-5927307319882617528" onmouseenter="enter('-5927307319882617528');" onmouseout="out('-5927307319882617528');" style=""> 362              users = adminUserDao.readAdminUserByEmail(emailAddress);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363          }                                                                                                         </span>
<span class="1348413323641637915" onmouseenter="enter('1348413323641637915');" onmouseout="out('1348413323641637915');" style=""> 364          if (CollectionUtils.isEmpty(users)) {                                                                     </span>
<span class="7242450034468345273" onmouseenter="enter('7242450034468345273');" onmouseout="out('7242450034468345273');" style=""> 365              response.addErrorCode(&quot;notFound&quot;);                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 366          } else {                                                                                                  </span>
<span class="-2763458366902467863" onmouseenter="enter('-2763458366902467863');" onmouseout="out('-2763458366902467863');" style=""> 367              List&lt;String&gt; activeUsernames = new ArrayList&lt;String&gt;();                                               </span>
<span class="504375398953239519" onmouseenter="enter('504375398953239519');" onmouseout="out('504375398953239519');" style=""> 368              for (AdminUser user : users) {                                                                        </span>
<span class="8102926718367948074" onmouseenter="enter('8102926718367948074');" onmouseout="out('8102926718367948074');" style=""> 369                  if (user.getActiveStatusFlag()) {                                                                 </span>
<span class="-4703391788383912495" onmouseenter="enter('-4703391788383912495');" onmouseout="out('-4703391788383912495');" style=""> 370                      activeUsernames.add(user.getLogin());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 371                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372              }                                                                                                     </span>
<span  style=""> 373                                                                                                                    </span>
<span class="7800996103103911618" onmouseenter="enter('7800996103103911618');" onmouseout="out('7800996103103911618');" style=""> 374              if (activeUsernames.size() &gt; 0) {                                                                     </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 375 -                HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                     </span>
<span class="-6918401081344831263" onmouseenter="enter('-6918401081344831263');" onmouseout="out('-6918401081344831263');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 376 -                vars.put(&quot;accountNames&quot;, activeUsernames);                                                        </span>
<span class="6798880421851252934" onmouseenter="enter('6798880421851252934');" onmouseout="out('6798880421851252934');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 377 -                emailService.sendTemplateEmail(emailAddress, getSendUsernameEmailInfo(), vars);                   </span>
<span class="-30352865974864371" onmouseenter="enter('-30352865974864371');" onmouseout="out('-30352865974864371');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 378 +                eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernames));"> 378 +                eventPublisher.publishEvent(new AdminForgotUsernameEvent(this, emailAddress, null, activeUsernamesðŸ”µ</abbr></span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 379              } else {                                                                                              </span>
<span class="3603576439991328525" onmouseenter="enter('3603576439991328525');" onmouseout="out('3603576439991328525');" style=""> 380                  // send inactive username found email.                                                            </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 381                  response.addErrorCode(&quot;inactiveUser&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 384          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 385      }                                                                                                             </span>
<span  style=""> 386                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 387      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 388      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-9033062334445922012" onmouseenter="enter('-9033062334445922012');" onmouseout="out('-9033062334445922012');" style=""> 389      public GenericResponse sendResetPasswordNotification(String username) {                                       </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 390          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 391          AdminUser user = null;                                                                                    </span>
<span  style=""> 392                                                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 393          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 394              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395          }                                                                                                         </span>
<span  style=""> 396                                                                                                                    </span>
<span class="7756458508104870118" onmouseenter="enter('7756458508104870118');" onmouseout="out('7756458508104870118');" style=""> 397          checkUser(user,response);                                                                                 </span>
<span  style=""> 398                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 399          if (! response.getHasErrors()) {                                                                          </span>
<span class="3137669876469747012" onmouseenter="enter('3137669876469747012');" onmouseout="out('3137669876469747012');" style=""> 400              String token = PasswordUtils.generateSecurePassword(TEMP_PASSWORD_LENGTH);                            </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 401              token = token.toLowerCase();                                                                          </span>
<span  style=""> 402                                                                                                                    </span>
<span class="-6005488429360027180" onmouseenter="enter('-6005488429360027180');" onmouseout="out('-6005488429360027180');" style=""> 403              ForgotPasswordSecurityToken fpst = new ForgotPasswordSecurityTokenImpl();                             </span>
<span class="7308939319458602875" onmouseenter="enter('7308939319458602875');" onmouseout="out('7308939319458602875');" style=""> 404              fpst.setAdminUserId(user.getId());                                                                    </span>
<span class="60202731123204779" onmouseenter="enter('60202731123204779');" onmouseout="out('60202731123204779');" style=""> 405              fpst.setToken(encodePassword(token, null));                                                           </span>

<span class="118078353989050088" onmouseenter="enter('118078353989050088');" onmouseout="out('118078353989050088');" style=""> 406              fpst.setCreateDate(SystemTime.asDate());                                                              </span>
<span class="-7638438841138052323" onmouseenter="enter('-7638438841138052323');" onmouseout="out('-7638438841138052323');" style=""> 407              forgotPasswordSecurityTokenDao.saveToken(fpst);                                                       </span>
<span  style=""> 408                                                                                                                    </span>
<span class="8884608966566249698" onmouseenter="enter('8884608966566249698');" onmouseout="out('8884608966566249698');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 409 -            HashMap&lt;String, Object&gt; vars = new HashMap&lt;String, Object&gt;();                                         </span>
<span class="-7576751007074497786" onmouseenter="enter('-7576751007074497786');" onmouseout="out('-7576751007074497786');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 410 -            vars.put(&quot;token&quot;, token);                                                                             </span>
<span class="-7527705945971207987" onmouseenter="enter('-7527705945971207987');" onmouseout="out('-7527705945971207987');" style=""> 411              String resetPasswordUrl = getResetPasswordURL();                                                      </span>
<span class="7676904455881888218" onmouseenter="enter('7676904455881888218');" onmouseout="out('7676904455881888218');" style=""> 412              if (!StringUtils.isEmpty(resetPasswordUrl)) {                                                         </span>
<span class="-504875606182491340" onmouseenter="enter('-504875606182491340');" onmouseout="out('-504875606182491340');" style=""> 413                  if (resetPasswordUrl.contains(&quot;?&quot;)) {                                                             </span>
<span class="-4702632295011526397" onmouseenter="enter('-4702632295011526397');" onmouseout="out('-4702632295011526397');" style=""> 414                      resetPasswordUrl=resetPasswordUrl+&quot;&amp;token=&quot;+token;                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 415                  } else {                                                                                          </span>
<span class="5395118818759586118" onmouseenter="enter('5395118818759586118');" onmouseout="out('5395118818759586118');" style=""> 416                      resetPasswordUrl=resetPasswordUrl+&quot;?token=&quot;+token;                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418              }                                                                                                     </span>
<span class="3935125112670028800" onmouseenter="enter('3935125112670028800');" onmouseout="out('3935125112670028800');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 419 -            vars.put(&quot;resetPasswordUrl&quot;, resetPasswordUrl);                                                       </span>
<span class="-423159219098060669" onmouseenter="enter('-423159219098060669');" onmouseout="out('-423159219098060669');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 420 -            emailService.sendTemplateEmail(user.getEmail(), getResetPasswordEmailInfo(), vars);                   </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 421 -                                                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 422 +                                                                                                                  </span>
<span class="-4570318612899268684" onmouseenter="enter('-4570318612899268684');" onmouseout="out('-4570318612899268684');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 423 +            eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl));"> 423 +            eventPublisher.publishEvent(new AdminForgotPasswordEvent(this, user.getId(), token, resetPasswordUrl))ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424          }                                                                                                         </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 425          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426      }                                                                                                             </span>
<span  style=""> 427                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 428      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 429      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-1553234826628367049" onmouseenter="enter('-1553234826628367049');" onmouseout="out('-1553234826628367049');" style=""><abbr title=" 430      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPassword) {"> 430      public GenericResponse resetPasswordUsingToken(String username, String token, String password, String confirmPðŸ”µ</abbr></span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 431          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 432          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 433          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 434              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 436          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 437          checkPassword(password, confirmPassword, response);                                                       </span>
<span class="-4169390037463393090" onmouseenter="enter('-4169390037463393090');" onmouseout="out('-4169390037463393090');" style=""> 438          if (StringUtils.isBlank(token)) {                                                                         </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 439              response.addErrorCode(&quot;invalidToken&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 440          }                                                                                                         </span>
<span  style=""> 441                                                                                                                    </span>
<span class="5801226395750103004" onmouseenter="enter('5801226395750103004');" onmouseout="out('5801226395750103004');" style=""> 442          ForgotPasswordSecurityToken fpst = null;                                                                  </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 443          if (! response.getHasErrors()) {                                                                          </span>
<span class="5927756983469236234" onmouseenter="enter('5927756983469236234');" onmouseout="out('5927756983469236234');" style=""> 444              token = token.toLowerCase();                                                                          </span>
<span class="-8444712097980049025" onmouseenter="enter('-8444712097980049025');" onmouseout="out('-8444712097980049025');" style=""><abbr title=" 445              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 445              List&lt;ForgotPasswordSecurityToken&gt; fpstoks = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserðŸ”µ</abbr></span>
<span class="5811622849753627225" onmouseenter="enter('5811622849753627225');" onmouseout="out('5811622849753627225');" style=""> 446              for (ForgotPasswordSecurityToken fpstok : fpstoks) {                                                  </span>
<span class="2480256277509042876" onmouseenter="enter('2480256277509042876');" onmouseout="out('2480256277509042876');" style=""> 447                  if (isPasswordValid(fpstok.getToken(), token, null)) {                                            </span>

<span class="-8696697531199533964" onmouseenter="enter('-8696697531199533964');" onmouseout="out('-8696697531199533964');" style=""> 448                      fpst = fpstok;                                                                                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 449                      break;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 451              }                                                                                                     </span>
<span class="-1673544419969423705" onmouseenter="enter('-1673544419969423705');" onmouseout="out('-1673544419969423705');" style=""> 452              if (fpst == null) {                                                                                   </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 453                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1851754756462568438" onmouseenter="enter('-1851754756462568438');" onmouseout="out('-1851754756462568438');" style=""> 454              } else if (fpst.isTokenUsedFlag()) {                                                                  </span>
<span class="-4571187449058469389" onmouseenter="enter('-4571187449058469389');" onmouseout="out('-4571187449058469389');" style=""> 455                  response.addErrorCode(&quot;tokenUsed&quot;);                                                               </span>
<span class="1126518180689710158" onmouseenter="enter('1126518180689710158');" onmouseout="out('1126518180689710158');" style=""> 456              } else if (isTokenExpired(fpst)) {                                                                    </span>
<span class="1324239895302259913" onmouseenter="enter('1324239895302259913');" onmouseout="out('1324239895302259913');" style=""> 457                  response.addErrorCode(&quot;tokenExpired&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 458              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459          }                                                                                                         </span>
<span  style=""> 460                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 461          if (! response.getHasErrors()) {                                                                          </span>
<span class="2923440711342611927" onmouseenter="enter('2923440711342611927');" onmouseout="out('2923440711342611927');" style=""> 462              if (! user.getId().equals(fpst.getAdminUserId())) {                                                   </span>
<span class="-5994256316510103080" onmouseenter="enter('-5994256316510103080');" onmouseout="out('-5994256316510103080');" style=""> 463                  if (LOG.isWarnEnabled()) {                                                                        </span>
<span class="-7662906789147909908" onmouseenter="enter('-7662906789147909908');" onmouseout="out('-7662906789147909908');" style=""><abbr title=" 464                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; + StringUtil.sanitize(token));"> 464                      LOG.warn(&quot;Password reset attempt tried with mismatched user and token &quot; + user.getId() + &quot;, &quot; ðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465                  }                                                                                                 </span>
<span class="-5065394993479210526" onmouseenter="enter('-5065394993479210526');" onmouseout="out('-5065394993479210526');" style=""> 466                  response.addErrorCode(&quot;invalidToken&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 467              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468          }                                                                                                         </span>
<span  style=""> 469                                                                                                                    </span>
<span class="-1250065807676287207" onmouseenter="enter('-1250065807676287207');" onmouseout="out('-1250065807676287207');" style=""> 470          if (! response.getHasErrors()) {                                                                          </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 471              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 472              saveAdminUser(user);                                                                                  </span>
<span class="2788705225119964752" onmouseenter="enter('2788705225119964752');" onmouseout="out('2788705225119964752');" style=""> 473              invalidateAllTokensForAdminUser(user);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474          }                                                                                                         </span>
<span  style=""> 475                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 476          return response;                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 477      }                                                                                                             </span>
<span  style=""> 478                                                                                                                    </span>
<span class="-8683151838866790539" onmouseenter="enter('-8683151838866790539');" onmouseout="out('-8683151838866790539');" style=""> 479      protected void invalidateAllTokensForAdminUser(AdminUser user) {                                              </span>
<span class="-2447349951797822174" onmouseenter="enter('-2447349951797822174');" onmouseout="out('-2447349951797822174');" style=""><abbr title=" 480          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(user.getId());"> 480          List&lt;ForgotPasswordSecurityToken&gt; tokens = forgotPasswordSecurityTokenDao.readUnusedTokensByAdminUserId(usðŸ”µ</abbr></span>
<span class="1745526185987355768" onmouseenter="enter('1745526185987355768');" onmouseout="out('1745526185987355768');" style=""> 481          for (ForgotPasswordSecurityToken token : tokens) {                                                        </span>
<span class="-3707452475519083600" onmouseenter="enter('-3707452475519083600');" onmouseout="out('-3707452475519083600');" style=""> 482              token.setTokenUsedFlag(true);                                                                         </span>
<span class="2781665899405012392" onmouseenter="enter('2781665899405012392');" onmouseout="out('2781665899405012392');" style=""> 483              forgotPasswordSecurityTokenDao.saveToken(token);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 484          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 485      }                                                                                                             </span>
<span  style=""> 486                                                                                                                    </span>
<span class="-6062498662352786638" onmouseenter="enter('-6062498662352786638');" onmouseout="out('-6062498662352786638');" style=""> 487      protected void checkUser(AdminUser user, GenericResponse response) {                                          </span>
<span class="-8165495754761689871" onmouseenter="enter('-8165495754761689871');" onmouseout="out('-8165495754761689871');" style=""> 488          if (user == null) {                                                                                       </span>
<span class="-2614459049713367355" onmouseenter="enter('-2614459049713367355');" onmouseout="out('-2614459049713367355');" style=""> 489              response.addErrorCode(&quot;invalidUser&quot;);                                                                 </span>
<span class="-2526365339750767904" onmouseenter="enter('-2526365339750767904');" onmouseout="out('-2526365339750767904');" style=""> 490          } else if (StringUtils.isBlank(user.getEmail())) {                                                        </span>
<span class="3641519375839212970" onmouseenter="enter('3641519375839212970');" onmouseout="out('3641519375839212970');" style=""> 491              response.addErrorCode(&quot;emailNotFound&quot;);                                                               </span>
<span class="6758811634644646038" onmouseenter="enter('6758811634644646038');" onmouseout="out('6758811634644646038');" style=""> 492          } else if (BooleanUtils.isNotTrue(user.getActiveStatusFlag())) {                                          </span>
<span class="5510537362121156528" onmouseenter="enter('5510537362121156528');" onmouseout="out('5510537362121156528');" style=""> 493              response.addErrorCode(&quot;inactiveUser&quot;);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 494          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 495      }                                                                                                             </span>
<span  style=""> 496                                                                                                                    </span>
<span class="-3281949438797137351" onmouseenter="enter('-3281949438797137351');" onmouseout="out('-3281949438797137351');" style=""> 497      protected void checkPassword(String password, String confirmPassword, GenericResponse response) {             </span>
<span class="2256032458684464296" onmouseenter="enter('2256032458684464296');" onmouseout="out('2256032458684464296');" style=""> 498          if (StringUtils.isBlank(password) || StringUtils.isBlank(confirmPassword)) {                              </span>
<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 499              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="5444167475313383383" onmouseenter="enter('5444167475313383383');" onmouseout="out('5444167475313383383');" style=""> 500          } else if (! password.equals(confirmPassword)) {                                                          </span>
<span class="-5929993345093092025" onmouseenter="enter('-5929993345093092025');" onmouseout="out('-5929993345093092025');" style=""> 501              response.addErrorCode(&quot;passwordMismatch&quot;);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 502          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 503      }                                                                                                             </span>
<span  style=""> 504                                                                                                                    </span>
<span class="450911706794908828" onmouseenter="enter('450911706794908828');" onmouseout="out('450911706794908828');" style=""> 505      protected void checkExistingPassword(String unencodedPassword, AdminUser user, GenericResponse response) {    </span>
<span class="3606634173628978484" onmouseenter="enter('3606634173628978484');" onmouseout="out('3606634173628978484');" style=""> 506          if (!isPasswordValid(user.getPassword(), unencodedPassword, getSalt(user, unencodedPassword))) {          </span>

<span class="5492480053199382271" onmouseenter="enter('5492480053199382271');" onmouseout="out('5492480053199382271');" style=""> 507              response.addErrorCode(&quot;invalidPassword&quot;);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 508          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 509      }                                                                                                             </span>
<span  style=""> 510                                                                                                                    </span>
<span class="762008802926387659" onmouseenter="enter('762008802926387659');" onmouseout="out('762008802926387659');" style=""> 511      protected boolean isTokenExpired(ForgotPasswordSecurityToken fpst) {                                          </span>
<span class="7457175319484101734" onmouseenter="enter('7457175319484101734');" onmouseout="out('7457175319484101734');" style=""> 512          Date now = SystemTime.asDate();                                                                           </span>
<span class="4814679658448270347" onmouseenter="enter('4814679658448270347');" onmouseout="out('4814679658448270347');" style=""> 513          long currentTimeInMillis = now.getTime();                                                                 </span>
<span class="2086457980523585614" onmouseenter="enter('2086457980523585614');" onmouseout="out('2086457980523585614');" style=""> 514          long tokenSaveTimeInMillis = fpst.getCreateDate().getTime();                                              </span>
<span class="447475646174830674" onmouseenter="enter('447475646174830674');" onmouseout="out('447475646174830674');" style=""> 515          long minutesSinceSave = (currentTimeInMillis - tokenSaveTimeInMillis)/60000;                              </span>
<span class="-6950327259506641142" onmouseenter="enter('-6950327259506641142');" onmouseout="out('-6950327259506641142');" style=""> 516          return minutesSinceSave &gt; getTokenExpiredMinutes();                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 517      }                                                                                                             </span>
<span  style=""> 518                                                                                                                    </span>
<span class="-3132950817106762657" onmouseenter="enter('-3132950817106762657');" onmouseout="out('-3132950817106762657');" style=""> 519      public static int getPASSWORD_TOKEN_LENGTH() {                                                                </span>
<span class="-6019969436583508621" onmouseenter="enter('-6019969436583508621');" onmouseout="out('-6019969436583508621');" style=""> 520          return TEMP_PASSWORD_LENGTH;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 521      }                                                                                                             </span>
<span  style=""> 522                                                                                                                    </span>
<span class="-5534321215610098066" onmouseenter="enter('-5534321215610098066');" onmouseout="out('-5534321215610098066');" style=""> 523      public static void setPASSWORD_TOKEN_LENGTH(int PASSWORD_TOKEN_LENGTH) {                                      </span>
<span class="-3713663885766178257" onmouseenter="enter('-3713663885766178257');" onmouseout="out('-3713663885766178257');" style=""> 524          AdminSecurityServiceImpl.TEMP_PASSWORD_LENGTH = PASSWORD_TOKEN_LENGTH;                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 525      }                                                                                                             </span>
<span  style=""> 526                                                                                                                    </span>
<span class="2364967818882917936" onmouseenter="enter('2364967818882917936');" onmouseout="out('2364967818882917936');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 527 -    public EmailInfo getSendUsernameEmailInfo() {                                                                 </span>
<span class="6645334365653770348" onmouseenter="enter('6645334365653770348');" onmouseout="out('6645334365653770348');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 528 -        return sendUsernameEmailInfo;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 529 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 530 -                                                                                                                  </span>
<span class="4459691850656241995" onmouseenter="enter('4459691850656241995');" onmouseout="out('4459691850656241995');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 531 -    public void setSendUsernameEmailInfo(EmailInfo sendUsernameEmailInfo) {                                       </span>
<span class="-4517177369776391158" onmouseenter="enter('-4517177369776391158');" onmouseout="out('-4517177369776391158');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 532 -        this.sendUsernameEmailInfo = sendUsernameEmailInfo;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 533 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 534 -                                                                                                                  </span>
<span class="-6812272375671871385" onmouseenter="enter('-6812272375671871385');" onmouseout="out('-6812272375671871385');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 535 -    public EmailInfo getResetPasswordEmailInfo() {                                                                </span>
<span class="-4739592575564292235" onmouseenter="enter('-4739592575564292235');" onmouseout="out('-4739592575564292235');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 536 -        return resetPasswordEmailInfo;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 537 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 538 -                                                                                                                  </span>
<span class="3739801032433810556" onmouseenter="enter('3739801032433810556');" onmouseout="out('3739801032433810556');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 539 -    public void setResetPasswordEmailInfo(EmailInfo resetPasswordEmailInfo) {                                     </span>
<span class="-4035605552677826201" onmouseenter="enter('-4035605552677826201');" onmouseout="out('-4035605552677826201');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 540 -        this.resetPasswordEmailInfo = resetPasswordEmailInfo;                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 541 -    }                                                                                                             </span>
<span  style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 542 -                                                                                                                  </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 543      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 544      @Override                                                                                                     </span>
<span class="-4591258778459607078" onmouseenter="enter('-4591258778459607078');" onmouseout="out('-4591258778459607078');" style=""> 545      public Object getSalt(AdminUser user, String unencodedPassword) {                                             </span>
<span class="-7916743778127639214" onmouseenter="enter('-7916743778127639214');" onmouseout="out('-7916743778127639214');" style=""> 546          Object salt = null;                                                                                       </span>
<span class="-468758031613970186" onmouseenter="enter('-468758031613970186');" onmouseout="out('-468758031613970186');" style=""> 547          if (saltSource != null) {                                                                                 </span>
<span class="7546791339615675361" onmouseenter="enter('7546791339615675361');" onmouseout="out('7546791339615675361');" style=""><abbr title=" 548              salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new ArrayList&lt;GrantedAuthority&gt;()));"> 548              salt = saltSource.getSalt(new AdminUserDetails(user.getId(), user.getLogin(), unencodedPassword, new AðŸ”µ</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 549          }                                                                                                         </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style=""> 550          return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 551      }                                                                                                             </span>
<span  style=""> 552                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 553      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 554      @Override                                                                                                     </span>
<span class="5378385800373988521" onmouseenter="enter('5378385800373988521');" onmouseout="out('5378385800373988521');" style=""> 555      public String getSalt() {                                                                                     </span>
<span class="3431775854604648548" onmouseenter="enter('3431775854604648548');" onmouseout="out('3431775854604648548');" style=""> 556          return salt;                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 557      }                                                                                                             </span>
<span  style=""> 558                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 559      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 560      @Override                                                                                                     </span>
<span class="-4361425533599957857" onmouseenter="enter('-4361425533599957857');" onmouseout="out('-4361425533599957857');" style=""> 561      public void setSalt(String salt) {                                                                            </span>
<span class="-4513734365927734086" onmouseenter="enter('-4513734365927734086');" onmouseout="out('-4513734365927734086');" style=""> 562          this.salt = salt;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 563      }                                                                                                             </span>
<span  style=""> 564                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 565      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 566      @Override                                                                                                     </span>
<span class="-7604283301279549906" onmouseenter="enter('-7604283301279549906');" onmouseout="out('-7604283301279549906');" style=""> 567      public SaltSource getSaltSource() {                                                                           </span>
<span class="-904082433474924859" onmouseenter="enter('-904082433474924859');" onmouseout="out('-904082433474924859');" style=""> 568          return saltSource;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 569      }                                                                                                             </span>
<span  style=""> 570                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 571      @Deprecated                                                                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 572      @Override                                                                                                     </span>
<span class="4344683956985852323" onmouseenter="enter('4344683956985852323');" onmouseout="out('4344683956985852323');" style=""> 573      public void setSaltSource(SaltSource saltSource) {                                                            </span>
<span class="-2983665589785658662" onmouseenter="enter('-2983665589785658662');" onmouseout="out('-2983665589785658662');" style=""> 574          this.saltSource = saltSource;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 575      }                                                                                                             </span>
<span  style=""> 576                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 577      @Override                                                                                                     </span>
<span class="5049387329381023556" onmouseenter="enter('5049387329381023556');" onmouseout="out('5049387329381023556');" style=""> 578      @Transactional(&quot;blTransactionManager&quot;)                                                                        </span>
<span class="-8557181821730052422" onmouseenter="enter('-8557181821730052422');" onmouseout="out('-8557181821730052422');" style=""> 579      public GenericResponse changePassword(String username,                                                        </span>
<span class="1616591629246815842" onmouseenter="enter('1616591629246815842');" onmouseout="out('1616591629246815842');" style=""> 580              String oldPassword, String password, String confirmPassword) {                                        </span>
<span class="-3323142898826342497" onmouseenter="enter('-3323142898826342497');" onmouseout="out('-3323142898826342497');" style=""> 581          GenericResponse response = new GenericResponse();                                                         </span>
<span class="6466303102269495776" onmouseenter="enter('6466303102269495776');" onmouseout="out('6466303102269495776');" style=""> 582          AdminUser user = null;                                                                                    </span>
<span class="-8284276918575957483" onmouseenter="enter('-8284276918575957483');" onmouseout="out('-8284276918575957483');" style=""> 583          if (username != null) {                                                                                   </span>
<span class="4179992809603478727" onmouseenter="enter('4179992809603478727');" onmouseout="out('4179992809603478727');" style=""> 584              user = adminUserDao.readAdminUserByUserName(username);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 585          }                                                                                                         </span>
<span class="2246929931473077321" onmouseenter="enter('2246929931473077321');" onmouseout="out('2246929931473077321');" style=""> 586          checkUser(user, response);                                                                                </span>
<span class="-3971600249312835278" onmouseenter="enter('-3971600249312835278');" onmouseout="out('-3971600249312835278');" style=""> 587          checkPassword(password, confirmPassword, response);                                                       </span>
<span  style=""> 588                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 589          if (!response.getHasErrors()) {                                                                           </span>
<span class="-4918188860728930614" onmouseenter="enter('-4918188860728930614');" onmouseout="out('-4918188860728930614');" style=""> 590              checkExistingPassword(oldPassword, user, response);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 591          }                                                                                                         </span>
<span  style=""> 592                                                                                                                    </span>
<span class="6662915930169218498" onmouseenter="enter('6662915930169218498');" onmouseout="out('6662915930169218498');" style=""> 593          if (!response.getHasErrors()) {                                                                           </span>
<span class="6398512100914115260" onmouseenter="enter('6398512100914115260');" onmouseout="out('6398512100914115260');" style=""> 594              user.setUnencodedPassword(password);                                                                  </span>
<span class="1142597077947924544" onmouseenter="enter('1142597077947924544');" onmouseout="out('1142597077947924544');" style=""> 595              saveAdminUser(user);                                                                                  </span>
<span  style=""> 596                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 597          }                                                                                                         </span>
<span  style=""> 598                                                                                                                    </span>
<span class="-1838489616061912436" onmouseenter="enter('-1838489616061912436');" onmouseout="out('-1838489616061912436');" style=""> 599          return response;                                                                                          </span>
<span  style=""> 600                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 601      }                                                                                                             </span>
<span  style=""> 602                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 603      /**                                                                                                           </span>
<span class="617564998012810029" onmouseenter="enter('617564998012810029');" onmouseout="out('617564998012810029');" style=""> 604       * Determines if a password is valid by comparing it to the encoded string, optionally using a salt.          </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 605       * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style=""><abbr title=" 606       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 606       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style=""><abbr title=" 607       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 607       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style=""><abbr title=" 608       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 608       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style=""><abbr title=" 609       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 609       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style=""><abbr title=" 610       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 610       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 611       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 612       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 613       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 614       * @param encodedPassword the encoded password                                                                </span>
<span class="-6973500330076487399" onmouseenter="enter('-6973500330076487399');" onmouseout="out('-6973500330076487399');" style=""> 615       * @param rawPassword the unencoded password                                                                  </span>
<span class="-185203437196014156" onmouseenter="enter('-185203437196014156');" onmouseout="out('-185203437196014156');" style=""> 616       * @param salt the optional salt                                                                              </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 617       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 618       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 619      @Deprecated                                                                                                   </span>
<span class="4647120131289693276" onmouseenter="enter('4647120131289693276');" onmouseout="out('4647120131289693276');" style=""> 620      protected boolean isPasswordValid(String encodedPassword, String rawPassword, Object salt) {                  </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style=""> 621          if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="-6959686797048566137" onmouseenter="enter('-6959686797048566137');" onmouseout="out('-6959686797048566137');" style=""> 622              return passwordEncoder.isPasswordValid(encodedPassword, rawPassword, salt);                           </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 623          } else {                                                                                                  </span>
<span class="-3936958825863998907" onmouseenter="enter('-3936958825863998907');" onmouseout="out('-3936958825863998907');" style=""> 624              return isPasswordValid(encodedPassword, rawPassword);                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 625          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 626      }                                                                                                             </span>
<span  style=""> 627                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 628      /**                                                                                                           </span>
<span class="-7402444345141522088" onmouseenter="enter('-7402444345141522088');" onmouseout="out('-7402444345141522088');" style=""><abbr title=" 629       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to the {@link PasswordEncoder}."> 629       * Determines if a password is valid by comparing it to the encoded string, salting is handled internally to tðŸ”µ</abbr></span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 630       * &lt;p&gt;                                                                                                        </span>
<span class="3631895464743803398" onmouseenter="enter('3631895464743803398');" onmouseout="out('3631895464743803398');" style=""><abbr title=" 631       * This method must always be called to verify if a password is valid after the original encoded password is generated"> 631       * This method must always be called to verify if a password is valid after the original encoded password is gðŸ”µ</abbr></span>
<span class="4876872302460773002" onmouseenter="enter('4876872302460773002');" onmouseout="out('4876872302460773002');" style=""><abbr title=" 632       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hash."> 632       * due to {@link PasswordEncoder} randomly generating salts internally and appending them to the resulting hasðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 633       *                                                                                                            </span>
<span class="-1092305253055154538" onmouseenter="enter('-1092305253055154538');" onmouseout="out('-1092305253055154538');" style=""> 634       * @param encodedPassword the encoded password                                                                </span>
<span class="2924019506572524074" onmouseenter="enter('2924019506572524074');" onmouseout="out('2924019506572524074');" style=""> 635       * @param rawPassword the raw password to check against the encoded password                                  </span>
<span class="2673757475826170918" onmouseenter="enter('2673757475826170918');" onmouseout="out('2673757475826170918');" style=""> 636       * @return true if rawPassword matches the encodedPassword, false otherwise                                   </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 637       */                                                                                                           </span>
<span class="-6826592066355303028" onmouseenter="enter('-6826592066355303028');" onmouseout="out('-6826592066355303028');" style=""> 638      protected boolean isPasswordValid(String encodedPassword, String rawPassword) {                               </span>
<span class="-3105924845719344527" onmouseenter="enter('-3105924845719344527');" onmouseout="out('-3105924845719344527');" style=""> 639          return passwordEncoderNew.matches(rawPassword, encodedPassword);                                          </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 640      }                                                                                                             </span>
<span  style=""> 641                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 642      /**                                                                                                           </span>
<span class="4257659912216426455" onmouseenter="enter('4257659912216426455');" onmouseout="out('4257659912216426455');" style=""> 643       * Generate an encoded password from a raw password, optionally using a salt.                                 </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 644       * &lt;p&gt;                                                                                                        </span>
<span class="8238547058305820967" onmouseenter="enter('8238547058305820967');" onmouseout="out('8238547058305820967');" style=""><abbr title=" 645       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder} support is"> 645       * The externally salted {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEðŸ”µ</abbr></span>
<span class="4204579750675551500" onmouseenter="enter('4204579750675551500');" onmouseout="out('4204579750675551500');" style=""><abbr title=" 646       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing algorithms such as bcrypt."> 646       * being deprecated, following in Spring Security&#x27;s footsteps, in order to move towards self salting hashing aðŸ”µ</abbr></span>
<span class="-3306783932389532125" onmouseenter="enter('-3306783932389532125');" onmouseout="out('-3306783932389532125');" style=""><abbr title=" 647       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect against rainbow table attacks"> 647       * Bcrypt is a superior hashing algorithm that randomly generates a salt per password in order to protect agaiðŸ”µ</abbr></span>
<span class="4003784395938333273" onmouseenter="enter('4003784395938333273');" onmouseout="out('4003784395938333273');" style=""><abbr title=" 648       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed passwords."> 648       * and is an intentionally expensive algorithm to further guard against brute force attempts to crack hashed pðŸ”µ</abbr></span>
<span class="-2099671646517936735" onmouseenter="enter('-2099671646517936735');" onmouseout="out('-2099671646517936735');" style=""><abbr title=" 649       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependencies such as {@link SaltSource}."> 649       * Additionally, having the encoding algorithm handle the salt internally reduces code complexity and dependenðŸ”µ</abbr></span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 650       *                                                                                                            </span>
<span class="-6749030359408285657" onmouseenter="enter('-6749030359408285657');" onmouseout="out('-6749030359408285657');" style=""> 651       * @deprecated the new {@link PasswordEncoder} handles salting internally, this will be removed in 4.2        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 652       *                                                                                                            </span>
<span class="2080997932325010713" onmouseenter="enter('2080997932325010713');" onmouseout="out('2080997932325010713');" style=""> 653       * @param rawPassword                                                                                         </span>
<span class="7878013986113858006" onmouseenter="enter('7878013986113858006');" onmouseout="out('7878013986113858006');" style=""> 654       * @param salt                                                                                                </span>
<span class="-9165797340485297481" onmouseenter="enter('-9165797340485297481');" onmouseout="out('-9165797340485297481');" style=""> 655       * @return                                                                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 656       */                                                                                                           </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 657      @Deprecated                                                                                                   </span>
<span class="-8747290197521765557" onmouseenter="enter('-8747290197521765557');" onmouseout="out('-8747290197521765557');" style=""> 658      protected String encodePassword(String rawPassword, Object salt) {                                            </span>
<span class="-7232422938046234962" onmouseenter="enter('-7232422938046234962');" onmouseout="out('-7232422938046234962');" style=""> 659          if (usingDeprecatedPasswordEncoder()) {                                                                   </span>
<span class="5931714538865276294" onmouseenter="enter('5931714538865276294');" onmouseout="out('5931714538865276294');" style=""> 660              return passwordEncoder.encodePassword(rawPassword, salt);                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 661          } else {                                                                                                  </span>
<span class="-7923712831729422017" onmouseenter="enter('-7923712831729422017');" onmouseout="out('-7923712831729422017');" style=""> 662              return encodePassword(rawPassword);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 663          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 664      }                                                                                                             </span>
<span  style=""> 665                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 666      /**                                                                                                           </span>
<span class="9021357431410177573" onmouseenter="enter('9021357431410177573');" onmouseout="out('9021357431410177573');" style=""><abbr title=" 667       * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncoder}."> 667       * Generate an encoded password from a raw password, salting is handled internally to the {@link PasswordEncodðŸ”µ</abbr></span>

<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 668       * &lt;p&gt;                                                                                                        </span>
<span class="1270276550163468043" onmouseenter="enter('1270276550163468043');" onmouseout="out('1270276550163468043');" style=""><abbr title=" 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PasswordEncoder}"> 669       * This method can only be called once per password. The salt is randomly generated internally in the {@link PðŸ”µ</abbr></span>
<span class="-8505312334696263704" onmouseenter="enter('-8505312334696263704');" onmouseout="out('-8505312334696263704');" style=""><abbr title=" 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a password,"> 670       * and appended to the hash to provide the resulting encoded password. Once this has been called on a passwordðŸ”µ</abbr></span>
<span class="-1857572043053598382" onmouseenter="enter('-1857572043053598382');" onmouseout="out('-1857572043053598382');" style=""><abbr title=" 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encoding the"> 671       * going forward all checks for authenticity must be done by {@link #isPasswordValid(String, String)} as encodðŸ”µ</abbr></span>
<span class="1617317087015691516" onmouseenter="enter('1617317087015691516');" onmouseout="out('1617317087015691516');" style=""> 672       * same password twice will result in different encoded passwords.                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 673       *                                                                                                            </span>
<span class="-5626416833833649033" onmouseenter="enter('-5626416833833649033');" onmouseout="out('-5626416833833649033');" style=""> 674       * @param rawPassword the unencoded password to encode                                                        </span>
<span class="-7164384961734418157" onmouseenter="enter('-7164384961734418157');" onmouseout="out('-7164384961734418157');" style=""> 675       * @return the encoded password                                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 676       */                                                                                                           </span>
<span class="-4610195350226345260" onmouseenter="enter('-4610195350226345260');" onmouseout="out('-4610195350226345260');" style=""> 677      protected String encodePassword(String rawPassword) {                                                         </span>
<span class="-8081074490464189240" onmouseenter="enter('-8081074490464189240');" onmouseout="out('-8081074490464189240');" style=""> 678          return passwordEncoderNew.encode(rawPassword);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 679      }                                                                                                             </span>
<span  style=""> 680                                                                                                                    </span>
<span class="-9122364098618956613" onmouseenter="enter('-9122364098618956613');" onmouseout="out('-9122364098618956613');" style=""> 681      @Deprecated                                                                                                   </span>
<span class="-6689514394619645734" onmouseenter="enter('-6689514394619645734');" onmouseout="out('-6689514394619645734');" style=""> 682      protected boolean usingDeprecatedPasswordEncoder() {                                                          </span>
<span class="-493259449393847495" onmouseenter="enter('-493259449393847495');" onmouseout="out('-493259449393847495');" style=""> 683          return passwordEncoder != null;                                                                           </span>

<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 684      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 685  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            